function asyncGeneratorStep(t,e,a,i,n,o,r){try{var c=t[o](r),s=c.value}catch(t){return void a(t)}c.done?e(s):Promise.resolve(s).then(i,n)}function _async_to_generator(t){return function(){var e=this,a=arguments;return new Promise((function(i,n){var o=t.apply(e,a);function r(t){asyncGeneratorStep(o,i,n,r,c,"next",t)}function c(t){asyncGeneratorStep(o,i,n,r,c,"throw",t)}r(void 0)}))}}function _define_property(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function _object_spread(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{},i=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(a).filter((function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})))),i.forEach((function(e){_define_property(t,e,a[e])}))}return t}function ownKeys(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function _object_spread_props(t,e){return e=null!=e?e:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):ownKeys(Object(e)).forEach((function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(e,a))})),t}var catchUpActivity=(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[10],{2092:function(t,e,a){"use strict";a.r(e),a.d(e,"FactoryGlobal",(function(){return de}));const i=window.hasOwnProperty("catchUpTestPerformance")?catchUpTestPerformance:performance,n=new class{setLogger(t){this._externalLogger=t}logTraceTag(t,e,a){if(!this._externalLogger)throw new Error("No ICatchUpLogger defined");e.tag=t,this._externalLogger.logTrace(e,a)}};var o;!function(t){t.CatchUpActivityStateUpdated="CatchUpActivityStateUpdated",t.CatchUpActivityValidationPropMissingError="CatchUpActivityValidationPropMissingError",t.CatchUpDisplayRecentChanges="CatchUpDisplayRecentChanges",t.CatchUpEmptyExperienceButtonClicked="CatchUpEmptyExperienceButtonClicked",t.CatchUpFeaturedActivityGroupClicked="CatchUpFeaturedActivityGroupClicked",t.CatchUpFlyoutActivitiesProcessed="CatchUpFlyoutActivitiesProcessed",t.CatchUpFlyoutActivitiesShown="CatchUpFlyoutActivitiesShown",t.CatchUpFlyoutAutoShown="CatchUpFlyoutAutoShown",t.CatchUpFlyoutDismissedCalled="CatchUpFlyoutDismissedCalled",t.CatchUpFlyoutRenderCalled="CatchUpFlyoutRenderCalled",t.CatchUpFlyoutStateBasedActivitiesProcessed="CatchUpFlyoutStateBasedActivitiesProcessed",t.CatchUpFlyoutTransientHidden="CatchUpFlyoutTransientHidden",t.CatchUpFlyoutTransientVisible="CatchUpFlyoutTransientVisible",t.CatchUpInitTimeline="CatchUpInitTimeline",t.CatchUpInvalidActivityTypeForItemString="CatchUpInvalidActivityTypeForItemString",t.CatchUpInvalidChangeIndices="CatchUpInvalidChangeIndices",t.CatchUpMissingActorsToCheckMentionee="CatchUpMissingActorsToCheckMentionee",t.CatchUpMissingDisplayNameError="CatchUpMissingDisplayNameError",t.CatchUpMissingDisplayTimestamp="CatchUpMissingDisplayTimestamp",t.CatchUpMissingHistoricalVersioningFeatureNameError="CatchUpMissingHistoricalVersioningFeatureNameError",t.CatchUpMissingNoChangesItemStringError="CatchUpMissingNoChangesItemStringError",t.CatchUpMissingSummaryItemStringError="CatchUpMissingSummaryItemStringError",t.CatchUpNavToItemFailed="CatchUpNavToItemFailed",t.CatchUpNoActivityForFeaturedGroupError="CatchUpNoActivityForFeaturedGroupError",t.CatchUpNoActivityForItemClickError="CatchUpNoActivityForItemClickError",t.CatchUpNoActivityOrActivityTypeError="CatchUpNoActivityOrActivityTypeError",t.CatchUpNoActorInFeedItemError="CatchUpNoActorInFeedItemError",t.CatchUpNoActorsForActivityError="CatchUpNoActorsForActivityError",t.CatchUpNoAuthorsForAuthorLayoutString="CatchUpNoAuthorsForAuthorLayoutString",t.CatchUpNoCreatorAttributionError="CatchUpNoCreatorAttributionError",t.CatchUpNoDataInFeedItemError="CatchUpNoDataInFeedItemError",t.CatchUpNoFeedItemIdError="CatchUpNoFeedItemIdError",t.CatchUpNoFeedItemPayloadError="CatchUpNoFeedItemPayloadError",t.CatchUpNoFeedItemTypeError="CatchUpNoFeedItemTypeError",t.CatchupNoPriorityIdError="CatchupNoPriorityIdError",t.CatchUpNoReasonsInActivityGroup="CatchUpNoReasonsInActivityGroup",t.CatchUpNoTimestampInFeedItemError="CatchUpNoTimestampInFeedItemError",t.CatchUpOverlappingContentChanges="CatchUpOverlappingContentChanges",t.CatchUpRelevantToMeItemClicked="CatchUpRelevantToMeItemClicked",t.CatchUpSummaryTextClicked="CatchUpSummaryTextClicked",t.CatchUpUnhandledTaskReopenCase="CatchUpUnhandledTaskReopenCase",t.CatchUpUnknownActivityTypeError="CatchUpUnknownActivityTypeError"}(o||(o={}));let r=!1;function c(t){r||i.mark("CatchUpInit."+t)}let s=void 0;function l(t){s=t}var p=a(157);function u(t,e){const a=[];return t.forEach(t=>{a.push(t)}),e.forEach(t=>{-1===Object(p.e)(a,e=>e.activityId===t.activityId)&&a.push(t)}),a}class m{getValueCount(){return this._count}inc(t){const e=this._map.get(t);this._map.set(t,(e||0)+1),this._count+=1}getJsonArray(){const t=[];return this._map.forEach((e,a)=>{t.push({[String(a)]:e})}),t}constructor(t=new Map,e=0){this._map=t,this._count=e}}function d(t){const e=new m,a=[],i=new Set,n=new Set;return t.filter(t=>t.contentExists).forEach(t=>{if(t.activityFeedItemId)return a.push(t),i.add(t.creatorName),void e.inc(t.type);n.add(t.creatorName)}),{genericAuthorsCount:n.size,activityTypesCountMap:e,relevantActivities:a,relevantAuthorsCount:i.size}}var C,h,y,g,v,f=a(1591);function E(t,e){return t===e||t.provider===e.provider&&function(t,e){if(!t||!e)return!1;if(t===e)return!0;const{aadId:a,upn:i}=T(t),{aadId:n,upn:o}=T(e);return U(a,n)||U(i,o)}(t.id,e.id)||U(t.email,e.email)||F(t.id,e.email)||F(e.id,t.email)}function T(t){if(0!==t.indexOf("S::")){const e=t.match(/(.*)(@)(.*)(\.)(.*)/);return 6===(null==e?void 0:e.length)?{aadId:"",upn:t}:{aadId:"",upn:""}}const e=t.match(/(.*)(::)(.*?)(::)(.*)/i);return 6===(null==e?void 0:e.length)?{aadId:e[5],upn:e[3]}:{aadId:"",upn:""}}function U(t,e){return!(!t||!e)&&t===e}function F(t,e){return!(!t||!e)&&-1!==t.indexOf(e)}function I(t){return!!(t&&t[0]&&t[1])&&E(t[0],t[1])}function A(t,e,a){if(!a)return{authorNames:[],summaryNavActivity:void 0};let i=e.map(t=>t.displayName).filter(t=>!!t),n={activity:void 0,priority:0};return t.forEach(t=>{t.activityFeedItemId||(t.type===h.Edit||t.contentExists)&&(i.push(t.creatorName),n=function(t,e,a){const i=function(t,e){return e?t.type===h.Edit?5:t.type>999?4:t.activityFeedItemId?3:2:1}(e,a);return i>t.priority?{activity:e,priority:i}:t}(n,t,t.contentExists))}),i=i.filter((t,e,a)=>e===a.indexOf(t)),{authorNames:i,summaryNavActivity:n.activity}}function _(t,e,a=!1){if(0===t.length)return"";const i=t.length<=4?t:t.slice(0,3).concat((t.length-3).toString());return Object(f.b)(function(t,e,a=!1){if(a&&t>1)return e.CatchUpFlyoutCompactSummaryString;switch(t){case 0:return n.logTraceTag(559436956,{level:"Warning",message:"Retrieving authors layout string for catch-up flyout with zero authors",eventCategory:"Generic",eventName:o.CatchUpNoAuthorsForAuthorLayoutString}),e.ActivityNotificationText;case 1:return e.CatchUpFlyoutOnePersonChange;case 2:return e.CatchUpFlyoutTwoPeopleChange;case 3:return e.CatchUpFlyoutThreePeopleChange;case 4:return e.CatchUpFlyoutFourPeopleChange;default:return e.CatchUpFlyoutMultiplePeopleChange}}(t.length,e,a),...i)}function b(){return(b=_async_to_generator((function*(t,e,a,i,r=!1){const{preprocessedActivities:c,wywaPayload:s}=yield w(t,e),{genericAuthorsCount:l,activityTypesCountMap:p,relevantActivities:u,relevantAuthorsCount:m}=d(c),{authorNames:C,summaryNavActivity:h}=A(c,s.authors,i&&!s.isFirstDocumentOpen),y=_(C,a,r);return n.logTraceTag(595637973,{level:"Info",message:JSON.stringify({msg:"Activities processed on CatchUpFlyout construction.",activityCount:p.getValueCount(),activityTypesCounts:p.getJsonArray(),peopleMadeGenericChanges:l,peopleMadeNewChanges:C.length,peopleMadeRelevantChanges:m,relevantChanges:u.length}),eventCategory:"Generic",eventName:o.CatchUpFlyoutActivitiesProcessed}),{relevantActivities:u,catchUpActivitiesCount:c.length,authorCount:C.length,summaryNavActivity:h,summaryItemText:y}}))).apply(this,arguments)}function w(t,e){return S.apply(this,arguments)}function S(){return(S=_async_to_generator((function*(t,e){const a=yield t.getWywaActivities();c("GetActivityFeed");const i=yield t.getActivityFeedItems();return c("EndGetActivityFeed"),{preprocessedActivities:u(i,a.activities).sort((t,e)=>e.displayTimestamp.getTime()-t.displayTimestamp.getTime()).map(t=>{const a=k(t);if(!a)return;let i=!0;return e&&"function"==typeof e.doesContentExist&&(i=e.doesContentExist(t)),_object_spread_props(_object_spread({},t),{creatorName:a,contentExists:i})}).filter(t=>void 0!==t),wywaPayload:a}}))).apply(this,arguments)}function k(t){if(!t.actors||!t.actors.length)return void n.logTraceTag(559436959,{level:"Error",message:"No actors for activity.",eventCategory:"Error",eventName:o.CatchUpNoActorsForActivityError});const e=t.actors[0];if(e&&e.displayName&&0!==e.displayName.length)return e.displayName;n.logTraceTag(559436960,{level:"Error",message:"No creator attribution for activity.",eventCategory:"Error",eventName:o.CatchUpNoCreatorAttributionError})}!function(t){t[t.Success=1]="Success",t[t.DeletedItem=2]="DeletedItem",t[t.UnknownError=3]="UnknownError",t[t.EmptyNavigationId=4]="EmptyNavigationId",t[t.DecodeNavIdFailed=5]="DecodeNavIdFailed",t[t.AppNavigationFailure=6]="AppNavigationFailure",t[t.UnsupportedActivityType=7]="UnsupportedActivityType",t[t.NoActivityProvided=8]="NoActivityProvided"}(C||(C={})),function(t){t[t.None=0]="None",t[t.Edit=1]="Edit",t[t.Comment=2]="Comment",t[t.Reply=3]="Reply",t[t.AtMention=4]="AtMention",t[t.Restore=5]="Restore",t[t.TaskAssign=6]="TaskAssign",t[t.TaskReassign=7]="TaskReassign",t[t.TaskReopen=8]="TaskReopen",t[t.TaskComplete=9]="TaskComplete",t[t.TaskReply=10]="TaskReply",t[t.WordCommentReaction=11]="WordCommentReaction",t[t.CommentReaction=12]="CommentReaction"}(h||(h={})),function(t){t[t.NewAssignee=1]="NewAssignee",t[t.ExistingAssignee=2]="ExistingAssignee",t[t.TaskCreator=3]="TaskCreator"}(y||(y={})),function(t){t[t.TopLeftEdge=1]="TopLeftEdge",t[t.TopCenter=2]="TopCenter",t[t.TopRightEdge=3]="TopRightEdge",t[t.TopAutoEdge=4]="TopAutoEdge",t[t.BottomLeftEdge=5]="BottomLeftEdge",t[t.BottomCenter=6]="BottomCenter",t[t.BottomRightEdge=7]="BottomRightEdge",t[t.BottomAutoEdge=8]="BottomAutoEdge",t[t.LeftTopEdge=9]="LeftTopEdge",t[t.LeftCenter=10]="LeftCenter",t[t.LeftBottomEdge=11]="LeftBottomEdge",t[t.RightTopEdge=12]="RightTopEdge",t[t.RightCenter=13]="RightCenter",t[t.RightBottomEdge=14]="RightBottomEdge"}(g||(g={})),function(t){t[t.None=0]="None",t[t.IsDismissed=1]="IsDismissed",t[t.IsSeen=2]="IsSeen",t[t.IsRead=4]="IsRead",t[t.IsCompleted=8]="IsCompleted",t[t.IsFlagged=16]="IsFlagged"}(v||(v={}));var N,R=a(82),M=a(81),D=a(217),x=a(841),O=a(11);function W(t,e){return"CommentCreated"===t?e?h.TaskReply:h.Reply:"TaskCreated"===t?h.TaskAssign:"TaskCompleted"===t?h.TaskComplete:"TaskReassigned"===t?h.TaskReassign:"TaskReopened"===t?h.TaskReopen:"UserAtMentioned"===t?h.AtMention:"WordCommentReactionUpdate"===t?h.WordCommentReaction:"CommentReactionCreated"===t?h.CommentReaction:(n.logTraceTag(560215318,{level:"Error",message:"Unknown type in getActivityType: "+t,eventCategory:"Error",eventName:o.CatchUpUnknownActivityTypeError}),h.None)}function j(t,e){return 0!=(t&e)}function L(t){const e=[];return t.forEach(t=>{const a=function(t){var e,a,i;if(!t.type)return void n.logTraceTag(560215319,{level:"Error",message:"No type when validating activity feed item.",eventCategory:"Error",eventName:o.CatchUpNoFeedItemPayloadError});if(!t.activityFeedItemPayload)return void n.logTraceTag(560215320,{level:"Error",message:"No activityFeedItemPayload when validating activity feed item.",eventCategory:"Error",eventName:o.CatchUpNoDataInFeedItemError});if(!t.id)return void n.logTraceTag(543741137,{level:"Error",message:"No activityFeedItemId when validating activity feed item.",eventCategory:"Error",eventName:o.CatchUpNoFeedItemIdError});const r=JSON.parse(t.activityFeedItemPayload);if(!r||!r.data||!r.data.activityId)return void n.logTraceTag(560215321,{level:"Error",message:"No data when validating activity feed item.",eventCategory:"Error",eventName:o.CatchUpNoActorInFeedItemError});if(!("WordCommentReactionUpdate"!==t.type||r.officeWordReaction&&r.officeWordReaction.latestReaction&&r.officeWordReaction.reactionCounts&&r.officeWordReaction.reactionCounts[0].count))return;if(!("CommentReactionCreated"!==t.type||r.officeReaction&&r.officeReaction.latestEmoji&&r.officeReaction.emojiCounts))return;if(!r.actor)return void n.logTraceTag(560215322,{level:"Error",message:"No actor when validating activity feed item.",eventCategory:"Error",eventName:o.CatchUpNoTimestampInFeedItemError});if(!r.timestamp)return void n.logTraceTag(560215323,{level:"Error",message:"No timestamp when validating activity feed item.",eventCategory:"Error",eventName:o.CatchUpNoTimestampInFeedItemError});const c={id:r.actor.id,provider:r.actor.provider,email:null!==(e=r.actor.email)&&void 0!==e?e:r.actor.userPrincipalName,displayName:r.actor.name,imageUrl:r.actor.pictureUrl};return _object_spread({type:t.type,activityId:r.data.activityId,activityFeedItemId:t.id,navigationId:null!==(a=r.data.navigationId)&&void 0!==a?a:void 0,commentThreadIsTask:r.data.commentThreadIsTask,actor:c,timestamp:new Date(r.timestamp),currentUserRoles:B(r.userRoles),commentThreadId:null!==(i=r.data.commentThreadId)&&void 0!==i?i:void 0,state:t.activityState},r.officeWordReaction&&{officeWordReaction:r.officeWordReaction},r.officeReaction&&{officeReaction:r.officeReaction})}(t);a&&e.push(a)}),e}function B(t){let e=N.Unknown;return t.split(", ").forEach(t=>{"Creator"===t&&(e|=N.Creator),"CommentThreadCreator"===t&&(e|=N.CommentThreadCreator),"TaskCreator"===t&&(e|=N.TaskCreator),"RepliedTo"===t&&(e|=N.RepliedTo),"InThread"===t&&(e|=N.InThread),"ExistingAssignee"===t&&(e|=N.ExistingAssignee),"NewAssignee"===t&&(e|=N.NewAssignee),"Mentioned"===t&&(e|=N.Mentioned),"CommentCreator"===t&&(e|=N.CommentCreator),"LatestReactor"===t&&(e|=N.LatestReactor)}),e}function P(t){return j(t,N.Mentioned)}function H(t){return j(t,N.CommentCreator)}function Z(t){return!(null===(e=null===(a=s)||void 0===a?void 0:a.isFeatureGateEnabled("Microsoft.Office.SharedOnline.CommentReactionIsEnabled",!1))||void 0===e||!e)&&j(t,N.CommentCreator);var e,a}function V(t,e){var a;t.has(e.commentThreadId)||t.set(e.commentThreadId,[]),null===(a=t.get(e.commentThreadId))||void 0===a||a.push(e)}function G(t){var e;let a={activityId:t.activityId,activityFeedItemId:null!==(e=t.activityFeedItemId)&&void 0!==e?e:void 0,type:W(t.type,t.commentThreadIsTask),actors:[t.actor],displayTimestamp:t.timestamp,navigationId:t.navigationId,state:t.state};var i,n,o,r,c,s,l,p,u,m;(a.type===h.AtMention&&j(t.currentUserRoles,N.Creator)&&(null===(i=a.actors)||void 0===i||i.push(t.actor)),a.type===h.TaskAssign||a.type===h.TaskComplete||a.type===h.TaskReassign||a.type===h.TaskReopen)&&(o=a.type,(j(r=t.currentUserRoles,N.TaskCreator)||o===h.TaskAssign&&j(r,N.Creator))&&j(t.currentUserRoles,N.NewAssignee|N.ExistingAssignee)&&(null===(m=a.actors)||void 0===m||m.push(t.actor)),a.type===h.TaskReassign&&!j(t.currentUserRoles,N.TaskCreator)&&j(t.currentUserRoles,N.ExistingAssignee)&&(a.type=h.TaskAssign),a=_object_spread_props(_object_spread({},a),{relationship:(n=t.currentUserRoles,j(n,N.TaskCreator)?y.TaskCreator:j(n,N.ExistingAssignee)?y.ExistingAssignee:y.NewAssignee)}));return a.type===h.WordCommentReaction&&(a=_object_spread_props(_object_spread({},a),{latestReaction:t.officeWordReaction.latestReaction,reactionCounts:null!==(c=null===(s=t.officeWordReaction)||void 0===s?void 0:s.reactionCounts)&&void 0!==c?c:[]})),a.type===h.CommentReaction&&(a=_object_spread_props(_object_spread({},a),{latestEmoji:null!==(l=t.officeReaction.latestEmoji)&&void 0!==l?l:"",emojiCounts:null!==(p=null===(u=t.officeReaction)||void 0===u?void 0:u.emojiCounts)&&void 0!==p?p:[]})),a}!function(t){t[t.Creator=1]="Creator",t[t.CommentThreadCreator=2]="CommentThreadCreator",t[t.TaskCreator=4]="TaskCreator",t[t.RepliedTo=8]="RepliedTo",t[t.InThread=16]="InThread",t[t.ExistingAssignee=32]="ExistingAssignee",t[t.NewAssignee=64]="NewAssignee",t[t.Mentioned=128]="Mentioned",t[t.CommentCreator=256]="CommentCreator",t[t.LatestReactor=512]="LatestReactor",t[t.Unknown=0]="Unknown"}(N||(N={}));class q{getWywaActivities(){var t=this;return _async_to_generator((function*(){return t.getWywaActivitiesPromise||(t.getWywaActivitiesPromise=(e=_async_to_generator((function*(e){c("RequestWywaActivities");const a={activities:[],authors:[],isFirstDocumentOpen:!1};let i=yield t._activityRepo.getWywaActivities();if(!i)return a;for(a.activities=i.activities,a.authors=i.actors,a.highWaterline=i.highWaterline,a.lowWaterline=i.lowWaterline,a.wywaWaterline=i.wywaWaterline,a.isFirstDocumentOpen=null!==(e=i.isFirstDocumentOpen)&&void 0!==e&&e,c("RequestActivities");null!==(n=i)&&void 0!==n&&n.hasMore;){var n;i=yield t._activityRepo.getActivities(a.lowWaterline,a.wywaWaterline),i&&(a.lowWaterline=i.lowWaterline,a.activities=[...a.activities,...i.activities],a.authors=[...a.authors,...i.actors])}return a.activities=t.dedupeActivities(a.activities),a.activities.length&&(a.authors=t.getActivityCreators(a.activities)),a})),function(t){return e.apply(this,arguments)})()),t.getWywaActivitiesPromise;var e}))()}getActivityFeedItems(){var t=this;return _async_to_generator((function*(){var e,a;const i=(new Date).getTime(),r=yield t._activityRepo.getActivityFeedItems(),c=(new Date).getTime()-i;return R.a.sendTraceTag(556337170,M.a.msoulscat_Wac_CatchUpFlyout,D.a.Info,JSON.stringify({msg:"requestActivityFeedItems completed",latencyMs:c})),function(t,e){const a=[],i=new Map;for(const e of t){const t=W(e.type,e.commentThreadIsTask);switch(t){case h.Reply:case h.TaskReply:if(j(r=e.currentUserRoles,N.Creator)||!j(r,N.InThread|N.RepliedTo))continue;a.push(G(e));continue;case h.AtMention:if(!P(e.currentUserRoles))continue;a.push(G(e));continue;case h.TaskAssign:case h.TaskComplete:case h.TaskReassign:case h.TaskReopen:V(i,e);continue;case h.WordCommentReaction:if(!H(e.currentUserRoles))continue;a.push(G(e));continue;case h.CommentReaction:if(!Z(e.currentUserRoles))continue;a.push(G(e));continue;default:n.logTraceTag(556933518,{level:"Error",message:"Unknown activity type in parseRelevantActivities: "+t,eventCategory:"Error",eventName:o.CatchUpUnknownActivityTypeError});continue}}var r;!function(t,e){t.forEach((t,a)=>{t.sort((t,e)=>e.timestamp.getTime()-t.timestamp.getTime());const i=t[0];if(!j(i.currentUserRoles,N.NewAssignee|N.ExistingAssignee|N.TaskCreator))return;const n=G(i);e.push(n)})}(i,a);const c=t=>{let a;return t.id&&(a=e.get(t.id)),!a&&t.email&&(a=e.get(t.email)),_object_spread_props(_object_spread({},t),{color:a})};return a.map(t=>_object_spread_props(_object_spread({},t),{actors:t.actors.map(c)}))}(null!==(e=null==r?void 0:r.activityFeedItems)&&void 0!==e?e:[],null!==(a=null==r?void 0:r.personaColorMap)&&void 0!==a?a:new Map)}))()}updateFeedActivityState(t,e){var a=this;return _async_to_generator((function*(){if(!t.activityFeedItemId)return R.a.sendTraceTag(507254172,M.a.msoulscat_Wac_CatchUpFlyout,D.a.Warning,"ValidatedActivity is missing activityFeedItemId."),Promise.resolve(!1);const i={itemIds:[t.activityFeedItemId],activityStatesToSet:e,activityStatesToReset:0,resetUnseenCount:!1};return a._activityRepo.updateFeedActivityState(i)}))()}dedupeActivities(t){return function(t,e){const a={};return t.filter(t=>{const e=t.activityId;return!a.hasOwnProperty(e)&&(a[e]=!0)})}(t)}getActivityCreators(t){return t.map(t=>t.actors[0]).filter(t=>t).reduce((t,e)=>(t.some(t=>E(t,e))||t.push(e),t),[])}constructor(t){this.getWywaActivitiesPromise=void 0,this._activityRepo=t}}function K(t){switch(typeof t){case"string":return t;case"object":return null==t?void 0:t.message;default:return}}function z(t,e,a){return J.apply(this,arguments)}function J(){return(J=_async_to_generator((function*(t,e,a,i=D.a.Error){try{var n;const o=null!==(n=yield t())&&void 0!==n?n:void 0;return o||R.a.sendTraceTag(588391823,M.a.msoulscat_Wac_CatchUpFlyout,i,`${e} received null data from ${a}.`),o}catch(t){const n=K(t);R.a.sendTraceTag(588391824,M.a.msoulscat_Wac_CatchUpFlyout,i,n?`${e} received an error from ${a}: ${n}`:`${e} received an error from ${a} with no message.`)}}))).apply(this,arguments)}function $(t){var e,a;if(t&&X(t,"activityId","Activity")&&X(t,"displayTimestamp","Activity"))return _object_spread_props(_object_spread({},t),{activityFeedItemId:null!==(e=t.activityFeedItemId)&&void 0!==e?e:void 0,actors:Q(t.actors,Y),state:null!==(a=t.state)&&void 0!==a?a:0})}function Y(t){if(t)return _object_spread({},t)}function Q(t,e){var a,i;return null!==(a=null==t||null===(i=t.map(t=>e(t)))||void 0===i?void 0:i.filter(t=>null!=t))&&void 0!==a?a:[]}function X(t,e,a){return void 0!==t[e]&&null!==t[e]||(n.logTraceTag(557983766,{level:"Error",message:`Essential property ${String(e)} is null or undefined on ${a}, the object will be set to undefined.`,eventCategory:"Error",eventName:o.CatchUpActivityValidationPropMissingError}),!1)}function tt(t){var e,a,i;if(t)return _object_spread_props(_object_spread({},t),{wywaWaterline:null!==(e=t.wywaWaterline)&&void 0!==e?e:void 0,highWaterline:null!==(a=t.highWaterline)&&void 0!==a?a:void 0,lowWaterline:null!==(i=t.lowWaterline)&&void 0!==i?i:void 0,activities:Q(t.activities,$),actors:Q(t.actors,Y)})}function et(t){const e=new Map;return t?(t.forEach((t,a)=>{a&&t&&e.set(a,t)}),e):e}class at{getWywaActivities(){var t=this;return _async_to_generator((function*(){const e=yield z(()=>t._activityRequestManager.requestWYWAActivities(),"getWywaActivities","requestWYWAActivities");return null!==(null==e?void 0:e.isFirstDocumentOpen)&&void 0!==(null==e?void 0:e.isFirstDocumentOpen)&&R.a.sendTraceTag(578404700,M.a.msoulscat_Wac_CatchUpFlyout,D.a.Info,"Is first document open: "+e.isFirstDocumentOpen),tt(e)}))()}getActivities(t,e){var a=this;return _async_to_generator((function*(){return tt(yield z(()=>a._activityRequestManager.requestActivities(t,e),"getActivities","requestActivities",D.a.Info))}))()}getActivityFeedItems(){var t=this;return _async_to_generator((function*(){return function(t){var e,a;if(t)return{activityFeedItems:L(null!==(e=null===(a=t.activityFeedItems)||void 0===a?void 0:a.filter(t=>!!t))&&void 0!==e?e:[]),personaColorMap:et(t.personaColorMap)}}(yield z(()=>t._activityRequestManager.requestActivityFeed({}),"getActivityFeedItems","requestActivityFeed"))}))()}updateFeedActivityState(t){var e=this;return _async_to_generator((function*(){return!!(yield z(()=>e._activityRequestManager.updateActivityState(t),"updateFeedActivityState","updateActivityState"))}))()}constructor(t){this._activityRequestManager=t}}var it=a(1),nt=a(52),ot=a(94),rt=a(765),ct=a(456),st=a(353),lt=a(66),pt=a(20),ut=a(5),mt=a(103),dt=a(314);const Ct=Object(pt.c)((t,e)=>{const a=Object(mt.a)(e),i=Object(dt.a)();return{activityIndicatorTooltip:Object(ut.eb)({boxShadow:t?"0px 16px 18px -4px rgba(0, 0, 0, 0.1)":"0px 8px 10px -2px rgba(0, 0, 0, 0.1)",borderRadius:"1px",maxWidth:"176px",zIndex:1,pointerEvents:"none"},ut.f.small),defaultButton:{root:{border:"1px solid transparent",padding:"0px 0px",height:"auto"}},activityIndicatorTooltipContent:Object(ut.eb)({display:"inline-block",margin:"4px 12px 8px 12px"}),activityIndicatorTooltipAuthorNames:Object(ut.eb)({float:"left",clear:"both",fontSize:ut.k.small,fontWeight:ut.l.semibold,color:a.textColor,textAlign:"left"}),activityIndicatorTooltipEditInfo:Object(ut.eb)({float:"left",clear:"both"}),activityIndicatorTooltipDotContainer:Object(ut.eb)({display:"inline-block",width:"8px",margin:"2px 1px"}),activityIndicatorTooltipDot:Object(ut.eb)({borderRadius:"50%",width:"6px",height:"6px",backgroundColor:i.catchupContentColor,cursor:"default",selectors:{[ut.m]:{backgroundColor:"Highlight"}}}),activityIndicatorTooltipNewText:Object(ut.eb)({color:i.catchupContentColor,fontSize:ut.k.small,fontWeight:ut.l.semibold,display:"inline",margin:"0px 1px"}),activityIndicatorTooltipChangeText:Object(ut.eb)({fontSize:ut.k.small,fontWeight:ut.l.regular,display:"inline",margin:"0px 4px",color:a.textSecondaryColor}),activityIndicatorTooltipTimestamp:Object(ut.eb)({float:"left",display:"inline-block",clear:"both",fontSize:ut.k.small,color:a.textSecondaryColor,marginTop:"1px"})}});class ht extends it.PureComponent{componentDidMount(){yt.register(this)}componentWillUnmount(){yt.unregister(this)}render(){return this.props.formatter(this.props.date)}}const yt=new class{register(t){this.components.push(t),void 0===this.timerId&&(this.timerId=window.setInterval(()=>this.onTimerFired(),6e4))}unregister(t){this.components=this.components.filter(e=>e!==t),this.components.length||window.clearInterval(this.timerId)}onTimerFired(){this.components.forEach(t=>t.forceUpdate())}constructor(){this.components=[]}},gt=({authorNames:t,timestamp:e,dateFormatter:a,isSticky:i,changeTypesDisplayString:n,localizedStrings:o})=>{const r=Object(ct.a)(),c=Ct(i,r),s=(l=n,p=c.activityIndicatorTooltipChangeText,it.createElement("span",{dir:"auto",className:p},l));var l,p;return it.createElement("div",{className:c.activityIndicatorTooltipContent},t&&it.createElement("div",{className:c.activityIndicatorTooltipAuthorNames},t),it.createElement("div",{className:c.activityIndicatorTooltipEditInfo},it.createElement("div",{className:c.activityIndicatorTooltipDotContainer},it.createElement("div",{className:c.activityIndicatorTooltipDot})),it.createElement("div",{className:c.activityIndicatorTooltipNewText},o.ActivityFlyoutNew,s)),e&&it.createElement("div",{className:c.activityIndicatorTooltipTimestamp},it.createElement(ht,{date:e,formatter:a})))},vt=({anchorTarget:t,authorNames:e,timestamp:a,dateFormatter:i,isSticky:n,directionalHint:o,changeTypesDisplayString:r,localizedStrings:c,onTooltipClick:s,onHoverEnterCallback:l,onHoverLeaveCallback:p})=>{const u=Object(ct.a)(),m=t.getBoundingClientRect();let d=document.documentElement.scrollTop;const C=document.documentElement.scrollHeight>0?document.documentElement.scrollHeight:document.documentElement.clientHeight,h=document.documentElement.scrollTop+C,y=document.documentElement.scrollLeft,v=document.documentElement.scrollLeft+document.documentElement.scrollWidth,f=m.top+m.height/2,E=m.left+m.width/2,T=document.getElementById("AppHeaderPanel"),U=document.getElementById("Ribbon");(T||U)&&(d=d+(T?T.clientHeight:0)+(U?U.clientHeight:0)+5);const F=f>=d&&f<=h&&E>=y&&E<=v,I=Ct(n,u),A=function(t){if(!t)return ot.a.leftTopEdge;switch(t){case g.TopLeftEdge:return ot.a.topLeftEdge;case g.TopCenter:return ot.a.topCenter;case g.TopRightEdge:return ot.a.topRightEdge;case g.TopAutoEdge:return ot.a.topAutoEdge;case g.BottomLeftEdge:return ot.a.bottomLeftEdge;case g.BottomCenter:return ot.a.bottomCenter;case g.BottomRightEdge:return ot.a.bottomRightEdge;case g.BottomAutoEdge:return ot.a.bottomAutoEdge;case g.LeftTopEdge:return ot.a.leftTopEdge;case g.LeftCenter:return ot.a.leftCenter;case g.LeftBottomEdge:return ot.a.leftBottomEdge;case g.RightTopEdge:return ot.a.rightTopEdge;case g.RightCenter:return ot.a.rightCenter;case g.RightBottomEdge:return ot.a.rightBottomEdge;default:return ot.a.leftTopEdge}}(o),_=void 0!==s;return F?it.createElement(rt.a,{target:t,directionalHint:A,isBeakVisible:!1,gapSpace:5,className:I.activityIndicatorTooltip,role:"alert","aria-live":"polite","aria-atomic":!0,"data-unique-id":"activityIndicatorTooltipContent",bounds:lt.getBoundingWindowWithPaddingFabric},_?it.createElement(st.a,{onClick:s,onMouseEnter:l,onMouseLeave:p,styles:I.defaultButton},it.createElement(gt,{authorNames:e,timestamp:a,dateFormatter:i,isSticky:n,changeTypesDisplayString:r,localizedStrings:c})):it.createElement(gt,{authorNames:e,timestamp:a,dateFormatter:i,isSticky:n,changeTypesDisplayString:r,localizedStrings:c})):it.createElement(it.Fragment,null)};class ft extends it.Component{addTooltip(t){this.setState(e=>({tooltips:[...e.tooltips,t]}))}removeTooltips(t){this.setState(e=>t?{tooltips:[]}:{tooltips:e.tooltips.filter(t=>t.isSticky)})}updateTooltip(t,e){const a=this.state.tooltips.filter(e=>e.anchorTarget.id===t.id);if(a&&a.length>0){const i=a[0];this.setState(a=>(i.anchorTarget=t,i.isSticky=e,{tooltips:[...a.tooltips.filter(t=>t.anchorTarget.id!==i.anchorTarget.id),i]}))}}render(){return it.createElement(it.Fragment,null,this.state.tooltips.map(t=>it.createElement(vt,_object_spread_props(_object_spread({},t),{key:t.anchorTarget.id}))))}constructor(t){super(t),this.state={tooltips:[]}}}let Et,Tt;function Ut(t){Tt&&Tt.then(e=>e.removeTooltips(t)),t&&Et&&Et.then(e=>e.removeTooltips(t))}class Ft{createActivityIndicatorTooltip(t){var e=this;return _async_to_generator((function*(){if(t&&t.target&&t.container&&t.activityIds)return e.getRecentActivitiesFromIds(t.activityIds).then(a=>{const i=e.getAuthorNames(a),n=e.getLatestTimestamp(a),o=e.getChangeString(a);!function(t,e,a,i,n,o,r,c,s,l,p,u,m,d){function h(t){t.stopPropagation(),0!==l.length?null==u||u(l[0].activityId):R.a.sendTraceTag(509748564,M.a.msoulscat_Wac_WacCatchUpActivities,D.a.Error,"Should receive at least 1 activity from the blue dot flyout.")}function y(t){t.stopPropagation(),0!==l.length?null==m||m(l[0].activityId):R.a.sendTraceTag(509748563,M.a.msoulscat_Wac_WacCatchUpActivities,D.a.Error,"Should receive at least 1 activity from the blue dot flyout.")}function g(t){return v.apply(this,arguments)}function v(){return(v=_async_to_generator((function*(t){if(t.stopPropagation(),Ut(!0),0===l.length)return void R.a.sendTraceTag(512522334,M.a.msoulscat_Wac_WacCatchUpActivities,D.a.Error,"Should receive at least 1 activity from clicking blue dot flyout.");const e=l[0],a=yield null==p?void 0:p.navigateToActivity({activity:e,locationId:d,fromSummaryString:!1});a&&a===C.Success||R.a.sendTraceTag(512312013,M.a.msoulscat_Wac_WacCatchUpActivities,D.a.Error,"Failed to navigate item from clicking catchup flyout, result="+a)}))).apply(this,arguments)}(function(t,e){const a=new Promise(e=>{nt.render(it.createElement(ft,{ref:t=>{e(t)}}),t)});return e?Et=a:Tt=a,a})(e,o).then(e=>e.addTooltip({anchorTarget:t,authorNames:a,timestamp:i,dateFormatter:n,isSticky:o,directionalHint:r,changeTypesDisplayString:c,localizedStrings:s,onTooltipClick:p?g:void 0,onHoverEnterCallback:u?h:void 0,onHoverLeaveCallback:m?y:void 0}))}(t.target,t.container,i,n,e._dateFormatter,t.isSticky,t.dirHint,o,e._catchUpActivityStrings,a,t.activityNavigationManager,t.onHoverEnter,t.onHoverLeave,t.blueDotSheetRangeKey)}).catch(t=>R.a.sendTraceTag(587206741,M.a.msoulscat_Wac_WacCatchUpActivities,D.a.Error,"createActivityIndicatorTooltip failed, indicator not shown. Error: "+t));R.a.sendTraceTag(588305366,M.a.msoulscat_Wac_WacCatchUpActivities,D.a.Warning,"Activity Indicator tooltip requested with invalid empty parameters.")}))()}dismissActivityIndicatorTooltips(t){t?Ut(t.clearSticky):R.a.sendTraceTag(575807587,M.a.msoulscat_Wac_WacCatchUpActivities,D.a.Error,"dismissActivityIndicatorTooltipsWithParams called with no parameters.")}updateActivityIndicatorTooltip(t){var e,a;t&&t.target?(e=t.target,a=t.isSticky,Tt&&Tt.then(t=>t.updateTooltip(e,a)),Et&&Et.then(t=>t.updateTooltip(e,a))):R.a.sendTraceTag(588305367,M.a.msoulscat_Wac_WacCatchUpActivities,D.a.Warning,"Activity Indicator tooltip Update requested with invalid empty target.")}getRecentActivitiesFromIds(t){var e=this;return _async_to_generator((function*(){return t&&0!==t.length?(yield e._activityStore.getWywaActivities()).activities.filter(e=>t.indexOf(e.activityId)>-1):(R.a.sendTraceTag(587206743,M.a.msoulscat_Wac_WacCatchUpActivities,D.a.Warning,"Unable to retrieve Activities for empty set of Activity Ids."),[])}))()}getAuthorNames(t){if(0===t.length)return R.a.sendTraceTag(588305369,M.a.msoulscat_Wac_WacCatchUpActivities,D.a.Warning,"Unable to retrieve Author Names for empty set of Activities."),"";let e=t.filter(t=>t&&t.actors&&t.actors[0]&&t.actors[0].displayName).map(t=>t.actors[0].displayName);if(e=e.filter((t,e,a)=>e===a.indexOf(t)),e.length>0)switch(e.length){case 1:return e[0];case 2:return Object(f.b)(this._catchUpActivityStrings.ActivityFlyoutTwoAuthors,...e);case 3:return Object(f.b)(this._catchUpActivityStrings.ActivityFlyoutThreeAuthors,...e);default:return Object(f.b)(this._catchUpActivityStrings.ActivityFlyoutFourOrMoreAuthors,...e)}return R.a.sendTraceTag(588305370,M.a.msoulscat_Wac_WacCatchUpActivities,D.a.Warning,"Unable to retrieve Author Names for the given Activity Ids."),""}getLatestTimestamp(t){if(0===t.length)return void R.a.sendTraceTag(588305371,M.a.msoulscat_Wac_WacCatchUpActivities,D.a.Warning,"Unable to retrieve Timestamp for the empty set of Activities.");let e;if(t.length>0&&t[0]&&t[0].displayTimestamp){const a=t.reduce((t,e)=>e&&e.displayTimestamp&&t&&t.displayTimestamp&&e.displayTimestamp>t.displayTimestamp?e:t,t[0]);a&&(e=a.displayTimestamp)}return e||R.a.sendTraceTag(588305372,M.a.msoulscat_Wac_WacCatchUpActivities,D.a.Warning,"Unable to retrieve valid Timestamp for the given Activity Ids."),e}getChangeString(t){if(0===t.length)return R.a.sendTraceTag(588305373,M.a.msoulscat_Wac_WacCatchUpActivities,D.a.Warning,"Unable to determine changes string with empty set of Activities."),this._catchUpActivityStrings.ActivityFlyoutChanges;let e=0,a=0;for(const i of t)switch(i.type){case h.Edit:e+=1;break;case h.Comment:case h.Reply:a+=1}return e>=1&&a>=1?this._catchUpActivityStrings.ActivityFlyoutEditsAndComments:e>1?this._catchUpActivityStrings.ActivityFlyoutEdits:a>1?this._catchUpActivityStrings.ActivityFlyoutComments:1===e?this._catchUpActivityStrings.ActivityFlyoutEdit:1===a?this._catchUpActivityStrings.ActivityFlyoutComment:(R.a.sendTraceTag(588305374,M.a.msoulscat_Wac_WacCatchUpActivities,D.a.Warning,"No supported change types found in the activities."),this._catchUpActivityStrings.ActivityFlyoutChanges)}constructor(t,e,a){this._catchUpActivityStrings=e,this._dateFormatter=a,this._activityStore=t}}var It=a(712);const At=t=>{const e=Object(ct.a)();return it.createElement(It.a,{theme:e},t.children)};function _t(t){return(t&v.IsRead)===v.IsRead}function bt(t){return(t&v.IsSeen)===v.IsSeen}var wt=a(62),St=a(1048),kt=a(2248),Nt=a(2229),Rt=a(187),Mt=a(831),Dt=it.memo(({firstFocusElementId:t,flyoutStrings:e,onKeyDown:a})=>{const i=Object(ct.a)(),n=Object(dt.g)(i);return it.createElement("div",{className:n.emptyActivitiesForYouContainer},it.createElement(Rt.a,{className:n.emptyActivitiesForYouIcon,iconName:window.matchMedia("screen and (-ms-high-contrast: active)").matches?"EmptyFlyoutHCIllustration":Object(Mt.a)()?"EmptyFlyoutDarkIllustration":"EmptyFlyoutColorfulIllustration"}),it.createElement("div",{className:n.emptyActivitiesForYouInnerContainer,id:t,onKeyDown:a},it.createElement("div",{className:n.emptyActivitiesForYouMessage},e.EmptyActivitiesForYouSectionLabel)))}),xt=a(1304),Ot=it.memo(({flyoutStrings:t,historicalVersionFeatureName:e,linkId:a,onClick:i,onKeyDown:r})=>{const c=Object(ct.a)(),s=Object(dt.g)(c);return e?it.createElement("div",{className:s.summaryItemContainer},it.createElement("div",{className:s.summaryItemTitle},t.CatchUpFlyoutSummaryFooterTitleString),it.createElement("div",{className:s.emptySummaryItemContainer},it.createElement("div",{className:s.emptySummaryItemMessage},Object(f.a)(t.CatchUpViewPreviousEditsLabel,t=>it.createElement(xt.a,{className:s.emptySummaryItemLink,dir:"auto",id:a,key:t,onClick:i,onKeyDown:r},e))))):(n.logTraceTag(512272132,{level:"Error",message:"Empty historical version feature name in EmptySummaryItem.",eventCategory:"Error",eventName:o.CatchUpMissingHistoricalVersioningFeatureNameError}),it.createElement(it.Fragment,null))}),Wt=a(1628),jt=a(403),Lt=a(1790),Bt=a(1415);var Pt=({activity:t,dateFormatter:e,flyoutItemId:a,flyoutStrings:i,hasKeyboardNavStarted:r,onActivityClicked:c,onKeyDown:s,onKeyDownDismissButton:l,updateActivityState:p})=>{it.useEffect(()=>{bt(t.state)||p(t,t.state|v.IsSeen)},[]);const u=it.useCallback(()=>{_t(t.state)||p(t,t.state|v.IsRead),c(t)},[t,c,p]),m=Object(ct.a)(),d=it.useCallback(e=>{e.preventDefault(),e.stopPropagation(),p(t,t.state|v.IsDismissed)},[t,p]);if(!t.actors.length||!t.actors[0])return it.createElement(it.Fragment,null);const C=t.actors[0],g=function(t,e){switch(t.type){case h.Comment:return e.CommentAction;case h.Edit:return e.EditAction;case h.AtMention:return I(t.actors)?e.CatchUpFlyoutSelfMentionItem:e.CatchUpFlyoutMentionItem;case h.Reply:return e.CatchUpFlyoutCommentReplyItem;case h.Restore:return e.RestoreAction;case h.TaskAssign:return I(t.actors)?e.CatchUpFlyoutSelfAssignedTaskItem:e.CatchUpFlyoutAssignTaskItem;case h.TaskReassign:case h.TaskReopen:case h.TaskComplete:{const i=t;switch(t.type){case h.TaskReassign:return i.relationship===y.TaskCreator?e.CatchUpFlyoutReassignTaskUserCreatedItem:e.CatchUpFlyoutReassignTaskItem;case h.TaskReopen:return i.relationship===y.TaskCreator?e.CatchUpFlyoutCreatedTaskReopenedItem:((a=i.relationship)===y.NewAssignee||a===y.ExistingAssignee||n.logTraceTag(507105998,{level:"Warning",message:`Unhandled TaskReopen case. Relationship: ${i.relationship}.`,eventCategory:"Generic",eventName:o.CatchUpUnhandledTaskReopenCase}),e.CatchUpFlyoutReopenTaskItem);case h.TaskComplete:return i.relationship===y.TaskCreator?e.CatchUpFlyoutCompleteTaskUserCreatedItem:e.CatchUpFlyoutCompleteTaskItem;default:return e.CatchUpFlyoutOnePersonChange}}case h.TaskReply:return e.CatchUpFlyoutReplyToTaskItem;case h.WordCommentReaction:{const a=t.reactionCounts.reduce((t,e)=>{var a;return t+(null!==(a=null==e?void 0:e.count)&&void 0!==a?a:0)},0);return 1===a?e.CatchUpFlyoutCommentReactionItemOnePerson:2===a?e.CatchUpFlyoutCommentReactionItemTwoPeople:e.CatchUpFlyoutCommentReactionItemMultiplePeople.replace("{1}",(a-1).toString())}case h.CommentReaction:{const a=t.emojiCounts.reduce((t,e)=>{var a;return t+(null!==(a=null==e?void 0:e.count)&&void 0!==a?a:0)},0);return 1===a?e.CatchUpFlyoutCommentReactionItemOnePerson:2===a?e.CatchUpFlyoutCommentReactionItemTwoPeople:e.CatchUpFlyoutCommentReactionItemMultiplePeople.replace("{1}",(a-1).toString())}default:return n.logTraceTag(507105997,{level:"Warning",message:"Invalid activity type provided when generating relevant item string",eventCategory:"Generic",eventName:o.CatchUpInvalidActivityTypeForItemString}),e.CatchUpFlyoutOnePersonChange}var a}(t,i),E=!_t(t.state),T={showFocus:r,contextPreviewLines:1},U=t=>a+t,F=U("Action"),A=U("Time"),_=U("Dot"),b=U("DismissButton"),w=[F,A,_].join(" "),S=Object(dt.g)(m);return it.createElement("div",{id:U("Container")},it.createElement("button",{id:a,type:"button",onKeyDown:s,className:Object(dt.d)(m,T).button,onClick:u,"aria-labelledby":w},it.createElement("div",{className:S.cornerControls},it.createElement("div",{className:S.newDotContainer},E&&it.createElement("span",{id:_,className:S.newDot+" newDot","aria-label":i.CatchUpFlyoutNewDotA11yLabel,role:"img"})),function(t,e=!1){if(!t||!t.displayName)return it.createElement(it.Fragment,null);const a=t.color||t.id&&function(t){let e=0;for(let a=0;a<t.length;a+=1)e+=t.charCodeAt(a);const a=["#d47800","#3834d1","#981788","#058249","#8c00e3","#1050ca","#878303","#0b6f98","#2c26a4","#ed6b4f","#b339c2","#393939","#0b6a0b","#b86487","#1c0b75","#74757a","#912e5c","#7e7969","#705b00","#2e568e"];return a[e%a.length]}(t.id);return it.createElement(Bt.a,{coinSize:e?20:24,initialsColor:a||void 0,hidePersonaDetails:!0,imageInitials:Object(Lt.a)(t.displayName,!1),imageShouldStartVisible:!0,imageUrl:t.imageUrl||void 0,showInitialsUntilImageLoads:!0})}(C)),it.createElement("div",{className:S.textContents},it.createElement("div",{id:F,className:S.inlineText},function(t,e,a,i=!1){if(!e.displayName)return n.logTraceTag(560215314,{level:"Error",message:"Missing display name rendering action element.",eventCategory:"Error",eventName:o.CatchUpMissingDisplayNameError}),[];let r=e.displayName;return i&&e.givenName&&(r=e.givenName),Object(f.a)(t,t=>(t=>it.createElement("span",{key:t,dir:"auto",className:a},r))(t))}(g,C,S.actorNameText)||i.ActivityNotificationText),it.createElement("div",{id:A,className:S.timeStamp},function(t,e){return e(new Date(t.displayTimestamp))}(t,e))),it.createElement("div",{className:S.dismissButtonContainer},it.createElement(Wt.a,{content:i.CatchUpFlyoutDismissIconTooltipLabel},it.createElement(jt.a,{id:b,className:"dismissButton",styles:Object(dt.c)(m),iconProps:{iconName:"Cancel"},onClick:d,onKeyDown:l})))))},Ht=a(1416),Zt=a(0);const Vt=Object(Zt.a)("CatchUp20Regular","20",["M7.45 7.27a.5.5 0 0 1 .91.04l2.35 5.76a1.5 1.5 0 0 0 2.73.11l1.23-2.4a.5.5 0 0 1 .44-.28h.98a1.5 1.5 0 1 0 0-1h-.98a1.5 1.5 0 0 0-1.33.82l-1.23 2.4a.5.5 0 0 1-.91-.03L9.29 6.93a1.5 1.5 0 0 0-2.73-.11l-1.23 2.4a.5.5 0 0 1-.44.28H3.9a1.5 1.5 0 1 0 0 1h.98a1.5 1.5 0 0 0 1.33-.82l1.23-2.4Z"]);var Gt,qt=({displayChangesCheckboxId:t,flyoutItemId:e,flyoutStrings:a,hasKeyboardNavStarted:i,isDisplayChangesChecked:r,onDisplayChangesClicked:c,onKeyDown:s,onSummaryItemClicked:l,shouldShowDisplayChangesCheckbox:p,summaryText:u})=>{const m=Object(ct.a)(),d=it.useCallback((t,e)=>{c(null!=e&&e)},[c]);if(!u)return n.logTraceTag(560215316,{level:"Error",message:"Missing string resource in SummaryItem.",eventCategory:"Error",eventName:o.CatchUpMissingSummaryItemStringError}),it.createElement(it.Fragment,null);const C=e+"Text",h={showFocus:i,contextPreviewLines:1},y=Object(dt.g)(m);return it.createElement("div",{className:y.summaryItemContainer},it.createElement("div",{className:y.summaryItemTitle},a.CatchUpFlyoutSummaryFooterTitleString),it.createElement("button",{id:e,type:"button",onKeyDown:s,className:Object(dt.d)(m,h).summaryItemButton,onClick:l,"data-unique-id":"summary-item","aria-labelledby":C},it.createElement("div",{className:y.summaryItemIcon},it.createElement(Vt,{className:"summaryIcon",primaryFill:Object(dt.a)().catchupContentColor})),it.createElement("div",{id:C,className:y.summaryTextContents},it.createElement("div",{className:y.inlineText},u))),p&&it.createElement("div",{onKeyDown:s},it.createElement(Ht.a,{id:t,label:a.CatchUpDisplayChanges,styles:Object(dt.b)(m,r),checked:r,onChange:d})))};!function(t){t[t.ListItem=0]="ListItem",t[t.DismissButton=1]="DismissButton",t[t.FocusableElementsPerItem=2]="FocusableElementsPerItem"}(Gt||(Gt={}));const Kt={heightOfItems:48,numberOfItems:5};function zt(t){return"flyoutItem"+t}function Jt(t,e){return t}function $t(t){const e=t.element===Gt.DismissButton?"DismissButton":"";return zt(t.index)+e}const Yt=({anchorTarget:t,dateFormatter:e,eventCallbacks:a,flyoutData:i,flyoutStrings:n,shouldShowAsNotification:o})=>{const[r,c]=it.useState({element:Gt.ListItem,index:-1}),s=it.useCallback(e=>{var n;const o=[wt.a.down,wt.a.end,wt.a.enter,wt.a.escape,wt.a.f6,wt.a.home,wt.a.space,wt.a.tab,wt.a.up,wt.a.left,wt.a.right],s=null!==(n=e.keyCode)&&void 0!==n?n:e.which;if(-1===o.indexOf(s))return;if(s===wt.a.escape){const e=document.querySelector(t);return void(e&&e.focus())}let l=function(t){const{relevantActivities:e,summaryItemText:a}=t;return e.length+(a?1:0)}(i);l+=!i.summaryItemText&&a.shouldShowEmptyExperienceButton()?1:0,l+=i.summaryItemText&&a.shouldShowDisplayChangesCheckbox()?1:0;const p=t=>{const e=t?1:-1;c({element:(r.element+Gt.FocusableElementsPerItem+e)%Gt.FocusableElementsPerItem,index:r.index})};switch(s){case wt.a.down:c({element:Gt.ListItem,index:(r.index+1)%l});break;case wt.a.up:{const t=-1===r.index?0:(r.index+l-1)%l;c({element:Gt.ListItem,index:t});break}case wt.a.home:c({element:Gt.ListItem,index:0});break;case wt.a.end:c({element:Gt.ListItem,index:l-1});break;case wt.a.space:case wt.a.enter:{const t=document.getElementById($t(r));t&&t.click();break}case wt.a.f6:return void(-1===r.index&&c({element:Gt.ListItem,index:0}));case wt.a.tab:p(!e.shiftKey);break;case wt.a.left:p(!1);break;case wt.a.right:p(!0)}e.preventDefault(),e.stopPropagation()},[t,a,i,r]),l=it.useCallback(t=>{var e;const a=null!==(e=t.keyCode)&&void 0!==e?e:t.which;a!==wt.a.enter&&a!==wt.a.space||c({element:Gt.ListItem,index:r.index-1<0?0:r.index-1})},[r]),p=it.useCallback((t,i)=>t.map((t,o)=>it.createElement(Pt,{activity:t,dateFormatter:e,flyoutItemId:zt(i+o),flyoutStrings:n,hasKeyboardNavStarted:r.index>-1,key:t.activityId||"",onActivityClicked:a.onActivityClicked,onKeyDown:s,onKeyDownDismissButton:l,updateActivityState:a.updateActivityState})),[e,a,n,r,s,l]),u=it.useCallback((t,e)=>it.createElement(qt,{displayChangesCheckboxId:zt(e+1),flyoutItemId:zt(e),flyoutStrings:n,hasKeyboardNavStarted:r.index>-1,isDisplayChangesChecked:a.isDisplayChangesChecked(),key:"SummaryItemId",onDisplayChangesClicked:a.onDisplayChangesClicked,onKeyDown:s,onSummaryItemClicked:a.onSummaryTextClicked,shouldShowDisplayChangesCheckbox:a.shouldShowDisplayChangesCheckbox(),summaryText:t}),[a,n,r,s]),m=it.useCallback(()=>{const{getEmptyExperienceCommandName:t,onEmptyCatchUpExperienceClick:e,shouldShowEmptyExperienceButton:o}=a,{relevantActivities:r,summaryItemText:c}=i,l=[];let m=0;r.length>0&&(l.push(...p(r,m)),m+=r.length);const d=Object(dt.f)(Kt),C=it.createElement("div",{id:"catchUpFlyoutContainer",className:d.listContainer,"data-is-scrollable":!0},it.createElement(St.a,{"aria-label":n.CatchUpFlyoutListA11yLabel,className:d.list,id:"catch-up-flyout-list",items:l,onKeyDown:s,onRenderCell:Jt}));let h;h=0===m?it.createElement(Dt,{firstFocusElementId:"empty-activities-for-you-item",flyoutStrings:n,onKeyDown:s}):C;const y=o()?it.createElement(Ot,{flyoutStrings:n,historicalVersionFeatureName:t(),linkId:zt(m),onClick:e,onKeyDown:s}):it.createElement(it.Fragment,null),g=c?u(c,m):y;return it.createElement(it.Fragment,null,h,g)},[a,i,n,s,p,u]);it.useEffect(()=>{const t=document.getElementById($t(r));t&&t.focus()},[r]);const{dismissCatchUpFlyout:d,onNotificationShown:C}=a,h={"aria-roledescription":o?n.Notification:void 0,directionalHint:ot.a.bottomRightEdge,isBeakVisible:!0,onDismiss:d,preventDismissOnScroll:!0,setInitialFocus:!o,preventDismissOnLostFocus:!1},y=function(t){return 0===t.relevantActivities.length}(i)?"#empty-activities-for-you-item":"#catch-up-flyout-list",g=it.createElement("div",null,it.createElement(kt.a,{actionableAnnouncement:o?n.Actionable:void 0,calloutProps:h,contentRendererFunction:m,"data-unique-id":"CatchUpFlyout",firstFocusElement:y,hasDynamicSizing:!0,styles:Object(dt.e)(o),target:t,title:n.CatchUpFlyoutActivitiesForYouTitleString}));return o?it.createElement(Nt.a,{isActionable:!0,onShow:C,telemetryId:"CatchUpFlyout"},g):g};function Qt(t){const e=(new Date).getTime()-t.getTime();return e<0?-1:e}function Xt(t,e,a){return te.apply(this,arguments)}function te(){return(te=_async_to_generator((function*(t,e,a){e||a||n.logTraceTag(559436958,{level:"Error",message:"No activity provided when clicking on item in the flyout",eventCategory:"Error",eventName:o.CatchUpNoActivityForItemClickError});const i=yield t.navigateToActivity({activity:e,fromSummaryString:a});return!(!i||i!==C.Success)||(n.logTraceTag(595637663,{level:"Warning",message:`Failed to navigate to ${e?"activity":"undefined"}, result=${i}.`,eventCategory:"Generic",eventName:o.CatchUpNavToItemFailed}),!1)}))).apply(this,arguments)}function ee(){return(ee=_async_to_generator((function*(t,e){return!!(yield t.toggleShowingChanges({shouldShowChanges:e}))||(n.logTraceTag(508609745,{level:"Warning",message:`Failed to toggle showing changes. Attempted to ${e?"show":"hide"} changes`,eventCategory:"Generic",eventName:o.CatchUpDisplayRecentChanges}),!1)}))).apply(this,arguments)}const ae=({catchUpFlyoutData:t,dateFormatter:e,featureGateAPI:a,flyoutFocus:c,flyoutRibbonButton:s,flyoutStrings:u,logUserAction:m,navigationManager:d,recentChangesManager:C,sendActivityUpdate:h,options:y})=>{var g;const f=s(),E=c(),T=d(),U=C(),F=a(),[I,A]=it.useState(t),[_,b]=it.useState(!1),[w,S]=it.useState(!1),[k,N]=it.useState(!1),[R,M]=it.useState(new Date),[D,x]=it.useState(!1),O=y.anchorTarget?y.anchorTarget.includes("Badge")?"Badge":"InPage":"Unknown";it.useEffect(()=>{A(t)},[t]),it.useEffect(()=>{l(F),b(!0),f.onFlyoutInitialized({}),f.registerButtonClickedEvent({buttonClickedCallback:()=>{!function(t,e){t?n.logTraceTag(595638497,{level:"Info",message:JSON.stringify({msg:"CatchUpFlyout is requested to be dismissed.",anchorTarget:e}),eventCategory:"Generic",eventName:o.CatchUpFlyoutDismissedCalled}):n.logTraceTag(595638496,{level:"Info",message:JSON.stringify({msg:"CatchUpFlyout is requested to be rendered.",anchorTarget:e}),eventCategory:"Generic",eventName:o.CatchUpFlyoutRenderCalled})}(w,O),S(t=>!t)},closeFlyoutCallback:()=>{}});const t=function(t){return t.relevantActivities.length>0||t.summaryItemText.length>0}(I);f.logFlightTriggers({hasFlyoutData:t}),function(t){return t.relevantActivities.filter(t=>!bt(t.state)).length>0}(I)&&(n.logTraceTag(508150113,{level:"Info",message:"Catch-up flyout auto-shown on document open.",eventCategory:"Generic",eventName:o.CatchUpFlyoutAutoShown}),N(!0),S(!0))},[]);const W=it.useCallback(()=>!!_&&w,[_,w]),j=it.useCallback(()=>{S(!1)},[]),L=it.useCallback(()=>{const t=W();t&&M(new Date),t?null==E||E.enableF6Focus({}):null==E||E.disableF6Focus({}),f.onFlyoutVisibilityChanged({flyoutIsVisible:t})},[E,f,W]);it.useEffect(()=>{_&&(w&&k&&function(){if(r)return;const t=i.getEntriesByType("mark"),e=function(t){let e=-1;for(let a=t.length-1;a>=0;a-=1)if("CatchUpInit.Begin"===t[a].name){e=a;break}return e}(t);if(-1===e)return;const a=function(t){const e=new Array;let a=t[0];for(let i=1;i<t.length;i+=1){const n=t[i];0===n.name.indexOf("CatchUpInit.")&&(e.push({start:a.name.split(".")[1],end:n.name.split(".")[1],duration:Math.round(n.startTime-a.startTime)}),a=n)}return e}(t.slice(e));0!==a.length&&(n.logTraceTag(592717845,{level:"Info",message:JSON.stringify(a),eventCategory:"Generic",eventName:o.CatchUpInitTimeline}),r=!0)}(),w&&!k&&m("CatchUpActiveAwarenessSession"),!w&&k&&N(!1),k&&w||L())},[w]),it.useEffect(()=>{var t;null!=U&&U.shouldShowDisplayChangesCheckbox()&&(null==U||null===(t=U.shouldDisplayChangesBeInitiallyChecked())||void 0===t||t.then(t=>{x(t)}).catch(()=>{}))},[U]);const B={anchorTarget:null!==(g=y.anchorTarget)&&void 0!==g?g:"button[data-unique-id*='CatchUpWithChanges']",eventCallbacks:{onActivityClicked:(P=_async_to_generator((function*(t){j(),yield Xt(T,t,!1),function(t,e,a,i){n.logTraceTag(595638498,{level:"Info",message:JSON.stringify({msg:"RelevantToMeItem is clicked.",activityIndex:Object(p.e)(t.relevantActivities,t=>t.activityId===e.activityId),activityFeedItemId:e.activityFeedItemId,activityState:e.state,activityTimestamp:e.displayTimestamp,activityType:e.type,flyoutShowTimeMs:Qt(a),anchorTarget:i}),eventCategory:"Generic",eventName:o.CatchUpRelevantToMeItemClicked})}(I,t,R,O),m("CatchUpActiveAwarenessSession")})),function(t){return P.apply(this,arguments)}),onSummaryTextClicked:_async_to_generator((function*(){j(),yield Xt(T,I.summaryNavActivity,!0),function(t,e){n.logTraceTag(595637976,{level:"Info",message:JSON.stringify({msg:"Summary text is clicked.",authorCount:t.authorCount,changesCount:t.catchUpActivitiesCount,flyoutShowTimeMs:Qt(e)}),eventCategory:"Generic",eventName:o.CatchUpSummaryTextClicked})}(I,R),m("CatchUpActiveAwarenessSession")})),dismissCatchUpFlyout:j,onNotificationShown:L,updateActivityState:function(){var t=_async_to_generator((function*(t,e){var a,i;a=t,i=e,n.logTraceTag(508899914,{level:"Info",message:JSON.stringify({msg:"Updating activity state.",newState:i,oldState:a.state,activityType:a.type}),eventCategory:"Generic",eventName:o.CatchUpActivityStateUpdated}),(yield h(t,e))&&A(a=>function(t){const{relevantActivities:e}=t;return _object_spread_props(_object_spread({},t),{relevantActivities:e.filter(t=>!((t.state&v.IsDismissed)===v.IsDismissed))})}(function(t,e,a){const i=t.relevantActivities.map(t=>e.activityId!==t.activityId?_object_spread({},t):_object_spread_props(_object_spread({},t),{state:a}));return _object_spread_props(_object_spread({},t),{relevantActivities:i})}(a,t,e)))}));return function(e,a){return t.apply(this,arguments)}}(),shouldShowEmptyExperienceButton:()=>{var t,e;return null!==(t=null===(e=y.emptyCatchUpBehavior)||void 0===e?void 0:e.shouldShowEmptyExperienceButton())&&void 0!==t&&t},onEmptyCatchUpExperienceClick:t=>{var e;t.stopPropagation(),j(),n.logTraceTag(553657312,{level:"Info",message:"Empty experience button pressed.",eventCategory:"Generic",eventName:o.CatchUpEmptyExperienceButtonClicked}),null===(e=y.emptyCatchUpBehavior)||void 0===e||e.onButtonClick()},getEmptyExperienceCommandName:()=>{var t,e;return null!==(t=null===(e=y.emptyCatchUpBehavior)||void 0===e?void 0:e.getCommandName())&&void 0!==t?t:""},onDisplayChangesClicked:function(){var t=_async_to_generator((function*(t){U&&(yield function(t,e){return ee.apply(this,arguments)}(U,t))&&(x(t),function(t){const e=t?"shown":"hidden";n.logTraceTag(508614083,{level:"Info",message:JSON.stringify({msg:"Recent changes are "+e}),eventCategory:"Generic",eventName:o.CatchUpSummaryTextClicked})}(t))}));return function(e){return t.apply(this,arguments)}}(),shouldShowDisplayChangesCheckbox:()=>{var t;return null!==(t=null==U?void 0:U.shouldShowDisplayChangesCheckbox())&&void 0!==t&&t},isDisplayChangesChecked:()=>D},flyoutData:I,dateFormatter:e,flyoutStrings:u,shouldShowAsNotification:k};var P;return W()?it.createElement(At,null,it.createElement(Yt,_object_spread({},B))):it.createElement(it.Fragment,null)};class ie{isChangeGateEnabled(t){return Object(O.g)("CatchUpOfficeOnlineDisabledChangeGates",t)}isFeatureGateEnabled(t,e=!1){return Object(O.h)(t,e)}}function ne(){return new ie}var oe=a(2573);function re(){Object(oe.a)(),Object(ut.ib)({icons:{EmptyFlyoutColorfulIllustration:it.createElement("svg",{width:"45",height:"46",viewBox:"0 0 45 46",fill:"none",xmlns:"http://www.w3.org/2000/svg"},it.createElement("path",{d:"M16.875 45.5C26.1948 45.5 33.75 37.9448 33.75 28.625C33.75 19.3052 26.1948 11.75 16.875 11.75C7.55519 11.75 0 19.3052 0 28.625C0 37.9448 7.55519 45.5 16.875 45.5Z",fill:"#FFE5B9"}),it.createElement("path",{d:"M17.2406 27.5281H16.2C11.8406 27.5281 8.29688 23.9844 8.29688 19.625V18.2469C8.29688 13.8875 11.8406 10.3438 16.2 10.3438H17.2406C21.6 10.3438 25.1438 13.8875 25.1438 18.2469V19.625C25.1438 23.9844 21.6 27.5281 17.2406 27.5281Z",fill:"#BF8F68"}),it.createElement("path",{d:"M16.875 45.5C24.8344 45.5 31.5 39.9875 33.2719 32.5906C33.2157 31.6625 33.1031 30.7625 32.5406 29.7219C31.3032 27.4719 29.1094 27.2188 27.4219 25.0813C25.7344 22.9719 25.1438 18.2188 25.1438 18.2188H8.2969C8.2969 18.2188 7.65002 22.9719 6.01877 25.1375C4.38752 27.3031 2.36252 27.0781 1.2094 29.3281C0.646899 30.3969 0.534399 31.4656 0.478149 32.5625C2.25002 39.9875 8.91565 45.5 16.875 45.5Z",fill:"#BF8F68"}),it.createElement("path",{d:"M26.6906 39.1999C25.3688 34.2218 21.9938 32.1124 21.9938 32.1124V32.1405C20.5031 31.0155 18.675 30.3687 16.65 30.3687C14.6531 30.3687 12.7969 31.0437 11.3344 32.1405C11.0813 32.3093 7.93127 34.4468 6.66565 39.1999C6.52502 39.7343 6.3844 40.6062 6.24377 41.703C9.14065 44.0655 12.825 45.4999 16.875 45.4999C20.7563 45.4999 24.3 44.2062 27.1406 42.0124C27 40.7749 26.8313 39.7905 26.6906 39.1999Z",fill:"#F7B548"}),it.createElement("path",{d:"M16.65 30.3408C15.0469 30.3408 13.5281 30.7908 12.2344 31.5502C12.2344 31.5502 12.2344 33.4908 14.175 33.4908H19.2656C20.3344 33.4908 21.1781 32.6752 21.2063 31.6064C19.8563 30.8189 18.3094 30.3408 16.65 30.3408Z",fill:"#F9DDBF"}),it.createElement("path",{d:"M19.2656 30.7345C19.2656 30.7345 18.6469 30.397 18.6469 29.722C18.6469 29.1876 18.6469 25.4751 18.6469 25.4751H14.6531C14.6531 25.4751 14.6531 28.6813 14.6531 29.3001C14.6531 30.3688 13.9219 30.7907 13.9219 30.7907L19.2656 30.7345Z",fill:"url(#paint0_radial_5009_223248)"}),it.createElement("path",{d:"M16.7062 27.3874H16.6218C13.6406 27.3874 11.2218 24.9687 11.2218 21.9874V19.7374C11.2218 16.7562 13.6406 14.3374 16.6218 14.3374H16.7062C19.6874 14.3374 22.1062 16.7562 22.1062 19.7374V21.9874C22.1062 24.9687 19.6874 27.3874 16.7062 27.3874Z",fill:"#F9DDBF"}),it.createElement("path",{d:"M22.1625 23.197H20.6719V20.4126H22.1625C22.9219 20.4126 23.5688 21.0313 23.5688 21.8188C23.5406 22.5782 22.9219 23.197 22.1625 23.197Z",fill:"#F9DDBF"}),it.createElement("path",{d:"M11.1656 23.197H12.6563V20.4126H11.1656C10.4063 20.4126 9.7594 21.0313 9.7594 21.8188C9.7594 22.5782 10.3781 23.197 11.1656 23.197Z",fill:"#F9DDBF"}),it.createElement("path",{d:"M16.4249 25.1094H12.7687V18.5H16.4249V25.1094Z",fill:"url(#paint1_radial_5009_223248)"}),it.createElement("path",{d:"M14.2031 21.9313C14.4672 21.9313 14.6812 21.5284 14.6812 21.0313C14.6812 20.5343 14.4672 20.1313 14.2031 20.1313C13.939 20.1313 13.725 20.5343 13.725 21.0313C13.725 21.5284 13.939 21.9313 14.2031 21.9313Z",fill:"#33312D"}),it.createElement("path",{d:"M18.8437 21.9313C19.1078 21.9313 19.3218 21.5284 19.3218 21.0313C19.3218 20.5343 19.1078 20.1313 18.8437 20.1313C18.5797 20.1313 18.3656 20.5343 18.3656 21.0313C18.3656 21.5284 18.5797 21.9313 18.8437 21.9313Z",fill:"#33312D"}),it.createElement("path",{d:"M16.425 24.1814C16.3687 23.6189 15.75 23.3658 15.4968 23.1127C15.3843 23.0002 15.3562 22.8314 15.4687 22.6908C15.7781 22.2971 16.2843 21.8189 16.425 20.2158C16.7062 20.7502 17.4093 22.9158 16.425 24.1814Z",fill:"#F9DDBF"}),it.createElement("path",{d:"M21.9375 14C23.4281 17.4875 24.1312 19.7656 24.1031 19.9906C23.5406 20.2719 22.95 20.4406 22.275 20.4406C21.2344 20.4406 20.3344 20.1031 19.575 19.4C18.8156 18.6969 18.4219 17.375 18.3656 16.3625H14.9906C14.9344 17.375 14.5406 18.6969 13.7812 19.4C13.0219 20.1031 12.1219 20.4406 11.0813 20.4406C10.3781 20.4406 9.73125 20.2719 9.14062 19.9344C9.14062 19.8219 9.53437 18.4438 10.35 16.6438L11.5594 14H21.9375Z",fill:"#BF8F68"}),it.createElement("path",{d:"M16.7062 16.3625H15.0187C15.0187 15.9125 15.3843 15.5469 15.8343 15.5469H15.8906C16.3406 15.5469 16.7062 15.9125 16.7062 16.3625Z",fill:"#9B643D"}),it.createElement("path",{d:"M18.3937 16.3625H16.7062C16.7062 15.9125 17.0718 15.5469 17.5218 15.5469H17.5781C18.0281 15.5469 18.3937 15.9125 18.3937 16.3625Z",fill:"#9B643D"}),it.createElement("path",{d:"M16.7063 16.3625H13.8375V11.1875H16.7063V16.3625Z",fill:"url(#paint2_radial_5009_223248)"}),it.createElement("path",{opacity:"0.5",d:"M16.0312 24.8564C16.2281 24.8282 16.3969 24.8001 16.5375 24.8001C16.7062 24.772 16.8187 24.7439 16.9594 24.7157C17.0719 24.6876 17.1843 24.6314 17.325 24.5751C17.4656 24.5189 17.5781 24.4064 17.7468 24.322H17.775C17.8312 24.2939 17.9437 24.2939 17.9719 24.3782C18 24.4064 18 24.4345 18 24.4626C18 24.6876 17.9437 24.9126 17.775 25.0814C17.6344 25.2782 17.4093 25.4189 17.1843 25.4751C16.9593 25.5314 16.7062 25.5314 16.5094 25.4751C16.2844 25.4189 16.1156 25.3064 15.9469 25.1376C15.8906 25.0814 15.8906 24.997 15.9469 24.9407C15.975 24.8845 16.0031 24.8845 16.0312 24.8564Z",fill:"#BF8F68"}),it.createElement("path",{d:"M36.7875 0.5H28.4625C23.9344 0.5 20.25 4.18438 20.25 8.7125V10.5406C20.25 14.9563 23.7375 18.5562 28.0969 18.7531C27.9563 20.0188 27.3938 21.1437 26.5781 22.0437C28.8 21.9594 30.6844 20.6656 31.6125 18.7531H36.7875C41.3156 18.7531 45 15.0688 45 10.5406V8.7125C45 4.18438 41.3156 0.5 36.7875 0.5Z",fill:"#006BFF"}),it.createElement("path",{d:"M34.1719 11.4404H34.1438C33.8063 12.4811 33.1031 13.0154 32.0906 13.0154C31.4438 13.0154 30.9094 12.7623 30.5157 12.2842C30.1219 11.8061 29.925 11.1311 29.925 10.3154C29.925 9.21855 30.2063 8.29043 30.7407 7.58731C31.3032 6.85606 32.0063 6.49043 32.9063 6.49043C33.2438 6.49043 33.5532 6.5748 33.8344 6.77168C34.1157 6.96855 34.2844 7.19356 34.3406 7.44668H34.3688C34.3688 7.39043 34.3969 7.27793 34.3969 7.1373C34.425 6.82793 34.7063 6.60293 35.0156 6.60293C35.3813 6.60293 35.6625 6.9123 35.6344 7.27793C35.4375 9.41543 35.3531 10.4842 35.3531 10.5404C35.3531 11.4967 35.6063 12.0029 36.1125 12.0029C36.5625 12.0029 36.9563 11.7217 37.2656 11.1873C37.575 10.6529 37.7157 9.9498 37.7157 9.07793C37.7157 7.8123 37.2938 6.77168 36.4781 5.95605C35.6625 5.14043 34.5375 4.74668 33.075 4.74668C31.6969 4.74668 30.5438 5.2248 29.6157 6.20918C28.6875 7.19355 28.2375 8.40293 28.2375 9.86543C28.2375 11.2998 28.6875 12.4811 29.5594 13.3529C30.4313 14.2248 31.6125 14.6748 33.1031 14.6748C33.975 14.6748 34.7625 14.5623 35.4375 14.3373C35.775 14.2248 36.1125 14.4779 36.1125 14.8436C36.1125 15.0686 35.9719 15.2654 35.7469 15.3498C34.9594 15.6311 34.0032 15.7436 32.9063 15.7436C31.1063 15.7436 29.6719 15.2092 28.575 14.1404C27.4781 13.0717 26.9156 11.6654 26.9156 9.92168C26.9156 8.12168 27.5063 6.65918 28.6594 5.47793C29.8125 4.29668 31.3031 3.70605 33.1031 3.70605C34.7906 3.70605 36.1969 4.21231 37.3219 5.19668C38.4188 6.18106 38.9813 7.4748 38.9813 9.0498C38.9813 10.2029 38.6719 11.1592 38.0813 11.9186C37.4906 12.6498 36.7313 13.0436 35.8594 13.0436C34.7344 13.0154 34.1719 12.4811 34.1719 11.4404ZM32.6813 7.8123C32.2031 7.8123 31.8094 8.0373 31.5281 8.51543C31.2469 8.99355 31.0782 9.58418 31.0782 10.2873C31.0782 10.7654 31.1906 11.1311 31.3875 11.4123C31.5844 11.6936 31.8375 11.8342 32.175 11.8342C32.6532 11.8342 33.0469 11.5811 33.3 11.1029C33.5813 10.5967 33.7219 9.94981 33.7219 9.13418C33.7219 8.23418 33.3844 7.8123 32.6813 7.8123Z",fill:"white"}),it.createElement("defs",null,it.createElement("radialGradient",{id:"paint0_radial_5009_223248",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(16.6695 25.6273) rotate(180) scale(4.09067 4.39714)"},it.createElement("stop",{"stop-color":"#9A6541","stop-opacity":"0.8471"}),it.createElement("stop",{offset:"0.225","stop-color":"#BB8E6C","stop-opacity":"0.8815"}),it.createElement("stop",{offset:"0.45","stop-color":"#D6B090","stop-opacity":"0.9159"}),it.createElement("stop",{offset:"0.6603","stop-color":"#E9C9AA","stop-opacity":"0.948"}),it.createElement("stop",{offset:"0.8497","stop-color":"#F5D8BA","stop-opacity":"0.977"}),it.createElement("stop",{offset:"1","stop-color":"#F9DDBF"})),it.createElement("radialGradient",{id:"paint1_radial_5009_223248",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(16.4775 22.7571) scale(2.24932)"},it.createElement("stop",{"stop-color":"#9A6541","stop-opacity":"0.8471"}),it.createElement("stop",{offset:"1","stop-color":"#F9DDBF","stop-opacity":"0"})),it.createElement("radialGradient",{id:"paint2_radial_5009_223248",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(19.6057 16.8978) scale(5.88715)"},it.createElement("stop",{"stop-color":"#5C2C07","stop-opacity":"0.8471"}),it.createElement("stop",{offset:"1","stop-color":"#BE906B","stop-opacity":"0"})))),EmptyFlyoutDarkIllustration:it.createElement("svg",{width:"45",height:"46",viewBox:"0 0 45 46",fill:"none",xmlns:"http://www.w3.org/2000/svg"},it.createElement("g",{"clip-path":"url(#clip0_4983_223723)"},it.createElement("path",{d:"M16.875 45.5C26.1948 45.5 33.75 37.9448 33.75 28.625C33.75 19.3052 26.1948 11.75 16.875 11.75C7.55519 11.75 0 19.3052 0 28.625C0 37.9448 7.55519 45.5 16.875 45.5Z",fill:"#33312D"}),it.createElement("path",{d:"M17.2406 27.5281H16.2C11.8406 27.5281 8.29688 23.9844 8.29688 19.625V18.2469C8.29688 13.8875 11.8406 10.3438 16.2 10.3438H17.2406C21.6 10.3438 25.1438 13.8875 25.1438 18.2469V19.625C25.1438 23.9844 21.6 27.5281 17.2406 27.5281Z",fill:"#594539"}),it.createElement("path",{d:"M16.875 45.5C24.8344 45.5 31.5 39.9875 33.2719 32.5906C33.2157 31.6625 33.1031 30.7625 32.5406 29.7219C31.3032 27.4719 29.1094 27.2188 27.4219 25.0813C25.7344 22.9719 25.1438 18.2188 25.1438 18.2188H8.2969C8.2969 18.2188 7.65002 22.9719 6.01877 25.1375C4.38752 27.3031 2.36252 27.0781 1.2094 29.3281C0.646899 30.3969 0.534399 31.4656 0.478149 32.5625C2.25002 39.9875 8.91565 45.5 16.875 45.5Z",fill:"#594539"}),it.createElement("path",{d:"M26.6906 39.2C25.3688 34.2219 21.9938 32.1125 21.9938 32.1125V32.1407C20.5031 31.0157 18.675 30.3688 16.65 30.3688C14.6531 30.3688 12.7969 31.0438 11.3344 32.1407C11.0813 32.3094 7.93127 34.4469 6.66565 39.2C6.52502 39.7344 6.3844 40.6063 6.24377 41.7031C9.14065 44.0656 12.825 45.5 16.875 45.5C20.7563 45.5 24.3 44.2063 27.1406 42.0125C27 40.775 26.8313 39.7907 26.6906 39.2Z",fill:"#797673"}),it.createElement("path",{d:"M16.65 30.3406C15.0469 30.3406 13.5281 30.7906 12.2344 31.55C12.2344 31.55 12.2344 33.4906 14.175 33.4906H19.2656C20.3344 33.4906 21.1781 32.675 21.2063 31.6062C19.8563 30.8187 18.3094 30.3406 16.65 30.3406Z",fill:"#F9DDBF"}),it.createElement("path",{d:"M19.2656 30.7343C19.2656 30.7343 18.6469 30.3968 18.6469 29.7218C18.6469 29.1875 18.6469 25.475 18.6469 25.475H14.6531C14.6531 25.475 14.6531 28.6812 14.6531 29.3C14.6531 30.3687 13.9219 30.7906 13.9219 30.7906L19.2656 30.7343Z",fill:"url(#paint0_radial_4983_223723)"}),it.createElement("path",{d:"M16.7062 27.3875H16.6218C13.6406 27.3875 11.2218 24.9688 11.2218 21.9875V19.7375C11.2218 16.7563 13.6406 14.3375 16.6218 14.3375H16.7062C19.6874 14.3375 22.1062 16.7563 22.1062 19.7375V21.9875C22.1062 24.9688 19.6874 27.3875 16.7062 27.3875Z",fill:"#F9DDBF"}),it.createElement("path",{d:"M22.1625 23.1968H20.6719V20.4125H22.1625C22.9219 20.4125 23.5688 21.0312 23.5688 21.8187C23.5406 22.5781 22.9219 23.1968 22.1625 23.1968Z",fill:"#F9DDBF"}),it.createElement("path",{d:"M11.1656 23.1968H12.6563V20.4125H11.1656C10.4063 20.4125 9.7594 21.0312 9.7594 21.8187C9.7594 22.5781 10.3781 23.1968 11.1656 23.1968Z",fill:"#F9DDBF"}),it.createElement("path",{d:"M16.4249 25.1094H12.7687V18.5H16.4249V25.1094Z",fill:"url(#paint1_radial_4983_223723)"}),it.createElement("path",{d:"M14.2031 21.9312C14.4672 21.9312 14.6812 21.5283 14.6812 21.0312C14.6812 20.5342 14.4672 20.1312 14.2031 20.1312C13.939 20.1312 13.725 20.5342 13.725 21.0312C13.725 21.5283 13.939 21.9312 14.2031 21.9312Z",fill:"#33312D"}),it.createElement("path",{d:"M18.8437 21.9312C19.1078 21.9312 19.3218 21.5283 19.3218 21.0312C19.3218 20.5342 19.1078 20.1312 18.8437 20.1312C18.5797 20.1312 18.3656 20.5342 18.3656 21.0312C18.3656 21.5283 18.5797 21.9312 18.8437 21.9312Z",fill:"#33312D"}),it.createElement("path",{d:"M16.425 24.1812C16.3687 23.6187 15.75 23.3656 15.4968 23.1125C15.3843 23 15.3562 22.8312 15.4687 22.6906C15.7781 22.2968 16.2843 21.8187 16.425 20.2156C16.7062 20.75 17.4093 22.9156 16.425 24.1812Z",fill:"#F9DDBF"}),it.createElement("path",{d:"M21.9375 14C23.4281 17.4875 24.1312 19.7656 24.1031 19.9906C23.5406 20.2719 22.95 20.4406 22.275 20.4406C21.2344 20.4406 20.3344 20.1031 19.575 19.4C18.8156 18.6969 18.4219 17.375 18.3656 16.3625H14.9906C14.9344 17.375 14.5406 18.6969 13.7812 19.4C13.0219 20.1031 12.1219 20.4406 11.0813 20.4406C10.3781 20.4406 9.73125 20.2719 9.14062 19.9344C9.14062 19.8219 9.53437 18.4438 10.35 16.6438L11.5594 14H21.9375Z",fill:"#594539"}),it.createElement("path",{d:"M16.7062 16.3625H15.0187C15.0187 15.9125 15.3843 15.5469 15.8343 15.5469H15.8906C16.3406 15.5469 16.7062 15.9125 16.7062 16.3625Z",fill:"#3A312E"}),it.createElement("path",{d:"M18.3937 16.3625H16.7062C16.7062 15.9125 17.0718 15.5469 17.5218 15.5469H17.5781C18.0281 15.5469 18.3937 15.9125 18.3937 16.3625Z",fill:"#3A312E"}),it.createElement("path",{d:"M16.7063 16.3625H13.8375V11.1875H16.7063V16.3625Z",fill:"url(#paint2_radial_4983_223723)"}),it.createElement("g",{opacity:"0.5"},it.createElement("path",{opacity:"0.5",d:"M16.0312 24.8562C16.2281 24.8281 16.3969 24.8 16.5375 24.8C16.7062 24.7719 16.8187 24.7437 16.9594 24.7156C17.0719 24.6875 17.1843 24.6312 17.325 24.575C17.4656 24.5187 17.5781 24.4062 17.7468 24.3219H17.775C17.8312 24.2937 17.9437 24.2938 17.9719 24.3781C18 24.4063 18 24.4344 18 24.4625C18 24.6875 17.9437 24.9125 17.775 25.0813C17.6344 25.2781 17.4093 25.4188 17.1843 25.475C16.9593 25.5313 16.7062 25.5313 16.5094 25.475C16.2844 25.4188 16.1156 25.3063 15.9469 25.1375C15.8906 25.0813 15.8906 24.9969 15.9469 24.9406C15.975 24.8844 16.0031 24.8844 16.0312 24.8562Z",fill:"#594539"})),it.createElement("path",{d:"M36.7875 0.5H28.4625C23.9344 0.5 20.25 4.18438 20.25 8.7125V10.5406C20.25 14.9563 23.7375 18.5562 28.0969 18.7531C27.9563 20.0188 27.3938 21.1437 26.5781 22.0437C28.8 21.9594 30.6844 20.6656 31.6125 18.7531H36.7875C41.3156 18.7531 45 15.0688 45 10.5406V8.7125C45 4.18438 41.3156 0.5 36.7875 0.5Z",fill:"#5099FF"}),it.createElement("path",{d:"M34.1719 11.4407H34.1438C33.8063 12.4813 33.1031 13.0157 32.0906 13.0157C31.4438 13.0157 30.9094 12.7625 30.5157 12.2844C30.1219 11.8063 29.925 11.1313 29.925 10.3157C29.925 9.2188 30.2063 8.29067 30.7407 7.58755C31.3032 6.8563 32.0063 6.49067 32.9063 6.49067C33.2438 6.49067 33.5532 6.57505 33.8344 6.77192C34.1157 6.9688 34.2844 7.1938 34.3406 7.44692H34.3688C34.3688 7.39067 34.3969 7.27817 34.3969 7.13755C34.425 6.82817 34.7063 6.60317 35.0156 6.60317C35.3813 6.60317 35.6625 6.91255 35.6344 7.27817C35.4375 9.41567 35.3531 10.4844 35.3531 10.5407C35.3531 11.4969 35.6063 12.0032 36.1125 12.0032C36.5625 12.0032 36.9563 11.7219 37.2656 11.1875C37.575 10.6532 37.7157 9.95005 37.7157 9.07817C37.7157 7.81255 37.2938 6.77192 36.4781 5.9563C35.6625 5.14067 34.5375 4.74692 33.075 4.74692C31.6969 4.74692 30.5438 5.22505 29.6157 6.20942C28.6875 7.1938 28.2375 8.40317 28.2375 9.86567C28.2375 11.3 28.6875 12.4813 29.5594 13.3532C30.4313 14.225 31.6125 14.675 33.1031 14.675C33.975 14.675 34.7625 14.5625 35.4375 14.3375C35.775 14.225 36.1125 14.4782 36.1125 14.8438C36.1125 15.0688 35.9719 15.2657 35.7469 15.35C34.9594 15.6313 34.0032 15.7438 32.9063 15.7438C31.1063 15.7438 29.6719 15.2094 28.575 14.1407C27.4781 13.0719 26.9156 11.6657 26.9156 9.92192C26.9156 8.12192 27.5063 6.65942 28.6594 5.47817C29.8125 4.29692 31.3031 3.7063 33.1031 3.7063C34.7906 3.7063 36.1969 4.21255 37.3219 5.19692C38.4188 6.1813 38.9813 7.47505 38.9813 9.05005C38.9813 10.2032 38.6719 11.1594 38.0813 11.9188C37.4906 12.65 36.7313 13.0438 35.8594 13.0438C34.7344 13.0157 34.1719 12.4813 34.1719 11.4407ZM32.6813 7.81255C32.2031 7.81255 31.8094 8.03755 31.5281 8.51567C31.2469 8.9938 31.0782 9.58442 31.0782 10.2875C31.0782 10.7657 31.1906 11.1313 31.3875 11.4125C31.5844 11.6938 31.8375 11.8344 32.175 11.8344C32.6532 11.8344 33.0469 11.5813 33.3 11.1032C33.5813 10.5969 33.7219 9.95005 33.7219 9.13442C33.7219 8.23442 33.3844 7.81255 32.6813 7.81255Z",fill:"#292929"})),it.createElement("defs",null,it.createElement("radialGradient",{id:"paint0_radial_4983_223723",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(16.6695 25.6272) rotate(180) scale(4.09067 4.39714)"},it.createElement("stop",{"stop-color":"#9A6541","stop-opacity":"0.8471"}),it.createElement("stop",{offset:"0.225","stop-color":"#BB8E6C","stop-opacity":"0.8815"}),it.createElement("stop",{offset:"0.45","stop-color":"#D6B090","stop-opacity":"0.9159"}),it.createElement("stop",{offset:"0.6603","stop-color":"#E9C9AA","stop-opacity":"0.948"}),it.createElement("stop",{offset:"0.8497","stop-color":"#F5D8BA","stop-opacity":"0.977"}),it.createElement("stop",{offset:"1","stop-color":"#F9DDBF"})),it.createElement("radialGradient",{id:"paint1_radial_4983_223723",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(16.4775 22.7571) scale(2.24932)"},it.createElement("stop",{"stop-color":"#9A6541","stop-opacity":"0.8471"}),it.createElement("stop",{offset:"1","stop-color":"#F9DDBF","stop-opacity":"0"})),it.createElement("radialGradient",{id:"paint2_radial_4983_223723",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(19.6057 16.8978) scale(5.88715)"},it.createElement("stop",{"stop-color":"#3A312E","stop-opacity":"0.8471"}),it.createElement("stop",{offset:"1","stop-color":"#3A312E","stop-opacity":"0"})),it.createElement("clipPath",{id:"clip0_4983_223723"},it.createElement("rect",{width:"45",height:"45",fill:"white",transform:"translate(0 0.5)"})))),EmptyFlyoutHCIllustration:it.createElement("svg",{width:"45",height:"46",viewBox:"0 0 45 46",fill:"none",xmlns:"http://www.w3.org/2000/svg"},it.createElement("path",{d:"M33.25 28.625C33.25 37.6687 25.9187 45 16.875 45C7.83134 45 0.5 37.6687 0.5 28.625C0.5 19.5813 7.83134 12.25 16.875 12.25C25.9187 12.25 33.25 19.5813 33.25 28.625Z",fill:"white",stroke:"white"}),it.createElement("path",{d:"M17.2406 27.5281H16.2C11.8406 27.5281 8.29688 23.9844 8.29688 19.625V18.2469C8.29688 13.8875 11.8406 10.3438 16.2 10.3438H17.2406C21.6 10.3438 25.1438 13.8875 25.1438 18.2469V19.625C25.1438 23.9844 21.6 27.5281 17.2406 27.5281Z",fill:"black"}),it.createElement("path",{d:"M16.875 45.5C24.8344 45.5 31.5 39.9875 33.2719 32.5906C33.2157 31.6625 33.1031 30.7625 32.5406 29.7219C31.3031 27.4719 29.1094 27.2188 27.4219 25.0813C25.7344 22.9719 25.1438 18.2188 25.1438 18.2188H8.2969C8.2969 18.2188 7.65002 22.9719 6.01877 25.1375C4.38752 27.3031 2.36252 27.0781 1.2094 29.3281C0.646899 30.3969 0.534399 31.4656 0.478149 32.5625C2.25002 39.9875 8.91565 45.5 16.875 45.5Z",fill:"black"}),it.createElement("path",{d:"M26.6906 39.1999C25.3688 34.2218 21.9938 32.1124 21.9938 32.1124V32.1405C20.5031 31.0155 18.675 30.3687 16.65 30.3687C14.6531 30.3687 12.7969 31.0437 11.3344 32.1405C11.0813 32.3093 7.93127 34.4468 6.66565 39.1999C6.52502 39.7343 6.3844 40.6062 6.24377 41.703C9.14065 44.0655 12.825 45.4999 16.875 45.4999C20.7563 45.4999 24.3 44.2062 27.1407 42.0124C27 40.7749 26.8313 39.7905 26.6906 39.1999Z",fill:"white"}),it.createElement("path",{d:"M11.9813 31.1187L11.7344 31.2637L11.7344 31.55L12.2344 31.55C11.7344 31.55 11.7344 31.5502 11.7344 31.5505L11.7344 31.551L11.7344 31.5523L11.7344 31.5553L11.7345 31.5636L11.7351 31.5884C11.7358 31.6085 11.7371 31.6357 11.7394 31.669C11.7442 31.7353 11.7534 31.8268 11.7715 31.9354C11.8073 32.1501 11.8798 32.4439 12.0297 32.7439C12.1807 33.0458 12.415 33.3629 12.7757 33.6034C13.1396 33.846 13.6024 33.9906 14.175 33.9906H19.2656C20.6033 33.9906 21.6708 32.9611 21.7061 31.6194L21.7139 31.3235L21.4582 31.1743C20.0405 30.3473 18.4075 29.8406 16.65 29.8406C14.9529 29.8406 13.3474 30.3169 11.9813 31.1187Z",fill:"white",stroke:"black"}),it.createElement("path",{d:"M19.2656 30.7345C19.2656 30.7345 18.6469 30.397 18.6469 29.722C18.6469 29.1876 18.6469 25.4751 18.6469 25.4751H14.6531C14.6531 25.4751 14.6531 28.6813 14.6531 29.3001C14.6531 30.3688 13.9219 30.7907 13.9219 30.7907L19.2656 30.7345Z",fill:"white"}),it.createElement("path",{d:"M16.6218 27.8874H16.7062C19.9636 27.8874 22.6062 25.2448 22.6062 21.9874V19.7374C22.6062 16.48 19.9636 13.8374 16.7062 13.8374H16.6218C13.3644 13.8374 10.7218 16.48 10.7218 19.7374V21.9874C10.7218 25.2448 13.3644 27.8874 16.6218 27.8874Z",fill:"white",stroke:"black"}),it.createElement("path",{d:"M22.1625 23.197H20.6719V20.4126H22.1625C22.9219 20.4126 23.5688 21.0313 23.5688 21.8188C23.5406 22.5782 22.9219 23.197 22.1625 23.197Z",fill:"white"}),it.createElement("path",{d:"M11.1656 23.197H12.6563V20.4126H11.1656C10.4063 20.4126 9.7594 21.0313 9.7594 21.8188C9.7594 22.5782 10.3781 23.197 11.1656 23.197Z",fill:"white"}),it.createElement("path",{d:"M14.2031 21.9313C14.4672 21.9313 14.6812 21.5284 14.6812 21.0313C14.6812 20.5343 14.4672 20.1313 14.2031 20.1313C13.939 20.1313 13.725 20.5343 13.725 21.0313C13.725 21.5284 13.939 21.9313 14.2031 21.9313Z",fill:"#33312D"}),it.createElement("path",{d:"M18.8437 21.9313C19.1078 21.9313 19.3218 21.5284 19.3218 21.0313C19.3218 20.5343 19.1078 20.1313 18.8437 20.1313C18.5797 20.1313 18.3656 20.5343 18.3656 21.0313C18.3656 21.5284 18.5797 21.9313 18.8437 21.9313Z",fill:"#33312D"}),it.createElement("path",{d:"M16.4226 22.1982C16.445 22.5314 16.4285 22.8558 16.36 23.1511C16.3598 23.1509 16.3597 23.1508 16.3596 23.1507C16.2536 23.0602 16.1427 22.9804 16.0565 22.9184C16.0485 22.9126 16.0407 22.907 16.0331 22.9015C16.0118 22.8861 15.9926 22.8722 15.9754 22.8595C16.1026 22.7032 16.2702 22.4886 16.4226 22.1982Z",stroke:"black"}),it.createElement("path",{d:"M21.9375 14C23.4281 17.4875 24.1312 19.7656 24.1031 19.9906C23.5406 20.2719 22.95 20.4406 22.275 20.4406C21.2344 20.4406 20.3344 20.1031 19.575 19.4C18.8156 18.6969 18.4219 17.375 18.3656 16.3625H14.9906C14.9344 17.375 14.5406 18.6969 13.7812 19.4C13.0219 20.1031 12.1219 20.4406 11.0813 20.4406C10.3781 20.4406 9.73125 20.2719 9.14062 19.9344C9.14062 19.8219 9.53437 18.4438 10.35 16.6438L11.5594 14H21.9375V14Z",fill:"black"}),it.createElement("path",{d:"M16.7062 16.3625H15.0187C15.0187 15.9125 15.3843 15.5469 15.8343 15.5469H15.8906C16.3406 15.5469 16.7062 15.9125 16.7062 16.3625Z",fill:"black"}),it.createElement("path",{d:"M18.3937 16.3625H16.7062C16.7062 15.9125 17.0718 15.5469 17.5218 15.5469H17.5781C18.0281 15.5469 18.3937 15.9125 18.3937 16.3625Z",fill:"black"}),it.createElement("path",{d:"M16.7063 16.3625H13.8375V11.1875H16.7063V16.3625V16.3625Z",fill:"black"}),it.createElement("path",{d:"M16.0312 24.8564C16.2281 24.8282 16.3969 24.8001 16.5375 24.8001C16.7062 24.772 16.8187 24.7439 16.9594 24.7157C17.0719 24.6876 17.1843 24.6314 17.325 24.5751C17.4656 24.5189 17.5781 24.4064 17.7468 24.322H17.775C17.8312 24.2939 17.9437 24.2939 17.9719 24.3782C18 24.4064 18 24.4345 18 24.4626C18 24.6876 17.9437 24.9126 17.775 25.0814C17.6344 25.2782 17.4093 25.4189 17.1843 25.4751C16.9593 25.5314 16.7062 25.5314 16.5094 25.4751C16.2844 25.4189 16.1156 25.3064 15.9469 25.1376C15.8906 25.0814 15.8906 24.997 15.9469 24.9407C15.975 24.8845 16.0031 24.8845 16.0312 24.8564Z",fill:"black"}),it.createElement("path",{d:"M28.5938 18.8083L28.6528 18.2777L28.1194 18.2536C24.0254 18.0687 20.75 14.6871 20.75 10.5406V8.7125C20.75 4.46052 24.2105 1 28.4625 1H36.7875C41.0395 1 44.5 4.46052 44.5 8.7125V10.5406C44.5 14.7926 41.0395 18.2531 36.7875 18.2531H31.6125H31.2994L31.1627 18.5348C30.4776 19.9465 29.2259 20.9877 27.7016 21.3787C28.1712 20.6157 28.4893 19.7494 28.5938 18.8083Z",fill:"white",stroke:"black"}),it.createElement("path",{d:"M34.1719 11.4407H34.1438C33.8063 12.4813 33.1031 13.0157 32.0906 13.0157C31.4438 13.0157 30.9094 12.7625 30.5157 12.2844C30.1219 11.8063 29.925 11.1313 29.925 10.3157C29.925 9.2188 30.2063 8.29067 30.7407 7.58755C31.3032 6.8563 32.0063 6.49067 32.9063 6.49067C33.2438 6.49067 33.5532 6.57505 33.8344 6.77192C34.1157 6.9688 34.2844 7.1938 34.3406 7.44692H34.3688C34.3688 7.39067 34.3969 7.27817 34.3969 7.13755C34.425 6.82817 34.7063 6.60317 35.0157 6.60317C35.3813 6.60317 35.6625 6.91255 35.6344 7.27817C35.4375 9.41567 35.3531 10.4844 35.3531 10.5407C35.3531 11.4969 35.6063 12.0032 36.1125 12.0032C36.5625 12.0032 36.9563 11.7219 37.2657 11.1875C37.575 10.6532 37.7157 9.95005 37.7157 9.07817C37.7157 7.81255 37.2938 6.77192 36.4781 5.9563C35.6625 5.14067 34.5375 4.74692 33.075 4.74692C31.6969 4.74692 30.5438 5.22505 29.6157 6.20942C28.6875 7.1938 28.2375 8.40317 28.2375 9.86567C28.2375 11.3 28.6875 12.4813 29.5594 13.3532C30.4313 14.225 31.6125 14.675 33.1031 14.675C33.975 14.675 34.7625 14.5625 35.4375 14.3375C35.775 14.225 36.1125 14.4782 36.1125 14.8438C36.1125 15.0688 35.9719 15.2657 35.7469 15.35C34.9594 15.6313 34.0032 15.7438 32.9063 15.7438C31.1063 15.7438 29.6719 15.2094 28.575 14.1407C27.4781 13.0719 26.9156 11.6657 26.9156 9.92192C26.9156 8.12192 27.5063 6.65942 28.6594 5.47817C29.8125 4.29692 31.3031 3.7063 33.1031 3.7063C34.7906 3.7063 36.1969 4.21255 37.3219 5.19692C38.4188 6.1813 38.9813 7.47505 38.9813 9.05005C38.9813 10.2032 38.6719 11.1594 38.0813 11.9188C37.4906 12.65 36.7313 13.0438 35.8594 13.0438C34.7344 13.0157 34.1719 12.4813 34.1719 11.4407ZM32.6813 7.81255C32.2031 7.81255 31.8094 8.03755 31.5281 8.51567C31.2469 8.9938 31.0782 9.58442 31.0782 10.2875C31.0782 10.7657 31.1906 11.1313 31.3875 11.4125C31.5844 11.6938 31.8375 11.8344 32.175 11.8344C32.6532 11.8344 33.0469 11.5813 33.3 11.1032C33.5813 10.5969 33.7219 9.95005 33.7219 9.13442C33.7219 8.23442 33.3844 7.81255 32.6813 7.81255Z",fill:"black"}))}})}function ce(){return(ce=_async_to_generator((function*(t,e,a,i,n,o,r,c,s,l){re();const p=document.createElement("div");document.body.appendChild(p);const u=(m=_async_to_generator((function*(t,e){return l.updateFeedActivityState(t,e)})),function(t,e){return m.apply(this,arguments)});var m;const d={emptyCatchUpBehavior:s,anchorTarget:"button[data-unique-id*='CatchUpWithChanges'],button[data-unique-id*='PeripheralOverflowRoot']"};nt.render(it.createElement(ae,{catchUpFlyoutData:t,dateFormatter:r,featureGateAPI:ne,flyoutFocus:a,flyoutRibbonButton:e,flyoutStrings:o,logUserAction:c,navigationManager:i,recentChangesManager:n,sendActivityUpdate:u,options:d}),p)}))).apply(this,arguments)}class se{fireEvent(t){this._listeners.forEach(e=>e(t))}addListener(t){t&&this._listeners.push(t)}removeListener(t){this._listeners=this._listeners.filter(e=>e!==t)}constructor(){this._listeners=[]}}class le{logTrace(t,e){const a=t;if(!a.tag||!a.level||!a.message)return void R.a.sendTraceTag(556363853,M.a.msoulscat_Wac_CatchUpFlyout,D.a.Error,"Undefined tag and/or level and/or message in tryLogEvent: "+a);if(a.category||(a.category=M.a.msoulscat_Wac_CatchUpFlyout),e){const t=JSON.stringify({errorMessage:e.message,errorStack:e.stack});a.message.concat(a.message,t)}const i=this.getULSTraceLevel(a.level);R.a.sendTraceTag(a.tag,a.category,i,a.message)}getULSTraceLevel(t){switch(t){case"Error":return D.a.Error;case"Warning":return D.a.Warning;case"Important":case"Info":return D.a.Info;case"Verbose":return D.a.Verbose;case"Spam":return D.a.Spam;default:return R.a.sendTraceTag(556363854,M.a.msoulscat_Wac_CatchUpFlyout,D.a.Error,"Unknown trace level set, defaulting to level 0"),0}}}class pe{initialize(t){var e=this;return _async_to_generator((function*(){var a,i;const o=yield e._activityStore.getWywaActivities();if(c("WywaReadyEvent"),e._onWywaActivitiesReadyEvent.fireEvent({wywaActivities:o.activities,authors:o.authors}),!t)return void R.a.sendTraceTag(578044767,M.a.msoulscat_Wac_WacCatchUpActivities,D.a.Error,"Undefined CatchUpConfiguration, not initializing the flyout.");if(!e._activityStore)throw new Error("No ActivityCache when initializing CatchUp flyout.");const r=e._activityNavigationManager;if(!r)throw new Error("Null ActivityNavigationManager when initializing CatchUp flyout.");const s=e._flyoutRibbonButton;if(!s)return void R.a.sendTraceTag(579350726,M.a.msoulscat_Wac_CatchUpFlyout,D.a.Error,"FlyoutRibbonButton is null.");e._catchUpActivityLogger&&n.setLogger(e._catchUpActivityLogger),l(ne());const p=yield function(t,e,a,i){return b.apply(this,arguments)}(e._activityStore,e._activityContentManager,e._catchUpFlyoutStrings,null===(a=t.summaryStringEnabled)||void 0===a||a,null!==(i=t.useCompactSummaryString)&&void 0!==i&&i).catch(t=>{R.a.sendTraceTag(555074974,M.a.msoulscat_Wac_CatchUpFlyout,D.a.Error,"Failed to get Flyout data: "+t)});yield function(t,e,a,i,n,o,r,c,s,l){return ce.apply(this,arguments)}(null!=p?p:{relevantActivities:[],summaryNavActivity:void 0,summaryItemText:"",authorCount:0,catchUpActivitiesCount:0},()=>s,()=>e._flyoutFocus,()=>r,()=>e._recentChangesManager,e._catchUpFlyoutStrings,e._dateFormatter,e._logUserAction,e._emptyCatchUpBehaviorManager,e._activityStore)}))()}getActivityIndicatorTooltipManager(){return this._activityIndicatorTooltipManager||(this._activityIndicatorTooltipManager=new Ft(this._activityStore,this._catchUpActivityStrings,this._dateFormatter)),this._activityIndicatorTooltipManager}getActivityStore(){return this._activityStore}getWywaEvent(){return this._onWywaActivitiesReadyEvent}setWebpackPublicPath(t){t&&Object(O.l)(t)}constructor(t,e,a,i,n,o,r,c,s,l,p,u,m,d,C){var h;this._activityRequestManager=t,this._activityNavigationManager=e,this._activityContentManager=a,this._flyoutRibbonButton=i,this._flyoutFocus=n,this._catchUpActivityStrings=c,this._logUserAction=u,this._emptyCatchUpBehaviorManager=m,this._recentChangesManager=d,this._onWywaActivitiesReadyEvent=new se,R.a.setLogger(p),this._catchUpFlyoutStrings=function(t,e={}){return _object_spread({Actionable:t.Actionable,ActivityNotificationText:t.ActivityNotificationText,CatchUpFlyoutAssignTaskItem:t.CatchUpFlyoutAssignTaskItem,CatchUpFlyoutCommentReplyItem:t.CatchUpFlyoutCommentReplyItem,CatchUpFlyoutCompleteTaskItem:t.CatchUpFlyoutCompleteTaskItem,CatchUpFlyoutCompleteTaskUserCreatedItem:t.CatchUpFlyoutCompleteTaskUserCreatedItem,CatchUpFlyoutCreatedTaskReopenedItem:t.CatchUpFlyoutCreatedTaskReopenedItem,CatchUpFlyoutListA11yLabel:t.CatchUpFlyoutListA11yLabel,CatchUpFlyoutMentionItem:t.CatchUpFlyoutMentionItem,CatchUpFlyoutNewDotA11yLabel:t.CatchUpFlyoutNewDotA11yLabel,CatchUpFlyoutOnePersonChange:t.CatchUpFlyoutOnePersonChange,CatchUpFlyoutTwoPeopleChange:t.CatchUpFlyoutTwoPeopleChange,CatchUpFlyoutThreePeopleChange:t.CatchUpFlyoutThreePeopleChange,CatchUpFlyoutFourPeopleChange:t.CatchUpFlyoutFourPeopleChange,CatchUpFlyoutMultiplePeopleChange:t.CatchUpFlyoutMultiplePeopleChange,CatchUpFlyoutReassignTaskUserCreatedItem:t.CatchUpFlyoutReassignTaskUserCreatedItem,CatchUpFlyoutReassignTaskItem:t.CatchUpFlyoutReassignTaskItem,CatchUpFlyoutReopenTaskItem:t.CatchUpFlyoutReopenTaskItem,CatchUpFlyoutReplyToTaskItem:t.CatchUpFlyoutReplyToTaskItem,CatchUpFlyoutSelfAssignedTaskItem:t.CatchUpFlyoutSelfAssignedTaskItem,CatchUpFlyoutTitle:t.CatchUpFlyoutTitle,CommentAction:t.CommentAction,EditAction:t.EditAction,NoChangesByOthers:t.NoChangesByOthers,Notification:t.Notification,RestoreAction:t.RestoreAction,CatchUpEmptyExperienceFirstLineLabel:t.CatchUpEmptyExperienceFirstLineLabel,CatchUpLastEditedItem:t.CatchUpLastEditedItem,CatchUpFlyoutCompactSummaryString:t.CatchUpFlyoutCompactSummaryString,CatchUpFlyoutActivitiesForYouTitleString:t.CatchUpFlyoutActivitiesForYouTitleString,CatchUpFlyoutDismissIconTooltipLabel:t.CatchUpFlyoutDismissIconTooltipLabel,CatchUpFlyoutSummaryFooterTitleString:t.CatchUpFlyoutSummaryFooterTitleString,CatchUpViewPreviousEditsLabel:t.CatchUpViewPreviousEditsLabel,CatchUpFlyoutSelfMentionItem:t.CatchUpFlyoutSelfMentionItem,CatchUpDisplayChanges:t.CatchUpDisplayChanges,CatchUpFlyoutCommentReactionItemTwoPeople:t.CatchUpFlyoutCommentReactionItemTwoPeople,CatchUpFlyoutCommentReactionItemOnePerson:t.CatchUpFlyoutCommentReactionItemOnePerson,CatchUpFlyoutCommentReactionItemMultiplePeople:t.CatchUpFlyoutCommentReactionItemMultiplePeople,EmptyActivitiesForYouSectionLabel:t.EmptyActivitiesForYouSectionLabel},e)}(_object_spread({},this._catchUpActivityStrings,l),null!==(h=null==C?void 0:C.strings)&&void 0!==h?h:{});const y=new x.b(o,r,s);this._dateFormatter=y.format.bind(y),this._activityStore=new q(new at(this._activityRequestManager)),this._catchUpActivityLogger=new le}}var ue=a(71),me=a(106);const de=new class{getExcelCatchUpAppInstance(t){var e,a;if(excelCatchupActivitySprite&&(Object(ut.ib)({icons:Object(me.iconSpriteToReactMap)(excelCatchupActivitySprite)}),excelCatchupActivitySprite=void 0),t&&t.activityRequestManager&&t.uiCulture&&t.dataCulture&&t.ulsLogger)return class{static createCatchUpApp(t,e,a,i,n,o,r,c,s,l,p,u){return new pe(t,e,a,i,n,o,r,CatchupActivityStrings,FriendlyDatesStrings,NotificationStrings,c,s,l,p,u)}}.createCatchUpApp(t.activityRequestManager,t.activityNavigationManager,t.activityContentManager,t.flyoutRibbonButton,t.flyoutFocus,t.uiCulture,t.dataCulture,t.ulsLogger,ue.logUserAction,null!==(e=t.emptyCatchUpBehaviorManager)&&void 0!==e?e:void 0,null!==(a=t.recentChangesManager)&&void 0!==a?a:void 0,{strings:{CatchUpFlyoutSummaryFooterTitleString:ExcelCatchupActivityStringsManager.get(ExcelCatchupActivityStringsEnum.CatchUpFlyoutSummaryFooterTitleString)}})}}},579:function(t,e,a){"use strict";a.d(e,"a",(function(){return s}));var i=a(3),n=a(1),o=a(525),r=a(820),c=a(353),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(i.__extends)(e,t),e.prototype.render=function(){return n.createElement(c.a,Object(i.__assign)({},this.props,{primary:!0,onRenderDescription:o.b}))},Object(i.__decorate)([Object(r.a)("PrimaryButton",["theme","styles"],!0)],e)}(n.Component)},71:function(t,e){t.exports=otel}},[[2092,2,0,1]]]);
//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/catchUpActivity.min.js.map/c1a2bd184b3a59ac437a54f7be7f0ab3/catchUpActivity.min.js.map