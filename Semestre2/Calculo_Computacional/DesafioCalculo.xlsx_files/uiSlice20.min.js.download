function asyncGeneratorStep(e,t,n,o,r,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(o,r)}function _async_to_generator(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var i=e.apply(t,n);function a(e){asyncGeneratorStep(i,o,r,a,s,"next",e)}function s(e){asyncGeneratorStep(i,o,r,a,s,"throw",e)}a(void 0)}))}}function _define_property(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _object_spread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),o.forEach((function(t){_define_property(e,t,n[t])}))}return e}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function _object_spread_props(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function _object_without_properties(e,t){if(null==e)return{};var n,o,r=_object_without_properties_loose(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function _object_without_properties_loose(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}function _to_primitive(e,t){if("object"!==_type_of(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==_type_of(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _to_property_key(e){var t=_to_primitive(e,"string");return"symbol"===_type_of(t)?t:String(t)}function _type_of(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[41],{1654:function(e,t,n){"use strict";n.d(t,"d",(function(){return Ct})),n.d(t,"e",(function(){return vt})),n.d(t,"f",(function(){return Rt})),n.d(t,"a",(function(){return Tt})),n.d(t,"h",(function(){return _t})),n.d(t,"i",(function(){return wt})),n.d(t,"b",(function(){return Dt})),n.d(t,"c",(function(){return Pt})),n.d(t,"g",(function(){return It}));var o=n(1),r=n(52),i=n(2801),a=n(157),s=n(2229),l=n(187),c=n(249),u=n(235),d=n(1417),p=n(399),g=n(5),h=n(103),m=n(523),b=n(2129),f=n(19),x=n(163);class E extends o.PureComponent{render(){return o.createElement(u.a,null,e=>{const{styles:t}=this.props;let n=void 0;n="function"==typeof t?t(this.props):t;const r=(e=>({root:Object(g.eb)(e.root),icon:Object(g.eb)(e.icon),title:Object(g.eb)(e.title),message:Object(g.eb)(e.message),spinner:Object(g.eb)(e.spinner)}))(((e,t)=>{const n=Object(h.a)(e),o=Object(x.c)()?e.palette.neutralLight:m.a.hoverBackgroundColor,r={root:[g.f.small,{border:"1px solid "+o,borderRadius:"2px",boxShadow:b.a.depth8,color:n.textColor,display:"flex",lineHeight:"16px",margin:"2px",padding:"8px 12px 8px 12px",backgroundColor:n.defaultBackgroundColor}],icon:{height:16,width:16,paddingRight:8},title:{fontWeight:"bold",paddingRight:5,commonHighContrastCanvasStyles:f.j},message:{commonHighContrastCanvasStyles:f.j},spinner:{height:16,width:16,paddingRight:8}};return Object(g.I)(r,t)})(e,n)),i=this.props.contentRendererFunction&&this.props.contentRendererFunction()||this.getToastContent(r);return o.createElement("div",{className:r.root},this.props.hasSpinner&&o.createElement(d.a,{size:p.a.small,className:r.spinner}),this.props.icon&&o.createElement(l.a,_object_spread_props(_object_spread({},Object(c.a)(this.props.icon)),{className:r.icon})),i)})}getToastContent(e){const{title:t,message:n}=this.props;return o.createElement(o.Fragment,null,t&&o.createElement("span",{className:e.title},t),n&&o.createElement("span",{className:e.message},n))}}function S(e){return o.createElement(E,_object_spread({},e))}var y=n(2584),C=n(20);const v={appear:"appear",appearActive:"appearActive",appearDone:"appearDone",enter:"enter",enterActive:"enterActive",enterDone:"enterDone",exit:"exit",exitActive:"exitActive",exitDone:"exitDone"},R=Object(C.c)(e=>{const t={animations:{selectors:{"&.appear":e.appear,"&.appearActive":e.appearActive,"&.enter":e.enter,"&.enterActive":e.enterActive,"&.enterDone":e.enterDone,"&.exit":e.exit,"&.exitActive":e.exitActive,"&.exitDone":e.exitDone}}};return Object(g.db)(t)});var k=n(66);const T=Object(C.c)(e=>Object(g.db)({root:{display:"flex",flexDirection:"row",justifyContent:"flex-end",whiteSpace:"nowrap"},hidden:{display:"inline-block",position:"absolute",opacity:0}},e)),_=Math.max(250,100),w=e=>e?f.E:350+_,D=Object(C.c)((e,t)=>{if(t)return{};const n={width:0,opacity:0,transform:"scale(0,0)"},o={width:e,opacity:1,transform:"scale(1,1)",transition:"width 250ms linear, transform 250ms ease-out 350ms, opacity 100ms linear 350ms"};return{appear:n,appearActive:o,enter:n,enterActive:o,exit:{width:e,opacity:1,transform:"scale(1,1)"},exitActive:{width:0,opacity:0,transform:"scale(0,0)",transition:`transform 250ms ease-out, opacity 100ms linear, width 250ms linear ${_+100}ms`},exitDone:n}});class P extends o.PureComponent{componentDidMount(){this.afterComponentRender()}componentDidUpdate(){this.afterComponentRender()}render(){const e=T(this.props.styles);return o.createElement("div",{ref:this.props.containerRef,className:e.root,"aria-live":"polite","aria-relevant":"additions","aria-atomic":"false"},this.state.toasts.filter(e=>!e.width).map(t=>o.createElement("div",{key:t.key,ref:t.ref,className:e.hidden,"aria-hidden":!0},S(t.toastProps))),this.state.toasts.filter(e=>e.width).map(e=>{const t=(e=>{const t=Object(k.isReducedAnimations)();return{transitionClassNames:R(D(e,t)),timeout:w(t)}})(e.width),n=o.createElement("div",{ref:e.ref,className:t.transitionClassNames.animations},S(e.toastProps));return o.createElement(s.a,_object_spread({key:e.key},e.notificationProps),(r=n,i=t,a={key:e.key,onExited:this.getDeleteToastCallback(e.key),appear:!0,in:!e.isLeaving},o.createElement(y.a,_object_spread_props(_object_spread({},a),{classNames:v,timeout:i.timeout||0}),r)));var r,i,a}))}addToast(e,t){const n=Object(a.d)(this.state.toasts,t=>t.toastProps===e);if(n)return n.key;const r=P.toastCounter.toString();return P.toastCounter+=1,this.setState(n=>({toasts:[...n.toasts,{key:r,toastProps:e,notificationProps:t,ref:o.createRef(),isLeaving:!1}]})),r}updateToast(e,t){this.setState(n=>{const o=Object(a.e)(n.toasts,t=>t.key===e);if(o>=0){const e={toasts:[...n.toasts]};return e.toasts[o]=_object_spread_props(_object_spread({},e.toasts[o]),{toastProps:t}),e}return n})}removeToast(e){this.setState(t=>{const n=Object(a.e)(t.toasts,t=>t.key===e);if(n>=0){const e={toasts:[...t.toasts]};return e.toasts[n].isLeaving=!0,e}return t})}afterComponentRender(){requestAnimationFrame(()=>{this.setState(e=>{let t=!1;const n={toasts:[...e.toasts]};return n.toasts.forEach(e=>{!e.width&&e.ref.current&&(e.width=e.ref.current.clientWidth+1,t=!0)}),t?n:e})})}constructor(e){super(e),this.getDeleteToastCallback=e=>()=>{this.setState(t=>{const n=Object(a.e)(t.toasts,t=>t.key===e);if(n>=0){const e={toasts:[...t.toasts]};return e.toasts.splice(n,1),e}return t})},this.state={toasts:[]}}}P.toastCounter=0;var I=n(171),F=n(608),B=n(1001),M=n(2171);const j=Object(C.c)((e,t,n)=>{const o=[];e&&o.push(e),n&&o.push(n);const r={root:{width:o.length?Math.max(...o):void 0,selectors:{img:{display:"block",marginLeft:"auto",marginRight:"auto",height:t}}}};return Object(g.db)(r)});class O extends o.PureComponent{componentDidUpdate(e){e.imageWidth!==this.props.imageWidth&&this.props.imageWidth!==this.state.imageWidth&&this.setState({imageWidth:this.props.imageWidth})}render(){const{paragraphs:e,image:t}=this.props,n=_object_spread_props(_object_spread({},t),{onLoadingStateChange:this.getOnloadingStateChangecallback()}),r=j(this.state.imageWidth,this.props.imageHeight,this.props.parentContainerMinWidth);return o.createElement("div",{className:r.root},(Array.isArray(e)?e:[e]).map((e,t)=>this.renderParagraph(t,e)),o.createElement("div",{ref:this.imgWrapperRef},o.createElement(F.a,_object_spread({},n))))}renderParagraph(e,t){if("string"==typeof t)return o.createElement("p",{key:e},t);switch(t.type){case"AppLinkProps":return o.createElement("p",{key:e},o.createElement(M.a,_object_spread({},t)));default:Object(B.a)(t.type)}}getOnloadingStateChangecallback(){return e=>{this.props.image.onLoadingStateChange&&this.props.image.onLoadingStateChange(e),this.onLoadingStateChange(e)}}constructor(e){super(e),this.imgWrapperRef=o.createRef(),this.onLoadingStateChange=e=>{if(e===I.c.loaded&&!this.props.imageWidth&&this.imgWrapperRef.current){const e=this.imgWrapperRef.current.querySelector("img");e&&e.width&&this.setState({imageWidth:e.clientWidth})}},this.state={imageWidth:e.imageWidth}}}var L=n(719);const A=Object(C.c)(e=>{const t=Object(h.a)(e),n={root:{backgroundColor:t.defaultBackgroundColor,height:"58px",width:"234px",display:"flex",marginTop:"8px"},rootRow:{display:"flex",flexDirection:"row",alignItems:"center"},rootColumn:{display:"flex",flexDirection:"column"},countNumber:{color:t.defaultBackgroundColor,fontFamily:"Bahnschrift, Segoe UI, Helvetica Neue",fontSize:"20px",height:"40px",letterSpacing:"0px",lineHeight:"46px",textAlign:"center",verticalAlign:"middle",width:"40px"},countBox:{background:"linear-gradient(-225deg, #3355ff 0%, #7160e8 100%)",borderRadius:"2px",height:"42px",width:"40px",marginRight:"20px"},messageBody:{width:"166px",height:"40px",color:t.textSecondaryColor,fontSize:"12px",fontFamily:"Segoe UI, Helvetica Neue",lineHeight:"18px"}};return Object(g.db)(n)});class N extends o.PureComponent{render(){const{numberOfWritingIssuesFound:e,buttonPropsList:t,ideasProactiveCalloutMessageSingular:n,ideasProactiveCalloutMessagePlural:r}=this.props,i=e<100?e:"99+",a=1===e?n.replace("{0}",e.toString()):r.replace("{0}",e.toString());return o.createElement(u.a,null,e=>{const n=A(e);return o.createElement("div",{className:n.root},o.createElement("div",{className:n.rootRow},o.createElement("div",{className:n.countBox},o.createElement("div",{className:n.countNumber},i))),o.createElement("div",{className:n.rootColumn},o.createElement("div",{className:n.messageBody},a),this.createButton(t,{root:{border:"0px",padding:"0px",minWidth:"94px",maxWidth:"166px",height:"18px",backgroundColor:"transparent",selectors:{[f.b]:{backgroundColor:"transparent"}}},rootHovered:{backgroundColor:"transparent"},rootPressed:{backgroundColor:"transparent"},flexContainer:{padding:"0px",margin:"0px"},textContainer:{color:"#7160E8",fontSize:"12px",fontFamily:"Segoe UI, Helvetica Neue",lineHeight:"18px",margin:"0px",padding:"0px"},label:{margin:"0px",padding:"0px",selectors:{":hover":{color:"#5648b0",textDecoration:"underline"},":active":{color:"#403582",textDecoration:"underline"}}}})))})}constructor(e){super(e),this.createButton=(e,t)=>void 0===e||0===e.length?o.createElement(o.Fragment,null," "):o.createElement(L.a,_object_spread({type:"AppButtonProps",onExecute:e[0].onExecute,label:e[0].label,id:e[0].label,styles:t},e))}}const W=e=>()=>o.createElement(N,_object_spread({},e));var z=n(708);const H=Object(C.c)(()=>Object(g.db)({root:{height:"flex",width:"700px",display:"flex",marginTop:"flex",marginBottom:"-10px"},rootRow:{display:"flex",flexDirection:"row",alignItems:"center"},spinnerId:{fontSize:"20px",height:"40px",letterSpacing:"0px",lineHeight:"46px",textAlign:"center",verticalAlign:"middle",width:"40px"},title:{fontSize:20,lineHeight:28,marginBottom:12},spinnerBox:{borderRadius:"2px",height:"32px",width:"30px",marginRight:"8px",marginLeft:"-10px",marginTop:"-15px",marginBottom:"20px"},messageBody:{width:"536px",height:"flex",display:"block",fontSize:"12px",lineHeight:"flex",marginTop:"-15px",marginRight:"445px",marginBottom:"5px"},messageTextStyle:{marginTop:"5px",marginRight:"-25px"}})),V={shade30:"#000000",shade20:"#002050",shade10:"#005a9e",primary:"#0078d7",tint10:"#c7e0f4",tint20:"#4a78b0",tint30:"#7da3c6",tint40:"#a5b9d1"};var U=n(2646),G=n(2730);class q extends o.PureComponent{render(){const e=H(),{title:t,messageText:n}=this.props;return o.createElement("div",null,o.createElement("div",{className:e.title},t),o.createElement("div",{className:e.root},o.createElement("div",{className:e.rootRow},o.createElement("div",{className:e.spinnerBox,"aria-hidden":!0},o.createElement("div",{className:e.spinnerId},this.renderSpinner()))),o.createElement("div",{className:e.messageBody,"aria-live":"polite",role:"status"},(Array.isArray(n)?n:[n]).map((e,t)=>this.renderMessage(t,e)))))}renderMessage(e,t){const n=H();if("string"==typeof t)return o.createElement(z.a,{delay:50},o.createElement("p",{className:n.messageTextStyle},t));switch(t.type){case"AppLinkProps":return o.createElement(z.a,{delay:50},o.createElement("p",{className:n.messageTextStyle},o.createElement(o.Fragment,null,t),o.createElement(M.a,_object_spread({},t))));default:Object(B.a)(t.type)}}constructor(e){super(e),this.renderSpinner=()=>o.createElement("div",{style:Object(G.b)()},o.createElement(U.a,{type:"AppSpinnerProps",id:"DeferredBlobSpinner",spinnerSize:p.a.small,appColors:V}))}}const Q=e=>t=>o.createElement(q,_object_spread_props(_object_spread({},e),{parentContainerMinWidth:t&&t.minWidth}));var K,J=n(2731);!function(e){e[e.None=0]="None",e[e.Top=1]="Top",e[e.Side=2]="Side"}(K||(K={}));const Y=Object(C.c)((e,t=K.None,n)=>{const o={root:{display:"flex",flexDirection:t===K.Side?"row":"column"},imageContainer:{display:"flex",alignItems:"center",justifyContent:"center",paddingBottom:t===K.Top?20:0,paddingRight:t===K.Side?20:0},contentContainer:{maxWidth:300},title:{fontWeight:g.l.semibold,marginBottom:14,fontSize:e?g.k.mediumPlus:g.k.xLarge,paddingRight:24},buttonsContainer:{display:"inline-block",paddingLeft:12},footer:{width:"100%",display:"flex",justifyContent:"flex-end",alignItems:"center"},message:{selectors:{p:{marginTop:"1em",marginBottom:"1em"},"p:first-child":{marginTop:0,paddingRight:n?void 0:24}}}};return Object(g.db)(o)}),Z=Object(C.c)(()=>Object(g.db)({feedbackBarContainer:{width:"100%",display:"flex",justifyContent:"flex-end",alignItems:"center",marginTop:"12px"},feedbackButtonContainer:{},message:{marginRight:"8px"}})),$=Object(C.c)(e=>{const{palette:t}=e,n="svg > path.OfficeIconColors_m20",o=Object(f.w)(e),r={root:{padding:"0 4px",marginLeft:"6px",width:"20px",height:"20px","svg > path.OfficeIconColors_m22":{fill:t.neutralLighter},[n]:{fill:"transparent"},":first-child":{marginLeft:"0px"}},rootHovered:{backgroundColor:"transparent",[n]:{fill:t.neutralLighter}},rootPressed:{backgroundColor:"transparent",[n]:{fill:t.neutralLight}},rootChecked:{backgroundColor:"transparent",[n]:{fill:t.neutralLight}},rootCheckedHovered:{backgroundColor:"transparent",[n]:{fill:t.neutralLighter}},rootCheckedPressed:{backgroundColor:"transparent",[n]:{fill:t.neutralLight}}};return{thumbButtons:Object(g.I)(o,r)}}),X=Object(C.c)((e,t)=>{const n={position:"relative"},o={root:_object_spread({},n)},r={root:_object_spread_props(_object_spread({},n),{marginLeft:8})},i=Object(J.a)(e,t,{primaryButton:o,secondaryButton:r});return{primaryButton:i.primaryButton,secondaryButton:i.secondaryButton}});var ee=n(216),te=n(2475),ne=n(2628),oe=n(197),re=n.n(oe);const ie=e=>{var t;return e.showFeedbackBar&&(null!==(t=e.feedbackBarProps)&&void 0!==t||(e.feedbackBarProps={feedbackPrompt:NotificationStringsManager.get(NotificationStringsEnum.FeedbackBarPrompt),feedbackResponsePrompt:NotificationStringsManager.get(NotificationStringsEnum.FeedbackBarResponse),positiveFeedbackButton:{icon:re.a.ThumbsUp_16,label:NotificationStringsManager.get(NotificationStringsEnum.FeedbackBarPositiveTooltip),onExecute:e.positiveFeedbackAction},negativeFeedbackButton:{icon:re.a.ThumbsDown_16,label:NotificationStringsManager.get(NotificationStringsEnum.FeedbackBarNegativeTooltip),onExecute:e.negativeFeedbackAction}})),()=>o.createElement(se,_object_spread({},e))};var ae;!function(e){e[e.PositiveFeedback=0]="PositiveFeedback",e[e.NegativeFeedback=1]="NegativeFeedback"}(ae||(ae={}));class se extends o.PureComponent{render(){const{image:e,positionImageAtLeft:t,smallHeadline:n,message:r,footer:i,title:a,feedbackBarProps:s,showLearnMoreHref:l,learnMoreHref:c,learnMoreDisplayText:u}=this.props,d=e?t?K.Side:K.Top:K.None,p=Array.isArray(r)?r:[r],g=Y(!!n,d,!!a);return o.createElement("div",{className:g.root},e&&!this.state.hideImage&&o.createElement("div",{className:g.imageContainer},o.createElement(F.a,_object_spread_props(_object_spread({},e),{className:g.image,onLoadingStateChange:this.onLoadingStateChange}))),o.createElement("div",{className:g.contentContainer},a&&o.createElement("div",{className:g.title,role:"heading","aria-level":1},a),o.createElement("div",{className:g.message},p.map((e,t)=>o.createElement("p",{key:t},e))),l&&o.createElement("a",{className:"LearnMoreLink",href:c,target:"_blank",rel:"noreferrer","aria-label":u,role:"button"},u),o.createElement("div",{className:g.footer},i&&o.createElement("span",null,i),this.renderButtons(g)),s&&this.renderFeedbackBar(s)))}renderButtons(e){const{primaryButtonProps:t,secondaryButtonProps:n,appColors:r}=this.props,i=Object(ee.a)("FloodgateCallout");return o.createElement(u.a,null,a=>{const s=X(a,r);return(t||n)&&o.createElement("span",{className:e&&e.buttonsContainer},t&&o.createElement(L.a,_object_spread_props(_object_spread({},t),{id:i+"-primaryButton",type:"AppButtonProps",styles:s&&s.primaryButton})),n&&o.createElement(L.a,_object_spread_props(_object_spread({},n),{id:i+"-secondaryButton",type:"AppButtonProps",styles:s&&s.secondaryButton})))})}renderFeedbackBar(e){const t=Object(ee.a)("FloodgateCallout"),n=e.positiveFeedbackButton.label,r=e.negativeFeedbackButton.label,i=()=>{this.onFeedbackButtonClick(ae.PositiveFeedback,e.positiveFeedbackButton.onExecute)},a=()=>{this.onFeedbackButtonClick(ae.NegativeFeedback,e.negativeFeedbackButton.onExecute)};return o.createElement(u.a,null,s=>{const l=Z(),u=$(s);return o.createElement("div",{className:l.feedbackBarContainer},o.createElement("span",{className:l.message},this.getFeedbackMessage()),o.createElement("span",{className:l.feedbackButtonContainer},o.createElement(te.a,null,o.createElement(ne.a,{id:t+"-positiveFeedbackButton",role:"button",styles:u.thumbButtons,iconProps:Object(c.a)(e.positiveFeedbackButton.icon),label:n,ariaLabel:n,customTooltip:n,checked:this.state.positiveFeedbackChecked,onClick:i}),o.createElement(ne.a,{id:t+"-negativeFeedbackButton",role:"button",styles:u.thumbButtons,iconProps:Object(c.a)(e.negativeFeedbackButton.icon),label:r,ariaLabel:r,customTooltip:r,checked:this.state.negativeFeedbackChecked,onClick:a}))))})}constructor(e){super(e),this.getFeedbackMessage=()=>{if(!this.props.feedbackBarProps)return"";const{feedbackPrompt:e,feedbackResponsePrompt:t}=this.props.feedbackBarProps;return this.state.feedbackSubmitted&&t||e},this.onFeedbackButtonClick=(e,t)=>{let n=this.state.positiveFeedbackChecked,o=this.state.negativeFeedbackChecked,r=!1;switch(e){case ae.PositiveFeedback:n||(n=!0,o=!1,r=!0);break;case ae.NegativeFeedback:o||(n=!1,o=!0,r=!0)}r&&(this.setState({positiveFeedbackChecked:n,negativeFeedbackChecked:o,feedbackSubmitted:n||o}),t&&t())},this.onLoadingStateChange=e=>{e===I.c.error&&this.setState({hideImage:!0})},this.state={hideImage:!1,feedbackSubmitted:!1,positiveFeedbackChecked:!1,negativeFeedbackChecked:!1}}}var le=n(82),ce=n(81),ue=n(217),de=n(151),pe=n(1015),ge=n(415);const he=Object(C.c)((e,t,n)=>{const o=Object(h.a)(e),r={borderRadius:2,height:32,fontWeight:g.l.semibold,letterSpacing:"0",textAlign:"center",position:"relative"},i={root:{background:o.defaultBackgroundColor,minWidth:250},radioButtonsContainer:{display:"inline-flex",justifyContent:"center",marginBottom:23},prompt:{marginBottom:13,marginTop:0,fontSize:g.k.medium,color:Object(x.c)()?e.palette.black:de.a.black},question:{marginBottom:23,color:Object(pe.a)(e).primaryTextColor,fontSize:g.k.large,fontWeight:"bold",maxWidth:null!=n?n:"100%"},disclaimer:{color:o.textDisclaimerColor,fontSize:g.k.small,fontStyle:"normal",fontWeight:"normal",maxWidth:null!=n?n:"100%",display:"flex"},disclaimerText:{margin:0},privacyLink:{marginLeft:5},buttonsContainer:{marginTop:21},subComponentStyles:{submitButton:Object(g.I)({root:[{marginRight:12},r]},Object(ge.d)(Object(ge.b)(t),ge.a)),cancelButton:Object(g.I)({root:r},Object(ge.d)(Object(ge.f)(e),ge.a))}};return Object(g.db)(i)}),me=Object(C.c)(()=>({flexContainer:{display:"flex",marginLeft:18,height:24}})),be=Object(C.c)((e,t)=>{const n=Object(x.c)()?e.palette.themePrimary:t.primary;return{root:{minHeight:18,marginRight:18,marginTop:7},field:{right:1,width:18,selectors:{":hover::before":{borderColor:n},":hover::after":{borderColor:n,backgroundColor:n},":after":{borderColor:n}}},choiceFieldWrapper:{selectors:{".is-checked::before":{borderColor:n}}}}});var fe=n(827),xe=n(1218),Ee=n(1217);class Se extends o.PureComponent{componentDidMount(){this.afterComponentRender(),le.a.sendTraceTag(590700804,ce.a.msoulscat_Wac_Telemetry,ue.a.Info,"NpsOneClickRadioButton has been displayed")}render(){const{appColors:e,npsOneClickCommonProps:t}=this.props,n={href:t.privacyStatementLink,target:"_blank"};return o.createElement(u.a,null,r=>{const i=he(r,e,this.state.radioButtonContainerWidth);return o.createElement("div",{className:i.root},t.prompt&&o.createElement("p",{className:i.prompt},t.prompt),t.question&&o.createElement("p",{className:i.question},t.question),o.createElement("div",{className:i.radioButtonsContainer,ref:this.radioButtonContainerRef},this.renderButtons(r,e,t.ratingLabels)),o.createElement("div",{className:i.disclaimer},o.createElement("p",{className:i.disclaimerText},t.disclaimer,o.createElement("span",{className:i.privacyLink},o.createElement(M.a,{handler:n,type:"AppLinkProps",id:"privacy link",text:t.verbatimPrivacyStatement})))),o.createElement("div",{className:i.buttonsContainer},o.createElement(fe.a,_object_spread_props(_object_spread({},t.ratingSendButtonProps),{styles:i.subComponentStyles.submitButton(),disabled:!this.hasSelectedRating(),onClick:this.handleSubmit})),o.createElement(fe.a,_object_spread_props(_object_spread({},t.cancelButtonProps),{styles:i.subComponentStyles.cancelButton(),onClick:this.handleCancel}))))})}afterComponentRender(){this.radioButtonContainerRef.current&&!this.state.radioButtonContainerWidth&&this.setState({radioButtonContainerWidth:this.radioButtonContainerRef.current.clientWidth})}hasSelectedRating(){return void 0!==this.state.selectedRating}constructor(e){super(e),this.radioButtonContainerRef=o.createRef(),this.getOptions=(e,t,n)=>{const o=be(e,t);return n.map((e,t)=>({key:""+t,text:"",ariaLabel:e,styles:o}))},this.handleOnUserSelection=e=>{this.setState({selectedRating:parseInt(e.key,10)}),le.a.sendTraceTag(590653001,ce.a.msoulscat_Wac_Telemetry,ue.a.Info,"User has selected a rating on NpsOneClickRadioButton")},this.renderButtons=Object(C.c)((e,t,n)=>o.createElement(o.Fragment,null,o.createElement(Ee.a,{type:"AppLabelProps",forId:"rating labels",label:n[0],id:"leading anchor"}),o.createElement(xe.a,{id:this.id,key:this.id,type:"AppChoiceGroupProps",label:"",options:this.getOptions(e,t,n),styles:me(),onChange:this.handleOnUserSelection}),o.createElement(Ee.a,{type:"AppLabelProps",forId:this.id,label:n[n.length-1],id:"trailing anchor"}))),this.handleSubmit=()=>{this.hasSelectedRating()&&this.props.npsOneClickCommonProps.ratingSendButtonProps.onExecute(this.state.selectedRating),this.props.updateCurrentPageNumber(Ie.Verbatim),le.a.sendTraceTag(590700805,ce.a.msoulscat_Wac_Telemetry,ue.a.Info,`User has submitted a rating of ${this.state.selectedRating} on NpsOneClickRadioButton`)},this.handleCancel=()=>{this.props.npsOneClickCommonProps.cancelButtonProps.onExecute(),le.a.sendTraceTag(590653002,ce.a.msoulscat_Wac_Telemetry,ue.a.Info,"User has dismissed the NpsOneClickRadioButton")},this.state={},this.id=Object(ee.a)("NpsOneClickRadioButton")}}const ye=Object(C.c)((e,t,n)=>{const o=Object(h.a)(e),r=Object(pe.a)(e),i={borderRadius:2,height:32,fontWeight:g.l.semibold,letterSpacing:"0",textAlign:"center",position:"relative"},a={frame:{background:o.defaultBackgroundColor,maxWidth:400},verbatimPrompt:{top:8,left:13,fontStyle:"normal",fontWeight:600,fontSize:g.k.medium,lineHeight:20,color:r.primaryTextColor},verbatimDisclaimer:{marginBottom:13,marginTop:5,color:o.textDisclaimerColor,fontSize:g.k.small,fontStyle:"normal",fontWeight:"normal",maxWidth:null!=n?n:"100%",display:"flex"},email:{marginBottom:13,marginTop:0,fontSize:g.k.medium,color:e.palette.black},submissionDisclaimer:{color:o.textDisclaimerColor,fontSize:g.k.small,fontStyle:"normal",fontWeight:"normal",maxWidth:null!=n?n:"100%",display:"flex"},submissionDisclaimerText:{margin:0},privacyLink:{color:r.primaryTextColor,fontSize:g.k.small,fontStyle:"normal",fontWeight:"normal",marginLeft:5},buttonsContainer:{marginTop:21},subComponentStyles:{submitButton:Object(g.I)({root:[{marginRight:12},i]},Object(ge.d)(Object(ge.c)(e,t),ge.a)),cancelButton:Object(g.I)({root:i},Object(ge.d)(Object(ge.f)(e),ge.a))}};return Object(g.db)(a)}),Ce=Object(C.c)((e,t)=>({root:{width:"100%"},fieldGroup:{borderColor:Object(x.c)()?e.palette.themePrimary:t.primary}})),ve=Object(C.c)((e,t,n)=>{const o=Object(x.c)()?e.palette.themePrimary:t.primary;return{root:{padding:0,border:"none"},checkmark:[n&&[{fill:o}]],checkbox:[n&&[{borderColor:o}],!n&&[{borderColor:Object(x.c)()?e.palette.black:de.a.black}]]}}),Re=Object(C.c)((e,t)=>({root:{width:"100%",backgroundColor:Object(h.a)(e).defaultBackgroundColor},fieldGroup:{borderColor:Object(x.c)()?e.palette.themePrimary:t.primary},errorMessage:{color:Object(x.c)()?e.palette.black:de.a.black}}));Object(C.c)(()=>({flexContainer:{display:"flex",marginLeft:18,height:24}}));var ke=n(2508),Te=n(2641),_e=n(62);class we extends o.PureComponent{componentDidMount(){le.a.sendTraceTag(587511235,ce.a.msoulscat_Wac_Telemetry,ue.a.Info,"NpsVerbatim has been displayed")}componentWillUnmount(){le.a.sendTraceTag(587511236,ce.a.msoulscat_Wac_Telemetry,ue.a.Info,"NpsVerbatim has been dismissed")}render(){const{appColors:e,npsOneClickCommonProps:t}=this.props,n={href:t.privacyStatementLink,target:"_blank"};return o.createElement(u.a,null,r=>{const i=ye(r,e);return o.createElement("div",{className:i.frame},o.createElement("div",{className:i.verbatimPrompt},t.verbatimPrompt),o.createElement("div",{className:i.verbatimDisclaimer},t.verbatimDisclaimer),o.createElement(Te.a,{styles:Ce(r,e),multiline:!0,value:this.state.userVerbatim,onChange:this.onUserInputChange,onKeyDown:this.preventArrowKeysFromChangingFocus,resizable:!0,type:"AppInputProps",id:"Verbatim Textbox"}),!t.isCommercialHost&&o.createElement("div",{className:i.email},o.createElement(ke.a,{label:t.emailLabel,checked:this.state.allowEmailContact,onExecute:this.onContactBoxChange,styles:ve(r,e,this.state.allowEmailContact),checkmarkIcon:this.props.checkmarkIcon,type:"AppCheckboxProps",id:"Email Checkbox"}),o.createElement(Te.a,{styles:Re(r,e),multiline:!1,value:this.state.allowEmailContact?this.state.userEmail:"",onChange:this.onUserEmailInputChange,disabled:!this.state.allowEmailContact,placeholder:t.emailPlaceHolder,type:"AppInputProps",id:"Email Textbox",errorMessage:this.state.errorMessage})),o.createElement("div",{className:i.submissionDisclaimer},o.createElement("p",{className:i.submissionDisclaimerText},t.submissionDisclaimer,o.createElement("span",{className:i.privacyLink},o.createElement(M.a,{handler:n,type:"AppLinkProps",id:"privacy link",text:t.verbatimPrivacyStatement})))),o.createElement("div",{className:i.buttonsContainer},o.createElement(fe.a,_object_spread_props(_object_spread({},t.verbatimSendButtonProps),{styles:i.subComponentStyles.submitButton(),onClick:this.handleSubmit,disabled:!this.enableSubmit()})),o.createElement(fe.a,_object_spread_props(_object_spread({},t.cancelButtonProps),{styles:i.subComponentStyles.cancelButton(),onClick:this.handleCancel}))))})}enableSubmit(){return this.state.allowEmailContact?this.state.userEmail&&this.state.isEmailValid:this.state.userVerbatim}constructor(e){super(e),this.preventArrowKeysFromChangingFocus=e=>{[_e.a.left,_e.a.right,_e.a.up,_e.a.down].includes(e.keyCode)&&e.stopPropagation()},this.validateEmail=e=>{void 0!==e&&/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e.toLowerCase())?this.setState({isEmailValid:!0,errorMessage:""}):this.setState({isEmailValid:!1,errorMessage:this.props.npsOneClickCommonProps.emailValidationErrorMessage})},this.onUserInputChange=e=>{this.setState({userVerbatim:e})},this.onUserEmailInputChange=e=>{this.setState({userEmail:e}),this.validateEmail(e)},this.onContactBoxChange=e=>{e.checked?this.validateEmail(this.state.userEmail):this.setState({userEmail:"",isEmailValid:!1,errorMessage:""}),this.setState({allowEmailContact:e.checked})},this.handleSubmit=()=>{const e=JSON.stringify({surveyStrings:JSON.stringify({prompt:_object_spread({},this.props.npsOneClickCommonProps.promptComponent.data),rating:[_object_spread({},this.props.npsOneClickCommonProps.ratingComponent.data)]})}),t=this.state.allowEmailContact?this.state.userEmail:"",n=[this.state.userVerbatim,t,e];this.props.npsOneClickCommonProps.verbatimSendButtonProps.onExecute(n),this.props.updateCurrentPageNumber(Ie.ThankyouPage),le.a.sendTraceTag(587511237,ce.a.msoulscat_Wac_Telemetry,ue.a.Info,"User has submitted input on NpsVerbatim text box")},this.handleCancel=()=>{this.props.updateCurrentPageNumber(Ie.ThankyouPage),le.a.sendTraceTag(587511238,ce.a.msoulscat_Wac_Telemetry,ue.a.Info,"User has clicked the cancel button to dismiss the NpsVerbatim")},this.state={allowEmailContact:!1,userVerbatim:void 0,isEmailValid:!1}}}const De=Object(C.c)((e,t)=>{const n={frame:{background:Object(h.a)(e).defaultBackgroundColor,minWidth:400,fontSize:g.k.large,lineHeight:24,color:Object(pe.a)(e,t).primaryTextColor}};return Object(g.db)(n)});class Pe extends o.PureComponent{componentDidMount(){setTimeout(()=>this.props.cancelButtonProps.onExecute(),3e3),le.a.sendTraceTag(587511233,ce.a.msoulscat_Wac_Telemetry,ue.a.Info,"Thankyou Page has been displayed with a 3s timer to auto dismiss")}componentWillUnmount(){le.a.sendTraceTag(587511234,ce.a.msoulscat_Wac_Telemetry,ue.a.Info,"Thankyou Page has been dismissed")}render(){return o.createElement(u.a,null,e=>{const t=De(e,this.props.appColors);return o.createElement("div",{className:t.frame},this.props.thankyouText)})}}var Ie;!function(e){e[e.Rating=0]="Rating",e[e.Verbatim=1]="Verbatim",e[e.ThankyouPage=2]="ThankyouPage"}(Ie||(Ie={}));class Fe extends o.PureComponent{componentDidMount(){le.a.sendTraceTag(587511239,ce.a.msoulscat_Wac_Telemetry,ue.a.Info,"NpsOneClickSurvey is currently displaying page # "+this.state.currentPage)}render(){let e=o.createElement(o.Fragment,null);if(this.state.currentPage===Ie.Rating){const t="NPSOneClickRadioButton";e=o.createElement(Se,_object_spread_props(_object_spread({},this.props),{type:t,updateCurrentPageNumber:this.updateCurrentPageNumber}))}else if(this.state.currentPage===Ie.Verbatim){const t="NPSVerbatim";e=o.createElement(we,_object_spread_props(_object_spread({},this.props),{type:t,updateCurrentPageNumber:this.updateCurrentPageNumber,checkmarkIcon:this.props.checkmarkIcon}))}else this.state.currentPage===Ie.ThankyouPage&&(e=o.createElement(Pe,{thankyouText:this.props.npsOneClickCommonProps.thankyouText,appColors:this.props.appColors,cancelButtonProps:this.props.npsOneClickCommonProps.cancelButtonProps}));return e}constructor(e){super(e),this.updateCurrentPageNumber=e=>{this.setState({currentPage:e})},this.state={currentPage:this.props.npsOneClickCommonProps.currentPage}}}const Be=e=>()=>o.createElement(Fe,_object_spread({},e)),Me=Object(C.c)((e,t)=>{const n={premiumIconContainer:{height:28,marginBottom:12},premiumIcon:{width:20,height:28,cursor:"default"},title:{fontSize:20,lineHeight:28,marginBottom:12,color:e.palette.neutralPrimary,cursor:"default"},contentContainer:{fontSize:12,lineHeight:16,marginBottom:20,color:e.palette.neutralPrimary},contentImageContainer:{lineHeight:16,marginBottom:20},message:{marginBottom:12},image:{display:"block",marginLeft:"auto",marginRight:"auto",height:t},screenReaderText:g.ab};return Object(g.db)(n)});class je extends o.PureComponent{render(){const{title:e,content:t,titleId:n,imageProps:r,appColors:i}=this.props;return o.createElement(u.a,null,a=>{const s=Me(a),u=Object(pe.a)(a,i);return o.createElement("div",null,o.createElement("div",{className:s.contentImageContainer},r&&o.createElement("div",null,o.createElement(F.a,_object_spread_props(_object_spread({},r),{className:s.image})))),o.createElement("div",{className:s.premiumIconContainer},o.createElement(l.a,_object_spread_props(_object_spread({},Object(c.a)("UpgradeProductGlyphColorless_16",u.primaryTextColor)),{className:s.premiumIcon})),o.createElement("span",{className:s.screenReaderText},NotificationStringsManager.get(NotificationStringsEnum.PremiumFeatureDiamond))),o.createElement("div",{className:s.title,id:n,role:"heading","aria-level":1},e),o.createElement("div",{className:s.contentContainer},o.createElement("div",{className:s.message},t)))})}constructor(e){super(e)}}const Oe=e=>()=>o.createElement(je,_object_spread({},e)),Le=e=>{if(!e)return!1;switch(e.type){case"NPSOneClick1":case"NPSOneClick2":case"NPSOneClickRadioButton":case"FloodgateTeachingCallout":return!0;case"IdeasCallout":case"TextAboveImage":case"DeferredContentType":default:return!1}};var Ae=n(2640);const Ne=(e,t)=>{const n=Object(h.a)(e),o={subComponentStyles:{callout:{calloutMain:[g.f.small,{padding:"8px 12px",backgroundColor:n.defaultBackgroundColor,color:n.textColor,lineHeight:16,maxWidth:310}]}}};return Object(g.I)(o,t)},We=6*Math.sqrt(2);class ze extends o.PureComponent{render(){return o.createElement(u.a,null,e=>o.createElement(Ae.a,_object_spread_props(_object_spread({},this.props),{calloutProps:_object_spread({beakWidth:We},this.props.calloutProps),styles:Ne(e,this.props.styles)})))}}var He=n(370),Ve=n(2732),Ue=n(2735),Ge=n(234);class qe extends o.Component{render(){const e=[];for(const t in this.state.entries){const n=this.state.entries[t];e.push(this.props.renderItem(t,n))}return e}canRender(e){return this.props.canRender(e)}contains(e){return!!this.state.entries[e]}add(e){if(!this.canRender(e))return;const t=this.props.keyPrefix+this.keyId;return this.keyId+=1,this.setState(n=>{const o=_object_spread({},n.entries);return o[t]=_object_spread({key:t},e),{entries:o}}),t}remove(e){this.state.entries[e]&&this.setState(t=>{const n=_object_spread({},t.entries);return delete n[e],{entries:n}})}update(e,t){this.state.entries[e]&&this.setState(n=>{const o=_object_spread({},n.entries);return o[e]=t,{entries:o}})}constructor(e){super(e),this.keyId=0,this.state={entries:{}},Object(Ge.a)(this),e.componentRef.current=this}}var Qe=n(1285);const Ke=NotificationStringsManager;NotificationStringsEnum;var Je=n(286),Ye=n(2455),Ze=n(59);const $e=Object(C.c)(e=>()=>{const t={type:"calloutClosed",correlation:e};Object(Ye.a)().emit("calloutClosed",t)}),Xe=Object(C.c)((e,t,n)=>{const o=n.onTargetResolved,r=et(e,t),i=o?(e,t)=>{o(e,t),r(e,t)}:r;return _object_spread_props(_object_spread({},n),{onTargetResolved:i})}),et=Object(C.c)((e,t)=>(n,o)=>{if(Object(Ze.d)()){const r={type:"shouldShowCallout",id:e,targetElement:n};Object(Ye.a)().emitWaitUntil("shouldShowCallout",r).then(()=>{!function(e,t){const n=o=>{Object(Je.a)(o.detail.element,e)&&(t(),Object(Ye.a)().removeListener("elementExit",n))};Object(Ye.a)().addListener("elementExit",n)}(n,t),o()},e=>{})}else o()});var tt=n(2624);class nt extends o.Component{render(){const{rendererRef:e}=this.props;return o.createElement(tt.a,null,o.createElement(qe,{componentRef:e,keyPrefix:"callout",canRender:this.canRender,renderItem:this.renderItem}))}renderCallout(e){var t,n;const{augmentContentProps:r,appColors:i,appStrings:a,icons:s}=this.props.appCustomizations;let l=void 0,c=e;if(e.content){const t=((e,t,n)=>{const r=(null==n?void 0:n.checkmark)||"";switch(e.type){case"TextAboveImage":return{contentRendererCallback:(i=e,e=>o.createElement(O,_object_spread_props(_object_spread({},i),{parentContainerMinWidth:e&&e.minWidth})))};case"DeferredContentType":return{contentRendererCallback:Q(e),calloutPropsUpdate:e=>{var t;return _object_spread_props(_object_spread({},e),{calloutProps:_object_spread_props(_object_spread({},e.calloutProps),{style:_object_spread_props(_object_spread({},null===(t=e.calloutProps)||void 0===t?void 0:t.style),{border:"1px solid "+Object(g.Y)().semanticColors.inputText})})})}};case"NPSOneClickRadioButton":return{contentRendererCallback:Be(_object_spread_props(_object_spread({},e),{appColors:t,checkmarkIcon:r}))};case"IdeasCallout":return{contentRendererCallback:W(e)};case"FloodgateTeachingCallout":return{contentRendererCallback:ie(_object_spread_props(_object_spread({},e),{appColors:t}))};case"PremiumUpsellCallout":const n=Object(ee.a)("PremiumUpsellCalloutTitle");return{contentRendererCallback:Oe(_object_spread_props(_object_spread({},e),{appColors:t,titleId:n})),calloutPropsUpdate:e=>_object_spread_props(_object_spread({},e),{calloutProps:_object_spread_props(_object_spread({},e.calloutProps),{ariaLabelledBy:n})})};default:return Object(B.a)(e)}var i})(r?r(e.content):e.content,i,s);l=t.contentRendererCallback,t.calloutPropsUpdate&&(c=t.calloutPropsUpdate(e))}switch(c.type){case"SimpleCalloutProps":return o.createElement(ze,_object_spread({},c));case"CalloutProps":return o.createElement(Ve.a,_object_spread_props(_object_spread({},c),{appColors:i,closeButtonProps:c.closeButtonProps||{icon:s.closeDark,label:c.customCloseLabel||a.closeLabel},contentRendererFunction:l,hasDynamicSizing:null!==(t=c.hasDynamicSizing)&&void 0!==t?t:Le(c.content),jumpToCalloutTargetButtonProps:c.jumpToCalloutTargetButtonEnabled&&s.jumpToTargetDark?{icon:s.jumpToTargetDark,label:Ke.get(NotificationStringsEnum.JumpToCalloutTarget)}:void 0}));case"TeachingCalloutProps":return o.createElement(Ue.a,_object_spread_props(_object_spread({},c),{appColors:i,closeButtonProps:c.closeButtonProps||{icon:s.closeLight,label:c.customCloseLabel||a.closeLabel},contentRendererFunction:l,hasDynamicSizing:null!==(n=c.hasDynamicSizing)&&void 0!==n?n:Le(c.content),useCoachmark:c.useCoachmark,jumpToCalloutTargetButtonProps:c.jumpToCalloutTargetButtonEnabled&&s.jumpToTargetLight?{icon:s.jumpToTargetLight,label:Ke.get(NotificationStringsEnum.JumpToCalloutTarget)}:void 0}));default:return Object(B.a)(c)}}ensureDismissCallback(e,t,n){const{contentProps:o}=t;return{contentProps:_object_spread_props(_object_spread({},o),{calloutProps:_object_spread_props(_object_spread({},o.calloutProps),{onDismiss:t=>{var r;const{rendererRef:i}=this.props;o.calloutProps&&o.calloutProps.onDismiss&&o.calloutProps.onDismiss(t),"SimpleCalloutProps"!==o.type&&Object(Qe.b)(e,He.b.Dismiss,{key:"HasActionButtons",value:""+!(!o.primaryButtonProps&&!o.secondaryButtonProps)}),null===(r=i.current)||void 0===r||r.remove(e),n&&n.forEach(e=>e())}})})}}addFocusCallback(e){var t;const{contentProps:n,notificationProps:o}=e;let r;const i=n.componentRef;if(!i)return e;let a=n;if("function"==typeof i){let e;a=_object_spread_props(_object_spread({},n),{componentRef:t=>{i(t),e=t}}),r=()=>e&&e.focus()}else r=()=>i.current&&i.current.focus();const s=Object(Ze.c)()&&!(null!==(t=e.contentProps.calloutProps)&&void 0!==t&&t.setInitialFocus);return{contentProps:a,notificationProps:_object_spread_props(_object_spread({},o),{focus:r,isActionable:!0,avoidTakeFocusOnShow:s})}}constructor(){super(...arguments),this.canRender=e=>{const{type:t}=e.contentProps;return"CalloutProps"===t||"SimpleCalloutProps"===t||"TeachingCalloutProps"===t},this.renderItem=Object(C.c)((e,t)=>{var n;const{hostElement:r}=this.props,i=r&&"function"==typeof r?r():r;let{contentProps:a,notificationProps:l}=this.addFocusCallback(t);a=this.ensureDismissCallback(e,{contentProps:a},Object(Ze.d)()?[$e(e)]:[]).contentProps;const c=null===(n=a.calloutProps)||void 0===n?void 0:n.onDismiss;return a=Xe(e,c,a),o.createElement(s.a,_object_spread({key:e,hostElement:i},l),this.renderCallout(a))})}}class ot extends o.Component{render(){return[...this.state.renderers.map(e=>e.rendererElement)]}canRender(e){var t;return!(null===(t=this.getRendererRefForProps(e))||void 0===t||!t.current)}contains(e){return this.state.renderers.some(t=>{var n;return null===(n=t.rendererRef.current)||void 0===n?void 0:n.contains(e)})}add(e){var t;return null===(t=this.getRendererRefForProps(e))||void 0===t||null===(t=t.current)||void 0===t?void 0:t.add(e)}remove(e){var t;null===(t=this.getRendererRefForKey(e))||void 0===t||null===(t=t.current)||void 0===t||t.remove(e)}update(e,t){var n;null===(n=this.getRendererRefForKey(e))||void 0===n||null===(n=n.current)||void 0===n||n.update(e,t)}getRendererRefForProps(e){var t;return null===(t=Object(a.d)(this.state.renderers,t=>{var n;return!(null===(n=t.rendererRef.current)||void 0===n||!n.canRender(e))}))||void 0===t?void 0:t.rendererRef}getRendererRefForKey(e){var t;return null===(t=Object(a.d)(this.state.renderers,t=>{var n;return!(null===(n=t.rendererRef.current)||void 0===n||!n.contains(e))}))||void 0===t?void 0:t.rendererRef}constructor(e){super(e),this.state={renderers:e.rendererFactory.map(e=>{const t=o.createRef();return{rendererRef:t,rendererElement:e(t)}})},Object(Ge.a)(this),e.componentRef.current=this}}const rt=e=>o.createElement(qe,{key:"toast",componentRef:e,keyPrefix:"toast",canRender:it,renderItem:at}),it=e=>"ToastProps"===e.contentProps.type,at=Object(C.c)((e,t)=>o.createElement(i.a,_object_spread_props(_object_spread({key:e},t.notificationProps),{toastProps:t.contentProps}))),st=e=>o.createElement(qe,{key:"external",componentRef:e,keyPrefix:"external",canRender:lt,renderItem:ct}),lt=e=>"ExternalNotificationProps"===e.contentProps.type,ct=Object(C.c)((e,t)=>o.createElement(s.a,_object_spread({key:e},t.notificationProps),o.createElement(o.Fragment,null)));var ut=n(11),dt=n(264),pt=n(55),gt=n(1028),ht=n(2575),mt=n(824),bt=n(109);function ft(e,t,n){var o,r,i;const a="#"+(null!=t?t:e),s=null===(o=document.getElementById(ht.b))||void 0===o?void 0:o.querySelectorAll(a);for(let e=0;s&&e<s.length;e++){const t=s.item(e);if(Object(bt.p)(t))return t}return null!==(r=null!==(i=document.querySelector(`#${n}-${mt.b}`))&&void 0!==i?i:document.querySelector(`#${mt.d}-${mt.b}`))&&void 0!==r?r:document.querySelector("#"+n)}var xt=n(805),Et=n(572);const St=o.createRef();let yt;function Ct(e){const t=document.createElement("div");document.body.appendChild(t),r.render(o.createElement(ot,{componentRef:St,rendererFactory:[t=>{return n={rendererRef:t,hostElement:yt||(()=>yt),appCustomizations:e},o.createElement(nt,_object_spread({key:"callout"},n));var n},rt,st]}),t)}function vt(e){le.a.shipAssertTag(594072578,ce.a.msoulscat_Wac_Telemetry,!yt,"Callout notifications initialized multiple times"),yt=e}function Rt(e,t){const n=e=>{e?i.a.setDefaultContainer(e):le.a.sendTraceTag(594060812,ce.a.msoulscat_Wac_Telemetry,ue.a.Error,"Failed to set default container for ToastNotification. toastContainerRef.current is undefined.")};let a=o.createElement(P,{ref:n});if(Object(ut.b)("Microsoft.Office.SharedOnline.LimitedAppStateNotificationsEnabled",!1)){const e=e=>{e&&t&&i.a.addToastContainer(t.containerId,e)};a=o.createElement(P,{ref:t?e:n,styles:null==t?void 0:t.styles})}r.render(a,e)}function kt(e,t,n,o,r){return e?function(e,t,n,o){var r;return n.target=t,St.current&&e?(St.current.update(e,{contentProps:n,notificationProps:o}),e):(null===(r=St.current)||void 0===r?void 0:r.add({contentProps:n,notificationProps:o}))||null}(r,e,t,n):function(e,t,n,o){var r,i,a,s;return t.target=null!==(r=null==n?void 0:n.fallBackTarget)&&void 0!==r?r:t.target,t.title=null!==(i=null==n?void 0:n.fallBackTitle)&&void 0!==i?i:t.title,t.message=null!==(a=null==n?void 0:n.fallBackMessage)&&void 0!==a?a:t.message,St.current&&e?(St.current.update(e,{contentProps:t}),e):(null===(s=St.current)||void 0===s?void 0:s.add({contentProps:t,notificationProps:void 0}))||null}(r,t,o)}function Tt(e,t){var n,o,r;const i="TeachingCalloutProps"===e.type,a=null!==(n=null==t?void 0:t.telemetryId)&&void 0!==n?n:"UNKNOWN_TELEMETRY_ID",s=i?"string"==typeof e.target?e.target:null===(o=e.target)||void 0===o?void 0:o.id:void 0,l=i?e.useCoachmark:void 0;if(!St.current)return le.a.sendTraceTag(594072579,ce.a.msoulscat_Wac_Telemetry,ue.a.Warning,"Area:ReactNotifications. NotificationsAPI.addNotification called before renderer initialized, TelemetryId: "+a),null;let c=null;const u=()=>c&&_t(c),d=function(e,t,n,o){const{expirationOptions:r,onShow:i}=e;return{onShow:i,telemetryId:t,expirationSettings:r,target:n,useCoachmark:o}}(function(e,t){if(t.expirationOptions){const n=t.expirationOptions.onExpire;return _object_spread_props(_object_spread({},t),{expirationOptions:_object_spread_props(_object_spread({},t.expirationOptions),{onExpire:()=>{n&&n(),e()}})})}return t}(()=>u,null!=t?t:{}),a,s,l),p=null==t?void 0:t.navigationalOptions;let g;p&&p.controlToFindByRibbonMode&&(g="SingleLine"===Object(pt.db)(dt.a.getState())?p.controlToFindByRibbonMode.singleLineId:p.controlToFindByRibbonMode.multiLineId);const h=null!==(r=g)&&void 0!==r?r:null==p?void 0:p.controlToFind;if(h&&i&&t&&d){const n=dt.a.getState(),{hostingTabId:o,hostingParentId:r,hostingGroupId:i}=Object(pt.bb)(n,h),a=Object(pt.jb)(dt.a.getState())===o;if(o&&!a)!function(e,t,n,r){if(e===Object(pt.jb)(dt.a.getState()))return void r();const i=document.getElementById(e),a=new MutationObserver(e=>{"true"===i.getAttribute("aria-selected")&&(a.disconnect(),Object(gt.a)(r))});a.observe(i,{attributes:!0,attributeFilter:["aria-selected"]}),Object(Et.a)(Object(xt.a)(o))}(o,0,0,()=>{const n=ft(h,r,i);c=kt(n,e,t,t.navigationalOptions,c)});else{const n=o?ft(h,r,i):null;c=kt(n,e,t,t.navigationalOptions,c)}}return c||(c=St.current.add({contentProps:e,notificationProps:d})||null),c}function _t(e){var t;null===(t=St.current)||void 0===t||t.remove(e)}function wt(e,t){var n;null===(n=St.current)||void 0===n||n.update(e,{contentProps:t})}function Dt(e){const{primaryButtonProps:t,secondaryButtonProps:n,showCloseIcon:r,target:i,title:a}=e,{hasFocusableControls:s,content:l,useTeachingStyles:c}=e,u=_object_without_properties(e,["hasFocusableControls","content","useTeachingStyles"]);if("string"==typeof l&&!(a||c||s||t||n||r))return{type:"SimpleCalloutProps",target:i,message:l};const d=_object_spread_props(_object_spread({type:"CalloutProps"},u),{componentRef:o.createRef(),hasDynamicSizing:u.hasDynamicSizing});return"string"==typeof l?d.message=l:d.content=l,c?_object_spread_props(_object_spread({},d),{type:"TeachingCalloutProps"}):d}function Pt(){return{type:"ExternalNotificationProps"}}function It(e){return(e=>{switch(e.type){case"TextAboveImage":case"DeferredContentType":case"NPSOneClick1":case"NPSOneClick2":case"NPSOneClickRadioButton":case"IdeasCallout":case"FloodgateTeachingCallout":case"PremiumUpsellCallout":return!0;default:return!1}})(e)}},214:function(e,t,n){(function(e,o){var r;
/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(){var i="Expected a function",a="__lodash_placeholder__",s=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],l="[object Arguments]",c="[object Array]",u="[object Boolean]",d="[object Date]",p="[object Error]",g="[object Function]",h="[object GeneratorFunction]",m="[object Map]",b="[object Number]",f="[object Object]",x="[object RegExp]",E="[object Set]",S="[object String]",y="[object Symbol]",C="[object WeakMap]",v="[object ArrayBuffer]",R="[object DataView]",k="[object Float32Array]",T="[object Float64Array]",_="[object Int8Array]",w="[object Int16Array]",D="[object Int32Array]",P="[object Uint8Array]",I="[object Uint16Array]",F="[object Uint32Array]",B=/\b__p \+= '';/g,M=/\b(__p \+=) '' \+/g,j=/(__e\(.*?\)|\b__t\)) \+\n'';/g,O=/&(?:amp|lt|gt|quot|#39);/g,L=/[&<>"']/g,A=RegExp(O.source),N=RegExp(L.source),W=/<%-([\s\S]+?)%>/g,z=/<%([\s\S]+?)%>/g,H=/<%=([\s\S]+?)%>/g,V=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,U=/^\w*$/,G=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,q=/[\\^$.*+?()[\]{}|]/g,Q=RegExp(q.source),K=/^\s+/,J=/\s/,Y=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Z=/\{\n\/\* \[wrapped with (.+)\] \*/,$=/,? & /,X=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ee=/[()=,{}\[\]\/\s]/,te=/\\(\\)?/g,ne=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,oe=/\w*$/,re=/^[-+]0x[0-9a-f]+$/i,ie=/^0b[01]+$/i,ae=/^\[object .+?Constructor\]$/,se=/^0o[0-7]+$/i,le=/^(?:0|[1-9]\d*)$/,ce=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ue=/($^)/,de=/['\n\r\u2028\u2029\\]/g,pe="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",ge="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",he="["+ge+"]",me="["+pe+"]",be="\\d+",fe="[a-z\\xdf-\\xf6\\xf8-\\xff]",xe="[^\ud800-\udfff"+ge+be+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",Ee="[^\ud800-\udfff]",Se="(?:\ud83c[\udde6-\uddff]){2}",ye="[\ud800-\udbff][\udc00-\udfff]",Ce="[A-Z\\xc0-\\xd6\\xd8-\\xde]",ve="(?:"+fe+"|"+xe+")",Re="(?:"+Ce+"|"+xe+")",ke="(?:"+me+"|\ud83c[\udffb-\udfff])?",Te="[\\ufe0e\\ufe0f]?"+ke+"(?:\\u200d(?:"+[Ee,Se,ye].join("|")+")[\\ufe0e\\ufe0f]?"+ke+")*",_e="(?:"+["[\\u2700-\\u27bf]",Se,ye].join("|")+")"+Te,we="(?:"+[Ee+me+"?",me,Se,ye,"[\ud800-\udfff]"].join("|")+")",De=RegExp("[']","g"),Pe=RegExp(me,"g"),Ie=RegExp("\ud83c[\udffb-\udfff](?=\ud83c[\udffb-\udfff])|"+we+Te,"g"),Fe=RegExp([Ce+"?"+fe+"+(?:['](?:d|ll|m|re|s|t|ve))?(?="+[he,Ce,"$"].join("|")+")",Re+"+(?:['](?:D|LL|M|RE|S|T|VE))?(?="+[he,Ce+ve,"$"].join("|")+")",Ce+"?"+ve+"+(?:['](?:d|ll|m|re|s|t|ve))?",Ce+"+(?:['](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",be,_e].join("|"),"g"),Be=RegExp("[\\u200d\ud800-\udfff"+pe+"\\ufe0e\\ufe0f]"),Me=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,je=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Oe=-1,Le={};Le[k]=Le[T]=Le[_]=Le[w]=Le[D]=Le[P]=Le["[object Uint8ClampedArray]"]=Le[I]=Le[F]=!0,Le[l]=Le[c]=Le[v]=Le[u]=Le[R]=Le[d]=Le[p]=Le[g]=Le[m]=Le[b]=Le[f]=Le[x]=Le[E]=Le[S]=Le[C]=!1;var Ae={};Ae[l]=Ae[c]=Ae[v]=Ae[R]=Ae[u]=Ae[d]=Ae[k]=Ae[T]=Ae[_]=Ae[w]=Ae[D]=Ae[m]=Ae[b]=Ae[f]=Ae[x]=Ae[E]=Ae[S]=Ae[y]=Ae[P]=Ae["[object Uint8ClampedArray]"]=Ae[I]=Ae[F]=!0,Ae[p]=Ae[g]=Ae[C]=!1;var Ne={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},We=parseFloat,ze=parseInt,He="object"==typeof e&&e&&e.Object===Object&&e,Ve="object"==typeof self&&self&&self.Object===Object&&self,Ue=He||Ve||Function("return this")(),Ge=t&&!t.nodeType&&t,qe=Ge&&"object"==typeof o&&o&&!o.nodeType&&o,Qe=qe&&qe.exports===Ge,Ke=Qe&&He.process,Je=function(){try{return qe&&qe.require&&qe.require("util").types||Ke&&Ke.binding&&Ke.binding("util")}catch(e){}}(),Ye=Je&&Je.isArrayBuffer,Ze=Je&&Je.isDate,$e=Je&&Je.isMap,Xe=Je&&Je.isRegExp,et=Je&&Je.isSet,tt=Je&&Je.isTypedArray;function nt(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function ot(e,t,n,o){for(var r=-1,i=null==e?0:e.length;++r<i;){var a=e[r];t(o,a,n(a),e)}return o}function rt(e,t){for(var n=-1,o=null==e?0:e.length;++n<o&&!1!==t(e[n],n,e););return e}function it(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function at(e,t){for(var n=-1,o=null==e?0:e.length;++n<o;)if(!t(e[n],n,e))return!1;return!0}function st(e,t){for(var n=-1,o=null==e?0:e.length,r=0,i=[];++n<o;){var a=e[n];t(a,n,e)&&(i[r++]=a)}return i}function lt(e,t){return!(null==e||!e.length)&&xt(e,t,0)>-1}function ct(e,t,n){for(var o=-1,r=null==e?0:e.length;++o<r;)if(n(t,e[o]))return!0;return!1}function ut(e,t){for(var n=-1,o=null==e?0:e.length,r=Array(o);++n<o;)r[n]=t(e[n],n,e);return r}function dt(e,t){for(var n=-1,o=t.length,r=e.length;++n<o;)e[r+n]=t[n];return e}function pt(e,t,n,o){var r=-1,i=null==e?0:e.length;for(o&&i&&(n=e[++r]);++r<i;)n=t(n,e[r],r,e);return n}function gt(e,t,n,o){var r=null==e?0:e.length;for(o&&r&&(n=e[--r]);r--;)n=t(n,e[r],r,e);return n}function ht(e,t){for(var n=-1,o=null==e?0:e.length;++n<o;)if(t(e[n],n,e))return!0;return!1}var mt=Ct("length");function bt(e,t,n){var o;return n(e,(function(e,n,r){if(t(e,n,r))return o=n,!1})),o}function ft(e,t,n,o){for(var r=e.length,i=n+(o?1:-1);o?i--:++i<r;)if(t(e[i],i,e))return i;return-1}function xt(e,t,n){return t==t?function(e,t,n){for(var o=n-1,r=e.length;++o<r;)if(e[o]===t)return o;return-1}(e,t,n):ft(e,St,n)}function Et(e,t,n,o){for(var r=n-1,i=e.length;++r<i;)if(o(e[r],t))return r;return-1}function St(e){return e!=e}function yt(e,t){var n=null==e?0:e.length;return n?kt(e,t)/n:NaN}function Ct(e){return function(t){return null==t?void 0:t[e]}}function vt(e){return function(t){return null==e?void 0:e[t]}}function Rt(e,t,n,o,r){return r(e,(function(e,r,i){n=o?(o=!1,e):t(n,e,r,i)})),n}function kt(e,t){for(var n,o=-1,r=e.length;++o<r;){var i=t(e[o]);void 0!==i&&(n=void 0===n?i:n+i)}return n}function Tt(e,t){for(var n=-1,o=Array(e);++n<e;)o[n]=t(n);return o}function _t(e){return e?e.slice(0,Ut(e)+1).replace(K,""):e}function wt(e){return function(t){return e(t)}}function Dt(e,t){return ut(t,(function(t){return e[t]}))}function Pt(e,t){return e.has(t)}function It(e,t){for(var n=-1,o=e.length;++n<o&&xt(t,e[n],0)>-1;);return n}function Ft(e,t){for(var n=e.length;n--&&xt(t,e[n],0)>-1;);return n}function Bt(e,t){for(var n=e.length,o=0;n--;)e[n]===t&&++o;return o}var Mt=vt({"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss","":"A","":"A","":"A","":"a","":"a","":"a","":"C","":"C","":"C","":"C","":"c","":"c","":"c","":"c","":"D","":"D","":"d","":"d","":"E","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"e","":"G","":"G","":"G","":"G","":"g","":"g","":"g","":"g","":"H","":"H","":"h","":"h","":"I","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"i","":"J","":"j","":"K","":"k","":"k","":"L","":"L","":"L","":"L","":"L","":"l","":"l","":"l","":"l","":"l","":"N","":"N","":"N","":"N","":"n","":"n","":"n","":"n","":"O","":"O","":"O","":"o","":"o","":"o","":"R","":"R","":"R","":"r","":"r","":"r","":"S","":"S","":"S","":"S","":"s","":"s","":"s","":"s","":"T","":"T","":"T","":"t","":"t","":"t","":"U","":"U","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"u","":"u","":"W","":"w","":"Y","":"y","":"Y","":"Z","":"Z","":"Z","":"z","":"z","":"z","":"IJ","":"ij","":"Oe","":"oe","":"'n","":"s"}),jt=vt({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Ot(e){return"\\"+Ne[e]}function Lt(e){return Be.test(e)}function At(e){var t=-1,n=Array(e.size);return e.forEach((function(e,o){n[++t]=[o,e]})),n}function Nt(e,t){return function(n){return e(t(n))}}function Wt(e,t){for(var n=-1,o=e.length,r=0,i=[];++n<o;){var s=e[n];s!==t&&s!==a||(e[n]=a,i[r++]=n)}return i}function zt(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}function Ht(e){return Lt(e)?function(e){for(var t=Ie.lastIndex=0;Ie.test(e);)++t;return t}(e):mt(e)}function Vt(e){return Lt(e)?function(e){return e.match(Ie)||[]}(e):function(e){return e.split("")}(e)}function Ut(e){for(var t=e.length;t--&&J.test(e.charAt(t)););return t}var Gt=vt({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),qt=function e(t){var n,o=(t=null==t?Ue:qt.defaults(Ue.Object(),t,qt.pick(Ue,je))).Array,r=t.Date,J=t.Error,pe=t.Function,ge=t.Math,he=t.Object,me=t.RegExp,be=t.String,fe=t.TypeError,xe=o.prototype,Ee=pe.prototype,Se=he.prototype,ye=t["__core-js_shared__"],Ce=Ee.toString,ve=Se.hasOwnProperty,Re=0,ke=(n=/[^.]+$/.exec(ye&&ye.keys&&ye.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",Te=Se.toString,_e=Ce.call(he),we=Ue._,Ie=me("^"+Ce.call(ve).replace(q,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Be=Qe?t.Buffer:void 0,Ne=t.Symbol,He=t.Uint8Array,Ve=Be?Be.allocUnsafe:void 0,Ge=Nt(he.getPrototypeOf,he),qe=he.create,Ke=Se.propertyIsEnumerable,Je=xe.splice,mt=Ne?Ne.isConcatSpreadable:void 0,vt=Ne?Ne.iterator:void 0,Qt=Ne?Ne.toStringTag:void 0,Kt=function(){try{var e=Xr(he,"defineProperty");return e({},"",{}),e}catch(e){}}(),Jt=t.clearTimeout!==Ue.clearTimeout&&t.clearTimeout,Yt=r&&r.now!==Ue.Date.now&&r.now,Zt=t.setTimeout!==Ue.setTimeout&&t.setTimeout,$t=ge.ceil,Xt=ge.floor,en=he.getOwnPropertySymbols,tn=Be?Be.isBuffer:void 0,nn=t.isFinite,on=xe.join,rn=Nt(he.keys,he),an=ge.max,sn=ge.min,ln=r.now,cn=t.parseInt,un=ge.random,dn=xe.reverse,pn=Xr(t,"DataView"),gn=Xr(t,"Map"),hn=Xr(t,"Promise"),mn=Xr(t,"Set"),bn=Xr(t,"WeakMap"),fn=Xr(he,"create"),xn=bn&&new bn,En={},Sn=wi(pn),yn=wi(gn),Cn=wi(hn),vn=wi(mn),Rn=wi(bn),kn=Ne?Ne.prototype:void 0,Tn=kn?kn.valueOf:void 0,_n=kn?kn.toString:void 0;function wn(e){if(Ga(e)&&!Ma(e)&&!(e instanceof Fn)){if(e instanceof In)return e;if(ve.call(e,"__wrapped__"))return Di(e)}return new In(e)}var Dn=function(){function e(){}return function(t){if(!Ua(t))return{};if(qe)return qe(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function Pn(){}function In(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}function Fn(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function Bn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function Mn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function jn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function On(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new jn;++t<n;)this.add(e[t])}function Ln(e){var t=this.__data__=new Mn(e);this.size=t.size}function An(e,t){var n=Ma(e),o=!n&&Ba(e),r=!n&&!o&&Aa(e),i=!n&&!o&&!r&&Xa(e),a=n||o||r||i,s=a?Tt(e.length,be):[],l=s.length;for(var c in e)!t&&!ve.call(e,c)||a&&("length"==c||r&&("offset"==c||"parent"==c)||i&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||ai(c,l))||s.push(c);return s}function Nn(e){var t=e.length;return t?e[Oo(0,t-1)]:void 0}function Wn(e,t){return vi(fr(e),Jn(t,0,e.length))}function zn(e){return vi(fr(e))}function Hn(e,t,n){(void 0!==n&&!Pa(e[t],n)||void 0===n&&!(t in e))&&Qn(e,t,n)}function Vn(e,t,n){var o=e[t];ve.call(e,t)&&Pa(o,n)&&(void 0!==n||t in e)||Qn(e,t,n)}function Un(e,t){for(var n=e.length;n--;)if(Pa(e[n][0],t))return n;return-1}function Gn(e,t,n,o){return eo(e,(function(e,r,i){t(o,e,n(e),i)})),o}function qn(e,t){return e&&xr(t,ys(t),e)}function Qn(e,t,n){"__proto__"==t&&Kt?Kt(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function Kn(e,t){for(var n=-1,r=t.length,i=o(r),a=null==e;++n<r;)i[n]=a?void 0:bs(e,t[n]);return i}function Jn(e,t,n){return e==e&&(void 0!==n&&(e=e<=n?e:n),void 0!==t&&(e=e>=t?e:t)),e}function Yn(e,t,n,o,r,i){var a,s=1&t,c=2&t,p=4&t;if(n&&(a=r?n(e,o,r,i):n(e)),void 0!==a)return a;if(!Ua(e))return e;var C=Ma(e);if(C){if(a=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&ve.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!s)return fr(e,a)}else{var B=ni(e),M=B==g||B==h;if(Aa(e))return dr(e,s);if(B==f||B==l||M&&!r){if(a=c||M?{}:ri(e),!s)return c?function(e,t){return xr(e,ti(e),t)}(e,function(e,t){return e&&xr(t,Cs(t),e)}(a,e)):function(e,t){return xr(e,ei(e),t)}(e,qn(a,e))}else{if(!Ae[B])return r?e:{};a=function(e,t,n){var o,r=e.constructor;switch(t){case v:return pr(e);case u:case d:return new r(+e);case R:return function(e,t){var n=t?pr(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case k:case T:case _:case w:case D:case P:case"[object Uint8ClampedArray]":case I:case F:return gr(e,n);case m:return new r;case b:case S:return new r(e);case x:return function(e){var t=new e.constructor(e.source,oe.exec(e));return t.lastIndex=e.lastIndex,t}(e);case E:return new r;case y:return o=e,Tn?he(Tn.call(o)):{}}}(e,B,s)}}i||(i=new Ln);var j=i.get(e);if(j)return j;i.set(e,a),Ya(e)?e.forEach((function(o){a.add(Yn(o,t,n,o,e,i))})):qa(e)&&e.forEach((function(o,r){a.set(r,Yn(o,t,n,r,e,i))}));var O=C?void 0:(p?c?qr:Gr:c?Cs:ys)(e);return rt(O||e,(function(o,r){O&&(o=e[r=o]),Vn(a,r,Yn(o,t,n,r,e,i))})),a}function Zn(e,t,n){var o=n.length;if(null==e)return!o;for(e=he(e);o--;){var r=n[o],i=t[r],a=e[r];if(void 0===a&&!(r in e)||!i(a))return!1}return!0}function $n(e,t,n){if("function"!=typeof e)throw new fe(i);return Ei((function(){e.apply(void 0,n)}),t)}function Xn(e,t,n,o){var r=-1,i=lt,a=!0,s=e.length,l=[],c=t.length;if(!s)return l;n&&(t=ut(t,wt(n))),o?(i=ct,a=!1):t.length>=200&&(i=Pt,a=!1,t=new On(t));e:for(;++r<s;){var u=e[r],d=null==n?u:n(u);if(u=o||0!==u?u:0,a&&d==d){for(var p=c;p--;)if(t[p]===d)continue e;l.push(u)}else i(t,d,o)||l.push(u)}return l}wn.templateSettings={escape:W,evaluate:z,interpolate:H,variable:"",imports:{_:wn}},wn.prototype=Pn.prototype,wn.prototype.constructor=wn,In.prototype=Dn(Pn.prototype),In.prototype.constructor=In,Fn.prototype=Dn(Pn.prototype),Fn.prototype.constructor=Fn,Bn.prototype.clear=function(){this.__data__=fn?fn(null):{},this.size=0},Bn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Bn.prototype.get=function(e){var t=this.__data__;if(fn){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return ve.call(t,e)?t[e]:void 0},Bn.prototype.has=function(e){var t=this.__data__;return fn?void 0!==t[e]:ve.call(t,e)},Bn.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=fn&&void 0===t?"__lodash_hash_undefined__":t,this},Mn.prototype.clear=function(){this.__data__=[],this.size=0},Mn.prototype.delete=function(e){var t=this.__data__,n=Un(t,e);return!(n<0||(n==t.length-1?t.pop():Je.call(t,n,1),--this.size,0))},Mn.prototype.get=function(e){var t=this.__data__,n=Un(t,e);return n<0?void 0:t[n][1]},Mn.prototype.has=function(e){return Un(this.__data__,e)>-1},Mn.prototype.set=function(e,t){var n=this.__data__,o=Un(n,e);return o<0?(++this.size,n.push([e,t])):n[o][1]=t,this},jn.prototype.clear=function(){this.size=0,this.__data__={hash:new Bn,map:new(gn||Mn),string:new Bn}},jn.prototype.delete=function(e){var t=Zr(this,e).delete(e);return this.size-=t?1:0,t},jn.prototype.get=function(e){return Zr(this,e).get(e)},jn.prototype.has=function(e){return Zr(this,e).has(e)},jn.prototype.set=function(e,t){var n=Zr(this,e),o=n.size;return n.set(e,t),this.size+=n.size==o?0:1,this},On.prototype.add=On.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},On.prototype.has=function(e){return this.__data__.has(e)},Ln.prototype.clear=function(){this.__data__=new Mn,this.size=0},Ln.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Ln.prototype.get=function(e){return this.__data__.get(e)},Ln.prototype.has=function(e){return this.__data__.has(e)},Ln.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Mn){var o=n.__data__;if(!gn||o.length<199)return o.push([e,t]),this.size=++n.size,this;n=this.__data__=new jn(o)}return n.set(e,t),this.size=n.size,this};var eo=yr(lo),to=yr(co,!0);function no(e,t){var n=!0;return eo(e,(function(e,o,r){return n=!!t(e,o,r)})),n}function oo(e,t,n){for(var o=-1,r=e.length;++o<r;){var i=e[o],a=t(i);if(null!=a&&(void 0===s?a==a&&!$a(a):n(a,s)))var s=a,l=i}return l}function ro(e,t){var n=[];return eo(e,(function(e,o,r){t(e,o,r)&&n.push(e)})),n}function io(e,t,n,o,r){var i=-1,a=e.length;for(n||(n=ii),r||(r=[]);++i<a;){var s=e[i];t>0&&n(s)?t>1?io(s,t-1,n,o,r):dt(r,s):o||(r[r.length]=s)}return r}var ao=Cr(),so=Cr(!0);function lo(e,t){return e&&ao(e,t,ys)}function co(e,t){return e&&so(e,t,ys)}function uo(e,t){return st(t,(function(t){return za(e[t])}))}function po(e,t){for(var n=0,o=(t=sr(t,e)).length;null!=e&&n<o;)e=e[_i(t[n++])];return n&&n==o?e:void 0}function go(e,t,n){var o=t(e);return Ma(e)?o:dt(o,n(e))}function ho(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Qt&&Qt in he(e)?function(e){var t=ve.call(e,Qt),n=e[Qt];try{e[Qt]=void 0;var o=!0}catch(e){}var r=Te.call(e);return o&&(t?e[Qt]=n:delete e[Qt]),r}(e):function(e){return Te.call(e)}(e)}function mo(e,t){return e>t}function bo(e,t){return null!=e&&ve.call(e,t)}function fo(e,t){return null!=e&&t in he(e)}function xo(e,t,n){for(var r=n?ct:lt,i=e[0].length,a=e.length,s=a,l=o(a),c=1/0,u=[];s--;){var d=e[s];s&&t&&(d=ut(d,wt(t))),c=sn(d.length,c),l[s]=!n&&(t||i>=120&&d.length>=120)?new On(s&&d):void 0}d=e[0];var p=-1,g=l[0];e:for(;++p<i&&u.length<c;){var h=d[p],m=t?t(h):h;if(h=n||0!==h?h:0,!(g?Pt(g,m):r(u,m,n))){for(s=a;--s;){var b=l[s];if(!(b?Pt(b,m):r(e[s],m,n)))continue e}g&&g.push(m),u.push(h)}}return u}function Eo(e,t,n){var o=null==(e=mi(e,t=sr(t,e)))?e:e[_i(Wi(t))];return null==o?void 0:nt(o,e,n)}function So(e){return Ga(e)&&ho(e)==l}function yo(e,t,n,o,r){return e===t||(null==e||null==t||!Ga(e)&&!Ga(t)?e!=e&&t!=t:function(e,t,n,o,r,i){var a=Ma(e),s=Ma(t),g=a?c:ni(e),h=s?c:ni(t),C=(g=g==l?f:g)==f,k=(h=h==l?f:h)==f,T=g==h;if(T&&Aa(e)){if(!Aa(t))return!1;a=!0,C=!1}if(T&&!C)return i||(i=new Ln),a||Xa(e)?Vr(e,t,n,o,r,i):function(e,t,n,o,r,i,a){switch(n){case R:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case v:return!(e.byteLength!=t.byteLength||!i(new He(e),new He(t)));case u:case d:case b:return Pa(+e,+t);case p:return e.name==t.name&&e.message==t.message;case x:case S:return e==t+"";case m:var s=At;case E:var l=1&o;if(s||(s=zt),e.size!=t.size&&!l)return!1;var c=a.get(e);if(c)return c==t;o|=2,a.set(e,t);var g=Vr(s(e),s(t),o,r,i,a);return a.delete(e),g;case y:if(Tn)return Tn.call(e)==Tn.call(t)}return!1}(e,t,g,n,o,r,i);if(!(1&n)){var _=C&&ve.call(e,"__wrapped__"),w=k&&ve.call(t,"__wrapped__");if(_||w){var D=_?e.value():e,P=w?t.value():t;return i||(i=new Ln),r(D,P,n,o,i)}}return!!T&&(i||(i=new Ln),function(e,t,n,o,r,i){var a=1&n,s=Gr(e),l=s.length;if(l!=Gr(t).length&&!a)return!1;for(var c=l;c--;){var u=s[c];if(!(a?u in t:ve.call(t,u)))return!1}var d=i.get(e),p=i.get(t);if(d&&p)return d==t&&p==e;var g=!0;i.set(e,t),i.set(t,e);for(var h=a;++c<l;){var m=e[u=s[c]],b=t[u];if(o)var f=a?o(b,m,u,t,e,i):o(m,b,u,e,t,i);if(!(void 0===f?m===b||r(m,b,n,o,i):f)){g=!1;break}h||(h="constructor"==u)}if(g&&!h){var x=e.constructor,E=t.constructor;x==E||!("constructor"in e)||!("constructor"in t)||"function"==typeof x&&x instanceof x&&"function"==typeof E&&E instanceof E||(g=!1)}return i.delete(e),i.delete(t),g}(e,t,n,o,r,i))}(e,t,n,o,yo,r))}function Co(e,t,n,o){var r=n.length,i=r,a=!o;if(null==e)return!i;for(e=he(e);r--;){var s=n[r];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++r<i;){var l=(s=n[r])[0],c=e[l],u=s[1];if(a&&s[2]){if(void 0===c&&!(l in e))return!1}else{var d=new Ln;if(o)var p=o(c,u,l,e,t,d);if(!(void 0===p?yo(u,c,3,o,d):p))return!1}}return!0}function vo(e){return!(!Ua(e)||(t=e,ke&&ke in t))&&(za(e)?Ie:ae).test(wi(e));var t}function Ro(e){return"function"==typeof e?e:null==e?Qs:"object"==typeof e?Ma(e)?Do(e[0],e[1]):wo(e):nl(e)}function ko(e){if(!di(e))return rn(e);var t=[];for(var n in he(e))ve.call(e,n)&&"constructor"!=n&&t.push(n);return t}function To(e,t){return e<t}function _o(e,t){var n=-1,r=Oa(e)?o(e.length):[];return eo(e,(function(e,o,i){r[++n]=t(e,o,i)})),r}function wo(e){var t=$r(e);return 1==t.length&&t[0][2]?gi(t[0][0],t[0][1]):function(n){return n===e||Co(n,e,t)}}function Do(e,t){return li(e)&&pi(t)?gi(_i(e),t):function(n){var o=bs(n,e);return void 0===o&&o===t?fs(n,e):yo(t,o,3)}}function Po(e,t,n,o,r){e!==t&&ao(t,(function(i,a){if(r||(r=new Ln),Ua(i))!function(e,t,n,o,r,i,a){var s=fi(e,n),l=fi(t,n),c=a.get(l);if(c)Hn(e,n,c);else{var u=i?i(s,l,n+"",e,t,a):void 0,d=void 0===u;if(d){var p=Ma(l),g=!p&&Aa(l),h=!p&&!g&&Xa(l);u=l,p||g||h?Ma(s)?u=s:La(s)?u=fr(s):g?(d=!1,u=dr(l,!0)):h?(d=!1,u=gr(l,!0)):u=[]:Ka(l)||Ba(l)?(u=s,Ba(s)?u=ss(s):Ua(s)&&!za(s)||(u=ri(l))):d=!1}d&&(a.set(l,u),r(u,l,o,i,a),a.delete(l)),Hn(e,n,u)}}(e,t,a,n,Po,o,r);else{var s=o?o(fi(e,a),i,a+"",e,t,r):void 0;void 0===s&&(s=i),Hn(e,a,s)}}),Cs)}function Io(e,t){var n=e.length;if(n)return ai(t+=t<0?n:0,n)?e[t]:void 0}function Fo(e,t,n){t=t.length?ut(t,(function(e){return Ma(e)?function(t){return po(t,1===e.length?e[0]:e)}:e})):[Qs];var o=-1;return t=ut(t,wt(Yr())),function(e,t){var o=e.length;for(e.sort((function(e,t){return function(e,t,n){for(var o=-1,r=e.criteria,i=t.criteria,a=r.length,s=n.length;++o<a;){var l=hr(r[o],i[o]);if(l)return o>=s?l:l*("desc"==n[o]?-1:1)}return e.index-t.index}(e,t,n)}));o--;)e[o]=e[o].value;return e}(_o(e,(function(e,n,r){return{criteria:ut(t,(function(t){return t(e)})),index:++o,value:e}})))}function Bo(e,t,n){for(var o=-1,r=t.length,i={};++o<r;){var a=t[o],s=po(e,a);n(s,a)&&zo(i,sr(a,e),s)}return i}function Mo(e,t,n,o){var r=o?Et:xt,i=-1,a=t.length,s=e;for(e===t&&(t=fr(t)),n&&(s=ut(e,wt(n)));++i<a;)for(var l=0,c=t[i],u=n?n(c):c;(l=r(s,u,l,o))>-1;)s!==e&&Je.call(s,l,1),Je.call(e,l,1);return e}function jo(e,t){for(var n=e?t.length:0,o=n-1;n--;){var r=t[n];if(n==o||r!==i){var i=r;ai(r)?Je.call(e,r,1):Xo(e,r)}}return e}function Oo(e,t){return e+Xt(un()*(t-e+1))}function Lo(e,t){var n="";if(!e||t<1||t>9007199254740991)return n;do{t%2&&(n+=e),(t=Xt(t/2))&&(e+=e)}while(t);return n}function Ao(e,t){return Si(hi(e,t,Qs),e+"")}function No(e){return Nn(Ps(e))}function Wo(e,t){var n=Ps(e);return vi(n,Jn(t,0,n.length))}function zo(e,t,n,o){if(!Ua(e))return e;for(var r=-1,i=(t=sr(t,e)).length,a=i-1,s=e;null!=s&&++r<i;){var l=_i(t[r]),c=n;if("__proto__"===l||"constructor"===l||"prototype"===l)return e;if(r!=a){var u=s[l];void 0===(c=o?o(u,l,s):void 0)&&(c=Ua(u)?u:ai(t[r+1])?[]:{})}Vn(s,l,c),s=s[l]}return e}var Ho=xn?function(e,t){return xn.set(e,t),e}:Qs,Vo=Kt?function(e,t){return Kt(e,"toString",{configurable:!0,enumerable:!1,value:Us(t),writable:!0})}:Qs;function Uo(e){return vi(Ps(e))}function Go(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var a=o(i);++r<i;)a[r]=e[r+t];return a}function qo(e,t){var n;return eo(e,(function(e,o,r){return!(n=t(e,o,r))})),!!n}function Qo(e,t,n){var o=0,r=null==e?o:e.length;if("number"==typeof t&&t==t&&r<=2147483647){for(;o<r;){var i=o+r>>>1,a=e[i];null!==a&&!$a(a)&&(n?a<=t:a<t)?o=i+1:r=i}return r}return Ko(e,t,Qs,n)}function Ko(e,t,n,o){var r=0,i=null==e?0:e.length;if(0===i)return 0;for(var a=(t=n(t))!=t,s=null===t,l=$a(t),c=void 0===t;r<i;){var u=Xt((r+i)/2),d=n(e[u]),p=void 0!==d,g=null===d,h=d==d,m=$a(d);if(a)var b=o||h;else b=c?h&&(o||p):s?h&&p&&(o||!g):l?h&&p&&!g&&(o||!m):!g&&!m&&(o?d<=t:d<t);b?r=u+1:i=u}return sn(i,4294967294)}function Jo(e,t){for(var n=-1,o=e.length,r=0,i=[];++n<o;){var a=e[n],s=t?t(a):a;if(!n||!Pa(s,l)){var l=s;i[r++]=0===a?0:a}}return i}function Yo(e){return"number"==typeof e?e:$a(e)?NaN:+e}function Zo(e){if("string"==typeof e)return e;if(Ma(e))return ut(e,Zo)+"";if($a(e))return _n?_n.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function $o(e,t,n){var o=-1,r=lt,i=e.length,a=!0,s=[],l=s;if(n)a=!1,r=ct;else if(i>=200){var c=t?null:Lr(e);if(c)return zt(c);a=!1,r=Pt,l=new On}else l=t?[]:s;e:for(;++o<i;){var u=e[o],d=t?t(u):u;if(u=n||0!==u?u:0,a&&d==d){for(var p=l.length;p--;)if(l[p]===d)continue e;t&&l.push(d),s.push(u)}else r(l,d,n)||(l!==s&&l.push(d),s.push(u))}return s}function Xo(e,t){return null==(e=mi(e,t=sr(t,e)))||delete e[_i(Wi(t))]}function er(e,t,n,o){return zo(e,t,n(po(e,t)),o)}function tr(e,t,n,o){for(var r=e.length,i=o?r:-1;(o?i--:++i<r)&&t(e[i],i,e););return n?Go(e,o?0:i,o?i+1:r):Go(e,o?i+1:0,o?r:i)}function nr(e,t){var n=e;return n instanceof Fn&&(n=n.value()),pt(t,(function(e,t){return t.func.apply(t.thisArg,dt([e],t.args))}),n)}function or(e,t,n){var r=e.length;if(r<2)return r?$o(e[0]):[];for(var i=-1,a=o(r);++i<r;)for(var s=e[i],l=-1;++l<r;)l!=i&&(a[i]=Xn(a[i]||s,e[l],t,n));return $o(io(a,1),t,n)}function rr(e,t,n){for(var o=-1,r=e.length,i=t.length,a={};++o<r;){var s=o<i?t[o]:void 0;n(a,e[o],s)}return a}function ir(e){return La(e)?e:[]}function ar(e){return"function"==typeof e?e:Qs}function sr(e,t){return Ma(e)?e:li(e,t)?[e]:Ti(ls(e))}var lr=Ao;function cr(e,t,n){var o=e.length;return n=void 0===n?o:n,!t&&n>=o?e:Go(e,t,n)}var ur=Jt||function(e){return Ue.clearTimeout(e)};function dr(e,t){if(t)return e.slice();var n=e.length,o=Ve?Ve(n):new e.constructor(n);return e.copy(o),o}function pr(e){var t=new e.constructor(e.byteLength);return new He(t).set(new He(e)),t}function gr(e,t){var n=t?pr(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function hr(e,t){if(e!==t){var n=void 0!==e,o=null===e,r=e==e,i=$a(e),a=void 0!==t,s=null===t,l=t==t,c=$a(t);if(!s&&!c&&!i&&e>t||i&&a&&l&&!s&&!c||o&&a&&l||!n&&l||!r)return 1;if(!o&&!i&&!c&&e<t||c&&n&&r&&!o&&!i||s&&n&&r||!a&&r||!l)return-1}return 0}function mr(e,t,n,r){for(var i=-1,a=e.length,s=n.length,l=-1,c=t.length,u=an(a-s,0),d=o(c+u),p=!r;++l<c;)d[l]=t[l];for(;++i<s;)(p||i<a)&&(d[n[i]]=e[i]);for(;u--;)d[l++]=e[i++];return d}function br(e,t,n,r){for(var i=-1,a=e.length,s=-1,l=n.length,c=-1,u=t.length,d=an(a-l,0),p=o(d+u),g=!r;++i<d;)p[i]=e[i];for(var h=i;++c<u;)p[h+c]=t[c];for(;++s<l;)(g||i<a)&&(p[h+n[s]]=e[i++]);return p}function fr(e,t){var n=-1,r=e.length;for(t||(t=o(r));++n<r;)t[n]=e[n];return t}function xr(e,t,n,o){var r=!n;n||(n={});for(var i=-1,a=t.length;++i<a;){var s=t[i],l=o?o(n[s],e[s],s,n,e):void 0;void 0===l&&(l=e[s]),r?Qn(n,s,l):Vn(n,s,l)}return n}function Er(e,t){return function(n,o){var r=Ma(n)?ot:Gn,i=t?t():{};return r(n,e,Yr(o,2),i)}}function Sr(e){return Ao((function(t,n){var o=-1,r=n.length,i=r>1?n[r-1]:void 0,a=r>2?n[2]:void 0;for(i=e.length>3&&"function"==typeof i?(r--,i):void 0,a&&si(n[0],n[1],a)&&(i=r<3?void 0:i,r=1),t=he(t);++o<r;){var s=n[o];s&&e(t,s,o,i)}return t}))}function yr(e,t){return function(n,o){if(null==n)return n;if(!Oa(n))return e(n,o);for(var r=n.length,i=t?r:-1,a=he(n);(t?i--:++i<r)&&!1!==o(a[i],i,a););return n}}function Cr(e){return function(t,n,o){for(var r=-1,i=he(t),a=o(t),s=a.length;s--;){var l=a[e?s:++r];if(!1===n(i[l],l,i))break}return t}}function vr(e){return function(t){var n=Lt(t=ls(t))?Vt(t):void 0,o=n?n[0]:t.charAt(0),r=n?cr(n,1).join(""):t.slice(1);return o[e]()+r}}function Rr(e){return function(t){return pt(zs(Bs(t).replace(De,"")),e,"")}}function kr(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Dn(e.prototype),o=e.apply(n,t);return Ua(o)?o:n}}function Tr(e){return function(t,n,o){var r=he(t);if(!Oa(t)){var i=Yr(n,3);t=ys(t),n=function(e){return i(r[e],e,r)}}var a=e(t,n,o);return a>-1?r[i?t[a]:a]:void 0}}function _r(e){return Ur((function(t){var n=t.length,o=n,r=In.prototype.thru;for(e&&t.reverse();o--;){var a=t[o];if("function"!=typeof a)throw new fe(i);if(r&&!s&&"wrapper"==Kr(a))var s=new In([],!0)}for(o=s?o:n;++o<n;){var l=Kr(a=t[o]),c="wrapper"==l?Qr(a):void 0;s=c&&ci(c[0])&&424==c[1]&&!c[4].length&&1==c[9]?s[Kr(c[0])].apply(s,c[3]):1==a.length&&ci(a)?s[l]():s.thru(a)}return function(){var e=arguments,o=e[0];if(s&&1==e.length&&Ma(o))return s.plant(o).value();for(var r=0,i=n?t[r].apply(this,e):o;++r<n;)i=t[r].call(this,i);return i}}))}function wr(e,t,n,r,i,a,s,l,c,u){var d=128&t,p=1&t,g=2&t,h=24&t,m=512&t,b=g?void 0:kr(e);return function f(){for(var x=arguments.length,E=o(x),S=x;S--;)E[S]=arguments[S];if(h)var y=Jr(f),C=Bt(E,y);if(r&&(E=mr(E,r,i,h)),a&&(E=br(E,a,s,h)),x-=C,h&&x<u){var v=Wt(E,y);return jr(e,t,wr,f.placeholder,n,E,v,l,c,u-x)}var R=p?n:this,k=g?R[e]:e;return x=E.length,l?E=bi(E,l):m&&x>1&&E.reverse(),d&&c<x&&(E.length=c),this&&this!==Ue&&this instanceof f&&(k=b||kr(k)),k.apply(R,E)}}function Dr(e,t){return function(n,o){return function(e,t,n,o){return lo(e,(function(e,r,i){t(o,n(e),r,i)})),o}(n,e,t(o),{})}}function Pr(e,t){return function(n,o){var r;if(void 0===n&&void 0===o)return t;if(void 0!==n&&(r=n),void 0!==o){if(void 0===r)return o;"string"==typeof n||"string"==typeof o?(n=Zo(n),o=Zo(o)):(n=Yo(n),o=Yo(o)),r=e(n,o)}return r}}function Ir(e){return Ur((function(t){return t=ut(t,wt(Yr())),Ao((function(n){var o=this;return e(t,(function(e){return nt(e,o,n)}))}))}))}function Fr(e,t){var n=(t=void 0===t?" ":Zo(t)).length;if(n<2)return n?Lo(t,e):t;var o=Lo(t,$t(e/Ht(t)));return Lt(t)?cr(Vt(o),0,e).join(""):o.slice(0,e)}function Br(e){return function(t,n,r){return r&&"number"!=typeof r&&si(t,n,r)&&(n=r=void 0),t=os(t),void 0===n?(n=t,t=0):n=os(n),function(e,t,n,r){for(var i=-1,a=an($t((t-e)/(n||1)),0),s=o(a);a--;)s[r?a:++i]=e,e+=n;return s}(t,n,r=void 0===r?t<n?1:-1:os(r),e)}}function Mr(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=as(t),n=as(n)),e(t,n)}}function jr(e,t,n,o,r,i,a,s,l,c){var u=8&t;t|=u?32:64,4&(t&=~(u?64:32))||(t&=-4);var d=[e,t,r,u?i:void 0,u?a:void 0,u?void 0:i,u?void 0:a,s,l,c],p=n.apply(void 0,d);return ci(e)&&xi(p,d),p.placeholder=o,yi(p,e,t)}function Or(e){var t=ge[e];return function(e,n){if(e=as(e),(n=null==n?0:sn(rs(n),292))&&nn(e)){var o=(ls(e)+"e").split("e");return+((o=(ls(t(o[0]+"e"+(+o[1]+n)))+"e").split("e"))[0]+"e"+(+o[1]-n))}return t(e)}}var Lr=mn&&1/zt(new mn([,-0]))[1]==1/0?function(e){return new mn(e)}:$s;function Ar(e){return function(t){var n,o,r,i=ni(t);return i==m?At(t):i==E?(n=t,o=-1,r=Array(n.size),n.forEach((function(e){r[++o]=[e,e]})),r):function(e,t){return ut(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function Nr(e,t,n,r,s,l,c,u){var d=2&t;if(!d&&"function"!=typeof e)throw new fe(i);var p=r?r.length:0;if(p||(t&=-97,r=s=void 0),c=void 0===c?c:an(rs(c),0),u=void 0===u?u:rs(u),p-=s?s.length:0,64&t){var g=r,h=s;r=s=void 0}var m=d?void 0:Qr(e),b=[e,t,n,r,s,g,h,l,c,u];if(m&&function(e,t){var n=e[1],o=t[1],r=n|o,i=r<131,s=128==o&&8==n||128==o&&256==n&&e[7].length<=t[8]||384==o&&t[7].length<=t[8]&&8==n;if(!i&&!s)return e;1&o&&(e[2]=t[2],r|=1&n?0:4);var l=t[3];if(l){var c=e[3];e[3]=c?mr(c,l,t[4]):l,e[4]=c?Wt(e[3],a):t[4]}(l=t[5])&&(c=e[5],e[5]=c?br(c,l,t[6]):l,e[6]=c?Wt(e[5],a):t[6]),(l=t[7])&&(e[7]=l),128&o&&(e[8]=null==e[8]?t[8]:sn(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=r}(b,m),e=b[0],t=b[1],n=b[2],r=b[3],s=b[4],!(u=b[9]=void 0===b[9]?d?0:e.length:an(b[9]-p,0))&&24&t&&(t&=-25),t&&1!=t)f=8==t||16==t?function(e,t,n){var r=kr(e);return function i(){for(var a=arguments.length,s=o(a),l=a,c=Jr(i);l--;)s[l]=arguments[l];var u=a<3&&s[0]!==c&&s[a-1]!==c?[]:Wt(s,c);if((a-=u.length)<n)return jr(e,t,wr,i.placeholder,void 0,s,u,void 0,void 0,n-a);var d=this&&this!==Ue&&this instanceof i?r:e;return nt(d,this,s)}}(e,t,u):32!=t&&33!=t||s.length?wr.apply(void 0,b):function(e,t,n,r){var i=1&t,a=kr(e);return function t(){for(var s=-1,l=arguments.length,c=-1,u=r.length,d=o(u+l),p=this&&this!==Ue&&this instanceof t?a:e;++c<u;)d[c]=r[c];for(;l--;)d[c++]=arguments[++s];return nt(p,i?n:this,d)}}(e,t,n,r);else var f=function(e,t,n){var o=1&t,r=kr(e);return function t(){var i=this&&this!==Ue&&this instanceof t?r:e;return i.apply(o?n:this,arguments)}}(e,t,n);return yi((m?Ho:xi)(f,b),e,t)}function Wr(e,t,n,o){return void 0===e||Pa(e,Se[n])&&!ve.call(o,n)?t:e}function zr(e,t,n,o,r,i){return Ua(e)&&Ua(t)&&(i.set(t,e),Po(e,t,void 0,zr,i),i.delete(t)),e}function Hr(e){return Ka(e)?void 0:e}function Vr(e,t,n,o,r,i){var a=1&n,s=e.length,l=t.length;if(s!=l&&!(a&&l>s))return!1;var c=i.get(e),u=i.get(t);if(c&&u)return c==t&&u==e;var d=-1,p=!0,g=2&n?new On:void 0;for(i.set(e,t),i.set(t,e);++d<s;){var h=e[d],m=t[d];if(o)var b=a?o(m,h,d,t,e,i):o(h,m,d,e,t,i);if(void 0!==b){if(b)continue;p=!1;break}if(g){if(!ht(t,(function(e,t){if(!Pt(g,t)&&(h===e||r(h,e,n,o,i)))return g.push(t)}))){p=!1;break}}else if(h!==m&&!r(h,m,n,o,i)){p=!1;break}}return i.delete(e),i.delete(t),p}function Ur(e){return Si(hi(e,void 0,ji),e+"")}function Gr(e){return go(e,ys,ei)}function qr(e){return go(e,Cs,ti)}var Qr=xn?function(e){return xn.get(e)}:$s;function Kr(e){for(var t=e.name+"",n=En[t],o=ve.call(En,t)?n.length:0;o--;){var r=n[o],i=r.func;if(null==i||i==e)return r.name}return t}function Jr(e){return(ve.call(wn,"placeholder")?wn:e).placeholder}function Yr(){var e=wn.iteratee||Ks;return e=e===Ks?Ro:e,arguments.length?e(arguments[0],arguments[1]):e}function Zr(e,t){var n,o,r=e.__data__;return("string"==(o=typeof(n=t))||"number"==o||"symbol"==o||"boolean"==o?"__proto__"!==n:null===n)?r["string"==typeof t?"string":"hash"]:r.map}function $r(e){for(var t=ys(e),n=t.length;n--;){var o=t[n],r=e[o];t[n]=[o,r,pi(r)]}return t}function Xr(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return vo(n)?n:void 0}var ei=en?function(e){return null==e?[]:(e=he(e),st(en(e),(function(t){return Ke.call(e,t)})))}:il,ti=en?function(e){for(var t=[];e;)dt(t,ei(e)),e=Ge(e);return t}:il,ni=ho;function oi(e,t,n){for(var o=-1,r=(t=sr(t,e)).length,i=!1;++o<r;){var a=_i(t[o]);if(!(i=null!=e&&n(e,a)))break;e=e[a]}return i||++o!=r?i:!!(r=null==e?0:e.length)&&Va(r)&&ai(a,r)&&(Ma(e)||Ba(e))}function ri(e){return"function"!=typeof e.constructor||di(e)?{}:Dn(Ge(e))}function ii(e){return Ma(e)||Ba(e)||!!(mt&&e&&e[mt])}function ai(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&le.test(e))&&e>-1&&e%1==0&&e<t}function si(e,t,n){if(!Ua(n))return!1;var o=typeof t;return!!("number"==o?Oa(n)&&ai(t,n.length):"string"==o&&t in n)&&Pa(n[t],e)}function li(e,t){if(Ma(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!$a(e))||U.test(e)||!V.test(e)||null!=t&&e in he(t)}function ci(e){var t=Kr(e),n=wn[t];if("function"!=typeof n||!(t in Fn.prototype))return!1;if(e===n)return!0;var o=Qr(n);return!!o&&e===o[0]}(pn&&ni(new pn(new ArrayBuffer(1)))!=R||gn&&ni(new gn)!=m||hn&&"[object Promise]"!=ni(hn.resolve())||mn&&ni(new mn)!=E||bn&&ni(new bn)!=C)&&(ni=function(e){var t=ho(e),n=t==f?e.constructor:void 0,o=n?wi(n):"";if(o)switch(o){case Sn:return R;case yn:return m;case Cn:return"[object Promise]";case vn:return E;case Rn:return C}return t});var ui=ye?za:al;function di(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Se)}function pi(e){return e==e&&!Ua(e)}function gi(e,t){return function(n){return null!=n&&n[e]===t&&(void 0!==t||e in he(n))}}function hi(e,t,n){return t=an(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,a=an(r.length-t,0),s=o(a);++i<a;)s[i]=r[t+i];i=-1;for(var l=o(t+1);++i<t;)l[i]=r[i];return l[t]=n(s),nt(e,this,l)}}function mi(e,t){return t.length<2?e:po(e,Go(t,0,-1))}function bi(e,t){for(var n=e.length,o=sn(t.length,n),r=fr(e);o--;){var i=t[o];e[o]=ai(i,n)?r[i]:void 0}return e}function fi(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var xi=Ci(Ho),Ei=Zt||function(e,t){return Ue.setTimeout(e,t)},Si=Ci(Vo);function yi(e,t,n){var o=t+"";return Si(e,function(e,t){var n=t.length;if(!n)return e;var o=n-1;return t[o]=(n>1?"& ":"")+t[o],t=t.join(n>2?", ":" "),e.replace(Y,"{\n/* [wrapped with "+t+"] */\n")}(o,function(e,t){return rt(s,(function(n){var o="_."+n[0];t&n[1]&&!lt(e,o)&&e.push(o)})),e.sort()}(function(e){var t=e.match(Z);return t?t[1].split($):[]}(o),n)))}function Ci(e){var t=0,n=0;return function(){var o=ln(),r=16-(o-n);if(n=o,r>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function vi(e,t){var n=-1,o=e.length,r=o-1;for(t=void 0===t?o:t;++n<t;){var i=Oo(n,r),a=e[i];e[i]=e[n],e[n]=a}return e.length=t,e}var Ri,ki,Ti=(Ri=Ra((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(G,(function(e,n,o,r){t.push(o?r.replace(te,"$1"):n||e)})),t}),(function(e){return 500===ki.size&&ki.clear(),e})),ki=Ri.cache,Ri);function _i(e){if("string"==typeof e||$a(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function wi(e){if(null!=e){try{return Ce.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Di(e){if(e instanceof Fn)return e.clone();var t=new In(e.__wrapped__,e.__chain__);return t.__actions__=fr(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var Pi=Ao((function(e,t){return La(e)?Xn(e,io(t,1,La,!0)):[]})),Ii=Ao((function(e,t){var n=Wi(t);return La(n)&&(n=void 0),La(e)?Xn(e,io(t,1,La,!0),Yr(n,2)):[]})),Fi=Ao((function(e,t){var n=Wi(t);return La(n)&&(n=void 0),La(e)?Xn(e,io(t,1,La,!0),void 0,n):[]}));function Bi(e,t,n){var o=null==e?0:e.length;if(!o)return-1;var r=null==n?0:rs(n);return r<0&&(r=an(o+r,0)),ft(e,Yr(t,3),r)}function Mi(e,t,n){var o=null==e?0:e.length;if(!o)return-1;var r=o-1;return void 0!==n&&(r=rs(n),r=n<0?an(o+r,0):sn(r,o-1)),ft(e,Yr(t,3),r,!0)}function ji(e){return null!=e&&e.length?io(e,1):[]}function Oi(e){return e&&e.length?e[0]:void 0}var Li=Ao((function(e){var t=ut(e,ir);return t.length&&t[0]===e[0]?xo(t):[]})),Ai=Ao((function(e){var t=Wi(e),n=ut(e,ir);return t===Wi(n)?t=void 0:n.pop(),n.length&&n[0]===e[0]?xo(n,Yr(t,2)):[]})),Ni=Ao((function(e){var t=Wi(e),n=ut(e,ir);return(t="function"==typeof t?t:void 0)&&n.pop(),n.length&&n[0]===e[0]?xo(n,void 0,t):[]}));function Wi(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}var zi=Ao(Hi);function Hi(e,t){return e&&e.length&&t&&t.length?Mo(e,t):e}var Vi=Ur((function(e,t){var n=null==e?0:e.length,o=Kn(e,t);return jo(e,ut(t,(function(e){return ai(e,n)?+e:e})).sort(hr)),o}));function Ui(e){return null==e?e:dn.call(e)}var Gi=Ao((function(e){return $o(io(e,1,La,!0))})),qi=Ao((function(e){var t=Wi(e);return La(t)&&(t=void 0),$o(io(e,1,La,!0),Yr(t,2))})),Qi=Ao((function(e){var t=Wi(e);return t="function"==typeof t?t:void 0,$o(io(e,1,La,!0),void 0,t)}));function Ki(e){if(!e||!e.length)return[];var t=0;return e=st(e,(function(e){if(La(e))return t=an(e.length,t),!0})),Tt(t,(function(t){return ut(e,Ct(t))}))}function Ji(e,t){if(!e||!e.length)return[];var n=Ki(e);return null==t?n:ut(n,(function(e){return nt(t,void 0,e)}))}var Yi=Ao((function(e,t){return La(e)?Xn(e,t):[]})),Zi=Ao((function(e){return or(st(e,La))})),$i=Ao((function(e){var t=Wi(e);return La(t)&&(t=void 0),or(st(e,La),Yr(t,2))})),Xi=Ao((function(e){var t=Wi(e);return t="function"==typeof t?t:void 0,or(st(e,La),void 0,t)})),ea=Ao(Ki),ta=Ao((function(e){var t=e.length,n=t>1?e[t-1]:void 0;return n="function"==typeof n?(e.pop(),n):void 0,Ji(e,n)}));function na(e){var t=wn(e);return t.__chain__=!0,t}function oa(e,t){return t(e)}var ra=Ur((function(e){var t=e.length,n=t?e[0]:0,o=this.__wrapped__,r=function(t){return Kn(t,e)};return!(t>1||this.__actions__.length)&&o instanceof Fn&&ai(n)?((o=o.slice(n,+n+(t?1:0))).__actions__.push({func:oa,args:[r],thisArg:void 0}),new In(o,this.__chain__).thru((function(e){return t&&!e.length&&e.push(void 0),e}))):this.thru(r)})),ia=Er((function(e,t,n){ve.call(e,n)?++e[n]:Qn(e,n,1)})),aa=Tr(Bi),sa=Tr(Mi);function la(e,t){return(Ma(e)?rt:eo)(e,Yr(t,3))}function ca(e,t){return(Ma(e)?it:to)(e,Yr(t,3))}var ua=Er((function(e,t,n){ve.call(e,n)?e[n].push(t):Qn(e,n,[t])})),da=Ao((function(e,t,n){var r=-1,i="function"==typeof t,a=Oa(e)?o(e.length):[];return eo(e,(function(e){a[++r]=i?nt(t,e,n):Eo(e,t,n)})),a})),pa=Er((function(e,t,n){Qn(e,n,t)}));function ga(e,t){return(Ma(e)?ut:_o)(e,Yr(t,3))}var ha=Er((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]})),ma=Ao((function(e,t){if(null==e)return[];var n=t.length;return n>1&&si(e,t[0],t[1])?t=[]:n>2&&si(t[0],t[1],t[2])&&(t=[t[0]]),Fo(e,io(t,1),[])})),ba=Yt||function(){return Ue.Date.now()};function fa(e,t,n){return t=n?void 0:t,Nr(e,128,void 0,void 0,void 0,void 0,t=e&&null==t?e.length:t)}function xa(e,t){var n;if("function"!=typeof t)throw new fe(i);return e=rs(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=void 0),n}}var Ea=Ao((function(e,t,n){var o=1;if(n.length){var r=Wt(n,Jr(Ea));o|=32}return Nr(e,o,t,n,r)})),Sa=Ao((function(e,t,n){var o=3;if(n.length){var r=Wt(n,Jr(Sa));o|=32}return Nr(t,o,e,n,r)}));function ya(e,t,n){var o,r,a,s,l,c,u=0,d=!1,p=!1,g=!0;if("function"!=typeof e)throw new fe(i);function h(t){var n=o,i=r;return o=r=void 0,u=t,s=e.apply(i,n)}function m(e){return u=e,l=Ei(f,t),d?h(e):s}function b(e){var n=e-c;return void 0===c||n>=t||n<0||p&&e-u>=a}function f(){var e=ba();if(b(e))return x(e);l=Ei(f,function(e){var n=t-(e-c);return p?sn(n,a-(e-u)):n}(e))}function x(e){return l=void 0,g&&o?h(e):(o=r=void 0,s)}function E(){var e=ba(),n=b(e);if(o=arguments,r=this,c=e,n){if(void 0===l)return m(c);if(p)return ur(l),l=Ei(f,t),h(c)}return void 0===l&&(l=Ei(f,t)),s}return t=as(t)||0,Ua(n)&&(d=!!n.leading,a=(p="maxWait"in n)?an(as(n.maxWait)||0,t):a,g="trailing"in n?!!n.trailing:g),E.cancel=function(){void 0!==l&&ur(l),u=0,o=c=r=l=void 0},E.flush=function(){return void 0===l?s:x(ba())},E}var Ca=Ao((function(e,t){return $n(e,1,t)})),va=Ao((function(e,t,n){return $n(e,as(t)||0,n)}));function Ra(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new fe(i);var n=function(){var o=arguments,r=t?t.apply(this,o):o[0],i=n.cache;if(i.has(r))return i.get(r);var a=e.apply(this,o);return n.cache=i.set(r,a)||i,a};return n.cache=new(Ra.Cache||jn),n}function ka(e){if("function"!=typeof e)throw new fe(i);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}Ra.Cache=jn;var Ta=lr((function(e,t){var n=(t=1==t.length&&Ma(t[0])?ut(t[0],wt(Yr())):ut(io(t,1),wt(Yr()))).length;return Ao((function(o){for(var r=-1,i=sn(o.length,n);++r<i;)o[r]=t[r].call(this,o[r]);return nt(e,this,o)}))})),_a=Ao((function(e,t){return Nr(e,32,void 0,t,Wt(t,Jr(_a)))})),wa=Ao((function(e,t){return Nr(e,64,void 0,t,Wt(t,Jr(wa)))})),Da=Ur((function(e,t){return Nr(e,256,void 0,void 0,void 0,t)}));function Pa(e,t){return e===t||e!=e&&t!=t}var Ia=Mr(mo),Fa=Mr((function(e,t){return e>=t})),Ba=So(function(){return arguments}())?So:function(e){return Ga(e)&&ve.call(e,"callee")&&!Ke.call(e,"callee")},Ma=o.isArray,ja=Ye?wt(Ye):function(e){return Ga(e)&&ho(e)==v};function Oa(e){return null!=e&&Va(e.length)&&!za(e)}function La(e){return Ga(e)&&Oa(e)}var Aa=tn||al,Na=Ze?wt(Ze):function(e){return Ga(e)&&ho(e)==d};function Wa(e){if(!Ga(e))return!1;var t=ho(e);return t==p||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!Ka(e)}function za(e){if(!Ua(e))return!1;var t=ho(e);return t==g||t==h||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Ha(e){return"number"==typeof e&&e==rs(e)}function Va(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function Ua(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Ga(e){return null!=e&&"object"==typeof e}var qa=$e?wt($e):function(e){return Ga(e)&&ni(e)==m};function Qa(e){return"number"==typeof e||Ga(e)&&ho(e)==b}function Ka(e){if(!Ga(e)||ho(e)!=f)return!1;var t=Ge(e);if(null===t)return!0;var n=ve.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Ce.call(n)==_e}var Ja=Xe?wt(Xe):function(e){return Ga(e)&&ho(e)==x},Ya=et?wt(et):function(e){return Ga(e)&&ni(e)==E};function Za(e){return"string"==typeof e||!Ma(e)&&Ga(e)&&ho(e)==S}function $a(e){return"symbol"==typeof e||Ga(e)&&ho(e)==y}var Xa=tt?wt(tt):function(e){return Ga(e)&&Va(e.length)&&!!Le[ho(e)]},es=Mr(To),ts=Mr((function(e,t){return e<=t}));function ns(e){if(!e)return[];if(Oa(e))return Za(e)?Vt(e):fr(e);if(vt&&e[vt])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[vt]());var t=ni(e);return(t==m?At:t==E?zt:Ps)(e)}function os(e){return e?(e=as(e))===1/0||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function rs(e){var t=os(e),n=t%1;return t==t?n?t-n:t:0}function is(e){return e?Jn(rs(e),0,4294967295):0}function as(e){if("number"==typeof e)return e;if($a(e))return NaN;if(Ua(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Ua(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=_t(e);var n=ie.test(e);return n||se.test(e)?ze(e.slice(2),n?2:8):re.test(e)?NaN:+e}function ss(e){return xr(e,Cs(e))}function ls(e){return null==e?"":Zo(e)}var cs=Sr((function(e,t){if(di(t)||Oa(t))xr(t,ys(t),e);else for(var n in t)ve.call(t,n)&&Vn(e,n,t[n])})),us=Sr((function(e,t){xr(t,Cs(t),e)})),ds=Sr((function(e,t,n,o){xr(t,Cs(t),e,o)})),ps=Sr((function(e,t,n,o){xr(t,ys(t),e,o)})),gs=Ur(Kn),hs=Ao((function(e,t){e=he(e);var n=-1,o=t.length,r=o>2?t[2]:void 0;for(r&&si(t[0],t[1],r)&&(o=1);++n<o;)for(var i=t[n],a=Cs(i),s=-1,l=a.length;++s<l;){var c=a[s],u=e[c];(void 0===u||Pa(u,Se[c])&&!ve.call(e,c))&&(e[c]=i[c])}return e})),ms=Ao((function(e){return e.push(void 0,zr),nt(Rs,void 0,e)}));function bs(e,t,n){var o=null==e?void 0:po(e,t);return void 0===o?n:o}function fs(e,t){return null!=e&&oi(e,t,fo)}var xs=Dr((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Te.call(t)),e[t]=n}),Us(Qs)),Es=Dr((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Te.call(t)),ve.call(e,t)?e[t].push(n):e[t]=[n]}),Yr),Ss=Ao(Eo);function ys(e){return Oa(e)?An(e):ko(e)}function Cs(e){return Oa(e)?An(e,!0):function(e){if(!Ua(e))return function(e){var t=[];if(null!=e)for(var n in he(e))t.push(n);return t}(e);var t=di(e),n=[];for(var o in e)("constructor"!=o||!t&&ve.call(e,o))&&n.push(o);return n}(e)}var vs=Sr((function(e,t,n){Po(e,t,n)})),Rs=Sr((function(e,t,n,o){Po(e,t,n,o)})),ks=Ur((function(e,t){var n={};if(null==e)return n;var o=!1;t=ut(t,(function(t){return t=sr(t,e),o||(o=t.length>1),t})),xr(e,qr(e),n),o&&(n=Yn(n,7,Hr));for(var r=t.length;r--;)Xo(n,t[r]);return n})),Ts=Ur((function(e,t){return null==e?{}:function(e,t){return Bo(e,t,(function(t,n){return fs(e,n)}))}(e,t)}));function _s(e,t){if(null==e)return{};var n=ut(qr(e),(function(e){return[e]}));return t=Yr(t),Bo(e,n,(function(e,n){return t(e,n[0])}))}var ws=Ar(ys),Ds=Ar(Cs);function Ps(e){return null==e?[]:Dt(e,ys(e))}var Is=Rr((function(e,t,n){return t=t.toLowerCase(),e+(n?Fs(t):t)}));function Fs(e){return Ws(ls(e).toLowerCase())}function Bs(e){return(e=ls(e))&&e.replace(ce,Mt).replace(Pe,"")}var Ms=Rr((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),js=Rr((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),Os=vr("toLowerCase"),Ls=Rr((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()})),As=Rr((function(e,t,n){return e+(n?" ":"")+Ws(t)})),Ns=Rr((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()})),Ws=vr("toUpperCase");function zs(e,t,n){return e=ls(e),void 0===(t=n?void 0:t)?function(e){return Me.test(e)}(e)?function(e){return e.match(Fe)||[]}(e):function(e){return e.match(X)||[]}(e):e.match(t)||[]}var Hs=Ao((function(e,t){try{return nt(e,void 0,t)}catch(e){return Wa(e)?e:new J(e)}})),Vs=Ur((function(e,t){return rt(t,(function(t){t=_i(t),Qn(e,t,Ea(e[t],e))})),e}));function Us(e){return function(){return e}}var Gs=_r(),qs=_r(!0);function Qs(e){return e}function Ks(e){return Ro("function"==typeof e?e:Yn(e,1))}var Js=Ao((function(e,t){return function(n){return Eo(n,e,t)}})),Ys=Ao((function(e,t){return function(n){return Eo(e,n,t)}}));function Zs(e,t,n){var o=ys(t),r=uo(t,o);null!=n||Ua(t)&&(r.length||!o.length)||(n=t,t=e,e=this,r=uo(t,ys(t)));var i=!(Ua(n)&&"chain"in n&&!n.chain),a=za(e);return rt(r,(function(n){var o=t[n];e[n]=o,a&&(e.prototype[n]=function(){var t=this.__chain__;if(i||t){var n=e(this.__wrapped__),r=n.__actions__=fr(this.__actions__);return r.push({func:o,args:arguments,thisArg:e}),n.__chain__=t,n}return o.apply(e,dt([this.value()],arguments))})})),e}function $s(){}var Xs=Ir(ut),el=Ir(at),tl=Ir(ht);function nl(e){return li(e)?Ct(_i(e)):function(e){return function(t){return po(t,e)}}(e)}var ol=Br(),rl=Br(!0);function il(){return[]}function al(){return!1}var sl,ll=Pr((function(e,t){return e+t}),0),cl=Or("ceil"),ul=Pr((function(e,t){return e/t}),1),dl=Or("floor"),pl=Pr((function(e,t){return e*t}),1),gl=Or("round"),hl=Pr((function(e,t){return e-t}),0);return wn.after=function(e,t){if("function"!=typeof t)throw new fe(i);return e=rs(e),function(){if(--e<1)return t.apply(this,arguments)}},wn.ary=fa,wn.assign=cs,wn.assignIn=us,wn.assignInWith=ds,wn.assignWith=ps,wn.at=gs,wn.before=xa,wn.bind=Ea,wn.bindAll=Vs,wn.bindKey=Sa,wn.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return Ma(e)?e:[e]},wn.chain=na,wn.chunk=function(e,t,n){t=(n?si(e,t,n):void 0===t)?1:an(rs(t),0);var r=null==e?0:e.length;if(!r||t<1)return[];for(var i=0,a=0,s=o($t(r/t));i<r;)s[a++]=Go(e,i,i+=t);return s},wn.compact=function(e){for(var t=-1,n=null==e?0:e.length,o=0,r=[];++t<n;){var i=e[t];i&&(r[o++]=i)}return r},wn.concat=function(){var e=arguments.length;if(!e)return[];for(var t=o(e-1),n=arguments[0],r=e;r--;)t[r-1]=arguments[r];return dt(Ma(n)?fr(n):[n],io(t,1))},wn.cond=function(e){var t=null==e?0:e.length,n=Yr();return e=t?ut(e,(function(e){if("function"!=typeof e[1])throw new fe(i);return[n(e[0]),e[1]]})):[],Ao((function(n){for(var o=-1;++o<t;){var r=e[o];if(nt(r[0],this,n))return nt(r[1],this,n)}}))},wn.conforms=function(e){return function(e){var t=ys(e);return function(n){return Zn(n,e,t)}}(Yn(e,1))},wn.constant=Us,wn.countBy=ia,wn.create=function(e,t){var n=Dn(e);return null==t?n:qn(n,t)},wn.curry=function e(t,n,o){var r=Nr(t,8,void 0,void 0,void 0,void 0,void 0,n=o?void 0:n);return r.placeholder=e.placeholder,r},wn.curryRight=function e(t,n,o){var r=Nr(t,16,void 0,void 0,void 0,void 0,void 0,n=o?void 0:n);return r.placeholder=e.placeholder,r},wn.debounce=ya,wn.defaults=hs,wn.defaultsDeep=ms,wn.defer=Ca,wn.delay=va,wn.difference=Pi,wn.differenceBy=Ii,wn.differenceWith=Fi,wn.drop=function(e,t,n){var o=null==e?0:e.length;return o?Go(e,(t=n||void 0===t?1:rs(t))<0?0:t,o):[]},wn.dropRight=function(e,t,n){var o=null==e?0:e.length;return o?Go(e,0,(t=o-(t=n||void 0===t?1:rs(t)))<0?0:t):[]},wn.dropRightWhile=function(e,t){return e&&e.length?tr(e,Yr(t,3),!0,!0):[]},wn.dropWhile=function(e,t){return e&&e.length?tr(e,Yr(t,3),!0):[]},wn.fill=function(e,t,n,o){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&si(e,t,n)&&(n=0,o=r),function(e,t,n,o){var r=e.length;for((n=rs(n))<0&&(n=-n>r?0:r+n),(o=void 0===o||o>r?r:rs(o))<0&&(o+=r),o=n>o?0:is(o);n<o;)e[n++]=t;return e}(e,t,n,o)):[]},wn.filter=function(e,t){return(Ma(e)?st:ro)(e,Yr(t,3))},wn.flatMap=function(e,t){return io(ga(e,t),1)},wn.flatMapDeep=function(e,t){return io(ga(e,t),1/0)},wn.flatMapDepth=function(e,t,n){return n=void 0===n?1:rs(n),io(ga(e,t),n)},wn.flatten=ji,wn.flattenDeep=function(e){return null!=e&&e.length?io(e,1/0):[]},wn.flattenDepth=function(e,t){return null!=e&&e.length?io(e,t=void 0===t?1:rs(t)):[]},wn.flip=function(e){return Nr(e,512)},wn.flow=Gs,wn.flowRight=qs,wn.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,o={};++t<n;){var r=e[t];o[r[0]]=r[1]}return o},wn.functions=function(e){return null==e?[]:uo(e,ys(e))},wn.functionsIn=function(e){return null==e?[]:uo(e,Cs(e))},wn.groupBy=ua,wn.initial=function(e){return null!=e&&e.length?Go(e,0,-1):[]},wn.intersection=Li,wn.intersectionBy=Ai,wn.intersectionWith=Ni,wn.invert=xs,wn.invertBy=Es,wn.invokeMap=da,wn.iteratee=Ks,wn.keyBy=pa,wn.keys=ys,wn.keysIn=Cs,wn.map=ga,wn.mapKeys=function(e,t){var n={};return t=Yr(t,3),lo(e,(function(e,o,r){Qn(n,t(e,o,r),e)})),n},wn.mapValues=function(e,t){var n={};return t=Yr(t,3),lo(e,(function(e,o,r){Qn(n,o,t(e,o,r))})),n},wn.matches=function(e){return wo(Yn(e,1))},wn.matchesProperty=function(e,t){return Do(e,Yn(t,1))},wn.memoize=Ra,wn.merge=vs,wn.mergeWith=Rs,wn.method=Js,wn.methodOf=Ys,wn.mixin=Zs,wn.negate=ka,wn.nthArg=function(e){return e=rs(e),Ao((function(t){return Io(t,e)}))},wn.omit=ks,wn.omitBy=function(e,t){return _s(e,ka(Yr(t)))},wn.once=function(e){return xa(2,e)},wn.orderBy=function(e,t,n,o){return null==e?[]:(Ma(t)||(t=null==t?[]:[t]),Ma(n=o?void 0:n)||(n=null==n?[]:[n]),Fo(e,t,n))},wn.over=Xs,wn.overArgs=Ta,wn.overEvery=el,wn.overSome=tl,wn.partial=_a,wn.partialRight=wa,wn.partition=ha,wn.pick=Ts,wn.pickBy=_s,wn.property=nl,wn.propertyOf=function(e){return function(t){return null==e?void 0:po(e,t)}},wn.pull=zi,wn.pullAll=Hi,wn.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?Mo(e,t,Yr(n,2)):e},wn.pullAllWith=function(e,t,n){return e&&e.length&&t&&t.length?Mo(e,t,void 0,n):e},wn.pullAt=Vi,wn.range=ol,wn.rangeRight=rl,wn.rearg=Da,wn.reject=function(e,t){return(Ma(e)?st:ro)(e,ka(Yr(t,3)))},wn.remove=function(e,t){var n=[];if(!e||!e.length)return n;var o=-1,r=[],i=e.length;for(t=Yr(t,3);++o<i;){var a=e[o];t(a,o,e)&&(n.push(a),r.push(o))}return jo(e,r),n},wn.rest=function(e,t){if("function"!=typeof e)throw new fe(i);return Ao(e,t=void 0===t?t:rs(t))},wn.reverse=Ui,wn.sampleSize=function(e,t,n){return t=(n?si(e,t,n):void 0===t)?1:rs(t),(Ma(e)?Wn:Wo)(e,t)},wn.set=function(e,t,n){return null==e?e:zo(e,t,n)},wn.setWith=function(e,t,n,o){return o="function"==typeof o?o:void 0,null==e?e:zo(e,t,n,o)},wn.shuffle=function(e){return(Ma(e)?zn:Uo)(e)},wn.slice=function(e,t,n){var o=null==e?0:e.length;return o?(n&&"number"!=typeof n&&si(e,t,n)?(t=0,n=o):(t=null==t?0:rs(t),n=void 0===n?o:rs(n)),Go(e,t,n)):[]},wn.sortBy=ma,wn.sortedUniq=function(e){return e&&e.length?Jo(e):[]},wn.sortedUniqBy=function(e,t){return e&&e.length?Jo(e,Yr(t,2)):[]},wn.split=function(e,t,n){return n&&"number"!=typeof n&&si(e,t,n)&&(t=n=void 0),(n=void 0===n?4294967295:n>>>0)?(e=ls(e))&&("string"==typeof t||null!=t&&!Ja(t))&&!(t=Zo(t))&&Lt(e)?cr(Vt(e),0,n):e.split(t,n):[]},wn.spread=function(e,t){if("function"!=typeof e)throw new fe(i);return t=null==t?0:an(rs(t),0),Ao((function(n){var o=n[t],r=cr(n,0,t);return o&&dt(r,o),nt(e,this,r)}))},wn.tail=function(e){var t=null==e?0:e.length;return t?Go(e,1,t):[]},wn.take=function(e,t,n){return e&&e.length?Go(e,0,(t=n||void 0===t?1:rs(t))<0?0:t):[]},wn.takeRight=function(e,t,n){var o=null==e?0:e.length;return o?Go(e,(t=o-(t=n||void 0===t?1:rs(t)))<0?0:t,o):[]},wn.takeRightWhile=function(e,t){return e&&e.length?tr(e,Yr(t,3),!1,!0):[]},wn.takeWhile=function(e,t){return e&&e.length?tr(e,Yr(t,3)):[]},wn.tap=function(e,t){return t(e),e},wn.throttle=function(e,t,n){var o=!0,r=!0;if("function"!=typeof e)throw new fe(i);return Ua(n)&&(o="leading"in n?!!n.leading:o,r="trailing"in n?!!n.trailing:r),ya(e,t,{leading:o,maxWait:t,trailing:r})},wn.thru=oa,wn.toArray=ns,wn.toPairs=ws,wn.toPairsIn=Ds,wn.toPath=function(e){return Ma(e)?ut(e,_i):$a(e)?[e]:fr(Ti(ls(e)))},wn.toPlainObject=ss,wn.transform=function(e,t,n){var o=Ma(e),r=o||Aa(e)||Xa(e);if(t=Yr(t,4),null==n){var i=e&&e.constructor;n=r?o?new i:[]:Ua(e)&&za(i)?Dn(Ge(e)):{}}return(r?rt:lo)(e,(function(e,o,r){return t(n,e,o,r)})),n},wn.unary=function(e){return fa(e,1)},wn.union=Gi,wn.unionBy=qi,wn.unionWith=Qi,wn.uniq=function(e){return e&&e.length?$o(e):[]},wn.uniqBy=function(e,t){return e&&e.length?$o(e,Yr(t,2)):[]},wn.uniqWith=function(e,t){return t="function"==typeof t?t:void 0,e&&e.length?$o(e,void 0,t):[]},wn.unset=function(e,t){return null==e||Xo(e,t)},wn.unzip=Ki,wn.unzipWith=Ji,wn.update=function(e,t,n){return null==e?e:er(e,t,ar(n))},wn.updateWith=function(e,t,n,o){return o="function"==typeof o?o:void 0,null==e?e:er(e,t,ar(n),o)},wn.values=Ps,wn.valuesIn=function(e){return null==e?[]:Dt(e,Cs(e))},wn.without=Yi,wn.words=zs,wn.wrap=function(e,t){return _a(ar(t),e)},wn.xor=Zi,wn.xorBy=$i,wn.xorWith=Xi,wn.zip=ea,wn.zipObject=function(e,t){return rr(e||[],t||[],Vn)},wn.zipObjectDeep=function(e,t){return rr(e||[],t||[],zo)},wn.zipWith=ta,wn.entries=ws,wn.entriesIn=Ds,wn.extend=us,wn.extendWith=ds,Zs(wn,wn),wn.add=ll,wn.attempt=Hs,wn.camelCase=Is,wn.capitalize=Fs,wn.ceil=cl,wn.clamp=function(e,t,n){return void 0===n&&(n=t,t=void 0),void 0!==n&&(n=(n=as(n))==n?n:0),void 0!==t&&(t=(t=as(t))==t?t:0),Jn(as(e),t,n)},wn.clone=function(e){return Yn(e,4)},wn.cloneDeep=function(e){return Yn(e,5)},wn.cloneDeepWith=function(e,t){return Yn(e,5,t="function"==typeof t?t:void 0)},wn.cloneWith=function(e,t){return Yn(e,4,t="function"==typeof t?t:void 0)},wn.conformsTo=function(e,t){return null==t||Zn(e,t,ys(t))},wn.deburr=Bs,wn.defaultTo=function(e,t){return null==e||e!=e?t:e},wn.divide=ul,wn.endsWith=function(e,t,n){e=ls(e),t=Zo(t);var o=e.length,r=n=void 0===n?o:Jn(rs(n),0,o);return(n-=t.length)>=0&&e.slice(n,r)==t},wn.eq=Pa,wn.escape=function(e){return(e=ls(e))&&N.test(e)?e.replace(L,jt):e},wn.escapeRegExp=function(e){return(e=ls(e))&&Q.test(e)?e.replace(q,"\\$&"):e},wn.every=function(e,t,n){var o=Ma(e)?at:no;return n&&si(e,t,n)&&(t=void 0),o(e,Yr(t,3))},wn.find=aa,wn.findIndex=Bi,wn.findKey=function(e,t){return bt(e,Yr(t,3),lo)},wn.findLast=sa,wn.findLastIndex=Mi,wn.findLastKey=function(e,t){return bt(e,Yr(t,3),co)},wn.floor=dl,wn.forEach=la,wn.forEachRight=ca,wn.forIn=function(e,t){return null==e?e:ao(e,Yr(t,3),Cs)},wn.forInRight=function(e,t){return null==e?e:so(e,Yr(t,3),Cs)},wn.forOwn=function(e,t){return e&&lo(e,Yr(t,3))},wn.forOwnRight=function(e,t){return e&&co(e,Yr(t,3))},wn.get=bs,wn.gt=Ia,wn.gte=Fa,wn.has=function(e,t){return null!=e&&oi(e,t,bo)},wn.hasIn=fs,wn.head=Oi,wn.identity=Qs,wn.includes=function(e,t,n,o){e=Oa(e)?e:Ps(e),n=n&&!o?rs(n):0;var r=e.length;return n<0&&(n=an(r+n,0)),Za(e)?n<=r&&e.indexOf(t,n)>-1:!!r&&xt(e,t,n)>-1},wn.indexOf=function(e,t,n){var o=null==e?0:e.length;if(!o)return-1;var r=null==n?0:rs(n);return r<0&&(r=an(o+r,0)),xt(e,t,r)},wn.inRange=function(e,t,n){return t=os(t),void 0===n?(n=t,t=0):n=os(n),function(e,t,n){return e>=sn(t,n)&&e<an(t,n)}(e=as(e),t,n)},wn.invoke=Ss,wn.isArguments=Ba,wn.isArray=Ma,wn.isArrayBuffer=ja,wn.isArrayLike=Oa,wn.isArrayLikeObject=La,wn.isBoolean=function(e){return!0===e||!1===e||Ga(e)&&ho(e)==u},wn.isBuffer=Aa,wn.isDate=Na,wn.isElement=function(e){return Ga(e)&&1===e.nodeType&&!Ka(e)},wn.isEmpty=function(e){if(null==e)return!0;if(Oa(e)&&(Ma(e)||"string"==typeof e||"function"==typeof e.splice||Aa(e)||Xa(e)||Ba(e)))return!e.length;var t=ni(e);if(t==m||t==E)return!e.size;if(di(e))return!ko(e).length;for(var n in e)if(ve.call(e,n))return!1;return!0},wn.isEqual=function(e,t){return yo(e,t)},wn.isEqualWith=function(e,t,n){var o=(n="function"==typeof n?n:void 0)?n(e,t):void 0;return void 0===o?yo(e,t,void 0,n):!!o},wn.isError=Wa,wn.isFinite=function(e){return"number"==typeof e&&nn(e)},wn.isFunction=za,wn.isInteger=Ha,wn.isLength=Va,wn.isMap=qa,wn.isMatch=function(e,t){return e===t||Co(e,t,$r(t))},wn.isMatchWith=function(e,t,n){return n="function"==typeof n?n:void 0,Co(e,t,$r(t),n)},wn.isNaN=function(e){return Qa(e)&&e!=+e},wn.isNative=function(e){if(ui(e))throw new J("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return vo(e)},wn.isNil=function(e){return null==e},wn.isNull=function(e){return null===e},wn.isNumber=Qa,wn.isObject=Ua,wn.isObjectLike=Ga,wn.isPlainObject=Ka,wn.isRegExp=Ja,wn.isSafeInteger=function(e){return Ha(e)&&e>=-9007199254740991&&e<=9007199254740991},wn.isSet=Ya,wn.isString=Za,wn.isSymbol=$a,wn.isTypedArray=Xa,wn.isUndefined=function(e){return void 0===e},wn.isWeakMap=function(e){return Ga(e)&&ni(e)==C},wn.isWeakSet=function(e){return Ga(e)&&"[object WeakSet]"==ho(e)},wn.join=function(e,t){return null==e?"":on.call(e,t)},wn.kebabCase=Ms,wn.last=Wi,wn.lastIndexOf=function(e,t,n){var o=null==e?0:e.length;if(!o)return-1;var r=o;return void 0!==n&&(r=(r=rs(n))<0?an(o+r,0):sn(r,o-1)),t==t?function(e,t,n){for(var o=n+1;o--;)if(e[o]===t)return o;return o}(e,t,r):ft(e,St,r,!0)},wn.lowerCase=js,wn.lowerFirst=Os,wn.lt=es,wn.lte=ts,wn.max=function(e){return e&&e.length?oo(e,Qs,mo):void 0},wn.maxBy=function(e,t){return e&&e.length?oo(e,Yr(t,2),mo):void 0},wn.mean=function(e){return yt(e,Qs)},wn.meanBy=function(e,t){return yt(e,Yr(t,2))},wn.min=function(e){return e&&e.length?oo(e,Qs,To):void 0},wn.minBy=function(e,t){return e&&e.length?oo(e,Yr(t,2),To):void 0},wn.stubArray=il,wn.stubFalse=al,wn.stubObject=function(){return{}},wn.stubString=function(){return""},wn.stubTrue=function(){return!0},wn.multiply=pl,wn.nth=function(e,t){return e&&e.length?Io(e,rs(t)):void 0},wn.noConflict=function(){return Ue._===this&&(Ue._=we),this},wn.noop=$s,wn.now=ba,wn.pad=function(e,t,n){e=ls(e);var o=(t=rs(t))?Ht(e):0;if(!t||o>=t)return e;var r=(t-o)/2;return Fr(Xt(r),n)+e+Fr($t(r),n)},wn.padEnd=function(e,t,n){e=ls(e);var o=(t=rs(t))?Ht(e):0;return t&&o<t?e+Fr(t-o,n):e},wn.padStart=function(e,t,n){e=ls(e);var o=(t=rs(t))?Ht(e):0;return t&&o<t?Fr(t-o,n)+e:e},wn.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),cn(ls(e).replace(K,""),t||0)},wn.random=function(e,t,n){if(n&&"boolean"!=typeof n&&si(e,t,n)&&(t=n=void 0),void 0===n&&("boolean"==typeof t?(n=t,t=void 0):"boolean"==typeof e&&(n=e,e=void 0)),void 0===e&&void 0===t?(e=0,t=1):(e=os(e),void 0===t?(t=e,e=0):t=os(t)),e>t){var o=e;e=t,t=o}if(n||e%1||t%1){var r=un();return sn(e+r*(t-e+We("1e-"+((r+"").length-1))),t)}return Oo(e,t)},wn.reduce=function(e,t,n){var o=Ma(e)?pt:Rt,r=arguments.length<3;return o(e,Yr(t,4),n,r,eo)},wn.reduceRight=function(e,t,n){var o=Ma(e)?gt:Rt,r=arguments.length<3;return o(e,Yr(t,4),n,r,to)},wn.repeat=function(e,t,n){return t=(n?si(e,t,n):void 0===t)?1:rs(t),Lo(ls(e),t)},wn.replace=function(){var e=arguments,t=ls(e[0]);return e.length<3?t:t.replace(e[1],e[2])},wn.result=function(e,t,n){var o=-1,r=(t=sr(t,e)).length;for(r||(r=1,e=void 0);++o<r;){var i=null==e?void 0:e[_i(t[o])];void 0===i&&(o=r,i=n),e=za(i)?i.call(e):i}return e},wn.round=gl,wn.runInContext=e,wn.sample=function(e){return(Ma(e)?Nn:No)(e)},wn.size=function(e){if(null==e)return 0;if(Oa(e))return Za(e)?Ht(e):e.length;var t=ni(e);return t==m||t==E?e.size:ko(e).length},wn.snakeCase=Ls,wn.some=function(e,t,n){var o=Ma(e)?ht:qo;return n&&si(e,t,n)&&(t=void 0),o(e,Yr(t,3))},wn.sortedIndex=function(e,t){return Qo(e,t)},wn.sortedIndexBy=function(e,t,n){return Ko(e,t,Yr(n,2))},wn.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var o=Qo(e,t);if(o<n&&Pa(e[o],t))return o}return-1},wn.sortedLastIndex=function(e,t){return Qo(e,t,!0)},wn.sortedLastIndexBy=function(e,t,n){return Ko(e,t,Yr(n,2),!0)},wn.sortedLastIndexOf=function(e,t){if(null!=e&&e.length){var n=Qo(e,t,!0)-1;if(Pa(e[n],t))return n}return-1},wn.startCase=As,wn.startsWith=function(e,t,n){return e=ls(e),n=null==n?0:Jn(rs(n),0,e.length),t=Zo(t),e.slice(n,n+t.length)==t},wn.subtract=hl,wn.sum=function(e){return e&&e.length?kt(e,Qs):0},wn.sumBy=function(e,t){return e&&e.length?kt(e,Yr(t,2)):0},wn.template=function(e,t,n){var o=wn.templateSettings;n&&si(e,t,n)&&(t=void 0),e=ls(e),t=ds({},t,o,Wr);var r,i,a=ds({},t.imports,o.imports,Wr),s=ys(a),l=Dt(a,s),c=0,u=t.interpolate||ue,d="__p += '",p=me((t.escape||ue).source+"|"+u.source+"|"+(u===H?ne:ue).source+"|"+(t.evaluate||ue).source+"|$","g"),g="//# sourceURL="+(ve.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Oe+"]")+"\n";e.replace(p,(function(t,n,o,a,s,l){return o||(o=a),d+=e.slice(c,l).replace(de,Ot),n&&(r=!0,d+="' +\n__e("+n+") +\n'"),s&&(i=!0,d+="';\n"+s+";\n__p += '"),o&&(d+="' +\n((__t = ("+o+")) == null ? '' : __t) +\n'"),c=l+t.length,t})),d+="';\n";var h=ve.call(t,"variable")&&t.variable;if(h){if(ee.test(h))throw new J("Invalid `variable` option passed into `_.template`")}else d="with (obj) {\n"+d+"\n}\n";d=(i?d.replace(B,""):d).replace(M,"$1").replace(j,"$1;"),d="function("+(h||"obj")+") {\n"+(h?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(r?", __e = _.escape":"")+(i?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var m=Hs((function(){return pe(s,g+"return "+d).apply(void 0,l)}));if(m.source=d,Wa(m))throw m;return m},wn.times=function(e,t){if((e=rs(e))<1||e>9007199254740991)return[];var n=4294967295,o=sn(e,4294967295);e-=4294967295;for(var r=Tt(o,t=Yr(t));++n<e;)t(n);return r},wn.toFinite=os,wn.toInteger=rs,wn.toLength=is,wn.toLower=function(e){return ls(e).toLowerCase()},wn.toNumber=as,wn.toSafeInteger=function(e){return e?Jn(rs(e),-9007199254740991,9007199254740991):0===e?e:0},wn.toString=ls,wn.toUpper=function(e){return ls(e).toUpperCase()},wn.trim=function(e,t,n){if((e=ls(e))&&(n||void 0===t))return _t(e);if(!e||!(t=Zo(t)))return e;var o=Vt(e),r=Vt(t);return cr(o,It(o,r),Ft(o,r)+1).join("")},wn.trimEnd=function(e,t,n){if((e=ls(e))&&(n||void 0===t))return e.slice(0,Ut(e)+1);if(!e||!(t=Zo(t)))return e;var o=Vt(e);return cr(o,0,Ft(o,Vt(t))+1).join("")},wn.trimStart=function(e,t,n){if((e=ls(e))&&(n||void 0===t))return e.replace(K,"");if(!e||!(t=Zo(t)))return e;var o=Vt(e);return cr(o,It(o,Vt(t))).join("")},wn.truncate=function(e,t){var n=30,o="...";if(Ua(t)){var r="separator"in t?t.separator:r;n="length"in t?rs(t.length):n,o="omission"in t?Zo(t.omission):o}var i=(e=ls(e)).length;if(Lt(e)){var a=Vt(e);i=a.length}if(n>=i)return e;var s=n-Ht(o);if(s<1)return o;var l=a?cr(a,0,s).join(""):e.slice(0,s);if(void 0===r)return l+o;if(a&&(s+=l.length-s),Ja(r)){if(e.slice(s).search(r)){var c,u=l;for(r.global||(r=me(r.source,ls(oe.exec(r))+"g")),r.lastIndex=0;c=r.exec(u);)var d=c.index;l=l.slice(0,void 0===d?s:d)}}else if(e.indexOf(Zo(r),s)!=s){var p=l.lastIndexOf(r);p>-1&&(l=l.slice(0,p))}return l+o},wn.unescape=function(e){return(e=ls(e))&&A.test(e)?e.replace(O,Gt):e},wn.uniqueId=function(e){var t=++Re;return ls(e)+t},wn.upperCase=Ns,wn.upperFirst=Ws,wn.each=la,wn.eachRight=ca,wn.first=Oi,Zs(wn,(sl={},lo(wn,(function(e,t){ve.call(wn.prototype,t)||(sl[t]=e)})),sl),{chain:!1}),wn.VERSION="4.17.21",rt(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){wn[e].placeholder=wn})),rt(["drop","take"],(function(e,t){Fn.prototype[e]=function(n){n=void 0===n?1:an(rs(n),0);var o=this.__filtered__&&!t?new Fn(this):this.clone();return o.__filtered__?o.__takeCount__=sn(n,o.__takeCount__):o.__views__.push({size:sn(n,4294967295),type:e+(o.__dir__<0?"Right":"")}),o},Fn.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),rt(["filter","map","takeWhile"],(function(e,t){var n=t+1,o=1==n||3==n;Fn.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:Yr(e,3),type:n}),t.__filtered__=t.__filtered__||o,t}})),rt(["head","last"],(function(e,t){var n="take"+(t?"Right":"");Fn.prototype[e]=function(){return this[n](1).value()[0]}})),rt(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");Fn.prototype[e]=function(){return this.__filtered__?new Fn(this):this[n](1)}})),Fn.prototype.compact=function(){return this.filter(Qs)},Fn.prototype.find=function(e){return this.filter(e).head()},Fn.prototype.findLast=function(e){return this.reverse().find(e)},Fn.prototype.invokeMap=Ao((function(e,t){return"function"==typeof e?new Fn(this):this.map((function(n){return Eo(n,e,t)}))})),Fn.prototype.reject=function(e){return this.filter(ka(Yr(e)))},Fn.prototype.slice=function(e,t){e=rs(e);var n=this;return n.__filtered__&&(e>0||t<0)?new Fn(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),void 0!==t&&(n=(t=rs(t))<0?n.dropRight(-t):n.take(t-e)),n)},Fn.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Fn.prototype.toArray=function(){return this.take(4294967295)},lo(Fn.prototype,(function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),o=/^(?:head|last)$/.test(t),r=wn[o?"take"+("last"==t?"Right":""):t],i=o||/^find/.test(t);r&&(wn.prototype[t]=function(){var t=this.__wrapped__,a=o?[1]:arguments,s=t instanceof Fn,l=a[0],c=s||Ma(t),u=function(e){var t=r.apply(wn,dt([e],a));return o&&d?t[0]:t};c&&n&&"function"==typeof l&&1!=l.length&&(s=c=!1);var d=this.__chain__,p=!!this.__actions__.length,g=i&&!d,h=s&&!p;if(!i&&c){t=h?t:new Fn(this);var m=e.apply(t,a);return m.__actions__.push({func:oa,args:[u],thisArg:void 0}),new In(m,d)}return g&&h?e.apply(this,a):(m=this.thru(u),g?o?m.value()[0]:m.value():m)})})),rt(["pop","push","shift","sort","splice","unshift"],(function(e){var t=xe[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",o=/^(?:pop|shift)$/.test(e);wn.prototype[e]=function(){var e=arguments;if(o&&!this.__chain__){var r=this.value();return t.apply(Ma(r)?r:[],e)}return this[n]((function(n){return t.apply(Ma(n)?n:[],e)}))}})),lo(Fn.prototype,(function(e,t){var n=wn[t];if(n){var o=n.name+"";ve.call(En,o)||(En[o]=[]),En[o].push({name:t,func:n})}})),En[wr(void 0,2).name]=[{name:"wrapper",func:void 0}],Fn.prototype.clone=function(){var e=new Fn(this.__wrapped__);return e.__actions__=fr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=fr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=fr(this.__views__),e},Fn.prototype.reverse=function(){if(this.__filtered__){var e=new Fn(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},Fn.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=Ma(e),o=t<0,r=n?e.length:0,i=function(e,t,n){for(var o=-1,r=n.length;++o<r;){var i=n[o],a=i.size;switch(i.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=sn(t,e+a);break;case"takeRight":e=an(e,t-a)}}return{start:e,end:t}}(0,r,this.__views__),a=i.start,s=i.end,l=s-a,c=o?s:a-1,u=this.__iteratees__,d=u.length,p=0,g=sn(l,this.__takeCount__);if(!n||!o&&r==l&&g==l)return nr(e,this.__actions__);var h=[];e:for(;l--&&p<g;){for(var m=-1,b=e[c+=t];++m<d;){var f=u[m],x=f.iteratee,E=f.type,S=x(b);if(2==E)b=S;else if(!S){if(1==E)continue e;break e}}h[p++]=b}return h},wn.prototype.at=ra,wn.prototype.chain=function(){return na(this)},wn.prototype.commit=function(){return new In(this.value(),this.__chain__)},wn.prototype.next=function(){void 0===this.__values__&&(this.__values__=ns(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?void 0:this.__values__[this.__index__++]}},wn.prototype.plant=function(e){for(var t,n=this;n instanceof Pn;){var o=Di(n);o.__index__=0,o.__values__=void 0,t?r.__wrapped__=o:t=o;var r=o;n=n.__wrapped__}return r.__wrapped__=e,t},wn.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof Fn){var t=e;return this.__actions__.length&&(t=new Fn(this)),(t=t.reverse()).__actions__.push({func:oa,args:[Ui],thisArg:void 0}),new In(t,this.__chain__)}return this.thru(Ui)},wn.prototype.toJSON=wn.prototype.valueOf=wn.prototype.value=function(){return nr(this.__wrapped__,this.__actions__)},wn.prototype.first=wn.prototype.head,vt&&(wn.prototype[vt]=function(){return this}),wn}();Ue._=qt,void 0===(r=function(){return qt}.call(t,n,t,o))||(o.exports=r)}).call(this)}).call(this,n(417),n(1224)(e))},2665:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(272),r=n(226);const i=e=>Object(o.b)(e,r.b.Floatie)},2683:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return l}));var o=n(5),r=n(20),i=n(486);const a=Object(r.c)(e=>Object(o.db)({root:{height:i.a.floatieRowHeight,padding:"0 3px",fontSize:12}},e)),s={root:{height:i.a.floatieLargeControlHeight,minWidth:i.a.minimumFloatieLargeControlWidth,padding:"2px 2px 0px 2px",fontSize:12},flexContainer:{flexDirection:"column"},icon:{width:i.a.floatieLargeIconSize,height:i.a.floatieLargeIconSize,padding:"2px 12px 2px 12px"},textContainer:{padding:"2px 2px 0px 2px",fontSize:14,width:"max-content"}},l={root:{height:i.a.floatieRowHeight,minWidth:i.a.floatieRowHeight,padding:"2px 2px 0px 2px",fontSize:12},flexContainer:{flexDirection:"row"},icon:{width:i.a.menuButtonWidth,height:i.a.menuButtonWidth,padding:"0px 10px 0px 0px"},textContainer:{fontSize:14,fontWeight:400}}},2684:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(1);const r={display:"inline-block",lineHeight:"14px",fontSize:"12px"};function i(e){if(e){const t=e.split(" ");return t.length>1?()=>o.createElement("div",{style:r},o.createElement("div",null,t[0]),o.createElement("div",null,t.slice(1).join(" "))):()=>o.createElement("span",{style:r},e)}}},2694:function(e,t,n){"use strict";n.d(t,"i",(function(){return Se})),n.d(t,"h",(function(){return X})),n.d(t,"j",(function(){return ne})),n.d(t,"f",(function(){return oe})),n.d(t,"a",(function(){return re})),n.d(t,"b",(function(){return ie})),n.d(t,"d",(function(){return ae})),n.d(t,"e",(function(){return ce})),n.d(t,"g",(function(){return ue})),n.d(t,"c",(function(){return de}));var o,r,i,a=n(3);function s(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}function l(e,t){return Object(a.__awaiter)(this,void 0,void 0,(function(){return Object(a.__generator)(this,(function(n){return[2,new Promise((function(n,o){var r=document.createElement("script");(null==t?void 0:t.createScriptURL)?r.src=t.createScriptURL(e.content):r.src=e.content,r.onload=function(){n()},r.onerror=function(){o(new Error("Dynamically loading script "+e.content+" failed"))},s(r,e.attributes),document.body.appendChild(r)}))]}))}))}function c(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){return Object(a.__generator)(this,(function(t){return[2,new Promise((function(t){var n=document.createElement("script"),o=document.createTextNode(e.content);n.appendChild(o),s(n,e.attributes),document.body.appendChild(n),t()}))]}))}))}function u(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){return Object(a.__generator)(this,(function(t){return[2,new Promise((function(t,n){var o=document.createElement("link");o.rel="stylesheet",o.type="text/css",o.href=e.content,o.onload=function(){t()},o.onerror=function(){n(new Error("Dynamically loading style "+e.content+" failed"))},s(o,e.attributes),document.head.appendChild(o)}))]}))}))}function d(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){return Object(a.__generator)(this,(function(t){return[2,new Promise((function(t){var n=document.createElement("link");n.rel="stylesheet",n.type="text/css";var o=document.createTextNode(e.content);n.appendChild(o),s(n,e.attributes),document.head.appendChild(n),t()}))]}))}))}function p(e,t){return Object(a.__awaiter)(this,void 0,void 0,(function(){var n,o,r,i,s,g,h;return Object(a.__generator)(this,(function(m){switch(m.label){case 0:switch(e.type){case"parallel":return[3,1];case"sequential":return[3,5];case"scriptUrl":return[3,16];case"script":return[3,18];case"styleUrl":return[3,20];case"style":return[3,22]}return[3,24];case 1:return m.trys.push([1,3,,4]),[4,Promise.all(e.children.map((function(e){return p(e,t)})))];case 2:return m.sent(),[3,4];case 3:if(n=m.sent(),!e.optional)throw n;return console.log("Dynamic loading of optional script failed",n),[3,4];case 4:return[2];case 5:m.trys.push([5,14,,15]),m.label=6;case 6:m.trys.push([6,11,12,13]),o=Object(a.__values)(e.children),r=o.next(),m.label=7;case 7:return r.done?[3,10]:[4,p(r.value,t)];case 8:m.sent(),m.label=9;case 9:return r=o.next(),[3,7];case 10:return[3,13];case 11:return i=m.sent(),g={error:i},[3,13];case 12:try{r&&!r.done&&(h=o.return)&&h.call(o)}finally{if(g)throw g.error}return[7];case 13:return[3,15];case 14:if(s=m.sent(),!e.optional)throw s;return console.log("Dynamic loading of optional script failed",s),[3,15];case 15:return[2];case 16:return[4,l(e,t)];case 17:return m.sent(),[2];case 18:return[4,c(e)];case 19:return m.sent(),[2];case 20:return[4,u(e)];case 21:return m.sent(),[2];case 22:return[4,d(e)];case 23:return m.sent(),[2];case 24:throw new Error("Invalid script loader object "+JSON.stringify(e))}}))}))}!function(e){e.Info="Info",e.Error="Error",e.Analytics="Analytics",e.Performance="Performance",e.Interface="Interface",e.Availability="Availability",e.Reliability="Reliability",e.Framework="Framework",e.Flight="Flight"}(o||(o={})),function(e){e.ClientInfo="ClientInfo",e.ClientError="ClientError",e.ClientAnalytics="ClientAnalytics",e.ClientPerformance="ClientPerformance",e.ClientAvailability="ClientAvailability",e.ClientReliability="ClientReliability",e.ClientFramework="ClientFramework"}(r||(r={})),function(e){e.Microsoft365AdminCenter="@ms/mac"}(i||(i={}));var g=new Map;function h(e,t){if(g.has(e))throw new Error("Logger "+e+" already exists");g.set(e,t)}var m,b,f=function(e){!function e(t,n){n.forEach((function(i,a){try{i.logger(t)}catch(t){var s=new Map(n);s.delete(a),e({id:"500294",type:o.Error,logCategory:r.ClientError,message:"Failure in logger: "+a,error:t},s)}}))}(e,g)};!function(e){e.M365AdminPortal="M365AdminPortal",e.SPOAdminPortal="SPOAdminPortal",e.SPOPortal="SPOPortal",e.EXOAdminPortal="EXOAdminPortal",e.TeamsAdminPortal="TeamsAdminPortal",e.SecurityPortal="SecurityPortal",e.CompliancePortal="CompliancePortal",e.M365SCCPortal="M365SCCPortal",e.SupportCentral="SupportCentral",e.IbizaMTMPortal="IbizaMTMPortal",e.CloudCostManagementPortal="CloudCostManagementPortal",e.Rave="Rave",e.DynamicsPortal="DynamicsPortal",e.TeamsApp="TeamsApp",e.M365DefenderSMB="M365DefenderSMB",e.Windows365Portal="Windows365Portal",e.PPACAdminPortal="PPACAdminPortal",e.VivaGoals="VivaGoals",e.VivaPulse="VivaPulse",e.FireSurveysHost="FireSurveysHost",e.AEM="AEM",e.ExcelPythonAddon="ExcelPythonAddon",e.AdminAppMetaOSTeams="AdminAppMetaOSTeams",e.AdminAppMetaOSOffice="AdminAppMetaOSOffice",e.AdminAppMetaOSOutlook="AdminAppMetaOSOutlook",e.Project="Project",e.Planner="Planner",e.Visio="Visio",e.Clipchamp="Clipchamp"}(m||(m={})),function(e){e.Static="centro.runtime.static",e.Error="centro.hvc.error",e.CentroHvcLoader="centro.hvc.loader-data"}(b||(b={}));var x;function E(e){var t=e;try{"string"==typeof e&&(t=(t=t.replaceAll(/[a-zA-Z0-9_\-'.]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-]+/g,"<upn>").replaceAll(/[a-zA-Z0-9_\-'.]+%40[a-zA-Z0-9-]+\.[a-zA-Z0-9-]+/g,"<upn>")).replaceAll(/eyJ0eX[A-Za-z0-9-_]+\.+[A-Za-z0-9-_=]+\.[A-Za-z0-9-_=/]+/g,"<token>").replaceAll(/eyJhbG[A-Za-z0-9-_]+\.+[A-Za-z0-9-_=]+\.[A-Za-z0-9-_=/]+/g,"<token>"))}catch(e){}return t}!function(e){e[e.Trace=0]="Trace",e[e.Info=1]="Info",e[e.Comment=2]="Comment",e[e.Warning=3]="Warning",e[e.Error=4]="Error",e[e.Critical=5]="Critical"}(x||(x={}));var S=!0;var y=function(e){var t,n,o=window;if(null===(t=null==o?void 0:o.trustedTypes)||void 0===t?void 0:t.createPolicy)try{n=o.trustedTypes.createPolicy("@centro/hvc-loader",{createScriptURL:function(e){var t;try{t=new URL(e)}catch(t){throw new Error("Invalid script url "+e)}if("https:"!==(null==t?void 0:t.protocol))throw new Error("Only https protocol is allowed for script url "+e);return e},createScript:void 0,createHTML:void 0})}catch(e){console.error("Failed to create trusted type policy",e)}return n}();function C(e,t){if(!e){var n=new Error(t);throw f({type:o.Error,message:t,id:"508371",error:n}),n}}function v(e){return void 0===window?(f({type:o.Info,message:"window is undefined",id:"512105"}),!1):void 0===window.m365_admin_features?(f({type:o.Info,message:"window.m365_admin_features is undefined",id:"512108"}),!1):void 0!==window.m365_admin_features.initializers&&void 0!==window.m365_admin_features.initializers[e]}function R(e){var t,n;return!!(null===(n=null===(t=window.m365_admin_features)||void 0===t?void 0:t.locDbg)||void 0===n?void 0:n[e])}var k,T,_,w,D=void 0,P=void 0,I=!1,F=!1,B=void 0,M=!1,j=new Map,O=void 0,L=void 0;function A(e){return void 0===e&&(e=""),Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(a.__generator)(this,(function(r){switch(r.label){case 0:if(void 0===L)throw t=new Error("attempting to getUxVersionData before preConfig were provided"),f({type:o.Error,message:t.message,error:t,id:"508373"}),t;return n=D+"/admin/api/uxversion"+e,M&&(n=""===e?n+"?locale="+L.locale+"&hostingapp="+L.hostName:n+"&locale="+L.locale+"&hostingapp="+L.hostName),[4,new Promise((function(e,t){var o=new XMLHttpRequest;o.open("GET",n,!0),M||(o.setRequestHeader("x-ms-mac-locale",L.locale),o.setRequestHeader("x-ms-mac-hostingapp",L.hostName)),o.onreadystatechange=function(){if(o.readyState===XMLHttpRequest.DONE){var r=o.getResponseHeader("x-ms-correlation-id");if(200!==o.status){var i="Request to "+n+" failed, server responseCode: "+o.status+" body: "+o.response+" correlationId: "+r,a=new Error(i);return void t(a)}e(function(e){if(void 0!==e&&e.hasOwnProperty("__hostApp_config"))for(var t in e)t.startsWith("__")||(e[t.toLowerCase()]=e[t],t.toLowerCase()!==t&&delete e[t]);return JSON.stringify(e)}(JSON.parse(o.response)))}},o.send()}))];case 1:return[2,r.sent()]}}))}))}function N(){return Object(a.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(a.__generator)(this,(function(n){switch(n.label){case 0:return B?[2]:(t=(e=JSON).parse,[4,A("?locdbg=true")]);case 1:return B=t.apply(e,[n.sent()]),[2]}}))}))}function W(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,i,s,l,c,u,d,p,g,m,b,y;return Object(a.__generator)(this,(function(v){switch(v.label){case 0:t=e.centroEnvironmentBaseUrl,i=e.preConfig,s=e.centroHvcData,l=e.enableUxVersionQueryParam,C(!!t,"centroEnvironmentBaseUrl is missing"),C(!!i,"preConfig is missing"),(L=i).appId||(L.appId="10000000-1000-4000-8000-100000000000".replace(/[018]/g,(function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)}))),c=L.appId,u=L.hostName,v.label=1;case 1:return v.trys.push([1,5,,6]),I?(f({type:o.Info,message:"initialize() is called but loader is already previously initialized",id:"508375"}),[2]):(D="/"===t.substring(t.length-1)?t.substring(0,t.length-1):t,d=n(2803),O=d.version,p=D+"/api/instrument/logclient",F||(h("hvcLoaderKustoLogger",function(e,t,n,i){var s=[],l=Promise.resolve(),c=0,u=e,d=t,p=n,g=i,h=function(){setTimeout((function(){m().catch((function(){}))}),1e3)},m=function(){return 0===s.length||S?(h(),Promise.resolve()):(l=new Promise((function(e,t){var n=new XMLHttpRequest;n.open("POST",d,!0),n.setRequestHeader("Content-Type","application/json"),n.setRequestHeader("x-ms-mac-hostingapp",p),n.setRequestHeader("x-ms-mac-appid",u),n.setRequestHeader("x-ms-mac-version",g),n.onreadystatechange=function(){if(n.readyState===XMLHttpRequest.DONE){if(204!==n.status){var o=new Error("Request to /api/instrument/logclient failed, server responseCode: "+n.status+" body: "+n.response);return console.log(o),void t(o)}e()}};var o=s.splice(0,s.length);n.send(JSON.stringify(o))}))).then(h)};h();var b=function(e){s.push(e)};return{logger:function(e){if(e.type!==o.Analytics&&e.type!==o.Performance&&!function(e){return e.type===o.Framework}(e)){c+=1;var t="",n="";try{if(null!==(t=function(){throw new Error("History object has not been set")}().location.pathname)&&-1!==t.indexOf(":")){var i=t.split(":");t=i[0],n=i[1]}}catch(e){t="",n=""}if(function(e){return e.type===o.Flight}(e))b({TagId:526460,LogLevel:x.Info,LogCategory:r.ClientAnalytics,Message:"UI Flight: "+e.flightName,Adhoc0:e.flightName,Adhoc1:JSON.stringify(e.flightData),Adhoc2:E(JSON.stringify(e.data)),Adhoc3:c.toString(),Adhoc5:E(n),PageName:E(t)});else{var a=parseInt(e.id,10);if(b({TagId:a,LogLevel:x.Info,LogCategory:e.logCategory||r.ClientInfo,Message:E(e.message||""),Adhoc0:u,Adhoc1:c.toString(),Adhoc2:E(JSON.stringify({data:e.data})),Adhoc5:E(n),PageName:E(t)}),function(e){return e.type===o.Error}(e)){var s=e.error.stack||"";b({TagId:500781,LogLevel:x.Error,LogCategory:e.logCategory||r.ClientError,Message:"UI Exception: "+(e.error.message||""),Adhoc0:u,Adhoc1:c.toString(),Adhoc2:E(JSON.stringify({version:g,stack:s})),Adhoc3:a.toString(),Adhoc5:E(n),PageName:E(t)})}}}},flush:function(){return Object(a.__awaiter)(this,void 0,void 0,(function(){return Object(a.__generator)(this,(function(e){return[2,Promise.all([l,m()]).then((function(){}))]}))}))}}}(c,p,u,d.name+"_"+d.version)),S=!1,void 0!==L.additionalLoggers&&Object.keys(L.additionalLoggers).forEach((function(e){h(e,{logger:L.additionalLoggers[e]})})),F=!0),g=performance.now(),s?(f({type:o.Info,message:"uxVersion Data is provided thru parameter",id:"508372",data:s}),P=JSON.parse(s),[3,4]):[3,2]);case 2:if(e.forHostVersion&&e.hvcVersion)throw new Error("cannot specify both forHostVersion and hvcVersion");return M=!!l,m="",e.forHostVersion?m="?bldVer="+encodeURIComponent(e.forHostVersion):e.hvcVersion&&(m="?pkgver="+encodeURIComponent(e.hvcVersion)),[4,A(m)];case 3:b=v.sent(),f({type:o.Info,message:"uxVersion Data is provided thru parameter",id:"508372",data:b}),P=JSON.parse(b),v.label=4;case 4:return I=!0,f({type:o.Info,message:"hvcloader initialze() step has succeeded",id:"513574",data:{eventName:"hvcLoader_Initialize_step",fromStart:performance.now()-g,UA:navigator.userAgent,enableQueryParam:M}}),[3,6];case 5:throw y=v.sent(),f({type:o.Error,message:"hvcloader initialze() step has failed "+y.message,id:"508376",error:y}),y;case 6:return[2]}}))}))}function z(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n,r,i,s,l;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:t=P,a.label=1;case 1:if(a.trys.push([1,7,,8]),!I)throw new Error("initialize() needs to be invoked before calling preloadFeature()");return n=performance.now(),e.localMode?[4,N()]:[3,3];case 2:a.sent(),t=B,a.label=3;case 3:if(!t)throw new Error("uxVersionData is not populated");return r=e.featureName.toLowerCase(),t[r]?v(r)&&R(r)===!!e.localMode?(f({type:o.Info,message:"preloadFeature() feature "+r+" already loaded previously",id:"508465",data:{hvc:r}}),[3,6]):[3,4]:(f({type:o.Info,message:"HVC "+r+" is not enabled for this host",id:"508419"}),[2,[!1,void 0]]);case 4:return[4,p(t[r].loaderSpec,y)];case 5:if(a.sent(),!v(r))throw new Error("preloadFeature(): global is not populated after loading for "+r);void 0===window.m365_admin_features.locDbg&&(window.m365_admin_features.locDbg={}),window.m365_admin_features.locDbg[r]=!!e.localMode,a.label=6;case 6:e.adapters&&j.set(r,e.adapters),i=void 0;try{i=window.m365_admin_features.staticAdditionalObjects[r]}catch(e){throw s=window.m365_admin_features.foreignEnvMainVersion,f({type:o.Error,message:s?"using v3 Hvc "+r+", error when trying to retrieve staticAdditionalObjects, error: "+e.message:"using v2 Hvc "+r+", staticAdditionalObjects is not supported, error: "+e.message,id:"521848",error:e}),e}return f({type:o.Info,message:"preloadFeatures() step has succeeded",id:"513585",data:{hvc:r,uxdata:JSON.stringify(t),eventName:"preloadFeature_step",fromStart:performance.now()-n,UA:navigator.userAgent}}),[2,[!0,i]];case 7:throw l=a.sent(),f({type:o.Error,message:"error in preloadFeatures() step "+l.message,id:"508417",data:{uxdata:JSON.stringify(t)},error:l}),l;case 8:return[2]}}))}))}function H(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n,r,i,s,l,c,u;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:if(a.trys.push([0,7,,8]),!I)throw new Error("initialize() needs to be invoked before calling bootstrapFeature()");if(t=performance.now(),n=P,R(r=e.featureName.toLowerCase())&&(n=B),!n)throw new Error("uxVersionData is not populated");if(!v(r))return[3,5];i={centroBaseUrl:D,cdnUrl:n[r].cdnUrl,ariaLoggerId:n.__hostApp_config.ariaLoggerId,targetAppUrls:n.__hostApp_config.hostingAppUrls,versionInfo:O},s=void 0,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,window.m365_admin_features.initializers[r](j.get(r),i,L)];case 2:return s=a.sent(),f({type:o.Info,message:"bootstrapFeature() step has succeeded",id:"513586",data:{hvc:r,eventName:"bootstrapFeature_step",fromStart:performance.now()-t,UA:navigator.userAgent}}),[3,4];case 3:throw l=a.sent(),c=window.m365_admin_features.foreignEnvMainVersion,f({type:o.Error,message:c?"using v3 Hvc "+r+", error when running foreignFeatureInitializeRuntime, error: "+l.message:"using v2 Hvc "+r+" is not supported, error: "+l.message,id:"521851",error:l}),l;case 4:return[2,s];case 5:throw new Error("bootstrapFeature(): preloadFeature() was not called before bootstraping "+r);case 6:return[3,8];case 7:throw u=a.sent(),f({type:o.Error,message:"error in bootstrapFeature() step "+u.message,id:"508481",error:u}),u;case 8:return[2]}}))}))}!function(e){e.GET="GET",e.PUT="PUT",e.POST="POST",e.DELETE="DELETE",e.PATCH="PATCH"}(k||(k={})),function(e){e.M365AdminCenter="MAC",e.Mover="Mover",e.ExchangeAdminCenter="EAC",e.SharepointAdminCenter="SPO",e.TeamsAdminCenter="TAC",e.ComplianceAdminCenter="CAC",e.SecurityAdminCenter="SAC",e.ProductivityAdminCenter="PAC",e.GraphApi="Graph",e.VRoomApi="VRoom",e.DeviceCareApi="DeviceCare",e.RecommendationApi="Reco",e.M365AoboApi="M365Aobo",e.Assist="Assist",e.BusinessApplicationPlatform="PPACBap",e.PowerPlatformAPITenantLevel="ppapi-tenant-level",e.PowerPlatformAPIEnvironmentLevel="ppapi-environment-level",e.DynamicsCRM="dynamics-crm",e.GovernancePPACAPI="GovPPACAPI",e.LicensingAPI="LicAPI",e.PPApiTenantLevel="PPApiTenantLevel",e.Fusion="Fusion",e.VivaPulse="VivaPulse",e.CloudPolicyServiceApi="OCPS",e.ECS="ECS",e.O365ShellServices="O365Shell",e.ProfileService="ProfileService",e.VsbHub="VsbHub",e.Augloop="Augloop",e.EmbeddedFinanceService="EmbeddedFinanceService",e.AzureResourceManager="ARM"}(T||(T={})),function(e){e.Centro="Centro",e.Hvc="Hvc",e.Consumer="Consumer"}(_||(_={})),function(e){e.Request="Request",e.History="History",e.DataSources="DataSources",e.SetTitleImpl="SetTitleImpl"}(w||(w={}));var V=/^$|^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i,U=function(e){var t=e.hostName,n=e.locale,o=e.centroUrl,r=e.specificHvcVersion,i=e.majorVersion,a=e.centroHvcData,s=e.enableUxVersionQueryParam,l={centroEnvironmentBaseUrl:null!=o?o:"https://admin.microsoft.com",preConfig:{hostName:t,locale:n,appId:e.telemetryAppId,perfPrefix:"".concat("OcvFeedback","_").concat(t)},forHostVersion:null!=i?i:"v2",hvcVersion:"",centroHvcData:null!=a?a:"",enableUxVersionQueryParam:s};return r?(l.hvcVersion=r,l.forHostVersion="",l):l};function G(e){f({type:o.Info,message:"".concat("logInAppFeedback",": ").concat(e),id:"523909"})}function q(e,t){throw f({type:o.Error,message:"".concat("logInAppFeedback",": ").concat(e),id:"523910",error:t}),t}function Q(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n,o,r,i,s;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return t=e.inAppFeedbackRef,n=e.hostName,o=e.locale,r=e.telemetryAppId,i=[],t||i.push("inAppFeedbackRef ".concat("is a mandatory parameter")),n||(i.push("hostName ".concat("is a mandatory parameter")),e.hostName="OcvFeedbackDemoHostingApp"),o||(i.push("locale ".concat("is a mandatory parameter")),e.locale="en"),r&&!V.test(r)&&i.push("telemetryAppId needs to be GUID"),i.length>0?[4,W(U(e))]:[3,2];case 1:throw a.sent(),q("Initialization parameter Error: ",s=new Error(JSON.stringify(i))),e.onInitializationError&&e.onInitializationError(s),s;case 2:return[2]}}))}))}var K,J,Y=function(e){var t,n;(null===(t=e.feedbackConfig)||void 0===t?void 0:t.isDisplayed)&&(e.performanceTimestamps=Object(a.__assign)(Object(a.__assign)({},e.performanceTimestamps),{hvcInvocationTimestamp:Date.now()}));var o=function(e){var t="".concat("inapp-feedback-loader v").concat("2.15.0");return e?e.includes("inapp-feedback-loader v")?e:"".concat(e," | ").concat(t):t}(null===(n=e.telemetry)||void 0===n?void 0:n.sdkVersion);return e.telemetry?e.telemetry.sdkVersion=o:e.telemetry={sdkVersion:o},e},Z=n(214),$=(K={},J=[],{register:function(e){return e&&J.push(e),K},unregister:function(e){var t=J.indexOf(e);t>-1&&J.splice(t,1)},updateFeedbackObject:function(e){var t=Z.merge({},K,e);t=Y(t),J.forEach((function(e){return e(t)}))},openFeedbackObject:function(e){e.feedbackConfig.isDisplayed=!0,e=Y(e),J.forEach((function(t){return t(e)}))}});function X(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n,o;return Object(a.__generator)(this,(function(r){switch(r.label){case 0:return[4,Q(e)];case 1:return r.sent(),te(),(null===(o=window.__inappfeedback_centro_integration_config)||void 0===o?void 0:o.unmountFunction)&&window.__inappfeedback_centro_integration_config.unmountFunction(),[4,window.__inappfeedback_centro_integration_config.loadInAppFeedbackPackage(e)];case 2:return r.sent(),[4,window.__inappfeedback_centro_integration_config.bootstrapFeature({featureName:"ocv-inapp-feedback"})];case 3:return t=r.sent(),n=window.__inappfeedback_centro_integration_config,[4,t.main(e.inAppFeedbackRef)];case 4:return n.unmountFunction=r.sent(),G("InAppFeedback Component Initialization Completed."),[2]}}))}))}function ee(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){return Object(a.__generator)(this,(function(t){switch(t.label){case 0:return[4,W(U(e)).catch((function(e){q("InAppFeedback initilization failed at centro initialize function",e)}))];case 1:return t.sent(),[4,z({featureName:"ocv-inapp-feedback",adapters:{dataSources:function(e){e("centro.hvc.feedback.initOptions",$)}}}).catch((function(e){q("InAppFeedback initilization failed at centro initialize preloadFeature",e)}))];case 2:return t.sent(),[2]}}))}))}var te=function(){window.__inappfeedback_centro_integration_config||(window.__inappfeedback_centro_integration_config={updateFeedbackOptions:$.updateFeedbackObject,openFeedback:$.openFeedbackObject,logInAppFeedbackInfo:G,logInAppFeedbackError:q,unmountFunction:function(){},bootstrapFeature:H,loadInAppFeedbackPackage:ee},G("inappfeedbackConfig Initialized"))};function ne(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){return Object(a.__generator)(this,(function(t){switch(t.label){case 0:return te(),[4,window.__inappfeedback_centro_integration_config.loadInAppFeedbackPackage(e)];case 1:return t.sent(),[2]}}))}))}var oe,re,ie,ae,se,le,ce,ue,de,pe,ge,he,me,be,fe,xe,Ee,Se=function(e){var t;(null===(t=window.__inappfeedback_centro_integration_config)||void 0===t?void 0:t.openFeedback)?window.__inappfeedback_centro_integration_config.openFeedback(e):q("openFeedback not added to config",new Error(JSON.stringify(window.__inappfeedback_centro_integration_config)))};!function(e){e.Smile="Smile",e.Frown="Frown",e.Idea="Idea",e.Unclassified="Unclassified"}(oe||(oe={})),function(e){e.Undefined="Undefined",e.MinorWithoutParentalConsent="MinorWithoutParentalConsent",e.MinorWithParentalConsent="MinorWithParentalConsent",e.NotAdult="NotAdult",e.Adult="Adult",e.MinorNoParentalConsentRequired="MinorNoParentalConsentRequired"}(re||(re={})),function(e){e.MSA="MSA",e.AAD="AAD",e.Unauthenticated="Unauthenticated"}(ie||(ie={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled",e.NotConfigured="Not Configured",e.NotApplicable="Not Applicable"}(ae||(ae={})),function(e){e.JPEG="jpeg",e.PNG="png"}(se||(se={})),function(e){e.Landscape="Landscape",e.Potrait="Potrait"}(le||(le={})),function(e){e.AutoCapture="AutoCapture",e.AutoCaptureWithHtml2Canvas="AutoCaptureWithHtml2Canvas",e.ProvidedAtInitialization="ProvidedAtInitialization",e.DynamicallyProvided="DynamicallyProvided"}(ce||(ce={})),function(e){e.SidePane="SidePane",e.Modal="Modal",e.NoSurface="NoSurface",e.CallOut="CallOut",e.NoSurfaceWithoutTitle="NoSurfaceWithoutTitle"}(ue||(ue={})),function(e){e.Windows="Windows",e.IOS="iOS",e.Android="Android",e.WacTaskPane="WacTaskPane",e.MacOS="MacOS",e.Web="Web",e.IFrame="IFrame"}(de||(de={})),function(e){e.DropDown="DropDown",e.MultiSelect="MultiSelect",e.Rating="Rating",e.SingleSelect="SingleSelect",e.SingleSelectHorizontal="SingleSelectHorizontal"}(pe||(pe={})),function(e){e.FeatureArea="FeatureArea",e.ResponsibleAI="ResponsibleAI",e.Experience="Experience",e.ProductSatisfaction="ProductSatisfaction",e.CrashImpact="CrashImpact",e.Custom="Custom",e.AIThumbsDown="AIThumbsDown",e.AIThumbsUp="AIThumbsUp",e.AIError="AIError",e.PromptSuggestion="PromptSuggestion"}(ge||(ge={})),function(e){e.QuestionNotRequired="QuestionNotRequired",e.CommentNotRequired="CommentNotRequired",e.CommentRequiredWithLastOption="CommentRequiredWithLastOption"}(he||(he={})),function(e){e.Application="Application",e.User="User"}(me||(me={})),function(e){e.Bot="Bot",e.User="User"}(be||(be={})),function(e){e.Header="Header",e.Footer="Footer",e.Backstage="Backstage",e.HelpMenu="Help Menu",e.Canvas="Canvas",e.Chat="Chat"}(fe||(fe={})),function(e){e.MSO="MSO",e.SDX="SDX",e.VivaUX="VivaUX",e.OneShell="OneShell",e.Teams="Teams",e.Outlook="Outlook"}(xe||(xe={})),function(e){e.ODS="ODS",e.TenantFeedback="TenantFeedback"}(Ee||(Ee={}))},2703:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return g})),n.d(t,"d",(function(){return h}));var o=n(127),r=n(55),i=n(788);const a=e=>e.floatieGroupModels,s=e=>e.activeFloatieGroups,l=e=>e.contextualUILayoutModel.floatieLayout,c=e=>!!e.contextualUILayoutModel.floatieLayout,u=Object(o.a)([s,a],(e,t)=>e.length<=0?[]:e.map(e=>{const n=t[e];if(void 0!==n)switch(n.type){case"MultiRowFloatieGroupModel":return[...n.topControlsRow,...n.bottomControlsRow];case"SingleRowFloatieGroupModel":return n.controls;case"SingleControlFloatieGroupModel":return[n.control];case"SingleRowMultiSectionFloatieGroupModel":return n.sectionControls.flat()}return[]}).reduce((e,t)=>e.concat(...t))),d=Object(o.a)([u,c],(e,t)=>e.length<=0||!t?[]:e),p=Object(o.a)([u,r.u],(e,t)=>{if(e.length<=0)return{};const n={};return e.forEach(e=>{const o=Object(r.p)(t,e);n[e]=o.modelType}),n});function g(){Object(i.c)(e=>d(e))}function h(e){return{getFloatieOnlyControlsMap:()=>p(e.getState())}}},2704:function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return f}));var o=n(5),r=n(20),i=n(103),a=n(329),s=n(1036),l=n(486);const c=Object(r.c)((e,t)=>Object(o.eb)({display:e?"none":"flex"},t)),u=Object(r.c)((e,t)=>Object(o.db)({wrapper:{position:"relative",maxWidth:"490px"},container:Object(o.eb)(d,p),leftFade:Object(o.eb)(g,h(e,t)),rightFade:Object(o.eb)(g,m(e,t))})),d={display:"inline-flex",width:"100%",overflowX:"scroll",whiteSpace:"nowrap",MsOverflowStyle:"none",selectors:{"::-webkit-scrollbar":{display:"none"}}},p={"scrollbar-width":"none"},g={position:"absolute",top:0,width:"25px",height:"100%",zIndex:1,pointerEvents:"none"},h=Object(r.c)((e,t)=>({left:0,backgroundImage:`linear-gradient(to right, ${Object(i.a)(e).menuBackgroundColor} 20%, transparent)`,visibility:t?"visible":"hidden"})),m=Object(r.c)((e,t)=>({right:0,backgroundImage:`linear-gradient(to left,  ${Object(i.a)(e).menuBackgroundColor} 20%, transparent)`,visibility:t?"hidden":"visible"})),b=Object(r.c)((e,t,n,r)=>{const s=Object(i.a)(e);return Object(o.db)({root:_object_spread({animation:"none",border:"none",lineHeight:"14px"},Object(a.e)()?{display:"inline"}:{}),calloutMain:{background:s.menuBackgroundColor,display:"inline-flex",alignItems:"center",padding:"3px 4px"},container:t?{opacity:0}:{opacity:n}},r)}),f=Object(r.c)(e=>Object(o.db)(Object(s.b)(e),{divider:{height:l.a.floatieDividerHeight},wrapper:{padding:"0 5px"}}))},2730:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return c}));var o=n(5),r=n(20),i=n(270),a=n(415);const s=Object(r.c)((e,t,n,r)=>{const s="path[class*='OfficeIconColors_m']:not(.OfficeIconColors_HighContrast)",l={backgroundColor:e?"highlight":void 0},c={root:{width:"36px",minWidth:"36px",height:"30px",border:"none",marginLeft:"0px",borderRadius:"0px",padding:"0px",[o.m]:l},rootDisabled:{border:"none"},icon:{[s]:{fill:e&&!t?Object(a.e)(r).textColor:Object(a.f)(r).textColor},[o.m]:{selectors:{[s]:{fill:e?"highlighttext":"transparent"}}},width:"18px",height:"18px",margin:"0px"},label:{display:"none"}};return Object(o.db)(e?Object(i.o)(r):Object(i.p)(r),Object(a.d)(e?Object(a.c)(r,n):Object(a.f)(r),a.a),c)}),l=Object(r.c)(()=>({margin:"auto 10px"})),c=Object(r.c)(()=>({bodyContainer:{width:i.a},bodyItemContainer:{marginBottom:"15px"},label:{root:{padding:"0px"}},input:{root:{"*::-ms-reveal":{display:"none"}},field:{padding:"8px 6px"},suffix:{backgroundColor:"inherit",padding:"0px",flexShrink:0,height:"100%"}}}))},2731:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var o=n(163),r=n(151),i=n(1015),a=n(415),s=n(474),l=n(20);const c=Object(l.c)((e,t,n)=>{const l=((e,t)=>{if(!Object(o.c)())return(e=>({defaultBackgroundColor:r.a.white,textColor:e.primary,textHoverColor:e.shade10,textPressedColor:e.shade20,hoverBackgroundColor:e.tint40,pressedBackgroundColor:e.tint30,disabledBackgroundColor:e.primary,textDisabledColor:e.tint30,focusDisabledBackgroundColor:e.primary,disabledBorderColor:e.tint30,focusedBackgroundColor:r.a.white,focusedBorderColor:e.primary,focusDisabledBorderColor:e.primary,toggledBackgroundColor:e.tint40,borderColor:"transparent"}))(t);const n=Object(i.a)(e);return{defaultBackgroundColor:n.controlBackgroundColorForPrimaryBackground,textColor:n.primaryTextColor,textHoverColor:n.primaryTextHoverColor,textPressedColor:n.primaryTextActiveColor,hoverBackgroundColor:n.controlHoverBackgroundColorForPrimaryBackground,pressedBackgroundColor:n.controlPressedBackgroundColorForPrimaryBackground,disabledBackgroundColor:e.palette.themePrimary,textDisabledColor:e.palette.themeLight,focusDisabledBackgroundColor:e.palette.themePrimary,disabledBorderColor:e.palette.themeLight,focusedBackgroundColor:e.palette.white,focusedBorderColor:e.palette.themePrimary,focusDisabledBorderColor:e.palette.themePrimary,toggledBackgroundColor:e.palette.themeLighter,borderColor:"transparent"}})(e,t),c=((e,t)=>{if(!Object(o.c)())return(e=>({defaultBackgroundColor:e.primary,textColor:r.a.white,hoverBackgroundColor:e.shade10,pressedBackgroundColor:e.shade20,disabledBackgroundColor:e.primary,textDisabledColor:e.tint30,focusDisabledBackgroundColor:e.primary,disabledBorderColor:e.tint30,focusedBackgroundColor:e.primary,focusedBorderColor:r.a.white,focusDisabledBorderColor:r.a.white,toggledBackgroundColor:e.shade20,borderColor:r.a.white}))(t);const n=Object(i.a)(e);return{defaultBackgroundColor:n.primaryDefaultBackgroundColor,textColor:n.defaultTextLabelColorForPrimaryBackground,hoverBackgroundColor:n.primaryHoverBackgroundColor,pressedBackgroundColor:n.primaryPressedBackgroundColor,disabledBackgroundColor:e.palette.themePrimary,textDisabledColor:e.palette.themeLight,focusDisabledBackgroundColor:e.palette.themePrimary,disabledBorderColor:e.palette.themeLight,focusedBackgroundColor:e.palette.themePrimary,focusedBorderColor:n.primaryFocusBorderColor,focusDisabledBorderColor:n.primaryFocusDisabledBorderColor,toggledBackgroundColor:e.palette.themeDark,borderColor:n.primaryFocusBorderColor}})(e,t),u=Object(i.a)(e,t),d=Object(o.c)(),p=_object_spread_props(_object_spread({},c),{disabledBorderColor:"transparent",borderColor:void 0}),g={title:{color:u.defaultTextLabelColorForPrimaryBackground},mainContent:{color:u.defaultTextLabelColorForPrimaryBackground},closeButton:Object(a.d)(p),jumpToCalloutTargetButton:Object(a.d)(p),primaryButton:Object(a.d)(l,{borderWidth:2,gapBetweenOuter:1}),secondaryButton:Object(a.d)(c,a.a),coachmark:{color:u.primaryTextColor,beaconColorOne:u.primaryDefaultBackgroundColor,beaconColorTwo:u.primaryDefaultBackgroundColor},subComponentStyles:{callout:{beakCurtain:{backgroundColor:u.primaryDefaultBackgroundColor},beak:{backgroundColor:u.primaryDefaultBackgroundColor},calloutMain:{backgroundColor:u.primaryDefaultBackgroundColor,color:u.defaultTextLabelColorForPrimaryBackground,selectors:{"a:link, a:visited":{color:u.defaultTextLabelColorForPrimaryBackground},"a:hover":{color:d?e.palette.neutralLighterAlt:r.a.gray10},"a:active":{color:d?e.palette.neutralLighterAlt:r.a.gray20}}}}}};return Object(s.h)(g,n)})},2732:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var o=n(1),r=n(1015),i=n(415),a=n(235),s=n(474),l=n(2733),c=n(1239),u=n(2734);class d extends o.PureComponent{render(){const{appColors:e,styles:t,calloutProps:n}=this.props,d=t=>{const n=Object(r.a)(t);return{primaryButton:Object(i.d)(Object(i.c)(t,e),i.a),subComponentStyles:{callout:{calloutMain:{selectors:{"a:link, a:visited":{color:n.primaryTextColor},"a:hover":{color:n.primaryTextHoverColor},"a:active":{color:n.primaryTextActiveColor}}}}}}},p=_object_spread({},n,Object(l.b)(this.props));return o.createElement(a.a,null,e=>o.createElement(u.a,_object_spread_props(_object_spread({},this.props),{calloutProps:p,externalDismissCommandHandler:c.a,actionableAnnouncement:Object(l.a)(this.props),styles:Object(s.h)(d(e),t)})))}}},2733:function(e,t,n){"use strict";function o(e){return{"aria-roledescription":"TeachingCalloutProps"===e.type?NotificationStringsManager.get(NotificationStringsEnum.TeachingNotification):NotificationStringsManager.get(NotificationStringsEnum.Notification)}}function r(e){return e.primaryButtonProps||e.secondaryButtonProps||e.firstFocusElement?NotificationStringsManager.get(NotificationStringsEnum.Actionable):void 0}n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return r}))},2734:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var o=n(1),r=n(2248),i=n(82),a=n(81),s=n(217),l=n(638);class c extends o.PureComponent{render(){var e;const t=Object(l.a)().shieldSettings().isCalloutInsertFirstFixEnabled()?_object_spread_props(_object_spread({},this.props),{calloutProps:_object_spread_props(_object_spread({},this.props.calloutProps),{layerProps:_object_spread({insertFirst:!0},null===(e=this.props.calloutProps)||void 0===e?void 0:e.layerProps)})}):this.props;return o.createElement(r.a,_object_spread_props(_object_spread({},t),{onFullRenderCompleted:this.onFullRenderCompleted}))}constructor(e){super(e),this.onFullRenderCompleted=(e=!1)=>{const t=window.performance.now()-this.firstRenderStartMs;e===!!this.props.useCoachmark&&i.a.sendTraceTag(593371728,a.a.msoulscat_Wac_Ribbon,s.a.Info,`${e?"Coachmark":"Callout"} first render time: ${t} ms`),this.props.onFullRenderCompleted&&this.props.onFullRenderCompleted(e)},this.firstRenderStartMs=window.performance.now()}}},2735:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var o=n(1),r=n(2731),i=n(2733),a=n(1239),s=n(2734),l=n(235);class c extends o.PureComponent{render(){const{appColors:e,styles:t,calloutProps:n}=this.props,c=_object_spread({},n,Object(i.b)(this.props));return o.createElement(l.a,null,n=>o.createElement(s.a,_object_spread_props(_object_spread({},this.props),{calloutProps:c,externalDismissCommandHandler:a.a,actionableAnnouncement:Object(i.a)(this.props),styles:Object(r.a)(n,e,t)})))}}},2736:function(e,t,n){var o=n(2808),r=n(2809),i={float:"cssFloat"},a=n(2812);function s(e,t,n){var s=i[t];if(void 0===s&&(s=function(e){var t=r(e),n=o(t);return i[t]=i[e]=i[n]=n,n}(t)),s){if(void 0===n)return e.style[s];e.style[s]=a(s,n)}}function l(e,t){for(var n in t)t.hasOwnProperty(n)&&s(e,n,t[n])}function c(){2===arguments.length?"string"==typeof arguments[1]?arguments[0].style.cssText=arguments[1]:l(arguments[0],arguments[1]):s(arguments[0],arguments[1],arguments[2])}e.exports=c,e.exports.set=c,e.exports.get=function(e,t){return Array.isArray(t)?t.reduce((function(t,n){return t[n]=s(e,n||""),t}),{}):s(e,t||"")}},2801:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n(1);class r extends o.PureComponent{static setDefaultContainer(e){this._defaultContainer=e,this._waitingToastCallbacks.length&&(this._waitingToastCallbacks.forEach(t=>t(e)),this._waitingToastCallbacks=[])}static addToastContainer(e,t){var n;null===(n=this._toastContainers)||void 0===n||n.set(e,t)}componentWillUnmount(){this.removeToast()}componentDidUpdate(e,t){const{toastProps:n}=this.props,{container:o}=this.state;!t.container&&this.state.container&&this.ensureRegisteredWithContainer(),this.toastKey&&o&&e.toastProps!==n&&o.updateToast(this.toastKey,n)}componentDidMount(){this.ensureRegisteredWithContainer()}render(){return this.state.container?o.createElement(o.Fragment,null):null}ensureRegisteredWithContainer(){const e=this.props,{toastProps:t}=e,n=_object_without_properties(e,["toastProps"]);if(this.state.container&&!this.toastKey){const e=_object_spread_props(_object_spread({},n),{onHide:()=>{this.removeToast(),n.onHide&&n.onHide()},telemetryId:this.props.telemetryId||"toast"});this.toastKey=this.state.container.addToast(t,e)}}removeToast(){const{container:e}=this.state;this.toastKey&&e&&e.removeToast(this.toastKey),this.toastKey=void 0}constructor(e){var t;super(e);const{toastContainerId:n}=e.toastProps;var o;n&&null!==(t=r._toastContainers)&&void 0!==t&&t.has(n)?this.state={container:null===(o=r._toastContainers)||void 0===o?void 0:o.get(n)}:r._defaultContainer?this.state={container:r._defaultContainer}:(this.state={},r._waitingToastCallbacks.push(e=>this.setState({container:e})))}}r.defaultProps={showExclusively:!1},r._toastContainers=new Map,r._waitingToastCallbacks=[]},2802:function(e,t){function n(e,t,n,o){var r,i=null==(r=o)||"number"==typeof r||"boolean"==typeof r?o:n(o),a=t.get(i);return void 0===a&&(a=e.call(this,o),t.set(i,a)),a}function o(e,t,n){var o=Array.prototype.slice.call(arguments,3),r=n(o),i=t.get(r);return void 0===i&&(i=e.apply(this,o),t.set(r,i)),i}function r(e,t,n,o,r){return n.bind(t,e,o,r)}function i(e,t){return r(e,this,1===e.length?n:o,t.cache.create(),t.serializer)}function a(){return JSON.stringify(arguments)}function s(){this.cache=Object.create(null)}s.prototype.has=function(e){return e in this.cache},s.prototype.get=function(e){return this.cache[e]},s.prototype.set=function(e,t){this.cache[e]=t};var l={create:function(){return new s}};e.exports=function(e,t){var n=t&&t.cache?t.cache:l,o=t&&t.serializer?t.serializer:a;return(t&&t.strategy?t.strategy:i)(e,{cache:n,serializer:o})},e.exports.strategies={variadic:function(e,t){return r(e,this,o,t.cache.create(),t.serializer)},monadic:function(e,t){return r(e,this,n,t.cache.create(),t.serializer)}}},2803:function(e){e.exports=JSON.parse('{"name":"@ms/centro-hvc-loader","version":"3.6.0","description":"Project Centro high value component loader","license":"UNLICENSED","devDependencies":{"@types/webpack-env":"1.15.1","typescript":"4.2.3-gauri-patch-3"},"homepage":"https://office.visualstudio.com/OC/_git/M365AdminUX?path=%2Fmodules%2Fhvc-loader","bugs":{"url":"https://office.visualstudio.com/OC/_workitems/edit/2364251","email":"centroinfo@microsoft.com"},"author":"MAC Platform Team <macplat@microsoft.com>","main":"./dist/hvc-loader/index.js","module":"./dist/hvc-loader/index.js","typings":"./dist/hvc-loader/index.d.ts","scripts":{"build":"tsc -p ./tsconfig.json"},"dependencies":{"tslib":"^2.1.0"}}')},2804:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Scrollbars=void 0;var o,r=(o=n(2805))&&o.__esModule?o:{default:o};t.default=r.default,t.Scrollbars=r.default},2805:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n(2806),a=f(i),s=f(n(2736)),l=n(1),c=f(n(731)),u=f(n(2813)),d=f(n(2814)),p=f(n(2815)),g=f(n(2816)),h=f(n(2817)),m=n(2818),b=n(2819);function f(e){return e&&e.__esModule?e:{default:e}}function x(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var S=function(e){function t(e){var n;x(this,t);for(var o=arguments.length,r=Array(o>1?o-1:0),i=1;i<o;i++)r[i-1]=arguments[i];var a=E(this,(n=t.__proto__||Object.getPrototypeOf(t)).call.apply(n,[this,e].concat(r)));return a.getScrollLeft=a.getScrollLeft.bind(a),a.getScrollTop=a.getScrollTop.bind(a),a.getScrollWidth=a.getScrollWidth.bind(a),a.getScrollHeight=a.getScrollHeight.bind(a),a.getClientWidth=a.getClientWidth.bind(a),a.getClientHeight=a.getClientHeight.bind(a),a.getValues=a.getValues.bind(a),a.getThumbHorizontalWidth=a.getThumbHorizontalWidth.bind(a),a.getThumbVerticalHeight=a.getThumbVerticalHeight.bind(a),a.getScrollLeftForOffset=a.getScrollLeftForOffset.bind(a),a.getScrollTopForOffset=a.getScrollTopForOffset.bind(a),a.scrollLeft=a.scrollLeft.bind(a),a.scrollTop=a.scrollTop.bind(a),a.scrollToLeft=a.scrollToLeft.bind(a),a.scrollToTop=a.scrollToTop.bind(a),a.scrollToRight=a.scrollToRight.bind(a),a.scrollToBottom=a.scrollToBottom.bind(a),a.handleTrackMouseEnter=a.handleTrackMouseEnter.bind(a),a.handleTrackMouseLeave=a.handleTrackMouseLeave.bind(a),a.handleHorizontalTrackMouseDown=a.handleHorizontalTrackMouseDown.bind(a),a.handleVerticalTrackMouseDown=a.handleVerticalTrackMouseDown.bind(a),a.handleHorizontalThumbMouseDown=a.handleHorizontalThumbMouseDown.bind(a),a.handleVerticalThumbMouseDown=a.handleVerticalThumbMouseDown.bind(a),a.handleWindowResize=a.handleWindowResize.bind(a),a.handleScroll=a.handleScroll.bind(a),a.handleDrag=a.handleDrag.bind(a),a.handleDragEnd=a.handleDragEnd.bind(a),a.state={didMountUniversal:!1},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){this.addListeners(),this.update(),this.componentDidMountUniversal()}},{key:"componentDidMountUniversal",value:function(){this.props.universal&&this.setState({didMountUniversal:!0})}},{key:"componentDidUpdate",value:function(){this.update()}},{key:"componentWillUnmount",value:function(){this.removeListeners(),(0,i.cancel)(this.requestFrame),clearTimeout(this.hideTracksTimeout),clearInterval(this.detectScrollingInterval)}},{key:"getScrollLeft",value:function(){return this.view?this.view.scrollLeft:0}},{key:"getScrollTop",value:function(){return this.view?this.view.scrollTop:0}},{key:"getScrollWidth",value:function(){return this.view?this.view.scrollWidth:0}},{key:"getScrollHeight",value:function(){return this.view?this.view.scrollHeight:0}},{key:"getClientWidth",value:function(){return this.view?this.view.clientWidth:0}},{key:"getClientHeight",value:function(){return this.view?this.view.clientHeight:0}},{key:"getValues",value:function(){var e=this.view||{},t=e.scrollLeft,n=void 0===t?0:t,o=e.scrollTop,r=void 0===o?0:o,i=e.scrollWidth,a=void 0===i?0:i,s=e.scrollHeight,l=void 0===s?0:s,c=e.clientWidth,u=void 0===c?0:c,d=e.clientHeight,p=void 0===d?0:d;return{left:n/(a-u)||0,top:r/(l-p)||0,scrollLeft:n,scrollTop:r,scrollWidth:a,scrollHeight:l,clientWidth:u,clientHeight:p}}},{key:"getThumbHorizontalWidth",value:function(){var e=this.props,t=e.thumbSize,n=e.thumbMinSize,o=this.view,r=o.scrollWidth,i=o.clientWidth,a=(0,g.default)(this.trackHorizontal),s=Math.ceil(i/r*a);return a===s?0:t||Math.max(s,n)}},{key:"getThumbVerticalHeight",value:function(){var e=this.props,t=e.thumbSize,n=e.thumbMinSize,o=this.view,r=o.scrollHeight,i=o.clientHeight,a=(0,h.default)(this.trackVertical),s=Math.ceil(i/r*a);return a===s?0:t||Math.max(s,n)}},{key:"getScrollLeftForOffset",value:function(e){var t=this.view,n=t.scrollWidth,o=t.clientWidth;return e/((0,g.default)(this.trackHorizontal)-this.getThumbHorizontalWidth())*(n-o)}},{key:"getScrollTopForOffset",value:function(e){var t=this.view,n=t.scrollHeight,o=t.clientHeight;return e/((0,h.default)(this.trackVertical)-this.getThumbVerticalHeight())*(n-o)}},{key:"scrollLeft",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.view&&(this.view.scrollLeft=e)}},{key:"scrollTop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.view&&(this.view.scrollTop=e)}},{key:"scrollToLeft",value:function(){this.view&&(this.view.scrollLeft=0)}},{key:"scrollToTop",value:function(){this.view&&(this.view.scrollTop=0)}},{key:"scrollToRight",value:function(){this.view&&(this.view.scrollLeft=this.view.scrollWidth)}},{key:"scrollToBottom",value:function(){this.view&&(this.view.scrollTop=this.view.scrollHeight)}},{key:"addListeners",value:function(){if("undefined"!=typeof document&&this.view){var e=this.view,t=this.trackHorizontal,n=this.trackVertical,o=this.thumbHorizontal,r=this.thumbVertical;e.addEventListener("scroll",this.handleScroll),(0,d.default)()&&(t.addEventListener("mouseenter",this.handleTrackMouseEnter),t.addEventListener("mouseleave",this.handleTrackMouseLeave),t.addEventListener("mousedown",this.handleHorizontalTrackMouseDown),n.addEventListener("mouseenter",this.handleTrackMouseEnter),n.addEventListener("mouseleave",this.handleTrackMouseLeave),n.addEventListener("mousedown",this.handleVerticalTrackMouseDown),o.addEventListener("mousedown",this.handleHorizontalThumbMouseDown),r.addEventListener("mousedown",this.handleVerticalThumbMouseDown),window.addEventListener("resize",this.handleWindowResize))}}},{key:"removeListeners",value:function(){if("undefined"!=typeof document&&this.view){var e=this.view,t=this.trackHorizontal,n=this.trackVertical,o=this.thumbHorizontal,r=this.thumbVertical;e.removeEventListener("scroll",this.handleScroll),(0,d.default)()&&(t.removeEventListener("mouseenter",this.handleTrackMouseEnter),t.removeEventListener("mouseleave",this.handleTrackMouseLeave),t.removeEventListener("mousedown",this.handleHorizontalTrackMouseDown),n.removeEventListener("mouseenter",this.handleTrackMouseEnter),n.removeEventListener("mouseleave",this.handleTrackMouseLeave),n.removeEventListener("mousedown",this.handleVerticalTrackMouseDown),o.removeEventListener("mousedown",this.handleHorizontalThumbMouseDown),r.removeEventListener("mousedown",this.handleVerticalThumbMouseDown),window.removeEventListener("resize",this.handleWindowResize),this.teardownDragging())}}},{key:"handleScroll",value:function(e){var t=this,n=this.props,o=n.onScroll,r=n.onScrollFrame;o&&o(e),this.update((function(e){var n=e.scrollLeft,o=e.scrollTop;t.viewScrollLeft=n,t.viewScrollTop=o,r&&r(e)})),this.detectScrolling()}},{key:"handleScrollStart",value:function(){var e=this.props.onScrollStart;e&&e(),this.handleScrollStartAutoHide()}},{key:"handleScrollStartAutoHide",value:function(){this.props.autoHide&&this.showTracks()}},{key:"handleScrollStop",value:function(){var e=this.props.onScrollStop;e&&e(),this.handleScrollStopAutoHide()}},{key:"handleScrollStopAutoHide",value:function(){this.props.autoHide&&this.hideTracks()}},{key:"handleWindowResize",value:function(){this.update()}},{key:"handleHorizontalTrackMouseDown",value:function(e){e.preventDefault();var t=e.target,n=e.clientX,o=t.getBoundingClientRect().left,r=this.getThumbHorizontalWidth(),i=Math.abs(o-n)-r/2;this.view.scrollLeft=this.getScrollLeftForOffset(i)}},{key:"handleVerticalTrackMouseDown",value:function(e){e.preventDefault();var t=e.target,n=e.clientY,o=t.getBoundingClientRect().top,r=this.getThumbVerticalHeight(),i=Math.abs(o-n)-r/2;this.view.scrollTop=this.getScrollTopForOffset(i)}},{key:"handleHorizontalThumbMouseDown",value:function(e){e.preventDefault(),this.handleDragStart(e);var t=e.target,n=e.clientX,o=t.offsetWidth,r=t.getBoundingClientRect().left;this.prevPageX=o-(n-r)}},{key:"handleVerticalThumbMouseDown",value:function(e){e.preventDefault(),this.handleDragStart(e);var t=e.target,n=e.clientY,o=t.offsetHeight,r=t.getBoundingClientRect().top;this.prevPageY=o-(n-r)}},{key:"setupDragging",value:function(){(0,s.default)(document.body,m.disableSelectStyle),document.addEventListener("mousemove",this.handleDrag),document.addEventListener("mouseup",this.handleDragEnd),document.onselectstart=p.default}},{key:"teardownDragging",value:function(){(0,s.default)(document.body,m.disableSelectStyleReset),document.removeEventListener("mousemove",this.handleDrag),document.removeEventListener("mouseup",this.handleDragEnd),document.onselectstart=void 0}},{key:"handleDragStart",value:function(e){this.dragging=!0,e.stopImmediatePropagation(),this.setupDragging()}},{key:"handleDrag",value:function(e){if(this.prevPageX){var t=e.clientX,n=-this.trackHorizontal.getBoundingClientRect().left+t-(this.getThumbHorizontalWidth()-this.prevPageX);this.view.scrollLeft=this.getScrollLeftForOffset(n)}if(this.prevPageY){var o=e.clientY,r=-this.trackVertical.getBoundingClientRect().top+o-(this.getThumbVerticalHeight()-this.prevPageY);this.view.scrollTop=this.getScrollTopForOffset(r)}return!1}},{key:"handleDragEnd",value:function(){this.dragging=!1,this.prevPageX=this.prevPageY=0,this.teardownDragging(),this.handleDragEndAutoHide()}},{key:"handleDragEndAutoHide",value:function(){this.props.autoHide&&this.hideTracks()}},{key:"handleTrackMouseEnter",value:function(){this.trackMouseOver=!0,this.handleTrackMouseEnterAutoHide()}},{key:"handleTrackMouseEnterAutoHide",value:function(){this.props.autoHide&&this.showTracks()}},{key:"handleTrackMouseLeave",value:function(){this.trackMouseOver=!1,this.handleTrackMouseLeaveAutoHide()}},{key:"handleTrackMouseLeaveAutoHide",value:function(){this.props.autoHide&&this.hideTracks()}},{key:"showTracks",value:function(){clearTimeout(this.hideTracksTimeout),(0,s.default)(this.trackHorizontal,{opacity:1}),(0,s.default)(this.trackVertical,{opacity:1})}},{key:"hideTracks",value:function(){var e=this;if(!this.dragging&&!this.scrolling&&!this.trackMouseOver){var t=this.props.autoHideTimeout;clearTimeout(this.hideTracksTimeout),this.hideTracksTimeout=setTimeout((function(){(0,s.default)(e.trackHorizontal,{opacity:0}),(0,s.default)(e.trackVertical,{opacity:0})}),t)}}},{key:"detectScrolling",value:function(){var e=this;this.scrolling||(this.scrolling=!0,this.handleScrollStart(),this.detectScrollingInterval=setInterval((function(){e.lastViewScrollLeft===e.viewScrollLeft&&e.lastViewScrollTop===e.viewScrollTop&&(clearInterval(e.detectScrollingInterval),e.scrolling=!1,e.handleScrollStop()),e.lastViewScrollLeft=e.viewScrollLeft,e.lastViewScrollTop=e.viewScrollTop}),100))}},{key:"raf",value:function(e){var t=this;this.requestFrame&&a.default.cancel(this.requestFrame),this.requestFrame=(0,a.default)((function(){t.requestFrame=void 0,e()}))}},{key:"update",value:function(e){var t=this;this.raf((function(){return t._update(e)}))}},{key:"_update",value:function(e){var t=this.props,n=t.onUpdate,o=t.hideTracksWhenNotNeeded,r=this.getValues();if((0,d.default)()){var i=r.scrollLeft,a=r.clientWidth,l=r.scrollWidth,c=(0,g.default)(this.trackHorizontal),u=this.getThumbHorizontalWidth(),p={width:u,transform:"translateX("+i/(l-a)*(c-u)+"px)"},m=r.scrollTop,b=r.clientHeight,f=r.scrollHeight,x=(0,h.default)(this.trackVertical),E=this.getThumbVerticalHeight(),S={height:E,transform:"translateY("+m/(f-b)*(x-E)+"px)"};if(o){var y={visibility:l>a?"visible":"hidden"},C={visibility:f>b?"visible":"hidden"};(0,s.default)(this.trackHorizontal,y),(0,s.default)(this.trackVertical,C)}(0,s.default)(this.thumbHorizontal,p),(0,s.default)(this.thumbVertical,S)}n&&n(r),"function"==typeof e&&e(r)}},{key:"render",value:function(){var e=this,t=(0,d.default)(),n=this.props,r=(n.onScroll,n.onScrollFrame,n.onScrollStart,n.onScrollStop,n.onUpdate,n.renderView),i=n.renderTrackHorizontal,a=n.renderTrackVertical,s=n.renderThumbHorizontal,c=n.renderThumbVertical,p=n.tagName,g=(n.hideTracksWhenNotNeeded,n.autoHide),h=(n.autoHideTimeout,n.autoHideDuration),b=(n.thumbSize,n.thumbMinSize,n.universal),f=n.autoHeight,x=n.autoHeightMin,E=n.autoHeightMax,S=n.style,y=n.children,C=function(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}(n,["onScroll","onScrollFrame","onScrollStart","onScrollStop","onUpdate","renderView","renderTrackHorizontal","renderTrackVertical","renderThumbHorizontal","renderThumbVertical","tagName","hideTracksWhenNotNeeded","autoHide","autoHideTimeout","autoHideDuration","thumbSize","thumbMinSize","universal","autoHeight","autoHeightMin","autoHeightMax","style","children"]),v=this.state.didMountUniversal,R=o({},m.containerStyleDefault,f&&o({},m.containerStyleAutoHeight,{minHeight:x,maxHeight:E}),S),k=o({},m.viewStyleDefault,{marginRight:t?-t:0,marginBottom:t?-t:0},f&&o({},m.viewStyleAutoHeight,{minHeight:(0,u.default)(x)?"calc("+x+" + "+t+"px)":x+t,maxHeight:(0,u.default)(E)?"calc("+E+" + "+t+"px)":E+t}),f&&b&&!v&&{minHeight:x,maxHeight:E},b&&!v&&m.viewStyleUniversalInitial),T={transition:"opacity "+h+"ms",opacity:0},_=o({},m.trackHorizontalStyleDefault,g&&T,(!t||b&&!v)&&{display:"none"}),w=o({},m.trackVerticalStyleDefault,g&&T,(!t||b&&!v)&&{display:"none"});return(0,l.createElement)(p,o({},C,{style:R,ref:function(t){e.container=t}}),[(0,l.cloneElement)(r({style:k}),{key:"view",ref:function(t){e.view=t}},y),(0,l.cloneElement)(i({style:_}),{key:"trackHorizontal",ref:function(t){e.trackHorizontal=t}},(0,l.cloneElement)(s({style:m.thumbHorizontalStyleDefault}),{ref:function(t){e.thumbHorizontal=t}})),(0,l.cloneElement)(a({style:w}),{key:"trackVertical",ref:function(t){e.trackVertical=t}},(0,l.cloneElement)(c({style:m.thumbVerticalStyleDefault}),{ref:function(t){e.thumbVertical=t}}))])}}]),t}(l.Component);t.default=S,S.propTypes={onScroll:c.default.func,onScrollFrame:c.default.func,onScrollStart:c.default.func,onScrollStop:c.default.func,onUpdate:c.default.func,renderView:c.default.func,renderTrackHorizontal:c.default.func,renderTrackVertical:c.default.func,renderThumbHorizontal:c.default.func,renderThumbVertical:c.default.func,tagName:c.default.string,thumbSize:c.default.number,thumbMinSize:c.default.number,hideTracksWhenNotNeeded:c.default.bool,autoHide:c.default.bool,autoHideTimeout:c.default.number,autoHideDuration:c.default.number,autoHeight:c.default.bool,autoHeightMin:c.default.oneOfType([c.default.number,c.default.string]),autoHeightMax:c.default.oneOfType([c.default.number,c.default.string]),universal:c.default.bool,style:c.default.object,children:c.default.node},S.defaultProps={renderView:b.renderViewDefault,renderTrackHorizontal:b.renderTrackHorizontalDefault,renderTrackVertical:b.renderTrackVerticalDefault,renderThumbHorizontal:b.renderThumbHorizontalDefault,renderThumbVertical:b.renderThumbVerticalDefault,tagName:"div",thumbMinSize:30,hideTracksWhenNotNeeded:!1,autoHide:!1,autoHideTimeout:1e3,autoHideDuration:200,autoHeight:!1,autoHeightMin:0,autoHeightMax:200,universal:!1}},2806:function(e,t,n){(function(t){for(var o=n(2807),r="undefined"==typeof window?t:window,i=["moz","webkit"],a="AnimationFrame",s=r["request"+a],l=r["cancel"+a]||r["cancelRequest"+a],c=0;!s&&c<i.length;c++)s=r[i[c]+"Request"+a],l=r[i[c]+"Cancel"+a]||r[i[c]+"CancelRequest"+a];if(!s||!l){var u=0,d=0,p=[];s=function(e){if(0===p.length){var t=o(),n=Math.max(0,1e3/60-(t-u));u=n+t,setTimeout((function(){var e=p.slice(0);p.length=0;for(var t=0;t<e.length;t++)if(!e[t].cancelled)try{e[t].callback(u)}catch(e){setTimeout((function(){throw e}),0)}}),Math.round(n))}return p.push({handle:++d,callback:e,cancelled:!1}),d},l=function(e){for(var t=0;t<p.length;t++)p[t].handle===e&&(p[t].cancelled=!0)}}e.exports=function(e){return s.call(r,e)},e.exports.cancel=function(){l.apply(r,arguments)},e.exports.polyfill=function(e){e||(e=r),e.requestAnimationFrame=s,e.cancelAnimationFrame=l}}).call(this,n(417))},2807:function(e,t,n){(function(t){(function(){var n,o,r,i,a,s;"undefined"!=typeof performance&&null!==performance&&performance.now?e.exports=function(){return performance.now()}:null!=t&&t.hrtime?(e.exports=function(){return(n()-a)/1e6},o=t.hrtime,i=(n=function(){var e;return 1e9*(e=o())[0]+e[1]})(),s=1e9*t.uptime(),a=i-s):Date.now?(e.exports=function(){return Date.now()-r},r=Date.now()):(e.exports=function(){return(new Date).getTime()-r},r=(new Date).getTime())}).call(this)}).call(this,n(1632))},2808:function(e,t){var n=null,o=["Webkit","Moz","O","ms"];e.exports=function(e){n||(n=document.createElement("div"));var t=n.style;if(e in t)return e;for(var r=e.charAt(0).toUpperCase()+e.slice(1),i=o.length;i>=0;i--){var a=o[i]+r;if(a in t)return a}return!1}},2809:function(e,t,n){var o=n(2810);e.exports=function(e){return o(e).replace(/\s(\w)/g,(function(e,t){return t.toUpperCase()}))}},2810:function(e,t,n){var o=n(2811);e.exports=function(e){return o(e).replace(/[\W_]+(.|$)/g,(function(e,t){return t?" "+t:""})).trim()}},2811:function(e,t){e.exports=function(e){return n.test(e)?e.toLowerCase():o.test(e)?(function(e){return e.replace(i,(function(e,t){return t?" "+t:""}))}(e)||e).toLowerCase():r.test(e)?function(e){return e.replace(a,(function(e,t,n){return t+" "+n.toLowerCase().split("").join(" ")}))}(e).toLowerCase():e.toLowerCase()};var n=/\s/,o=/(_|-|\.|:)/,r=/([a-z][A-Z]|[A-Z][a-z])/,i=/[\W_]+(.|$)/g,a=/(.)([A-Z]+)/g},2812:function(e,t){var n={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridColumn:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,stopOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0};e.exports=function(e,t){return"number"!=typeof t||n[e]?t:t+"px"}},2813:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return"string"==typeof e}},2814:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){if(!1!==i)return i;if("undefined"!=typeof document){var e=document.createElement("div");(0,r.default)(e,{width:100,height:100,position:"absolute",top:-9999,overflow:"scroll",MsOverflowStyle:"scrollbar"}),document.body.appendChild(e),i=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}else i=0;return i||0};var o,r=(o=n(2736))&&o.__esModule?o:{default:o},i=!1},2815:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return!1}},2816:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.clientWidth,n=getComputedStyle(e),o=n.paddingLeft,r=n.paddingRight;return t-parseFloat(o)-parseFloat(r)}},2817:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.clientHeight,n=getComputedStyle(e),o=n.paddingTop,r=n.paddingBottom;return t-parseFloat(o)-parseFloat(r)}},2818:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.containerStyleDefault={position:"relative",overflow:"hidden",width:"100%",height:"100%"},t.containerStyleAutoHeight={height:"auto"},t.viewStyleDefault={position:"absolute",top:0,left:0,right:0,bottom:0,overflow:"scroll",WebkitOverflowScrolling:"touch"},t.viewStyleAutoHeight={position:"relative",top:void 0,left:void 0,right:void 0,bottom:void 0},t.viewStyleUniversalInitial={overflow:"hidden",marginRight:0,marginBottom:0},t.trackHorizontalStyleDefault={position:"absolute",height:6},t.trackVerticalStyleDefault={position:"absolute",width:6},t.thumbHorizontalStyleDefault={position:"relative",display:"block",height:"100%"},t.thumbVerticalStyleDefault={position:"relative",display:"block",width:"100%"},t.disableSelectStyle={userSelect:"none"},t.disableSelectStyleReset={userSelect:""}},2819:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e};t.renderViewDefault=function(e){return i.default.createElement("div",e)},t.renderTrackHorizontalDefault=function(e){var t=e.style,n=a(e,["style"]),r=o({},t,{right:2,bottom:2,left:2,borderRadius:3});return i.default.createElement("div",o({style:r},n))},t.renderTrackVerticalDefault=function(e){var t=e.style,n=a(e,["style"]),r=o({},t,{right:2,bottom:2,top:2,borderRadius:3});return i.default.createElement("div",o({style:r},n))},t.renderThumbHorizontalDefault=function(e){var t=e.style,n=a(e,["style"]),r=o({},t,{cursor:"pointer",borderRadius:"inherit",backgroundColor:"rgba(0,0,0,.2)"});return i.default.createElement("div",o({style:r},n))},t.renderThumbVerticalDefault=function(e){var t=e.style,n=a(e,["style"]),r=o({},t,{cursor:"pointer",borderRadius:"inherit",backgroundColor:"rgba(0,0,0,.2)"});return i.default.createElement("div",o({style:r},n))};var r,i=(r=n(1))&&r.__esModule?r:{default:r};function a(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}},2820:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return E}));var o=n(1),r=n(20),i=n(5),a=n(187),s=n(103),l=n(249),c=n(718),u=n(235),d=n(163),p=n(2120),g=n(486),h=n(2683),m=n(2684),b=n(2665);class f extends o.PureComponent{render(){return o.createElement(p.a,_object_spread_props(_object_spread({},this.props),{id:Object(b.a)(this.props.id),useLegacyButton:void 0===this.props.useLegacyButton||this.props.useLegacyButton,directionalHintFixed:!1,hideLabel:!0,variant:"floatieMenuButton",styles:Object(h.b)(this.props.styles),dataAutomationType:"FloatieFlyoutAnchor",keytipProps:void 0}))}}const x=Object(r.c)((e,t,n)=>{const o={root:{height:g.a.floatieLargeControlHeight,padding:"2px 2px 0px 2px"},flexContainer:{flexDirection:"column"},label:{margin:0,textAlign:"center"}},r={height:g.a.floatieSingleRowFlyoutAnchorDefaultLabelHeight,padding:"2px 2px 0px 2px",whiteSpace:"nowrap"},a={height:g.a.floatieSingleRowFlyoutAnchorLabelHeight,padding:"2px 2px 0px 2px"};return o.textContainer=n?r:a,Object(i.I)(e,o,t)});class E extends o.PureComponent{render(){var e;const t=null===(e=this.props.hideChevron)||void 0===e||e;return o.createElement(u.a,null,e=>o.createElement(p.a,_object_spread_props(_object_spread({},this.props),{id:Object(b.a)(this.props.id),styles:x(h.a,this.props.styles,this.props.isDefaultLabelRendering),dataAutomationType:"FloatieSingleRowFlyoutAnchor",directionalHintFixed:!1,useLegacyButton:!0,onRenderText:this.props.isDefaultLabelRendering?void 0:Object(m.a)(this.props.hideLabel?void 0:this.props.label),onRenderIcon:this._onRenderIcon(e),hideChevron:t,keytipProps:void 0})))}constructor(){super(...arguments),this._onRenderIcon=e=>()=>{var t;const{icon:n,iconColor:r,styles:s,disabled:u}=this.props,d=null!=n?n:{display:"none"},p=null==s?void 0:s.icon,g=null==s?void 0:s.menuIcon,h=null===(t=this.props.hideChevron)||void 0===t||t;return o.createElement("div",{className:Object(i.eb)(S)},o.createElement(a.a,_object_spread_props(_object_spread({},Object(l.a)(n,r,void 0,void 0,u)),{className:Object(i.eb)(C,d,p)})),h&&o.createElement(a.a,_object_spread_props(_object_spread({iconName:"ChevronDown"},Object(l.a)(Object(c.a)(this.props),void 0,void 0,void 0,u)),{className:Object(i.eb)(y(e),g)})))}}}const S={display:"flex",alignItems:"center"},y=e=>({height:12,lineHeight:12,width:12,fill:Object(d.c)()?Object(s.a)(e).textColor:"#444444",padding:"6px 0px"}),C={width:g.a.floatieLargeIconSize,height:g.a.floatieLargeIconSize,padding:2,lineHeight:20,margin:0}},2821:function(e,t){e.exports={ReadAloud_20:"ReadAloud_20",Play_20:"Play_20",CancelGlyph_20:"CancelGlyph_20",MicrophoneGlyph_24:"MicrophoneGlyph_24",MicrophonePaused_24:"MicrophonePaused_24",LeftChevronMedium_20:"LeftChevronMedium_20",ellipsis_20:"ellipsis_20",Pause_20:"Pause_20",Gear_24:"Gear_24",MicrophoneGlyphRed_24:"MicrophoneGlyphRed_24",OfficeAssistant_24:"OfficeAssistant_24",LanguageCommandsFlyoutAnchor_20:"LanguageCommandsFlyoutAnchor_20",PersonSpeakingSettings_24:"PersonSpeakingSettings_24",Info_20:"Info_20",FirstRecord_20:"FirstRecord_20",LastRecord_20:"LastRecord_20",VoicedictationGray_24:"VoicedictationGray_24",VolumePillGray:"VolumePillGray",VolumePillBlue:"VolumePillBlue",Voicedictation_24:"Voicedictation_24",VoiceDictation_Recording_20:"VoiceDictation_Recording_20",GearWithoutOfficeIconColorsM22_24:"GearWithoutOfficeIconColorsM22_24"}},3065:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return h}));var o=n(127),r=n(627),i=n(55),a=n(183),s=n(2703),l=n(226);const c=Object(a.a)((e,t,n,o,i)=>({type:"MultiRowFloatieGroup",id:e,topControlsRow:t.topControlsRow.map(e=>Object(r.c)(n,o,e,i,void 0,void 0,l.b.Floatie)),bottomControlsRow:t.bottomControlsRow.map(e=>Object(r.c)(n,o,e,i,void 0,void 0,l.b.Floatie))})),u=Object(a.a)((e,t,n,o,i)=>{const a=[];return t.sectionControls.forEach(e=>{const t=e.map(e=>Object(r.c)(n,o,e,i,void 0,void 0,l.b.Floatie));a.push(t)}),{type:"SingleRowMultiSectionFloatieGroup",id:e,sectionControls:a,preventAutoDismiss:t.preventAutoDismiss}}),d=Object(a.a)((e,t,n,o,a)=>({type:"SingleRowFloatieGroup",id:e,controls:t.controls.map(e=>{const t=Object(r.c)(n,o,e,a,void 0,void 0,l.b.Floatie),s=Object(i.v)(n,o,e);switch(s.type){case"ButtonModel":case"ToggleButtonModel":case"FlyoutAnchorModel":case"SplitButtonModel":case"StatefulSplitButtonModel":return _object_spread_props(_object_spread({},t),{icon:s.iconSet&&s.iconSet.icon24||s.iconSet&&s.iconSet.default});case"PreviewGalleryModel":return _object_spread_props(_object_spread({},t),{flyoutAnchorProps:{icon:s.flyoutAnchorIconSet&&s.flyoutAnchorIconSet.icon24||s.flyoutAnchorIconSet&&s.flyoutAnchorIconSet.default,label:s.flyoutAnchorLabel}})}return t}),preventAutoDismiss:t.preventAutoDismiss})),p=Object(a.a)((e,t,n,o,r)=>({type:"SingleControlFloatieGroup",id:e,control:g(n,o,t.control,r),preventAutoDismiss:t.preventAutoDismiss})),g=function(e,t,n,o){const a=Object(r.c)(e,t,n,o,void 0,void 0,l.b.Floatie),s=Object(i.v)(e,t,n);switch(s.type){case"FlyoutAnchorModel":return _object_spread_props(_object_spread({},a),{icon:s.iconSet&&s.iconSet.icon16||s.iconSet&&s.iconSet.default})}return a},h=e=>Object(o.a)([s.a,s.b,i.V,i.u,i.cb],(t,n,o,r,i)=>{const a=[];return(null!=e?e:t).map(e=>{const t=n[e];if(void 0!==t)switch(t.type){case"MultiRowFloatieGroupModel":a.push(c(e,t,o,r,i));break;case"SingleRowFloatieGroupModel":a.push(d(e,t,o,r,i));break;case"SingleControlFloatieGroupModel":a.push(p(e,t,o,r,i));break;case"SingleRowMultiSectionFloatieGroupModel":a.push(u(e,t,o,r,i));break;default:throw new Error("The floatie group type can't be placed in the floatie")}}),a})},3066:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return c}));var o=n(1),r=n(2128),i=n(2683),a=n(2684),s=n(2665);class l extends o.PureComponent{render(){return o.createElement(r.a,_object_spread_props(_object_spread({},this.props),{id:Object(s.a)(this.props.id),useLegacyButton:void 0===this.props.useLegacyButton||this.props.useLegacyButton,hideLabel:!0,styles:Object(i.b)(this.props.styles),variant:"floatieButton",dataAutomationType:"FloatieButton",keytipProps:void 0}))}}class c extends o.PureComponent{render(){return o.createElement(r.a,_object_spread_props(_object_spread({},this.props),{id:Object(s.a)(this.props.id),useLegacyButton:!0,styles:i.a,variant:"floatieLargeButton",dataAutomationType:"FloatieLargeButton",onRenderText:Object(a.a)(this.props.label),keytipProps:void 0}))}}},3067:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return c}));var o=n(1),r=n(2135),i=n(2683),a=n(2684),s=n(2665);class l extends o.PureComponent{render(){return o.createElement(r.a,_object_spread_props(_object_spread({},this.props),{id:Object(s.a)(this.props.id),useLegacyButton:void 0===this.props.useLegacyButton||this.props.useLegacyButton,hideLabel:!0,styles:Object(i.b)(this.props.styles),variant:"floatieButton",dataAutomationType:"FloatieToggleButton",keytipProps:void 0}))}}class c extends o.PureComponent{render(){return o.createElement(r.a,_object_spread_props(_object_spread({},this.props),{id:Object(s.a)(this.props.id),useLegacyButton:!0,styles:i.a,variant:"floatieLargeButton",dataAutomationType:"FloatieLargeToggleButton",onRenderText:Object(a.a)(this.props.hideLabel?void 0:this.props.label),keytipProps:void 0}))}}},3068:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var o=n(1),r=n(5),i=n(20),a=n(404),s=n(486),l=n(2665),c=n(2157);const u=Object(i.c)((e,t)=>Object(r.db)({container:[{height:s.a.floatieRowHeight,display:"inline-flex"},Object(a.b)(0,e)],root:{paddingRight:s.a.menuButtonWidth,height:28}},t)),d=Object(i.c)(e=>Object(r.db)({root:{width:s.a.menuButtonWidth,height:28}},e));class p extends o.PureComponent{render(){return o.createElement(c.a,_object_spread_props(_object_spread({},this.props),{id:Object(l.a)(this.props.id),dataAutomationType:"FloatieComboBox",styles:u(this.props.pinToPreviousComboBox,this.props.styles),caretDownButtonStyles:d(this.props.caretDownButtonStyles),keytipProps:void 0,shadowRenderMenu:!1,directionalHintDynamic:!0,preventCalloutDismissOnScroll:!0,useLegacyCombobox:void 0===this.props.useLegacyCombobox||this.props.useLegacyCombobox}))}}},3070:function(e,t,n){"use strict";n.r(t);var o=n(2735);n.d(t,"TeachingCallout",(function(){return o.a}));var r=n(2732);n.d(t,"OfficeStandardCallout",(function(){return r.a}));var i=n(2229);n.d(t,"Notification",(function(){return i.a}));var a=n(2801);n.d(t,"ToastNotification",(function(){return a.a}));var s=n(2248);n.d(t,"StandardCallout",(function(){return s.a}))},3081:function(e,t,n){"use strict";n.r(t),n.d(t,"notifications",(function(){return v})),n.d(t,"taskPane",(function(){return mR})),n.d(t,"contextualUI",(function(){return $P})),n.d(t,"dialog",(function(){return yD})),n.d(t,"messageBar",(function(){return gI})),n.d(t,"statusBar",(function(){return _O})),n.d(t,"renderDatePicker",(function(){return LO})),n.d(t,"hideDatePicker",(function(){return AO})),n.d(t,"renderTableTotalRowOptions",(function(){return vI})),n.d(t,"renderSheetDropdownMenu",(function(){return TI})),n.d(t,"renderTextToColumnsContextualUI",(function(){return WI})),n.d(t,"renderFormulaSuggestionCard",(function(){return JI})),n.d(t,"renderRowNumberingSuggestionCard",(function(){return YI})),n.d(t,"renderX10PlaygroundCard",(function(){return aF})),n.d(t,"renderProactiveSuggestionCard",(function(){return SF})),n.d(t,"renderProactiveSuggestionDebugPane",(function(){return RF})),n.d(t,"renderExcelIntelligenceSuggestionCard",(function(){return uF})),n.d(t,"renderNameBoxStatusCallout",(function(){return VO})),n.d(t,"renderCopySheetStatusCallout",(function(){return JO})),n.d(t,"renderInvalidSheetNameCallout",(function(){return YO.renderInvalidSheetNameCallout})),n.d(t,"showRenameFileCallout",(function(){return eL})),n.d(t,"isRenameCalloutVisible",(function(){return tL})),n.d(t,"ocvFeedbackModal",(function(){return DO})),n.d(t,"liveMeeting",(function(){return bI})),n.d(t,"showCompatShortcutKeyPressedInfoCallout",(function(){return iL})),n.d(t,"showKeyboardShortcutAwarenessCallout",(function(){return cL})),n.d(t,"renderObserverChartAwarenessCallout",(function(){return pL}));var o,r=n(1654);!function(e){e[e.None=0]="None",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.Spinner=4]="Spinner",e[e.Custom=5]="Custom"}(o||(o={}));var i=n(82),a=n(81),s=n(217),l=n(15),c=n.n(l),u=n(12),d=n.n(u),p=n(41),g=n.n(p),h=n(107),m=n.n(h),b=n(105),f=n(453),x=n(21);let E=!1;function S(){E||(Object(r.d)({appColors:Object(b.a)(),appStrings:Object(f.a)(),icons:{closeDark:c.a.CancelGlyph_16,closeLight:c.a.CancelGlyphWhite_16,jumpToTargetDark:c.a.AccessMoveUpSection_16,jumpToTargetLight:c.a.AccessMoveUpSectionWhite_16,checkmark:c.a.Checkmark_16}}),E=!0)}function y(e){if(e)switch(e.icon){case o.Error:return m.a.CancelRequest_16;case o.Warning:return m.a.Risks_16;case o.Info:return m.a.Info_16;case o.Custom:const t=function(e){const t=e.customIconName||e.iconPath;return t&&(C(d.a,t)||C(g.a,t))}(e);if(!t){const t=e.customIconName||e.iconPath,n=t?`Icon ${t} not found in excel icons`:"No value specified for customIconName";i.a.sendTraceTag(523801940,a.a.msoulscat_Wac_Ribbon,s.a.Warning,n)}return t;case o.Spinner:return m.a.MissingIcon_20;case o.None:default:return}}function C(e,t){return e[t]}const v={initializeCalloutNotifications:function(e){S(),Object(r.e)(e)},initializeToastNotifications:function(e){S(),Object(r.f)(e)},isCustomContentSupported:r.g,addNotification:r.a,removeNotification:r.h,updateNotification:r.i,externalNotification:r.c,toast:function(e){const{message:t,icon:n}=e;return{type:"ToastProps",message:t,icon:y(n),styles:{message:{fontSize:"14px",fontWeight:Object(x.isChangeGateEnabled)("OfficeVSO:8720667_ToastFontStylingFix")?600:"bold"}}}},callout:r.b};var R=n(1),k=n(52),T=n(1248),_=n(1185),w=n(2201),D=n(475),P=n(2635),I=n(1556),F=n(5);const B=Object(x.getBooleanFeatureGate)("Microsoft.Office.Excel.EnabledConditionalFormattingEmptyRuleV2",!1);let M=Object(x.getBooleanFeatureGate)("Microsoft.Office.Excel.CFPaneRuleEditorV2",!1);const j=Object(x.getBooleanFeatureGate)("Microsoft.Office.Excel.CFPaneManageRulesV2",!1),O=(e,t)=>({[`#${e}::placeholder`]:{color:t.palette.neutralSecondaryAlt}}),L=(e,t)=>e?{borderColor:t.palette.neutralQuaternaryAlt,borderStyle:"solid",borderRadius:"4px"}:{borderColor:z,borderStyle:"solid",borderRadius:"4px"},A=M?"16px":"17px",N=M?"14px":"17px",W=M?"288px":"287px",z="rgb(184, 0, 0)",H=()=>({marginLeft:A,marginRight:A,right:"0px",left:"0px"}),V=()=>G(!0),U=e=>e?"rgb(96, 94, 92)":z,G=e=>_object_spread({borderColor:U(e),borderStyle:"solid"},M?{borderRadius:"4px"}:{}),q=(e,t)=>{const n={root:{height:"26px"}};return{contentRoot:_object_spread_props(_object_spread({},M?L(e,t):G(e)),{maxWidth:W}),pickingIcon:n,cancelButton:n,applyButton:n}},Q=(e=!0,t=!1)=>({outline:"none !important",borderWidth:(t?"2px":"1px")+" !important",borderColor:U(e)+" !important",borderStyle:"solid",[F.m]:{outline:"highlighttext dashed 2px !important",outlineOffset:"-2px",color:"highlight",borderColor:"highlight !important"}}),K={whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},J=(e,t)=>({root:{height:"65px",marginTop:"12px",width:"262px",padding:"12px 12px 8px 12px",borderRadius:"8px",boxShadow:"0px 1px 3px 0px"+t.palette.neutralLight,cursor:e?"grab":"default",selectors:{":hover":{borderColor:t.palette.neutralTertiaryAlt,borderStyle:"solid",borderRadius:"8px",[F.m]:{borderColor:"Highlight"}},":focus,:focus-within,:focus:after":_object_spread_props(_object_spread({},Q()),{borderRadius:"8px !important"})}}}),Y={alignItems:"center"},Z={float:"right",whiteSpace:"nowrap"},$={display:"flex",height:"28px"},X={alignSelf:"center",height:"14px"},ee={height:"12px",width:"12px",paddingRight:"3px"},te={root:{width:"170px",height:"28px"},field:{color:"#252423",fontSize:"12px",padding:"0px"}},ne={height:"30px",alignSelf:"center",borderRadius:"3px"},oe={width:"100%",overflow:"hidden",textOverflow:"ellipsis",marginTop:"5px"},re={display:"flex",flexDirection:"row",justifyContent:"space-between",width:"100%",height:"32px"},ie={display:"flex",flexDirection:"column",width:"100%"},ae={flexDirection:"row",display:"flex",alignItems:"flex-start",gap:"8px"},se={display:"flex",flexDirection:"column",gap:"4px"};var le=n(807);const ce={shimmerGradient:{animationDirection:"reverse"}};var ue=n(149),de=n(329);class pe{static updateData(e){var t,n,o,r;e.callbacks?(i.a.shipAssertTag(595711942,a.a.msoulscat_ES_EWAJS,null!=e.callbacks.onRuleFilteringOptionsChange,"ConditionalFormattingTaskPaneReact.ConditionalFormattingTaskPane: onRuleFilteringOptionsChange not set"),i.a.shipAssertTag(595357775,a.a.msoulscat_ES_EWAJS,null!=e.callbacks.onRuleDelete,"ConditionalFormattingTaskPaneReact.ConditionalFormattingTaskPane: onRuleDelete not set"),i.a.shipAssertTag(538027297,a.a.msoulscat_ES_EWAJS,null!=e.callbacks.onRuleDuplicate,"ConditionalFormattingTaskPaneReact.ConditionalFormattingTaskPane: onRuleDuplicate not set"),i.a.shipAssertTag(573850571,a.a.msoulscat_ES_EWAJS,null!=e.callbacks.getFormulaErrorType,"ConditionalFormattingTaskPaneReact.ConditionalFormattingTaskPane: getFormulaErrorType not set")):i.a.shipAssertTag(595402902,a.a.msoulscat_ES_EWAJS,!1,"ConditionalFormattingTaskPaneReact.ConditionalFormattingTaskPane: callbacks object is not set"),pe.firstPaneElementId=(null===(t=e.uiElementsIds)||void 0===t?void 0:t.firstPaneElementId)||e.firstPaneElementId||"",pe.ruleManagerId=(null===(n=e.uiElementsIds)||void 0===n?void 0:n.ruleManagerId)||"ConditionalFormattingTaskPaneRuleManagerId",pe.loadingRuleListId=(null===(o=e.uiElementsIds)||void 0===o?void 0:o.loadingRuleListId)||"ConditionalFormattingTaskPaneLoadingRuleListId",pe.ruleListId=(null===(r=e.uiElementsIds)||void 0===r?void 0:r.ruleListId)||"ConditionalFormattingTaskPaneRuleListId",pe.colorPickerButtonController=e.colorPickerButtonController||{},pe.borderMenuController=e.borderMenuController||void 0,pe.onRuleFilteringOptionsChange=e.callbacks.onRuleFilteringOptionsChange||(()=>{}),pe.onRuleHoverStateChange=e.callbacks.onRuleHoverStateChange||(()=>{}),pe.onRuleDelete=e.callbacks.onRuleDelete||(()=>{}),pe.onRuleDuplicate=e.callbacks.onRuleDuplicate||(()=>{}),pe.setFocusOnToolbarFirstElement=e.callbacks.setFocusOnToolbarFirstElement||(()=>{}),pe.onTaskPaneViewChange=e.callbacks.changeTaskPaneView||(()=>{}),pe.onDeleteRulesByFilter=e.callbacks.onDeleteRulesByFilter||(()=>{}),pe.onRuleAdded=e.callbacks.onRuleAdded||(()=>{}),pe.onRuleEdited=e.callbacks.onRuleEdited||(()=>{}),pe.addNewRuleFromTaskPane=e.callbacks.addNewRuleFromTaskPane||(()=>{}),pe.onEmptyPaneHelpLinkClick=e.callbacks.onEmptyPaneHelpLinkClick||(()=>{}),pe.getFormulaErrorType=e.callbacks.getFormulaErrorType||(()=>1),pe.getRangeError=e.callbacks.getRangeError||(()=>2),pe.rangePickerController=e.rangePickerController||{startPicker:()=>{},stopPicker:()=>{},disposeRangePicker:()=>{},getGridDomElementId:()=>"",getSheetName:()=>""}}static setFocusOnPaneFirstElement(){if(pe.firstPaneElementId){const e=document.getElementById(pe.firstPaneElementId);e&&e.focus()}}static getRequiredFirstPaneElementId(){return pe.firstPaneElementId}static getRequiredRuleManagerId(){return pe.ruleManagerId}static getRequiredLoadingRuleListId(){return pe.loadingRuleListId}static getRequiredRuleListId(){return pe.ruleListId}static isRuleReorderWithDnDSupported(){return!Object(de.e)()}static getColorPickerButtonController(){return pe.colorPickerButtonController}static getBorderMenuController(){return pe.borderMenuController}}class ge extends R.Component{render(){if(this.props.isPlaceholder){let e=_object_spread({},te);return Object(ue.a)()&&(e=_object_spread_props(_object_spread({},e),{rtlShimmerStyles:ce})),R.createElement(le.a,{style:{marginTop:"7px"},styles:e})}return i.a.shipAssertTag(595357774,a.a.msoulscat_ES_EWAJS,null!=this.props.ruleName&&""!==this.props.ruleName,"ConditionalFormattingTaskPaneReact.RulePreview.Render: rule name is empty."),R.createElement(I.a,{"data-testid":"rule-name",value:this.props.ruleName,styles:te,borderless:!0,readOnly:!0,tabIndex:-1,"data-is-focusable":!1,ariaLabel:this.props.ruleName,style:{cursor:pe.isRuleReorderWithDnDSupported()?"grab":"default"}})}constructor(e){super(e)}}var he,me=n(23),be=n.n(me),fe=n(187),xe=n(62),Ee=n(1628),Se=n(94);function ye(e){return"CondFmtEditRuleIconId-"+e}function Ce(e){return"CondFmtDeleteRuleIconId-"+e}function ve(e){return"CondFmtDuplicateRuleIconId-"+e}!function(e){e[e.Edit=0]="Edit",e[e.Duplicate=1]="Duplicate",e[e.Delete=2]="Delete"}(he||(he={}));class Re extends R.Component{render(){return this.props.showCommands?R.createElement("div",null,R.createElement(Ee.a,{content:this.props.enableEdit?ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingRuleEdit):ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingEditingRuleNotSupportedTooltipContent),directionalHint:Se.a.bottomCenter},R.createElement(fe.a,{id:ye(this.props.ruleId),role:"button",iconName:be.a.EditGeneric_24,styles:this.getCommandIconStyle(this.props.enableEdit),onClick:this.props.enableEdit?this.props.editRule:void 0,"data-is-focusable":!0,tabIndex:-1,onKeyDown:this.editRuleOnKeyDown,"aria-label":this.props.enableEdit?ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingRuleEdit):void 0})),this.getDuplicateRuleButton(),R.createElement(Ee.a,{content:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingRuleDelete),directionalHint:Se.a.bottomCenter},R.createElement(fe.a,{"data-testid":"deleteRuleIcon",id:Ce(this.props.ruleId),role:"button",iconName:be.a.TrashCan_16,styles:this.getCommandIconStyle(),onClick:this.props.onRuleDelete,"data-is-focusable":!0,tabIndex:-1,onKeyDown:this.deleteRuleOnKeyDown,"aria-label":ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingRuleDelete)}))):R.createElement("div",null)}getDuplicateRuleButton(){return R.createElement(Ee.a,{content:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingRuleDuplicate),directionalHint:Se.a.bottomCenter},R.createElement(fe.a,{id:ve(this.props.ruleId),role:"button",iconName:be.a.Duplicate_24,styles:this.getCommandIconStyle(),onClick:this.props.onRuleDuplicate,"data-is-focusable":!0,tabIndex:-1,onKeyDown:this.duplicateRuleOnKeyDown,"aria-label":ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingRuleDuplicate)}))}editRuleOnKeyDown(e){this.ruleCommandOnKeyDown(e,he.Edit)}deleteRuleOnKeyDown(e){this.ruleCommandOnKeyDown(e,he.Delete)}duplicateRuleOnKeyDown(e){this.ruleCommandOnKeyDown(e,he.Duplicate)}ruleCommandOnKeyDown(e,t){let n=null;switch(e.keyCode){case xe.a.tab:n=this.getNextOrPreviousFocusElementFromCommand(e,t);break;case xe.a.escape:n=document.getElementById(this.props.ruleId);break;case xe.a.enter:switch(t){case he.Edit:this.props.editRule(),e.preventDefault();break;case he.Duplicate:this.props.onRuleDuplicate(),e.stopPropagation();break;case he.Delete:this.props.onRuleDelete(),e.stopPropagation()}}n&&(e.stopPropagation(),e.preventDefault(),n.focus())}getNextOrPreviousFocusElementFromCommand(e,t){let n=null;switch(t){case he.Edit:if(e.shiftKey){n=document.getElementById(this.props.ruleRangeId);break}n=document.getElementById(ve(this.props.ruleId));break;case he.Delete:if(!e.shiftKey){n=document.getElementById(this.props.ruleRangeId);break}n=document.getElementById(ve(this.props.ruleId));break;case he.Duplicate:if(e.shiftKey){if(this.props.enableEdit){n=document.getElementById(ye(this.props.ruleId));break}n=document.getElementById(this.props.ruleRangeId);break}n=document.getElementById(Ce(this.props.ruleId))}return n}getCommandIconStyle(e=!0){return{root:{height:"16px",width:"16px",marginTop:"2px",marginLeft:"1px",padding:"3px",opacity:e?void 0:"0.3",pointerEvents:e?void 0:"none",cursor:e?"pointer":"default",selectors:{":hover":{background:"#E1DFDD",[F.m]:e?Q():{color:"GrayText"}},":focus":Q(),":focus:after":{border:"none",outline:"none"},":active":{border:"none",outline:"none"}}}}}constructor(e){super(e),this.editRuleOnKeyDown=this.editRuleOnKeyDown.bind(this),this.duplicateRuleOnKeyDown=this.duplicateRuleOnKeyDown.bind(this),this.deleteRuleOnKeyDown=this.deleteRuleOnKeyDown.bind(this)}}var ke=n(1306);const Te=e=>e+"-ErrorTooltip";class _e extends R.Component{render(){return R.createElement(Ee.a,{id:Te(this.props.childComponentId),content:this.getErrorMessage(),tooltipProps:this.tooltipStyle,setAriaDescribedBy:!1,role:"alert"},this.props.children)}constructor(){super(...arguments),this.tooltipStyle={calloutProps:{backgroundColor:z,styles:{beakCurtain:{backgroundColor:z}}},styles:{content:{color:"white"}}},this.getErrorMessage=()=>this.props.errorMessage||void 0}}var we=n(235);class De extends R.Component{render(){return M?R.createElement(we.a,null,e=>R.createElement("div",null,R.createElement("div",{role:"alert","aria-label":this.props.error}),R.createElement(_e,{errorMessage:this.props.error,childComponentId:this.props.id},R.createElement(ke.a,_object_spread_props(_object_spread({},this.getRangePickerProps(e)),{disableApplyChanges:!!this.props.error&&this.props.disableApplyingChangesOnError}))))):R.createElement("div",null,R.createElement("div",{role:"alert","aria-label":this.props.error}),R.createElement(_e,{errorMessage:this.props.error,childComponentId:this.props.id},R.createElement(ke.a,_object_spread_props(_object_spread({},this.getRangePickerProps()),{disableApplyChanges:!!this.props.error&&this.props.disableApplyingChangesOnError}))))}updatePlaceholderStyles(e,t){void 0!==e.styles?e.styles.contentRoot=Object(F.I)(O(e.id,t),e.styles.contentRoot):e.styles={contentRoot:O(e.id,t)}}constructor(e){super(e),this.getRangePickerProps=e=>{const t=_object_spread({rangePickerController:pe.rangePickerController},this.props);return M&&e&&this.updatePlaceholderStyles(t,e),void 0!==t.editingStyles?t.editingStyles.contentRoot=Object(F.I)(this.getPickingStyle(e),t.editingStyles.contentRoot):t.editingStyles={contentRoot:this.getPickingStyle(e)},t},this.getPickingStyle=e=>M&&e?((e=!0,t,n)=>_object_spread_props(_object_spread({outline:"none !important",borderWidth:"1px !important",borderColor:U(e)+" !important",borderStyle:"solid",borderRadius:"4px"},O(t,n)),{[F.m]:{outline:"highlighttext dashed 2px !important",outlineOffset:"-2px",color:"highlight",borderColor:"highlight !important"}}))(!this.props.error,this.props.id,e):Q(!this.props.error,!0)}}class Pe{get rangeString(){return this.data.rangeString}set rangeString(e){this.data.rangeString=e,this.wasModified=!0}get sheetName(){return this.data.sheetName}set sheetName(e){this.data.sheetName=e,this.wasModified=!0}get activeCell(){return this.data.activeCell}set activeCell(e){this.data.activeCell=e,this.wasModified=!0}update(e){"rangeString"in e&&(this.rangeString=e.rangeString),"sheetName"in e&&(this.sheetName=e.sheetName),"activeCell"in e&&(this.activeCell=e.activeCell)}get initialData(){return _object_spread({},this.originalData)}isDirty(){return this.wasModified}getErrorType(e,t){const n=pe.getRangeError(this.rangeString,this.sheetName);return 0!==n?n:this.rangeString&&this.rangeString.length>1e3?3:e||null==this.sheetName||this.sheetName===this.originalData.sheetName?this.sheetName&&t.length>0&&t.indexOf(this.sheetName)>=0?5:0:4}getErrorMessage(e,t){switch(this.getErrorType(e,t)){case 1:case 2:return ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingInvalidRangeError);case 3:return ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingValueTooLongError).replace("{0}",1e3.toString());case 4:return ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingChangeRangeSheetNameError);case 5:return ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingSheetDeletedError);case 6:return ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingProtecedSheetRangePickerErrorMessage);default:return null}}isValid(e,t){return 0===this.getErrorType(e,t)}onSheetRename(e){var t,n;this.sheetName===e.oldSheetName&&(this.sheetName=null!==(t=e.newSheetName)&&void 0!==t?t:this.sheetName),this.initialData.sheetName===e.oldSheetName&&(this.originalData.sheetName=null!==(n=e.newSheetName)&&void 0!==n?n:this.originalData.sheetName)}constructor(e){this.wasModified=!1,this.data=e,this.originalData=_object_spread({},e)}}function Ie(e){return"ConditionalFormattingRuleRange."+e}class Fe extends R.Component{render(){var e;if(this.props.isPlaceholder){let e=_object_spread({},te);return Object(ue.a)()&&(e=_object_spread_props(_object_spread({},e),{rtlShimmerStyles:ce})),R.createElement(le.a,{style:{marginTop:"7px"},styles:e})}i.a.shipAssertTag(595357773,a.a.msoulscat_ES_EWAJS,null!=this.props.range&&""!==this.props.range,"ConditionalFormattingTaskPaneReact.RulePreview.Render: rule range is empty.");const t=null===(e=this.state.rangeData)||void 0===e?void 0:e.getErrorMessage(!1,[]);return R.createElement("div",{onMouseEnter:this.mouseOver,onMouseLeave:this.mouseOut},R.createElement(De,{id:Ie(this.props.ruleId),value:this.props.range,sheetName:this.props.sheetName||void 0,onStartPicking:this.onStartPicking,onCancelChanges:this.onCancelChanges,onApplyChanges:this.onApplyChanges,onChange:this.onChange,supportOnlyRanges:!0,useAbsoluteRef:!1,blockSwitchingSheets:!0,error:t||void 0,disableApplyingChangesOnError:!0,styles:{contentRoot:{width:"180px",border:this.state.hovering||this.state.picking?void 0:"none"},textField:{field:{padding:"2px"}},pickingIcon:this.state.hovering||this.state.picking?{}:{root:{visibility:"hidden"}}},editingStyles:{contentRoot:{width:"100%"},textField:{field:{padding:"2px"}}}}))}constructor(e){super(e),this.mouseOver=()=>{this.setState({hovering:!0})},this.mouseOut=()=>{this.setState({hovering:!1})},this.onStartPicking=()=>{this.setState({picking:!0,rangeData:new Pe({rangeString:this.props.range,sheetName:this.props.sheetName||void 0})})},this.onChange=(e,t)=>{var n;this.state.rangeData.update({rangeString:e||"",sheetName:t||void 0}),this.setState({rangeData:this.state.rangeData}),this.props.updatePickerState(!0,!(null===(n=this.state.rangeData)||void 0===n||!n.getErrorMessage(!1,[])),e,t)},this.onStopPicking=(e,t)=>{this.setState({rangeData:void 0,picking:!1,hovering:!1}),this.props.updatePickerState(!1,!1,e,t)},this.onApplyChanges=(e,t)=>{this.onStopPicking(e,t)},this.onCancelChanges=(e,t)=>{this.onStopPicking(e,t)},this.state={hovering:!1,picking:!1}}}var Be,Me,je=n(852);function Oe(e,t,n,o){if(t.length<=e||n.length<=e||0===t[e])return"none";let r=o+"px";switch(t[e]){case 3:case 9:case 11:r+=" dashed";break;case 7:case 4:r+=" dotted";break;default:r+=" solid"}return n[e]?r+=" "+n[e]:(r+=" ",r+="#000000"),r}function Le(e){let t="";return(e.isTextUnderlined||e.isTextDoubleUnderlined)&&(t="underline "),e.isTextStrikethrough&&(t+="line-through"),t||"none"}function Ae(e){return e.isTextUnderlined||e.isTextDoubleUnderlined?"underline":"none"}!function(e){e[e.Top=0]="Top",e[e.Bottom=1]="Bottom",e[e.Left=2]="Left",e[e.Right=3]="Right"}(Be||(Be={})),function(e){e[e.Bottom=1]="Bottom",e[e.Top=2]="Top",e[e.Left=4]="Left",e[e.Right=8]="Right",e[e.AllBorders=15]="AllBorders"}(Me||(Me={}));const Ne=new Map;function We(){return{position:Me.AllBorders,lineStyle:[0,0,0,0],color:["#000000","#000000","#000000","#000000"],themeColor:[null,null,null,null]}}Ne.set(0,"to right"),Ne.set(180,"to left"),Ne.set(90,"to bottom"),Ne.set(270,"to top"),Ne.set(45,"to right bottom"),Ne.set(225,"to left top"),Ne.set(135,"to left bottom"),Ne.set(315,"to right top");const ze={height:"13px",width:"13px"},He=Object(x.isChangeGateEnabled)("OfficeVSO:8828451_FixTextDecorForStrikethrough");class Ve extends R.Component{render(){if(this.props.rule.isPlaceholder)return R.createElement(le.a,{style:_object_spread({},this.rulePreviewStyle,this.props.style),styles:Object(ue.a)()?ce:void 0});switch(this.props.rule.ruleType){case 3:return this.renderCustomFormatPreview();case 0:return this.renderColorScalePreview();case 1:return this.renderDataBarPreview();case 2:return this.renderIconSetPreview();default:return i.a.shipAssertTag(595702673,a.a.msoulscat_ES_EWAJS,!1,"ConditionalFormattingTaskPaneReact.RulePreview.Render: unexpected rule type received."),R.createElement("div",{style:_object_spread({},this.rulePreviewStyle,this.props.style)})}}renderCustomFormatPreview(){let e={};var t;He&&(e={textDecorationLine:(t=this.props.rule.customFormat,t.isTextStrikethrough?"line-through":"none"),textDecorationStyle:"solid"});const n=j&&this.props.isManageRulesCard?ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingCustomStylePreviewSampleTextSmall):ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingCustomStylePreviewSampleText),o=_object_spread({},this.rulePreviewStyle,this.getCustomFormatStyleExceptStrikethrough(),this.props.style),r=j&&this.props.isManageRulesCard?_object_spread_props(_object_spread({},o),{fontSize:"18px",textAlign:"center"}):o;return R.createElement("div",{style:r,"aria-hidden":"true"},He?R.createElement("div",{style:e}," ",n):n)}renderColorScalePreview(){const e=this.props.rule.colorScaleFormat;i.a.shipAssertTag(595706326,a.a.msoulscat_ES_EWAJS,null!=e,"ConditionalFormattingTaskPaneReact.RulePreview.renderColorScalePreview: colorScaleFormat not set"),i.a.shipAssertTag(595706327,a.a.msoulscat_ES_EWAJS,null!=e.minimumColor&&""!==e.minimumColor&&null!=e.maximumColor&&""!==e.maximumColor,"ConditionalFormattingTaskPaneReact.RulePreview.renderColorScalePreview: colorScaleFormat values not set correctly");let t={};return t=e.midpointColor?{background:"linear-gradient(to right, "+e.minimumColor+", "+e.midpointColor+", "+e.maximumColor+")"}:{background:"linear-gradient(to right, "+e.minimumColor+", "+e.maximumColor+")"},R.createElement("div",{style:_object_spread({},this.rulePreviewStyle,t,this.props.style)})}renderIconSetPreview(){const e=this.props.rule.iconSetFormat;return i.a.shipAssertTag(595706328,a.a.msoulscat_ES_EWAJS,null!=e,"ConditionalFormattingTaskPaneReact.RulePreview.renderIconSetPreview: IconSetFormat not set"),i.a.shipAssertTag(595706329,a.a.msoulscat_ES_EWAJS,null!=e.icons,"ConditionalFormattingTaskPaneReact.RulePreview.renderIconSetPreview: ruleIconSetFormat values not set correctly"),R.createElement("div",{style:_object_spread(_object_spread_props(_object_spread({},this.rulePreviewStyle),{display:"flex",border:"none",flexBasis:"100%",justifyContent:"space-between",direction:"ltr"}),this.props.style)},je.a.getIconNamesArray(e.icons,e.isReverseIconsOrder).map((e,t)=>R.createElement(fe.a,{iconName:e,key:t,style:M&&this.props.iconStyle?this.props.iconStyle:ze})))}renderDataBarPreview(){const e=this.props.rule.dataBarFormat;i.a.shipAssertTag(595706330,a.a.msoulscat_ES_EWAJS,null!=e,"ConditionalFormattingTaskPaneReact.RulePreview.renderDataBarPreview: dataBarFormat not set"),i.a.shipAssertTag(595706331,a.a.msoulscat_ES_EWAJS,null!=e.fillColor&&""!==e.fillColor,"ConditionalFormattingTaskPaneReact.RulePreview.renderDataBarPreview: dataBarFormat values not set correctly");const t=j?{width:"80%",height:"100%"}:{width:"80%"};let n={};n=e.isGradientFill?{backgroundImage:"linear-gradient(to "+(e.isLTRDirection?"right":"left")+", "+e.fillColor+" , white)"}:{backgroundColor:e.fillColor};let o={};return e.borderColor&&(o={border:"0.7px solid "+e.borderColor}),R.createElement("div",{style:_object_spread(_object_spread_props(_object_spread({},this.rulePreviewStyle),{display:"flex",padding:"0.5px",flexDirection:e.isLTRDirection?"row":"row-reverse",direction:"ltr"}),this.props.style)},R.createElement("div",{style:_object_spread({},n,t,o)}))}getCustomFormatStyleExceptStrikethrough(){var e;if(!this.props.rule.customFormat)return i.a.shipAssertTag(595706332,a.a.msoulscat_ES_EWAJS,!1,"ConditionalFormattingTaskPaneReact.RulePreview.getCustomFormatStyle: ruleCustomFormat not set"),{};const t=this.props.rule.customFormat;let n={};var o;return t.borderFormat&&t.borderFormat.color&&t.borderFormat.lineStyle&&(o=t.borderFormat.lineStyle).length>=4&&(0!==o[Be.Top]||0!==o[Be.Bottom]||0!==o[Be.Left]||0!==o[Be.Right])&&(n=_object_spread_props(_object_spread({border:null},M?{borderColor:null,borderWidth:null}:{}),{borderTop:Oe(Be.Top,t.borderFormat.lineStyle,t.borderFormat.color,this.previewBorderWidth),borderBottom:Oe(Be.Bottom,t.borderFormat.lineStyle,t.borderFormat.color,this.previewBorderWidth),borderRight:Oe(Be.Right,t.borderFormat.lineStyle,t.borderFormat.color,this.previewBorderWidth),borderLeft:Oe(Be.Left,t.borderFormat.lineStyle,t.borderFormat.color,this.previewBorderWidth)})),_object_spread(_object_spread_props(_object_spread({},null!==(e=function(e){if(!e||!e.gradientStops)return null;if(e.isLinearGradient){const n=e.gradientStops.join(",");return{background:"linear-gradient("+(t=e.degree,(Ne.get(t)||"")+", ")+n+")"}}var t,n,o,r;return e.radialGradientPosition&&2===e.gradientStops.length?e.radialGradientPosition.isCenter?{background:"radial-gradient("+e.gradientStops[0]+", "+e.gradientStops[1]+" 70%)"}:{background:(n=e.radialGradientPosition,o=e.gradientStops[0]||"",r=e.gradientStops[1]||"","radial-gradient(farthest-side, "+o+" , "+r+(n.isBottom?") top ":") bottom ")+(n.isRight?"left":"right")+"/200% 200%")}:null}(t.gradientFill))&&void 0!==e?e:{backgroundColor:t.backgroundColor||"#FFFFFF"}),{textAlign:"center",fontWeight:t.isTextBold?"bold":"normal",fontStyle:t.isTextItalic?"italic":"normal",color:t.textColor||"#000000",textDecorationLine:He?Ae(t):Le(t),textDecorationStyle:t.isTextDoubleUnderlined?"double":"solid",fontSize:"12px"}),n)}constructor(e){super(e),this.previewBorderWidth=1,this.baseRulePreviewStyle={width:"72px",height:"16px",border:this.previewBorderWidth+"px solid #d2d0ce",borderRadius:"1px"},this.rulePreviewStyle=j&&this.props.isManageRulesCard?_object_spread_props(_object_spread({},this.baseRulePreviewStyle),{borderRadius:"3px",width:"46px",height:"30px"}):this.baseRulePreviewStyle}}var Ue=n(661);function Ge(e){const t=document.getElementById(Ks);null!=t&&t.firstChild&&t.removeChild(t.firstChild);const n=document.createElement("div");n.setAttribute("role","status"),n.setAttribute("aria-label",e),n.setAttribute("aria-live","assertive"),null==t||t.appendChild(n)}class qe extends R.Component{render(){return R.createElement(Ee.a,{content:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingDeleteAllRulesTooltip),directionalHint:Se.a.bottomCenter},R.createElement(Ue.a,{"data-testid":"DeleteAllRules",id:"CondFmtDeleteAllRulesButton","aria-label":ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingDeleteAllRulesTooltip),disabled:this.props.isDisabled,styles:mn(),iconProps:{iconName:be.a.TrashCan_16,style:{width:"16px",height:"16px"}},onClick:this.onDeleteAllRulesSelected}))}onDeleteAllRulesSelected(e){pe.onDeleteRulesByFilter(),Ge(ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingAllRulesDeleted)),this.props.onDeleteAllRules()}constructor(e){super(e),this.onDeleteAllRulesSelected=this.onDeleteAllRulesSelected.bind(this)}}var Qe=n(416);class Ke{getRuleInputData(){return this.ruleInputData}setRuleInputData(e){this.ruleInputData=e}getGuid(){return this.guid}setGuid(e){this.guid=e}getRange(){return this.range}updateRange(e){null==this.range?this.range=new Pe(_object_spread({},e)):this.range.update(e)}getStopIfTrue(){return this.stopIfTrue}setStopIfTrue(e){this.stopIfTrue=e}getFormatInputData(){return this.ruleFormat}setFormatInputData(e){this.ruleFormat=e}isNewRule(){return null===this.getGuid()||void 0===this.getGuid()}canFocusOnRuleInput(){return this.getRuleInputData().canFocusOnRuleInput()}getDataBarFormat(){return this.dataBarFormat}getColorScaleFormat(){return this.colorScaleFormat}getIconSetFormat(){return this.iconSetFormat}constructor(e,t=null,n,o=!1,r,i=null,a=null,s=null){this.ruleInputData=e,this.stopIfTrue=o,this.guid=t,this.range=new Pe(_object_spread({},n)),this.ruleFormat=r,this.dataBarFormat=i,this.colorScaleFormat=a,this.iconSetFormat=s}}var Je=n(2433);const Ye=e=>({isTextBold:!1,isTextItalic:!1,isTextStrikethrough:!1,isTextUnderlined:!1,isTextDoubleUnderlined:!1,backgroundColor:e.backgroundColor?e.backgroundColor:null,textColor:e.textColor?e.textColor:null,borderFormat:e.borderColor?{position:Me.AllBorders,lineStyle:[1,1,1,1],color:[e.borderColor,e.borderColor,e.borderColor,e.borderColor],thickness:[1,1,1,1]}:{position:Me.AllBorders,lineStyle:[0,0,0,0],color:["#000000","#000000","#000000","#000000"],thickness:[0,0,0,0]}}),Ze={0:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingQuickFormatRedFillRedText),1:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingQuickFormatYellowFillYellowText),2:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingQuickFormatGreenFillGreenText),3:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingQuickFormatRedFill),4:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingQuickFormatRedText),5:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingQuickFormatRedBorder),6:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingCustomFormatText),[-1]:""},$e=[{key:0,ruleStyles:{textColor:"#9C0006",backgroundColor:"#FFC7CE"}},{key:1,ruleStyles:{textColor:"#9C5700",backgroundColor:"#FFEB9C"}},{key:2,ruleStyles:{textColor:"#006100",backgroundColor:"#C6EFCE"}},{key:3,ruleStyles:{backgroundColor:"#FFC7CE"}},{key:4,ruleStyles:{textColor:"#9C0006"}},{key:5,ruleStyles:{borderColor:"#9C0006"}}],Xe=$e.map(e=>_object_spread_props(_object_spread({},e),{customFormat:Ye(e.ruleStyles),text:Ze[e.key]})),et=[{key:0,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingQuickFormatRedFillRedText),customFormat:Ye({textColor:"#9C0006",backgroundColor:"#FFC7CE"})},{key:1,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingQuickFormatYellowFillYellowText),customFormat:Ye({textColor:"#9C5700",backgroundColor:"#FFEB9C"})},{key:2,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingQuickFormatGreenFillGreenText),customFormat:Ye({textColor:"#006100",backgroundColor:"#C6EFCE"})},{key:3,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingQuickFormatRedFill),customFormat:Ye({backgroundColor:"#FFC7CE"})},{key:4,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingQuickFormatRedText),customFormat:Ye({textColor:"#9C0006"})},{key:5,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingQuickFormatRedBorder),customFormat:Ye({borderColor:"#9C0006"})}],tt=Object(Je.a)(e=>{const t=M?Xe:et;for(let n=0;n<t.length;n+=1)if(nt(e,t[n].customFormat))return n;return-1});function nt(e,t){if(e&&t){if(e.backgroundColor!==t.backgroundColor||e.textColor!==t.textColor||e.isTextBold!==t.isTextBold||e.isTextItalic!==t.isTextItalic||e.isTextStrikethrough!==t.isTextStrikethrough||e.isTextUnderlined!==t.isTextUnderlined||e.isTextDoubleUnderlined!==t.isTextDoubleUnderlined)return!1;if(e.borderFormat&&t.borderFormat){if(e.borderFormat.lineStyle&&t.borderFormat.lineStyle)for(let n=0;n<e.borderFormat.lineStyle.length;n+=1)if(e.borderFormat.lineStyle[n]!==t.borderFormat.lineStyle[n])return!1;if(e.borderFormat.color&&t.borderFormat.color)for(let r=0;r<e.borderFormat.color.length;r+=1){var n,o;if((null===(n=e.borderFormat.color[r])||void 0===n?void 0:n.toLowerCase())!==(null===(o=t.borderFormat.color[r])||void 0===o?void 0:o.toLowerCase()))return!1}if(e.borderFormat.thickness&&t.borderFormat.thickness)for(let n=0;n<e.borderFormat.thickness.length;n+=1)if(e.borderFormat.thickness[n]!==t.borderFormat.thickness[n])return!1}else if(e.borderFormat&&!t.borderFormat||!e.borderFormat&&t.borderFormat)return!1;if(e.gradientFill)return!1}return!0}var ot=n(581);class rt{getUniqueId(){return this.uniqueId}getQuickFormat(){return this.quickFormat}setQuickFormat(e){this.quickFormat=e}getCustomFormat(){return this.customFormat}getSelectedFormat(){return this.isQuickFormat()?M?Xe[this.quickFormat].customFormat:et[this.quickFormat].customFormat:this.customFormat}setCustomFormat(e){this.customFormat=e,this.isQuickFormat()&&(this.customFormat.preserveBackgroundColor=!1,this.customFormat.preserveTextColor=!1),this.quickFormat=6,this.hasCustomFormatChanges=!0}hasChanges(){return this.isQuickFormat()||this.hasCustomFormatChanges}hasCustomFormat(){return null!=this.customFormat}isQuickFormat(){return-1!==this.quickFormat&&6!==this.quickFormat}constructor(e,t,n){this.quickFormat=e,this.customFormat=t,this.hasCustomFormatChanges=!1,this.uniqueId=null!=n?n:ot()}}function it(e,t,n=null){var o,r,s;let l=null;const c={rangeString:null!==(o=t.range)&&void 0!==o?o:void 0,sheetName:null!==(r=t.ruleRangeSheetName)&&void 0!==r?r:void 0,activeCell:null!==(s=t.activeCell)&&void 0!==s?s:void 0};if(t.addRuleType){const o=function(e){const t=at.get(e);if(t)return t;throw new Error("Unsupported ruleType")}(t.addRuleType);if(l=e.createRuleInputData(o),n&&n.isNewRule()&&n.getRuleInputData()){const e=n.getRuleInputData().getRuleInputValue();return l.getInputType()===n.getRuleInputData().getInputType()&&e&&l.setRuleInputValue(e),new Ke(l,t.guid,c,n.getStopIfTrue(),n.getFormatInputData())}}else t.guid&&(t.options&&t.options.command?l=e.createRuleInputData(t.options.command,t.options,t.dataBarFormat):(t.dataBarFormat||t.colorScaleFormat||t.iconSetFormat)&&(l=e.createRuleInputData(0,t.options,t.dataBarFormat,t.colorScaleFormat,t.iconSetFormat)));l||(i.a.shipAssertTag(573687755,a.a.msoulscat_ES_EWAJS,!1,"ConditionalFormattingHelper.createRuleData: RuleInputData is null"),l=e.createDefaultRuleInputDataByRuleTypeOption(null));const u=new rt(t.customFormat?6:0,t.customFormat||null,t.guid);return new Ke(l,t.guid,c,!!t.stopIfTrue&&t.stopIfTrue,u,t.dataBarFormat||null,t.colorScaleFormat||null,t.iconSetFormat||null)}const at=new Map;function st(e){return{guid:e.ruleId,ruleRangeSheetName:e.ruleRangeSheetName,options:{command:0,quickFormat:-1},stopIfTrue:e.stopIfTrue,priority:-1,newJSApiPriority:-1}}function lt(e){const t=e.customFormat||null;return t&&(t.preserveBackgroundColor=!0,t.preserveTextColor=!0,t.borderFormat||(t.borderFormat=We()),t.borderFormat.position=0),{guid:e.ruleId,addRuleType:null,range:e.ruleRange,ruleRangeSheetName:e.ruleRangeSheetName,options:e.editOptions,stopIfTrue:e.stopIfTrue,customFormat:t,dataBarFormat:e.dataBarFormat||null,colorScaleFormat:e.colorScaleFormat||null,iconSetFormat:e.iconSetFormat||null,newJSApiPriority:-1}}at.set("HighlightCellsGT",1),at.set("HighlightCellsLT",2),at.set("HighlightCellsBetween",3),at.set("HighlightCellsEQ",4),at.set("HighlightCellsContains",5),at.set("HighlightCellsDate",6),at.set("HighlightCellsDupe",7),at.set("HighlightCellsNoBlanks",65),at.set("TopBottomTop10",8),at.set("TopBottomBot10",10),at.set("TopBottomTop10P",9),at.set("TopBottomBot10P",11),at.set("TopBottomAA",12),at.set("TopBottomBA",13);var ct=n(2613),ut=n(136),dt=n(70),pt=n(60);const gt=Object(ut.a)({root:{display:"flex",flexDirection:"row",alignItems:"center",columnGap:"4px"},label:{fontSize:"12px",fontWeight:dt.a.fontWeightSemibold,lineHeight:"16px"},labelWrapper:_object_spread_props(_object_spread({},pt.a.padding("2px","0px","4px","0px"),pt.a.flex("none")),{alignItems:"center",justifyContent:"center",display:"flex",height:"22px"}),shimmerStyles:_object_spread({},(()=>{let e=_object_spread_props(_object_spread({},te),{marginTop:"7px"});return Object(ue.a)()&&(e=_object_spread_props(_object_spread({},e),{rtlShimmerStyles:ce})),e})())}),ht=e=>({contentRoot:{border:e.hovering||e.picking?void 0:"none",borderRadius:"4px"},textField:{field:{padding:"2px"}},pickingIcon:e.hovering||e.picking?{}:{root:{visibility:"hidden"}}}),mt={contentRoot:{width:"100%"},textField:{field:{padding:"2px"}}},bt={width:"100%"};var ft=n(218),xt=n(361);const Et=R.createContext(void 0),St={},yt=Et.Provider;var Ct=n(16),vt=n(269),Rt=n(56);const kt=R.forwardRef((e,t)=>{const n=((e,t)=>{const{animation:n,appearance:o}=null!==(r=R.useContext(Et))&&void 0!==r?r:St;var r;const{animation:i=(null!=n?n:"wave"),appearance:a=(null!=o?o:"opaque")}=e;return{animation:i,appearance:a,components:{root:"div"},root:ft.a.always(Object(xt.a)("div",_object_spread({ref:t,role:"progressbar","aria-busy":!0,"aria-label":"Loading Content"},e)),{elementType:"div"})}})(e,t),o=(e=>{const{animation:t,appearance:n}=e;return{skeletonGroup:R.useMemo(()=>({animation:t,appearance:n}),[t,n])}})(n);return(e=>{e.root.className=Object(Rt.a)("fui-Skeleton",e.root.className)})(n),((e,t)=>(Object(vt.a)(e),Object(Ct.a)(yt,{value:t.skeletonGroup,children:Object(Ct.a)(e.root,{})})))(n,o)});function Tt(e){return"ConditionalFormattingRuleRange."+e}kt.displayName="Skeleton";const _t=e=>{var t;const n=gt(),[o,r]=R.useState({hovering:!1,picking:!1}),s=null===(t=o.rangeData)||void 0===t?void 0:t.getErrorMessage(!1,[]),l=(t,n)=>{r({rangeData:void 0,picking:!1,hovering:!1}),e.updatePickerState(!1,!1,t,n)};return e.isPlaceholder?R.createElement(kt,{className:n.shimmerStyles}):(i.a.shipAssertTag(506795024,a.a.msoulscat_ES_EWAJS,null!=e.range&&""!==e.range,"ConditionalFormattingTaskPaneReact.RuleManagerRangePicker.Render: rule range is empty."),R.createElement("div",{className:n.root},R.createElement(ct.a,{forId:Tt(e.ruleId),id:"ConditionalFormattingRuleRangeLabel",type:"AppLabelProps",label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingApplyTo),className:n.label,labelWrapperClassName:n.labelWrapper}),R.createElement("div",{onMouseEnter:()=>{r(_object_spread_props(_object_spread({},o),{hovering:!0}))},onMouseLeave:()=>{r(_object_spread_props(_object_spread({},o),{hovering:!1}))},style:bt},R.createElement(De,{id:Tt(e.ruleId),value:e.range,sheetName:e.sheetName||void 0,onStartPicking:()=>{r(_object_spread_props(_object_spread({},o),{picking:!0,rangeData:new Pe({rangeString:e.range,sheetName:e.sheetName||void 0})}))},onCancelChanges:(e,t)=>{l(e,t)},onApplyChanges:(e,t)=>{l(e,t)},onChange:(t,n)=>{var i;const a=Object.create(Object.getPrototypeOf(o.rangeData));a.update({rangeString:t||"",sheetName:n||void 0}),r(_object_spread_props(_object_spread({},o),{rangeData:a})),e.updatePickerState(!0,!(null===(i=o.rangeData)||void 0===i||!i.getErrorMessage(!1,[])),t,n)},supportOnlyRanges:!0,useAbsoluteRef:!1,blockSwitchingSheets:!0,error:s||void 0,disableApplyingChangesOnError:!0,styles:ht(o),editingStyles:mt}))))};var wt=n(3099);const Dt=e=>"CondFmtRule"+e;class Pt extends R.Component{static getDerivedStateFromError(){return{hasError:!0,ownUpdate:!0}}static getDerivedStateFromProps(e,t){return t.ownUpdate?{ownUpdate:!1}:{hasError:!1}}componentDidCatch(e,t){i.a.sendTraceTag(595706333,a.a.msoulscat_ES_EWAJS,s.a.Error,`ConditionalFormattingTaskPaneReact.Rule: Rule component failed to render: ${e.toString()} , ${t.componentStack}`)}componentWillUnmount(){this.mouseOut()}render(){return this.state.hasError?R.createElement("div",null):j?R.createElement(we.a,null,e=>R.createElement(P.a,{"data-testid":"ruleContainer",tabIndex:0===this.props.index?0:-1,"data-is-focusable":!0,styles:J(this.isCursorShouldBeGrab(),e),onMouseOver:this.mouseOver,onMouseLeave:this.mouseOut,onFocus:this.onFocus,onBlur:this.onBlur,id:Dt(this.props.index),onKeyDown:this.onKeyDown,"aria-label":this.prepareRuleLabel(),role:"listitem"},R.createElement("div",{style:se},R.createElement("div",{style:ae},R.createElement("div",{style:ne},R.createElement(Ve,{rule:this.props.rule,style:Y,isManageRulesCard:!0})),R.createElement("div",{style:ie},R.createElement("div",{style:re},R.createElement("div",{style:oe},R.createElement(ge,{ruleName:this.props.rule.ruleName,isPlaceholder:this.props.rule.isPlaceholder||!1})),R.createElement("div",{style:Z},R.createElement(Re,{showCommands:this.shouldShowCommands(),enableEdit:this.isRuleEditable(),onRuleDelete:this.onRuleDelete,editRule:this.editRule,onRuleDuplicate:this.onRuleDuplicate,ruleId:Dt(this.props.index),ruleRangeId:Ie(this.props.rule.ruleId)}))),R.createElement(wt.a,null))),R.createElement("div",{onKeyDown:this.onRuleRangeKeyDown},R.createElement(_t,{ruleId:this.props.rule.ruleId,range:this.props.rule.ruleRange,sheetName:this.props.rule.ruleRangeSheetName,isPlaceholder:this.props.rule.isPlaceholder||!1,updatePickerState:this.updatePickerState}))))):R.createElement(P.a,{"data-testid":"ruleContainer",tabIndex:0===this.props.index?0:-1,"data-is-focusable":!0,styles:this.ruleCardStyle,onMouseOver:this.mouseOver,onMouseLeave:this.mouseOut,onFocus:this.onFocus,onBlur:this.onBlur,id:Dt(this.props.index),onKeyDown:this.onKeyDown,"aria-label":this.prepareRuleLabel(),role:"listitem"},R.createElement("div",{style:_object_spread_props(_object_spread({},$),{marginBottom:"4px"})},R.createElement("div",{style:X},!this.props.rule.isPlaceholder&&this.props.rule.stopIfTrue?R.createElement(Ee.a,{content:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingStopIfTrueText)},R.createElement(fe.a,{iconName:be.a.StopConditional_12,style:ee})):null),R.createElement("div",{style:{flexGrow:2}},R.createElement(ge,{ruleName:this.props.rule.ruleName,isPlaceholder:this.props.rule.isPlaceholder||!1})),R.createElement("div",{style:{marginTop:"8px"}},R.createElement(Ve,{rule:this.props.rule})," ")),R.createElement("div",{style:$,onKeyDown:this.onRuleCommandsKeyDown},R.createElement("div",{style:{flexGrow:2},onKeyDown:this.onRuleRangeKeyDown},R.createElement(Fe,{ruleId:this.props.rule.ruleId,range:this.props.rule.ruleRange,sheetName:this.props.rule.ruleRangeSheetName,isPlaceholder:this.props.rule.isPlaceholder||!1,updatePickerState:this.updatePickerState})),R.createElement(Re,{showCommands:this.shouldShowCommands(),enableEdit:this.isRuleEditable(),onRuleDelete:this.onRuleDelete,editRule:this.editRule,onRuleDuplicate:this.onRuleDuplicate,ruleId:Dt(this.props.index),ruleRangeId:Ie(this.props.rule.ruleId)})))}updatePickerState(e,t,n,o){const r=e!==this.state.pickerState.isPicking,l=r&&e,c=r&&!e,u=n!==this.props.rule.ruleRange;if(l||c){const t=_object_spread({},this.props.rule);c&&u&&(this.props.onRuleRangeChanged(this.props.rule,n,o),t.ruleRange=n,i.a.sendTraceTag(542914069,a.a.msoulscat_ES_EWAJS,s.a.Info,"Rule.onRuleRangeChanged: Conditional Formatting Rule range was modified via the Rule Manager")),this.state.hovering&&this.props.onRuleHoverStateChanged(!e,t)}this.setState({pickerState:{isPicking:e,hasError:t},ownUpdate:!0})}updatePickerStateDeprecated(e,t){this.setState({pickerState:{isPicking:e,hasError:t},ownUpdate:!0})}isRuleEditable(){return i.a.shipAssertTag(573933140,a.a.msoulscat_ES_EWAJS,this.props.rule.isPlaceholder||3===this.props.rule.ruleType||null!==this.props.rule.dataBarFormat||null!==this.props.rule.colorScaleFormat||null!==this.props.rule.iconSetFormat,"ConditionalFormattingTaskPaneReact.Rule.isRuleEditable: rule does not have custom format."),null!=this.props.rule.editOptions||3!==this.props.rule.ruleType}editRule(){i.a.sendTraceTag(507618456,a.a.msoulscat_ES_EWAJS,s.a.Info,"Rule.editRule: Edit Rule was clicked via manage rules cards."),this.isRuleEditable()&&this.props.editRule(this.props.rule)}prepareRuleLabel(){var e;if(this.props.rule.isPlaceholder)return ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingLoadingRule);let t;t=this.props.rule.stopIfTrue?ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingRuleAppliesToRangeHasStopIfTrue):ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingRuleAppliesToRange);let n=t.replace("{0}",this.props.rule.ruleName).replace("{1}",this.props.rule.ruleRange),o=3;return o+=this.isRuleEditable()?1:0,n=n.concat(null===(e=ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingRuleHasMultipleOptions))||void 0===e?void 0:e.replace("{0}",""+o)),this.isRuleEditable()||(n=n.concat(ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingEditingRuleNotSupportedTooltipContent))),n=n.concat(ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingCanReorderRules)),n}onRuleDelete(){i.a.sendTraceTag(507618455,a.a.msoulscat_ES_EWAJS,s.a.Info,"Rule.onRuleDelete: Delete Rule was clicked via manage rules cards."),Ge(ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingRuleDeleted)),this.props.rule.isPlaceholder?i.a.shipAssertTag(593826331,a.a.msoulscat_ES_EWAJS,!1,"ConditionalFormattingTaskPaneReact.Rule.onRuleDelete: rule is a place holder."):(this.props.onRuleHoverStateChanged(!1,this.props.rule),setTimeout(()=>{this.setFocusAfterDelete(this.props.isLastRule?this.props.index-1:this.props.index)},100),this.props.onRuleDelete(this.props.rule.ruleId,this.props.index))}onRuleDuplicate(){if(i.a.sendTraceTag(507618454,a.a.msoulscat_ES_EWAJS,s.a.Info,"Rule.onRuleDuplicate: Duplicate Rule was clicked via manage rules cards."),Ge(ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingRuleDuplicated)),this.props.rule.isPlaceholder)return void i.a.shipAssertTag(538063968,a.a.msoulscat_ES_EWAJS,!1,"ConditionalFormattingTaskPaneReact.Rule.onRuleDuplicate: rule is a place holder.");const e=function(e){const t=lt(e);if(t.customFormat&&(t.customFormat.preserveBackgroundColor=!1),t.dataBarFormat||t.iconSetFormat||t.colorScaleFormat){const e=t.dataBarFormat?77:t.iconSetFormat?79:t.colorScaleFormat?78:0;t.options={command:e,quickFormat:6}}else t.options||(t.options={quickFormat:6});return t}(this.props.rule);this.props.onRuleDuplicate(e)}setFocusAfterDelete(e){const t=document.getElementById(Dt(e));t?t.focus():pe.setFocusOnPaneFirstElement()}onKeyDown(e){if(this.state.pickerState.isPicking)return;let t=null;switch(e.keyCode){case xe.a.up:e.ctrlKey?this.props.onMoveRuleWithKeyboard(this.props.rule,this.props.index,!0):0!==this.props.index&&(t=document.getElementById(Dt(this.props.index-1)));break;case xe.a.down:e.ctrlKey?this.props.onMoveRuleWithKeyboard(this.props.rule,this.props.index,!1):this.props.isLastRule||(t=document.getElementById(Dt(this.props.index+1)));break;case xe.a.tab:e.shiftKey?t=document.getElementById("CondFmtDeleteAllRulesButton"):pe.setFocusOnToolbarFirstElement(),e.stopPropagation(),e.preventDefault();break;case xe.a.del:this.onRuleDelete(),e.preventDefault();break;case xe.a.enter:if(t=document.getElementById(Ie(this.props.rule.ruleId)),!t){const e=Dt(this.props.index);t=document.getElementById(ye(e)),t&&this.isRuleEditable()||(t=document.getElementById(Ce(e)))}}t&&t.focus()}isCursorShouldBeGrab(){return pe.isRuleReorderWithDnDSupported()&&!this.props.rule.isPlaceholder}constructor(e){super(e),this.ruleCardStyle={root:{minWidth:"262px",minHeight:"58px",maxWidth:"262px",maxHeight:"58px",marginTop:"9px",marginBottom:"9px",padding:"8px 11px 8px 11px",borderRadius:"2px",boxShadow:"0px 1px 3px 0px #eaeaea",cursor:this.isCursorShouldBeGrab()?"grab":"default",selectors:{":hover":{borderColor:"#c8c8c8",borderStyle:"solid",[F.m]:{borderColor:"Highlight"}},":focus,:focus-within,:focus:after":Q()}}},this.shouldShowCommands=()=>{const e=this.state.hovering||this.state.focused,t=this.props.rule.isPlaceholder||this.state.pickerState.isPicking;return e&&!t},this.mouseOver=()=>{(this.state.pickerState.isPicking||this.props.onRuleHoverStateChanged(!0,this.props.rule))&&this.setState(e=>e.hovering?null:{hovering:!0,ownUpdate:!0})},this.mouseOut=()=>{this.state.hovering&&this.props.onRuleHoverStateChanged(!1,this.props.rule)&&this.setState({hovering:!1,ownUpdate:!0})},this.onFocus=()=>{this.setState(e=>e.focused?null:{focused:!0,ownUpdate:!0})},this.onBlur=()=>{this.state.focused&&this.setState({focused:!1,ownUpdate:!0})},this.onRuleCommandsKeyDown=e=>{let t=null;e.keyCode===xe.a.escape&&(t=document.getElementById(Dt(this.props.index))),t&&(e.preventDefault(),e.stopPropagation(),t.focus())},this.onRuleRangeKeyDown=e=>{let t=null;switch(e.keyCode){case xe.a.tab:if(this.state.pickerState.isPicking){var n,o;e.shiftKey?(null===(n=document.activeElement)||void 0===n?void 0:n.id)===this.getFirstPickerButtonElementId()&&(t=document.getElementById(this.getLastPickerButtonElementId())):(null===(o=document.activeElement)||void 0===o?void 0:o.id)===this.getLastPickerButtonElementId()&&(t=document.getElementById(this.getFirstPickerButtonElementId()));break}const r=Dt(this.props.index);if(t=document.getElementById(ye(r)),e.shiftKey){t=document.getElementById(Ce(r));break}if(!this.isRuleEditable()||!t){t=document.getElementById(ve(r));break}break;case xe.a.escape:case xe.a.enter:t=document.getElementById(Dt(this.props.index))}t&&(e.preventDefault(),e.stopPropagation(),t.focus())},this.getLastPickerButtonElementId=()=>Object(Qe.d)(Ie(this.props.rule.ruleId),this.state.pickerState.hasError?Qe.c.cancelButton:Qe.c.applyButton),this.getFirstPickerButtonElementId=()=>Object(Qe.d)(Ie(this.props.rule.ruleId),Qe.c.textField),this.state={hasError:!1,hovering:!1,pickerState:{isPicking:!1,hasError:!1},focused:!1,ownUpdate:!0},this.onRuleDelete=this.onRuleDelete.bind(this),this.onRuleDuplicate=this.onRuleDuplicate.bind(this),this.updatePickerState=this.updatePickerState.bind(this),this.updatePickerStateDeprecated=this.updatePickerStateDeprecated.bind(this),this.editRule=this.editRule.bind(this),this.onKeyDown=this.onKeyDown.bind(this)}}var It=n(2804);class Ft extends R.Component{render(){return R.createElement(It.Scrollbars,{autoHide:!1,style:this.props.containerStyle,renderView:this.renderView,renderThumbHorizontal:this.renderThumbHorizontal,renderThumbVertical:this.renderThumbVertical,renderTrackVertical:this.renderTrackVertical},this.props.children)}renderView(){return R.createElement("div",{className:Object(F.eb)({overflow:"scroll",position:"absolute",top:"0px",bottom:"0px",right:"0px",left:"0px","-ms-overflow-style":"none","scrollbar-width":"none",selectors:{"::-webkit-scrollbar":{display:"none"}}})})}renderThumbHorizontal(){return R.createElement("div",{style:{display:"hidden"}})}renderThumbVertical(){return R.createElement("div",{style:{display:"block",width:"6px",backgroundColor:"#C8C6C4",borderRadius:"3px"}})}constructor(){super(...arguments),this.renderTrackVertical=()=>{const{trackWidth:e=10}=this.props,t={position:"absolute",bottom:"2px",[Object(ue.a)()?"left":"right"]:"3px",top:"10px",width:e,cursor:"default"};return R.createElement("div",{style:t})}}}let Bt=void 0;class Mt extends R.Component{render(){const e=Object.keys(this.props.rules).length,t=R.createElement("div",{role:"list",id:this.getRuleListId()},this.props.rules.map((t,n)=>pe.isRuleReorderWithDnDSupported()&&!t.isPlaceholder?R.createElement(Bt,{key:t.ruleId,id:t.ruleId,index:n,onRenderItem:this.onRenderItem,onReorderItemPreview:this.props.onReorderRuleCardPreview,onCommitReorderItem:this.props.onCommitReorderRuleCard,onCancelReorderItem:this.props.onCancelReorderRuleCard}):this.renderRuleComponent(t,n,n===e-1)));return R.createElement(Ft,{containerStyle:{minWidth:"304px"}},R.createElement("div",{style:{position:"absolute",display:"flex",flexDirection:"column",overflow:"hidden"},"data-testid":"RulesContainer"},t))}getRuleListId(){return this.props.rules&&0!==this.props.rules.length&&this.props.rules[0].isPlaceholder?pe.getRequiredLoadingRuleListId():pe.getRequiredRuleListId()}onRenderItem(e,t){return this.renderRuleComponent(this.props.rules[t],t,t===Object.keys(this.props.rules).length-1)}renderRuleComponent(e,t,n){return R.createElement("div",{"data-testid":"Rule"},R.createElement(Pt,{key:e.ruleId,index:t,rule:e,onRuleDelete:this.props.onRuleDelete,onRuleDuplicate:this.props.onRuleDuplicate,onRuleHoverStateChanged:this.props.onRuleHoverStateChanged,editRule:this.props.editRule,onMoveRuleWithKeyboard:this.props.onMoveRuleWithKeyboard,onRuleRangeChanged:this.props.onRuleRangeChanged,isLastRule:n}))}constructor(e){super(e),Bt||(Bt=R.lazy(()=>n.e(34).then(n.bind(null,3092)))),this.renderRuleComponent=this.renderRuleComponent.bind(this),this.onRenderItem=this.onRenderItem.bind(this)}}var jt=n(410);class Ot extends R.Component{render(){return R.createElement(jt.a,{"data-testid":"EmptyRuleContainer","aria-label":ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingEmptyPane),style:this.emptyContainerLabelStyle,id:"EmptyRuleContainerLabel"},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingEmptyPane))}constructor(){super(...arguments),this.emptyContainerLabelStyle=_object_spread_props(_object_spread({},gn),{paddingTop:"16px",fontWeight:400})}}var Lt=n(2165),At=n(376);const Nt={dropdown:{border:"1px solid transparent",width:"max-content",color:"#217346",fontSize:"12px",selectors:{":focus":Q(),":focus:after":{outline:"none",border:"1px solid transparent"}}},title:{border:"none",color:"#217346 !important",backgroundColor:"transparent",height:"22px",marginBottom:"5px",paddingLeft:"4px",lineHeight:"23px"},root:{color:"#217346"},dropdownOptionText:{backgroundColor:"transparent",fontSize:"12px"},caretDownWrapper:{maxHeight:"12px",lineHeight:"23px"},dropdownItem:{minHeight:"24px",color:"#252423"},dropdownItemSelected:{minHeight:"24px"},dropdownItems:{overflow:"hidden"}},Wt={alignItems:"baseline",marginTop:"9px"};var zt=n(1244);class Ht extends R.Component{componentDidMount(){pe.setFocusOnPaneFirstElement()}render(){return R.createElement(At.a,{style:Wt,horizontal:!0,tokens:{childrenGap:2},verticalAlign:"end"},R.createElement(jt.a,{style:{fontSize:"12px",paddingTop:"0px",paddingBottom:"0px",marginBottom:"8px"},id:"ConditionalFormattingFilterMenuPrefix"},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingFilterMenuPrefix)),R.createElement(Lt.a,{role:"combobox",options:Ht.filterOptions,selectedKey:this.props.ruleFilterOption,styles:Nt,onRenderCaretDown:zt.a,onChange:this.onUpdateFilteringOption,"aria-labelledby":"EmptyRuleContainerLabel ConditionalFormattingFilterMenuPrefix",id:pe.getRequiredFirstPaneElementId()}))}onUpdateFilteringOption(e,t){if(!t)throw new Error("undefined filtering option.");let n;if(0===t.key)n=0;else{if(1!==t.key)throw new Error("RuleManager.onUpdateFilteringOption Unknown filtering type.");n=1}pe.onRuleFilteringOptionsChange(n)}constructor(e){super(e),this.onUpdateFilteringOption=this.onUpdateFilteringOption.bind(this)}}Ht.filterOptions=[{key:1,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingFilterMenuSheet)},{key:0,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingFilterMenuSelection)}];class Vt extends R.Component{render(){return this.state.isLoading?this.props.loadingElement():R.createElement("div",null)}componentDidMount(){this.state.isLoading||(this.timeout=setTimeout(()=>{this.setState({isLoading:!0})},this.props.showLoadingAfter))}componentWillUnmount(){clearTimeout(this.timeout)}constructor(e){super(e),this.state={isLoading:!1},this.timeout=null}}var Ut=n(1304);const Gt={marginLeft:"9px"},qt=_object_spread_props(_object_spread({},Gt),{color:"#252423",paddingTop:"16px"}),Qt=_object_spread_props(_object_spread({},Gt),{fontSize:"12px",color:"#252423",fontWeight:400,paddingBottom:"16px"}),Kt={root:Gt};class Jt extends R.Component{render(){return R.createElement("div",{"data-testid":"ErrorContainer"},R.createElement(jt.a,{style:qt},this.props.errorTitle),R.createElement(jt.a,{style:Qt},this.props.errorMsg),this.props.infoLink&&this.props.infoLinkText?R.createElement(Ut.a,{href:this.props.infoLink,target:"_blank",styles:Kt},this.props.infoLinkText):"")}constructor(e){super(e)}}const Yt=new Map;Yt.set(1,{errorTitle:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingTooManyRulesErrorTitle),errorMsg:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingTooManyRulesErrorMessage),infoLink:"https://support.office.com/article/fed60dfa-1d3f-4e13-9ecb-f1951ff89d7f",infoLinkText:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingInfoURLText)}),Yt.set(3,{errorTitle:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingCantDisplayRulesErrorTitle),errorMsg:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingProtecedSheetRuleManagerErrorMessage),infoLink:"https://support.office.com/article/fed60dfa-1d3f-4e13-9ecb-f1951ff89d7f",infoLinkText:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingInfoURLText)});class Zt extends R.Component{render(){return R.createElement(Ee.a,{content:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingNewRuleTooltip),directionalHint:Se.a.bottomCenter},R.createElement(Ue.a,{"aria-label":ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingNewRuleTooltip),disabled:this.props.isDisabled,styles:mn(),iconProps:{iconName:be.a.plussignglyph_16,styles:$t},onClick:this.onAddNewRuleSelected}))}onAddNewRuleSelected(e){pe.addNewRuleFromTaskPane()}}const $t={root:{width:"16px",height:"16px",selectors:{"svg > path.OfficeIconColors_DynamicColor":{fill:"buttonText"}}}};var Xt=n(646),en=n.n(Xt),tn=n(1060),nn=n(2550),on=n(2525);const rn=Object(ut.a)({root:_object_spread({display:"flex",flexDirection:"column",minHeight:"100%",justifyContent:"center",alignItems:"center"},pt.a.padding("0","16px")),headerText:{fontWeight:F.l.semibold,lineHeight:"20px",fontSize:"14px",color:"#252423"},descriptionText:{textAlign:"center",fontSize:"12px",lineHeight:"16px",fontWeight:F.l.regular,color:"#252423"},link:{fontSize:"12px",lineHeight:"16px",marginTop:"16px",marginBottom:"12px"},newRuleButton:_object_spread({},pt.a.padding("5px","20px"))});var an=n(1013),sn=n(1460),ln=n(460),cn=n(2558);const un=Object(ut.a)({base:{minHeight:"24px",minWidth:"24px"}}),dn=R.memo(R.forwardRef((e,t)=>{const n=Object(sn.a)(_object_spread_props(_object_spread({},e),{dataAutomationType:"TaskPaneButton"}),t);return(e=>{const t=un();e.root.className=Object(Rt.a)(t.base,e.root.className),Object(cn.a)(e),Object(cn.b)(e.icon,e),Object(ln.b)(e)})(n),Object(an.a)(n)}));dn.displayName="next/TaskPaneButton";const pn=e=>{const t=rn();return R.createElement(Ft,null,R.createElement("div",{"data-testid":"EmptyRuleContainerV2Container",className:t.root},R.createElement(nn.a,{className:t.headerText},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingEmptyPaneV2Header)),R.createElement(tn.a,{iconName:en.a.CellNew_256x256,width:192,height:192}),R.createElement(nn.a,{className:t.descriptionText},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingEmptyPaneV2Label)),R.createElement(on.a,{id:"LearnMoreLinkId",rel:"noopener noreferrer",className:t.link,onClick:pe.onEmptyPaneHelpLinkClick},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingEmptyPaneV2LearnMore)),R.createElement(dn,{id:"NewRuleButton",appearance:"primary",label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingNewRule),disabled:e.isAddNewRuleDisabled,onExecute:pe.addNewRuleFromTaskPane,className:t.newRuleButton})))},gn={color:"#252423",fontSize:"12px"},hn={background:"Highlight",color:"HighlightText",fill:"HighlightText","svg > path.OfficeIconColors_DynamicColor":{fill:"highlighttext"}},mn=()=>({root:{paddingRight:"4px",selectors:{":hover":{background:"#E1DFDD",[F.m]:hn},":focus":{[F.m]:hn}}},rootDisabled:{opacity:"0.3",":hover":{background:"transparent"},pointerEvents:"none"}});let bn=null,fn=void 0;class xn extends R.Component{static getDerivedStateFromProps(e,t){return t.ownUpdate?{ownUpdate:!1}:t.isInReorder?{hasPendingChanges:!0}:{rules:xn.copyRulesArray(e.rules),hasPendingChanges:!1,ownUpdate:!1}}render(){return R.createElement("div",{id:pe.getRequiredRuleManagerId(),style:_object_spread({position:"absolute",height:"100%",display:"flex",flexDirection:"column"},H())},R.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},R.createElement(Ht,{ruleFilterOption:this.props.ruleFilterOption}),this.shouldRenderAddDeleteButtons()&&R.createElement("div",null,R.createElement(Zt,{isDisabled:this.isAddNewRuleButtonDisabled()}),R.createElement(qe,{onDeleteAllRules:this.onDeleteAllRules,isDisabled:this.isDeleteAllRulesButtonDisabled()}))),this.getRulesContent())}shouldRenderAddDeleteButtons(){return this.areRulesPresent()||!B}areRulesPresent(){return 0!==Object.keys(this.state.rules).length}getRulesContent(){return this.props.error?R.createElement(Jt,_object_spread({},Yt.get(this.props.error))):this.props.isLoading?R.createElement("div",{"data-testid":"LoadingContainer"},R.createElement(Vt,{showLoadingAfter:Qs,loadingElement:this.createLoadingElement})):this.areRulesPresent()?this.getRulesContainerComponent(this.state.rules):B?R.createElement(pn,{isAddNewRuleDisabled:this.isAddNewRuleButtonDisabled()}):R.createElement(Ot,null)}isDeleteAllRulesButtonDisabled(){const e=0===Object.keys(this.state.rules).length&&!(1===this.props.error);return 3===this.props.error||e}isAddNewRuleButtonDisabled(){return 3===this.props.error}getRulesContainerComponent(e){return R.createElement(Mt,{rules:e,onRuleDelete:this.onRuleDelete,onRuleDuplicate:this.onRuleDuplicate,editRule:this.editRule,onRuleHoverStateChanged:this.onRuleHoverStateChanged,onMoveRuleWithKeyboard:this.onMoveRuleWithKeyboard,onReorderRuleCardPreview:this.onReorderRuleCardPreview,onCommitReorderRuleCard:this.onCommitReorderRuleCard,onCancelReorderRuleCard:this.onCancelReorderRuleCard,onRuleRangeChanged:this.onRuleRangeChanged})}onRuleDelete(e,t){const n=this.state.rules;n.splice(t,1),this.setState({rules:n,ownUpdate:!0}),pe.onRuleDelete(e)}onRuleDuplicate(e){const t=this.state.rules;t.unshift(this.createPlaceholderRule(ot())),this.setState({rules:t,ownUpdate:!0},()=>{var e;null===(e=document.getElementById(Dt(0)))||void 0===e||e.focus()}),pe.onRuleDuplicate(e)}onDeleteAllRules(){this.setState({rules:[],ownUpdate:!0})}editRule(e){i.a.sendTraceTag(506853334,a.a.msoulscat_ES_EWAJS,s.a.Info,"RuleManager.editRule: Editing rule"),this.props.onChangeViewRequest(2,e)}onRuleRangeChanged(e,t,n){pe.onRuleEdited(_object_spread_props(_object_spread({},st(e)),{range:t,ruleRangeSheetName:n}));const o=this.state.rules,r=o.indexOf(e);if(r>=0){const e=_object_spread({},o[r]);e.ruleRange=t,o[r]=e,this.setState({rules:o,ownUpdate:!0})}}restoreRulesFromProps(){this.setState({rules:xn.copyRulesArray(this.props.rules),isInReorder:!1,hasPendingChanges:!1,ownUpdate:!0})}onReorderRuleCardPreview(e,t){const n=this.state.rules;this.moveRuleToIndex(n,e,t),this.setState({rules:n,isInReorder:!0,ownUpdate:!0})}onCommitReorderRuleCard(e,t){const n=this.state.rules,o=Object.keys(n).length;if(o<=1)return;const r=n.filter(t=>""+t.ruleId===e)[0];if(!r||r.isPlaceholder)return i.a.shipAssertTag(556660762,a.a.msoulscat_ES_EWAJS,!1,"ConditionalFormattingTaskPaneReact.RuleManager: invalid rule for reorder."),void this.restoreRulesFromProps();const s=n.indexOf(r);if(t===s)return void(this.state.hasPendingChanges&&this.restoreRulesFromProps());let l=-1;if(l=s===o-1?n[s-1].priority+1:n[s+1].priority,r.priority!==l)if(pe.onRuleEdited(_object_spread_props(_object_spread({},st(r)),{priority:l,newJSApiPriority:s})),this.state.hasPendingChanges)this.restoreRulesFromProps();else{r.priority=l;for(let e=s+1;e<o;e+=1)n[e].priority+=1;this.setState({rules:n,hasPendingChanges:!1,isInReorder:!1,ownUpdate:!0},()=>{this.AnnounceRuleReorder(s+1,o)})}}onMoveRuleWithKeyboard(e,t,n){if(!this.isMoveRuleWithKeyboardEnabled(e,t,n))return;const o=this.state.rules,r=Object.keys(o).length;bn&&(clearTimeout(bn),fn?fn.rule.ruleId!==e.ruleId&&this.commitRuleReorderKeyboardEvent():i.a.shipAssertTag(555266245,a.a.msoulscat_ES_EWAJS,!1,"ConditionalFormattingTaskPaneReact.onMoveRuleWithKeyboard: reorderEvent is undefined."));const s={rule:e,newPriority:-1,newIndex:-1};n?(s.newIndex=t-1,s.newPriority=o[s.newIndex].priority,o[t]=o[s.newIndex],o[s.newIndex]=e):(s.newIndex=t+1,s.newIndex===r-1?s.newPriority=o[s.newIndex].priority+1:s.newPriority=o[s.newIndex+1].priority,o[t]=o[s.newIndex],o[s.newIndex]=e),fn=s,bn=setTimeout(()=>{this.commitRuleReorderKeyboardEvent(),bn=null},1e3),this.setState({rules:o,ownUpdate:!0},()=>{var e;null===(e=document.getElementById(Dt(s.newIndex)))||void 0===e||e.focus({preventScroll:!1})})}isMoveRuleWithKeyboardEnabled(e,t,n){const o=this.state.rules,r=Object.keys(o).length;return!(e.isPlaceholder||r<=1||0===t&&n||t===r-1&&!n||n&&o[t-1].isPlaceholder||!n&&o[t+1].isPlaceholder)}commitRuleReorderKeyboardEvent(){if(!fn)return void i.a.shipAssertTag(555266246,a.a.msoulscat_ES_EWAJS,!1,"ConditionalFormattingTaskPaneReact.commitRuleReorderKeyboardEvent: reorderEvent is undefined.");pe.onRuleEdited(_object_spread_props(_object_spread({},st(fn.rule)),{priority:fn.newPriority,newJSApiPriority:fn.newIndex}));const e=this.state.rules,t=Object.keys(e).length;if(fn.newIndex<t&&e[fn.newIndex].ruleId===fn.rule.ruleId){fn.rule.priority=fn.newPriority;for(let n=fn.newIndex+1;n<t;n+=1)e[n].priority+=1}this.AnnounceRuleReorder(fn.newIndex+1,t),fn=void 0}onCancelReorderRuleCard(e,t){if(this.state.hasPendingChanges)this.restoreRulesFromProps();else{const n=this.state.rules;this.moveRuleToIndex(n,e,t),this.setState({rules:n,isInReorder:!1,hasPendingChanges:!1,ownUpdate:!0})}}moveRuleToIndex(e,t,n){if(n<0||n>=Object.keys(e).length)return void i.a.shipAssertTag(556660763,a.a.msoulscat_ES_EWAJS,!1,"ConditionalFormattingTaskPaneReact.RuleManager: invalid index for rule reorder.");const o=e.filter(e=>""+e.ruleId===t)[0];if(!o)return void i.a.shipAssertTag(556660764,a.a.msoulscat_ES_EWAJS,!1,"ConditionalFormattingTaskPaneReact.RuleManager: invalid rule for reorder.");const r=e.indexOf(o);e.splice(r,1),e.splice(n,0,o)}onRuleHoverStateChanged(e,t){return!t.isPlaceholder&&!this.state.isInReorder&&(pe.onRuleHoverStateChange(e,t.ruleId,t.ruleRange),!0)}createPlaceholderRule(e){return{isPlaceholder:!0,ruleName:"",ruleType:0,ruleRange:"",ruleId:e,priority:0,stopIfTrue:!1,colorScaleFormat:null,dataBarFormat:null,customFormat:null,iconSetFormat:null}}createPlaceholderRulesList(){const e=[];for(let t=0;t<4;t+=1)e.push(this.createPlaceholderRule(t.toString()));return e}static copyRulesArray(e){const t=[];if(e){const n=Object.keys(e).length;for(let o=0;o<n;o+=1)t.push(e[o])}return t}constructor(e){super(e),this.AnnounceRuleReorder=(e,t)=>{Ge(ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingReorderRulesCompleted).replace("{0}",""+e).replace("{1}",""+t))},this.createLoadingElement=()=>this.getRulesContainerComponent(this.createPlaceholderRulesList()),this.state={rules:xn.copyRulesArray(this.props.rules),isInReorder:!1,hasPendingChanges:!1,ownUpdate:!0},this.onRuleDelete=this.onRuleDelete.bind(this),this.onRuleDuplicate=this.onRuleDuplicate.bind(this),this.editRule=this.editRule.bind(this),this.onDeleteAllRules=this.onDeleteAllRules.bind(this),this.onRuleHoverStateChanged=this.onRuleHoverStateChanged.bind(this),this.onReorderRuleCardPreview=this.onReorderRuleCardPreview.bind(this),this.onCommitReorderRuleCard=this.onCommitReorderRuleCard.bind(this),this.onCancelReorderRuleCard=this.onCancelReorderRuleCard.bind(this),this.restoreRulesFromProps=this.restoreRulesFromProps.bind(this),this.onMoveRuleWithKeyboard=this.onMoveRuleWithKeyboard.bind(this),this.commitRuleReorderKeyboardEvent=this.commitRuleReorderKeyboardEvent.bind(this),this.onRuleRangeChanged=this.onRuleRangeChanged.bind(this)}}var En,Sn,yn,Cn;!function(e){e[e.CellValue=0]="CellValue",e[e.SpecificText=1]="SpecificText",e[e.DateOccurring=2]="DateOccurring",e[e.DuplicateValues=3]="DuplicateValues",e[e.UniqueValues=4]="UniqueValues",e[e.Blanks=5]="Blanks",e[e.NoBlanks=6]="NoBlanks",e[e.Errors=7]="Errors",e[e.NoErrors=8]="NoErrors"}(En||(En={})),function(e){e[e.HighlightCellsWith=0]="HighlightCellsWith",e[e.TopBottom=1]="TopBottom",e[e.DataBars=2]="DataBars",e[e.ColorScales=3]="ColorScales",e[e.IconSets=4]="IconSets",e[e.Formula=5]="Formula"}(Sn||(Sn={})),function(e){e[e.Top=0]="Top",e[e.Bottom=1]="Bottom",e[e.AboveAverage=2]="AboveAverage",e[e.BelowAverage=3]="BelowAverage",e[e.EqualOrAboveAverage=4]="EqualOrAboveAverage",e[e.EqualOrBelowAverage=5]="EqualOrBelowAverage"}(yn||(yn={})),function(e){e[e.Percent=0]="Percent",e[e.Values=1]="Values"}(Cn||(Cn={}));class vn{getCommandType(){return this.command}setCommandType(e){this.command=e}getRuleInputValue(){return this.inputValue}setRuleInputValue(e){this.setShouldShowErrorWhenInvalid(!0),this.inputValue=e}shouldShowError(){return this.shouldShowErrorWhenInvalid&&!this.isValid()}getShouldShowErrorWhenInvalid(){return this.shouldShowErrorWhenInvalid}setShouldShowErrorWhenInvalid(e){this.shouldShowErrorWhenInvalid=e}wasChanged(){return this.inputWasChanged}setWasChanged(){this.inputWasChanged=!0}doesSupportStopIfTrueOrFormatInput(){return!0}getError(){return null}canFocusOnRuleInput(){return!1}constructor(e,t){this.command=e,this.inputValue=t,this.shouldShowErrorWhenInvalid=!0,this.inputWasChanged=!1}}class Rn extends vn{isPercentRule(){return 9===this.getCommandType()||11===this.getCommandType()}getInputType(){return Sn.TopBottom}isAverageRule(){return 12===this.getCommandType()||13===this.getCommandType()||75===this.getCommandType()||76===this.getCommandType()}isTopRule(){return 8===this.getCommandType()||9===this.getCommandType()}isBottomRule(){return 10===this.getCommandType()||11===this.getCommandType()}isValid(){if(this.isAverageRule())return!0;const e=this.getRuleInputValue();if(!isNaN(e)&&null!=e){const t=parseInt(e,10);if(t.toString()===e.toString()&&t>=this.getMinValue()&&t<=this.getMaxValue())return!0}return!1}getError(){return i.a.shipAssertTag(587310853,a.a.msoulscat_ES_EWAJS,!this.isAverageRule(),"TopBottomRuleInput.getErrorMessage: Average rule has no input value."),this.isValid()?null:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingTopBottomValueTextboxOnError).replace("{0}",this.getMinValue().toString()).replace("{1}",this.getMaxValue().toString())}getMinValue(){return this.minValue}getMaxValue(){return this.isPercentRule()?this.percentMaxValue:this.maxValue}updateConditionalFormattingOptions(e){e.value=this.getRuleInputValue(),e.command=this.getCommandType()}getDefaultValue(){return this.defaultInputValue}canFocusOnRuleInput(){return!this.isAverageRule()}constructor(e,t=null){super(e,t),this.minValue=1,this.percentMaxValue=100,this.maxValue=1e3,this.defaultInputValue=10,this.isAverageRule()||null!==t||this.setRuleInputValue(this.getDefaultValue())}}class kn extends vn{getInputType(){return 63===this.getCommandType()?Sn.Formula:Sn.HighlightCellsWith}canFocusOnRuleInput(){return!0}isValid(){return this.isValidValue(this.getRuleInputValue())}getError(){return this.getErrorForValue(this.getRuleInputValue())}getErrorIfNeeded(){return this.shouldShowErrorWhenInvalid?this.getError():null}updateConditionalFormattingOptions(e){e.command=this.getCommandType(),this.updateFormulaValueOptions(e)}updateFormulaValueOptions(e){e.formula1=this.getRuleInputValue(),e.formula2=null}isValidValue(e){return 0===this.getErrorTypeForValue(e)}getErrorForValue(e){switch(this.getErrorTypeForValue(e)){case 1:return this.getInputType()===Sn.Formula?ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingFormulaValueTextboxError):ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingHighlightCellValueTextboxOnError);case 2:return ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingValueTooLongError).replace("{0}",this.ruleFormulaValueMaxLength.toString());case 3:return ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingFormulaRepresentingRangeError);default:return null}}getDefaultValue(){return this.defaultInputValue}getErrorTypeForValue(e){return e&&e.length>this.ruleFormulaValueMaxLength?2:pe.getFormulaErrorType(e)}constructor(e,t){super(e,t),this.defaultInputValue="",this.ruleFormulaValueMaxLength=255,null==t&&this.setRuleInputValue(this.getDefaultValue()),this.shouldShowErrorWhenInvalid=!1}}class Tn extends kn{isTwoInputValuesRuleType(){return 3===this.getCommandType()||70===this.getCommandType()}isValid(){return!(!this.isValidValue(this.getRuleInputValue()[0])||this.isTwoInputValuesRuleType()&&!this.isValidValue(this.getRuleInputValue()[1]))}getError(){return this.getRuleInputValue().map(e=>this.getErrorForValue(e))}getErrorIfNeeded(){return this.shouldShowErrorWhenInvalid?this.getError():this.getRuleInputValue().map(()=>null)}updateFormulaValueOptions(e){e.formula1=this.getRuleInputValue()[0],this.isTwoInputValuesRuleType()?e.formula2=this.getRuleInputValue()[1]:e.formula2=null}constructor(e,t=null,n=null){super(e,[t,n]);let o=t,r=n;null===t&&(o=this.getDefaultValue()),this.isTwoInputValuesRuleType()&&null===n&&(r=this.getDefaultValue()),o===t&&r===n||this.setRuleInputValue([o,r]),this.shouldShowErrorWhenInvalid=!1}}class _n extends vn{getInputType(){return Sn.HighlightCellsWith}isValid(){return!0}updateConditionalFormattingOptions(e){e.command=this.getCommandType(),7===this.getCommandType()&&(e.unique=!this.getRuleInputValue())}constructor(e,t=!0){super(e,t)}}class wn extends vn{getInputType(){return Sn.HighlightCellsWith}isValid(){return!0}updateConditionalFormattingOptions(e){e.command=this.getCommandType(),e.timePeriod=this.getRuleInputValue()}constructor(e,t=1){super(e,t)}}class Dn extends vn{getInputType(){return Sn.DataBars}isValid(){return!0}doesSupportStopIfTrueOrFormatInput(){return!1}updateConditionalFormattingOptions(e){e.command=this.getCommandType()}constructor(e,t=null){super(e,t)}}class Pn extends vn{getInputType(){return Sn.ColorScales}isValid(){return!0}doesSupportStopIfTrueOrFormatInput(){return!1}updateConditionalFormattingOptions(e){e.command=this.getCommandType()}constructor(e,t=null){super(e,t)}}class In extends vn{getInputType(){return Sn.IconSets}isValid(){return!0}doesSupportStopIfTrueOrFormatInput(){return!1}updateConditionalFormattingOptions(e){e.command=this.getCommandType()}constructor(e,t=null){super(e,t)}}const Fn=e=>{const t=e?"10px":"1px";return Object(ue.a)()?_object_spread({marginRight:t},K):_object_spread({marginLeft:t},K)},Bn={lineHeight:"normal",width:"100%"},Mn={lineHeight:"normal",marginTop:"4px"};function jn(e){return{label:{fontSize:"12px",height:"14px",marginBottom:"4px",padding:"0px"},title:_object_spread_props(_object_spread({},e.isOpen?Q(!0,!0):{}),{height:"28px",lineHeight:"normal",selectors:{":active:hover":{borderColor:"#217344"},":active:not(:hover)":{borderColor:"#217344"}}}),dropdown:{maxWidth:W,fontSize:"12px",selectors:{":active":{outline:"none"},":focus::after":Q(!0,!0),[F.m]:{":focus .ms-Dropdown-title":{color:"unset"},":hover .ms-Dropdown-title":{borderColor:"unset"}}}},dropdownItem:{direction:Object(ue.a)()?"rtl":"ltr",minHeight:"28px",fontSize:"12px"},dropdownItemSelected:{direction:Object(ue.a)()?"rtl":"ltr",minHeight:"28px",fontSize:"12px"}}}class On extends R.Component{render(){return R.createElement(Lt.a,{role:"combobox listbox",id:this.props.id,label:this.props.label,ariaLabel:this.props.ariaLabel||this.props.label,options:this.props.options,styles:jn,onRenderOption:this.onRenderOption,onRenderTitle:this.onRenderTitle,onRenderCaretDown:zt.a,onChange:this.props.onChange?this.props.onChange:void 0,selectedKey:void 0===this.props.selectedKey||null===this.props.selectedKey?this.props.options[0].key:this.props.selectedKey,disabled:this.props.disabled})}constructor(e){super(e),this.onRenderOption=e=>e?R.createElement("div",{style:Bn},R.createElement(Ln,{text:e.text,item:e.data&&e.data.item})):(i.a.sendTraceTag(591927251,a.a.msoulscat_ES_EWAJS,s.a.Warning,"ConditionalFormattingTaskPaneReact.CFDropdown.RenderOption: option is undefined."),R.createElement("div",null)),this.onRenderTitle=e=>e&&e[0]?R.createElement("div",{style:Mn},R.createElement(Ln,{text:e[0].text,item:e[0].data&&e[0].data.item})):(i.a.sendTraceTag(591927252,a.a.msoulscat_ES_EWAJS,s.a.Warning,"ConditionalFormattingTaskPaneReact.CFDropdown.RenderTitle: options list is "+(void 0===e?"undefined.":"empty.")),R.createElement("div",null))}}class Ln extends R.Component{render(){return R.createElement("div",{style:{display:"flex"}},R.createElement("div",null,this.props.item),R.createElement("span",{style:Fn(!!this.props.item)},this.props.text))}}class An extends R.Component{render(){return R.createElement(On,{id:this.props.id,label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingRuleTypeMenuPrefix),options:Wn,onChange:this.onChange,selectedKey:this.props.selectedKey?this.props.selectedKey:Wn[0].key})}static getDropdownElementId(e){return e?"ConditionalFormatting.RuleEditor.RuleTypeDropdown":pe.getRequiredFirstPaneElementId()}onChange(e,t){t&&this.props.onChange&&this.props.onChange(t.key)}constructor(e){super(e),this.onChange=this.onChange.bind(this)}}const Nn={height:"24px",width:"24px",marginTop:"-3px"},Wn=[{key:Sn.HighlightCellsWith,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingRuleTypeHighlightCellsWith),data:{item:R.createElement(fe.a,{iconName:be.a.FlyoutAnchorCFHighlightCells_32,style:Nn})}},{key:Sn.TopBottom,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingRuleTypeTopBottom),data:{item:R.createElement(fe.a,{iconName:be.a.FormattingRuleTop10_32,style:Nn})}},{key:Sn.DataBars,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingRuleTypeDataBars),data:{item:R.createElement(fe.a,{iconName:be.a.FormattingRuleDataBar_32,style:Nn})}},{key:Sn.ColorScales,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingRuleTypeColorScale),data:{item:R.createElement(fe.a,{iconName:be.a.FormattingRuleGrad3_32,style:Nn})}},{key:Sn.IconSets,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingRuleTypeIconSets),data:{item:R.createElement(fe.a,{iconName:be.a.FormattingRuleIconSet_32,style:Nn})}},{key:Sn.Formula,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingRuleTypeFormula),data:{item:R.createElement(fe.a,{iconName:be.a.ShapeSheetShowFormulas_32,style:Nn})}}];var zn=n(1606),Hn=n(2589),Vn=n(1595),Un=n(619),Gn=n(527),qn=n(182),Qn=n(825),Kn=n(1280),Jn=n(1281),Yn=n(1151),Zn=n(1282),$n=n(2114),Xn=n(1420),eo=n(605);var to=n(662),no=n(2616);const oo=(e,t)=>{const n=e.options.map(e=>R.createElement(no.a,{disabled:e.disabled,value:e.key.toString(),key:e.key,text:e.text},e.text)),o=((e,t)=>{var n;e=Object(zn.b)(e,{supportsLabelFor:!0,supportsSize:!0});const{listboxRef:o,activeParentRef:r,controller:i}=Object(Hn.a)({matchOption:e=>e.classList.contains(to.a.root)}),a=Object(Kn.a)(_object_spread_props(_object_spread({},e),{activeDescendantController:i,freeform:!1})),{clearable:s,clearSelection:l,hasFocus:c,multiselect:u,open:d,selectedOptions:p}=a,{primary:g,root:h}=Object(Un.b)({props:e,primarySlotTagName:"button",excludedPropNames:["children"]}),[m,b]=Object(Jn.a)(e),f=R.useRef(null),x=Object(Zn.a)(e.listbox,Object(Gn.a)(m,o),{state:a,triggerRef:f,defaultProps:{children:e.children}});var E;const S=function(e,t,n){const{state:{open:o,setOpen:r,getOptionById:i},defaultProps:a,activeDescendantController:s}=n,l=R.useRef(""),[c,u]=Object($n.a)(),d=(e,t={startFromNext:!1})=>{const{startFromNext:n}=t,o=s.active();return s.find(t=>{const n=i(t);return!!n&&e(n.text)},{startFrom:n?s.next({passive:!0}):o})||s.find(t=>{const n=i(t);return!!n&&e(n.text)})},p=Object(Xn.a)(e,t,{state:n.state,defaultProps:a,elementType:"button",activeDescendantController:s});return p.onKeyDown=Object(Qn.a)(e=>{u(),"Type"===Object(eo.a)(e)&&(l.current+=e.key.toLowerCase(),c(()=>{l.current=""},500),!o&&r(e,!0),d(e=>0===e.toLocaleLowerCase().indexOf(l.current),{startFromNext:1===l.current.length})||function(e){for(let t=1;t<e.length;t++)if(e[t]!==e[t-1])return!1;return!0}(l.current)&&d(e=>0===e.toLocaleLowerCase().indexOf(l.current[0]),{startFromNext:!0})||s.blur())},p.onKeyDown),p}(null!==(E=e.button)&&void 0!==E?E:{},Object(Gn.a)(f,r,t),{state:a,defaultProps:_object_spread({type:"button",tabIndex:0,children:a.value||e.placeholder,"aria-controls":d?null==x?void 0:x.id:void 0},g),activeDescendantController:i}),y=ft.a.always(e.root,{defaultProps:_object_spread({"aria-owns":!e.inlinePopup&&d?null==x?void 0:x.id:void 0,children:e.children},h),elementType:"div"});y.ref=Object(Gn.a)(y.ref,b);const C=p.length>0&&s&&!u,v=_object_spread({components:{root:"div",button:"button",clearButton:"button",expandIcon:"span",listbox:Yn.a},root:y,button:S,listbox:d||c?x:void 0,clearButton:ft.a.optional(e.clearButton,{defaultProps:{"aria-label":"Clear selection",children:R.createElement(Vn.i,null),tabIndex:0,type:"button"},elementType:"button",renderByDefault:!0}),expandIcon:ft.a.optional(e.expandIcon,{renderByDefault:!0,defaultProps:{children:R.createElement(Vn.c,null)},elementType:"span"}),placeholderVisible:!a.value&&!!e.placeholder,showClearButton:C,activeDescendantController:i},a),k=Object(qn.a)(Object(Qn.a)(null===(n=v.clearButton)||void 0===n?void 0:n.onClick,e=>{var t;l(e),null===(t=f.current)||void 0===t||t.focus()}));return v.clearButton&&(v.clearButton.onClick=k),u&&(v.clearButton=void 0),v})(_object_spread_props(_object_spread({},e),{children:n}),t);return _object_spread({},e,o)};var ro=n(2486),io=n(119),ao=n(250);const so=Object(io.a)({root:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5",B7ck84d:"f1ewtqcl",mc9l5x:"ftuwxu6",Bf4jedk:"f1exfvgq",qhf8xq:"f10pi13n",Bbr2w1p:"f14a1fxs",Bduesf4:"f3e99gv",Bpq79vn:"fhljsf7",li1rpt:"f1gw3sf2",Bsft5z2:"f13zj6fq",E3zdtr:"f1mdlcz9",Eqx8gd:["f1a7op3","f1cjjd47"],By385i5:"f1gboi2j",B1piin3:["f1cjjd47","f1a7op3"],Dlnsje:"ffyw7fx",d9w3h3:["f1kp91vd","f1ibwz09"],B3778ie:["f1ibwz09","f1kp91vd"],B1q35kw:0,Bw17bha:0,Bcgy8vk:0,Bjuhk93:"f1mnjydx",Gjdm7m:"f13evtba",b1kco5:"f1yk9hq",Ba2ppi3:"fhwpy7i",F2fol1:"f14ee0xe",lck23g:"f1xhbsuh",df92cz:"fv8e3ye",I188md:"ftb5wc6",umuwi5:"fjw5xc1",Blcqepd:"f1xdyd5c",nplu4u:"fatpbeo",Bioka5o:"fb7uyps",H713fs:"f1cmft4k",B9ooomg:"f1x58t8o",Bercvud:"f1ibeo51",Bz04dq9:"f132nw8t",Budl3uf:"f1htdosj"},listbox:{B7ck84d:"f1ewtqcl",E5pizo:"f1hg901r",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5",Bxyxcbc:"fmmk62d"},listboxCollapsed:{mc9l5x:"fjseox"},inlineListbox:{Bj3rh1h:"f19g0ac"},button:{Bt984gj:"f122n59",De3pzq:"f1c21dwh",Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"f3bhgqh",B7ck84d:"f1ewtqcl",sj55zd:"f19n0e5",i8kkvl:"f14mj54c",Bceei9c:"f1k6fduh",mc9l5x:"f13qh94s",Bahqtrf:"fk6fouc",Budl1dq:"f12nh0o2",Brf1p80:"f1869bpl",fsow6f:["f1o700av","fes3tcz"],a9b677:"fly5x3f",Brovlpu:"ftqa4ok"},placeholder:{sj55zd:"fxc4j92"},small:{Bahqtrf:"fk6fouc",Be2twd7:"fy9rknc",Bhrd7zp:"figsok6",Bg96gwp:"fwrc4pm",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:["fye6m5k","f3cq2dl"]},medium:{Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",Bg96gwp:"f1i3iumi",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:["f14ev680","f58uxzw"]},large:{i8kkvl:"f1rjii52",Bahqtrf:"fk6fouc",Be2twd7:"fod5ikn",Bhrd7zp:"figsok6",Bg96gwp:"faaz57k",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:["f139mn7i","f1v3q0m"]},outline:{De3pzq:"fxugw4r",Bgfg5da:0,B9xav0g:"f1c1zstj",oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"fhz96rm"},outlineInteractive:{Bgoe8wy:"fvcxoqz",Bwzppfd:["f1ub3y4t","f1m52nbi"],oetu4i:"flmw63s",gg5e9n:["f1m52nbi","f1ub3y4t"],B6oc9vd:"fvs00aa",ak43y8:["f1assf6x","f4ruux4"],wmxk5l:"fqhmt4z",B50zh58:["f4ruux4","f1assf6x"]},underline:{De3pzq:"f1c21dwh",B9xav0g:0,oivjwe:0,Bn0qgzm:0,Bgfg5da:"f9ez7ne",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"fokr779"},"filled-lighter":{De3pzq:"fxugw4r",Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"fs2rfia"},"filled-darker":{De3pzq:"f16xq7d1",Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"fs2rfia"},invalid:{tvckwq:"fs4k3qj",gk2u95:["fcee079","fmyw78r"],hhx65j:"f1fgmyf4",Bxowmz0:["fmyw78r","fcee079"]},invalidUnderline:{hhx65j:"f1fgmyf4"},disabled:{Bceei9c:"fdrzuqr",De3pzq:"f1c21dwh",g2u3we:"f1jj8ep1",h3c5rm:["f15xbau","fy0fskl"],B9xav0g:"f4ikngz",zhjwy3:["fy0fskl","f15xbau"],Bjwas2f:"fg455y9",Bn1d65q:["f1rvyvqg","f14g86mu"],Bxeuatn:"f1cwzwz",n51gp8:["f14g86mu","f1rvyvqg"]},disabledText:{sj55zd:"f1s2aq7o",Bceei9c:"fdrzuqr"},hidden:{mc9l5x:"fjseox"}},{d:[[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],".f1ewtqcl{box-sizing:border-box;}",".ftuwxu6{display:inline-flex;}",".f1exfvgq{min-width:250px;}",".f10pi13n{position:relative;}",".f1gw3sf2::after{box-sizing:border-box;}",'.f13zj6fq::after{content:"";}',".f1mdlcz9::after{position:absolute;}",".f1a7op3::after{left:-1px;}",".f1cjjd47::after{right:-1px;}",".f1gboi2j::after{bottom:-1px;}",".ffyw7fx::after{height:max(var(--strokeWidthThick), var(--borderRadiusMedium));}",".f1kp91vd::after{border-bottom-left-radius:var(--borderRadiusMedium);}",".f1ibwz09::after{border-bottom-right-radius:var(--borderRadiusMedium);}",[".f1mnjydx::after{border-bottom:var(--strokeWidthThick) solid var(--colorCompoundBrandStroke);}",{p:-1}],".f13evtba::after{clip-path:inset(calc(100% - 2px) 0 0 0);}",".f1yk9hq::after{transform:scaleX(0);}",".fhwpy7i::after{transition-property:transform;}",".f14ee0xe::after{transition-duration:var(--durationUltraFast);}",".f1xhbsuh::after{transition-delay:var(--curveAccelerateMid);}",".f1hg901r{box-shadow:var(--shadow16);}",[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],".fmmk62d{max-height:80vh;}",".fjseox{display:none;}",".f19g0ac{z-index:1;}",".f122n59{align-items:center;}",".f1c21dwh{background-color:var(--colorTransparentBackground);}",[".f3bhgqh{border:none;}",{p:-2}],".f19n0e5{color:var(--colorNeutralForeground1);}",".f14mj54c{column-gap:var(--spacingHorizontalXXS);}",".f1k6fduh{cursor:pointer;}",".f13qh94s{display:grid;}",".fk6fouc{font-family:var(--fontFamilyBase);}",".f12nh0o2{grid-template-columns:[content] 1fr [icon] auto [end];}",".f1869bpl{justify-content:space-between;}",".f1o700av{text-align:left;}",".fes3tcz{text-align:right;}",".fly5x3f{width:100%;}",".fxc4j92{color:var(--colorNeutralForeground4);}",".fy9rknc{font-size:var(--fontSizeBase200);}",".figsok6{font-weight:var(--fontWeightRegular);}",".fwrc4pm{line-height:var(--lineHeightBase200);}",[".fye6m5k{padding:3px var(--spacingHorizontalSNudge) 3px calc(var(--spacingHorizontalSNudge) + var(--spacingHorizontalXXS));}",{p:-1}],[".f3cq2dl{padding:3px calc(var(--spacingHorizontalSNudge) + var(--spacingHorizontalXXS)) 3px var(--spacingHorizontalSNudge);}",{p:-1}],".fkhj508{font-size:var(--fontSizeBase300);}",".f1i3iumi{line-height:var(--lineHeightBase300);}",[".f14ev680{padding:5px var(--spacingHorizontalMNudge) 5px calc(var(--spacingHorizontalMNudge) + var(--spacingHorizontalXXS));}",{p:-1}],[".f58uxzw{padding:5px calc(var(--spacingHorizontalMNudge) + var(--spacingHorizontalXXS)) 5px var(--spacingHorizontalMNudge);}",{p:-1}],".f1rjii52{column-gap:var(--spacingHorizontalSNudge);}",".fod5ikn{font-size:var(--fontSizeBase400);}",".faaz57k{line-height:var(--lineHeightBase400);}",[".f139mn7i{padding:7px var(--spacingHorizontalM) 7px calc(var(--spacingHorizontalM) + var(--spacingHorizontalSNudge));}",{p:-1}],[".f1v3q0m{padding:7px calc(var(--spacingHorizontalM) + var(--spacingHorizontalSNudge)) 7px var(--spacingHorizontalM);}",{p:-1}],".fxugw4r{background-color:var(--colorNeutralBackground1);}",[".fhz96rm{border:var(--strokeWidthThin) solid var(--colorNeutralStroke1);}",{p:-2}],".f1c1zstj{border-bottom-color:var(--colorNeutralStrokeAccessible);}",[".f9ez7ne{border-bottom:var(--strokeWidthThin) solid var(--colorNeutralStrokeAccessible);}",{p:-1}],[".fokr779{border-radius:0;}",{p:-1}],[".fs2rfia{border:var(--strokeWidthThin) solid transparent;}",{p:-2}],".f16xq7d1{background-color:var(--colorNeutralBackground3);}",[".fs2rfia{border:var(--strokeWidthThin) solid transparent;}",{p:-2}],".fs4k3qj:not(:focus-within),.fs4k3qj:hover:not(:focus-within){border-top-color:var(--colorPaletteRedBorder2);}",".fcee079:not(:focus-within),.fcee079:hover:not(:focus-within){border-right-color:var(--colorPaletteRedBorder2);}",".fmyw78r:not(:focus-within),.fmyw78r:hover:not(:focus-within){border-left-color:var(--colorPaletteRedBorder2);}",".f1fgmyf4:not(:focus-within),.f1fgmyf4:hover:not(:focus-within){border-bottom-color:var(--colorPaletteRedBorder2);}",".fdrzuqr{cursor:not-allowed;}",".f1jj8ep1{border-top-color:var(--colorNeutralStrokeDisabled);}",".f15xbau{border-right-color:var(--colorNeutralStrokeDisabled);}",".fy0fskl{border-left-color:var(--colorNeutralStrokeDisabled);}",".f4ikngz{border-bottom-color:var(--colorNeutralStrokeDisabled);}",".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}"],w:[".f14a1fxs:focus-within{outline-width:2px;}",".f3e99gv:focus-within{outline-style:solid;}",".fhljsf7:focus-within{outline-color:transparent;}",".fjw5xc1:focus-within::after{transform:scaleX(1);}",".f1xdyd5c:focus-within::after{transition-property:transform;}",".fatpbeo:focus-within::after{transition-duration:var(--durationNormal);}",".fb7uyps:focus-within::after{transition-delay:var(--curveDecelerateMid);}",".f1ibeo51:focus-within:active::after{border-bottom-color:var(--colorCompoundBrandStrokePressed);}"],m:[["@media screen and (prefers-reduced-motion: reduce){.fv8e3ye::after{transition-duration:0.01ms;}}",{m:"screen and (prefers-reduced-motion: reduce)"}],["@media screen and (prefers-reduced-motion: reduce){.ftb5wc6::after{transition-delay:0.01ms;}}",{m:"screen and (prefers-reduced-motion: reduce)"}],["@media screen and (prefers-reduced-motion: reduce){.f1cmft4k:focus-within::after{transition-duration:0.01ms;}}",{m:"screen and (prefers-reduced-motion: reduce)"}],["@media screen and (prefers-reduced-motion: reduce){.f1x58t8o:focus-within::after{transition-delay:0.01ms;}}",{m:"screen and (prefers-reduced-motion: reduce)"}],["@media (forced-colors: active){.fg455y9{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f14g86mu{border-left-color:GrayText;}.f1rvyvqg{border-right-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1cwzwz{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}]],t:["@supports selector(:has(*)){.f132nw8t:has(.fui-Dropdown__clearButton:focus)::after{border-bottom-color:initial;}}","@supports selector(:has(*)){.f1htdosj:has(.fui-Dropdown__clearButton:focus)::after{transform:scaleX(0);}}"],f:[".ftqa4ok:focus{outline-style:none;}"],h:[".fvcxoqz:hover{border-top-color:var(--colorNeutralStroke1Hover);}",".f1ub3y4t:hover{border-right-color:var(--colorNeutralStroke1Hover);}",".f1m52nbi:hover{border-left-color:var(--colorNeutralStroke1Hover);}",".flmw63s:hover{border-bottom-color:var(--colorNeutralStrokeAccessible);}"],a:[".fvs00aa:active{border-top-color:var(--colorNeutralStroke1Pressed);}",".f1assf6x:active{border-right-color:var(--colorNeutralStroke1Pressed);}",".f4ruux4:active{border-left-color:var(--colorNeutralStroke1Pressed);}",".fqhmt4z:active{border-bottom-color:var(--colorNeutralStrokeAccessible);}"]}),lo=Object(io.a)({icon:{B7ck84d:"f1ewtqcl",sj55zd:"fxkbij4",mc9l5x:"ftgm304",Be2twd7:"f1pp30po",Br312pm:"f12w6cgp",Bw0ie65:"f8bv1bt",Bo70h7d:"fvc9v3g"},small:{Be2twd7:"f4ybsrx",Frg6f3:["f1h9en5y","f1xk557c"]},medium:{Be2twd7:"fe5j1ua",Frg6f3:["f1h9en5y","f1xk557c"]},large:{Be2twd7:"f1rt2boy",Frg6f3:["f1t5qyk5","f1ikr372"]},disabled:{sj55zd:"f1s2aq7o"}},{d:[".f1ewtqcl{box-sizing:border-box;}",".fxkbij4{color:var(--colorNeutralStrokeAccessible);}",".ftgm304{display:block;}",".f1pp30po{font-size:var(--fontSizeBase500);}",".f12w6cgp{grid-column-start:icon;}",".f8bv1bt{grid-column-end:end;}",".fvc9v3g svg{display:block;}",".f4ybsrx{font-size:16px;}",".f1h9en5y{margin-left:var(--spacingHorizontalXXS);}",".f1xk557c{margin-right:var(--spacingHorizontalXXS);}",".fe5j1ua{font-size:20px;}",".f1rt2boy{font-size:24px;}",".f1t5qyk5{margin-left:var(--spacingHorizontalSNudge);}",".f1ikr372{margin-right:var(--spacingHorizontalSNudge);}",".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}"]}),co=Object(ao.a)("rticfuj","r1vp6jef",{r:[".rticfuj{align-self:center;background-color:var(--colorTransparentBackground);border:none;cursor:pointer;height:fit-content;margin:0;margin-right:var(--spacingHorizontalMNudge);padding:0;position:relative;}",".rticfuj:focus{outline-style:none;}",".rticfuj:focus-visible{outline-style:none;}",".rticfuj[data-fui-focus-visible]{border-top-color:transparent;border-right-color:transparent;border-bottom-color:transparent;border-left-color:transparent;}",'.rticfuj[data-fui-focus-visible]::after{content:"";position:absolute;pointer-events:none;z-index:1;border:2px solid var(--colorStrokeFocus2);border-radius:var(--borderRadiusMedium);top:calc(2px * -1);right:calc(2px * -1);bottom:calc(2px * -1);left:calc(2px * -1);}',".r1vp6jef{align-self:center;background-color:var(--colorTransparentBackground);border:none;cursor:pointer;height:fit-content;margin:0;margin-left:var(--spacingHorizontalMNudge);padding:0;position:relative;}",".r1vp6jef:focus{outline-style:none;}",".r1vp6jef:focus-visible{outline-style:none;}",".r1vp6jef[data-fui-focus-visible]{border-top-color:transparent;border-left-color:transparent;border-bottom-color:transparent;border-right-color:transparent;}",'.r1vp6jef[data-fui-focus-visible]::after{content:"";position:absolute;pointer-events:none;z-index:1;border:2px solid var(--colorStrokeFocus2);border-radius:var(--borderRadiusMedium);top:calc(2px * -1);left:calc(2px * -1);bottom:calc(2px * -1);right:calc(2px * -1);}'],s:["@media (forced-colors: active){.rticfuj[data-fui-focus-visible]::after{border-top-color:Highlight;border-right-color:Highlight;border-bottom-color:Highlight;border-left-color:Highlight;}}","@media (forced-colors: active){.r1vp6jef[data-fui-focus-visible]::after{border-top-color:Highlight;border-left-color:Highlight;border-bottom-color:Highlight;border-right-color:Highlight;}}"]});var uo=n(1624),po=n(2485),go=n(1283),ho=n(267);const mo=R.memo(R.forwardRef((e,t)=>{const n=oo(e,t),o=Object(ro.a)(n);return(e=>{const{appearance:t,open:n,placeholderVisible:o,showClearButton:r,size:i}=e,a=""+e.button["aria-invalid"]=="true",s=e.button.disabled,l=so(),c=lo(),u=co();e.root.className=Object(Rt.a)("fui-Dropdown",l.root,l[t],!s&&"outline"===t&&l.outlineInteractive,a&&"underline"!==t&&l.invalid,a&&"underline"===t&&l.invalidUnderline,s&&l.disabled,e.root.className),e.button.className=Object(Rt.a)("fui-Dropdown__button",l.button,l[i],o&&l.placeholder,s&&l.disabledText,e.button.className),e.listbox&&(e.listbox.className=Object(Rt.a)("fui-Dropdown__listbox",l.listbox,e.inlinePopup&&l.inlineListbox,!n&&l.listboxCollapsed,e.listbox.className)),e.expandIcon&&(e.expandIcon.className=Object(Rt.a)("fui-Dropdown__expandIcon",c.icon,c[i],s&&c.disabled,r&&l.hidden,e.expandIcon.className)),e.clearButton&&(e.clearButton.className=Object(Rt.a)("fui-Dropdown__clearButton",u,c.icon,c[i],s&&c.disabled,!r&&l.hidden,e.clearButton.className))})(n),((e,t)=>((e,t)=>(Object(vt.a)(e),Object(Ct.a)(e.root,{children:Object(Ct.a)(po.a,{value:t.activeDescendant,children:Object(Ct.a)(ho.a.Provider,{value:t.listbox,children:Object(Ct.b)(go.a.Provider,{value:t.combobox,children:[Object(Ct.b)(e.button,{children:[e.button.children,e.expandIcon&&Object(Ct.a)(e.expandIcon,{})]}),e.clearButton&&Object(Ct.a)(e.clearButton,{}),e.listbox&&(e.inlinePopup?Object(Ct.a)(e.listbox,{}):Object(Ct.a)(uo.a,{mountNode:e.mountNode,children:Object(Ct.a)(e.listbox,{})}))]})})})})))(e,t))(n,o)}));mo.displayName="next/AppSimpleDropdown";const bo=Object(ut.a)({dropdown:{height:"26px",minWidth:"84px",width:"100%"},internalButton:_object_spread({},pt.a.padding("0px","6px")),textSpan:{overflowX:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontSize:"12px",lineHeight:"16px"}}),fo=e=>{const t=bo(),{options:n,onChange:o,selectedKey:r}=e,i=R.useCallback((e,t)=>{if(o&&t.optionValue){const e=parseInt(t.optionValue,10);o(e)}},[o]),a=R.useMemo(()=>n.map(e=>_object_spread_props(_object_spread({},e),{key:e.key.toString()})),[n]),s=r.toString();return R.createElement(mo,{role:"combobox listbox",id:e.id,"aria-label":e.ariaLabel,options:a,onOptionSelect:i,selectedOptions:[s],positioning:"below-end",appearance:"filled-darker",root:{className:t.dropdown},button:{children:R.createElement("span",{className:t.textSpan},(e=>{const t=a.find(t=>t.key===e);return null==t?void 0:t.text})(s)),className:t.internalButton}})},xo="ConditionalFormatting.RuleEditor.TopBottomDropdown";class Eo extends R.Component{render(){return M?R.createElement(fo,{id:xo,options:So,onChange:this.props.onChange,selectedKey:this.props.selectedKey,ariaLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingOperatorDropdownType)}):R.createElement(On,{id:xo,options:So,onChange:this.onChange,selectedKey:this.props.selectedKey,ariaLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingOperatorDropdownType)})}onChange(e,t){t&&this.props.onChange&&this.props.onChange(t.key)}constructor(e){super(e),this.onChange=this.onChange.bind(this)}}const So=[{key:yn.Top,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingTopBottomTop)},{key:yn.Bottom,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingTopBottomBottom)},{key:yn.AboveAverage,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingTopBottomAverageAbove)},{key:yn.BelowAverage,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingTopBottomAverageBelow)},{key:yn.EqualOrAboveAverage,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingTopBottomEqualOrAboveAverage)},{key:yn.EqualOrBelowAverage,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingTopBottomEqualOrBelowAverage)}];var yo=n(1416),Co=n(364),vo=n(2606),Ro=n(2583),ko=n(2644),To=n(2505),_o=n(17);const wo=Object(ut.a)({base:_object_spread_props(_object_spread({},pt.a.padding(0,_o.a.spacingHorizontalMNudge,0,0)),{width:"16px",height:"16px"})}),Do=R.memo(R.forwardRef((e,t)=>{const n=Object(Ro.a)(_object_spread_props(_object_spread({},e),{size:"small"}),t);return(e=>{(e=>{const t=wo();e.iconClassName=Object(Rt.a)(t.base,e.iconClassName)})(e),Object(cn.a)(e),Object(To.a)(e)})(n),Object(ko.a)(n)}));Do.displayName="next/TaskPaneSpinButton";var Po=n(152);const Io=Object(ut.a)({CFSpinButton:{minHeight:"24px",marginRight:"0px"},CFSpinButtonOuterDiv:{flexGrow:1},TaskPaneSpinButtonContainerStyles:{marginRight:"0px"}}),Fo={display:"flex",flexDirection:"row",gap:"4px",justifyContent:"space-between",alignItems:"center"},Bo={flexBasis:"40%",flexGrow:1},Mo={flexBasis:"100%"},jo={display:"flex",flexDirection:"column"},Oo={marginTop:"4px"},Lo=e=>{const t=Io();return R.createElement("div",{style:Fo},R.createElement("div",{style:r()?Bo:void 0},R.createElement(Eo,{selectedKey:e.getTopBottomOption(e.ruleInputData.getCommandType()),onChange:e.onTopBottomChange})),e.ruleInputData.isAverageRule()?R.createElement(R.Fragment,null):R.createElement(R.Fragment,null,function(){const n=parseInt(e.ruleInputData.getRuleInputValue().toString(),10),o=e.ruleInputData.getError();return R.createElement("div",{className:t.CFSpinButtonOuterDiv},R.createElement(_e,{errorMessage:o||"",childComponentId:No},R.createElement(Do,{appearance:"filled-darker",id:No,className:t.CFSpinButton,containerClassName:t.TaskPaneSpinButtonContainerStyles,value:n,hideLabel:!0,onExecute:t=>e.onInputValueChanged(t.value.toString()),inputMode:"numeric",input:{id:e.isNewRule?pe.getRequiredFirstPaneElementId():"TopBottomValueInput"},onInput:e.onInput,"aria-labelledby":xo+"-option "+Te(No),incrementAriaLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingIncreaseSpinButton),decrementAriaLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingDecreaseSpinButton),incrementButtonIcon:Po.a.spinButtonUpChevron,decrementButtonIcon:Po.a.spinButtonDownChevron,type:"AppSpinButtonProps",label:"",numberFormatInfo:{negativeSign:"-",numberDecimalDigits:0,numberDecimalSeparator:".",numberGroupSizes:[3],numberGroupSeparator:",",numberNegativePattern:1},unitType:"Number",validUnits:[{unitType:"Number",unitPlaceholder:"{0}",minValue:e.ruleInputData.getMinValue().valueOf(),maxValue:e.ruleInputData.getMaxValue().valueOf(),step:1}]})))}(),R.createElement("div",{style:r()?Bo:void 0},R.createElement(fo,{id:"TopBottomRulePercent",options:Ao,selectedKey:o(e.ruleInputData.getCommandType()),ariaLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingTopBottomPercent),onChange:n}))));function n(t){t===Cn.Percent?e.onPercentChange(void 0,!0):t===Cn.Values?e.onPercentChange(void 0,!1):i.a.sendTraceTag(507339681,a.a.msoulscat_ES_EWAJS,s.a.Error,"TopBottomRuleV2.onPercentChange: Unsupported Percent Option.")}function o(e){switch(e){case 9:case 11:return Cn.Percent;case 8:case 10:return Cn.Values;case 12:case 13:case 75:case 76:default:throw Error("getTopBottomOption: Unsupported Command Type")}}function r(){if(!M)return!1;switch(e.getTopBottomOption(e.ruleInputData.getCommandType())){case yn.Top:case yn.Bottom:return!0;case yn.AboveAverage:case yn.BelowAverage:case yn.EqualOrAboveAverage:case yn.EqualOrBelowAverage:return!1}}},Ao=[{key:Cn.Percent,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingTopBottomRuleComboboxPercent)},{key:Cn.Values,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingTopBottomRuleComboboxValues)}],No="TopBottomSpinButton";class Wo extends R.Component{render(){return M?R.createElement(Lo,_object_spread_props(_object_spread({},this.props),{getTopBottomOption:this.getTopBottomOption,onCommandTypeChange:this.onCommandTypeChange,onTopBottomChange:this.onTopBottomChange,onPercentChange:this.onPercentChange,onInputValueChanged:this.onInputValueChanged,onInput:this.onInput})):R.createElement("div",{style:{display:"flex",flexDirection:"column"}},R.createElement("div",{style:{display:"flex",flexDirection:"row",marginTop:"4px",flexWrap:"wrap"}},this.getTopBottomDropdown(),this.getTopBottomInputContent()))}getTopBottomDropdown(){return R.createElement("div",{style:{minWidth:this.topBottomDropdownMinWidth}},R.createElement(Eo,{selectedKey:this.getTopBottomOption(this.props.ruleInputData.getCommandType()),onChange:this.onTopBottomChange}))}getTopBottomInputContent(){return this.props.ruleInputData.isAverageRule()?R.createElement("div",null):R.createElement(R.Fragment,null,this.getTopBottomSpinButton(),this.getTopBottomPercentCheckbox())}getTopBottomPercentCheckbox(){const e={root:{marginLeft:this.inputElementsMarginLeft,marginTop:this.checkBoxMarginTop},checkbox:{borderRadius:"0%"},label:{fontSize:"12px"}};return R.createElement(yo.a,{styles:e,checked:this.props.ruleInputData.isPercentRule(),onChange:this.onPercentChange,label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingTopBottomPercent),theme:Object(Co.a)({semanticColors:{inputBorderHovered:"#217346",inputBackgroundChecked:"#217346"},palette:{themeDark:"#217346"}})})}getTopBottomSpinButton(){const e=this.props.ruleInputData.isValid(),t=G(e),n={width:this.spinButtonMinWidth,marginLeft:this.inputElementsMarginLeft},o={root:{minWidth:this.spinButtonMinWidth,height:this.spinButtonHight},input:{fontSize:"12px",minWidth:"0px"},spinButtonWrapper:{selectors:{"::after":t,":hover::after":t,":focus::after":t,"&&":{selectors:{"::after":{borderColor:U(e)}}}}}},r=this.props.ruleInputData.getRuleInputValue().toString(),i=this.props.ruleInputData.getError();return R.createElement("div",{style:n},R.createElement(_e,{errorMessage:i||"",childComponentId:No},R.createElement(vo.a,{id:No,style:{minWidth:this.spinButtonMinWidth,height:this.spinButtonHight},styles:o,value:r,min:this.props.ruleInputData.getMinValue(),max:this.props.ruleInputData.getMaxValue(),onIncrement:this.onIncrement,onDecrement:this.onDecrement,onInput:this.onInput,theme:Object(Co.a)({semanticColors:{inputBorderHovered:"#217346",inputBackgroundChecked:"#217346"},palette:{themeDark:"#217346"}}),inputProps:{id:this.props.isNewRule?pe.getRequiredFirstPaneElementId():"TopBottomValueInput"},"aria-labelledby":xo+"-option "+Te(No),incrementButtonAriaLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingIncreaseSpinButton),decrementButtonAriaLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingDecreaseSpinButton)})))}onInput(e){this.onInputValueChanged(e.target.value)}onInputValueChanged(e){const t=this.props.ruleInputData;t.setRuleInputValue(e),t.setWasChanged(),this.props.onInputChange(t)}onPercentChange(e,t){if(null!=t){const e=this.props.ruleInputData;e.isTopRule()?this.onCommandTypeChange(t?9:8):e.isBottomRule()&&this.onCommandTypeChange(t?11:10)}}onTopBottomChange(e){const t=this.props.ruleInputData;this.onCommandTypeChange(this.getCommandType(e,t.isPercentRule()))}onCommandTypeChange(e){const t=this.props.ruleInputData,n=new Rn(e,t.getRuleInputValue());n.setWasChanged(),this.props.onInputChange(n)}getCommandType(e,t){switch(e){case yn.Top:return t?9:8;case yn.Bottom:return t?11:10;case yn.AboveAverage:return 12;case yn.BelowAverage:return 13;case yn.EqualOrAboveAverage:return 75;case yn.EqualOrBelowAverage:return 76}}getTopBottomOption(e){switch(e){case 8:case 9:return yn.Top;case 10:case 11:return yn.Bottom;case 12:return yn.AboveAverage;case 13:return yn.BelowAverage;case 75:return yn.EqualOrAboveAverage;case 76:return yn.EqualOrBelowAverage;default:throw Error("getTopBottomOption: Unsupported Command Type")}}constructor(e){super(e),this.inputElementsMarginLeft="5px",this.spinButtonHight="28px",this.spinButtonMinWidth="70px",this.checkBoxMarginTop="4px",this.topBottomDropdownMinWidth="130px",this.onIncrement=e=>{const t=parseInt(e,10);this.onInputValueChanged(isNaN(t)?this.props.ruleInputData.getMinValue().toString():(t+1).toString()),Ge(ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingSpinButtonValueIncreased))},this.onDecrement=e=>{const t=parseInt(e,10);this.onInputValueChanged(isNaN(t)?this.props.ruleInputData.getMinValue().toString():(t-1).toString()),Ge(ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingSpinButtonValueDecreased))},this.onTopBottomChange=this.onTopBottomChange.bind(this),this.onPercentChange=this.onPercentChange.bind(this),this.onIncrement=this.onIncrement.bind(this),this.onDecrement=this.onDecrement.bind(this),this.onInput=this.onInput.bind(this),this.onInputValueChanged=this.onInputValueChanged.bind(this),this.getTopBottomInputContent=this.getTopBottomInputContent.bind(this)}}var zo=n(1211);class Ho extends R.Component{render(){return R.createElement(On,{id:"ConditionalFormatting.RuleEditor.QuickFormatDropdown",label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormatWithMenuPrefix),options:this.createFormatOptionsList(),onChange:this.onChange,selectedKey:this.props.selectedFormat.getQuickFormat()})}onChange(e,t){t&&this.props.onChange&&this.props.onChange(t.key)}createFormatOptionsList(){const e=[];et.forEach(t=>{e.push({key:t.key,text:t.text,data:{item:Vo(t.customFormat)}})});const t=this.props.selectedFormat.getCustomFormat();if(t){const n=6,o=tt(t);-1!==o?e[o].key=n:e.push({key:"customFormatDivider",text:"-",itemType:zo.a.Divider},{key:n,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingCustomFormatText)})}return e}constructor(e){super(e),this.onChange=this.onChange.bind(this)}}const Vo=e=>R.createElement(Ve,{rule:{ruleType:3,customFormat:e}});var Uo=n(809),Go=n(318),qo=n(248),Qo=n(2611),Ko=n(719),Jo=n(20),Yo=n(151);const Zo={root:{backgroundColor:Yo.a.gray30,border:"none",outline:"none",height:"30px",minWidth:"32px",padding:"5px 1px 5px 1px",cursor:"default",[F.m]:{margin:"0px 2px 0px 2px","svg > path.OfficeIconColors_HighContrast":{fill:"ButtonText !important"},":focus, :focus::after, :active":{borderStyle:"dashed","svg > path.OfficeIconColors_HighContrast":{fill:"ButtonText"}}}},rootHovered:{backgroundColor:Yo.a.gray40,[F.m]:{backgroundColor:"Highlight",color:"HighlightText","svg > path.OfficeIconColors_HighContrast":{fill:"HighlightText !important"},outline:"2px dashed ButtonText !important"}}},$o={root:{border:"none",outline:"none",cursor:"default",height:"35px",width:"100%",fontSize:"12px",padding:"0px 4px 0px 0px",[F.m]:{"svg > path.OfficeIconColors_HighContrast":{fill:"ButtonText !important"},":hover, :active":{backgroundColor:"Highlight !important",color:"HighlightText !important",fill:"HighlightText !important","svg > path.OfficeIconColors_HighContrast":{fill:"HighlightText !important"}}}},rootFocused:{[F.m]:{background:"none !important",border:"2px dashed Highlight !important","svg > path.OfficeIconColors_HighContrast":{fill:"ButtonText !important"}}},textContainer:{textAlign:"left"},label:{[F.m]:{":hover, :focus, :active, :focus::after":{background:"HighlightText !important",color:"Highlight"}}}},Xo={root:{paddingLeft:"5px",paddingRight:"5px",overflow:"hidden"},header:{color:Yo.a.gray130,padding:"0px",height:"25px"}},er={colorCell:{height:"24px",width:"24px"},svg:{height:"16px",width:"16px"}},tr=Object(Jo.c)(e=>({root:{fill:e,height:"18px",width:"18px"}})),nr=Object(Jo.c)(e=>({root:{fontSize:"12px",height:"30px",width:"100%",border:"none",backgroundColor:e?Yo.a.gray20:void 0,[F.m]:{background:e?"Highlight":void 0,color:e?"HighlightText !important":void 0,"svg > path.OfficeIconColors_HighContrast":{fill:e?"HighlightText !important":void 0}}},icon:{height:"16px",width:"16px"}})),or={root:{[F.m]:{"svg > path.OfficeIconColors_HighContrast":{fill:"HighlightText !important"}}}},rr={width:"12px",height:"12px",lineHeight:"12px"},ir={width:"8px",height:"8px",lineHeight:"5px"};let ar=null,sr=null;class lr extends R.Component{componentWillUnmount(){ar&&clearTimeout(ar),sr&&clearTimeout(sr)}render(){let e;e=this.props.isSubMenuButton?{text:this.props.buttonLabel,styles:$o,menuIconProps:this.caretRightIconProps,componentRef:this.ref,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave}:{styles:Object(F.I)(Zo,this.props.mainButtonStyles),menuIconProps:this.caretDownIconProps,split:!0};const t=R.createElement(Uo.a,_object_spread({"aria-label":this.getButtonAriaLabel(),role:"button",iconProps:{iconName:this.props.buttonIconName,styles:Object(F.I)(tr(this.props.selectedColor||this.props.defaultColor),this.props.mainButtonIconStyles)},menuProps:this.state.menuProps},e));return this.props.isSubMenuButton?t:R.createElement(Ee.a,{content:this.props.buttonLabel,directionalHint:Se.a.bottomCenter},t)}prepareMenuSections(){const e=this.props.colorPickerController.getColorPickerButtonMenuProps(this.props.modifiers);if(!e||!e.sections)return i.a.sendTraceTag(545116672,a.a.msoulscat_ES_EWAJS,s.a.Error,"ColorPickerButton: getColorPickerButtonMenuProps returned null."),[];if(this.menuSections=e.sections||[],this.menuSections.length<1)return sr=setTimeout(this.updateMenuSections,this.retryDelay),[];const t=[];return this.menuSections.forEach((e,n)=>{t.push({key:"ColorPickerButtonSection"+n,itemType:Go.a.Section,sectionProps:{topDivider:0!==n,bottomDivider:n!==this.menuSections.length-1,title:e.title,items:[{key:"ColorPickerButtonSectionItem"+n,data:n,onRender:this.onRenderMenuSectionItem}]}})}),t}updateMenuSections(){const e=this.prepareMenuSections();e&&e.length>0&&this.setState({menuProps:this.buildMenuProps(e)})}buildMenuProps(e){return{items:e,styles:Xo,focusZoneProps:{direction:qo.a.bidirectional}}}onRenderMenuSectionItem(e,t){this.dismissMenu=t;const n=this.menuSections[e.data];if(!n)return i.a.sendTraceTag(545116673,a.a.msoulscat_ES_EWAJS,s.a.Error,"ColorPickerButton.onRenderMenuSectionItem: menuSection is null."),R.createElement("div",null);switch(n.type){case 1:if(n.colorSwatchProps)return this.renderColorSwatch(n.colorSwatchProps);break;case 2:if(n.buttonProps)return this.renderMenuButton(n.buttonProps)}return i.a.sendTraceTag(545116674,a.a.msoulscat_ES_EWAJS,s.a.Error,"ColorPickerButton.onRenderMenuSectionItem: Unknown menu section type."),R.createElement("div",null)}selectColor(e,t){this.props.onChange(e.color||null,t),this.dismissMenu()}selectThemeColor(e){this.selectColor(e,this.props.colorPickerController.getThemeColor(e.color)||void 0)}selectThemeColorAndNotify(e){this.notifyColorUsed(e),this.selectThemeColor(e)}selectColorAndNotify(e){this.notifyColorUsed(e),this.selectColor(e)}notifyColorUsed(e){e.color&&this.props.colorPickerController.onColorUsed(e.color)}renderColorSwatch(e){var t;let n=this.selectColor;return e.isThemeColorSection?n=e.notifyOnColorUsed?this.selectThemeColorAndNotify:this.selectThemeColor:e.notifyOnColorUsed&&(n=this.selectColorAndNotify),R.createElement(Qo.a,{type:"AppColorPickerProps",columnCount:10,id:"ColorPickerButton",colorCells:e.colors,selectedId:(null===(t=this.props.selectedColor)||void 0===t?void 0:t.toLowerCase())||void 0,cellStyles:()=>er,onExecute:n})}renderMenuButton(e){let t=void 0,n=void 0,o=!1;switch(e.type){case 1:t=this.showMoreColorsDialog,n=d.a.MoreColors_20;break;case 3:t=this.changeToDefaultColor,n=d.a.Automatic_16,o=null==this.props.selectedColor;break;case 2:t=this.changeToDefaultColor,n=d.a.SwatchNoColorSquare_20,o=null==this.props.selectedColor;break;case 5:t=this.launchEyedropper,n=d.a.EyedropperFillColor_20;break;case 4:default:return i.a.sendTraceTag(545116675,a.a.msoulscat_ES_EWAJS,s.a.Error,"ColorPickerButton.renderMenuButton: Unknown button type."),R.createElement("div",null)}return R.createElement(Ko.a,{type:"AppButtonProps",label:e.label,id:"ColorPickerSectionButton",icon:n,onExecute:t,styles:nr(o)})}changeToDefaultColor(){this.props.onChange(null),this.dismissMenu()}showMoreColorsDialog(){this.dismissMenu(),this.props.colorPickerController.showMoreColorsDialog(this.props.selectedColor||"#FFFFFF",(e,t)=>{e&&this.props.onChange("#"+t)})}launchEyedropper(){this.props.colorPickerController.launchEyedropper((e,t)=>{e&&this.props.onChange("#"+t)}),this.dismissMenu()}onMouseEnter(){ar=setTimeout(this.openColorSubMenu,this.hoverDelay)}onMouseLeave(){ar&&clearTimeout(ar)}openColorSubMenu(){var e;null===(e=this.ref.current)||void 0===e||e.openMenu(!1,!1),this.props.onSubMenuOpened&&this.props.onSubMenuOpened()}getButtonAriaLabel(){let e="";return this.props.selectedColor?e=this.findColorLabel(this.props.selectedColor):("#000000"===this.props.defaultColor&&(e=this.findButtonLabel(3)),"transparent"===this.props.defaultColor&&(e=this.findButtonLabel(2))),this.props.buttonLabel+e}findButtonLabel(e){if(this.menuSections)for(let o=0;o<this.menuSections.length;o++){var t;const r=this.menuSections[o];var n;if(2===r.type&&(null===(t=r.buttonProps)||void 0===t?void 0:t.type)===e)return(null===(n=r.buttonProps)||void 0===n?void 0:n.label)||""}return""}constructor(e){super(e),this.menuSections=[],this.dismissMenu=()=>{},this.ref=R.createRef(),this.hoverDelay=250,this.retryDelay=500,this.caretDownIconProps={iconName:be.a.CommonControlChevronDown_12,style:ir},this.caretRightIconProps={styles:or,iconName:Object(ue.a)()?c.a.CommonControlChevronLeft_12:c.a.CommonControlChevronRight_12,style:rr},this.findColorLabel=Object(Jo.c)(e=>{if(e&&this.menuSections)for(let n=0;n<this.menuSections.length;n++){var t;const o=null===(t=this.menuSections[n].colorSwatchProps)||void 0===t?void 0:t.colors;if(o)for(let t=0;t<o.length;t++)if(e===o[t].color&&o[t].label)return o[t].label}return e}),this.onRenderMenuSectionItem=this.onRenderMenuSectionItem.bind(this),this.renderColorSwatch=this.renderColorSwatch.bind(this),this.renderMenuButton=this.renderMenuButton.bind(this),this.changeToDefaultColor=this.changeToDefaultColor.bind(this),this.showMoreColorsDialog=this.showMoreColorsDialog.bind(this),this.launchEyedropper=this.launchEyedropper.bind(this),this.notifyColorUsed=this.notifyColorUsed.bind(this),this.selectColorAndNotify=this.selectColorAndNotify.bind(this),this.selectThemeColorAndNotify=this.selectThemeColorAndNotify.bind(this),this.selectColor=this.selectColor.bind(this),this.selectThemeColor=this.selectThemeColor.bind(this),this.onMouseEnter=this.onMouseEnter.bind(this),this.onMouseLeave=this.onMouseLeave.bind(this),this.openColorSubMenu=this.openColorSubMenu.bind(this),this.prepareMenuSections=this.prepareMenuSections.bind(this),this.updateMenuSections=this.updateMenuSections.bind(this),this.buildMenuProps=this.buildMenuProps.bind(this),this.getButtonAriaLabel=this.getButtonAriaLabel.bind(this),this.findColorLabel=this.findColorLabel.bind(this),this.findButtonLabel=this.findButtonLabel.bind(this);const t=this.prepareMenuSections();this.state={menuProps:this.buildMenuProps(t)}}}const cr=R.memo(lr);var ur,dr=n(2135),pr=n(353),gr=n(4),hr=n.n(gr);!function(e){e[e.NoBorder=1]="NoBorder",e[e.BottomBorder=2]="BottomBorder",e[e.TopBorder=3]="TopBorder",e[e.LeftBorder=4]="LeftBorder",e[e.RightBorder=5]="RightBorder",e[e.AllBorders=6]="AllBorders",e[e.OutsideBorders=7]="OutsideBorders",e[e.ThickOutsideBorders=8]="ThickOutsideBorders",e[e.BottomDoubleBorders=9]="BottomDoubleBorders",e[e.ThickBottomBorders=10]="ThickBottomBorders",e[e.TopAndBottomBorders=11]="TopAndBottomBorders",e[e.TopAndThickBottomBorders=12]="TopAndThickBottomBorders",e[e.TopAndDoubleBottomBorders=13]="TopAndDoubleBottomBorders",e[e.InsideBorders=14]="InsideBorders",e[e.InsideHorizontalBorders=15]="InsideHorizontalBorders",e[e.InsideVerticalBorders=16]="InsideVerticalBorders"}(ur||(ur={}));const mr={root:{width:"20px",height:"20px",padding:"2px"}},br={root:{height:"40px",width:"40px"}},fr=new Map;fr.set(ur.NoBorder,{type:"AppGalleryButtonProps",id:"NoBorder",index:ur.NoBorder,fullIconProps:{iconName:M?be.a.NoBorder_16:hr.a.NoBorder_20,styles:mr},title:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NoBorder),style:br}),fr.set(ur.BottomBorder,{type:"AppGalleryButtonProps",id:"BottomBorder",index:ur.BottomBorder,fullIconProps:{iconName:M?be.a.BottomBorder_16:g.a.BottomBorder_20,styles:mr},title:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.BottomBorder),style:br}),fr.set(ur.TopBorder,{type:"AppGalleryButtonProps",id:"TopBorder",index:ur.TopBorder,fullIconProps:{iconName:M?be.a.TopBorder_16:hr.a.TopBorder_20,styles:mr},title:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.TopBorder),style:br}),fr.set(ur.LeftBorder,{type:"AppGalleryButtonProps",id:"LeftBorder",index:ur.LeftBorder,fullIconProps:{iconName:M?be.a.LeftBorder_16:hr.a.LeftBorder_20,styles:mr},title:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.LeftBorder),style:br}),fr.set(ur.RightBorder,{type:"AppGalleryButtonProps",id:"RightBorder",index:ur.RightBorder,fullIconProps:{iconName:M?be.a.RightBorder_16:hr.a.RightBorder_20,styles:mr},title:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.RightBorder),style:br}),fr.set(ur.AllBorders,{type:"AppGalleryButtonProps",id:"AllBorders",index:ur.AllBorders,fullIconProps:{iconName:M?be.a.AllBorders_16:hr.a.AllBorders_20,styles:mr},title:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.AllBorders),style:br}),fr.set(ur.OutsideBorders,{type:"AppGalleryButtonProps",id:"OutsideBorders",index:ur.OutsideBorders,fullIconProps:{iconName:M?be.a.BoxBorder_16:hr.a.BoxBorder_20,styles:mr},title:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.OutsideBorders),style:br}),fr.set(ur.ThickOutsideBorders,{type:"AppGalleryButtonProps",id:"ThickOutsideBorders",index:ur.ThickOutsideBorders,fullIconProps:{iconName:M?be.a.ThickOutsideBorder_16:hr.a.ThickOutsideBorder_20,styles:mr},title:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ThickOutsideBorders),style:br}),fr.set(ur.BottomDoubleBorders,{type:"AppGalleryButtonProps",id:"BottomDoubleBorders",index:ur.BottomDoubleBorders,fullIconProps:{iconName:M?be.a.DoubleBottomBorder_16:hr.a.DoubleBottomBorder_20,styles:mr},title:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.BottomDoubleBorders),style:br}),fr.set(ur.ThickBottomBorders,{type:"AppGalleryButtonProps",id:"ThickBottomBorders",index:ur.ThickBottomBorders,fullIconProps:{iconName:M?be.a.ThickBottomBorder_16:hr.a.ThickBottomBorder_20,styles:mr},title:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ThickBottomBorders),style:br}),fr.set(ur.TopAndBottomBorders,{type:"AppGalleryButtonProps",id:"TopAndBottomBorders",index:ur.TopAndBottomBorders,fullIconProps:{iconName:M?be.a.TopAndBottomBorder_16:hr.a.TopAndBottomBorder_20,styles:mr},title:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.TopAndBottomBorders),style:br}),fr.set(ur.TopAndThickBottomBorders,{type:"AppGalleryButtonProps",id:"TopAndThickBottomBorders",index:ur.TopAndThickBottomBorders,fullIconProps:{iconName:M?be.a.TopAndThickBottomBorder_16:hr.a.TopAndThickBottomBorder_20,styles:mr},title:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.TopAndThickBottomBorders),style:br}),fr.set(ur.TopAndDoubleBottomBorders,{type:"AppGalleryButtonProps",id:"TopAndDoubleBottomBorders",index:ur.TopAndDoubleBottomBorders,fullIconProps:{iconName:M?be.a.TopAndDoubleBottomBorder_16:hr.a.TopAndDoubleBottomBorder_20,styles:mr},title:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.TopAndDoubleBottomBorders),style:br}),fr.set(ur.InsideBorders,{type:"AppGalleryButtonProps",id:"InsideBorders",index:ur.InsideBorders,fullIconProps:{iconName:M?be.a.InsideBorder_16:hr.a.InsideBorder_20,styles:mr},title:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.InsideBorders),style:br}),fr.set(ur.InsideHorizontalBorders,{type:"AppGalleryButtonProps",id:"InsideHorizontalBorders",index:ur.InsideHorizontalBorders,fullIconProps:{iconName:M?be.a.InsideHorizontalBorder_16:hr.a.InsideHorizontalBorder_20,styles:mr},title:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.InsideHorizontalBorder),style:br}),fr.set(ur.InsideVerticalBorders,{type:"AppGalleryButtonProps",id:"InsideVerticalBorders",index:ur.InsideVerticalBorders,fullIconProps:{iconName:M?be.a.InsideVerticalBorder_16:hr.a.InsideVerticalBorder_20,styles:mr},title:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.InsideVerticalBorder),style:br});var xr=n(2515),Er=n(2142);const Sr={root:{paddingLeft:"5px",paddingRight:"5px"},header:{color:Yo.a.gray130,padding:"0px",height:"25px"}},yr={backgroundColor:"Highlight",color:"HighlightText"},Cr={root:{backgroundColor:Yo.a.gray30,border:"none",outline:"none",height:"30px",minWidth:"32px",padding:"5px 1px 5px 1px",cursor:"default"},rootHovered:{backgroundColor:Yo.a.gray40,[F.m]:yr},splitButtonContainerHovered:{backgroundColor:Yo.a.gray40,[F.m]:yr},splitButtonMenuButton:{border:"none",outline:"none",width:"8px",cursor:"default",":hover":{backgroundColor:Yo.a.gray40,[F.m]:yr}},splitButtonDivider:{width:"0px"},splitButtonContainer:{":hover, :active, :focus, :focus::after":{[F.m]:{border:"2px dashed ButtonText !important",outline:"none !important"}}}},vr={width:"8px",height:"8px",lineHeight:"5px",padding:"0px"},Rr={root:{margin:"0px"}},kr={width:"12px",height:"12px",lineHeight:"12px"},Tr={root:{cursor:"default"},label:{fontSize:"12px",marginLeft:"10px"}},_r=Object(Jo.c)(e=>({root:{border:"none",backgroundColor:e?Yo.a.gray20:void 0,[F.m]:{background:e?"Highlight":void 0,fill:e?"HighlightText":void 0,svg:{color:e?"HighlightText !important":void 0,fill:e?"HighlightText !important":void 0}},margin:"4px",padding:"0px"},icon:{width:"120px",height:"20px"}}));var wr=n(2465),Dr=n(2249),Pr=n(2239);const Ir=R.memo(R.forwardRef((e,t)=>{const n=Object(Pr.a)(e,t);return Object(wr.b)(n),Object(Dr.a)(n)}));Ir.displayName="next/AppSplitButton";var Fr=n(1425),Br=n(2596),Mr=n(2154);class jr extends R.Component{render(){var e;const t=fr.get(this.state.currentBorderOption),n=`${ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.Borders)} ${null!==(e=null==t?void 0:t.title)&&void 0!==e?e:""}`,o=fr.get(this.state.currentBorderOption).fullIconProps;return this.props.renderAsV9SplitButton?R.createElement(Ir,_object_spread({id:"BorderButton",label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.Borders),"aria-label":n,icon:o.iconName,toggleable:!1,hideLabel:!0,controlInMenuRendererFunction:this.menuRendererFunction,downChevronIcon:Po.a.downChevron.icon8,menu:ft.a.always(void 0,{defaultProps:this.menuProps,elementType:Mr.a}),onExecute:this.onDefaultBorderOptionSelected},this.props.overrideAppButtonProps)):R.createElement(Ee.a,{content:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.Borders),directionalHint:Se.a.bottomCenter},R.createElement(pr.a,{split:!0,"aria-label":n,"aria-roledescription":ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SplitButtonRoleDescription),styles:Object(F.I)(Cr,this.props.mainButtonStyles),iconProps:_object_spread_props(_object_spread({},o),{styles:Object(F.I)(o.styles,this.props.mainButtonIconStyles)}),menuProps:this.menuProps,menuIconProps:this.caretDownIconProps,onClick:this.onDefaultBorderOptionSelected}))}onRenderBorderOptionsSection(e,t){var n;return this.dismissMenu=t,R.createElement(xr.a,{columns:5,type:"AppIconFullGalleryProps",defaultWidth:212,onGalleryButtonExecute:this.onBorderOptionSelectedFromMenu,id:"BorderMenuBorderOptionsGallery",getGalleryButtonComponent:Er.a,gallerySections:this.gallerySections,selectedId:null===(n=fr.get(this.state.currentBorderOption))||void 0===n?void 0:n.id})}onRenderLineStyleIcon(e){const t=this.state.lineStyle?e.key===this.state.lineStyle:0===e.itemIndex;return R.createElement(Ko.a,{id:e.key,type:"AppButtonProps",label:e.iconTitle,hideLabel:!0,icon:e.iconName,onExecute:this.onLineStyleSelected,styles:_r(t)})}onBorderOptionSelectedFromMenu(e){this.onBorderOptionSelected(this.gallerySections[0].galleryButtons[e.galleryButton.index].index)}onBorderOptionSelected(e){this.dismissMenu(),this.setState({currentBorderOption:e}),this.props.onBorderOptionSelected(e,this.state.lineStyle,this.state.color,this.state.themeColor)}onDefaultBorderOptionSelected(){this.onBorderOptionSelected(this.state.currentBorderOption)}onColorChanged(e,t){this.setState({color:e||this.defaultBorderColor,themeColor:t}),this.dismissMenu()}onLineStyleSelected(e){this.setState({lineStyle:e.id}),this.dismissMenu()}renderColorMenuButton(){return R.createElement(lr,{buttonIconName:d.a.TableBorderColorSplitDropdown_20,buttonLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.BorderColor),colorPickerController:this.props.colorPickerController,modifiers:{automaticColor:!0,clearColor:!1,highlightWhen:!1,moreColors:!0,eyedropper:!0},selectedColor:this.state.color,defaultColor:this.defaultBorderColor,onChange:this.onColorChanged,isSubMenuButton:!0,onSubMenuOpened:this.onColorMenuOpened})}getSupportedBorderOptions(e){const t=[];return fr.forEach((n,o)=>{e&&-1===e.indexOf(o)||t.push(n)}),t}getSupportedLineStyles(){if(!this.props.borderMenuController)return[];const e=this.props.borderMenuController.getBorderLineStyleProps();if(!e)return i.a.sendTraceTag(540645599,a.a.msoulscat_ES_EWAJS,s.a.Error,"BorderMenuButton: getBorderLineStyleProps returned null."),[];const t=[];for(let n=0;n<e.length;n++)null!=this.props.supportedLineStyles&&-1===this.props.supportedLineStyles.indexOf(e[n].key)||t.push({itemIndex:t.length,key:e[n].key,iconTitle:e[n].title||void 0,iconName:e[n].iconName,onRender:this.onRenderLineStyleIcon});return t}onColorMenuOpened(){var e;null===(e=this.lineStyleMenuRef.current)||void 0===e||e.dismissSubMenu()}constructor(e){super(e),this.dismissMenu=()=>{},this.defaultBorderColor="#000000",this.lineStyleMenuRef=R.createRef(),this.caretDownIconProps={iconName:be.a.CommonControlChevronDown_12,style:vr};const t=M?ur.BottomBorder:ur.NoBorder;this.state={currentBorderOption:e.defaultBorderOption||t,color:e.defaultColor||this.defaultBorderColor,themeColor:void 0,lineStyle:null},this.onRenderBorderOptionsSection=this.onRenderBorderOptionsSection.bind(this),this.onBorderOptionSelectedFromMenu=this.onBorderOptionSelectedFromMenu.bind(this),this.onDefaultBorderOptionSelected=this.onDefaultBorderOptionSelected.bind(this),this.onBorderOptionSelected=this.onBorderOptionSelected.bind(this),this.renderColorMenuButton=this.renderColorMenuButton.bind(this),this.onColorChanged=this.onColorChanged.bind(this),this.onRenderLineStyleIcon=this.onRenderLineStyleIcon.bind(this),this.onLineStyleSelected=this.onLineStyleSelected.bind(this),this.onColorMenuOpened=this.onColorMenuOpened.bind(this),this.getSupportedLineStyles=this.getSupportedLineStyles.bind(this),this.menuRendererFunction=Object(Br.a)(Po.a,Object(Fr.a)());const n=[];n.push({key:"BorderMenuBorderOptionsSection",itemType:Go.a.Section,sectionProps:{bottomDivider:!0,items:[{key:"BorderMenuBorderOptionsSection",onRender:this.onRenderBorderOptionsSection}]}}),n.push({key:"BorderMenuBorderColorSection",itemType:Go.a.Section,sectionProps:{items:[{key:"BorderMenuBorderColorSectionItem",onRender:this.renderColorMenuButton}]}});const o=this.getSupportedLineStyles();o&&o.length>0&&n.push({key:"BorderMenuBorderLineStyleSection",itemType:Go.a.Section,sectionProps:{items:[{key:"BorderMenuBorderLineStyleSection",iconProps:{iconName:d.a.DashStyle_16,styles:Rr},text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.BorderLineStyle),role:"button",subMenuProps:{items:o,calloutProps:{calloutWidth:128}},submenuIconProps:{iconName:Object(ue.a)()?c.a.CommonControlChevronLeft_12:c.a.CommonControlChevronRight_12,style:kr},itemProps:{styles:Tr},componentRef:this.lineStyleMenuRef}]}}),this.menuProps={items:n,styles:Sr,focusZoneProps:{direction:qo.a.bidirectional}},this.gallerySections=[{galleryButtons:this.getSupportedBorderOptions(e.supportedBorderOptions)}]}}const Or=R.memo(jr);var Lr=n(2130),Ar=n(2132);const Nr=Object(ut.a)({base:{minWidth:"32px"}}),Wr=R.memo(R.forwardRef((e,t)=>{const n=Object(Lr.a)(_object_spread_props(_object_spread({},e),{dataAutomationType:"TaskPaneToggleButton"}),t);return(e=>{const t=Nr();e.root.className=Object(Rt.a)(t.base,e.root.className),Object(cn.a)(e),Object(cn.b)(e.icon,e),Object(Ar.a)(e)})(n),Object(an.a)(n)}));Wr.displayName="next/TaskPaneToggleButton";const zr=Object(ut.a)({flexContainerBackLabel:{display:"flex",flexDirection:"row",alignContent:"flex-start",alignItems:"center"},backButton:_object_spread_props(_object_spread({width:"16px",minWidth:"16px",height:"16px"},pt.a.padding("0px")),{marginBottom:"12px",marginRight:"8px"}),toggleButton:_object_spread_props(_object_spread({height:"27px",width:"32px"},pt.a.padding("5px","6px","4px","8px")),{display:"flex",justifyContent:"center",alignItems:"center"}),styleControlsFlex:{display:"flex",flexDirection:"row",alignItems:"flex-start",justifyContent:"space-between","> .ms-layer":{display:"none"}},rulePreviewWrapper:_object_spread({width:"100%",boxSizing:"border-box",height:"auto"},pt.a.padding("0px","1px")),splitButtonRoot:{height:"27px",width:"34px"},splitButtonPrimaryButton:_object_spread_props(_object_spread({height:"100%",width:"22px",minWidth:"22px"},pt.a.padding("3px","2px","3px","3px"),pt.a.borderRight("0px")),{display:"flex",justifyContent:"center",alignItems:"center",":focus":_object_spread({},pt.a.borderRight("0px"))}),splitButtonMenuButton:_object_spread_props(_object_spread({height:"100%",width:"12px",minWidth:"12px",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",flexShrink:0},pt.a.padding("7px","1px","7px","2px")),{"> span":_object_spread_props(_object_spread({display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},pt.a.margin("0px")),{"> i":{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",width:"8px",height:"8px"}})}),divider:{height:"27px",flexGrow:0}}),Hr={display:"flex",flexDirection:"column",justifyContent:"center",flexShrink:0,width:"100%",height:"32px",lineHeight:"16px",fontSize:"18px",textAlign:"center",fontFamily:"Aptos Display",letterSpacing:"0.2px",borderRadius:"4px",borderWidth:"1px",borderColor:Yo.a.gray70,marginBottom:"12px"},Vr={root:{backgroundColor:"transparent",height:"27px",padding:"0px"},rootHovered:{backgroundColor:"transparent"}},Ur={root:{height:"16px",width:"16px"}},Gr=Object(ut.a)({labelWrapper:_object_spread_props(_object_spread({},pt.a.padding("0px")),{marginBottom:"12px"}),label:{fontWeight:F.l.semibold,fontSize:"12px",lineHeight:"16px"}});var qr=n(298),Qr=n(1167);const Kr=Object(ut.a)({base:{marginLeft:_o.a.spacingHorizontalNone}});var Jr=n(1449),Yr=n(1470);const Zr=R.memo(R.forwardRef((e,t)=>{const n=Object(Yr.a)(e,t);return(e=>{const t=Kr();e.root.className=Object(Rt.a)("ms-ButtonNext","ms-Button",e.root.className),e.menuIcon&&(e.menuIcon.className=Object(Rt.a)(t.base,e.menuIcon.className)),Object(cn.a)(e),Object(cn.b)(e.icon,e),Object(cn.b)(e.menuIcon,e),Object(Qr.a)(e)})(n),Object(Jr.a)(n)}));Zr.displayName="next/TaskPaneSplitButtonMenuButton";const $r=R.memo(R.forwardRef((e,t)=>{const n=Object(Pr.a)(_object_spread_props(_object_spread({},e),{dataAutomationType:"TaskPaneSplitButton"}),t);return n.components&&(n.components.menuButton=Zr,n.menuButton[qr.a]=Zr,n.components.primaryActionButton=e.toggleable?Wr:dn,n.primaryActionButton[qr.a]=e.toggleable?Wr:dn),(e=>{Object(wr.b)(e)})(n),Object(Dr.a)(n)}));$r.displayName="next/TaskPaneSplitButton";class Xr{constructor(e,t,n,o){this.colorPickerController=e,this.controllerMenuProps=t,this.selectedColor=n,this.onColorChange=o,this.getMenuDefinition=()=>({sections:this.getMenuSections()}),this.getMenuSections=()=>this.controllerMenuProps.sections.map(e=>this.getMenuSectionDefinition(e)),this.getMenuSectionDefinition=e=>{const t={controls:[]};return e.title&&(t.title=e.title),2===e.type?t.controls.push(this.getButtonProps(e.buttonProps)):1===e.type&&t.controls.push(this.getColorPickerProps(e.colorSwatchProps)),t},this.getButtonProps=e=>_object_spread({type:"AppButtonProps",label:e.label,id:"ColorPickerSectionButton-"+e.type},this.getAdditionalPropsForButton(e.type)),this.getAdditionalPropsForButton=e=>{let t=void 0,n=void 0;switch(e){case 1:t=this.showMoreColorsDialog,n=d.a.MoreColors_20;break;case 3:t=this.changeToDefaultColor,n=d.a.Automatic_16;break;case 2:t=this.changeToDefaultColor,n=d.a.SwatchNoColorSquare_20;break;case 5:t=this.launchEyedropper,n=d.a.EyedropperFillColor_20;break;case 4:default:return i.a.sendTraceTag(545116675,a.a.msoulscat_ES_EWAJS,s.a.Error,"ColorPickerMenuDefinitionHelper.getAdditionalPropsForButton: Unknown button type."),{}}return{onExecute:t,icon:n}},this.getColorPickerProps=e=>_object_spread({type:"AppColorPickerProps",columnCount:10,id:"ColorPickerButton",colorCells:e.colors},this.getAdditionalPropsForColorSwatch(e)),this.getAdditionalPropsForColorSwatch=e=>{var t;let n=this.selectColor;return e.isThemeColorSection?n=e.notifyOnColorUsed?this.selectThemeColorAndNotify:this.selectThemeColor:e.notifyOnColorUsed&&(n=this.selectColorAndNotify),{selectedId:(null===(t=this.selectedColor)||void 0===t?void 0:t.toLowerCase())||void 0,onExecute:n}},this.changeToDefaultColor=()=>{this.onColorChange(null)},this.showMoreColorsDialog=()=>{this.colorPickerController.showMoreColorsDialog(this.selectedColor||"#FFFFFF",(e,t)=>{e&&this.onColorChange("#"+t)})},this.launchEyedropper=()=>{this.colorPickerController.launchEyedropper((e,t)=>{e&&this.onColorChange("#"+t)})},this.selectColor=(e,t)=>{this.onColorChange(e.color||null,t)},this.selectThemeColor=e=>{this.selectColor(e,this.colorPickerController.getThemeColor(e.color)||void 0)},this.selectThemeColorAndNotify=e=>{this.notifyColorUsed(e),this.selectThemeColor(e)},this.selectColorAndNotify=e=>{this.notifyColorUsed(e),this.selectColor(e)},this.notifyColorUsed=e=>{e.color&&this.colorPickerController.onColorUsed(e.color)}}}class ei{getButtonAriaLabel(){let e="";return this.selectedColor?e=this.findColorLabel(this.selectedColor):("#000000"===this.defaultColor&&(e=this.findButtonLabel(3)),"transparent"===this.defaultColor&&(e=this.findButtonLabel(2))),this.label+e}constructor(e,t,n,o){this.label=t,this.selectedColor=n,this.defaultColor=o,this.findColorLabel=Object(Jo.c)(e=>{if(e&&this.menuSections)for(let n=0;n<this.menuSections.length;n++){var t;const o=null===(t=this.menuSections[n].colorSwatchProps)||void 0===t?void 0:t.colors;if(o)for(let t=0;t<o.length;t++)if(e===o[t].color&&o[t].label)return o[t].label}return e}),this.findButtonLabel=e=>{if(this.menuSections)for(let o=0;o<this.menuSections.length;o++){var t;const r=this.menuSections[o];var n;if(2===r.type&&(null===(t=r.buttonProps)||void 0===t?void 0:t.type)===e)return(null===(n=r.buttonProps)||void 0===n?void 0:n.label)||""}return""},this.menuSections=e.sections}}class ti extends R.Component{render(){const e=this.props.colorPickerController.getColorPickerButtonMenuProps(this.props.modifiers),t=(n=this.props.colorPickerController,o=e,r=this.props.selectedColor,i=this.props.onColorChange,new Xr(n,o,r,i).getMenuDefinition());var n,o,r,i;const a=function(e,t,n,o){return new ei(e,t,n,o).getButtonAriaLabel()}(e,this.props.label,this.props.selectedColor,this.props.defaultColor);return R.createElement(Ir,_object_spread({label:this.props.label,"aria-label":a,icon:this.props.icon,id:"colorPickerButton",toggleable:!1,hideLabel:!0,controlInMenuRendererFunction:this.defaultRibbonMenuRenderer,downChevronIcon:Po.a.downChevron.icon8,iconColor:this.props.selectedColor||this.props.defaultColor,menuDefinition:t,onExecute:()=>{this.props.onColorChange(this.props.selectedColor||this.props.defaultColor)}},this.props.overrideAppButtonProps))}constructor(e){super(e),this.defaultRibbonMenuRenderer=Object(Br.a)(Po.a,Object(Fr.a)())}}const ni=R.memo(ti),oi=Object(x.isChangeGateEnabled)("OfficeVSO:8896835_MigrateColorButtonTov9"),ri=Object(x.isChangeGateEnabled)("OfficeVSO:8896838_MigrateBorderButtonTov9"),ii=Object(x.isChangeGateEnabled)("OfficeVSO:9053428_AddSplitButtonAriaLabelinCustomFormatting"),ai=Object(x.isChangeGateEnabled)("OfficeVSO:9189070_CfSplitButtonV9RestoreFocus"),si=R.memo(e=>{const t=zr();return R.createElement(Wr,_object_spread_props(_object_spread({},e),{hideLabel:!0,appearance:"subtle",className:t.toggleButton}))}),li=R.memo(e=>{const t=Gr(),n=zr(),o=ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FontColor),r=ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.Underline),i=ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FillColor),a=ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.Borders),s=Object(Br.a)(Po.a,Object(Fr.a)()),l={sections:[{controls:[{type:"AppToggleButtonProps",id:"FormatStylesCustomPaneDoubleUnderLineButton",label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.DoubleUnderline),toggled:e.customFormat.isTextDoubleUnderlined,onExecute:e.onDoubleUnderlineButtonExecute,icon:be.a.DoubleUnderline_16}]}]},u=e=>{const t={appearance:"subtle",className:n.splitButtonRoot,primaryActionButton:{className:n.splitButtonPrimaryButton},menuButton:{className:n.splitButtonMenuButton},alwaysRestoreFocus:ai};return ii?_object_spread_props(_object_spread({},t),{splitButtonAriaLabel:e}):t};return R.createElement("div",{id:"CustomFormattingPanel","aria-labelledby":"labelForCustomFormattingPanel"},R.createElement("div",{className:n.flexContainerBackLabel},R.createElement(dn,{className:n.backButton,icon:c.a.CommonControlChevronLeft_16,id:"FormatStylesCustomPaneBackButton",label:"",fullDescriptionLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingRuleEditorCustomFormatBackButton),hideLabel:!0,onExecute:e.onBackButtonExecute,appearance:"subtle"}),R.createElement(ct.a,{type:"AppLabelProps",id:"labelForCustomFormattingPanel",forId:"CustomFormattingPanel",label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingCustomFormatText),labelWrapperClassName:t.labelWrapper,className:t.label})),R.createElement("div",{className:n.rulePreviewWrapper},R.createElement(Ve,{rule:{ruleType:3,customFormat:e.customFormat},style:Hr})),R.createElement("div",{className:n.styleControlsFlex},R.createElement(si,{id:"FormatStylesCustomPaneBoldButton",label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.Bold),toggled:e.customFormat.isTextBold,onExecute:e.onBoldButtonExecute,icon:be.a.Bold_16}),R.createElement(si,{id:"FormatStylesCustomPaneItalicButton",label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.Italic),toggled:e.customFormat.isTextItalic,onExecute:e.onItalicButtonExecute,icon:be.a.Italic_16}),R.createElement($r,_object_spread({type:"AppSplitButtonProps",label:r,hideLabel:!0,id:"FormatStylesCustomPaneUnderlineSplitButton",menuDefinition:l,controlInMenuRendererFunction:s,downChevronIcon:Po.a.downChevron.icon8,icon:be.a.Underline_16,onExecute:e.onUnderlineButtonExecute,toggled:e.customFormat.isTextUnderlined,toggleable:!0},u(r))),R.createElement(si,{id:"FormatStylesCustomPaneStrikeButton",label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.Strikethrough),toggled:e.customFormat.isTextStrikethrough,onExecute:e.onStrikethroughButtonExecute,icon:be.a.Strikethrough2_16}),oi?R.createElement(ni,{icon:be.a.FontColor_16,label:o,colorPickerController:e.colorPickerController,modifiers:e.fontColorModifiers,selectedColor:e.customFormat.textColor||null,defaultColor:e.defaultFontColor,onColorChange:e.onFontColorChange,overrideAppButtonProps:u(o)}):R.createElement(cr,{buttonIconName:be.a.FontColor_16,buttonLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FontColor),colorPickerController:e.colorPickerController,modifiers:e.fontColorModifiers,selectedColor:e.customFormat.textColor||null,defaultColor:e.defaultFontColor,onChange:e.onFontColorChange,mainButtonStyles:Vr,mainButtonIconStyles:Ur}),R.createElement(wt.a,{vertical:!0,appearance:"strong",className:n.divider}),oi?R.createElement(ni,{icon:be.a.FillColorSplitDropdown_16,label:i,colorPickerController:e.colorPickerController,modifiers:e.fillColorModifiers,selectedColor:e.customFormat.backgroundColor||null,defaultColor:e.defaultFillColor,onColorChange:e.onFillColorChange,overrideAppButtonProps:u(i)}):R.createElement(cr,{buttonIconName:be.a.FillColorSplitDropdown_16,buttonLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FillColor),colorPickerController:e.colorPickerController,modifiers:e.fillColorModifiers,selectedColor:e.customFormat.backgroundColor||null,defaultColor:e.defaultFillColor,onChange:e.onFillColorChange,mainButtonStyles:Vr,mainButtonIconStyles:Ur}),R.createElement(Or,_object_spread({defaultColor:e.defaultBorderColor,colorPickerController:e.colorPickerController,borderMenuController:e.borderMenuController,supportedBorderOptions:e.supportedBorderOptions,supportedLineStyles:e.supportedBorderLineStyles,onBorderOptionSelected:e.onBorderOptionsChange,mainButtonStyles:Vr,mainButtonIconStyles:Ur},ri?{overrideAppButtonProps:u(a),renderAsV9SplitButton:!0}:{}))))});var ci=n(19),ui=n(39);const di="drop-shadow(0px 3.2px 7.2px rgba(0, 0, 0, 0.13)) drop-shadow(0px 0.6px 1.8px rgba(0, 0, 0, 0.10))",pi=Object(ut.a)(_object_spread({},$e.reduce((e,t)=>(e[t.key]=((e=dt.a.colorNeutralForeground1,t=dt.a.colorNeutralForegroundInverted,n=Yo.a.gray50)=>_object_spread_props(_object_spread({backgroundColor:t,color:e},pt.a.borderColor(n),pt.a.borderWidth("1px")),{":hover":_object_spread_props(_object_spread({backgroundColor:t,color:e},pt.a.borderColor(n)),{filter:di}),":hover:active":_object_spread_props(_object_spread({backgroundColor:t,color:e},pt.a.borderColor(n)),{filter:di})}))(t.ruleStyles.textColor,t.ruleStyles.backgroundColor,t.ruleStyles.borderColor),e),{}))),gi=Object(ut.a)({formatPreviewBaseStyles:{height:"32px",width:"48px",minWidth:"48px",lineHeight:"24px",fontSize:"18px",fontFamily:"Aptos Display !important",fontWeight:F.l.regular,["& ."+ci.C]:_object_spread({},ui.p)},customAddButtonOverrides:_object_spread_props(_object_spread({backgroundColor:Yo.a.gray10},pt.a.borderWidth("0px")),{":hover":_object_spread({},pt.a.borderWidth("0px")),":hover:active":_object_spread({},pt.a.borderWidth("0px")),"& span":_object_spread({},pt.a.margin("0px"))}),selected:_object_spread_props(_object_spread({},pt.a.outline("1.2px","solid",dt.a.colorBrandBackground)),{filter:"drop-shadow(0px 1.6px 3.6px rgba(0, 0, 0, 0.13)) drop-shadow(0px 0.3px 0.9px rgba(0, 0, 0, 0.10))",":hover":_object_spread_props(_object_spread({},pt.a.outline("1.2px","solid",dt.a.colorBrandBackground),pt.a.borderWidth("1.2px")),{filter:di}),":hover:active":_object_spread_props(_object_spread({},pt.a.outline("1.2px","solid",dt.a.colorBrandBackground),pt.a.borderWidth("1.2px")),{filter:di})}),selectedCustomAddButton:_object_spread_props(_object_spread({},pt.a.outline("1.2px","solid",dt.a.colorBrandBackground)),{":hover":_object_spread({},pt.a.outline("1.2px","solid",dt.a.colorBrandBackground),pt.a.borderWidth("1.2px")),":hover:active":_object_spread({},pt.a.outline("1.2px","solid",dt.a.colorBrandBackground),pt.a.borderWidth("1.2px"))}),flexBox:{display:"flex",flexDirection:"row",alignItems:"center",flexWrap:"wrap",columnGap:"min(max(calc((100% - 240px)/4), 4px), 11.25px)",rowGap:"8px"}}),hi={root:{height:"20px",width:"20px",selectors:{"svg > path.OfficeIconColors_DynamicColor":{fill:"buttonText"}}}};var mi=n(249);const bi=R.memo(e=>{const t=gi(),n=pi(),o=Object(Rt.a)(t.formatPreviewBaseStyles,n[e.itemKey],e.isSelected&&t.selected);return R.createElement(dn,{label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingCustomStylePreviewSampleTextSmall),id:"FormatPreviewButtonInternal-"+e.itemKey,className:o,onExecute:e.onExecute,customTooltip:e.tooltip})}),fi=R.memo(e=>{const t=gi(),n=Gr(),{selectedKey:o,onExecute:r}=e,i=R.useCallback(e=>t=>r(e,t),[r]);return R.createElement(R.Fragment,null,R.createElement(ct.a,{type:"AppLabelProps",id:"labelForQuickFormatGallery",forId:"QuickFormatGallery",label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingFormatStyleText),labelWrapperClassName:n.labelWrapper,className:n.label}),R.createElement("div",{className:t.flexBox,id:"QuickFormatGallery","aria-labelledby":"labelForQuickFormatGallery"},Xe.map(e=>R.createElement(bi,{key:e.key,itemKey:e.key,onExecute:i(e.key),isSelected:e.key===o,tooltip:e.text})),R.createElement(dn,{className:Object(Rt.a)(t.formatPreviewBaseStyles,t.customAddButtonOverrides,6===o&&t.selectedCustomAddButton),icon:{children:R.createElement(fe.a,_object_spread_props(_object_spread({},Object(mi.a)(be.a.plussignglyph_16)),{styles:hi}))},id:"FormatPreviewButtonInternal-Custom",label:"",hideLabel:!0,onExecute:i(6),customTooltip:Ze[6]})))}),xi={root:{height:"30px",width:"24px",maxWidth:"24px",padding:"1px",marginLeft:"1px",selectors:{":hover":{background:"#E1DFDD"}}},rootChecked:{background:"#E1DFDD"},icon:{height:"18px",width:"18px"}},Ei={marginTop:M?"2px":"12px"},Si={marginTop:"12px"},yi={display:"flex",alignItems:"flex-start"},Ci={height:"33px",lineHeight:"33px",width:"100%",marginTop:"12px",fontSize:"20px"},vi={automaticColor:!0,clearColor:!1,highlightWhen:!1,moreColors:!0,eyedropper:!0},Ri={automaticColor:!1,clearColor:!0,highlightWhen:!1,moreColors:!0,eyedropper:!0};class ki extends R.Component{static getDerivedStateFromProps(e,t){if(!M)return null;if(!t||e.selectedFormat.getUniqueId()!==t.selectedFormatUniqueId){const t=ki.getSelectedKey(e.selectedFormat,!0);return{selectedFormatUniqueId:e.selectedFormat.getUniqueId(),mapCustomFormatToQuickFormat:!0,shouldShowCustomFormatPanel:6===t}}return null}render(){return R.createElement("div",{style:Ei},M?this.renderSimplifiedFormattingOptions():this.getFormatDisplayComponents())}renderSimplifiedFormattingOptions(){if(this.state.shouldShowCustomFormatPanel){const e={defaultFontColor:"#000000",defaultFillColor:"transparent",defaultBorderColor:this.getDefaultBorderColor()},t={fontColorModifiers:vi,fillColorModifiers:Ri,supportedBorderOptions:this.cfSupportedBorderTypes,supportedBorderLineStyles:this.cfSupportedLineStyles},n={onBoldButtonExecute:this.onBoldButtonClicked,onItalicButtonExecute:this.onItalicButtonClicked,onUnderlineButtonExecute:this.onTextUnderlinedButtonClicked,onDoubleUnderlineButtonExecute:this.onTextDoubleUnderlinedButtonClicked,onStrikethroughButtonExecute:this.onTextStrikethroughButtonClicked,onFontColorChange:this.onFontColorChanged,onFillColorChange:this.onBackgroundColorChanged,onBorderOptionsChange:this.onBorderChanged},o={colorPickerController:pe.getColorPickerButtonController(),borderMenuController:pe.getBorderMenuController()};return R.createElement(li,_object_spread({customFormat:this.props.selectedFormat.getSelectedFormat(),onBackButtonExecute:this.onCustomPanelBackButtonExecute},e,t,o,n))}return R.createElement(fi,{selectedKey:ki.getSelectedKey(this.props.selectedFormat,this.state.mapCustomFormatToQuickFormat),onExecute:this.onQuickFormatButtonExecute})}getFormatDisplayComponents(){return R.createElement("div",null,this.getFormatDropdown(),this.getCustomFormatPanel())}getFormatDropdown(){return R.createElement(Ho,{selectedFormat:this.props.selectedFormat,onChange:this.onDropdownOptionChanged})}getCustomFormatPanel(){return R.createElement("div",{style:Si},R.createElement("div",{style:yi},this.renderToggleButtons(),this.renderColorPickerButtons(),this.renderBorderButton()),this.renderPreview())}renderToggleButtons(){return R.createElement(R.Fragment,null,this.renderToggleButton("ConditionalFormattingFormatInputBoldButton",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.Bold),g.a.Bold_20,this.props.selectedFormat.getSelectedFormat().isTextBold,this.onBoldButtonClicked),this.renderToggleButton("ConditionalFormattingFormatInputItalicButton",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.Italic),g.a.Italic_20,this.props.selectedFormat.getSelectedFormat().isTextItalic,this.onItalicButtonClicked),this.renderToggleButton("ConditionalFormattingFormatInputUnderlineButton",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.Underline),g.a.Underline_20,this.props.selectedFormat.getSelectedFormat().isTextUnderlined,this.onTextUnderlinedButtonClicked),this.renderToggleButton("ConditionalFormattingFormatInputDoubleUnderlineButton",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.DoubleUnderline),g.a.DoubleUnderline_20,this.props.selectedFormat.getSelectedFormat().isTextDoubleUnderlined,this.onTextDoubleUnderlinedButtonClicked),this.renderToggleButton("ConditionalFormattingFormatInputStrikethroughButton",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.Strikethrough),g.a.Strikethrough2_20,this.props.selectedFormat.getSelectedFormat().isTextStrikethrough,this.onTextStrikethroughButtonClicked))}renderToggleButton(e,t,n,o,r){return R.createElement(dr.a,{type:"AppToggleButtonProps",useLegacyButton:!0,id:e,styles:xi,hideLabel:!0,label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormatWithMenuPrefix)+t,icon:n,toggled:o,onExecute:r,customTooltip:t})}renderColorPickerButtons(){return R.createElement("span",null,R.createElement(lr,{buttonIconName:g.a.FillColorSplitDropdown_20,buttonLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FillColor),colorPickerController:pe.getColorPickerButtonController(),modifiers:Ri,selectedColor:this.props.selectedFormat.getSelectedFormat().backgroundColor||null,defaultColor:"transparent",onChange:this.onBackgroundColorChanged}),R.createElement(lr,{buttonIconName:g.a.FontColor_20,buttonLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FontColor),colorPickerController:pe.getColorPickerButtonController(),modifiers:vi,selectedColor:this.props.selectedFormat.getSelectedFormat().textColor||null,defaultColor:"#000000",onChange:this.onFontColorChanged}))}renderPreview(){return R.createElement(Ve,{rule:{ruleType:3,customFormat:this.props.selectedFormat.getSelectedFormat()},style:Ci})}renderBorderButton(){return R.createElement(jr,{defaultColor:this.defaultSelectedBorderColor,colorPickerController:pe.getColorPickerButtonController(),borderMenuController:pe.getBorderMenuController(),supportedBorderOptions:this.cfSupportedBorderTypes,supportedLineStyles:this.cfSupportedLineStyles,onBorderOptionSelected:this.onBorderChanged})}onDropdownOptionChanged(e){M&&this.setState({mapCustomFormatToQuickFormat:!1});const t=this.props.selectedFormat;t.setQuickFormat(e),this.props.onChange(t)}onCustomFormatChanged(e){M&&this.setState({mapCustomFormatToQuickFormat:!1});const t=this.props.selectedFormat;t.setCustomFormat(e),this.props.onChange(t)}onFontColorChanged(e,t){const n=_object_spread({},this.props.selectedFormat.getSelectedFormat());n.textColor=e,n.textColorThemeInfo=t,n.preserveTextColor=!1,this.onCustomFormatChanged(n)}onBackgroundColorChanged(e,t){const n=_object_spread({},this.props.selectedFormat.getSelectedFormat());n.backgroundColor=e,n.backgroundColorThemeInfo=t,n.preserveBackgroundColor=!1,n.gradientFill=null,this.onCustomFormatChanged(n)}onBoldButtonClicked(){const e=_object_spread({},this.props.selectedFormat.getSelectedFormat());e.isTextBold=!e.isTextBold,this.onCustomFormatChanged(e)}onItalicButtonClicked(){const e=_object_spread({},this.props.selectedFormat.getSelectedFormat());e.isTextItalic=!e.isTextItalic,this.onCustomFormatChanged(e)}onTextUnderlinedButtonClicked(){const e=_object_spread({},this.props.selectedFormat.getSelectedFormat());e.isTextUnderlined?e.isTextUnderlined=!1:(e.isTextUnderlined=!0,e.isTextDoubleUnderlined=!1),this.onCustomFormatChanged(e)}onTextDoubleUnderlinedButtonClicked(){const e=_object_spread({},this.props.selectedFormat.getSelectedFormat());e.isTextDoubleUnderlined?e.isTextDoubleUnderlined=!1:(e.isTextDoubleUnderlined=!0,e.isTextUnderlined=!1),this.onCustomFormatChanged(e)}onTextStrikethroughButtonClicked(){const e=_object_spread({},this.props.selectedFormat.getSelectedFormat());e.isTextStrikethrough=!e.isTextStrikethrough,this.onCustomFormatChanged(e)}onBorderChanged(e,t,n,o){const r=_object_spread({},this.props.selectedFormat.getSelectedFormat());var i,a,s;r.borderFormat?r.borderFormat={position:r.borderFormat.position,lineStyle:null===(i=r.borderFormat.lineStyle)||void 0===i?void 0:i.slice(),color:null===(a=r.borderFormat.color)||void 0===a?void 0:a.slice(),themeColor:(null===(s=r.borderFormat.themeColor)||void 0===s?void 0:s.slice())||[null,null,null,null]}:r.borderFormat=We(),this.setBorderFormatProperties(r.borderFormat,e,t,n,o),this.onCustomFormatChanged(r)}setBorderFormatProperties(e,t,n,o,r){const l=this.getLineStyle(n);switch(t){case ur.NoBorder:e.position=Me.AllBorders,e.lineStyle=[0,0,0,0],e.color=["#000000","#000000","#000000","#000000"],e.themeColor=[null,null,null,null];break;case ur.BottomBorder:e.position=e.position|Me.Bottom,this.setBorderProperties(e,Be.Bottom,l,o,r);break;case ur.TopBorder:e.position=e.position|Me.Top,this.setBorderProperties(e,Be.Top,l,o,r);break;case ur.LeftBorder:e.position=e.position|Me.Left,this.setBorderProperties(e,Be.Left,l,o,r);break;case ur.RightBorder:e.position=e.position|Me.Right,this.setBorderProperties(e,Be.Right,l,o,r);break;case ur.OutsideBorders:e.position=Me.AllBorders,e.lineStyle=[l,l,l,l],e.color=[o,o,o,o],e.themeColor=[r,r,r,r];break;case ur.TopAndBottomBorders:e.position=e.position|Me.Top|Me.Bottom,this.setBorderProperties(e,Be.Top,l,o,r),this.setBorderProperties(e,Be.Bottom,l,o,r);break;default:i.a.sendTraceTag(541193945,a.a.msoulscat_ES_EWAJS,s.a.Error,"ConditionalFormattingFormatInput.setBorderProperties: Unsupported BorderOptionType.")}}setBorderProperties(e,t,n,o,r){e.lineStyle[t]=n,e.color[t]=o,e.themeColor[t]=r}getLineStyle(e){if(null==e)return 1;switch(e){case"BorderStyleSolidLine":return 1;case"BorderStyleDashedLine":return 3;case"BorderStyleDottedLine":return 4}return i.a.sendTraceTag(540553687,a.a.msoulscat_ES_EWAJS,s.a.Error,"ConditionalFormattingFormatInput.setBorderProperties: Unsupported line style type."),1}getDefaultBorderColor(){const e=this.props.selectedFormat.getSelectedFormat().borderFormat;if(e&&e.color&&e.lineStyle){if(0!==e.lineStyle[Be.Top])return e.color[Be.Top]||void 0;if(0!==e.lineStyle[Be.Bottom])return e.color[Be.Bottom]||void 0;if(0!==e.lineStyle[Be.Left])return e.color[Be.Left]||void 0;if(0!==e.lineStyle[Be.Right])return e.color[Be.Right]||void 0}}constructor(e){super(e),this.cfSupportedBorderTypes=[ur.NoBorder,ur.BottomBorder,ur.TopBorder,ur.LeftBorder,ur.RightBorder,ur.OutsideBorders,ur.TopAndBottomBorders],this.cfSupportedLineStyles=["BorderStyleSolidLine","BorderStyleDashedLine","BorderStyleDottedLine"],this.onCustomPanelBackButtonExecute=()=>{this.setState({shouldShowCustomFormatPanel:!1})},this.onQuickFormatButtonExecute=e=>{6!==e?this.onDropdownOptionChanged(e):this.setState({shouldShowCustomFormatPanel:!0})},this.getFormatDropdown=this.getFormatDropdown.bind(this),this.getCustomFormatPanel=this.getCustomFormatPanel.bind(this),this.renderToggleButton=this.renderToggleButton.bind(this),this.renderToggleButtons=this.renderToggleButtons.bind(this),this.renderColorPickerButtons=this.renderColorPickerButtons.bind(this),this.renderPreview=this.renderPreview.bind(this),this.renderBorderButton=this.renderBorderButton.bind(this),this.onDropdownOptionChanged=this.onDropdownOptionChanged.bind(this),this.onCustomFormatChanged=this.onCustomFormatChanged.bind(this),this.onFontColorChanged=this.onFontColorChanged.bind(this),this.onBackgroundColorChanged=this.onBackgroundColorChanged.bind(this),this.onBoldButtonClicked=this.onBoldButtonClicked.bind(this),this.onItalicButtonClicked=this.onItalicButtonClicked.bind(this),this.onTextUnderlinedButtonClicked=this.onTextUnderlinedButtonClicked.bind(this),this.onTextDoubleUnderlinedButtonClicked=this.onTextDoubleUnderlinedButtonClicked.bind(this),this.onTextStrikethroughButtonClicked=this.onTextStrikethroughButtonClicked.bind(this),this.onBorderChanged=this.onBorderChanged.bind(this),this.getDefaultBorderColor=this.getDefaultBorderColor.bind(this),this.getLineStyle=this.getLineStyle.bind(this),this.defaultSelectedBorderColor=this.getDefaultBorderColor()}}ki.getSelectedKey=(e,t)=>{if(!t)return e.getQuickFormat();if(e.isQuickFormat())return e.getQuickFormat();const n=e.getCustomFormat(),o=tt(n);return-1===o?6:Xe[o].key};const Ti="ConditionalFormatting.RuleEditor.CellValueDropdown";class _i extends R.Component{render(){return M?R.createElement(fo,{id:Ti,options:wi,onChange:this.props.onChange,selectedKey:this.props.selectedKey,ariaLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingOperatorDropdownType)}):R.createElement(On,{id:Ti,options:wi,onChange:this.onChange,selectedKey:this.props.selectedKey,ariaLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingOperatorDropdownType)})}onChange(e,t){t&&this.props.onChange&&this.props.onChange(t.key)}constructor(e){super(e),this.onChange=this.onChange.bind(this)}}const wi=[{key:1,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingHighlightCellValueGreaterThan)},{key:2,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingHighlightCellValueLessThan)},{key:3,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingHighlightCellValueBetween)},{key:4,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingHighlightCellValueEqualTo)},{key:68,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingHighlightCellValueGreaterThanOrEqualsTo)},{key:69,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingHighlightCellValueLessThanOrEqualsTo)},{key:70,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingHighlightCellValueNotBetween)},{key:71,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingHighlightCellValueNotEqualTo)}],Di={display:"flex",flexDirection:"column"},Pi={display:"flex",flexDirection:"row"},Ii={display:"flex",flexDirection:"row",alignItems:"center"},Fi={flexGrow:1,width:"100%"},Bi={root:{height:"14px",fontSize:"12px",padding:"9px",flexShrink:0}},Mi={root:{fontSize:"12px",padding:"0px 9px",flexShrink:0,lineHeight:"16px"}};class ji extends R.Component{render(){return M?this.renderNew():R.createElement("div",{style:Di},this.getCellValueDropdown(),R.createElement("div",{style:Oo},this.getCellValueInputContent()))}renderNew(){return R.createElement(R.Fragment,null,R.createElement("div",{style:Bo},this.getCellValueDropdown()),R.createElement("div",{style:Mo},this.getCellValueInputContent()))}static getCellValueFormulaFirstElementId(e){return e?pe.getRequiredFirstPaneElementId():"CellValueRuleInput"}getCellValueDropdown(){return R.createElement(_i,{selectedKey:this.props.ruleInputData.getCommandType(),onChange:this.onCellValueChange})}getCellValueInputContent(){return this.props.ruleInputData.isTwoInputValuesRuleType()?R.createElement("div",{style:M?Ii:Pi},R.createElement("div",{style:Fi},this.getCellValueInputComponent(0,this.onFirstValueChange,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingFormula1TextBox),ji.getCellValueFormulaFirstElementId(this.props.isNewRule))),this.getTwoInputValuesLabel(),R.createElement("div",{style:Fi},this.getCellValueInputComponent(1,this.onSecondValueChange,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingFormula2TextBox),"CellValueRuleSecondInput","CellValueTwoInputTextField"))):this.getCellValueInputComponent(0,this.onFirstValueChange,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingFormulaTextBox),ji.getCellValueFormulaFirstElementId(this.props.isNewRule))}getTwoInputValuesLabel(){return R.createElement(jt.a,{styles:M?Mi:Bi},M?ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingHighlightCellValueBetweenAndSymbol):ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingHighlightCellValueBetweenAnd))}getCellValueInputComponent(e,t,n,o,r="CellValueTextField"){const i=this.props.ruleInputData.getErrorIfNeeded()[e],a=o+"CellValueRuleError";return R.createElement(we.a,null,s=>R.createElement("div",{"aria-labelledby":Ti+" "+a},R.createElement(De,{id:o,name:r,autoApply:!0,value:this.props.ruleInputData.getRuleInputValue()[e],sheetName:this.props.sheetName,styles:q(null===i,s),onChange:t,onCancelChanges:t,error:i||void 0,ariaLabel:n,placeholder:M?ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingRangePickerPlaceholder):void 0})))}onFirstValueChange(e){const t=this.props.ruleInputData;t.setRuleInputValue([e,t.getRuleInputValue()[1]]),t.setWasChanged(),this.props.onInputChange(t)}onSecondValueChange(e){const t=this.props.ruleInputData;t.setRuleInputValue([t.getRuleInputValue()[0],e]),t.setWasChanged(),this.props.onInputChange(t)}onCellValueChange(e){const t=this.props.ruleInputData,n=new Tn(e,t.getRuleInputValue()[0],t.getRuleInputValue()[1]);n.setWasChanged(),this.props.onInputChange(n)}constructor(e){super(e),this.onCellValueChange=this.onCellValueChange.bind(this),this.onFirstValueChange=this.onFirstValueChange.bind(this),this.onSecondValueChange=this.onSecondValueChange.bind(this),this.getCellValueInputContent=this.getCellValueInputContent.bind(this)}}class Oi extends R.Component{render(){return M?R.createElement(fo,{id:"ConditionalFormatting.RuleEditor.DateOccurringDropdown",options:Li,onChange:this.props.onChange,selectedKey:this.props.selectedKey,ariaLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingDateDropdownType)}):R.createElement(On,{id:"ConditionalFormatting.RuleEditor.DateOccurringDropdown",options:Li,onChange:this.onChange,selectedKey:this.props.selectedKey,ariaLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingDateDropdownType)})}onChange(e,t){t&&this.props.onChange&&this.props.onChange(t.key)}constructor(e){super(e),this.onChange=this.onChange.bind(this)}}const Li=[{key:1,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingHighlightDateYesterday)},{key:0,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingHighlightDateToday)},{key:6,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingHighlightDateTomorrow)},{key:2,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingHighlightDateLast7Days)},{key:4,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingHighlightDateLastWeek)},{key:3,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingHighlightDateThisWeek)},{key:7,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingHighlightDateNextWeek)},{key:5,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingHighlightDateLastMonth)},{key:9,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingHighlightDateThisMonth)},{key:8,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingHighlightDateNextMonth)}];class Ai extends R.Component{render(){return M?this.renderNew():R.createElement(Oi,{selectedKey:this.props.ruleInputData.getRuleInputValue(),onChange:this.onDateOccurringValueChange})}renderNew(){return R.createElement("div",{style:Bo},R.createElement(Oi,{selectedKey:this.props.ruleInputData.getRuleInputValue(),onChange:this.onDateOccurringValueChange}))}onDateOccurringValueChange(e){const t=this.props.ruleInputData;t.setRuleInputValue(e),t.setWasChanged(),this.props.onInputChange(t)}constructor(e){super(e),this.onDateOccurringValueChange=this.onDateOccurringValueChange.bind(this)}}class Ni extends R.Component{render(){return M?R.createElement(fo,{id:"ConditionalFormatting.RuleEditor.HighlightCellsWithDropdown",options:Wi,onChange:this.props.onChange,selectedKey:this.props.selectedKey,ariaLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingCriteriaDropdownType)}):R.createElement(On,{id:"ConditionalFormatting.RuleEditor.HighlightCellsWithDropdown",options:Wi,onChange:this.onChange,selectedKey:this.props.selectedKey,ariaLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingCriteriaDropdownType)})}onChange(e,t){t&&this.props.onChange&&this.props.onChange(t.key)}constructor(e){super(e),this.onChange=this.onChange.bind(this)}}const Wi=[{key:En.CellValue,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingHighlightWithCellValue)},{key:En.SpecificText,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingHighlightSpecificText)},{key:En.DateOccurring,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingHighlightDateOccurring)},{key:En.DuplicateValues,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingHighlightDuplicateValues)},{key:En.UniqueValues,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingHighlightDuplicateValuesUnique)},{key:En.Blanks,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingHighlightBlanks)},{key:En.NoBlanks,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingHighlightNoBlanks)},{key:En.Errors,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingHighlightErrors)},{key:En.NoErrors,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingHighlightNoErrors)}],zi="ConditionalFormatting.RuleEditor.SpecificTextDropdown";class Hi extends R.Component{render(){return M?R.createElement(fo,{id:zi,options:Vi,onChange:this.props.onChange,selectedKey:this.props.selectedKey,ariaLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingOperatorDropdownType)}):R.createElement(On,{id:zi,options:Vi,onChange:this.onChange,selectedKey:this.props.selectedKey,ariaLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingOperatorDropdownType)})}onChange(e,t){t&&this.props.onChange&&this.props.onChange(t.key)}constructor(e){super(e),this.onChange=this.onChange.bind(this)}}const Vi=[{key:5,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingHighlightTextContaining)},{key:72,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingHighlightTextNotContaining)},{key:73,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingHighlightTextBeginningWith)},{key:74,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingHighlightTextEndingWith)}];class Ui extends R.Component{render(){return M?this.renderNew():R.createElement("div",{style:jo},this.getSpecificTextDropdown(),R.createElement("div",{style:Oo},this.getTextField(this.props.ruleInputData.getRuleInputValue(),this.onTextValueChange)))}renderNew(){return R.createElement(R.Fragment,null,R.createElement("div",{style:Bo},this.getSpecificTextDropdown()),R.createElement("div",{style:Mo},this.getTextField(this.props.ruleInputData.getRuleInputValue(),this.onTextValueChange)))}getSpecificTextDropdown(){return R.createElement(Hi,{selectedKey:this.props.ruleInputData.getCommandType(),onChange:this.onSpecificTextChange})}getTextField(e,t){const n=this.props.ruleInputData.getErrorIfNeeded();return R.createElement(we.a,null,o=>R.createElement("div",{"aria-labelledby":zi+" ConditionalFormattingSpecificTextRuleError"},R.createElement(De,{id:this.props.isNewRule?pe.getRequiredFirstPaneElementId():"TextRuleValueInput",name:"SpecificTextTextField",autoApply:!0,value:e,sheetName:this.props.sheetName,styles:q(null===n,o),onChange:t,onCancelChanges:t,error:n||void 0,ariaLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingTextBoxName),placeholder:M?ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingRangePickerPlaceholder):void 0})))}onTextValueChange(e){const t=this.props.ruleInputData;t.setRuleInputValue(e),t.setWasChanged(),this.props.onInputChange(t)}onSpecificTextChange(e){const t=this.props.ruleInputData,n=new kn(e,t.getRuleInputValue());n.setWasChanged(),this.props.onInputChange(n)}constructor(e){super(e),this.onSpecificTextChange=this.onSpecificTextChange.bind(this),this.onTextValueChange=this.onTextValueChange.bind(this)}}const Gi={display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"flex-start",alignItems:"center",alignContent:"space-between",gap:"8px 4px",width:"100%",marginTop:"4px"};class qi extends R.Component{render(){return M?this.renderNew():R.createElement("div",{style:jo},R.createElement("div",{style:Oo},this.getHighlightCellsWithDropdown(),R.createElement("div",{style:Oo},this.getHighlightCellsWithInputContent())))}renderNew(){return R.createElement("div",{style:Gi},this.getHighlightCellsWithDropdown(),this.getHighlightCellsWithInputContent())}getHighlightCellsWithDropdown(){return R.createElement("div",{style:this.shouldLimitPrimarySubRuleWidth()?Bo:void 0},R.createElement(Ni,{selectedKey:this.getHighlightCellsWithOption(this.props.ruleInputData.getCommandType()),onChange:this.props.onHighlightCellsWithChange}))}getHighlightCellsWithInputContent(){switch(this.getHighlightCellsWithOption(this.props.ruleInputData.getCommandType())){case En.CellValue:return R.createElement(ji,{isNewRule:this.props.isNewRule,ruleInputData:this.props.ruleInputData,onInputChange:this.props.onInputChange,sheetName:this.props.sheetName});case En.SpecificText:return R.createElement(Ui,{isNewRule:this.props.isNewRule,ruleInputData:this.props.ruleInputData,onInputChange:this.props.onInputChange,sheetName:this.props.sheetName});case En.DateOccurring:return R.createElement(Ai,{ruleInputData:this.props.ruleInputData,onInputChange:this.props.onInputChange});case En.DuplicateValues:case En.UniqueValues:case En.Blanks:case En.NoBlanks:case En.Errors:case En.NoErrors:return R.createElement(R.Fragment,null)}}getHighlightCellsWithOption(e){switch(e){case 1:case 2:case 4:case 3:case 68:case 69:case 71:case 70:return En.CellValue;case 5:case 72:case 73:case 74:return En.SpecificText;case 6:return En.DateOccurring;case 7:return!0===this.props.ruleInputData.getRuleInputValue()?En.DuplicateValues:En.UniqueValues;case 64:return En.Blanks;case 65:return En.NoBlanks;case 66:return En.Errors;case 67:return En.NoErrors;default:throw Error("getHighlightCellsWithOption: Unsupported ConditionalFormattingCommandType")}}constructor(e){super(e),this.shouldLimitPrimarySubRuleWidth=()=>{if(!M)return!1;switch(this.getHighlightCellsWithOption(this.props.ruleInputData.getCommandType())){case En.CellValue:case En.SpecificText:case En.DateOccurring:return!0;case En.DuplicateValues:case En.UniqueValues:case En.Blanks:case En.NoBlanks:case En.Errors:case En.NoErrors:return!1}},this.getHighlightCellsWithInputContent=this.getHighlightCellsWithInputContent.bind(this)}}var Qi=n(765),Ki=n(286);const Ji="conditionalFormatting-GalleryItemButton-",Yi=Object(ut.a)({common:{["& ."+ci.C]:ui.p,maxWidth:"100%"}}),Zi=R.memo(e=>{const{commandType:t,onItemClick:n,text:o,data:r,selectedItemId:i,blockLabel:a,customTooltip:s}=e,l=Ji+t,c=i===l,u=Yi(),d=R.useCallback(()=>{n(t)},[n,t]),p=s||`${o} ${a||""}`;return R.createElement(Wr,{id:l,label:"",fullDescriptionLabel:o,customTooltip:p,hideLabel:!1,toggled:!!c,"aria-checked":!!c,onExecute:d,appearance:"subtle",className:u.common,role:"radio"},r)});class $i extends R.Component{render(){const e=Ji+this.props.commandType,t={root:{cursor:"pointer",display:"flex",border:"none",padding:"3px",outline:"none",height:"auto",width:this.props.width?this.props.width:void 0,minWidth:"auto",justifyContent:this.props.justifyContent?this.props.justifyContent:"center",backgroundColor:this.props.selectedItemId===e?"rgb(237, 235, 233)":"unset",selectors:{":focus::after":{outline:"none",border:"none"},":focus,:focus-within,:active":{[F.m]:{background:"Highlight"}},[F.m]:{border:"none"}}},flexContainer:{width:"100%"},rootHovered:{backgroundColor:"rgb(243, 242, 241)",[F.m]:{background:"Highlight"}}};return R.createElement(Ee.a,{content:this.props.hideTooltip?void 0:this.props.text,directionalHint:Se.a.bottomCenter},R.createElement(pr.a,{id:e,styles:t,onClick:this.onInnerItemClick,ariaLabel:this.props.text+(this.props.blockLabel||""),role:"listitem"},this.props.data))}onInnerItemClick(){this.props.onItemClick(this.props.commandType)}constructor(e){super(e),this.onInnerItemClick=this.onInnerItemClick.bind(this)}}var Xi=n(2625);const ea={content:{},root:{padding:"4px 0px 0px 0px",marginBottom:"-4px",selectors:{"::before":{backgroundColor:"#d2d0ce"}}}},ta=Object(ut.a)({divider:{height:"16px"},outerDiv:{display:"flex",flexDirection:"column"},innerContainerFlexDiv:{display:"flex",justifyContent:"space-between",flexDirection:"row",flexWrap:"wrap",marginTop:"4px",rowGap:"4px"}});var na=n(1462),oa=n(1463);class ra extends R.Component{render(){if(M)return R.createElement(ia,_object_spread({},this.props));if(this.props.itemsNumberInLine<1)throw new Error("itemsNumberInLine is less than 1");return R.createElement("div",{style:{display:"flex",flexDirection:"column"}},this.renderBlockHeader(),this.getItemRows(this.props.itemsProps,this.props.itemsNumberInLine).map((e,t)=>R.createElement("div",{key:t,style:{display:"flex",justifyContent:"space-between",flexDirection:"row",marginTop:"4px"}},e.map((e,n)=>this.renderBlockItem(e,n,t)))),this.renderSeparator())}getItemRows(e,t){const n=this.getItemRowsGenerator(e,t),o=[];if(n){let e=n.next();for(;!e.done;)o.push(e.value),e=n.next()}return o}constructor(e){super(e),this.renderBlockHeader=()=>this.props.label?R.createElement(jt.a,{"aria-label":this.props.label},this.props.label):R.createElement("div",null),this.renderSeparator=()=>this.props.seperatorAfterBlock?R.createElement(Xi.a,{styles:ea}):R.createElement("div",null),this.renderBlockItem=(e,t,n)=>R.createElement($i,_object_spread_props(_object_spread({},e),{blockLabel:this.props.label,key:n+"."+t})),this.getItemRowsGenerator=function*(e,t){for(let n=0;n<e.length;n+=t)yield e.slice(n,n+t)}}}const ia=e=>{const t=ta(),n=R.useRef(null),o=Object(na.a)(!1,"grid-linear");if(Object(oa.a)({},n),e.itemsNumberInLine<1)throw new Error("itemsNumberInLine is less than 1");return R.createElement("div",{className:t.outerDiv},e.hideBlockHeader?R.createElement(R.Fragment,null):R.createElement(wt.a,{className:t.divider},e.label),R.createElement("div",_object_spread_props(_object_spread({className:t.innerContainerFlexDiv,ref:n},o),{tabIndex:-1}),e.itemsProps.map((t,n)=>{return R.createElement("div",{key:n,style:(o=e.itemsNumberInLine,{maxWidth:`calc(100%/${o})`})},R.createElement(Zi,_object_spread_props(_object_spread({},t),{blockLabel:e.label})));var o})),e.seperatorAfterBlock?R.createElement(wt.a,{className:t.divider}):R.createElement(R.Fragment,null))};class aa extends R.Component{render(){if(M)return this.renderGallery();const e={root:_object_spread_props(_object_spread({},K),{fontSize:"12px",fontWeight:"normal",height:"24px",border:"none",textAlign:"left",padding:"0px",paddingTop:"5px",cursor:"pointer",selectors:{":active":{outline:"none",border:"none"},":focus":{outline:"none",border:"none"},":focus::after":{outline:"none",border:"none"}}})},t={height:"28px",width:"285px",cursor:"pointer",padding:"0px",paddingRight:Object(ue.a)()?"0px":"3px",paddingLeft:Object(ue.a)()?"3px":"0px",selectors:{":focus::after":{outline:"none",border:"none"},"svg > path.OfficeIconColors_HighContrast":{fill:"buttonText !important"},[F.m]:{color:"unset !important",borderColor:"unset !important"}}},n={root:t,rootHovered:[t,_object_spread_props(_object_spread({},V()),{background:"white"})],rootExpanded:[t,_object_spread_props(_object_spread({},V()),{background:"white"})],rootFocused:[t,Q(!0,!0)],rootPressed:[t,_object_spread_props(_object_spread({},V()),{background:"white"})],menuIcon:{height:"14px",width:"12px"}},o=Object(F.db)({buttonArea:{height:"28px"}});return R.createElement("div",{style:{display:"flex",flexDirection:"column"}},R.createElement("div",{className:o.buttonArea},R.createElement(pr.a,{role:"combobox listbox",styles:n,menuProps:{items:[{key:"ConditionalFormattingGalleryDropdownMenuItem",onRender:this.populateMenu,props:o}]},menuIconProps:{iconName:be.a.CommonControlChevronDown_12},ariaLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingFormatDropdownType)},R.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"left",paddingLeft:"8px",height:"28px",width:"255px"}},this.props.selectedItem.preview?R.createElement("div",{style:{marginTop:"5px",marginRight:"8px"}},this.props.selectedItem.preview):R.createElement("div",null),R.createElement(jt.a,{id:this.props.id+"-label",styles:e,tabIndex:-1,"data-is-focusable":!1},this.props.selectedItem.text)))))}renderGallery(){return R.createElement("div",{id:"RulesGallery"},this.props.itemsDropdownBlocksProps.map(e=>R.createElement(ra,_object_spread_props(_object_spread({},e),{key:e.id}))))}onKeyDown(e){if(document.activeElement){const t=document.activeElement.id;let n,o=null;switch(e.keyCode){case xe.a.up:n=this.getItemIdToFocus(t,sa.up),e.preventDefault();break;case xe.a.down:n=this.getItemIdToFocus(t,sa.down),e.preventDefault();break;case xe.a.right:n=this.getItemIdToFocus(t,Object(ue.a)()?sa.prev:sa.next),e.preventDefault();break;case xe.a.left:n=this.getItemIdToFocus(t,Object(ue.a)()?sa.next:sa.prev),e.preventDefault();break;case xe.a.tab:n=e.shiftKey?this.props.prevFocusableElementId:this.props.nextFocusableElementId,e.preventDefault()}n&&(o=document.getElementById(n),o&&o.focus())}else i.a.sendTraceTag(573415824,a.a.msoulscat_ES_EWAJS,s.a.Error,"ConditionalFormattingTaskPaneReact.GalleryDropdown: couldn't find  activeElement")}onKeyDownCapture(e){e.keyCode===xe.a.escape&&this.dismissCallout()}getItemIdToFocus(e,t){const n=this.getItemPosition(e,this.props.selectedItem.id);if(n)switch(t){case sa.down:return this.getLineDownItemId(n);case sa.up:return this.getLineUpItemId(n);case sa.prev:const e=this.getItem(this.getPrevItemPosition(n));return aa.getItemIdFromCommand(e.commandType);case sa.next:const t=this.getItem(this.getNextItemPosition(n));return aa.getItemIdFromCommand(t.commandType)}return i.a.shipAssertTag(573413458,a.a.msoulscat_ES_EWAJS,!1,"currentItemId not found in the GalleryDropdown items. ID: "+e),this.props.selectedItem.id}getItemPosition(e,t){let n=null;for(let o=0;o<this.props.itemsDropdownBlocksProps.length;o+=1){const r=this.props.itemsDropdownBlocksProps[o];for(let i=0;i<r.itemsProps.length;i+=1){const a=r.itemsProps[i],s=aa.getItemIdFromCommand(a.commandType);if(s===e)return{blockIndex:o,itemIndexInBlock:i};s===t&&(n={blockIndex:o,itemIndexInBlock:i})}}return n}getNextItemPosition(e){const t=this.getBlock(e.blockIndex).itemsProps.length,n=this.props.itemsDropdownBlocksProps.length;return e.itemIndexInBlock+1>=t?{blockIndex:(e.blockIndex+1)%n,itemIndexInBlock:0}:{blockIndex:e.blockIndex,itemIndexInBlock:e.itemIndexInBlock+1}}getPrevItemPosition(e){const t=this.props.itemsDropdownBlocksProps.length,n=(t+e.blockIndex-1)%t,o=this.props.itemsDropdownBlocksProps[n].itemsProps.length;return e.itemIndexInBlock-1<0?{blockIndex:n,itemIndexInBlock:o-1}:{blockIndex:e.blockIndex,itemIndexInBlock:e.itemIndexInBlock-1}}static getItemIdFromCommand(e){return Ji+e}getLineDownItemId(e){let t;const n=this.props.itemsDropdownBlocksProps[e.blockIndex],o=e.itemIndexInBlock%n.itemsNumberInLine+1,r=n.itemsProps.length/n.itemsNumberInLine===Math.floor(n.itemsProps.length/n.itemsNumberInLine);let i=Math.floor(n.itemsProps.length/n.itemsNumberInLine);if(i=r?i-1:i,Math.floor(e.itemIndexInBlock/n.itemsNumberInLine)!==i)t=e.itemIndexInBlock+n.itemsNumberInLine<=n.itemsProps.length-1?aa.getItemIdFromCommand(n.itemsProps[e.itemIndexInBlock+n.itemsNumberInLine].commandType):aa.getItemIdFromCommand(n.itemsProps[n.itemsProps.length-1].commandType);else{const n=e.blockIndex===this.props.itemsDropdownBlocksProps.length-1?0:e.blockIndex+1,r=this.props.itemsDropdownBlocksProps[n];t=o<=r.itemsProps.length?aa.getItemIdFromCommand(r.itemsProps[o-1].commandType):aa.getItemIdFromCommand(r.itemsProps[r.itemsProps.length-1].commandType)}return t}getLineUpItemId(e){let t;const n=this.props.itemsDropdownBlocksProps[e.blockIndex],o=e.itemIndexInBlock%n.itemsNumberInLine+1;if(e.itemIndexInBlock-n.itemsNumberInLine>=0)t=aa.getItemIdFromCommand(n.itemsProps[e.itemIndexInBlock-n.itemsNumberInLine].commandType);else{const n=0===e.blockIndex?this.props.itemsDropdownBlocksProps.length-1:e.blockIndex-1,r=this.props.itemsDropdownBlocksProps[n],i=r.itemsProps.length/r.itemsNumberInLine===Math.floor(r.itemsProps.length/r.itemsNumberInLine);let a=Math.floor(r.itemsProps.length/r.itemsNumberInLine);a=i?a-1:a,t=a*r.itemsNumberInLine+o<r.itemsProps.length?aa.getItemIdFromCommand(r.itemsProps[a*r.itemsNumberInLine+o-1].commandType):aa.getItemIdFromCommand(r.itemsProps[r.itemsProps.length-1].commandType)}return t}constructor(e){super(e),this.dismissCallout=()=>{},this.populateMenu=(e,t)=>{this.dismissCallout=t;const n=e.props;return R.createElement(Qi.a,{role:"list",target:"."+n.buttonArea,style:{display:"flex"},styles:{root:{boxShadow:"rgba(0, 0, 0, 0.133) 0px 3.2px 7.2px 0px, rgba(0, 0, 0, 0.11) 0px 0.6px 1.8px 0px",backgroundColor:"white",width:"285px",maxHeight:"285px",overflowY:"auto"}},directionalHint:Se.a.bottomCenter,isBeakVisible:!1,tabIndex:-1,onKeyDown:this.onKeyDown,onKeyDownCapture:this.onKeyDownCapture,setInitialFocus:!0,onFocus:this.setFocus},R.createElement("div",{onClick:t,id:"ConditionalFormattingGalleryDropdownBlockList",style:{display:"flex",flexDirection:"column",justifyContent:"space-between",overflowX:Object(x.isChangeGateEnabled)("OfficeVSO:8570049_EnableScrollInConditionalFormattingPane")?void 0:"hidden",overflowY:Object(x.isChangeGateEnabled)("OfficeVSO:8570049_EnableScrollInConditionalFormattingPane")?void 0:"hidden",width:"270px",margin:"8px",maxHeight:Object(x.isChangeGateEnabled)("OfficeVSO:8570049_EnableScrollInConditionalFormattingPane")?"50vh":void 0}},this.props.itemsDropdownBlocksProps.map(e=>R.createElement(ra,_object_spread_props(_object_spread({},e),{key:e.id})))))},this.setFocus=e=>{var t;Object(Ki.a)(e.currentTarget,e.relatedTarget)||null===(t=document.getElementById(this.props.selectedItem.id))||void 0===t||t.focus()},this.getBlock=e=>this.props.itemsDropdownBlocksProps[e],this.getItem=e=>this.getBlock(e.blockIndex).itemsProps[e.itemIndexInBlock],this.onKeyDown=this.onKeyDown.bind(this),this.populateMenu=this.populateMenu.bind(this),this.onKeyDownCapture=this.onKeyDownCapture.bind(this)}}var sa;!function(e){e[e.up=0]="up",e[e.down=1]="down",e[e.next=2]="next",e[e.prev=3]="prev"}(sa||(sa={}));const la={width:"280px",backgroundColor:"white",display:"flex",height:"32px",justifyContent:"left"};class ca extends R.Component{render(){const e=this.props.ruleInputData.getCommandType();return 0===e&&(this.dataBarQuickFormatCommand=function(e){for(let t=0;t<pa.length;t+=1)if(ga(e,pa[t].customFormat))return pa[t].key;return null}(this.props.ruleInputData.getRuleInputValue())||this.dataBarQuickFormatCommand),this.selectedItem.id=Ji+this.props.ruleInputData.getCommandType(),this.selectedItem.text=ua.get(e||this.dataBarQuickFormatCommand),this.selectedItem.preview=this.getDataBarFormatPreviewElement(e?function(e){for(let t=0;t<pa.length;t+=1)if(e===pa[t].key)return pa[t].customFormat;return null}(e):this.props.ruleInputData.getRuleInputValue()),R.createElement("div",{style:{marginTop:"4px"}},R.createElement(aa,{id:"ConditionalFormattingDataBarDropdown",nextFocusableElementId:this.props.nextFocusableElementId,prevFocusableElementId:this.props.prevFocusableElementId,itemsDropdownBlocksProps:this.createItemsDropdownBlockPropsList(),selectedItem:this.selectedItem}))}onDataBarValueChange(e){const t=this.props.ruleInputData;t.setCommandType(e),t.setWasChanged(),this.props.onInputChange(t)}createItemsDropdownBlockPropsList(){const e=[this.getIconItemProps(15,be.a.DataBarBlueGradient_32),this.getIconItemProps(16,be.a.DataBarGreenGradient_32),this.getIconItemProps(17,be.a.DataBarRedGradient_32),this.getIconItemProps(18,be.a.DataBarOrangeGradient_32),this.getIconItemProps(19,be.a.DataBarLightBlueGradient_32),this.getIconItemProps(20,be.a.DataBarPurpleGradient_32)],t={id:"ConditionalFormattingGradientDataBarBlock",label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.GradientFill),itemsProps:e,itemsNumberInLine:3},n=[this.getIconItemProps(21,be.a.DataBarBlueSolid_32),this.getIconItemProps(22,be.a.DataBarGreenSolid_32),this.getIconItemProps(23,be.a.DataBarRedSolid_32),this.getIconItemProps(24,be.a.DataBarOrangeSolid_32),this.getIconItemProps(25,be.a.DataBarLightBlueSolid_32),this.getIconItemProps(26,be.a.DataBarPurpleSolid_32)],o=[t,{id:"ConditionalFormattingSolidDataBarBlock",label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SolidFill),itemsProps:n,itemsNumberInLine:3}];if(null!==this.props.ruleInputData.getRuleInputValue()&&0===this.dataBarQuickFormatCommand){const e=this.getItemProps(0,this.getDataBarFormatPreview(),!0);e.justifyContent="left",e.width="100%",M&&(e.customTooltip=ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingCustomFormatText));const t={id:"ConditionalFormattingPreviewDataBarBlock",itemsProps:[e],itemsNumberInLine:1,seperatorAfterBlock:!M,label:M?ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingCustomFormatText):void 0};o.unshift(t)}return o}getIconItemProps(e,t){return this.getItemProps(e,this.getItemIconContent(t))}getItemProps(e,t,n=!1){let o=e;return 0!==this.dataBarQuickFormatCommand&&this.dataBarQuickFormatCommand===e&&(o=0),{commandType:o,text:ua.get(e),data:t,selectedItemId:this.selectedItem.id,onItemClick:this.onDataBarValueChange,hideTooltip:n}}getItemIconContent(e){return R.createElement(fe.a,{iconName:e,style:{height:"50px",width:"50px"}})}getDataBarFormatPreview(){if(M)return this.renderNewDataBarFormatPreview();const e=_object_spread({fontSize:"12px",marginRight:Object(ue.a)()?"10px":void 0,marginLeft:Object(ue.a)()?void 0:"10px"},K);if(null!=this.props.ruleInputData.getRuleInputValue())return R.createElement("div",{style:{display:"flex",padding:"0px",width:"100%",justifyContent:"left"}},R.createElement("div",null,this.getDataBarFormatPreviewElement(this.props.ruleInputData.getRuleInputValue())),R.createElement("span",{style:e},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingCustomFormatText)));throw new Error("Data bar input value is null")}getDataBarFormatPreviewElement(e){return null!=e?R.createElement(Ve,{rule:{ruleType:1,dataBarFormat:e}}):R.createElement("div",null)}constructor(e){super(e),this.renderNewDataBarFormatPreview=()=>{const e=this.props.ruleInputData.getRuleInputValue();if(null!=e)return R.createElement(Ve,{rule:{ruleType:1,dataBarFormat:e},style:la});throw new Error("Data bar input value is null")},this.onDataBarValueChange=this.onDataBarValueChange.bind(this),this.selectedItem={id:Ji+this.props.ruleInputData.getCommandType(),text:""},this.dataBarQuickFormatCommand=0}}const ua=new Map;ua.set(0,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingCustomFormatText)),ua.set(15,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingDataBarsBlueDataBar)),ua.set(16,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingDataBarsGreenDataBar)),ua.set(17,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingDataBarsRedDataBar)),ua.set(18,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingDataBarsOrangeDataBar)),ua.set(19,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingDataBarsLightBlueDataBar)),ua.set(20,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingDataBarsPurpleDataBar)),ua.set(21,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingDataBarsBlueDataBar)),ua.set(22,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingDataBarsGreenDataBar)),ua.set(23,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingDataBarsRedDataBar)),ua.set(24,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingDataBarsOrangeDataBar)),ua.set(25,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingDataBarsLightBlueDataBar)),ua.set(26,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingDataBarsPurpleDataBar));const da=e=>({isGradientFill:e.isGradientFill,borderColor:e.borderColor,fillColor:e.fillColor,isLTRDirection:!0,isNegativeValuesFillColorCustom:!1,negativeValuesFillColor:e.fillColor,isNegativeValuesBorderColorCustom:!1,negativeValuesBorderColor:e.borderColor,isShowValueEnabled:!0,axisColor:"#000000",axisPositionType:0}),pa=[{key:15,customFormat:da({isGradientFill:!0,borderColor:"#638EC6",fillColor:"#638EC6"})},{key:16,customFormat:da({isGradientFill:!0,borderColor:"#63C384",fillColor:"#63C384"})},{key:17,customFormat:da({isGradientFill:!0,borderColor:"#FF555A",fillColor:"#FF555A"})},{key:18,customFormat:da({isGradientFill:!0,borderColor:"#FFB628",fillColor:"#FFB628"})},{key:19,customFormat:da({isGradientFill:!0,borderColor:"#008AEF",fillColor:"#008AEF"})},{key:20,customFormat:da({isGradientFill:!0,borderColor:"#D6007B",fillColor:"#D6007B"})},{key:21,customFormat:da({isGradientFill:!1,borderColor:null,fillColor:"#638EC6"})},{key:22,customFormat:da({isGradientFill:!1,borderColor:null,fillColor:"#63C384"})},{key:23,customFormat:da({isGradientFill:!1,borderColor:null,fillColor:"#FF555A"})},{key:24,customFormat:da({isGradientFill:!1,borderColor:null,fillColor:"#FFB628"})},{key:25,customFormat:da({isGradientFill:!1,borderColor:null,fillColor:"#008AEF"})},{key:26,customFormat:da({isGradientFill:!1,borderColor:null,fillColor:"#D6007B"})}];function ga(e,t){return!(!e||!t)&&e.isGradientFill===t.isGradientFill&&e.borderColor===t.borderColor&&e.fillColor===t.fillColor}const ha={display:"flex",width:"45.25px",height:"50px",justifyContent:"center",alignItems:"center"},ma={width:"40px",height:"37px"};class ba extends R.Component{render(){const e=this.props.ruleInputData.getCommandType();return 0===e&&(this.colorScaleQuickFormatCommand=function(e){for(let t=0;t<Ea.length;t+=1)if(Sa(e,Ea[t].customFormat))return Ea[t].key;return null}(this.props.ruleInputData.getRuleInputValue())||this.colorScaleQuickFormatCommand),this.selectedItem.id=Ji+this.props.ruleInputData.getCommandType(),this.selectedItem.text=fa.get(e||this.colorScaleQuickFormatCommand),this.selectedItem.preview=this.getColorScaleFormatPreviewElement(e?function(e){for(let t=0;t<Ea.length;t+=1)if(e===Ea[t].key)return Ea[t].customFormat;return null}(e):this.props.ruleInputData.getRuleInputValue()),R.createElement("div",{style:{marginTop:"4px"}},R.createElement(aa,{id:"ConditionalFormattingColorScaleDropdown",nextFocusableElementId:this.props.nextFocusableElementId,prevFocusableElementId:this.props.prevFocusableElementId,itemsDropdownBlocksProps:this.createItemsDropdownBlockPropsList(),selectedItem:this.selectedItem}))}onColorScaleValueChange(e){const t=this.props.ruleInputData;t.setCommandType(e),t.setWasChanged(),this.props.onInputChange(t)}createItemsDropdownBlockPropsList(){const e=[{id:"ConditionalFormattingColorScaleBlock",itemsProps:[this.getIconItemProps(28,be.a.ColorScaleGYR_32),this.getIconItemProps(27,be.a.ColorScaleRYG_32),this.getIconItemProps(29,be.a.ColorScaleGWR_32),this.getIconItemProps(30,be.a.ColorScaleRWG_32),this.getIconItemProps(31,be.a.ColorScaleBWR_32),this.getIconItemProps(32,be.a.ColorScaleRWB_32),this.getIconItemProps(35,be.a.ColorScaleWR_32),this.getIconItemProps(36,be.a.ColorScaleRW_32),this.getIconItemProps(38,be.a.ColorScaleGW_32),this.getIconItemProps(37,be.a.ColorScaleWG_32),this.getIconItemProps(33,be.a.ColorScaleGY_32),this.getIconItemProps(34,be.a.ColorScaleYG_32)],itemsNumberInLine:4,hideBlockHeader:M}];if(null!=this.props.ruleInputData.getRuleInputValue()&&0===this.colorScaleQuickFormatCommand){const t=this.getItemProps(0,this.getColorScaleFormatPreview(),!0);t.justifyContent="left",t.width="100%",M&&(t.customTooltip=ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingCustomFormatText));const n={id:"ConditionalFormattingPreviewColorScaleBlock",itemsProps:[t],itemsNumberInLine:1,seperatorAfterBlock:!M,label:M?ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingCustomFormatText):void 0};M&&(e[0].hideBlockHeader=!1),e.unshift(n)}return e}getIconItemProps(e,t){return this.getItemProps(e,this.getItemIconContent(t))}getItemProps(e,t,n=!1){let o=e;return 0!==this.colorScaleQuickFormatCommand&&this.colorScaleQuickFormatCommand===e&&(o=0),{commandType:o,text:fa.get(e),data:t,selectedItemId:this.selectedItem.id,onItemClick:this.onColorScaleValueChange,hideTooltip:n}}getItemIconContent(e){return R.createElement(fe.a,{iconName:e,style:{height:"50px",width:"50px"}})}getColorScaleFormatPreview(){if(M)return this.renderNewColorScaleFormatPreview();const e=_object_spread({fontSize:"12px",marginRight:Object(ue.a)()?"10px":void 0,marginLeft:Object(ue.a)()?void 0:"10px"},K);if(null!=this.props.ruleInputData.getRuleInputValue())return R.createElement("div",{style:{display:"flex",padding:"0px",width:"100%",justifyContent:"left"}},R.createElement("div",null,this.getColorScaleFormatPreviewElement(this.props.ruleInputData.getRuleInputValue())),R.createElement("span",{style:e},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingCustomFormatText)));throw new Error("Color scale input value is null")}getColorScaleFormatPreviewElement(e){return null!=e?R.createElement(Ve,{rule:{ruleType:0,colorScaleFormat:e}}):R.createElement("div",null)}constructor(e){super(e),this.renderNewColorScaleFormatPreview=()=>{const e=this.props.ruleInputData.getRuleInputValue();if(null!=e)return R.createElement("div",{style:ha},R.createElement(Ve,{rule:{ruleType:0,colorScaleFormat:e},style:ma}));throw new Error("Color scale input value is null")},this.onColorScaleValueChange=this.onColorScaleValueChange.bind(this),this.selectedItem={id:Ji+this.props.ruleInputData.getCommandType(),text:""},this.colorScaleQuickFormatCommand=0}}const fa=new Map;fa.set(0,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingCustomFormatText)),fa.set(27,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingColorScalesRYG)),fa.set(28,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingColorScalesGYR)),fa.set(29,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingColorScalesGWR)),fa.set(30,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingColorScalesRWG)),fa.set(31,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingColorScalesBWR)),fa.set(32,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingColorScalesRWB)),fa.set(33,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingColorScalesGY)),fa.set(34,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingColorScalesYG)),fa.set(35,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingColorScalesWR)),fa.set(36,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingColorScalesRW)),fa.set(37,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingColorScalesWG)),fa.set(38,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingColorScalesGW));const xa=e=>({maximumColor:e.maximumColor,midpointColor:e.midpointColor,minimumColor:e.minimumColor}),Ea=[{key:27,customFormat:xa({maximumColor:"#F8696B",midpointColor:"#FFEB84",minimumColor:"#63BE7B"})},{key:28,customFormat:xa({maximumColor:"#63BE7B",midpointColor:"#FFEB84",minimumColor:"#F8696B"})},{key:29,customFormat:xa({maximumColor:"#63BE7B",midpointColor:"#FCFCFF",minimumColor:"#F8696B"})},{key:30,customFormat:xa({maximumColor:"#F8696B",midpointColor:"#FCFCFF",minimumColor:"#63BE7B"})},{key:31,customFormat:xa({maximumColor:"#5A8AC6",midpointColor:"#FCFCFF",minimumColor:"#F8696B"})},{key:32,customFormat:xa({maximumColor:"#F8696B",midpointColor:"#FCFCFF",minimumColor:"#5A8AC6"})},{key:33,customFormat:xa({maximumColor:"#63BE7B",midpointColor:null,minimumColor:"#FFEF9C"})},{key:34,customFormat:xa({maximumColor:"#FFEF9C",midpointColor:null,minimumColor:"#63BE7B"})},{key:35,customFormat:xa({maximumColor:"#FCFCFF",midpointColor:null,minimumColor:"#F8696B"})},{key:36,customFormat:xa({maximumColor:"#F8696B",midpointColor:null,minimumColor:"#FCFCFF"})},{key:37,customFormat:xa({maximumColor:"#FCFCFF",midpointColor:null,minimumColor:"#63BE7B"})},{key:38,customFormat:xa({maximumColor:"#63BE7B",midpointColor:null,minimumColor:"#FCFCFF"})}];function Sa(e,t){return!(!e||!t)&&e.maximumColor===t.maximumColor&&e.midpointColor===t.midpointColor&&e.minimumColor===t.minimumColor}const ya={display:"flex",width:"110px",height:"20px",justifyContent:"left"},Ca={height:"20px",width:"20px",marginLeft:"1px",marginRight:"1px"};class va extends R.Component{render(){const e=this.props.ruleInputData.getCommandType();0===e&&(this.iconSetQuickFormatCommand=function(e){let t=null;return je.b.forEach(n=>{(function(e,t){if(e&&t&&void 0!==e.icons&&null!==e.icons){if(e.icons.length!==t.icons.length)return!1;for(let n=0;n<t.icons.length;n+=1)if(e.icons[n].iconSet!==t.icons[n].iconSet||e.icons[n].index!==t.icons[n].index)return!1;return!0}return!1})(e,Ra(n.iconFormats))&&(t=n.command)}),t}(this.props.ruleInputData.getRuleInputValue())||this.iconSetQuickFormatCommand);const t=ka(e||this.iconSetQuickFormatCommand);return this.selectedItem.id=Ji+this.props.ruleInputData.getCommandType(),this.selectedItem.text=t.text,this.selectedItem.preview=this.getIconSetFormatPreviewElement(e?Ra(t.iconFormats):this.props.ruleInputData.getRuleInputValue()),R.createElement("div",{style:{marginTop:"4px"}},R.createElement(aa,{id:"ConditionalFormattingIconSetDropdown",nextFocusableElementId:this.props.nextFocusableElementId,prevFocusableElementId:this.props.prevFocusableElementId,itemsDropdownBlocksProps:this.createItemsDropdownBlockPropsList(),selectedItem:this.selectedItem}))}onIconSetValueChange(e){const t=this.props.ruleInputData;t.setCommandType(e),t.setWasChanged(),this.props.onInputChange(t)}createItemsDropdownBlockPropsList(){const e=[this.getIconItemProps(39),this.getIconItemProps(40),this.getIconItemProps(57),this.getIconItemProps(48),this.getIconItemProps(47),this.getIconItemProps(53),this.getIconItemProps(52)],t={id:"ConditionalFormattingDirectionalIconSetBlock",label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.IconSetsDirectional),itemsProps:e,itemsNumberInLine:2},n=[this.getIconItemProps(42),this.getIconItemProps(43),this.getIconItemProps(44),this.getIconItemProps(51),this.getIconItemProps(49)],o={id:"ConditionalFormattingShapesIconSetBlock",label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.IconSetsShapes),itemsProps:n,itemsNumberInLine:2},r=[this.getIconItemProps(45),this.getIconItemProps(46),this.getIconItemProps(41)],i={id:"ConditionalFormattingIndicatorsIconSetBlock",label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.IconSetsIndicators),itemsProps:r,itemsNumberInLine:2},a=[this.getIconItemProps(56),this.getIconItemProps(50),this.getIconItemProps(55),this.getIconItemProps(54),this.getIconItemProps(58)],s=[t,o,i,{id:"ConditionalFormattingRatingsIconSetBlock",label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.IconSetsRatings),itemsProps:a,itemsNumberInLine:2}];if(null!=this.props.ruleInputData.getRuleInputValue()&&0===this.iconSetQuickFormatCommand){const e=this.getItemProps(0,this.getIconSetFormatPreview(),!0);e.justifyContent="left",e.width="100%",M&&(e.customTooltip=ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingCustomFormatText));const t={id:"ConditionalFormattingPreviewIconSetBlock",itemsProps:[e],itemsNumberInLine:1,seperatorAfterBlock:!M,label:M?ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingCustomFormatText):void 0};s.unshift(t)}return s}getIconItemProps(e){return this.getItemProps(e,this.getItemContent(e))}getItemProps(e,t,n=!1){let o=e;return 0!==this.iconSetQuickFormatCommand&&this.iconSetQuickFormatCommand===e&&(o=0),{commandType:o,text:ka(e).text,data:t,selectedItemId:this.selectedItem.id,onItemClick:this.onIconSetValueChange,hideTooltip:n}}getItemContent(e){const t=[];return ka(e).icons.forEach(e=>{t.push(e)}),t.reverse(),R.createElement("div",{style:{display:"flex",border:"none",flexBasis:"100%",direction:"ltr",height:"20px",width:"110px"}},t.map(e=>R.createElement(fe.a,{iconName:e,key:e,style:{height:"20px",width:"20px",marginLeft:"1px",marginRight:"1px"}})))}getIconSetFormatPreview(){if(M)return this.renderNewIconSetFormatPreview();const e=_object_spread({fontSize:"12px",marginRight:Object(ue.a)()?"10px":void 0,marginLeft:Object(ue.a)()?void 0:"10px"},K);if(null!=this.props.ruleInputData.getRuleInputValue())return R.createElement("div",{style:{display:"flex",padding:"0px",width:"100%",justifyContent:"left"}},R.createElement("div",null,this.getIconSetFormatPreviewElement(this.props.ruleInputData.getRuleInputValue())),R.createElement("span",{style:e},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingCustomFormatText)));throw new Error("Icon set input value is null")}getIconSetFormatPreviewElement(e){return null!=e?R.createElement("div",{style:{display:"flex",maxWidth:"100px",padding:"0px"}},R.createElement(Ve,{rule:{ruleType:2,iconSetFormat:e}})):R.createElement("div",null)}constructor(e){super(e),this.renderNewIconSetFormatPreview=()=>{const e=this.props.ruleInputData.getRuleInputValue();if(null!=e)return R.createElement(Ve,{rule:{ruleType:2,iconSetFormat:e},style:ya,iconStyle:Ca});throw new Error("Icon set input value is null")},this.onIconSetValueChange=this.onIconSetValueChange.bind(this),this.selectedItem={id:Ji+this.props.ruleInputData.getCommandType(),text:""},this.iconSetQuickFormatCommand=0}}const Ra=e=>({icons:e,isReverseIconsOrder:!1});function ka(e){let t=null;return je.b.forEach(n=>{e===n.command&&(t=n)}),t}const Ta={fontSize:"12px"},_a=M?{marginTop:"8px"}:void 0;class wa extends R.Component{render(){const e=this.props.ruleInputData.getErrorIfNeeded();return R.createElement(we.a,null,t=>R.createElement(R.Fragment,null,!M&&R.createElement(jt.a,{id:"ConditionalFormattingFormulaRuleLabel",style:Ta},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingFormatFormulaTrue)),R.createElement("div",{"aria-labelledby":"ConditionalFormattingFormulaRuleLabel ConditionalFormattingFormulaRuleError",style:_a},R.createElement(De,{id:this.props.isNewRule?pe.getRequiredFirstPaneElementId():"FormulaValueInput",name:"FormulaRuleTextField",autoApply:!0,value:this.props.ruleInputData.getRuleInputValue(),sheetName:this.props.sheetName,styles:q(null===e,t),onChange:this.onFormulaValueChange,onCancelChanges:this.onFormulaValueChange,error:e||void 0,ariaLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingFormulaTextBox),placeholder:M?ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingFormulaPickerPlaceholder):void 0}))))}onFormulaValueChange(e){const t=this.props.ruleInputData;t.setRuleInputValue(e),t.setWasChanged(),this.props.onInputChange(t)}constructor(e){super(e),this.onFormulaValueChange=this.onFormulaValueChange.bind(this)}}const Da=Object(ut.a)({pivotItemLabel:{lineHeight:"16px",fontWeight:dt.a.fontWeightSemibold,fontSize:"12px"},pivotItemLabelWrapper:_object_spread({},pt.a.margin("12px","0px","12px","0px"),pt.a.padding("0px")),ruleTypeTabList:{display:"flex",flexDirection:"row",justifyContent:"space-between"},selectedRuleTabStyles:{[""+ui.a]:{backgroundColor:"Highlight !important",color:"HighlightText !important","& path":{fill:"ButtonFace !important"},":hover":{backgroundColor:"transparent !important","& path":{fill:"highlight !important"}},":focus":{outlineColor:"ButtonText",outlineStyle:"solid",outlineWidth:"2px"}}}});var Pa=n(2223),Ia=n(365);const Fa=(e,t)=>(Object(vt.a)(e),Object(Ct.a)(e.root,{children:Object(Ct.a)(Ia.a,{value:t.tabList,children:e.root.children})}));var Ba=n(2225),Ma=n(2224),ja=n(573);const Oa=R.forwardRef((e,t)=>{const n=Object(Pa.a)(e,t),o=Object(Ma.a)(n);return Object(Ba.a)(n),Object(ja.c)("useTabListStyles_unstable")(n),Fa(n,o)});Oa.displayName="TabList";var La=n(1791),Aa=n(1792),Na=n(2250);const Wa=R.forwardRef((e,t)=>{const n=Object(La.a)(e,t);return Object(Na.b)(n),Object(ja.c)("useTabStyles_unstable")(n),Object(Aa.a)(n)});Wa.displayName="Tab";var za=n(43),Ha=n.n(za);const Va=e=>{const t=Da(),n=Object(Rt.a)("ms-Button","ms-ButtonNext"),o=t.selectedRuleTabStyles;return R.createElement("div",null,R.createElement(Oa,{id:e.id,className:t.ruleTypeTabList,defaultSelectedValue:Ua(e.selectedKey),onTabSelect:(t,n)=>{e.onChange&&n&&e.onChange(parseInt(n.value,10))}},Ga.map(t=>R.createElement(Ee.a,{key:t.key,content:t.text},R.createElement(Wa,{icon:{children:R.createElement(fe.a,{iconName:t.iconName})},value:t.key,id:"RuleTypeTab"+t.key,"aria-label":t.text,className:t.key===Ua(e.selectedKey)?o:n})))),R.createElement(ct.a,{forId:"RuleTypeTabList"+Ua(e.selectedKey),id:"RuleTypeTabLabel",label:Ga[e.selectedKey||0].text,type:"AppLabelProps",className:t.pivotItemLabel,labelWrapperClassName:t.pivotItemLabelWrapper}))},Ua=e=>void 0===e?Ga[0].key:e,Ga=[{key:Sn.HighlightCellsWith,iconName:hr.a.FlyoutAnchorCFHighlightCells_20,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingRuleTypeHighlightCellsWith)},{key:Sn.TopBottom,iconName:hr.a.FormattingRuleTop10_20,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingRuleTypeHighlightTopOrBottom)},{key:Sn.DataBars,iconName:hr.a.FormattingRuleDataBar_20,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingDataBars)},{key:Sn.ColorScales,iconName:hr.a.FormattingRuleGrad3_20,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingColorScales)},{key:Sn.IconSets,iconName:hr.a.FormattingRuleIconSet_20,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingIconSets)},{key:Sn.Formula,iconName:Ha.a.Function_20,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingFormatFormulaRuleTypeLabel)}],qa={marginTop:"12px",marginLeft:"2px"};var Qa=n(2227),Ka=n(2241),Ja=n(2509);const Ya=Object(ut.a)({base:{left:_o.a.spacingHorizontalSNudge}}),Za=Object(ut.a)({base:_object_spread({},pt.a.borderRadius(_o.a.borderRadiusMedium))}),$a=Object(ut.a)({base:_object_spread({},pt.a.padding(_o.a.spacingVerticalNone))}),Xa=R.memo(R.forwardRef((e,t)=>{const n=Object(Ka.a)(_object_spread_props(_object_spread({},e),{size:"medium"}),t);return(e=>{const t=Ya(),n=Za(),o=$a();e.input&&(e.input.className=Object(Rt.a)(t.base,e.input.className)),e.indicator&&(e.indicator.className=Object(Rt.a)(n.base,e.indicator.className)),e.label&&(e.label.className=Object(Rt.a)(o.base,e.label.className)),Object(Ja.a)(e)})(n),Object(Qa.a)(n)}));Xa.displayName="next/TaskPaneCheckbox";const es=Object(ut.a)({StopIfTrueCheckboxLabelStyle:{fontSize:"12px"}}),ts=e=>{if(!e.ruleInputData.doesSupportStopIfTrueOrFormatInput())return R.createElement(R.Fragment,null);const t=es();return R.createElement(wt.a,{alignContent:"end",role:"none","aria-orientation":void 0,"aria-labelledby":void 0},R.createElement(Xa,{id:"StopIfTrueCheckboxId",type:"AppCheckboxProps",checked:e.isStopIfTrueChecked,checkmarkIcon:Po.a.checkboxCheckmark,customTooltip:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingStopIfTrueTooltipContent),onExecute:t=>e.onStopIfTrueChange(void 0,t.checked),label:{className:t.StopIfTrueCheckboxLabelStyle,children:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingStopIfTrueText)},"aria-label":ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingStopIfTrueTooltipContent)}))};class ns extends R.Component{render(){return M?this.renderRuleInputV2():R.createElement("div",{style:qa},R.createElement(An,{selectedKey:this.props.ruleInputData.getInputType(),onChange:this.props.onRuleTypeChange,id:this.props.ruleTypeElementId}),this.getInputContent(),this.getFormatContent())}getInputContent(){switch(this.props.ruleInputData.getInputType()){case Sn.TopBottom:return R.createElement("div",{style:{marginTop:"4px"}},R.createElement(Wo,{isNewRule:this.props.isNewRule,ruleInputData:this.props.ruleInputData,onInputChange:this.props.onInputChange}));case Sn.HighlightCellsWith:return R.createElement(qi,{isNewRule:this.props.isNewRule,ruleInputData:this.props.ruleInputData,onInputChange:this.props.onInputChange,onHighlightCellsWithChange:this.props.onHighlightCellsWithChange,sheetName:this.props.sheetName});case Sn.DataBars:return R.createElement(ca,{nextFocusableElementId:this.props.doneButtonElementId,prevFocusableElementId:this.props.ruleTypeElementId,ruleInputData:this.props.ruleInputData,onInputChange:this.props.onInputChange});case Sn.ColorScales:return R.createElement(ba,{nextFocusableElementId:this.props.doneButtonElementId,prevFocusableElementId:this.props.ruleTypeElementId,ruleInputData:this.props.ruleInputData,onInputChange:this.props.onInputChange});case Sn.IconSets:return R.createElement(va,{nextFocusableElementId:this.props.doneButtonElementId,prevFocusableElementId:this.props.ruleTypeElementId,ruleInputData:this.props.ruleInputData,onInputChange:this.props.onInputChange});case Sn.Formula:return R.createElement(wa,{isNewRule:this.props.isNewRule,ruleInputData:this.props.ruleInputData,onInputChange:this.props.onInputChange,sheetName:this.props.sheetName})}return R.createElement("div",null)}getFormatContent(){return this.props.ruleInputData.doesSupportStopIfTrueOrFormatInput()?R.createElement(ki,{selectedFormat:this.props.ruleFormat,onChange:this.props.onFormatChange}):R.createElement("div",null)}renderRuleInputV2(){return R.createElement("div",null,R.createElement(Va,{selectedKey:this.props.ruleInputData.getInputType(),onChange:this.props.onRuleTypeChange,id:this.props.ruleTypeElementId}),this.getInputContent(),R.createElement(ts,{ruleInputData:this.props.ruleInputData,isStopIfTrueChecked:this.props.isStopIfTrueChecked,onStopIfTrueChange:this.props.onStopIfTrueChange}),this.getFormatContent())}constructor(e){super(e)}}var os=n(1361),rs=n(1139),is=n(2628);const as={root:{boxShadow:"rgba(0, 0, 0, 0.22) 0px 25.6px 57.6px 0px, rgba(0, 0, 0, 0.18) 0px 4.8px 14.4px 0px",backgroundColor:"white",overflow:"hidden"}},ss={root:{fontSize:"22px",color:"#217346",margin:"20px",marginBottom:"15px"}},ls={root:{fontSize:"14px",color:"rgb(133, 133, 133)"}},cs={minHeight:"150px",width:"270px",display:"flex",flexDirection:"column",justifyContent:"space-between",overflowY:"hidden",overflowX:"hidden"},us={display:"flex",flexDirection:"row",justifyContent:"space-between"},ds={marginLeft:"20px",marginRight:"20px"},ps={display:"flex",alignSelf:"flex-end",margin:"15px"},gs={marginLeft:"10px"};class hs extends R.Component{componentDidMount(){var e;M||null===(e=document.getElementById(this.beforeYouGoApplyButtonId))||void 0===e||e.focus()}render(){return M?R.createElement(os.a,{role:"dialog",onDismiss:this.props.rejectViewChange,directionalHint:Se.a.topCenter,coverTarget:!0,target:this.props.beforeYouGoRef.current,isBeakVisible:!1,shouldRestoreFocus:!1,styles:as},this.renderCalloutBody()):R.createElement(Qi.a,{role:"dialog",onDismiss:this.props.rejectViewChange,directionalHint:Se.a.topCenter,coverTarget:!0,target:this.props.beforeYouGoRef.current,isBeakVisible:!1,shouldRestoreFocus:!1,styles:as},this.renderCalloutBody())}renderCalloutBody(){return R.createElement("div",{style:cs},R.createElement("div",{style:us},R.createElement(rs.a,{styles:ss},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingBeforeYouGoDialogTitle)),R.createElement(Ee.a,{content:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.Close),directionalHint:Se.a.leftTopEdge},R.createElement(is.a,{type:"AppIconButtonProps",iconProps:Object(mi.a)(c.a.CancelGlyph_16),onClick:this.props.rejectViewChange,id:this.beforeYouGoCloseButtonId,"aria-label":ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.Close),onKeyDown:M?void 0:this.onKeyDownCloseButtonBeforeYouGo}))),R.createElement("div",{style:ds},R.createElement(rs.a,{styles:ls},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingBeforeYouGoDialogMessage))),R.createElement("div",{style:ps},R.createElement(pr.a,{id:this.beforeYouGoApplyButtonId,styles:this.props.primaryButtonStyle,onClick:this.props.applyChangesAndConfirmViewChange,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingBeforeYouGoDialogApplyChanges),onKeyDown:M?void 0:this.onKeyDownApplyButtonBeforeYouGo}),R.createElement(pr.a,{id:this.beforeYouGoDiscardButtonId,styles:this.props.buttonStyle,style:gs,onClick:this.props.resetChangesAndConfirmViewChange,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingBeforeYouGoDialogDiscardChanges),onKeyDown:M?void 0:this.onKeyDownDiscardButtonBeforeYouGo})))}onKeyDownDiscardButtonBeforeYouGo(e){var t,n;"Tab"===e.key?(e.shiftKey?null===(t=document.getElementById(this.beforeYouGoApplyButtonId))||void 0===t||t.focus():null===(n=document.getElementById(this.beforeYouGoCloseButtonId))||void 0===n||n.focus(),e.preventDefault()):"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),this.props.resetChangesAndConfirmViewChange())}onKeyDownCloseButtonBeforeYouGo(e){var t,n;"Tab"===e.key?(e.shiftKey?null===(t=document.getElementById(this.beforeYouGoDiscardButtonId))||void 0===t||t.focus():null===(n=document.getElementById(this.beforeYouGoApplyButtonId))||void 0===n||n.focus(),e.preventDefault()):"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),this.props.rejectViewChange())}onKeyDownApplyButtonBeforeYouGo(e){"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),this.props.applyChangesAndConfirmViewChange())}constructor(e){super(e),this.beforeYouGoCloseButtonId="ConditionalFormattingBeforeYouGoDialogCloseButton",this.beforeYouGoApplyButtonId="ConditionalFormattingBeforeYouGoDialogApplyButton",this.beforeYouGoDiscardButtonId="ConditionalFormattingBeforeYouGoDialogDiscardButton",this.onKeyDownCloseButtonBeforeYouGo=this.onKeyDownCloseButtonBeforeYouGo.bind(this),this.onKeyDownDiscardButtonBeforeYouGo=this.onKeyDownDiscardButtonBeforeYouGo.bind(this),this.onKeyDownApplyButtonBeforeYouGo=this.onKeyDownApplyButtonBeforeYouGo.bind(this)}}const ms=Object(ut.a)({root:{display:"flex",flexDirection:"row",alignItems:"center",columnGap:"4px"},rangePickerDiv:{marginTop:"4px",flexGrow:1},label:{fontSize:"12px",fontWeight:dt.a.fontWeightSemibold,lineHeight:"16px"},labelWrapper:_object_spread_props(_object_spread({},pt.a.padding("0px","0px","0px","2px"),pt.a.flex("none")),{display:"flex"}),rangePickerContainer:{marginTop:"4px",flexGrow:1}}),bs=(e,t)=>({contentRoot:_object_spread({},L(null===e,t))}),fs=e=>{const t=ms(),n=e.ruleRangeData.getErrorMessage(e.isNewRule,e.deletedSheets);return R.createElement(we.a,null,o=>{var r;return R.createElement("div",{className:t.root},R.createElement(ct.a,{forId:"ConditionalFormattingRuleRangeTextField",id:"ConditionalFormattingRuleRangeLabel",type:"AppLabelProps",label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingApplyTo),className:t.label,labelWrapperClassName:t.labelWrapper}),R.createElement("div",{className:t.rangePickerContainer},R.createElement(De,{id:"ConditionalFormattingRuleRangeTextField",supportOnlyRanges:!0,useAbsoluteRef:!1,blockSwitchingSheets:!e.isNewRule,value:e.ruleRangeData.rangeString,sheetName:e.getDefaultSheetName(),onChange:e.onRangeChanged,onCancelChanges:e.onRangeChangesDiscarded,onApplyChanges:e.onRangeChangesAccepted,styles:bs(n,o),error:n||void 0,sheetRenameEvent:null===(r=e.notification)||void 0===r?void 0:r.sheetRenameEvent,onStartPicking:e.onStartRangePicker,"aria-label":ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingApplyTo)+(n||""),placeholder:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingRuleRangePickerPlaceholder)})))})},xs={root:{padding:"2px",color:"#217346",fontSize:"12px",selectors:{":hover":{color:"#0e5c2f"},":focus":_object_spread_props(_object_spread({},Q()),{color:"#217346",boxShadow:"none !important",borderRadius:"0px"}),":active":{outline:"none",border:"none"},":focus:after":{outline:"none",border:"none"}}}},Es={root:{fontSize:"12px",height:"28px"}},Ss={root:{fontSize:"12px",height:"28px",backgroundColor:"#217346",color:"white",":focus:after":{outlineColor:"white !important"}},rootHovered:{backgroundColor:"#0e5c2f",color:"white"}},ys={alignSelf:"flex-end",marginBottom:"15px",marginTop:"15px"},Cs={marginLeft:"8px",marginRight:"8px"},vs=_object_spread({position:"absolute",height:"100%"},H()),Rs={position:"absolute",height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between",marginRight:Object(ue.a)()?"0px":A,marginLeft:Object(ue.a)()?N:"0px",right:"0px",left:"0px"},ks={root:{height:"14px",fontSize:"12px",padding:"0px"}},Ts={root:{width:"16px",height:"16px",marginLeft:"3px"}},_s={root:{height:"16px",width:"16px",padding:"3px",selectors:{":hover":{cursor:"help"},":focus":Q(),":active":{outline:"none",border:"none"},":focus:after":{outline:"none",border:"none"}}}},ws={checkbox:{borderRadius:"0%",height:"16px",width:"16px",marginTop:"1px",marginLeft:"1px"},text:{fontSize:"12px"},root:[{[F.m]:{":focus,:focus-within,:active,:focus:after":Q()}}]},Ds={marginTop:"4px",display:"flex",flexDirection:"row",marginLeft:"3px"},Ps={padding:"5px 0px 4px 0px",margin:"4px 0px 4px 0px",width:"auto"},Is=e=>({padding:"12px",gap:"4px",borderRadius:"8px",background:e.palette.white,boxShadow:"rgba(0, 0, 0, 0.1) 0px 0.3px 0.9px, rgba(0, 0, 0, 0.13) 0px 1.6px 3.6px",marginLeft:"2px",marginTop:"1px"}),Fs={marginTop:"12px",display:"flex",flexDirection:"row",gap:"2px"},Bs={root:{width:"16px",height:"16px",padding:"0px 2px",flexShrink:0}},Ms={fontSize:"12px",lineHeight:"16px",fontWeight:"400",margin:"0px"},js={fontSize:"12px",lineHeight:"16px",fontWeight:"400"},Os={alignSelf:"flex-end",marginBottom:"15px",marginTop:"15px"},Ls=Object(ut.a)({doneButtonStyle:{marginRight:"8px"}}),As=e=>{const t=Ls();return R.createElement("div",{id:"ConditionalFormattingRuleEditorFooter",style:Os},R.createElement(dn,{appearance:"primary",id:e.doneButtonElementId,onExecute:e.onDoneButtonClick,label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingRuleEditWindowDone),disabled:e.shouldDisableDoneButton,className:t.doneButtonStyle}),R.createElement(dn,{id:"RuleEditorCancelButton",appearance:"secondary",label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingRuleEditWindowCancel),onExecute:e.onCancelButtonClick}))},Ns={[Sn.HighlightCellsWith]:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingInfoTextHighlightCells),[Sn.TopBottom]:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingInfoTextTopBottom),[Sn.DataBars]:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingInfoTextDataBars),[Sn.ColorScales]:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingInfoTextColorScale),[Sn.IconSets]:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingInfoTextIconSets),[Sn.Formula]:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingInfoFormula)};class Ws extends R.Component{static getDerivedStateFromProps(e,t){const n=t.ruleData;if(!t.ownUpdate&&n&&e.notification){var o,r;const i={ruleData:n,deletedSheets:t.deletedSheets,ownUpdate:!1};return null!==(o=e.notification.sheetRenameEvent)&&void 0!==o&&o.newSheetName&&n.getRange().onSheetRename(e.notification.sheetRenameEvent),null!==(r=e.notification.sheetDeletedEvent)&&void 0!==r&&r.sheetName&&n.isNewRule()&&(i.deletedSheets.push(e.notification.sheetDeletedEvent.sheetName),i.allowDiscardingDeletedSheets=!1),i}return t.ownUpdate||!e.rule||e.showConfirmation?{ruleData:t.ruleData,ownUpdate:!1}:{ruleData:it(Ws.RuleInputFactory,e.rule),ownUpdate:!1}}componentDidMount(){pe.setFocusOnPaneFirstElement()}render(){return M?this.renderV2Experience():R.createElement("div",{id:"ConditionalFormattingTaskPaneRuleEditorId",style:vs},R.createElement(Ft,{containerStyle:{minWidth:"304px"}},R.createElement("div",{style:Rs},R.createElement("div",null,R.createElement(Ut.a,{styles:xs,onClick:()=>this.resetChangesAndMoveToManagerView("ManageRulesLink")},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingGoToManageRules)),this.getRuleRangeContent(),this.getStopIfTrueCheckbox(),R.createElement("div",{ref:this.beforeYouGoRef},this.getRuleInputContent()),this.getBeforeYouGoDialog()),R.createElement("div",{id:"ConditionalFormattingRuleEditorFooter",style:ys},R.createElement(pr.a,{id:this.getDoneButtonElementId(),styles:Ss,style:Cs,onClick:()=>this.applyChangesAndMoveToManagerView("DoneButton"),text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingRuleEditWindowDone),disabled:this.shouldDisableDoneButton()}),R.createElement(pr.a,{styles:Es,onClick:()=>this.resetChangesAndMoveToManagerView("CancelButton"),text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingRuleEditWindowCancel)})))))}renderV2Experience(){return R.createElement(we.a,null,e=>R.createElement("div",{id:"ConditionalFormattingTaskPaneRuleEditorId",style:vs},R.createElement(Ft,{containerStyle:{minWidth:"304px"}},R.createElement("div",{style:Rs},R.createElement("div",null,R.createElement("div",{style:Is(e)},M?R.createElement(R.Fragment,null):R.createElement(Ut.a,{styles:xs,onClick:()=>this.resetChangesAndMoveToManagerView("ManageRulesLink")},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingGoToManageRules)),R.createElement(fs,{ruleRangeData:this.state.ruleData.getRange(),isNewRule:this.state.ruleData.isNewRule(),deletedSheets:this.state.deletedSheets,onStartRangePicker:this.onStartRangePicker,getDefaultSheetName:this.getDefaultSheetName,onRangeChanged:this.onRangeChanged,onRangeChangesDiscarded:this.onRangeChangesDiscarded,onRangeChangesAccepted:this.onRangeChangesAccepted,notification:this.props.notification}),R.createElement(wt.a,{style:Ps}),R.createElement("div",{ref:this.beforeYouGoRef},this.getRuleInputContent()),this.getBeforeYouGoDialog()),R.createElement("div",{style:Fs},R.createElement(fe.a,{iconName:be.a.InfoFluent_16,styles:Bs}),R.createElement(nn.a,{as:"p",style:Ms},this.getHelpText()," ",R.createElement(on.a,{onClick:()=>pe.onEmptyPaneHelpLinkClick(),rel:"noopener noreferrer",style:js},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingRuleEditorLearnMore))))),M?R.createElement(As,{doneButtonElementId:this.getDoneButtonElementId(),shouldDisableDoneButton:this.shouldDisableDoneButton(),onDoneButtonClick:()=>this.applyChangesAndMoveToManagerView("DoneButton"),onCancelButtonClick:()=>this.resetChangesAndMoveToManagerView("CancelButton")}):R.createElement("div",{id:"ConditionalFormattingRuleEditorFooter",style:ys},R.createElement(pr.a,{id:this.getDoneButtonElementId(),styles:Ss,style:Cs,onClick:()=>this.applyChangesAndMoveToManagerView("DoneButton"),text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingRuleEditWindowDone),disabled:this.shouldDisableDoneButton()}),R.createElement(pr.a,{styles:Es,onClick:()=>this.resetChangesAndMoveToManagerView("CancelButton"),text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingRuleEditWindowCancel)}))))))}componentDidCatch(e,t){i.a.sendTraceTag(579736727,a.a.msoulscat_ES_EWAJS,s.a.Error,`ConditionalFormattingTaskPaneReact.RuleEditor: RuleEditor component failed to render: ${e.toString()} , ${t.componentStack}`)}getRuleRangeContent(){var e;const t=this.state.ruleData.getRange().getErrorMessage(this.state.ruleData.isNewRule(),this.state.deletedSheets);return R.createElement("div",{style:{marginTop:"12px"}},R.createElement(jt.a,{styles:ks,htmlFor:"ConditionalFormattingRuleRangeTextField"},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingApplyToRange)),R.createElement("div",{style:{marginTop:"4px"}},R.createElement(De,{id:"ConditionalFormattingRuleRangeTextField",supportOnlyRanges:!0,useAbsoluteRef:!1,blockSwitchingSheets:!this.state.ruleData.isNewRule(),value:this.state.ruleData.getRange().rangeString,sheetName:this.getDefaultSheetName(),onChange:this.onRangeChanged,onCancelChanges:this.onRangeChangesDiscarded,onApplyChanges:this.onRangeChangesAccepted,styles:{contentRoot:_object_spread({},G(null===t))},error:t||void 0,sheetRenameEvent:null===(e=this.props.notification)||void 0===e?void 0:e.sheetRenameEvent,onStartPicking:this.onStartRangePicker,"aria-label":ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingApplyToRange)+(t||"")})))}getStopIfTrueCheckbox(){return this.state.ruleData.getRuleInputData().doesSupportStopIfTrueOrFormatInput()?R.createElement("div",{style:Ds},R.createElement(yo.a,{styles:ws,checked:this.state.ruleData.getStopIfTrue(),onChange:this.onStopIfTrueChange,label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingStopIfTrue),theme:Object(Co.a)({semanticColors:{inputBorderHovered:"#217346",inputBackgroundChecked:"#217346"},palette:{themeDark:"#217346"}})}),R.createElement(Ee.a,{content:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingStopIfTrueTooltipContent),styles:Ts},R.createElement(fe.a,_object_spread_props(_object_spread({role:"tooltip"},Object(mi.a)(be.a.Info_20)),{styles:_s,"aria-label":`${ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingStopIfTrueInfoRole)}, ${ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingStopIfTrueTooltipContent)}`,tabIndex:0})))):R.createElement("div",{style:{height:"20px"}})}getRuleInputContent(){return R.createElement(ns,{isNewRule:this.state.ruleData.isNewRule(),ruleTypeElementId:this.getRuleTypeElementId(),doneButtonElementId:this.getDoneButtonElementId(),ruleInputData:this.state.ruleData.getRuleInputData(),sheetName:this.state.ruleData.getRange().sheetName||this.getDefaultSheetName(),ruleFormat:this.state.ruleData.getFormatInputData(),onRuleTypeChange:this.onTypeChange,onHighlightCellsWithChange:this.onHighlightCellsWithChange,onInputChange:this.onInputChange,onFormatChange:this.onFormatChange,isStopIfTrueChecked:this.state.ruleData.getStopIfTrue(),onStopIfTrueChange:this.onStopIfTrueChange})}isRuleRangeValid(){return this.state.ruleData.getRange().isValid(this.state.ruleData.isNewRule(),this.state.deletedSheets)}isRuleDataValid(){return this.state.ruleData.getRuleInputData().isValid()&&this.isRuleRangeValid()}wasRuleInputChanged(){return this.state.ruleData.getRuleInputData().wasChanged()}shouldDisableDoneButton(){var e;const t=this.isRuleRangeValid(),n=!(null!==(e=this.state.ruleData.getRuleInputData())&&void 0!==e&&e.shouldShowError());return!t||!n}applyChangesAndConfirmViewChange(){this.applyChanges()?(i.a.sendTraceTag(507618459,a.a.msoulscat_ES_EWAJS,s.a.Info,`RuleEditor.applyChangesAndConfirmViewChange: Rule Applied using confirmation dialog, was new rule: ${this.state.ruleData.isNewRule()}, was if true then stop selected: ${this.state.ruleData.getStopIfTrue()}`),this.props.onConfirmationResponse(!0)):this.rejectViewChange(),this.showingDialog=!1}resetChangesAndConfirmViewChange(e){i.a.sendTraceTag(506853333,a.a.msoulscat_ES_EWAJS,s.a.Info,`RuleEditor.resetChangesAndConfirmViewChange: Updates to rule discarded. Source:${e}, NewRule: ${this.state.ruleData.isNewRule()}`),this.props.onConfirmationResponse(!0),this.showingDialog=!1}rejectViewChange(){this.props.onConfirmationResponse(!1),this.showingDialog=!1}applyChangesAndMoveToManagerView(e){this.applyChanges()&&(i.a.sendTraceTag(507618458,a.a.msoulscat_ES_EWAJS,s.a.Info,`RuleEditor.resetChangesAndMoveToManagerView: Moved to Manage Rule from source: ${e}, was new rule: ${this.state.ruleData.isNewRule()}, was if true then stop selected: ${this.state.ruleData.getStopIfTrue()}`),this.props.onChangeViewRequest(1))}resetChangesAndMoveToManagerView(e){i.a.sendTraceTag(507618457,a.a.msoulscat_ES_EWAJS,s.a.Info,`RuleEditor.resetChangesAndMoveToManagerView: Moved to Manage Rule from source: ${e}, was new rule: ${this.state.ruleData.isNewRule()}`),this.props.onChangeViewRequest(1)}applyChanges(){if(this.isRuleDataValid()){const e={},t=!this.state.ruleData.isNewRule(),n=this.state.ruleData.getRuleInputData();let o=null;n.doesSupportStopIfTrueOrFormatInput()&&this.state.ruleData.getFormatInputData().hasChanges()?this.state.ruleData.getFormatInputData().isQuickFormat()?e.quickFormat=this.state.ruleData.getFormatInputData().getQuickFormat():(e.quickFormat=6,o=this.state.ruleData.getFormatInputData().getCustomFormat()):e.quickFormat=-1,t&&!this.wasRuleInputChanged()?e.command=0:n&&n.updateConditionalFormattingOptions(e);const r={guid:this.state.ruleData.getGuid(),range:this.state.ruleData.getRange().isDirty()||!t?this.state.ruleData.getRange().rangeString:null,ruleRangeSheetName:this.state.ruleData.getRange().sheetName,activeCell:this.state.ruleData.getRange().activeCell,stopIfTrue:n.doesSupportStopIfTrueOrFormatInput()&&this.state.ruleData.getStopIfTrue(),options:e,customFormat:o};return t?(pe.onRuleEdited(r),null!=r.range&&i.a.sendTraceTag(542914070,a.a.msoulscat_ES_EWAJS,s.a.Info,"RuleEditor.applyChanges: Conditional Formatting Rule range was modified via the Rule Editor")):(pe.onRuleAdded(r),r.stopIfTrue&&i.a.sendTraceTag(539890389,a.a.msoulscat_ES_EWAJS,s.a.Info,"ConditionalFormattingTaskPaneReact.RuleEditor: New rule added with stopIfTrue"),r.customFormat&&i.a.sendTraceTag(539890390,a.a.msoulscat_ES_EWAJS,s.a.Info,"ConditionalFormattingTaskPaneReact.RuleEditor: New rule added with customFormat")),Ge(ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ConditionalFormattingRuleEditWindowDoneActionMessage)),!0}if(!this.shouldDisableDoneButton()){i.a.sendTraceTag(575501088,a.a.msoulscat_ES_EWAJS,s.a.Info,`ConditionalFormattingTaskPaneReact.RuleEditor: Apply changes while in initial view on ${null!=this.state.ruleData.getGuid()?"exsiting":"new"} rule`);const e=this.state.ruleData.getRuleInputData();e.setShouldShowErrorWhenInvalid(!0),this.setRuleInputOnState(e)}return!1}getBeforeYouGoDialog(){return this.props.showConfirmation?(this.showingDialog||(this.showingDialog=!0),this.wasRuleInputChanged()?R.createElement(hs,{beforeYouGoRef:this.beforeYouGoRef,rejectViewChange:this.rejectViewChange,applyChangesAndConfirmViewChange:this.applyChangesAndConfirmViewChange,resetChangesAndConfirmViewChange:()=>this.resetChangesAndConfirmViewChange("DiscardButton"),primaryButtonStyle:Ss,buttonStyle:Es}):(this.resetChangesAndConfirmViewChange("NoChangeDetected"),R.createElement(R.Fragment,null))):(this.showingDialog=!1,R.createElement(R.Fragment,null))}onTypeChange(e){let t=null;if(!this.state.ruleData.isNewRule())switch(e){case Sn.DataBars:t=this.state.ruleData.getDataBarFormat();break;case Sn.ColorScales:t=this.state.ruleData.getColorScaleFormat();break;case Sn.IconSets:t=this.state.ruleData.getIconSetFormat()}this.setRuleInputOnState(Ws.RuleInputFactory.createDefaultRuleInputDataByRuleTypeOption(e,t))}onHighlightCellsWithChange(e){this.setRuleInputOnState(Ws.RuleInputFactory.createDefaultRuleInputDataByHighlightCellsWithOption(e))}onStopIfTrueChange(e,t){if(null!=t){const e=this.state.ruleData;e.setStopIfTrue(t),this.setState({ruleData:e,ownUpdate:!0})}}onInputChange(e){this.setRuleInputOnState(e)}setRangeErrorMessageAlert(){const e=document.getElementById(this.rangeErrorMessageId);if(e){e.setAttribute("aria-label",""),e.setAttribute("role","");const t=this.state.ruleData.getRange().getErrorMessage(this.state.ruleData.isNewRule(),this.state.deletedSheets);t&&(e.setAttribute("aria-label",t),e.setAttribute("role","alert"))}}onStartRangePicker(){this.state.deletedSheets.length>0&&this.setState({allowDiscardingDeletedSheets:!0,ownUpdate:!0})}onRangeChanged(e,t,n=!1){const o=this.state.ruleData;o.updateRange({rangeString:e,sheetName:t,activeCell:null}),this.setState({ruleData:o,allowDiscardingDeletedSheets:!0,deletedSheets:n?[]:this.state.deletedSheets,ownUpdate:!0},()=>this.setRangeErrorMessageAlert())}onRangeChangesAccepted(e,t){this.onRangeChanged(e,t||this.state.ruleData.getRange().sheetName,this.state.allowDiscardingDeletedSheets)}onRangeChangesDiscarded(e,t){this.onRangeChanged(e,t||this.state.ruleData.getRange().sheetName)}onFormatChange(e){const t=this.state.ruleData;t.setFormatInputData(e),this.setState({ruleData:t,ownUpdate:!0})}setRuleInputOnState(e){const t=this.state.ruleData;t.setRuleInputData(e),this.setState({ruleData:t,ownUpdate:!0})}getDoneButtonElementId(){return this.state.ruleData.canFocusOnRuleInput()||!this.state.ruleData.isNewRule()?"ConditionalFormattingRuleEditorDoneButton":pe.getRequiredFirstPaneElementId()}getRuleTypeElementId(){return An.getDropdownElementId(this.state.ruleData.isNewRule())}constructor(e){super(e),this.showingDialog=!1,this.rangeErrorMessageId="CondFmtRangeErrorMessage",this.beforeYouGoRef=R.createRef(),this.getDefaultSheetName=()=>{if(this.state.ruleData.isNewRule()){const e=this.state.ruleData.getRange().sheetName;return e&&this.state.deletedSheets.indexOf(e)<0?e:void 0}return this.state.ruleData.getRange().initialData.sheetName},this.getHelpText=()=>{const e=this.state.ruleData.getRuleInputData().getInputType();return Ns[e]},this.state={ruleData:it(Ws.RuleInputFactory,e.rule),deletedSheets:[],allowDiscardingDeletedSheets:!0,ownUpdate:!0},this.applyChanges=this.applyChanges.bind(this),this.applyChangesAndConfirmViewChange=this.applyChangesAndConfirmViewChange.bind(this),this.resetChangesAndConfirmViewChange=this.resetChangesAndConfirmViewChange.bind(this),this.applyChangesAndMoveToManagerView=this.applyChangesAndMoveToManagerView.bind(this),this.resetChangesAndMoveToManagerView=this.resetChangesAndMoveToManagerView.bind(this),this.getBeforeYouGoDialog=this.getBeforeYouGoDialog.bind(this),this.rejectViewChange=this.rejectViewChange.bind(this),this.onTypeChange=this.onTypeChange.bind(this),this.onHighlightCellsWithChange=this.onHighlightCellsWithChange.bind(this),this.onInputChange=this.onInputChange.bind(this),this.setRuleInputOnState=this.setRuleInputOnState.bind(this),this.onFormatChange=this.onFormatChange.bind(this),this.onStartRangePicker=this.onStartRangePicker.bind(this),this.onRangeChanged=this.onRangeChanged.bind(this),this.onRangeChangesAccepted=this.onRangeChangesAccepted.bind(this),this.onRangeChangesDiscarded=this.onRangeChangesDiscarded.bind(this),this.onStopIfTrueChange=this.onStopIfTrueChange.bind(this),this.getDoneButtonElementId=this.getDoneButtonElementId.bind(this),this.getRuleTypeElementId=this.getRuleTypeElementId.bind(this)}}Ws.RuleInputFactory=new class{createRuleInputData(e,t=null,n=null,o=null,r=null){switch(e){case 8:case 10:case 9:case 11:case 12:case 13:case 75:case 76:return new Rn(e,t?t.value:null);case 1:case 2:case 4:case 68:case 69:case 71:return new Tn(e,t?t.formula1:null);case 3:case 70:return new Tn(e,t?t.formula1:null,t?t.formula2:null);case 5:case 72:case 73:case 74:return new kn(e,t?t.formula1:null);case 7:return new _n(7,!t||!t.unique||!t.unique);case 64:case 65:case 66:case 67:return new _n(e);case 6:return new wn(6,t&&null!==t.timePeriod&&void 0!==t.timePeriod?t.timePeriod:void 0);case 15:return new Dn(15,n);case 28:return new Pn(28,o);case 39:return new In(39,r);case 63:return new kn(63,t?t.formula1:null);case 0:if(null!==n)return new Dn(0,n);if(null!==o)return new Pn(0,o);if(null!==r)return new In(0,r);throw new Error("Unsupported ConditionalFormattingCommandType.Nil with no dataBarFormat");default:throw new Error("Unsupported ConditionalFormattingCommandType")}}createDefaultRuleInputDataByRuleTypeOption(e=null,t=null){let n;switch(e){case Sn.TopBottom:n=this.createRuleInputData(8),n.setWasChanged();break;case Sn.HighlightCellsWith:n=this.createRuleInputData(1),n.setWasChanged();break;case Sn.DataBars:n=null!=t?this.createRuleInputData(0,null,t):this.createRuleInputData(15),n.setWasChanged();break;case Sn.ColorScales:n=null!=t?this.createRuleInputData(0,null,null,t):this.createRuleInputData(28),n.setWasChanged();break;case Sn.IconSets:n=null!=t?this.createRuleInputData(0,null,null,null,t):this.createRuleInputData(39),n.setWasChanged();break;case Sn.Formula:n=this.createRuleInputData(63),n.setWasChanged();break;case null:n=this.createRuleInputData(1);break;default:throw new Error("Unsupported RuleTypeOption")}return n}createDefaultRuleInputDataByHighlightCellsWithOption(e){let t;switch(e){case En.CellValue:t=this.createRuleInputData(1);break;case En.SpecificText:t=this.createRuleInputData(5);break;case En.DateOccurring:t=this.createRuleInputData(6);break;case En.DuplicateValues:t=this.createRuleInputData(7);break;case En.UniqueValues:t=this.createRuleInputData(7,{unique:!0});break;case En.Blanks:t=this.createRuleInputData(64);break;case En.NoBlanks:t=this.createRuleInputData(65);break;case En.Errors:t=this.createRuleInputData(66);break;case En.NoErrors:t=this.createRuleInputData(67)}return t.setWasChanged(),t}};let zs,Hs=!1,Vs=0,Us=!1;function Gs(e){return Us?new Promise((t,n)=>{t(zs),e&&e()}):!Object(de.e)()&&(Hs||0===Vs)&&Vs<5?function(e){return Vs++,new Promise((t,o)=>{n.e(34).then(n.bind(null,3078)).then(n=>{t(n),Us=!0,zs=n,e&&e()}).catch(e=>{Hs=!0,o(e)})})}(e):new Promise((e,t)=>{t("Failed to load reactdnd js after 5 retries on same session")})}let qs=void 0;const Qs=400,Ks="CondFmtLiveRegion";class Js extends R.Component{static getDerivedStateFromProps(e,t){var n;if(t.isUpdateInitiatedFromReactSide||e.notification)return{isUpdateInitiatedFromReactSide:!1};0===t.viewType&&(qs=R.lazy(()=>Gs()));const o=e.taskPaneViewType,r=null!==(n=e.rule)&&void 0!==n?n:t.ruleForEdit;let i;return 2===t.viewType?i={viewType:t.viewType,requestedView:o,requireConfirmation:!0,ruleForEdit:r}:(i={viewType:o,requireConfirmation:!1,requestedView:null,ruleForEdit:r},function(e,t){e!==t&&pe.onTaskPaneViewChange(t)}(t.viewType,o)),i}componentDidCatch(e,t){i.a.sendTraceTag(595657362,a.a.msoulscat_ES_EWAJS,s.a.Error,`ConditionalFormattingTaskPaneReact.ConditionalFormattingTaskPane: component failed to render: ${e.toString()} , ${t.componentStack}`)}render(){return R.createElement("div",{className:Object(F.eb)({background:"#EDEBE9"})},R.createElement("div",{id:Ks}),this.getTaskpaneContent(this.state.viewType))}getTaskpaneContent(e){return 1===e?pe.isRuleReorderWithDnDSupported()?R.createElement(R.Suspense,{fallback:this.renderRuleManager(!0)},R.createElement("div",{"data-testid":"DraggableRuleManager"},R.createElement(qs,{onRenderComponent:this.renderRuleManager}))):this.renderRuleManager():2===e?R.createElement(Ws,{rule:this.state.ruleForEdit,onChangeViewRequest:this.onChangeViewRequest,showConfirmation:this.state.requireConfirmation,onConfirmationResponse:this.onUserConfirmationResponse,notification:this.props.notification}):R.createElement("div",null)}renderRuleManager(e){const t=e?null:this.props.rules,n=function(e){return e?e.sort((e,t)=>e.priority-t.priority):e}(t||[]);return R.createElement("div",{"data-testid":"RuleManager"},R.createElement(xn,{rules:n,isLoading:null==t,onChangeViewRequest:this.onChangeViewRequest,error:this.props.error||0,ruleFilterOption:this.props.ruleFilterOption}))}onChangeViewRequest(e,t=null){let n=null;t&&(n=lt(t)),this.setState({viewType:e,requireConfirmation:!1,requestedView:null,isUpdateInitiatedFromReactSide:!0,ruleForEdit:n}),pe.onTaskPaneViewChange(e)}onUserConfirmationResponse(e){const t=this.state.requestedView;null!=t?e?(this.setState({viewType:t,requireConfirmation:!1,requestedView:null,isUpdateInitiatedFromReactSide:!0}),pe.onTaskPaneViewChange(t)):this.setState({requireConfirmation:!1,requestedView:null,ruleForEdit:null,isUpdateInitiatedFromReactSide:!0}):i.a.shipAssertTag(594872280,a.a.msoulscat_ES_EWAJS,!1,"requestedView must have value.")}constructor(e){super(e),this.focus=pe.setFocusOnPaneFirstElement,this.state={viewType:e.taskPaneViewType,requireConfirmation:!1,requestedView:null,isUpdateInitiatedFromReactSide:!0,ruleForEdit:e.rule||null},pe.updateData(e),this.onUserConfirmationResponse=this.onUserConfirmationResponse.bind(this),this.onChangeViewRequest=this.onChangeViewRequest.bind(this),this.renderRuleManager=this.renderRuleManager.bind(this),qs=R.lazy(()=>Gs())}}var Ys=n(2556),Zs=n(1419),$s=n(907);const Xs=Object(Jo.c)(()=>({root:Object(F.eb)({padding:"0 16px"})})),el=Object(Jo.c)(()=>({root:Object(F.eb)({padding:"16px 0 0 16px"})})),tl=Object(Jo.c)(e=>({root:{height:"24px",margin:"1px 0 0 16px"},link:{height:"24px",marginRight:"0px",paddingLeft:"6px",paddingRight:"6px",marginTop:"1px",color:e.palette.neutralDark,selectors:{":hover":{background:e.palette.neutralLighter},":active":{background:e.palette.neutralLight}}}})),nl=Object(Jo.c)(e=>({root:{minHeight:"28px",margin:"13px 13px 12px 0",cursor:"pointer"},rootDisabled:{background:"transparent",borderColor:"transparent"},rootHovered:{background:e.palette.neutralLighter,borderColor:e.palette.neutralLighter},rootPressed:{background:e.palette.neutralLight,borderColor:e.palette.neutralLight}})),ol=Object(Jo.c)((e,t)=>({root:{marginBottom:"8px"},icon:rl,text:{padding:"0 24px 0 8px",fontSize:"12px",color:t?e.palette.neutralDark:e.palette.neutralTertiary}})),rl={root:{width:"12px",height:"12px"}},il=Object(Jo.c)(()=>({root:{marginBottom:"8px"},label:{fontWeight:600}})),al=Object(Jo.c)(()=>({root:{marginBottom:"8px"}})),sl=Object(Jo.c)(e=>({borderBottom:"1px solid "+e.palette.neutralLight,paddingTop:"4px",marginBottom:"12px"})),ll=Object(Jo.c)(e=>({root:{background:e.palette.white,border:"1px solid "+e.palette.white,borderRadius:"8px",boxShadow:e.effects.elevation4,padding:"12px",margin:"12px 0px",fontSize:"12px",width:"100%"},header:{fontSize:"12px",fontWeight:600},badge:{fontSize:"10px",padding:"2px 6px",borderRadius:"4px",border:"1px solid "+e.palette.themeLight,backgroundColor:e.palette.themeLighter,color:e.palette.themePrimary,alignSelf:"center",marginRight:"8px"},cancelButton:{width:"16px",height:"16px"}}));var cl=n(222),ul=n(333),dl=n(2169),pl=n(717),gl=n(203),hl=n(1184);const ml=Object(Jo.c)((e,t,n)=>Object(F.I)(Object(ul.a)(e,!!t),Object(hl.a)(!0,n)));class bl extends R.PureComponent{render(){return R.createElement(we.a,null,e=>{const t=Object(ul.b)(this.props,gl.a.Small,ml(e,this.props.hideChevron,this.props.styles));return R.createElement(dl.a,_object_spread_props(_object_spread({},this.props),{styles:Object(pl.a)(e,t),dataAutomationType:"TaskPaneActionFlyoutAnchor",keytipProps:void 0}))})}}class fl extends R.PureComponent{render(){return R.createElement(dl.a,_object_spread_props(_object_spread({},this.props),{styles:Object(hl.a)(!1,this.props.styles),dataAutomationType:"TaskPaneFlyoutAnchor",keytipProps:void 0}))}}const xl=Object(Jo.c)(e=>({root:Object(F.eb)(["ExternalLinksContainer-root",{padding:"7px 11px",borderRadius:"4px",marginBottom:"10px",background:e.palette.white,border:"1px solid "+e.palette.white,boxShadow:e.effects.elevation4,selectors:{":hover":{boxShadow:e.effects.elevation8}}}])})),El=Object(Jo.c)(e=>({rootHasMenu:Object(F.eb)({display:"inline-block",marginLeft:"12px",minWidth:"21px",width:"21px",height:"16px",padding:"0px",borderStyle:"none",cursor:"pointer"}),flexContainer:Object(F.eb)({width:"18px",padding:"0 2px 0 1px"}),rootHovered:{background:e.palette.neutralLighter},rootPressed:{background:e.palette.neutralLight}})),Sl=Object(Jo.c)(e=>({root:Object(F.eb)({display:"inline-block",marginLeft:"12px",width:"21px",height:"16px",padding:"0px",borderStyle:"none",cursor:"pointer"}),rootHovered:{background:e.palette.neutralLighter},rootPressed:{background:e.palette.neutralLight}})),yl=Object(Jo.c)((e,t)=>({root:Object(F.eb)({width:"100%",height:"16px",paddingTop:"4px"}),text:Object(F.eb)({float:"left",fontSize:"12px",width:"60%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",padding:"0px",color:e.palette.neutralDark}),icon:Object(F.eb)({float:"left",height:"16px",width:"16px",marginRight:"7px"}),buttonContainer:Object(F.eb)(["ExternalLinksContainer-button",{float:"right",display:"flex",visibility:"hidden",selectors:{".ExternalLinksContainer-root:hover &":{visibility:"visible"},".ExternalLinksContainer-root:focus &":{visibility:"visible"},".ExternalLinksContainer-root:focus-within &":{visibility:"visible"}}},t&&{visibility:"visible"}])})),Cl=Object(Jo.c)(e=>({root:Object(F.eb)({display:"flex",width:"70%",marginLeft:"23px",fontSize:"12px",color:e.palette.neutralPrimary}),icon:Object(F.eb)(_object_spread({width:"12px",height:"12px"},Object(x.isChangeGateEnabled)("OfficeVSO:9218238_WorkbookLinks_TaskPaneErrorIconAlignmentFix")?{margin:"2px"}:{marginRight:"2px"})),errorText:Object(F.eb)({display:"inline-block",color:e.palette.neutralPrimaryAlt}),recentlyEdited:Object(F.eb)({width:"16px",height:"16px",marginRight:"2px",marginLeft:"4px",verticalAlign:"-3px"})}));var vl=n(841);const Rl=Object(x.isChangeGateEnabled)("OfficeVSO:8916803_ExternalLinksFindNextLinkLabelUpdate");class kl extends R.Component{getLastRefreshedElement(e){const t=this.props.link.lastRefreshed,n=t&&!isNaN(t.getTime())?R.createElement(vl.a,{date:t,formatter:this.props.dateFormatter}):"";return Object(x.isChangeGateEnabled)("OfficeVSO:8707130_ExtLinksWebRecentlyEditedUi")&&this.props.link.recentlyEdited?R.createElement(R.Fragment,null,R.createElement("div",{title:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ExternalLinksRecentlyEditedToolTip)},this.props.lastRefreshedUiString," ",n,this.props.link.recentlyEdited&&R.createElement(fe.a,{iconName:be.a.Info_16,className:e}))):R.createElement(R.Fragment,null,this.props.lastRefreshedUiString," ",n)}render(){const e=this.state.isServerResponsePending||this.props.link.isUpdating,t=this.props.link.statusMessage;return R.createElement(we.a,null,n=>{const o=xl(n),r=yl(n,this.state.showButtons),i=Cl(n);return R.createElement("div",{className:o.root,id:"ExternalLinksContainerId-"+this.props.id,ref:this.container,"data-is-focusable":!0,tabIndex:1===this.props.id?0:-1,onKeyDown:this.onKeyDown,"aria-label":this.props.link.workbookName+". "+t,"aria-describedby":this.props.link.errorLongDesc,role:"listitem"},R.createElement("div",{className:r.root},R.createElement(fe.a,{className:r.icon,iconName:be.a.SaveAsExcelXlsx_20}),R.createElement(jt.a,{title:Object(x.isChangeGateEnabled)("OfficeVSO:8701101_AddingTooltipExternalLinksFileName")?this.props.link.displayUrl:"",className:r.text},this.props.link.workbookName),R.createElement("div",{className:r.buttonContainer},R.createElement(Ys.b,{id:"findNextLink-"+this.props.link.originalUrl,label:ExcelRibbonStringsManager.get(Rl?ExcelRibbonStringsEnum.ExternalLinksFindNextLinkLabelV2:ExcelRibbonStringsEnum.ExternalLinksFindNextLinkLabel),disabled:!1,type:"AppButtonProps",icon:be.a.GoToLink_20,hideLabel:!0,onFocus:this.onFocus,onBlur:this.onBlur,onKeyDown:this.onKeyDown,onExecute:Dl(this.props.link.originalUrl,this.props.link.onButtonExecuteV2),styles:Sl(n)}),R.createElement(bl,{id:"ExternalLinksTaskPaneEllipsesFlyoutId-"+this.props.id,label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ExternalLinksSingleLinkMoreOptionsButtonText),type:"AppFlyoutAnchorProps",hideLabel:!0,hideChevron:!0,directionalHintFixed:!1,directionalHint:Se.a.bottomRightEdge,icon:c.a.HintBarEllipses_20,menuDefinition:this.getMenuDefinition(),onFocus:this.onFocus,onBlur:this.onBlur,onAfterMenuDismiss:this.onBlur,onExecute:this.isLinkOptionsFocusFixEnabled?this.onFocus:void 0,controlInMenuRendererFunction:this.externalLinksControlInMenuRendererFunction,styles:El(n)}))),R.createElement("div",{className:i.root,title:this.props.link.errorLongDesc},this.props.link.errorLongDesc?R.createElement(R.Fragment,null,R.createElement(fe.a,{className:i.icon,iconName:be.a.AlertWarning_16}),R.createElement("div",{className:i.errorText},t)):R.createElement(R.Fragment,null,e?this.props.busyUiString:this.getLastRefreshedElement(i.recentlyEdited))))})}constructor(e){super(e),this.container=R.createRef(),this.getMenuDefinition=()=>{const e=this.state.isServerResponsePending||this.props.link.isUpdating,t={sections:[{controls:[{type:"AppButtonProps",id:"openWorkbook-"+this.props.link.originalUrl,label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ExternalLinksOpenWorkbookLabel),disabled:!this.props.link.hostEditUrl,icon:be.a.GoToWorkbook_20,onExecute:Tl(this.props.link.hostEditUrl),onFocus:this.isLinkOptionsFocusFixEnabled?this.onFocus:void 0}]}]},n={type:"AppButtonProps",id:"changeSource-"+this.props.link.originalUrl,label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ExternalLinksChangeSourceLabel),icon:be.a.EditCloud_20,onExecute:_l(this.props.link.originalUrl,this.props.link.onButtonExecuteV2),disabled:this.props.link.changeSourceDisabled,onFocus:this.isLinkOptionsFocusFixEnabled?this.onFocus:void 0};t.sections[0].controls.push(n);const o={type:"AppButtonProps",id:"ExternalLinksTaskPaneRefreshButtonId-"+this.props.id,label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ExternalLinksRefreshButtonText),icon:be.a.Sync_20,onExecute:this.onRefreshButtonExecute,disabled:this.props.link.refreshDisabled||e,onFocus:this.isLinkOptionsFocusFixEnabled?this.onFocus:void 0};t.sections[0].controls.push(o);const r={type:"AppButtonProps",id:"breakLink-"+this.props.link.originalUrl,label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ExternalLinksBreakLinksLabel),icon:be.a.DeleteHyperlink_20,onExecute:wl(this.props.link.originalUrl,this.props.link.onButtonExecuteV2),disabled:!1,onFocus:this.isLinkOptionsFocusFixEnabled?this.onFocus:void 0};return t.sections[0].controls.push(r),t},this.externalLinksControlInMenuRendererFunction=Object(cl.c)(Po.a,Object(f.a)()),this.onRefreshButtonExecute=()=>{this.props.link&&this.props.link.onButtonExecuteV2?(this.setState({isServerResponsePending:!0}),this.props.link.onButtonExecuteV2(0,this.props.link.originalUrl,()=>{this.setState({isServerResponsePending:!1})}),i.a.sendTraceTag(595637534,a.a.msoulscat_ES_EWAJS,s.a.Info,"ExternalLinksTaskPane refresh button clicked.")):i.a.shipAssertTag(595650711,a.a.msoulscat_ES_EWAJS,!1,"ExternalLinksTaskPane onRefreshButtonExecute not set.")},this.onFocus=()=>{this.setState({showButtons:!0})},this.onBlur=()=>{this.setState({showButtons:!1})},this.onKeyDown=e=>{this.props.onKeyDown(this.container,e)},this.isLinkOptionsFocusFixEnabled=Object(x.isChangeGateEnabled)("OfficeVSO:8846650_FixKeyboardFocusOnLinkFocus"),this.state={showButtons:!1,isServerResponsePending:!1}}}const Tl=e=>()=>{e?(window.open(e,"_blank"),i.a.sendTraceTag(595637535,a.a.msoulscat_ES_EWAJS,s.a.Info,"ExternalLinksTaskPane open workbook button clicked.")):i.a.shipAssertTag(595650712,a.a.msoulscat_ES_EWAJS,!1,"ExternalLinksTaskPane hostEditUrl not set.")},_l=(e,t)=>()=>{t?(t(4,e,null),i.a.sendTraceTag(572331906,a.a.msoulscat_ES_EWAJS,s.a.Info,"ExternalLinksTaskPane Change Source button clicked.")):i.a.shipAssertTag(572331907,a.a.msoulscat_ES_EWAJS,!1,"ExternalLinksTaskPane onButtonExecuteV2 not set.")},wl=(e,t)=>()=>{t?(t(3,e,null),i.a.sendTraceTag(593762060,a.a.msoulscat_ES_EWAJS,s.a.Info,"ExternalLinksTaskPane break link button clicked.")):i.a.shipAssertTag(593762061,a.a.msoulscat_ES_EWAJS,!1,"ExternalLinksTaskPane onButtonExecuteV2 not set.")},Dl=(e,t)=>()=>{t?(t(7,e,null),i.a.sendTraceTag(592544162,a.a.msoulscat_ES_EWAJS,s.a.Info,"ExternalLinksTaskPane find next link button clicked.")):i.a.shipAssertTag(592544163,a.a.msoulscat_ES_EWAJS,!1,"ExternalLinksTaskPane onButtonExecuteV2 not set.")};var Pl=n(1048),Il=n(109),Fl=n(232);class Bl extends R.Component{render(){return R.createElement("div",{ref:this.domElement},R.createElement(Pl.a,{role:"list",items:this.props.links,onRenderCell:this.onRenderListItem}))}switchFocus(e,t){if(t&&this.domElement.current&&e.current)if(t.which===xe.a.down){const t=Object(Il.j)(this.domElement.current,e.current,!1,!1,!0,!1,!1,!1);t&&t.focus()}else if(t.which===xe.a.up){const t=Object(Fl.a)(e.current,!1),n=Object(Il.j)(this.domElement.current,null!=t?t.previousElementSibling:null,!1,!1,!1,!1,!1,!1);n&&n.focus()}}onRenderListItem(e,t){if(void 0!==e)return R.createElement(kl,{link:e,id:void 0!==t?t+1:0,onKeyDown:this.switchFocus,dateFormatter:this.props.dateFormatter,busyUiString:this.props.busyUiString,lastRefreshedUiString:this.props.lastRefreshedUiString})}constructor(e){super(e),this.domElement=R.createRef(),this.switchFocus=this.switchFocus.bind(this),this.onRenderListItem=this.onRenderListItem.bind(this)}}var Ml=n(2612),jl=n(1218);const Ol=Object(ut.a)({root:_object_spread({display:"flex",flexDirection:"column",height:"100%",justifyContent:"center",alignItems:"center"},pt.a.padding("0","16px")),headerText:{fontWeight:600},descriptionText:{textAlign:"center",fontSize:"12px",lineHeight:"16px"},link:{fontSize:"12px",lineHeight:"16px",marginTop:"16px"}}),Ll=e=>{const t=Ol();return R.createElement("div",{className:t.root},R.createElement(nn.a,{className:t.headerText},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ExternalLinksEmptyPaneHeader)),R.createElement(tn.a,{iconName:en.a.Link_192x192,width:192,height:192}),R.createElement(nn.a,{className:t.descriptionText},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ExternalLinksEmptyPaneDescription)),R.createElement(on.a,{onClick:()=>{e.onEmptyPaneLinkClick&&(e.onEmptyPaneLinkClick(),i.a.sendTraceTag(507585170,a.a.msoulscat_ES_EWAJS,s.a.Info,"ExternalLinksEmptyPane: learn more link clicked"))},id:"ExternalLinksEmptyPaneLinkId",rel:"noopener noreferrer",className:t.link},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ExternalLinksEmptyPaneLinkText)))},Al=Object(Jo.c)(e=>({calloutContainer:{root:{width:"auto",padding:"12px",borderRadius:"4px",boxShadow:e.effects.elevation16,border:"none"},beakCurtain:{borderRadius:"4px"},calloutMain:{lineHeight:"20px"}}}));var Nl=n(2158);const Wl=e=>{const t=R.useRef(null),[n,o]=R.useState(!1),r=R.useCallback(()=>{t.current&&clearTimeout(t.current)},[t]),i=R.useCallback(()=>{t.current=setTimeout(()=>{o(!0),e.restoreFocusToGrid()},5e3)},[t,e]),{callback:a}=e;Object(R.useEffect)(()=>{a(!1)},[a]);const s=()=>{r(),o(!0)};return R.createElement(we.a,null,e=>{const t=Al(e);return R.createElement(Nl.a,{target:"#ExternalLinksTaskPaneAlwaysTrustToggleId",role:"alert",beakWidth:8,calloutMaxWidth:296,directionalHint:Se.a.leftCenter,directionalHintFixed:!0,hidden:n,styles:t.calloutContainer,dismissOnTargetClick:!0,preventDismissOnEvent:()=>!1,onDismiss:s,setInitialFocus:!0,onMouseEnter:r,onMouseLeave:i},R.createElement("span",null,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ExternalLinksAlwaysTrustCalloutText)))})};function zl(e,t){k.render(R.createElement(Wl,{callback:e,restoreFocusToGrid:t}),document.createElement("div"))}const Hl=Object(x.isChangeGateEnabled)("OfficeVSO:9033062_WorkbookLinks_IsDefaultTabSelectionEnabled"),Vl=Object(x.getBooleanFeatureGate)("Microsoft.Office.Excel.IsAlwaysTrustCalloutEnabled");class Ul extends R.Component{componentDidMount(){Vl&&setTimeout(()=>{this.props.alwaysTrustCalloutOnBizBarTrustState&&document.getElementById("ExternalLinksTaskPaneAlwaysTrustToggleId")&&this.props.updateAlwaysTrustCalloutOnBizBarTrustState&&this.props.restoreFocusToGrid&&(i.a.sendTraceTag(506818822,a.a.msoulscat_ES_EWAJS,s.a.Info,"ExternalLinksTaskPane: rendering always trust callout on business bar trust"),zl(this.props.updateAlwaysTrustCalloutOnBizBarTrustState,this.props.restoreFocusToGrid))},500)}componentDidUpdate(){Vl&&this.props.alwaysTrustCalloutOnAlwaysRefreshState&&document.getElementById("ExternalLinksTaskPaneAlwaysTrustToggleId")&&this.props.updateAlwaysTrustCalloutOnAlwaysRefreshState&&this.props.restoreFocusToGrid&&(i.a.sendTraceTag(506818821,a.a.msoulscat_ES_EWAJS,s.a.Info,"ExternalLinksTaskPane: rendering always trust callout on selecting always refresh preference setting"),zl(this.props.updateAlwaysTrustCalloutOnAlwaysRefreshState,this.props.restoreFocusToGrid))}render(){let e=this.props.externalLinkInfoList;var t;return this.state.isServerResponsePending&&(e=null===(t=this.props.externalLinkInfoList)||void 0===t?void 0:t.map(e=>{const t=e||void 0;return t&&(t.isUpdating=!0),t})),R.createElement(we.a,null,t=>e&&e.length>0?R.createElement(Zs.a,_object_spread({componentRef:this.pivotRef,styles:tl(t)},Hl?{defaultSelectedKey:this.props.defaultTab}:{}),this.renderActiveLinksPivotItem(t,e),this.renderSettingsPivotItem(t)):R.createElement(Ll,{onEmptyPaneLinkClick:this.props.onEmptyPaneLinkClick}))}renderActiveLinksPivotItem(e,t){return R.createElement($s.a,_object_spread({headerText:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ExternalLinksLinksTabHeader)},Hl?{itemKey:"LinksTab"}:{}),R.createElement("div",{className:Xs().root},this.props.featurePromotionDialogEnabled&&this.renderFeaturePromotionDialog(e),R.createElement(Ys.a,{id:"ExternalLinksTaskPaneRefreshAllButtonId",label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ExternalLinksRefreshAllButtonText),disabled:this.props.refreshAllDisabled,type:"AppButtonProps",icon:be.a.SynchronizeWithSite_20,onExecute:this.onRefreshAllButtonExecute,styles:nl(e)}),R.createElement(Ys.a,{id:"ExternalLinksTaskPaneBreakAllLinksButtonId",label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ExternalLinksNewBreakAllLinksLabel),disabled:this.props.breakAllLinksDisabled,type:"AppButtonProps",icon:be.a.DeleteHyperlink_20,onExecute:this.onBreakAllLinksButtonExecute,styles:nl(e)}),R.createElement(Bl,{links:t,dateFormatter:this.dateFormatter,busyUiString:this.props.busyUiString||"",lastRefreshedUiString:this.props.lastRefreshedUiString||""})))}renderSettingsPivotItem(e){this.populateRefreshPreferences();const t=ol(e,this.props.alwaysTrustEnabled);return R.createElement($s.a,_object_spread({headerText:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ExternalLinksSettingsTabHeader)},Hl?{itemKey:"SettingsTab"}:{}),R.createElement("div",{className:el().root},R.createElement(Ml.a,{type:"AppToggleProps",id:"ExternalLinksTaskPaneAlwaysTrustToggleId",label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ExternalLinksAlwaysTrustToggleLabel),inlineLabel:!0,checked:this.props.alwaysTrustEnabled,onChange:this.onAlwaysTrustUpdateExecute,styles:il(),appColors:Object(b.a)()}),R.createElement(At.a,{horizontal:!0,style:t.root},R.createElement(At.a.Item,null,R.createElement(fe.a,{iconName:be.a.InfoFluent_16,styles:t.icon})),R.createElement(At.a.Item,null,R.createElement("div",{style:t.text},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ExternalLinksAlwaysTrustToggleDescription)))),R.createElement("div",{style:sl(e)}),R.createElement(jl.a,{type:"AppChoiceGroupProps",id:"ExternalLinksTaskPaneRefreshPreferenceChoiceGroupId",label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ExternalLinksRefreshPreferenceLabel),selectedKey:null!==this.props.refreshPreferenceSetting?this.props.refreshPreferenceSetting.toString():"",options:this.refreshPreferences,onChange:this.onRefreshPreferenceUpdateExecute,styles:al(),disabled:this.props.refreshPreferencesDisabled})))}renderFeaturePromotionDialog(e){const t=ll(e);return R.createElement(At.a,{style:t.root,tokens:{childrenGap:8}},R.createElement(At.a,{horizontal:!0,horizontalAlign:"space-between"},R.createElement(At.a.Item,{style:t.header},R.createElement("span",{style:t.badge},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ExternalLinksFeaturePromotionDialogBadge)),R.createElement("span",null,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ExternalLinksFeaturePromotionDialogHeader))),R.createElement(is.a,{type:"AppIconButtonProps",id:"ExternalLinksFeaturePromotionDialogCancelButtonId",iconProps:Object(mi.a)(c.a.CancelGlyph_16),onClick:this.onFeaturePromotionDialogDismiss,"aria-label":ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.Close),customTooltip:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.Close),style:t.cancelButton})),R.createElement("span",null,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ExternalLinksFeaturePromotionDialogBody)),R.createElement("span",null,R.createElement(Ut.a,{onClick:this.oneFeaturePromotionDialogLinkClick},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ExternalLinksFeaturePromotionDialogLinkText))))}constructor(e){super(e),this.refreshPreferences=[],this.focus=()=>{var e,t;this.props.externalLinkInfoList&&this.props.externalLinkInfoList.length>0?null===(e=this.pivotRef.current)||void 0===e||e.focus():null===(t=document.getElementById("ExternalLinksEmptyPaneLinkId"))||void 0===t||t.focus()},this.pivotRef=R.createRef(),this.oneFeaturePromotionDialogLinkClick=()=>{this.props.onFeaturePromotionDialogLinkClick&&(this.props.onFeaturePromotionDialogLinkClick(),i.a.sendTraceTag(507623568,a.a.msoulscat_ES_EWAJS,s.a.Info,"ExternalLinksTaskPane feature promotion dialog link clicked"))},this.onFeaturePromotionDialogDismiss=()=>{this.props.onFeaturePromotionDialogDismiss&&(this.props.onFeaturePromotionDialogDismiss(),i.a.sendTraceTag(507623567,a.a.msoulscat_ES_EWAJS,s.a.Info,"ExternalLinksTaskPane feature promotion dialog dismissed"))},this.populateRefreshPreferences=()=>{this.refreshPreferences=[{key:(0).toString(),text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ExternalLinksRefreshPreferenceAlwaysLabelV2)},{key:1..toString(),text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ExternalLinksRefreshPreferenceAskLabel)},{key:2..toString(),text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ExternalLinksRefreshPreferenceNeverLabel)}]},this.onAlwaysTrustUpdateExecute=()=>{this.props.onAlwaysTrustUpdateExecute&&(this.props.onAlwaysTrustUpdateExecute(),i.a.sendTraceTag(507860806,a.a.msoulscat_ES_EWAJS,s.a.Info,"ExternalLinksTaskPane always trust external links toggled changed."))},this.onRefreshPreferenceUpdateExecute=e=>{this.props.onRefreshPreferenceUpdateExecute&&(this.props.onRefreshPreferenceUpdateExecute(Number(e.key)),i.a.sendTraceTag(507860804,a.a.msoulscat_ES_EWAJS,s.a.Info,"ExternalLinksTaskPane refresh preference changed."))},this.onRefreshAllButtonExecute=()=>{this.props.onRefreshAllButtonExecuteV2?(this.setState({isServerResponsePending:!0}),this.props.onRefreshAllButtonExecuteV2(()=>{this.setState({isServerResponsePending:!1})}),i.a.sendTraceTag(595637536,a.a.msoulscat_ES_EWAJS,s.a.Info,"ExternalLinksTaskPane RefreshAll button clicked.")):i.a.shipAssertTag(595646292,a.a.msoulscat_ES_EWAJS,!1,"ExternalLinksTaskPaneonRefreshAllButtonExecutenotset.")},this.onBreakAllLinksButtonExecute=()=>{this.props.onBreakAllLinksButtonExecute?(this.props.onBreakAllLinksButtonExecute(),i.a.sendTraceTag(593356554,a.a.msoulscat_ES_EWAJS,s.a.Info,"ExternalLinksTaskPane BreakAllLinks button clicked.")):i.a.shipAssertTag(593356555,a.a.msoulscat_ES_EWAJS,!1,"ExternalLinksTaskPaneonBreakAllLinksButtonExecutenotset.")},this.state={isServerResponsePending:!1};const t=e.uiCulture?e.uiCulture:"en-US",n=e.dataCulture?e.dataCulture:"en-US",o=_object_spread({},FriendlyDatesStrings),r=new vl.b(t,n,o,!0);this.dateFormatter=r.format.bind(r)}}var Gl,ql;!function(e){e[e.FormatCellsListView=0]="FormatCellsListView",e[e.NumberFormatItemView=1]="NumberFormatItemView",e[e.AlignmentItemView=2]="AlignmentItemView",e[e.FontItemView=3]="FontItemView",e[e.BorderItemView=4]="BorderItemView"}(Gl||(Gl={})),function(e){e[e.General=0]="General",e[e.Number=1]="Number",e[e.Currency=2]="Currency",e[e.Accounting=3]="Accounting",e[e.Date=4]="Date",e[e.Time=5]="Time",e[e.Percentage=6]="Percentage",e[e.Fraction=7]="Fraction",e[e.Scientific=8]="Scientific",e[e.Text=9]="Text",e[e.Special=10]="Special",e[e.Custom=11]="Custom"}(ql||(ql={}));var Ql=n(1024);const Kl={summaryCardStyles:Object(Jo.c)(e=>({root:{minHeight:"66px",height:"fit-content",borderRadius:"4px",marginTop:"8px",marginBottom:"8px",marginLeft:"15px",marginRight:"15px",background:e.palette.white,borderColor:"transparent",boxShadow:"0px 0.3px 0.9px rgba(0, 0, 0, 0.1), 0px 1.6px 3.6px rgba(0, 0, 0, 0.13)",":hover":{borderRadius:"4px",boxShadow:"0px 1.2px 3.6px rgba(0, 0, 0, 0.1), 0px 6.4px 14.4px rgba(0, 0, 0, 0.13)",borderColor:"transparent !important"},":hover::after":{border:"unset"}}})),tooltipHostStyles:{root:{width:"10px",height:"10px",marginLeft:"4px"}},tooltipIconStyles:{root:{height:"10px",width:"10px"}},cardViewIconStyles:{root:{height:"16px",minWidth:"16px",maxWidth:"16px"}},summaryCardTitleStyles:{root:{fontWeight:"600",fontSize:"14px",lineHeight:"20px"}},stackStyles:{root:{width:"100%",marginRight:"12px",marginLeft:"12px",alignItems:"center"}},chevronIconStyles:{root:{height:"20px",minWidth:"12px",maxWidth:"12px"}},rootDescriptionTextStyles:{root:{marginTop:"6px",fontSize:"12px",lineHeight:"16px"}},formattingOptionsLabelStyles:Object(Jo.c)(e=>({root:{fontWeight:F.l.semibold,color:e.palette.neutralDark,paddingLeft:"0px",label:{paddingLeft:"15px"}}})),cardTextContainerStyling:{width:"auto",height:"100%",flexGrow:1,marginLeft:"10px",marginRight:"4px",paddingBottom:"10px",paddingTop:"12px",boxSizing:"border-box"}},Jl=R.createContext(void 0);var Yl=n(1217);const Zl={floatingObjectDivStyles:{marginLeft:"17px",fontStyle:"italic",width:"auto",height:"20px"}};var $l=()=>R.createElement("div",{style:Zl.floatingObjectDivStyles},ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.FloatingObjectSelectedDescription));function Xl(e){const t=Object(x.getBooleanFeatureGate)("Microsoft.Office.Excel.FormatCellsTaskPane",!1),n=Object(x.getBooleanFeatureGate)("Microsoft.Office.Excel.FormatCellsTaskPaneFontItemView",!1),o=Object(x.getBooleanFeatureGate)("Microsoft.Office.Excel.FormatCellsTaskPaneBordersItemView",!1);switch(e){case Gl.NumberFormatItemView:case Gl.AlignmentItemView:return t;case Gl.FontItemView:return t&&n;case Gl.BorderItemView:return t&&o;default:return!1}}class ec extends R.Component{render(){return R.createElement(we.a,null,e=>R.createElement(Jl.Consumer,null,t=>R.createElement(R.Fragment,null,this.props.isFloatingObjectSelected?R.createElement($l,null):R.createElement(R.Fragment,null,R.createElement(Yl.a,{id:"formattingOptionsLabel",type:"AppLabelProps",forId:"formattingOptionsToolTip",label:ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.FormattingOptionsLabel),styles:Kl.formattingOptionsLabelStyles(e)},R.createElement(Ee.a,{id:"formattingOptionsToolTip",content:ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.FormattingOptionsToolTip),styles:Kl.tooltipHostStyles},R.createElement(fe.a,_object_spread_props(_object_spread({role:"tooltip"},Object(mi.a)(be.a.Info_20)),{styles:Kl.tooltipIconStyles,"aria-label":ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.FormattingOptionsToolTipAriaLabel),tabIndex:0})))),this.generateSummaryCard(ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.NumberTabCardAriaLabel),t.callbacks,Gl.NumberFormatItemView,be.a.NumberFormat_16,ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.NumberTabLabel),ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.NumberSummaryCardDescription),e),this.generateSummaryCard(ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.AlignmentTabCardAriaLabel),t.callbacks,Gl.AlignmentItemView,be.a.FormatCellAlignment_16,ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.AlignmentTabLabel),ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.AlignmentSummaryCardDescription),e),this.generateSummaryCard(ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.FontTabCardAriaLabel),t.callbacks,Gl.FontItemView,be.a.FontScheme_16,ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.FontTabLabel),ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.FontSummaryCardDescription),e),this.generateSummaryCard(ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.BorderTabCardAriaLabel),t.callbacks,Gl.BorderItemView,be.a.TopAndBottomBorder_16,ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.BorderTabLabel),ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.BorderSummaryCardDescription),e)))))}constructor(e){super(e),this.cardRef=R.createRef(),this.generateSummaryCard=(e,t,n,o,r,i,a)=>Xl(n)?R.createElement(P.a,{componentRef:this.cardRef,styles:Kl.summaryCardStyles(a),"aria-label":e,tabIndex:0,type:Ql.a.compact,onClick:()=>{var e;null===(e=this.cardRef.current)||void 0===e||e.focus(),t.onItemClick(n)}},R.createElement(At.a,{horizontal:!0,styles:Kl.stackStyles},R.createElement(fe.a,{iconName:o,styles:Kl.cardViewIconStyles}),R.createElement("div",{style:Kl.cardTextContainerStyling},R.createElement(rs.a,{styles:Kl.summaryCardTitleStyles,block:!0},r),R.createElement(rs.a,{styles:Kl.rootDescriptionTextStyles,block:!0},i)),R.createElement(fe.a,{iconName:c.a.CommonControlChevronRight_12,styles:Kl.chevronIconStyles}))):R.createElement(R.Fragment,null),this.state={}}}const tc=(e,t)=>({fontWeight:"450",fontSize:"12px",padding:"3px 0px 3px 0px",color:e?t.palette.themePrimary:t.palette.neutralDark,cursor:e?"pointer":"default"});var nc=n(199),oc=n(2);const rc=e=>{const[t,n]=R.useState(!1);return R.createElement(we.a,null,o=>{var r;return R.createElement("div",{style:{height:"40px",paddingTop:"5px"},role:"button",tabIndex:0,onClick:null!==(r=e.onButtonClick)&&void 0!==r?r:ic,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||ic()}},R.createElement("div",{style:{display:"flex",padding:"6px 0px 6px 9px",lineHeight:"20px"}},R.createElement(fe.a,{iconName:be.a.Feedback_20,style:{padding:"6px 11px 6px 1px",height:"16px",width:"16px"}}),R.createElement("span",{style:tc(t,o),onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1)},e.giveFeedBackButtonText||ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.GiveFeedBackButtonText))))})},ic=()=>{Object(nc.b)(oc.b.GiveFeedback,{modelType:"ButtonModel",payload:{type:"ButtonPayload"}})};var ac=n(54);const sc=()=>{const e=!Object(x.isChangeGateEnabled)("OfficeVSO:8333192_FormatCellsTaskPaneColorFix");return{backgroundTransparent:"transparent",iconButtonBackgroundRest:"transparent",iconButtonBackgroundHover:e?ac.a.gray40:"#EBEBEB",iconButtonBackgroundPressed:e?ac.a.gray50:"#E0E0E0",iconButtonBackgroundSelected:e?ac.a.gray50:"#E0E0E0",iconButtonBackgroundFocus:"transparent",iconButtonBackgroundDisabled:"transparent",iconButtonForegroundRest:e?ac.a.gray160:"#424242",iconButtonForegroundHover:e?ac.a.gray190:"#242424",iconButtonForegroundPressed:e?ac.a.gray190:"#242424",iconButtonForegroundSelected:e?ac.a.gray190:"#242424",iconButtonForegroundFocus:e?ac.a.gray160:"#424242",iconButtonForegroundDisabled:e?ac.a.gray90:"#BDBDBD"}},lc=Object(Jo.c)(e=>({root:{marginRight:"10px",background:sc().backgroundTransparent},dropdown:{border:"1px solid "+e.palette.neutralLight,borderRadius:"2px",width:"140px"},caretDownWrapper:{height:"16px",paddingBottom:"2px",paddingTop:"3px",lineHeight:"unset"},title:{border:"unset",fontSize:"12px",height:"24px",lineHeight:"24px"},dropdownOptionText:{fontSize:"12px"},label:{fontWeight:F.l.semibold,fontSize:"12px",whiteSpace:"nowrap"}})),cc=Object(Jo.c)((e,t)=>({root:{marginBottom:e?void 0:"5px",marginTop:e?"22px":void 0,marginRight:"2px",marginLeft:t,paddingLeft:"4px",paddingRight:"4px",height:"28px",border:"unset",backgroundColor:"transparent",color:sc().iconButtonForegroundRest},textContainer:{fontSize:"12px",fontWeight:F.l.regular,fontStyle:"normal",whiteSpace:"nowrap"},label:{marginLeft:"4px",marginRight:"4px"},icon:{height:"16px",width:"16px"},rootDisabled:{border:"unset",backgroundColor:sc().iconButtonBackgroundDisabled,color:sc().iconButtonForegroundDisabled},rootChecked:{backgroundColor:sc().iconButtonBackgroundSelected,color:sc().iconButtonForegroundSelected},rootHovered:{backgroundColor:sc().iconButtonBackgroundHover,color:sc().iconButtonForegroundHover},rootPressed:{backgroundColor:sc().iconButtonBackgroundPressed,color:sc().iconButtonForegroundPressed},rootFocused:{backgroundColor:sc().iconButtonBackgroundFocus,color:sc().iconButtonForegroundFocus}})),uc={styles:{root:{marginBottom:"5px",marginRight:"12px",paddingLeft:"4px",paddingRight:"4px",height:"28px",border:"unset",backgroundColor:"transparent",color:sc().iconButtonForegroundRest},textContainer:{fontSize:"12px",fontWeight:F.l.regular,fontStyle:"normal",whiteSpace:"nowrap"},label:{marginLeft:"4px",marginRight:"4px"},splitButtonMenuButton:{backgroundColor:"unset"},rootDisabled:{border:"unset",backgroundColor:sc().iconButtonBackgroundDisabled,color:sc().iconButtonForegroundDisabled},rootChecked:{backgroundColor:sc().iconButtonBackgroundSelected,color:sc().iconButtonForegroundSelected},rootHovered:{backgroundColor:sc().iconButtonBackgroundHover,color:sc().iconButtonForegroundHover},rootPressed:{backgroundColor:sc().iconButtonBackgroundPressed,color:sc().iconButtonForegroundPressed},rootFocused:{backgroundColor:sc().iconButtonBackgroundFocus,color:sc().iconButtonForegroundFocus}}},dc={styles:{splitButtonContainer:{padding:"0px 4px",display:"flex",height:"28px",alignItems:"center",flexShrink:0},label:{fontSize:"12px",fontWeight:F.l.regular,fontStyle:"normal",whiteSpace:"nowrap"},root:{paddingLeft:"4px",paddingRight:"4px",height:"28px",border:"unset",backgroundColor:"unset",display:"flex",alignItems:"center"},rootDisabled:{border:"unset",backgroundColor:sc().iconButtonBackgroundDisabled,color:sc().iconButtonForegroundDisabled},rootChecked:{backgroundColor:sc().iconButtonBackgroundSelected,color:sc().iconButtonForegroundSelected},rootHovered:{backgroundColor:sc().iconButtonBackgroundHover,color:sc().iconButtonForegroundHover},rootPressed:{backgroundColor:sc().iconButtonBackgroundPressed,color:sc().iconButtonForegroundPressed},rootFocused:{backgroundColor:sc().iconButtonBackgroundFocus,color:sc().iconButtonForegroundFocus},splitButtonDivider:{width:"0px"},splitButtonMenuButtonExpanded:{height:"28px"},splitButtonMenuButton:{backgroundColor:"unset",width:"12px",height:"28px",padding:"4px 2px",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",flexShrink:0,border:"none",outline:"none",fontWeight:F.l.regular,selectors:{"span:first-child":{height:"8px",width:"8px",lineHeight:"8px"}}},splitButtonMenuButtonDisabled:{backgroundColor:sc().iconButtonBackgroundDisabled,color:sc().iconButtonForegroundDisabled},splitButtonContainerChecked:{backgroundColor:sc().iconButtonBackgroundSelected,color:sc().iconButtonForegroundSelected},splitButtonContainerCheckedHovered:{backgroundColor:sc().iconButtonBackgroundHover,color:sc().iconButtonForegroundHover},splitButtonContainerFocused:{backgroundColor:sc().iconButtonBackgroundFocus,color:sc().iconButtonForegroundFocus},splitButtonMenuIcon:{display:"inline-block",fontSize:"8px",lineHeight:"8px",height:"unset",width:"unset"}}},pc={root:{marginTop:"10px",paddingLeft:"0px"},label:{fontWeight:F.l.semibold,fontSize:"12px",fontStyle:"normal"}},gc=Object(Jo.c)((e,t)=>({root:{width:"140px",marginTop:"-6px",padding:"0px",marginRight:t?void 0:"10px"},spinButtonWrapper:{position:"relative",border:"1px solid "+e.palette.neutralLight,borderRadius:"2px",height:"24px"},input:{fontWeight:F.l.regular,fontSize:"12px"},labelWrapper:{marginBottom:"-8px"},label:{fontWeight:F.l.semibold,fontSize:"12px",background:sc().backgroundTransparent}})),hc={alignmentCheckBoxStyles:Object(Jo.c)(e=>({root:{height:"24px",marginTop:"30px",background:sc().backgroundTransparent,padding:"0px"},label:{fontStyle:"normal",fontWeight:F.l.semilight,color:e.palette.neutralLight,whiteSpace:"nowrap"},checkbox:{height:"18px",width:"18px",borderColor:e.palette.neutralLight,borderRadius:"2px"}})),alignmentDropDownStyles:lc,alignmentSpinButtonStyles:gc,alignRowDivStyles:Object(Jo.c)((e,t=!1)=>({marginTop:e?void 0:"10px",display:"flex",justifyContent:t?"flex-start":"space-between",flexDirection:"row",marginRight:e?"20px":void 0})),verticalOrientationDivStyles:{display:"inline-flex",flexDirection:"row",flexWrap:"wrap"},iconButtonStyles:cc,textControlLabelStyles:pc,storeConnectedIconButtonsStyles:uc,mergeSplitButtonStyles:dc,orientationSpinButtonDivWrapper:{flexShrink:0}};var mc=n(96),bc=n(2642),fc=n(2638),xc=n(827);const Ec={root:{height:"12px",width:"12px",marginRight:"-6px"}},Sc=()=>R.createElement(fe.a,{iconName:Po.a.downChevron.icon12,styles:Ec});var yc=n(2643);function Cc(e,t,n){Object(_.c)(t)?(Object(_.a)(e),Object(yc.a)(e,t)):n||i.a.sendTraceTag(507905987,a.a.msoulscat_ES_EWAJS,s.a.Info,"logPanePerfTelemetry: start marker not found. "+t),Object(_.b)(e),Object(_.b)(t)}var vc=n(2107),Rc=n(127),kc=n(55),Tc=n(627);const _c=Object(Rc.a)([(e,t)=>t.controlsToRender,kc.V,kc.u,kc.cb],(e,t,n,o)=>{const r={};return e.forEach(e=>{const i=Object(Tc.c)(t,n,e,o);r[e]=i}),r});var wc=n(572),Dc=n(1771),Pc=n(160),Ic=n(189);const Fc=Object(x.isChangeGateEnabled)("OfficeVSO:8654917_StoreConnectedTaskPanePropComparison"),Bc=e=>(R.useEffect(()=>(Object(wc.a)(Object(vc.j)(e.taskPaneId,e.controlsToRender)),()=>{Object(wc.a)(Object(vc.j)(e.taskPaneId,[]))}),[e.taskPaneId,e.controlsToRender]),e.customViewRendererFunction(e.controlPropsMap)),Mc=R.memo(Bc,(e,t)=>{if(e.taskPaneId!==t.taskPaneId)return!1;if(!Object.is(e.controlsToRender,t.controlsToRender))return!1;for(let n=0;n<e.controlsToRender.length;n++){const o=e.controlsToRender[n];if(!Object.is(e.controlPropsMap[o],t.controlPropsMap[o]))return!1}return!0}),jc=Object(Ic.connect)((e,t)=>_object_spread_props(_object_spread({},t),{controlPropsMap:_c(e,t)}),void 0,void 0,{areStatesEqual:Object(Pc.c)("StoreConnectedTaskPaneView")})(Object(Dc.a)(Fc?Mc:Bc));var Oc=n(2567),Lc=n(2235),Ac=(n(1209),n(2136));R.PureComponent;class Nc extends R.PureComponent{render(){return R.createElement(Ac.a,_object_spread_props(_object_spread({},this.props),{styles:Object(hl.a)(!1,this.props.styles),dataAutomationType:"TaskPaneToggleButton"}))}}var Wc=n(2481),zc=n(2458);class Hc extends R.PureComponent{render(){return R.createElement(Wc.a,_object_spread(_object_spread_props(_object_spread({},this.props),{dataAutomationType:"TaskPaneComboBox"}),Object(zc.a)(gl.a.Small,this.props)))}}var Vc=n(2133),Uc=n(1035),Gc=n(1374);const qc=Object(Jo.c)(e=>{const t=Object(Gc.a)(!1),n={splitButtonMenuButton:[{height:26,width:26,backgroundColor:t.defaultBackgroundColor,selectors:{":hover":{backgroundColor:t.hoverBackgroundColor},":active":{backgroundColor:t.pressedBackgroundColor}}}],splitButtonDivider:{height:13,right:26},splitButtonContainer:{height:26,selectors:{":hover button":{borderColor:t.hoverBackgroundColor},":active button":{borderColor:t.pressedBackgroundColor}}},splitButtonMenuButtonExpanded:{backgroundColor:t.toggledBackgroundColor,selectors:{":hover":{backgroundColor:t.hoverBackgroundColor}}},splitButtonMenuButtonDisabled:{backgroundColor:t.disabledBackgroundColor}};return Object(F.I)(n,e)}),Qc=(Object(Jo.c)((e,t,n,o)=>Object(Uc.b)(t,gl.a.Small,n,Object(F.I)(Object(Uc.a)(e,o),Object(hl.a)(!0),qc()))),Object(Jo.c)(e=>Object(F.I)(Object(hl.a)(!1),qc(e))));R.PureComponent;class Kc extends R.PureComponent{render(){const e=Qc(this.props.styles);return R.createElement(Vc.a,_object_spread_props(_object_spread({},this.props),{styles:e,dataAutomationType:"TaskPaneSplitButton"}))}}var Jc=n(226);class Yc extends R.Component{get shouldGridTakeFocus(){return!Object(x.isChangeGateEnabled)("OfficeVSO:8428800_FocusFixOnFontTab")&&void 0}render(){return R.createElement(jc,{taskPaneId:this.props.taskPaneId,controlsToRender:this.controlsToRender,customViewRendererFunction:this.renderTab})}constructor(e){super(e),this.renderControlFromCommandId=(e,t)=>{var n,o,r;const s=e[t];if(!s)throw i.a.shipAssertTag(508074143,a.a.msoulscat_ES_EWAJS,!1,`ControlProps not found for commandId: ${t}. Did you add it to the controlsToRender property?`),new Error("ControlProps not found for commandId: "+t);const l=_object_spread_props(_object_spread({},s),{location:Jc.b.TaskPane,shouldTakeFocus:null!==(n=this.shouldGridTakeFocus)&&void 0!==n?n:s.shouldTakeFocus});switch(l.type){case"AppToggleButtonProps":return R.createElement(we.a,null,e=>R.createElement(Nc,_object_spread(_object_spread_props(_object_spread({},l),{hideLabel:!0,keytipProps:void 0}),this.getOverridePropsForCommandId(l.id,e))));case"AppButtonProps":return R.createElement(we.a,null,e=>R.createElement(Ys.b,_object_spread(_object_spread_props(_object_spread({},l),{hideLabel:!1,keytipProps:void 0}),this.getOverridePropsForCommandId(l.id,e))));case"AppComboBoxProps":return R.createElement(we.a,null,e=>R.createElement(Hc,_object_spread(_object_spread_props(_object_spread({},l),{downChevronIcon:Po.a.downChevron,keytipProps:void 0}),this.getOverridePropsForCommandId(l.id,e))));case"AppFontPickerProps":return R.createElement(we.a,null,e=>R.createElement(Oc.a,_object_spread(_object_spread_props(_object_spread({},l),{downChevronIcon:Po.a.downChevron,keytipProps:void 0}),this.getOverridePropsForCommandId(l.id,e))));case"AppSplitButtonProps":return R.createElement(we.a,null,e=>R.createElement(Kc,_object_spread(_object_spread_props(_object_spread({},l),{downChevronIcon:Po.a.downChevron.icon8,controlInMenuRendererFunction:this.defaultRibbonControlInMenuRendererFunction,hideLabel:!0,keytipProps:void 0}),this.getOverridePropsForCommandId(l.id,e))));case"AppIconFullGalleryProps":const e=l;return Object(x.isChangeGateEnabled)("OfficeVSO:8596179_FixEscBehaviourOnBordersTab")&&(e.useInMenuHover=!1),null===(o=e.galleryButtons)||void 0===o||o.forEach(e=>{var t;e.keytipProps=void 0,e.shouldTakeFocus=null!==(t=this.shouldGridTakeFocus)&&void 0!==t?t:e.shouldTakeFocus}),null===(r=e.gallerySections)||void 0===r||r.forEach(e=>{e.galleryButtons.forEach(e=>{var t;e.keytipProps=void 0,e.shouldTakeFocus=null!==(t=this.shouldGridTakeFocus)&&void 0!==t?t:e.shouldTakeFocus})}),R.createElement(we.a,null,t=>R.createElement(xr.a,_object_spread({},e,this.getOverridePropsForCommandId(e.id,t))));case"AppFlyoutAnchorProps":return R.createElement(we.a,null,e=>R.createElement(fl,_object_spread(_object_spread_props(_object_spread({},l),{controlInMenuRendererFunction:this.defaultRibbonControlInMenuRendererFunction,keytipProps:void 0,downChevronIcon:Po.a.downChevron.icon8}),this.getOverridePropsForCommandId(l.id,e))));default:return this.defaultRibbonControlRendererFunction(l)}},this.state={},Object(x.isChangeGateEnabled)("OfficeVSO:8586104_ChangeControlMenuRendererToMLR")?this.defaultRibbonControlInMenuRendererFunction=Object(Br.a)(Po.a,Object(Fr.a)()):this.defaultRibbonControlInMenuRendererFunction=Object(cl.c)(Po.a,Object(Fr.a)()),this.defaultRibbonControlRendererFunction=Object(Lc.a)(Po.a,this.defaultRibbonControlInMenuRendererFunction)}}class Zc extends Yc{constructor(e){super(e),this.getOverridePropsForCommandId=(e,t)=>{switch(e){case oc.b.Wrap:return _object_spread_props(_object_spread({},hc.storeConnectedIconButtonsStyles),{hideLabel:!1});case oc.b.Merge:return _object_spread_props(_object_spread({},hc.mergeSplitButtonStyles),{hideLabel:!1});default:return{}}},this.renderTab=e=>R.createElement(At.a,{horizontal:!0},this.renderControlFromCommandId(e,oc.b.Wrap),this.renderControlFromCommandId(e,oc.b.Merge)),this.controlsToRender=[oc.b.Wrap,oc.b.Merge]}}var $c=n(11),Xc=n(2557);const eu=[{text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.HorizontalAlignmentOptionsGeneral),key:Xc.a.Automatic},{text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.HorizontalAlignmentOptionsLeft),key:Xc.a.Left},{text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.HorizontalAlignmentOptionsCenter),key:Xc.a.Center},{text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.HorizontalAlignmentOptionsRight),key:Xc.a.Right}];Object($c.h)("Microsoft.Office.Excel.CenterAcrossSelectionInRibbonEnabled",!1)&&eu.push({text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.HorizontalAlignmentOptionsCenterAcrossSelection),key:Xc.a.CenterAcrossSelection});const tu=Object(x.isChangeGateEnabled)("OfficeVSO:7941823_textOrientationSlice3"),nu=[{text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.VerticalAlignmentOptionsTop),key:Xc.d.Top},{text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.VerticalAlignmentOptionsCenter),key:Xc.d.Center},{text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.VerticalAlignmentOptionsBottom),key:Xc.d.Bottom}],ou=[{unitType:"Number",unitPlaceholder:"{0}",minValue:-90,maxValue:90,step:1}],ru=[{unitType:"Number",unitPlaceholder:"{0}",minValue:0,maxValue:250,step:1}],iu={negativeSign:"-",numberDecimalDigits:0,numberDecimalSeparator:".",numberNegativePattern:0,numberGroupSeparator:",",numberGroupSizes:[3]};class au extends R.Component{render(){return R.createElement(we.a,null,e=>R.createElement(Jl.Consumer,null,t=>{var n;return this.alignmentModel=null==t||null===(n=t.viewModelData)||void 0===n?void 0:n.alignmentModel,this.alignmentCallbacks=null==t?void 0:t.callbacks.alignmentCallbacks,R.createElement("div",{style:{marginLeft:"17px",marginRight:"15px"}},R.createElement("div",{style:hc.alignRowDivStyles(!1)},R.createElement(bc.a,{type:"AppDropdownProps",id:"HorizontalAlignment",componentRef:this.horizontalAlignmentDropdownRef,label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.HorizontalAlignmentDropdownLabel),selectedKey:this.alignmentModel.horizontalAlignmentType,options:eu,styles:hc.alignmentDropDownStyles(e),onChange:this.onHorizontalAlignmentChanged,onRenderCaretDown:Sc,dropdownWidth:"auto",disabled:this.alignmentModel.disableAllControls}),R.createElement(fc.a,{id:"indentation",type:"AppSpinButtonProps",numberFormatInfo:iu,incrementButtonIcon:be.a.CommonControlChevronUp_12,decrementButtonIcon:be.a.CommonControlChevronDown_12,label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.IndentLabel),validUnits:ru,styles:hc.alignmentSpinButtonStyles(e,!0),unitType:ru[0].unitType,value:this.alignmentModel.indent,onExecute:this.onIndentationChanged,labelPosition:mc.a.top,disabled:this.alignmentModel.disableAllControls})),R.createElement("div",{style:hc.alignRowDivStyles(!1)},R.createElement(bc.a,{type:"AppDropdownProps",id:"VerticalAlignment",componentRef:this.verticalAlignmentDropdownRef,label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.VerticalAlignmentDropdownLabel),selectedKey:this.alignmentModel.verticalAlignmentType,options:nu,styles:hc.alignmentDropDownStyles(e),onChange:this.onVerticalAlignmentChanged,dropdownWidth:"auto",onRenderCaretDown:Sc,disabled:this.alignmentModel.disableAllControls})),R.createElement(Yl.a,{id:"TextControlLabel",type:"AppLabelProps",forId:"TextControl",label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.TextControlLabel),styles:hc.textControlLabelStyles}),R.createElement("div",{id:"TextControl",style:hc.alignRowDivStyles(!0,!0),"aria-label":ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.TextControlLabel)},!this.isAlignmentPaneCleanUpEnabled&&R.createElement(xc.a,{id:"WrapTextIcon",componentRef:this.wrapTextButtonRef,iconProps:{iconName:g.a.WrapText_20},onClick:()=>{var e;this.alignmentCallbacks.wrapText(!this.alignmentModel.isWrapText),null===(e=this.wrapTextButtonRef.current)||void 0===e||e.focus()},checked:this.alignmentModel.isWrapText,toggle:!0,styles:hc.iconButtonStyles(!1),text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.AlignmentTextControlWrapText),disabled:this.alignmentModel.disableAllControls}),!this.isAlignmentPaneCleanUpEnabled&&R.createElement(xc.a,{id:"MergeCellsIcon",componentRef:this.mergeCellsButtonRef,iconProps:{iconName:g.a.MergeCells_20},checked:this.alignmentModel.isMergeCells,disabled:this.alignmentModel.isMergeCellsDisabled||this.alignmentModel.disableAllControls,onClick:()=>{var e;this.alignmentCallbacks.mergeCells(!this.alignmentModel.isMergeCells),null===(e=this.mergeCellsButtonRef.current)||void 0===e||e.focus()},toggle:!0,styles:hc.iconButtonStyles(!1,"10px"),text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.AlignmentTextControlMergeCells)}),this.isAlignmentPaneCleanUpEnabled&&R.createElement(Zc,_object_spread({},this.props))),tu&&R.createElement("div",{style:hc.verticalOrientationDivStyles},R.createElement("div",{style:hc.orientationSpinButtonDivWrapper},R.createElement(fc.a,{id:"orientaion",type:"AppSpinButtonProps",numberFormatInfo:iu,incrementButtonIcon:be.a.CommonControlChevronUp_12,decrementButtonIcon:be.a.CommonControlChevronDown_12,disabled:this.alignmentModel.indent>0||Object(x.isChangeGateEnabled)("OfficeVSO:9170197_DisableOrientationCommandsOnCenterAcrossSelection")&&this.alignmentModel.horizontalAlignmentType===Xc.a.CenterAcrossSelection||this.alignmentModel.disableAllControls,label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.OrientationLabel),validUnits:ou,styles:hc.alignmentSpinButtonStyles(e,!1),unitType:ou[0].unitType,value:this.alignmentModel.orientation,onExecute:this.onOrientationChanged,labelPosition:mc.a.top})),R.createElement(xc.a,{id:"FlipVerticalIcon",componentRef:this.flipVerticalButtonRef,iconProps:{iconName:Object(x.isChangeGateEnabled)("OfficeVSO:8821370_FlipVerticalIconFix")?hr.a.StackedText_16:g.a.RotateCharacters_16},toggle:!0,checked:this.alignmentModel.isFlipVertical,styles:hc.iconButtonStyles(!0),onClick:()=>{var e;this.alignmentCallbacks.flipVertical(!this.alignmentModel.isFlipVertical),null===(e=this.flipVerticalButtonRef.current)||void 0===e||e.focus()},text:Object(x.isChangeGateEnabled)("OfficeVSO:8821370_FlipVerticalIconFix")?ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.VerticalText):ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FlipVerticalLabel),disabled:this.alignmentModel.disableAllControls})))}))}componentDidUpdate(){Cc("AlignmentTab::Update::End","AlignmentTab::Update::Start"),Cc("AlignmentTab::CmdUpdate::End","AlignmentTab::CmdUpdate::Start",!0)}constructor(e){super(e),this.horizontalAlignmentDropdownRef=R.createRef(),this.verticalAlignmentDropdownRef=R.createRef(),this.wrapTextButtonRef=R.createRef(),this.mergeCellsButtonRef=R.createRef(),this.flipVerticalButtonRef=R.createRef(),this.onHorizontalAlignmentChanged=(e,t)=>{var n;t&&this.alignmentCallbacks.onHorizontalAlignmentChange(Number(t.key)),null===(n=this.horizontalAlignmentDropdownRef.current)||void 0===n||n.focus()},this.onVerticalAlignmentChanged=(e,t)=>{var n;t&&this.alignmentCallbacks.onVerticalAlignmentChange(Number(t.key)),null===(n=this.verticalAlignmentDropdownRef.current)||void 0===n||n.focus()},this.onOrientationChanged=e=>{let t;t="string"==typeof e.value?parseInt(e.value,10):e.value,this.alignmentCallbacks.onOrientationChange(t)},this.onIndentationChanged=e=>{let t;t="string"==typeof e.value?parseInt(e.value,10):e.value,this.alignmentCallbacks.onIndentationChange(t)},this.state={},this.isAlignmentPaneCleanUpEnabled=Object(x.isChangeGateEnabled)("OfficeVSO:8444537_AlignmentPaneCleanUp")}}var su=n(818);const lu={scrollablePaneStyles:{root:{height:118,position:"relative"}},categoryIconStyles:{root:{marginRight:"8px",height:"16px",width:"16px",top:"3px",position:"relative"}},tooltipHostStyles:{root:{width:"10px",height:"10px",marginLeft:"17px"}},tooltipIconStyles:{root:{height:"16px",width:"16px"}},categoryDescriptionStyles:Object(Jo.c)(e=>({root:{fontSize:"12px",width:"270px",marginLeft:"8px",display:"block",color:e.palette.neutralDark}})),categoryDropdownStyles:Object(Jo.c)(e=>({root:{width:"286px",height:"38px",background:"unset",marginLeft:"17px",marginBottom:"41px"},dropdown:{height:"41px"},label:{marginBottom:"5px",fontSize:"12px"},title:{height:"41px",paddingTop:"6px",paddingBottom:"6px",borderColor:"transparent",borderRadius:"4px",fontWeight:F.l.semibold,color:e.palette.neutralDark,boxShadow:"0px 0.3px 0.9px rgba(0, 0, 0, 0.1), 0px 1.6px 3.6px rgba(0, 0, 0, 0.13)",":hover":{borderColor:"transparent !important"}},caretDownWrapper:{paddingTop:"5px",paddingBottom:"5px"},callout:{width:"288px",height:"320px"}})),categoryDivStyles:{display:"flex",flexDirection:"row",marginTop:"8px",marginLeft:"17px",marginBottom:"8px"}};var cu=n(220);const uu={dropdownStyles:Object(Jo.c)(e=>({root:{background:"unset",width:"fit-content"},title:{height:"24px",paddingBottom:"3px",border:"unset",lineHeight:"24px"},callout:{height:"360px",borderRadius:"2px"},label:{fontSize:"12px",marginBottom:"4px",height:"16px",paddingBottom:"0px",paddingTop:"0px"},dropdown:{height:"26px",border:"1px solid "+e.palette.neutralQuaternary,borderRadius:"2px",width:"140px"},caretDownWrapper:{height:"16px",paddingBottom:"3px",paddingTop:"0px",lineHeight:"24px"}})),decimalSpinnerStyles:Object(Jo.c)(e=>({root:{paddingLeft:"0px",paddingRight:"0px",width:"fit-content"},spinButtonWrapper:{width:"140px",height:"24px",border:"1px solid",borderColor:e.palette.neutralQuaternary+" !important",borderRadius:"2px",background:e.palette.white},labelWrapper:{marginBottom:"4px",height:"16px"},label:{fontSize:"12px",fontWeight:F.l.semibold}})),decimalSpinnerWrapperStyles:{width:"fit-content"},stackStyles:{root:{width:"288px",columnGap:"2px",justifyContent:"space-between",marginLeft:"17px",flexDirection:"row",flexWrap:"wrap"}},decimalStackItemStyles:{root:{minWidth:"140px"}},symbolStackItemStyles:{root:{minWidth:"140px"}}},du=R.memo(e=>{const t=(t,n)=>{let o;o="string"==typeof(null==n?void 0:n.key)?parseInt(n.key,10):null==n?void 0:n.key,o!==e.currencyType&&e.onSymbolChanged(o)},n=e=>{const t=[];for(let n=0;n<((null==e?void 0:e.length)||0);n++)t.push({key:n,text:e[n]||""});return t};return R.createElement(we.a,null,o=>R.createElement(bc.a,{type:"AppDropdownProps",id:"currencyDropdown",label:ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.SymbolLabel),selectedKey:e.currencyType,options:n(e.currencySymbols),placeholder:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NumberFormatAccountingCurrencySymbol),styles:uu.dropdownStyles(o),onChange:t,responsiveMode:su.a.large,dropdownWidth:212,onRenderCaretDown:Sc}))},(e,t)=>Object(cu.e)(e.currencySymbols,t.currencySymbols)&&e.currencyType===t.currencyType),pu=[{unitType:"Number",unitPlaceholder:"{0}",minValue:0,maxValue:30,step:1}],gu={negativeSign:"-",numberDecimalDigits:2,numberDecimalSeparator:".",numberNegativePattern:0,numberGroupSeparator:",",numberGroupSizes:[3]},hu=R.memo(e=>{const[t,n]=R.useState(e.decimalPlaces);return R.useEffect(()=>{n(e.decimalPlaces)},[e.decimalPlaces]),R.createElement(we.a,null,o=>R.createElement("div",{style:uu.decimalSpinnerWrapperStyles},R.createElement(fc.a,{type:"AppSpinButtonProps",id:"decimalPlacesSpinner",label:ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.DecimalPlacesLabel),labelPosition:mc.a.top,value:t,validUnits:pu,onExecute:t=>(t=>{let o;o="string"==typeof t.value?parseInt(t.value,10):t.value,o!==e.decimalPlaces&&(n(o),e.onDecimalPlacesChanged(o))})(t),incrementAriaLabel:ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.DecimalPlacesIncrementAriaLabel),decrementAriaLabel:ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.DecimalPlacesDecrementAriaLabel),styles:uu.decimalSpinnerStyles(o),unitType:pu[0].unitType,numberFormatInfo:gu,incrementButtonIcon:be.a.CommonControlChevronUp_12,decrementButtonIcon:be.a.CommonControlChevronDown_12})))},(e,t)=>e.decimalPlaces===t.decimalPlaces);class mu extends R.PureComponent{render(){return R.createElement(Jl.Consumer,null,e=>{var t,n,o;return R.createElement(R.Fragment,null,R.createElement(At.a,{horizontal:!0,styles:uu.stackStyles},this.props.isSymbolVisible&&R.createElement(At.a.Item,{grow:1,styles:uu.symbolStackItemStyles},R.createElement(du,{currencyType:null==e||null===(t=e.viewModelData)||void 0===t||null===(t=t.numberFormatModel)||void 0===t?void 0:t.currencyType,currencySymbols:null==e||null===(n=e.viewModelData)||void 0===n||null===(n=n.numberFormatModel)||void 0===n?void 0:n.currencySymbols,onSymbolChanged:null==e?void 0:e.callbacks.numberFormatCallbacks.onSymbolChanged})),R.createElement(At.a.Item,{grow:1,styles:uu.decimalStackItemStyles},R.createElement(hu,{decimalPlaces:null==e||null===(o=e.viewModelData)||void 0===o||null===(o=o.numberFormatModel)||void 0===o?void 0:o.decimalPlaces,onDecimalPlacesChanged:null==e?void 0:e.callbacks.numberFormatCallbacks.onDecimalPlacesChanged}))))})}constructor(e){super(e)}}var bu=n(2508);const fu=Object(Jo.c)(e=>({root:{left:"17px",position:"relative"},spinButtonWrapper:{width:"140px",height:"24px",border:"1px solid",borderColor:e.palette.neutralTertiaryAlt,borderRadius:"2px",background:e.palette.white},labelWrapper:{fontSize:"12px",fontWeight:F.l.semibold}})),xu=Object(Jo.c)((e,t)=>({root:{left:"17px",marginTop:"8px",border:"none",paddingLeft:"0px",height:"16px",borderRadius:"2px"},text:{fontSize:"12px",lineHeight:"16px",marginLeft:"8px"},checkbox:[t&&{background:e.palette.themePrimary},{marginRight:"0px"}]})),Eu=Object(Jo.c)(e=>({root:{height:"24px",minHeight:"24px",borderBottom:"unset"},cell:{color:e,minHeight:"24px",height:"24px",paddingTop:"0px",paddingBottom:"0px",display:"flex",alignItems:"center"}})),Su=Object(Jo.c)(e=>({root:{height:"24px",minHeight:"24px",borderBottom:"unset"},cell:{color:e.palette.neutralDark,minHeight:"24px",height:"24px",paddingTop:"0px",paddingBottom:"0px",display:"flex",alignItems:"center"}})),yu={decimalButtonStyles:fu,thousandSeparatorCheckBoxStyles:xu,detailListLabelStyles:{root:{left:"17px",position:"relative",marginTop:"11px",paddingLeft:"0px",label:{fontSize:"12px",fontWeight:F.l.semibold}}},negativeDetailListRowStyles:Eu,typeDetailListStyles:Object(Jo.c)((e,t)=>({root:{left:"17px",width:"288px",height:"97px",overflowX:"hidden",border:"1px solid",borderRadius:"2px",borderColor:e.palette.neutralQuaternary,selectors:{".ms-List-cell":{minHeight:"24px",height:"24px",paddingTop:"0px",paddingBottom:"0px"},".is-selected":{background:0===t?e.palette.white:e.palette.neutralLight,fontStyle:0===t?"italic":"normal"}}},focusZone:{},headerWrapper:{},contentWrapper:{}})),detailListRowStyles:Su};class Cu extends R.Component{shouldComponentUpdate(e){return this.props.isChecked!==e.isChecked}render(){return R.createElement(we.a,null,e=>R.createElement(R.Fragment,null,R.createElement(bu.a,{type:"AppCheckboxProps",id:"thousandSeparatorCheckbox",label:ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.ThousandsSeparatorLabel),checked:this.props.isChecked,onExecute:this.onThousandSeparatorChanged,styles:yu.thousandSeparatorCheckBoxStyles(e,this.props.isChecked),iconColor:e.palette.white,checkmarkIcon:c.a.CheckmarkWithDynamicColor_16})))}constructor(e){super(e),this.onThousandSeparatorChanged=e=>{this.props.onThousandSeparatorChanged(e.checked)},this.state={}}}var vu=n(2547),Ru=n(2172),ku=n(1022),Tu=n(1180),_u=n(118);const wu=Object(vu.a)(Ru.a,Math.floor(4)-1,24);class Du extends R.Component{shouldComponentUpdate(e){return!Object(cu.e)(this.props.items,e.items)||this.props.currentType!==e.currentType}render(){return R.createElement(we.a,null,e=>R.createElement(R.Fragment,null,this.props.isNegativeNumberType?this.generateLabel(ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.NegativeNumbersLabel)):this.generateLabel(ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.TypeLabel)),R.createElement(wu,{items:this.getItems(this.props.items),id:"typeDetailsList",type:"AppDetailsListProps",componentRef:this.detailsListRef,columns:this.columns,compact:!1,selectionMode:_u.d.single,selectionPreservedOnEmptyClick:!0,selection:this.selection,isHeaderVisible:!1,isSelectedOnFocus:!1,ariaLabelForGrid:this.props.isNegativeNumberType?ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.NegativeNumbersLabel):ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.TypeLabel),onItemInvoked:this.onItemInvoked,styles:yu.typeDetailListStyles(e,this.props.items?this.props.items.length:0),onRenderRow:this.props.isNegativeNumberType?this.onRenderNegativeTypeRow:this.onRenderRow})))}onTypeChanged(){if(0!==this.selection.getSelectedCount()){const n=this.selection.getSelection()[0];let o;var e,t;o="string"==typeof(null==n?void 0:n.key)?parseInt(n.key,10):null==n?void 0:n.key,o!==this.props.currentType&&(this.props.onTypeChanged(o),Object(x.isChangeGateEnabled)("OfficeVSO:8468791_NumberTabFocusFix")&&(null===(e=this.detailsListRef.current)||void 0===e||e.focusIndex(o))),Object(x.isChangeGateEnabled)("OfficeVSO:8468791_NumberTabFocusFix")||null===(t=this.detailsListRef.current)||void 0===t||t.focusIndex(o)}}constructor(e){super(e),this.detailsListRef=R.createRef(),this.selection=new ku.a({onSelectionChanged:()=>{this.onTypeChanged()}}),this.generateLabel=e=>R.createElement(Yl.a,{id:"typeLabel",type:"AppLabelProps",forId:"typeDetailsList",label:e,styles:yu.detailListLabelStyles}),this.onItemInvoked=e=>{this.selection.toggleIndexSelected(this.props.currentType),this.selection.toggleIndexSelected(e.key)},this.onRenderNegativeTypeRow=e=>R.createElement(we.a,null,t=>{let n="#E41323";return e.itemIndex%2==0&&(n=t.palette.neutralDark),this.setSelectedRow(e),R.createElement(Tu.a,_object_spread_props(_object_spread({},e),{styles:yu.negativeDetailListRowStyles(n)}))}),this.onRenderRow=e=>R.createElement(we.a,null,t=>(this.setSelectedRow(e),R.createElement(Tu.a,_object_spread_props(_object_spread({},e),{styles:yu.detailListRowStyles(t)})))),this.getItems=e=>{const t=[];if(e&&0!==e.length)for(let n=0;e&&n<e.length;n++)t.push({key:n,text:e[n]||"",value:e[n]||""});else t.push({key:0,text:ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.EmptyTypeDescription),value:ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.EmptyTypeDescription)});return t},this.setSelectedRow=e=>{e.itemIndex===this.props.currentType&&e.selection.setIndexSelected(this.props.currentType,!0,!1)},this.columns=[{key:"value",name:"Value",fieldName:"value",isResizable:!1,minWidth:50}]}}class Pu extends R.Component{render(){return R.createElement(Jl.Consumer,null,e=>{var t,n,o,r;return R.createElement(R.Fragment,null,R.createElement(mu,{isSymbolVisible:!1}),R.createElement(Cu,{isChecked:null==e||null===(t=e.viewModelData)||void 0===t||null===(t=t.numberFormatModel)||void 0===t?void 0:t.isComma,onThousandSeparatorChanged:null===(n=e.callbacks.numberFormatCallbacks)||void 0===n?void 0:n.onThousandSeparatorChanged}),R.createElement(Du,{items:null==e||null===(o=e.viewModelData)||void 0===o||null===(o=o.numberFormatModel)||void 0===o?void 0:o.negativeNumberTypes,onTypeChanged:null==e?void 0:e.callbacks.numberFormatCallbacks.onNegativeNumberTypeChanged,isNegativeNumberType:!0,currentType:null==e||null===(r=e.viewModelData)||void 0===r||null===(r=r.numberFormatModel)||void 0===r?void 0:r.negativeNumberType}))})}constructor(e){super(e)}}class Iu extends R.Component{render(){return R.createElement(Jl.Consumer,null,e=>{var t,n;return R.createElement(R.Fragment,null,R.createElement(mu,{isSymbolVisible:!0}),R.createElement(Du,{items:null==e||null===(t=e.viewModelData)||void 0===t||null===(t=t.numberFormatModel)||void 0===t?void 0:t.negativeCurrencyTypes,onTypeChanged:null==e?void 0:e.callbacks.numberFormatCallbacks.onNegativeCurrencyTypeChanged,isNegativeNumberType:!0,currentType:null==e||null===(n=e.viewModelData)||void 0===n||null===(n=n.numberFormatModel)||void 0===n?void 0:n.negativeCurrencyType}))})}constructor(e){super(e)}}var Fu=n(110);const Bu={infoStyle:{display:"flex",justifyContent:"space-between",marginTop:"5px"},localeStyle:{marginLeft:"17px"},calendarCheckBoxStyles:{root:{paddingTop:"10px",paddingBottom:"10px"},checkbox:{height:"18px",width:"18px",borderRadius:"2px"}},localeDropdownStyles:{root:{marginTop:"5px",marginBottom:"5px",maxWidth:"288px",background:sc().backgroundTransparent},dropdownOptionText:{fontFamily:"Segoe UI",fontWeight:F.l.regular,fontSize:"12px"},label:{fontSize:"12px"},title:{borderColor:"transparent",fontWeight:F.l.regular,fontSize:"12px",borderRadius:"2px",boxShadow:"0px 0.3px 0.9px rgba(0, 0, 0, 0.1), 0px 1.6px 3.6px rgba(0, 0, 0, 0.13)",":hover":{borderColor:"transparent !important"}},dropdownItemsWrapper:{maxHeight:"196px"}},localeAppComboboxStyles:Object(Jo.c)(e=>({container:{display:"block",margin:"5px 0px 5px 0px",height:"58px",maxWidth:"288px",width:"100%"},callout:{maxWidth:"288px"},root:{height:"32px",margin:"0px",borderRadius:"2px",borderColor:"transparent",boxShadow:"0px 0.3px 0.9px rgba(0, 0, 0, 0.1), 0px 1.6px 3.6px rgba(0, 0, 0, 0.13)",fontWeight:F.l.regular,fontSize:"12px","input[type=text]":{paddingTop:"3px",paddingBottom:"3px",paddingLeft:"8px"},width:"100%"},rootFocused:{border:"2px solid "+e.palette.themePrimary},input:{paddingTop:"3px",paddingBottom:"3px",paddingLeft:"8px",height:"100%"},label:{fontSize:"12px",margin:"0px",fontWeight:F.l.semibold},optionsContainerWrapper:{maxHeight:"196px"},optionsContainer:{fontSize:"12px",fontWeight:F.l.regular}})),localeDropdownCaretDownStyles:{root:{height:"100%",width:Fu.a.comboBoxCaretWidth,minWidth:Fu.a.comboBoxCaretWidth},icon:{width:"12px",height:"12px",lineHeight:"12px"}},localeAppComboboxOptionsStyles:{optionText:{fontSize:"12px",fontWeight:F.l.regular}},applyLocaleButtonStyles:Object(Jo.c)(e=>({root:{marginTop:"10px",marginBottom:"10px",background:e.palette.white,borderRadius:"2px",boxShadow:"0px 0.3px 0.9px rgba(0, 0, 0, 0.1), 0px 1.6px 3.6px rgba(0, 0, 0, 0.13)"}})),learnMoreDivStyles:{marginTop:"8px",paddingBottom:"10px"}};var Mu=n(2171),ju=n(482);let Ou=void 0,Lu=void 0;class Au extends R.Component{render(){return R.createElement(we.a,null,e=>R.createElement(Jl.Consumer,null,t=>{var n,o,r,i,a;return this.numberFormatModel=null==t||null===(n=t.viewModelData)||void 0===n?void 0:n.numberFormatModel,this.numberFormatCallbacks=null==t?void 0:t.callbacks.numberFormatCallbacks,Lu=null===(o=this.numberFormatModel)||void 0===o?void 0:o.localeIndex,R.createElement("div",{style:Bu.localeStyle},this.getLocaleComponent(Lu,e),4===(null===(r=this.numberFormatModel)||void 0===r?void 0:r.currentCategory)&&(null===(i=this.numberFormatModel)||void 0===i?void 0:i.calendarTypes)&&this.calendarDropDownComponent(),0!==(null===(a=this.numberFormatModel)||void 0===a?void 0:a.localeIndex)&&this.applyLocaleButtonComponent(e),R.createElement("div",{style:Bu.learnMoreDivStyles},R.createElement(Mu.a,{type:"AppLinkProps",id:"LearnMoreLink",text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NumberFormatLocaleLearnMore),handler:{href:"https://go.microsoft.com/fwlink/p/?linkid=2134522",target:"_blank"}})))}))}constructor(e){super(e),this.calendarDropDownComponent=()=>{var e,t,n;return Ou=null===(e=this.numberFormatModel)||void 0===e?void 0:e.calendarType,R.createElement(R.Fragment,null,R.createElement(bc.a,{type:"AppDropdownProps",id:"CalendarTypeDropDown",label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NumberFormatLocaleCalendarType),selectedKey:Ou,options:this.getdropdownOptions(null===(t=this.numberFormatModel)||void 0===t?void 0:t.calendarTypes),styles:Bu.localeDropdownStyles,onChange:this.onCalendarOptionChanged,onRenderCaretDown:Sc}),(null===(n=this.numberFormatModel)||void 0===n?void 0:n.isInputCalendarCheckboxRequired)&&this.calendarTypeCheckbox())},this.calendarTypeCheckbox=()=>{var e,t;return R.createElement(R.Fragment,null,(null===(e=this.numberFormatModel)||void 0===e?void 0:e.isGannenCheckboxRequired)&&this.gannenCheckbox(),R.createElement(bu.a,{type:"AppCheckboxProps",id:"calendarCheckBox",label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NumberFormatLocaleInputCalendarLabel),checked:null===(t=this.numberFormatModel)||void 0===t?void 0:t.isInputCalendarChecked,onExecute:this.onCalendarCheckboxChange,styles:Bu.calendarCheckBoxStyles,checkmarkIcon:Po.a.checkboxCheckmark}))},this.gannenCheckbox=()=>{var e;return R.createElement(bu.a,{type:"AppCheckboxProps",id:"gannenCheckbox",label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NumberFormatLocaleGannen),checked:null===(e=this.numberFormatModel)||void 0===e?void 0:e.isGannenChecked,onExecute:this.onGannenCheckboxChange,styles:Bu.calendarCheckBoxStyles,checkmarkIcon:Po.a.checkboxCheckmark})},this.applyLocaleButtonComponent=e=>R.createElement(Ko.a,{type:"AppButtonProps",id:"OverrideLocaleButton",label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NumberFormatLocaleApplyButtonText),customTooltip:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NumberFormatLocaleApplyButtonToolTip),icon:"Info",onExecute:this.numberFormatCallbacks.overrideLocale,styles:Bu.applyLocaleButtonStyles(e)}),this.getdropdownOptions=e=>{const t=[];for(let n=0;n<e.length;n++)t.push({key:n,text:e[n]||""});return t},this.getComboboxOptions=e=>{const t=[];for(let n=0;n<e.length;n++)t.push({type:"AppComboBoxItem",key:n.toString(),text:e[n]||"",styles:Bu.localeAppComboboxOptionsStyles});return t},this.onCalendarOptionChanged=(e,t)=>{t&&Ou!==Number(t.key)&&this.numberFormatCallbacks.onCalendarTypeChanged(Number(t.key))},this.onCalendarCheckboxChange=e=>{this.numberFormatCallbacks.onInputCalendarChecked(e.checked)},this.onGannenCheckboxChange=e=>{this.numberFormatCallbacks.onGannenChecked(e.checked)},this.onLocaleOptionChanged=(e,t)=>{t&&Lu!==Number(t.key)&&this.numberFormatCallbacks.onLocaleChanged(Number(t.key))},this.onLocaleComboBoxOptionChanged=e=>{if(!e||"string"==typeof e.newValue)return void i.a.sendTraceTag(507593122,a.a.msoulscat_ES_EWAJS,s.a.Error,"LocaleView:onLocaleComboBoxOptionChanged - parameter is null or newValue is not AppComboBoxPreviewNewValueParameter");const t=Number(e.newValue.key);Lu!==t&&this.numberFormatCallbacks.onLocaleChanged(t)},this.getLocaleComponent=(e,t)=>{var n,o;return Object(x.isChangeGateEnabled)("OfficeVSO:8642586_FixJumppyLocaleMenu")?R.createElement(ju.a,{type:"AppComboBoxProps",id:"LocaleDropdown",label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NumberFormatLocale),showLabel:!0,selectedKey:e.toString(),options:this.getComboboxOptions(null===(o=this.numberFormatModel)||void 0===o?void 0:o.localeOptions),styles:Bu.localeAppComboboxStyles(t),caretDownButtonStyles:Bu.localeDropdownCaretDownStyles,downChevronIcon:Po.a.downChevron.icon12,onExecute:this.onLocaleComboBoxOptionChanged}):R.createElement(bc.a,{type:"AppDropdownProps",id:"LocaleDropdown",label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NumberFormatLocale),selectedKey:e,options:this.getdropdownOptions(null===(n=this.numberFormatModel)||void 0===n?void 0:n.localeOptions),styles:Bu.localeDropdownStyles,onChange:this.onLocaleOptionChanged,onRenderCaretDown:Sc})}}}class Nu extends R.PureComponent{render(){return R.createElement(Jl.Consumer,null,e=>{var t,n;return R.createElement(R.Fragment,null,R.createElement(Du,{items:null==e||null===(t=e.viewModelData)||void 0===t||null===(t=t.numberFormatModel)||void 0===t?void 0:t.dateTypes,onTypeChanged:null==e?void 0:e.callbacks.numberFormatCallbacks.onDateTypeChanged,isNegativeNumberType:!1,currentType:null==e||null===(n=e.viewModelData)||void 0===n||null===(n=n.numberFormatModel)||void 0===n?void 0:n.dateType}),R.createElement(Au,null))})}constructor(e){super(e)}}class Wu extends R.Component{render(){return R.createElement(Jl.Consumer,null,e=>{var t,n;return R.createElement(R.Fragment,null,R.createElement(Du,{items:null==e||null===(t=e.viewModelData)||void 0===t||null===(t=t.numberFormatModel)||void 0===t?void 0:t.timeTypes,onTypeChanged:null==e?void 0:e.callbacks.numberFormatCallbacks.onTimeTypeChanged,isNegativeNumberType:!1,currentType:null==e||null===(n=e.viewModelData)||void 0===n||null===(n=n.numberFormatModel)||void 0===n?void 0:n.timeType}),R.createElement(Au,null))})}constructor(e){super(e)}}class zu extends R.Component{render(){return R.createElement(Jl.Consumer,null,e=>{var t,n;return R.createElement(Du,{items:null==e||null===(t=e.viewModelData)||void 0===t||null===(t=t.numberFormatModel)||void 0===t?void 0:t.fractionTypes,onTypeChanged:null==e?void 0:e.callbacks.numberFormatCallbacks.onFractionTypeChanged,isNegativeNumberType:!1,currentType:null==e||null===(n=e.viewModelData)||void 0===n||null===(n=n.numberFormatModel)||void 0===n?void 0:n.fractionType})})}constructor(e){super(e)}}class Hu extends R.Component{render(){return R.createElement(Jl.Consumer,null,e=>{var t,n;return R.createElement(R.Fragment,null,R.createElement(Du,{items:null==e||null===(t=e.viewModelData)||void 0===t||null===(t=t.numberFormatModel)||void 0===t?void 0:t.specialTypes,onTypeChanged:null==e?void 0:e.callbacks.numberFormatCallbacks.onSpecialTypeChanged,isNegativeNumberType:!1,currentType:null==e||null===(n=e.viewModelData)||void 0===n||null===(n=n.numberFormatModel)||void 0===n?void 0:n.specialType}),R.createElement(Au,null))})}constructor(e){super(e)}}class Vu extends R.Component{render(){return R.createElement(Jl.Consumer,null,e=>{var t,n;return R.createElement(R.Fragment,null,R.createElement(Du,{items:null==e||null===(t=e.viewModelData)||void 0===t||null===(t=t.numberFormatModel)||void 0===t?void 0:t.customTypes,onTypeChanged:null==e?void 0:e.callbacks.numberFormatCallbacks.onCustomTypeChanged,isNegativeNumberType:!1,currentType:null==e||null===(n=e.viewModelData)||void 0===n||null===(n=n.numberFormatModel)||void 0===n?void 0:n.customType}))})}constructor(e){super(e)}}const Uu={cardStyles:Object(Jo.c)(e=>({height:"40px",width:"288px",background:e.palette.white})),loaderDivStyles:{marginLeft:"17px"},categoryLabelStyles:{root:{paddingLeft:"0px",label:{fontSize:"12px",fontWeight:F.l.semibold}}},shimmerStyles:Object(Jo.c)(e=>({root:{marginLeft:"13px",top:e?"0px":"13px",marginTop:e?"13px":"0px",marginBottom:e?"8px":"13px",height:"14px",width:"101px",borderRadius:"4px",background:"#DCD9D9"}}))},Gu=()=>R.createElement(we.a,null,e=>R.createElement("div",{id:"shimmerNumberFormat",style:Uu.cardStyles(e)},R.createElement(le.a,{styles:Uu.shimmerStyles()}))),qu=()=>R.createElement("div",{style:Uu.loaderDivStyles},R.createElement(Yl.a,{type:"AppLabelProps",id:"numberFormatShimmerLabel",forId:"shimmerNumberFormat",label:ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.ChooseCategoryLabel),styles:Uu.categoryLabelStyles}),Gu(),R.createElement(le.a,{styles:Uu.shimmerStyles(!0)}),Gu(),Gu(),Gu());let Qu=void 0;class Ku extends R.Component{render(){return R.createElement(we.a,null,e=>R.createElement(Jl.Consumer,null,t=>{var n,o,r,i;return this.callbacks=t.callbacks,null!==(n=t.viewModelData)&&void 0!==n&&n.numberFormatModel?(Qu=null==t||null===(o=t.viewModelData)||void 0===o||null===(o=o.numberFormatModel)||void 0===o?void 0:o.currentCategory,R.createElement("div",{style:{display:"flex"}},R.createElement("div",null,R.createElement(bc.a,{type:"AppDropdownProps",id:"numberFormatCategoryDropdown",componentRef:this.categoryDropdownRef,label:ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.ChooseCategoryLabel),selectedKey:Qu,options:this.getNumberFormatCategories(null==t||null===(r=t.viewModelData)||void 0===r||null===(r=r.numberFormatModel)||void 0===r?void 0:r.categories),onRenderOption:this.onRenderDropdownOption,onRenderTitle:this.onRenderDropdownTitle,styles:lu.categoryDropdownStyles(e),onChange:this.onCategoryChanged,responsiveMode:su.a.large,onRenderCaretDown:Sc}),this.renderCategoryView(Qu),R.createElement("div",{style:lu.categoryDivStyles},R.createElement(Ee.a,{content:this.getToolTipDescriptions[Qu]},R.createElement(fe.a,_object_spread_props(_object_spread({role:"tooltip"},Object(mi.a)(Object(x.isChangeGateEnabled)("OfficeVSO:8619734_NumberTabInfoIconChange")?be.a.InfoFluent_16:be.a.Info_20)),{styles:lu.tooltipIconStyles}))),R.createElement(rs.a,{styles:lu.categoryDescriptionStyles(e)},null==t||null===(i=t.viewModelData)||void 0===i||null===(i=i.numberFormatModel)||void 0===i?void 0:i.categoryDescriptionStrings[Qu]))))):R.createElement(qu,null)}))}renderCategoryView(e){switch(e){case 1:return R.createElement(Pu,null);case 2:return R.createElement(Iu,null);case 3:return R.createElement(mu,{isSymbolVisible:!0});case 4:return R.createElement(Nu,null);case 5:return R.createElement(Wu,null);case 6:return R.createElement(mu,{isSymbolVisible:!1});case 7:return R.createElement(zu,null);case 8:return R.createElement(mu,{isSymbolVisible:!1});case 10:return R.createElement(Hu,null);case 11:return R.createElement(Vu,null);default:return R.createElement(R.Fragment,null)}}componentDidUpdate(){Cc("NumberFormatTab::DelayedUpdate::End","NumberFormatTab::DelayedUpdate::Start",!0),Cc("NumberFormatTab::InstantUpdate::End","NumberFormatTab::InstantUpdate::Start",!0)}constructor(e){super(e),this.categoryDropdownRef=R.createRef(),this.iconNames=[be.a.General_16,be.a.DataTypeNumber_16,be.a.InternationalCurrency_16,be.a.Accounting_16,Object(x.isChangeGateEnabled)("OfficeVSO:8745398_DateNewIconCellFormatting")?be.a.Date_16:be.a.NewCalendar_16,be.a.Clock_16,be.a.Percentage_16,be.a.Fraction_16,be.a.DataTypeScientific_16,be.a.Text_16,be.a.EditCode_16,be.a.PbiDataFormat_16],this.getToolTipDescriptions=[ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.GeneralTooltipContent),ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.NumberTooltipContent),ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.CurrencyTooltipContent),ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.AccountingTooltipContent),ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.DateTooltipContent),ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.TimeTooltipContent),ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.PercentageTooltipContent),ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.FractionTooltipContent),ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.ScientificTooltipContent),ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.TextTooltipContent),ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.SpecialTooltipContent),ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.CustomTooltipContent)],this.getNumberFormatCategories=e=>{const t=[];for(let n=0;n<e.length;n++)t.push({key:n,text:e[n]||"",data:{icon:this.iconNames[n]}});return t},this.onRenderDropdownOption=e=>R.createElement("div",null,e.data&&e.data.icon&&R.createElement(fe.a,{styles:lu.categoryIconStyles,iconName:e.data.icon,"aria-hidden":"true"}),R.createElement("span",null,e.text)),this.onRenderDropdownTitle=e=>{const t=e[0];return this.onRenderDropdownOption(t)},this.onCategoryChanged=(e,t)=>{var n;let o;o="string"==typeof(null==t?void 0:t.key)?parseInt(t.key,10):null==t?void 0:t.key,o!==Qu&&this.callbacks.numberFormatCallbacks.onCategoryTypeChange(o),null===(n=this.categoryDropdownRef.current)||void 0===n||n.focus(!0)},this.state={}}}const Ju=Object(Jo.c)(e=>({root:{marginTop:e?"5px":"10px",paddingLeft:"0px",paddingRight:"0px",paddingTop:"3px",paddingBottom:"5px",height:"16px"},label:{fontWeight:F.l.semibold,fontSize:"12px",fontStyle:"normal",lineHeight:"16px"}})),Yu=Object(Jo.c)(e=>({styles:{container:{marginRight:"0px"},root:{height:"24px",marginRight:"8px",border:"1px solid "+e.palette.neutralLight,borderRadius:"2px",display:"flex",justifyContent:"center",alignItems:"center",selectors:{"input[type=text]":{paddingTop:"4px",paddingBottom:"4px",paddingLeft:"8px"}}},input:{height:"24px",paddingTop:"4px",paddingBottom:"4px",paddingLeft:"8px",display:"flex",justifyContent:"center",alignItems:"center",flexShrink:0}},caretDownButtonStyles:{root:{height:"24px",width:Fu.a.comboBoxCaretWidth,minWidth:Fu.a.comboBoxCaretWidth},icon:{width:"12px",height:"12px",lineHeight:"12px"}}})),Zu={mostOutterDivStyling:{marginLeft:"17px",marginRight:"15px",marginBottom:"10px"},textControlLabelStyles:Ju,fontNameComboBoxStyles:Object(Jo.c)(e=>_object_spread({width:207},Yu(e))),fontPickerStyles:Object(Jo.c)(e=>({width:207,styles:{root:{height:"24px"},subComponentStyles:{dropDownStyles:{},textFieldStyles:{root:{height:"24px",marginRight:"0px",border:"1px solid "+e.palette.neutralLight,borderTopLeftRadius:"2px",borderBottomLeftRadius:"2px",borderTopRightRadius:"2px",borderBottomRightRadius:"2px",display:"flex",justifyContent:"center",alignItems:"center",selectors:{"input[type=text]":{paddingTop:"4px",paddingBottom:"4px",paddingLeft:"8px",fontSize:"12px"}}}}}}})),fontSizeComboBoxStyles:Object(Jo.c)(e=>_object_spread({pinToPreviousComboBox:!1,width:73,useComboBoxAsMenuWidth:!0},Yu(e))),iconButtonsStyles:{styles:{root:{marginRight:"8px",paddingLeft:"4px",paddingRight:"4px",height:"27px",width:"32px",border:"unset",backgroundColor:sc().iconButtonBackgroundRest,color:sc().iconButtonForegroundRest,display:"flex",alignItems:"center",justifyContent:"center"},splitButtonMenuButton:{backgroundColor:"unset"},rootDisabled:{border:"unset",backgroundColor:sc().iconButtonBackgroundDisabled,color:sc().iconButtonForegroundDisabled},rootChecked:{backgroundColor:sc().iconButtonBackgroundSelected,color:sc().iconButtonForegroundSelected},rootHovered:{backgroundColor:sc().iconButtonBackgroundHover,color:sc().iconButtonForegroundHover},rootPressed:{backgroundColor:sc().iconButtonBackgroundPressed,color:sc().iconButtonForegroundPressed},rootFocused:{backgroundColor:sc().iconButtonBackgroundFocus,color:sc().iconButtonForegroundFocus}}},fontEffectsStackStyles:{root:{marginRight:"15px"}},fontColorSplitButtonStyles:{styles:{splitButtonContainer:{padding:"0px 4px",display:"flex",alignItems:"center",flexShrink:0},root:{padding:"4px 2px 4px 4px",height:"24px",width:"22px",border:"unset",backgroundColor:"unset",display:"flex",alignItems:"center"},rootDisabled:{border:"unset",backgroundColor:sc().iconButtonBackgroundDisabled,color:sc().iconButtonForegroundDisabled},rootChecked:{backgroundColor:sc().iconButtonBackgroundSelected,color:sc().iconButtonForegroundSelected},rootHovered:{backgroundColor:sc().iconButtonBackgroundHover,color:sc().iconButtonForegroundHover},rootPressed:{backgroundColor:sc().iconButtonBackgroundPressed,color:sc().iconButtonForegroundPressed},rootFocused:{backgroundColor:sc().iconButtonBackgroundFocus,color:sc().iconButtonForegroundFocus},splitButtonDivider:{width:"0px"},splitButtonMenuButton:{backgroundColor:"unset",width:"12px",height:"24px",padding:"4px 2px",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",flexShrink:0,border:"none",outline:"none",selectors:{"span:first-child":{display:"flex",height:"16px"}}},splitButtonMenuButtonDisabled:{backgroundColor:sc().iconButtonBackgroundDisabled,color:sc().iconButtonForegroundDisabled},splitButtonContainerChecked:{backgroundColor:sc().iconButtonBackgroundSelected,color:sc().iconButtonForegroundSelected},splitButtonContainerCheckedHovered:{backgroundColor:sc().iconButtonBackgroundHover,color:sc().iconButtonForegroundHover},splitButtonContainerFocused:{backgroundColor:sc().iconButtonBackgroundFocus,color:sc().iconButtonForegroundFocus},splitButtonMenuIcon:{width:"8px",height:"8px",flexShrink:0}}}};var $u=n(50);class Xu extends Yc{constructor(e){super(e),this.getOverridePropsForCommandId=(e,t)=>{switch(e){case oc.b.FontName_New:return _object_spread_props(_object_spread({},Zu.fontNameComboBoxStyles(t)),{label:ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.ChooseFontLabel)});case oc.b.FontPicker:return _object_spread_props(_object_spread({},Zu.fontPickerStyles(t)),{label:ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.ChooseFontLabel)});case oc.b.FontSize:return Zu.fontSizeComboBoxStyles(t);case oc.b.Bold:case oc.b.Italic:case oc.b.Underline:case oc.b.DoubleUnderline:case oc.b.Strikethrough:return Zu.iconButtonsStyles;case oc.b.FontColor:return Zu.fontColorSplitButtonStyles;default:return{}}},this.renderTab=e=>R.createElement(At.a,{style:Zu.mostOutterDivStyling},R.createElement(At.a,{horizontal:!0},R.createElement(At.a,null,R.createElement(Yl.a,{id:"FontDropdownLabel",type:"AppLabelProps",forId:"FontDropdown",label:ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.ChooseFontLabel),styles:Zu.textControlLabelStyles(!0)}),R.createElement("div",{id:"FontDropdown"},this.renderControlFromCommandId(e,$u.a.isModernFontPickerEnabled()?oc.b.FontPicker:oc.b.FontName_New))),R.createElement(At.a,null,R.createElement(Yl.a,{id:"FontSizeLabel",type:"AppLabelProps",forId:"FontSize",label:ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.SizeLabel),styles:Zu.textControlLabelStyles(!0)}),R.createElement("div",{id:"FontSize"},this.renderControlFromCommandId(e,oc.b.FontSize)))),R.createElement(At.a,{horizontal:!0},R.createElement(At.a,{styles:Zu.fontEffectsStackStyles},R.createElement(Yl.a,{id:"FontEffectsLabel",type:"AppLabelProps",forId:"FontEffects",label:ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.EffectsLabel),styles:Zu.textControlLabelStyles(!1)}),R.createElement(At.a,{horizontal:!0,id:"FontEffects"},this.renderControlFromCommandId(e,oc.b.Bold),this.renderControlFromCommandId(e,oc.b.Italic),this.renderControlFromCommandId(e,oc.b.Underline),this.renderControlFromCommandId(e,oc.b.DoubleUnderline),this.renderControlFromCommandId(e,oc.b.Strikethrough))),R.createElement(At.a,null,R.createElement(Yl.a,{id:"FontColorLabel",type:"AppLabelProps",forId:"FontColor",label:ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.ColorLabel),styles:Zu.textControlLabelStyles(!1)}),R.createElement(At.a,{horizontal:!0,id:"FontColor"},this.renderControlFromCommandId(e,oc.b.FontColor))))),this.controlsToRender=[$u.a.isModernFontPickerEnabled()?oc.b.FontPicker:oc.b.FontName_New,oc.b.FontSize,oc.b.Bold,oc.b.Italic,oc.b.Underline,oc.b.DoubleUnderline,oc.b.Strikethrough,oc.b.FontColor]}}const ed={root:{marginTop:"10px",paddingLeft:"0px",paddingRight:"0px",paddingTop:"3px",paddingBottom:"5px",height:"16px"},label:{fontWeight:F.l.semibold,fontSize:"12px",fontStyle:"normal",lineHeight:"16px"}},td={mostOuterDivStyling:{marginLeft:"17px",marginRight:"15px",marginBottom:"10px"},borderGalleryStyles:{columns:6,defaultWidth:280,styles:{galleryButtonInExpanded:{root:{height:"28px",width:"28px",border:"4px solid transparent",backgroundColor:sc().iconButtonBackgroundRest,color:sc().iconButtonForegroundRest},rootDisabled:{backgroundColor:sc().iconButtonBackgroundDisabled,color:sc().iconButtonForegroundDisabled},rootChecked:{backgroundColor:sc().iconButtonBackgroundSelected,color:sc().iconButtonForegroundSelected},rootHovered:{backgroundColor:sc().iconButtonBackgroundHover,color:sc().iconButtonForegroundHover},rootPressed:{backgroundColor:sc().iconButtonBackgroundPressed,color:sc().iconButtonForegroundPressed},rootFocused:{backgroundColor:sc().iconButtonBackgroundFocus,color:sc().iconButtonForegroundFocus}},galleryStack:{root:{width:"280px"},inner:{gridRowGap:"10px",gridColumnGap:"20px"}}}},lineGalleryStyles:Object(Jo.c)(e=>({defaultWidth:276,columns:2,styles:{galleryButtonInExpanded:{root:{height:"30px",width:"130px",backgroundColor:sc().iconButtonBackgroundRest,color:sc().iconButtonForegroundRest},rootDisabled:{backgroundColor:sc().iconButtonBackgroundDisabled,color:sc().iconButtonForegroundDisabled},rootChecked:{backgroundColor:sc().iconButtonBackgroundSelected,color:sc().iconButtonForegroundSelected},rootHovered:{backgroundColor:sc().iconButtonBackgroundHover,color:sc().iconButtonForegroundHover},rootPressed:{backgroundColor:sc().iconButtonBackgroundPressed,color:sc().iconButtonForegroundPressed},rootFocused:{backgroundColor:sc().iconButtonBackgroundFocus,color:sc().iconButtonForegroundFocus}},galleryStack:{root:{backgroundColor:e.palette.white,border:"1px solid "+e.palette.neutralQuaternary,borderRadius:"2px"},inner:{gridRowGap:"2px",gridColumnGap:"12px"}}}})),textControlLabelStyles:ed,appButtonStyles:{styles:{root:{margin:"0px",paddingLeft:"4px",paddingRight:"4px",height:"26px",border:"unset",backgroundColor:sc().iconButtonBackgroundRest,color:sc().iconButtonForegroundRest,display:"flex",alignItems:"center",justifyContent:"center"},splitButtonMenuButton:{backgroundColor:"unset"},rootDisabled:{border:"unset",backgroundColor:sc().iconButtonBackgroundDisabled,color:sc().iconButtonForegroundDisabled},rootChecked:{backgroundColor:sc().iconButtonBackgroundSelected,color:sc().iconButtonForegroundSelected},rootHovered:{backgroundColor:sc().iconButtonBackgroundHover,color:sc().iconButtonForegroundHover},rootPressed:{backgroundColor:sc().iconButtonBackgroundPressed,color:sc().iconButtonForegroundPressed},rootFocused:{backgroundColor:sc().iconButtonBackgroundFocus,color:sc().iconButtonForegroundFocus},textContainer:{fontSize:F.k.size12,fontStyle:"normal",fontWeight:F.l.regular,lineheight:"16px",marginLeft:"8px",marginRight:"0px"},label:{margin:"0px"}}},splitButtonStyles:{styles:{root:{paddingLeft:"4px",paddingRight:"4px",height:"26px",border:"unset",backgroundColor:"unset",display:"flex",alignItems:"center"},rootDisabled:{border:"unset",backgroundColor:sc().iconButtonBackgroundDisabled,color:sc().iconButtonForegroundDisabled},rootHovered:{backgroundColor:sc().iconButtonBackgroundHover,color:sc().iconButtonForegroundHover},rootPressed:{backgroundColor:sc().iconButtonBackgroundPressed,color:sc().iconButtonForegroundPressed},rootFocused:{backgroundColor:sc().iconButtonBackgroundFocus,color:sc().iconButtonForegroundFocus},splitButtonDivider:{width:"0px"},splitButtonMenuButton:{backgroundColor:"unset",width:"12px",height:"24px",padding:"4px 2px",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",flexShrink:0,border:"none",outline:"none",selectors:{"span:first-child":{display:"flex",height:"16px"}}},textContainer:{fontSize:F.k.size12,fontStyle:"normal",fontWeight:F.l.regular,lineheight:"16px",marginLeft:"8px",marginRight:"8px"},label:{margin:"0px"},menuIcon:{margin:"0px",width:"8px",height:"8px",lineHeight:"8px"}}},borderOptionTableStyles:{width:"100%",borderCollapse:"collapse"}};class nd extends Yc{constructor(e){super(e),this.getOverridePropsForCommandId=(e,t)=>{switch(e){case oc.b.BorderMenuGallery:return td.borderGalleryStyles;case oc.b.BorderStyleGallery:return td.lineGalleryStyles(t);case oc.b.DrawBorder:case oc.b.DrawBorderGrid:case oc.b.EraseBorder:return td.appButtonStyles;case oc.b.BorderColor:return td.splitButtonStyles;default:return{}}},this.renderTab=e=>R.createElement(At.a,{style:td.mostOuterDivStyling},R.createElement(At.a,{horizontal:!0},this.renderControlFromCommandId(e,oc.b.BorderMenuGallery)),R.createElement(At.a,null,R.createElement(Yl.a,{id:"BorderOptionsLabel",type:"AppLabelProps",forId:"BorderOptions",label:ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.BorderOptionsLabel),styles:td.textControlLabelStyles}),R.createElement("div",{id:"BorderOptions","aria-labelledby":"BorderOptionsLabel"},R.createElement("table",{style:td.borderOptionTableStyles},R.createElement("tr",null,R.createElement("td",null,this.renderControlFromCommandId(e,oc.b.DrawBorder)),R.createElement("td",null,this.renderControlFromCommandId(e,oc.b.DrawBorderGrid))),R.createElement("tr",null,R.createElement("td",null,this.renderControlFromCommandId(e,oc.b.EraseBorder)),R.createElement("td",null,this.renderControlFromCommandId(e,oc.b.BorderColor))))),R.createElement(Yl.a,{id:"BorderLineStylesLabel",type:"AppLabelProps",forId:"BorderLineStyles",label:ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.BorderLineStyleLabel),styles:td.textControlLabelStyles}),R.createElement("div",{id:"BorderLineStyles","aria-labelledby":"BorderLineStylesLabel"},this.renderControlFromCommandId(e,oc.b.BorderStyleGallery)))),this.controlsToRender=[oc.b.BorderMenuGallery,oc.b.DrawBorder,oc.b.DrawBorderGrid,oc.b.EraseBorder,oc.b.BorderColor,oc.b.BorderStyleGallery]}}const od={pivotStyles:{root:{marginLeft:"11px",height:"24px",marginBottom:"19px"},link:{height:"24px",marginRight:"0px",paddingLeft:"6px",paddingRight:"6px",marginTop:"1px"}},pivotDivStyles:{overflowY:"auto",overflowX:"hidden"},rootDivStyles:{display:"flex",flexDirection:"column",overflow:"hidden",height:"100%"}};class rd extends R.Component{render(){return R.createElement(Jl.Consumer,null,e=>R.createElement("div",{style:od.rootDivStyles},R.createElement("div",{style:od.pivotDivStyles},R.createElement(Zs.a,{componentRef:this.pivotRef,styles:od.pivotStyles,selectedKey:this.props.activePage.toString(),onLinkClick:t=>{var n;e.callbacks.onItemClick(parseInt(t.props.itemKey,10)),null===(n=this.pivotRef.current)||void 0===n||n.focus()}},this.getItemViewPivotItem(Gl.NumberFormatItemView,ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.NumberTabLabel),()=>R.createElement(Ku,null)),this.getItemViewPivotItem(Gl.AlignmentItemView,ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.AlignmentTabLabel),()=>R.createElement(au,{taskPaneId:"FormatCellsTaskPane"})),this.getItemViewPivotItem(Gl.FontItemView,ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.FontTabLabel),()=>R.createElement(Xu,{taskPaneId:"FormatCellsTaskPane"})),this.getItemViewPivotItem(Gl.BorderItemView,ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.BorderTabLabel),()=>R.createElement(nd,{taskPaneId:"FormatCellsTaskPane"})))),R.createElement("div",{style:{flexGrow:1}}),R.createElement(rc,{giveFeedBackButtonText:ExcelFormatcellsTaskpaneStringsManager.get(ExcelFormatcellsTaskpaneStringsEnum.FeedbackText),onButtonClick:e.callbacks.onFeedbackButtonClick})))}constructor(e){super(e),this.pivotRef=R.createRef(),this.getItemViewPivotItem=(e,t,n)=>Xl(e)?R.createElement($s.a,{headerText:t,itemKey:e.toString()},this.props.isFloatingObjectSelected?R.createElement($l,null):n()):R.createElement(R.Fragment,null),this.state={}}}class id extends R.Component{componentDidUpdate(e){Object(x.isChangeGateEnabled)("OfficeVSO:8616450_FixInvisibleTabStop")&&e.activePage!==this.props.activePage&&this.focus()}render(){var e,t;return R.createElement(Jl.Provider,{value:{callbacks:null!==(e=this.props.callbacks)&&void 0!==e?e:void 0,viewModelData:null!==(t=this.props.viewModelData)&&void 0!==t?t:void 0}},R.createElement("div",{ref:this.formatCellsPane,style:{height:"inherit"}},this.getTaskPaneContent()))}getTaskPaneContent(){switch(this.props.activePage){case Gl.FormatCellsListView:return R.createElement(ec,{isFloatingObjectSelected:this.props.isFloatingObjectSelected});case Gl.NumberFormatItemView:case Gl.AlignmentItemView:case Gl.FontItemView:case Gl.BorderItemView:return R.createElement(rd,{activePage:this.props.activePage,isFloatingObjectSelected:this.props.isFloatingObjectSelected});default:return R.createElement(R.Fragment,null)}}queryAndFocusOnElement(e){if(!this.formatCellsPane.current)return void i.a.shipAssertTag(507605603,a.a.msoulscat_ES_EWAJS,!1,"FormatCellsTaskPane::queryAndFocusOnElement: formatCellsPane is undefined.");const t=this.formatCellsPane.current.querySelector(e);t&&t.focus()}constructor(e){super(e),this.formatCellsPane=R.createRef(),this.focus=()=>{if(Object(x.isChangeGateEnabled)("OfficeVSO:8616450_FixInvisibleTabStop"))this.props.activePage===Gl.FormatCellsListView?this.queryAndFocusOnElement('div[role="group"][tabindex]:not([tabindex="-1"])'):this.queryAndFocusOnElement('button[role="tab"].is-selected');else{const e=this.formatCellsPane.current.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"]), div[data-is-focusable="true"]');e&&e[1]&&(e[1].classList.contains("is-selected")?e[1].focus():e[0].focus())}},this.state={}}}const ad=()=>({root:{height:"26px",width:"84px",lineHeight:"20px",fontWeight:F.l.semibold,borderRadius:"2px",fontSize:"12px"}}),sd=Object(Jo.c)(e=>Object(F.I)(ad,{root:{height:"26px",fontSize:"12px",backgroundColor:e.palette.themePrimary,color:e.palette.white,marginRight:"8px",fontWeight:F.l.semibold},rootHovered:{backgroundColor:e.palette.themeDarkAlt,color:e.palette.white},rootPressed:{backgroundColor:e.palette.themeDark,color:e.palette.white}})),ld=e=>R.createElement("div",null,R.createElement("div",{style:{display:"flex",padding:"8px"}},R.createElement(fe.a,{styles:{root:{height:"20px",width:"20px",minWidth:"20px",marginRight:"8px"}},iconName:e.iconName,ariaLabel:""}),R.createElement("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between"}},R.createElement("span",{style:{fontWeight:"600",fontSize:"14px",lineHeight:"20px",paddingBottom:"4px"}},e.itemName),R.createElement("span",{style:{fontWeight:"400",fontSize:"12px",lineHeight:"16px",paddingBottom:"4px"}},e.itemDescription))));var cd=n(13),ud=n.n(cd);class dd extends R.PureComponent{render(){return R.createElement(we.a,null,e=>R.createElement("div",{ref:this.loadBlockPane,className:Object(F.eb)({height:"100%",overflowX:"hidden",overflowY:"auto"})},R.createElement("div",{className:Object(F.eb)({height:"100%",display:"flex",flexDirection:"column"})},R.createElement("div",{className:Object(F.eb)({marginLeft:"16px",marginRight:"16px",fontStyle:"normal",fontSize:"12px",lineHeight:"16px",display:"flex",flexDirection:"column",wordSpacing:"1px"})},this.getSubHeader(),this.props.loadBlockingFloatingObjectsTaskPaneBody,this.getInvalidFloatingObjectItems(),this.getDirective(),this.getActionButtons(e)),R.createElement("div",{style:{flexGrow:1}}),R.createElement(rc,null))))}constructor(e){super(e),this.loadBlockPane=R.createRef(),this.focus=()=>{const e=this.loadBlockPane.current;Object(Il.c)(e)},this.getSubHeader=()=>R.createElement("div",{className:Object(F.eb)({fontWeight:"600",fontSize:"14px",lineHeight:"20px",paddingBottom:"8px"})},this.props.loadBlockingFloatingObjectsTaskPaneSubHeader),this.getInvalidFloatingObjectItems=()=>R.createElement("div",{style:{padding:"16px 0px 16px 0px"}},this.props.containsEmptyTextBox&&R.createElement(ld,{itemName:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.LoadBlockEmptyTextboxes),itemDescription:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.LoadBlockEmptyTextboxesDescription),iconName:ud.a.Textbox_32}),this.props.containsInvalidImage&&R.createElement(ld,{itemName:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.LoadBlockInvalidImages),itemDescription:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.LoadBlockInvalidImagesDescription),iconName:ud.a.AutoShapes_32}),this.props.containsInvalidShape&&R.createElement(ld,{itemName:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.LoadBlockInvalidShapes),itemDescription:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.LoadBlockInvalidShapesDescription),iconName:ud.a.InsertPictureSimple_32})),this.getDirective=()=>R.createElement("div",{className:Object(F.eb)({display:"flex",paddingTop:"12px 0 12px 0"})},R.createElement(fe.a,{styles:{root:{height:"16px",width:"16px",minWidth:"16px",marginRight:"12px"}},iconName:c.a.Info_32,ariaLabel:""}),ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.LoadBlockingFloatingObjectsDirective)),this.getActionButtons=e=>R.createElement("div",{className:Object(F.eb)({alignSelf:"flex-end",paddingTop:"36px"})},R.createElement(Ko.a,{id:"LoadBlockRemoveButtonId",type:"AppButtonProps",label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.LoadBlockingFloatingObjectsRemoveButtonText),onExecute:()=>Object(nc.b)(oc.b.CleanLoadBlockingFloatingObjects,{modelType:"ButtonModel",payload:{type:"ButtonPayload"}}),styles:sd(e)}),this.props.isSoftBlocked&&R.createElement(Ko.a,{id:"LoadBlockSkipButtonId",type:"AppButtonProps",customTooltip:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.LoadBlockingFloatingObjectsSkipTooltipText),label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.LoadBlockingFloatingObjectsSkipButtonText),icon:be.a.AlertWarning_16,onExecute:()=>{this.props.allowEditingSoftBlockedFiles(!0),Object(nc.b)(oc.b.ModeSwitcherModeEditing,{modelType:"ButtonModel",payload:{type:"ButtonPayload"}})},styles:ad()}))}}var pd,gd,hd,md,bd,fd,xd,Ed=n(301),Sd=n(2162),yd=n(2150),Cd=n(720);!function(e){e[e.NameManagerListView=0]="NameManagerListView",e[e.NameManagerItemView=1]="NameManagerItemView",e[e.NameManagerMultiSelectView=2]="NameManagerMultiSelectView",e[e.NameManagerClosedView=3]="NameManagerClosedView",e[e.NameManagerErrorView=4]="NameManagerErrorView"}(pd||(pd={})),function(e){e[e.Workbook=0]="Workbook",e[e.Sheet=1]="Sheet"}(gd||(gd={})),function(e){e[e.NameInput=0]="NameInput",e[e.ReferenceInput=1]="ReferenceInput",e[e.CommentInput=2]="CommentInput"}(hd||(hd={})),function(e){e[e.NamedRange=0]="NamedRange",e[e.Table=1]="Table",e[e.NamedFormula=2]="NamedFormula",e[e.NamedConstant=3]="NamedConstant",e[e.Lambda=4]="Lambda",e[e.TableSlicer=5]="TableSlicer",e[e.PrintArea=6]="PrintArea",e[e.Others=7]="Others"}(md||(md={})),function(e){e[e.ASC=0]="ASC",e[e.DESC=1]="DESC"}(bd||(bd={})),function(e){e[e.Default=0]="Default",e[e.Name=1]="Name",e[e.Scope=2]="Scope"}(fd||(fd={})),function(e){e[e.Workbook=0]="Workbook",e[e.Worksheets=1]="Worksheets",e[e.withErrors=2]="withErrors",e[e.withoutErrors=3]="withoutErrors",e[e.DefinedNames=4]="DefinedNames",e[e.TableNames=5]="TableNames"}(xd||(xd={}));var vd=n(403),Rd=n(336),kd=n(401);const Td={[F.m]:{background:"Highlight !important",color:"HighlightText !important",fill:"HighlightText !important",forcedColorAdjust:"none"}},_d=Object(Jo.c)((e,t,n,o,r,i)=>({cardStyle:{padding:"12px",borderRadius:"4px",backgroundColor:r.palette.white,border:e?`2px solid ${r.palette.themePrimary} !important`:`1px solid ${r.palette.white} !important`,boxShadow:r.effects.elevation4,selectors:_object_spread_props(_object_spread({},!i&&{":hover":{boxShadow:r.effects.elevation8}}),{":hover::after":{border:"none",boxShadow:"none"}}),marginTop:"8px",marginBottom:"8px",cursor:!n&&o===md.Others||i?"default !important":"pointer"},icon:{maxHeight:"100%"},mainText:{fontWeight:"600",color:i?r.palette.neutralSecondaryAlt:r.palette.neutralDark,display:"flex",alignItems:"center",gap:"8px",maxWidth:n?"200px":t?"150px":"230px",".nameManager-scope-text":{padding:"0 2px",borderRadius:"2px",backgroundColor:i?r.palette.neutralLighter:r.palette.neutralLight,color:i?r.palette.neutralSecondaryAlt:r.palette.neutralPrimaryAlt,fontSize:"10px",lineHeight:"12px",fontWeight:400}},subText:{fontSize:"12px",lineHeight:"16px",color:i?r.palette.neutralSecondaryAlt:r.palette.neutralSecondary,display:"flex",maxWidth:n?"200px":t?"150px":"230px",".nameManager-invalid-reference-text":{backgroundColor:r.semanticColors.warningBackground,padding:"0 2px",borderRadius:"2px",color:"#484644",display:"flex",alignItems:"center",gap:"4px"},".nameManager-reference-text":{fontSize:"12px",lineHeight:"16px",display:"flex",maxWidth:n?"200px":t?"150px":"230px"},".nameManager-reference-range":{padding:"0px 2px",borderRadius:"2px",margin:"0px 4px",fontWeight:600,fontSize:"12px",lineHeight:"16px",backgroundColor:r.palette.neutralLighter,color:i?r.palette.neutralSecondaryAlt:r.palette.neutralDark,alignSelf:"center"}},actionIconContainer:{display:t?"flex":"none"},commentMinimized:{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",display:"block"},commentPadding:{padding:"0px 0px 0px 28px",maxWidth:n?"200px":"230px",wordBreak:"break-word"},iconButtonStyles:{root:{padding:"0 4px",width:"32px",height:"32px",backgroundColor:"transparent",border:"none",borderRadius:"2px",cursor:"pointer"},rootHovered:{color:r.palette.themeDarkAlt,backgroundColor:r.palette.neutralLighter,selectors:Td},flexContainer:{display:"flex",justifyContent:"center",alignItems:"center"},rootPressed:{color:r.palette.themeDark,backgroundColor:r.palette.neutralLight,selectors:Td},rootFocused:{selectors:Td},rootExpanded:{color:r.palette.themeDark,backgroundColor:r.palette.neutralLight,selectors:Td},rootChecked:{color:r.palette.themeDark,backgroundColor:r.palette.neutralLight},rootCheckedHovered:{color:r.palette.themeDark,backgroundColor:r.palette.neutralQuaternaryAlt}},namedObjectIcon:{root:_object_spread(_object_spread_props(_object_spread({},Object(kd.d)(r)),{padding:"0"}),i&&{opacity:.75})},invalidReferenceIcon:{root:{width:"12px",height:"12px"}},moreOptionsContextualMenu:{container:{width:"120px"},root:{".ms-ContextualMenu-link":{selectors:{":hover":Td,":focus":Td}}}},moreOptionsButtonIcon:{root:{width:"16px",height:"16px"}},clippingStyle:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},appIconButtonStyles:{root:{width:"16px",height:"16px"}}}));class wd extends R.PureComponent{getReferenceText(e,t,n,o,r,i){if(!n||!o||!r)return R.createElement("span",{className:Object(F.eb)(i.clippingStyle)},t);const a=`${o}:${r}`;return e===md.NamedRange||e===md.Table||e===md.PrintArea?R.createElement("div",{className:"nameManager-reference-text","aria-label":`${n} ${a}`},R.createElement("span",{className:Object(F.eb)(i.clippingStyle)},n),R.createElement("span",{className:Object(F.eb)("nameManager-reference-range",i.clippingStyle)},a)):R.createElement("span",{className:Object(F.eb)(i.clippingStyle)},t)}getAriaLabel(){const{name:e,type:t,referenceSheetName:n,topLeft:o,bottomRight:r,comment:i,isInvalidReference:a,reference:s}=this.props,l=`${o}:${r}`,c=!n||!o||!r,u=a?ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerInvalidReference)+"\n":"";let d=s;return!c&&[md.NamedRange,md.Table,md.PrintArea].includes(t)&&(d=`${n} ${l}`),`${e}\n${u}${d}${i?"\n"+i:""}`}render(){return R.createElement(we.a,null,e=>{const t=_d(this.props.selected,this.state.isActive,this.props.isInMultiSelectMode,this.props.type,e,this.props.disabled);return R.createElement("div",_object_spread({className:Object(F.eb)(t.cardStyle),key:this.props.runtimeUid,id:"name-manager-item-card-"+this.props.selectionIndex,onMouseEnter:()=>{this.setState({isActive:!0})},onMouseLeave:()=>{var e;this.setState({isActive:!1}),null===(e=this.moreMenuButtonRef.current)||void 0===e||e.dismissMenu()},onFocus:()=>{this.setState({isActive:!0})},onBlur:e=>{const{relatedTarget:t}=e;var n;!t||t.classList.contains("ms-ContextualMenu-link")||t.classList.contains("ms-ContextualMenu-container")||(this.setState({isActive:!1}),null===(n=this.moreMenuButtonRef.current)||void 0===n||n.dismissMenu())},"data-is-focusable":!0,role:this.props.isInMultiSelectMode?"checkbox":"group","aria-checked":this.props.selected,onClick:this.cardItemClick,tabIndex:this.props.selected||0===this.props.selectionIndex&&!this.props.isInMultiSelectMode?0:-1,"aria-disabled":this.props.disabled,"data-selection-index":this.props.selectionIndex,"data-testid":"name-manager-item-card"},!this.props.isInMultiSelectMode&&{"aria-label":Object(x.isChangeGateEnabled)("OfficeVSO:8720747_NameManagerMoreOptionAccessibilityString")?`${this.getAriaLabel()}, ${ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerMoreOptionsAccessibility)}`:this.getAriaLabel(),title:this.getAriaLabel()}),R.createElement(At.a,null,R.createElement(At.a,{horizontal:!0,horizontalAlign:"space-between"},R.createElement(At.a,{horizontal:!0,tokens:{childrenGap:8}},R.createElement(fe.a,_object_spread_props(_object_spread({},Object(mi.a)(this.iconMap(this.props.type))),{styles:t.namedObjectIcon})),R.createElement(At.a,null,R.createElement(At.a.Item,{className:Object(F.eb)(t.mainText)},R.createElement("span",{className:Object(F.eb)(t.clippingStyle)},this.props.name),1===this.props.scope&&R.createElement("span",{className:Object(F.eb)("nameManager-scope-text",t.clippingStyle)},this.props.referenceSheetName)),R.createElement(At.a.Item,{className:Object(F.eb)(t.subText)},this.props.isInvalidReference?R.createElement("div",{className:"nameManager-invalid-reference-text"},R.createElement("span",null,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerInvalidReference)),R.createElement(fe.a,_object_spread_props(_object_spread({},Object(mi.a)(be.a.AlertWarning_20)),{styles:t.invalidReferenceIcon}))):this.getReferenceText(this.props.type,this.props.reference,this.props.referenceSheetName,this.props.topLeft,this.props.bottomRight,t)))),!this.props.isInMultiSelectMode&&R.createElement(At.a,{horizontal:!0,tokens:{childrenGap:4},className:Object(F.eb)(t.actionIconContainer)},R.createElement(vd.a,{iconProps:{iconName:be.a.EditGeneric_24,styles:t.appIconButtonStyles},title:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerEditButtonLabel),ariaLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerEditButtonLabel),onClick:()=>{this.props.onEditIconClick(this.props),i.a.sendTraceTag(507581339,a.a.msoulscat_ES_EWAJS,s.a.Info,"onEditIconClick")},styles:t.iconButtonStyles}),this.props.type!==md.Table&&R.createElement(Rd.a,{styles:t.iconButtonStyles,onRenderText:()=>R.createElement(R.Fragment,null),onRenderDescription:()=>R.createElement(R.Fragment,null),ref:this.moreMenuButtonRef,menuProps:{items:[{key:"Select",text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerSelectButtonLabel),iconProps:{iconName:be.a.MultiSelect_16},onClick:this.props.onMultiSelectClick},{key:"Delete",text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerDeleteButtonLabel),iconProps:{iconName:be.a.TrashCan_16},onClick:this.deleteButtonClick}],directionalHint:Se.a.bottomRightEdge,styles:t.moreOptionsContextualMenu},onRenderMenuIcon:()=>R.createElement(R.Fragment,null),iconProps:{iconName:be.a.ellipsis_16,styles:t.moreOptionsButtonIcon},title:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerMoreOptionsButtonLabel),ariaLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerMoreOptionsButtonLabel)}))),this.props.comment&&R.createElement("div",{className:Object(F.eb)(t.subText,t.commentPadding,this.props.selected?{}:t.commentMinimized)},this.props.comment)))})}constructor(e){super(e),this.moreMenuButtonRef=R.createRef(),this.cardItemClick=()=>{this.props.isInMultiSelectMode||this.props.onItemClick&&this.props.onItemClick(this.props.runtimeUid)},this.deleteButtonClick=()=>{this.props.onItemsDelete&&this.props.onItemsDelete([this.props.runtimeUid])},this.iconMap=Object(Jo.c)(e=>{switch(e){case md.NamedRange:return d.a.SelectRange_20;case md.Lambda:case md.NamedFormula:return c.a.Function_16;case md.Table:case md.TableSlicer:return d.a.Table_20;case md.PrintArea:return d.a.FlyoutAnchorPrintArea_20;case md.NamedConstant:return be.a.DataTypeText_20;case md.Others:return be.a.CreateName_20;default:return d.a.SelectRange_20}}),this.state={isActive:!1}}}const Dd=Object(Jo.c)(e=>({boldText:{fontWeight:"600"},checkboxStyle:t=>({checkbox:{background:t.checked?e.palette.themePrimary:e.palette.white}}),appIconButtonStyles:{root:{width:"16px",height:"16px"}},newButtonStyles:Pd,filterDropDownStyle:Id(e),multiDeleteStyles:{icon:{height:20,fontSize:20,lineHeight:20},root:{selectors:{":hover, :focus":{[F.m]:{background:"Highlight",color:"HighlightText",fill:"HighlightText"}}}}}})),Pd={root:{height:"26px",width:"73px",selectors:{[F.m]:{fill:"ButtonText"}}},rootHovered:{[F.m]:{background:"Highlight !important",color:"HighlightText !important",fill:"HighlightText !important",forcedColorAdjust:"none"}}},Id=Object(Jo.c)(e=>({root:{height:"24px",width:"34px",background:e.palette.neutralLighter,padding:"0px 2px 0px 0px",minWidth:"fit-content",borderStyle:"none",verticalAlign:"top",marginTop:"-2px",marginRight:"1px",selectors:{":focus::after":{outline:"unset !important"},[F.n]:{selectors:{"svg > path.OfficeIconColors_HighContrast":{fill:"ButtonText !important"}}},[F.o]:{selectors:{"svg > path.OfficeIconColors_HighContrast":{fill:"ButtonText !important"}}}}},rootFocused:{backgroundColor:"unset",outline:"1px solid "+e.palette.black},rootHovered:{backgroundColor:e.palette.neutralLight,selectors:{[F.m]:{backgroundColor:"ButtonFace",color:"ButtonText"}}},rootExpanded:{background:e.palette.neutralLight},rootExpandedHovered:{background:e.palette.neutralLighter},rootPressed:{backgroundColor:e.palette.neutralQuaternary},menuIcon:{fontSize:"8px",margin:"0px",height:"8px",width:"8px",lineHeight:"12px"},icon:{width:"16px",height:"16px",margin:"0px 2px"},flexContainer:{paddingLeft:"2px",width:"34px"}})),Fd={root:{marginTop:"0px",selectors:{".ms-ChoiceFieldLabel":{fontSize:"12px",lineHeight:"16px"},".ms-ChoiceField-field::before":{transform:"scale(0.8)"},".ms-ChoiceField-field::after":{transform:"scale(0.8)"}}},choiceFieldWrapper:{width:"100%",padding:"4px 6px"}},Bd=e=>{var t;const{subMenuRef:n,sortOrder:o,onSortOrderChange:r}=e;return R.createElement("div",{onMouseOver:null===(t=n.current)||void 0===t?void 0:t.dismissSubMenu},R.createElement(jl.a,{options:[{key:"ASC",text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerFilterSortAZ),styles:Fd},{key:"DESC",text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerFilterSortZA),styles:Fd}],"aria-label":ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerSortLabel),selectedKey:0===o?"ASC":1===o?"DESC":void 0,onChange:e=>{r("ASC"===e.key?0:1)},type:"AppChoiceGroupProps",label:"",id:"NameManagerSortOrderChoiceGroup"}))},Md=Object(ut.a)({root:_object_spread({display:"flex",flexDirection:"row",flexWrap:"nowrap",width:"auto",height:"auto",boxSizing:"border-box",alignItems:"center"},pt.a.gap("4px")),item:{height:"auto",width:"auto",flexShrink:1},appliedFilterTextStyles:{fontSize:"14px",fontWeight:"600"}}),jd=Object(Jo.c)(e=>({dropdownStyles:{header:{height:"28px",selectors:{i:{display:"none"}}},root:{overflow:"hidden",selectors:{".ms-ContextualMenu-link":{height:"28px",fontSize:"12px"},".no-checkmark .ms-ContextualMenu-checkmarkIcon":{display:"none"},".with-checkmark .ms-ContextualMenu-icon":{display:"none"}}}},subMenuStyles:{root:{overflow:"hidden",selectors:{".ms-ContextualMenu-link":{height:"28px",fontSize:"12px"}}}},buttonStyles:{root:{padding:"4px",height:"inherit"},rootHovered:{[F.m]:{background:"Highlight !important",color:"HighlightText !important",fill:"HighlightText !important",forcedColorAdjust:"none"}},rootExpanded:{[F.m]:{background:"Highlight !important",color:"HighlightText !important",fill:"HighlightText !important",forcedColorAdjust:"none"}},menuIcon:{color:e.palette.neutralPrimary,fontSize:"8px",margin:"0px",height:"8px",width:"8px",flexShrink:0,lineHeight:"12px",textAlign:"center"},menuIconHovered:{[F.m]:{background:"Highlight !important",color:"HighlightText !important",fill:"HighlightText !important",forcedColorAdjust:"none"}},menuIconExpanded:{[F.m]:{background:"Highlight !important",color:"HighlightText !important",fill:"HighlightText !important",forcedColorAdjust:"none"}}},applyButtonStyles:{root:{margin:"4px 8px 8px 8px",fontSize:"12px",padding:"5px 20px"}},appIconButtonStyles:{root:{width:"16px",height:"16px"}}})),Od=[{key:"default",text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerFilterSortOrderDefault),sortByType:0},{key:"name",text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerFilterSortOrderName),sortByType:1},{key:"scope",text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerFilterSortOrderScope),sortByType:2}],Ld=[{key:"workbook",text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerFilterWorkbook),filterType:0},{key:"worksheets",text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerFilterWorksheets),filterType:1},{key:"withErrors",text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerFilterWithErrors),filterType:2},{key:"withoutErrors",text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerFilterWithoutErrors),filterType:3},{key:"DefinedNames",text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerFilterDefinedNames),filterType:4},{key:"TableNames",text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerFilterTableNames),filterType:5}],Ad=({sortBy:e,sortOrder:t,filterBy:n,onApplyFilter:o,filterCountMap:r})=>{const i=Md(),a=R.useRef(null);return R.createElement(we.a,null,s=>{var l,c;const u=jd(s);return R.createElement("div",{className:i.root},R.createElement("div",{className:i.item},R.createElement(is.a,{id:"name-manager-filter",iconProps:{iconName:hr.a.Filter_20,styles:u.appIconButtonStyles},"aria-label":ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerFilterLabel),styles:u.buttonStyles,menuProps:{doNotLayer:!1,subMenuHoverDelay:250,calloutProps:{calloutWidth:180},styles:u.dropdownStyles,items:[{key:"SortSection",itemType:Go.a.Section,sectionProps:{topDivider:!1,bottomDivider:!0,items:[{key:"SortDirectionPicker",onRender:(r,i)=>R.createElement(Bd,{subMenuRef:a,sortOrder:t,onSortOrderChange:t=>{o({sortBy:e,sortOrder:t,filterBy:n}),i()}})},{key:"SortByPicker",text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerFilterSortBy),className:"no-checkmark",componentRef:a,subMenuProps:{calloutProps:{calloutWidth:120,calloutMaxWidth:120},styles:u.subMenuStyles,items:Od.map(r=>({key:r.key,text:r.text,canCheck:!0,checked:e===r.sortByType,onClick:()=>{o({sortBy:r.sortByType,sortOrder:t,filterBy:n})}}))}}]}},{key:"ClearFilters",text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerFilterClearFilters),className:"no-checkmark",iconProps:{iconName:hr.a.DeleteFilter_20},style:{margin:"2px 0px"},onClick:()=>{o({sortBy:0,sortOrder:0,filterBy:void 0})}},{key:"FilterSection",itemType:Go.a.Section,sectionProps:{topDivider:!0,bottomDivider:!1,title:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerFilterFilterByHeaderLabel),items:Ld.map(i=>({key:i.key,text:i.text,canCheck:!0,checked:n===i.filterType,className:"with-checkmark",secondaryText:null==r?void 0:r[i.filterType].toString(),onClick:()=>{o({sortBy:e,sortOrder:t,filterBy:i.filterType})}}))}}]}})),R.createElement("div",{className:Object(Rt.a)(i.item,i.appliedFilterTextStyles)},null!==(l=null===(c=Ld.find(e=>e.filterType===n))||void 0===c?void 0:c.text)&&void 0!==l?l:""))})};class Nd extends R.PureComponent{render(){return R.createElement(we.a,null,e=>{const t=Dd(e);return this.props.showMultiSelectCommandBar?this.showMultiSelectManagerBar(t):this.showCreateManagerBar(t)})}constructor(e){super(e),this.showMultiSelectManagerBar=e=>R.createElement(At.a,{horizontal:!0,horizontalAlign:"space-between",verticalAlign:"center",tokens:{padding:"6px 12px"}},R.createElement(At.a.Item,null,R.createElement(yo.a,{checked:this.props.isAllSelected,styles:e.checkboxStyle,onChange:this.props.onToggle,label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerSelectAllLabel)})),R.createElement(At.a.Item,{align:"end"},R.createElement(vd.a,{iconProps:{iconName:be.a.OLDeleteHover_20},title:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerDeleteButtonLabel),ariaLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerDeleteButtonLabel),disabled:!this.props.shouldEnableDelete,onClick:()=>{this.props.onMultiDelete()},styles:e.multiDeleteStyles}))),this.showCreateManagerBar=e=>R.createElement(At.a,{horizontal:!0,horizontalAlign:"space-between",verticalAlign:"center",tokens:{padding:"6px 12px"}},R.createElement(At.a.Item,null,Object($c.h)("Microsoft.Office.Excel.XLONameManagerFastFollow",!1)&&R.createElement(Ad,{sortBy:this.props.sortBy,sortOrder:this.props.sortOrder,filterBy:this.props.filterBy,onApplyFilter:this.props.onApplyFilter,filterCountMap:this.props.filterCountMap})),R.createElement(At.a.Item,{align:"end"},R.createElement(pr.a,{id:"nameManagerCreate","aria-label":ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerNewLabel),iconProps:{iconName:be.a.ListAddNewColumnGlyph_16,styles:e.appIconButtonStyles},text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerNewLabel),styles:e.newButtonStyles,onClick:this.props.createDefinedName})))}}var Wd=n(579);const zd=Object(Jo.c)(e=>({wrapperStackStyles:{root:{alignItems:"center",justifyContent:"center",height:"inherit",margin:"0 16px"}},headerTextStyle:{root:{fontSize:14,fontWeight:600,lineHeight:20}},descriptionTextWrapperStyle:{root:{textAlign:"center"}},descriptionTextStyle:{root:{fontSize:12,lineHeight:16}},actionButtonStyle:{root:{color:e.palette.themePrimary,fontSize:12,lineHeight:16,height:30}},createButtonWrapperStyle:{root:{marginTop:"16px"}},illustrationStackStyles:{root:{height:"192px"}}})),Hd=e=>{const{headerText:t,descriptionText:n,actionButtonText:o,primaryButtonText:r,iconName:i,onActionButtonClick:a,onPrimaryButtonClick:s}=e;return R.createElement(we.a,null,e=>{const l=zd(e);return R.createElement(At.a,{styles:l.wrapperStackStyles},R.createElement(At.a.Item,null,R.createElement(rs.a,{styles:l.headerTextStyle},t)),R.createElement(At.a.Item,{styles:l.illustrationStackStyles},R.createElement(tn.a,{iconName:i,width:192,height:192})),n&&R.createElement(At.a.Item,{styles:l.descriptionTextWrapperStyle},R.createElement(rs.a,{styles:l.descriptionTextStyle},n)),o&&R.createElement(At.a.Item,null,R.createElement(Ue.a,{styles:l.actionButtonStyle,text:o,onClick:a})),r&&R.createElement(At.a.Item,{styles:l.createButtonWrapperStyle},R.createElement(Wd.a,{text:r,onClick:s,id:"IllustratedInfoPrimaryButton"})))})},Vd=Object(Jo.c)(e=>({listContainerStyle:{margin:"0px 12px"},checkboxStyle:t=>({checkbox:{background:t.checked?e.palette.themePrimary:e.palette.white}}),selectionZoneStyle:{overflow:"auto",height:"100%"},focusZoneStyle:{height:"100%"},rootStackStyle:{root:{height:"100%"}},listWrapperStackStyle:{root:{flexGrow:1,overflow:"hidden"}}}));var Ud=n(2521);const Gd=Object(Jo.c)(e=>({searchBoxStyles:{clearButton:{".ms-Button":{borderRadius:"0 3px 3px 0"}},root:{margin:"6px 12px",borderRadius:"4px",border:"1px solid "+e.palette.neutralTertiaryAlt,borderBottom:"1px solid "+e.palette.neutralSecondary,selectors:{"::after":{border:"none"},":hover":{border:"1px solid "+e.palette.neutralTertiaryAlt,borderBottom:"1px solid "+e.palette.neutralSecondary},"&.is-active::after":{borderBottom:"2px solid "+e.palette.themePrimary,position:"absolute",bottom:"-1px",borderRadius:"4px",clipPath:"inset(94% 0px 0px 0px)"},"&.is-active":{border:"1px solid "+e.palette.neutralTertiaryAlt}}}}})),qd=({searchText:e,onSearchTextChange:t,isDisabled:n=!1})=>{const o=R.useCallback((e,n)=>{t(n||"")},[t]);return R.createElement(we.a,null,t=>{const r=Gd(t);return R.createElement(Ud.a,{type:"AppSearchBoxProps",id:"NameManagerSearchBox",showIcon:!0,styles:r.searchBoxStyles,placeholder:n?"":ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerSearchBoxPlaceholder),icon:c.a.Search_20,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,value:e,onChange:o,disabled:n})})};var Qd=n(173);class Kd extends R.Component{isQueryActive(){return""!==this.state.searchText||void 0!==this.state.filterBy}shouldComponentUpdate(e,t){return e.isMultiSelectView!==this.props.isMultiSelectView||t.searchText!==this.state.searchText||e.items!==this.props.items||t.isAllSelected!==this.state.isAllSelected||t.shouldEnableDelete!==this.state.shouldEnableDelete}componentDidUpdate(e){var t;e.isMultiSelectView!==this.props.isMultiSelectView&&(this.props.isMultiSelectView||this.state.selection.setAllSelected(!1),null===(t=this.listReference.current)||void 0===t||t.forceUpdate()),e.items===this.props.items&&e.isMultiSelectView===this.props.isMultiSelectView||this.state.selection.setItems(this.props.items,!1)}render(){const e=0===this.props.items.length?ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerNoSearchResults):1===this.props.items.length?ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerSingleSearchResult):ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerSearchResults).replace("{0}",this.props.items.length.toString());return R.createElement(we.a,null,t=>{const n=Vd(t);return R.createElement(At.a,{styles:n.rootStackStyle},R.createElement(At.a.Item,null,R.createElement(Nd,{onMultiDelete:this.onMultiDeleteClick,onToggle:this.onToggleClick,showMultiSelectCommandBar:this.props.isMultiSelectView,createDefinedName:this.createDefinedName,isAllSelected:this.state.isAllSelected,shouldEnableDelete:this.state.shouldEnableDelete,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,filterBy:this.state.filterBy,onApplyFilter:this.onFiltersChange,filterCountMap:this.props.filterCountMap}),!this.props.isMultiSelectView&&R.createElement(R.Fragment,null,R.createElement(qd,{searchText:this.state.searchText,onSearchTextChange:this.onSearchTextChange}),(this.state.searchText||void 0!==this.state.filterBy)&&Object(Qd.isChangeGateEnabled)("OfficeVSO:8762479_NameManagerSearchResultsAnnouncement")&&R.createElement(Sd.a,{message:e,"aria-live":"polite"}))),R.createElement(At.a.Item,{styles:n.listWrapperStackStyle},R.createElement(yd.a,{selection:this.state.selection,selectionMode:this.props.isMultiSelectView?_u.d.multiple:_u.d.single,className:Object(F.eb)(n.selectionZoneStyle)},R.createElement(Cd.a,{direction:qo.a.bidirectional,className:Object(F.eb)(n.focusZoneStyle)},0===this.props.items.length?R.createElement(Hd,{headerText:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerNoSearchResults),iconName:en.a.SearchFilter_192x192,descriptionText:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerNoSearchResultsDescription),actionButtonText:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerNoSearchClearButtonLabel),onActionButtonClick:()=>{this.onSearchTextChange(""),this.onFiltersChange({sortBy:0,sortOrder:0,filterBy:void 0})}}):R.createElement(Pl.a,{componentRef:this.listReference,items:this.props.items||void 0,onRenderCell:this.onRenderCell(n),className:Object(F.eb)(n.listContainerStyle),role:"presentation"})))),!this.props.isMultiSelectView&&R.createElement(At.a.Item,null,R.createElement(rc,{giveFeedBackButtonText:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerImproveButtonLabel)})))})}constructor(e){super(e),this.listReference=R.createRef(),this.asyncInstance=new Ed.a,this.onSearchTextChange=e=>{this.setState({searchText:e}),window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.debouncedQuery()})})},this.onFiltersChange=e=>{this.setState({sortBy:e.sortBy,sortOrder:e.sortOrder,filterBy:e.filterBy}),window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.debouncedQuery()})})},this.debouncedQuery=this.asyncInstance.debounce(()=>{var e,t;null===(e=(t=this.props).onSearch)||void 0===e||e.call(t,this.state.searchText,{sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,filterBy:this.state.filterBy})},500,{trailing:!0}),this.createDefinedName=()=>{this.props.updateView&&this.props.updateView(1,null)},this.onRenderCell=e=>(t,n)=>{if(t&&void 0!==n&&n>=0){const o=this.props.isMultiSelectView,r=this.state.selection.isIndexSelected(n);return R.createElement(At.a,{horizontal:!0,tokens:{childrenGap:10}},o&&R.createElement(At.a.Item,{align:"center","aria-hidden":!0},R.createElement(yo.a,{checked:r,styles:e.checkboxStyle,onChange:()=>{var e;this.state.selection.toggleIndexSelected(n),null===(e=this.listReference.current)||void 0===e||e.forceUpdate()},ariaLabelledBy:"name-manager-item-card-"+n,inputProps:{"data-is-focusable":!1},disabled:!this.state.selection.canSelectItem(t)})),R.createElement(At.a.Item,{grow:1,styles:{root:{minWidth:0}}},R.createElement(wd,_object_spread_props(_object_spread({},t),{onItemsDelete:this.props.onItemsDelete,isInMultiSelectMode:o,selected:r,onEditIconClick:()=>this.props.updateView&&this.props.updateView(1,t),onMultiSelectClick:this.onMultiSelectClick,onItemClick:this.props.onItemClick,selectionIndex:n,disabled:!this.state.selection.canSelectItem(t)}))))}return R.createElement(R.Fragment,null)},this.onMultiDeleteClick=()=>{this.props.onItemsDelete&&this.props.onItemsDelete(this.getItemsToDelete()),this.state.selection.setAllSelected(!1)},this.onToggleClick=()=>{this.state.selection.toggleAllSelected()},this.onMultiSelectClick=()=>{this.props.updateView&&this.props.updateView(2,null)},this.onSelectionChanged=()=>{var e;this.setState({isAllSelected:this.state.selection.isAllSelected(),shouldEnableDelete:this.state.selection.getSelectedCount()>0}),null===(e=this.listReference.current)||void 0===e||e.forceUpdate()},this.getItemsToDelete=()=>{const e=this.state.selection.getSelectedIndices(),t=[];return e.forEach(e=>{t.push(this.props.items[e].runtimeUid)}),t},this.createSelectionInstance=()=>new ku.a({onSelectionChanged:this.onSelectionChanged,items:this.props.items,getKey:e=>e.runtimeUid,canSelectItem:e=>e.type!==md.Table||!this.props.isMultiSelectView}),this.state={selection:this.createSelectionInstance(),searchText:"",isAllSelected:!1,shouldEnableDelete:!0,sortOrder:0,sortBy:0,filterBy:void 0}}}const Jd=Object(Jo.c)(e=>({anchorStyles:{position:"absolute",bottom:"56px",width:"calc(100% - 24px)",height:"0px",marginLeft:"12px"},calloutStyles:{root:{boxShadow:e.effects.elevation8,borderRadius:e.effects.roundedCorner4},calloutMain:{padding:"8px 8px 8px 16px",borderRadius:e.effects.roundedCorner4,backgroundColor:e.palette.neutralPrimary}},messageStyles:{root:{fontWeight:"600",color:e.palette.neutralLighter,whiteSpace:"pre-line"}},actionButtonStyles:{root:{backgroundColor:"transparent",color:e.palette.neutralLighter,maxHeight:"24px",minWidth:"54px",padding:"initial"},rootHovered:{backgroundColor:"transparent",color:e.palette.neutralLighter}},closeButtonStyles:{root:{height:"24px",width:"24px",backgroundColor:"transparent !important"},rootHovered:{backgroundColor:"transparent !important"}},iconStyles:{root:{filter:"invert(1)",selectors:{[F.m]:{filter:"invert(0)"}}}}})),Yd=e=>{const{message:t,actionButtonText:n,onActionButtonClick:o,sequenceNumber:r,autoHide:i,allowDismiss:a,onCloseButtonClick:s}=e,[l,c]=R.useState(!0),u=R.useRef(null),d=R.useCallback(()=>{i&&u.current&&clearTimeout(u.current)},[u,i]),p=R.useCallback(()=>{i&&(d(),u.current=setTimeout(()=>{c(!0)},5e3))},[u,i,d]),g=R.useCallback(()=>{null==o||o(),c(!0),d()},[o,d]),h=R.useCallback(()=>{c(!0),d(),null==s||s()},[d,s]);return R.useEffect(()=>(r>0&&(c(!1),p()),()=>{c(!0),d()}),[r,p,d]),R.createElement(we.a,null,e=>{const o=Jd(e);return R.createElement(R.Fragment,null,R.createElement("div",{id:"name-manager-toast-target",className:Object(F.eb)(o.anchorStyles)}),!l&&R.createElement(Nl.a,{target:"#name-manager-toast-target",calloutWidth:296,onMouseEnter:d,onMouseLeave:p,coverTarget:!0,directionalHint:Se.a.topLeftEdge,isBeakVisible:!1,styles:o.calloutStyles,"aria-labelledby":"name-manager-toast-message",role:"alert"},R.createElement(At.a,{horizontal:!0,tokens:{childrenGap:6},verticalAlign:"center"},R.createElement(At.a.Item,{grow:1},R.createElement(rs.a,{variant:"medium",styles:o.messageStyles,id:"name-manager-toast-message"},t)),n&&R.createElement(At.a.Item,null,R.createElement(pr.a,{styles:o.actionButtonStyles,onClick:g},n)),a&&R.createElement(At.a.Item,null,R.createElement(vd.a,{iconProps:{iconName:Ha.a.CancelGlyph_20,styles:o.iconStyles},id:"#name-manager-toast-close-button",onClick:h,styles:o.closeButtonStyles,title:"Close"})))))})},Zd=({createDefinedName:e})=>R.createElement(Hd,{headerText:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerEmptyViewHeader),iconName:en.a.TextCard_192x192,descriptionText:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerEmptyViewDescription),primaryButtonText:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerContextMenuEntryPointText),onPrimaryButtonClick:e,onActionButtonClick:()=>{}}),$d=({onRetryButtonClick:e})=>R.createElement(Hd,{headerText:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerErrorViewHeader),iconName:en.a.WebWarning_192x192,primaryButtonText:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerErrorViewRetryButtonLabel),onPrimaryButtonClick:e});var Xd=n(2641);const ep=Object(Jo.c)((e,t)=>({textFeildStyles:{root:{"input::placeholder, textarea::placeholder":{color:e.palette.neutralPrimaryAlt}},field:{fontSize:"12px"},fieldGroup:_object_spread_props(_object_spread({background:e.palette.white},!t&&{height:"28px"}),{borderRadius:"2px",border:"1px solid "+e.palette.neutralTertiary,selectors:{":focus":{borderColor:e.palette.neutralLight}}}),subComponentStyles:{label:{root:{fontWeight:"600"}}}}})),tp=({label:e,required:t,value:n,id:o,placeholder:r,errorMessage:i,onChange:a,multiline:s,resizable:l})=>R.createElement(we.a,null,c=>{const u=ep(c,!!s);return R.createElement(Xd.a,{label:e,required:t,value:n,type:"AppInputProps",id:o,maxLength:255,styles:u.textFeildStyles,placeholder:r,onChange:e=>{a(e||"")},errorMessage:i,multiline:s,resizable:l,autoComplete:"off"})}),np=Object(Jo.c)((e,t=!1)=>({infoIconStyle:{root:{width:"12px",height:"12px",display:"flex",padding:"2px",cursor:"pointer"}},tableInputStyle:{field:{fontSize:"12px"},fieldGroup:{height:"28px",borderRadius:"2px"},wrapper:{border:"1px solid "+e.palette.neutralTertiaryAlt}},ewaRangePickerParentStyle:{root:{"#name-manager-range-picker::placeholder":{color:e.palette.neutralPrimaryAlt},"div[role='alert']":{width:"1px",height:"1px",overflow:"hidden"},"#name-manager-range-picker-RootComponent > div.ms-Stack":{border:"1px solid",borderColor:t?e.palette.redDark:e.palette.neutralTertiary},"#name-manager-range-picker-RootComponent > div.ms-Stack:focus-within, #name-manager-range-picker-RootComponent > div.ms-Stack:hover":{border:"1px solid",borderColor:t?e.palette.redDark:e.palette.neutralSecondary}}},customErrorMessageStyle:{fontSize:12,fontWeight:400,color:e.palette.redDark,margin:0,paddingTop:5,display:"flex",alignItems:"center"},tableLabelStyle:{root:{selectors:{"::after":{paddingRight:"4px"}}}}})),op=({value:e})=>R.createElement(we.a,null,t=>{const n=np(t);return R.createElement(At.a,null,R.createElement(At.a.Item,null,R.createElement(At.a,{horizontal:!0,verticalAlign:"center"},R.createElement(At.a.Item,null,R.createElement(jt.a,{styles:n.tableLabelStyle,htmlFor:"name-manager-table-ref",required:!0},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerRefersToInputTitle))),R.createElement(At.a.Item,null,R.createElement(Ee.a,{content:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerTableEditInfoMessage),directionalHint:Se.a.bottomCenter},R.createElement(fe.a,{iconName:be.a.InfoFluent_16,styles:n.infoIconStyle,"aria-label":ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerTableEditInfoMessage),"data-is-focusable":!0,tabIndex:0}))))),R.createElement(At.a.Item,null,R.createElement(Xd.a,{defaultValue:e,disabled:!0,type:"AppInputProps",id:"name-manager-table-ref",styles:n.tableInputStyle})))}),rp=({value:e,rangePickerController:t,onChange:n,errorMessage:o})=>R.createElement(we.a,null,r=>{const i=np(r,void 0!==o);return R.createElement(At.a,{styles:i.ewaRangePickerParentStyle},R.createElement(At.a.Item,null,R.createElement(jt.a,{htmlFor:"name-manager-range-picker",required:!0},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerRefersToInputTitle))),R.createElement(At.a.Item,null,R.createElement(ke.a,{rangePickerController:t,id:"name-manager-range-picker",value:e,onChange:e=>{null==n||n(e||"")},placeholder:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerRefersToInputPlaceholder),useAbsoluteRef:!0,autoApply:!0,inputProps:{maxLength:255,errorMessage:o,selectTextOnFocus:!0},addSheetName:!0,supportStructuredReferenceReplacement:!0})),o&&R.createElement(At.a.Item,null,R.createElement("div",{"aria-hidden":!0},R.createElement("p",{className:Object(F.eb)(i.customErrorMessageStyle,F.b.slideDownIn20)},o))))}),ip=({type:e,value:t,rangePickerController:n,onChange:o,errorMessage:r})=>e===md.Table?R.createElement(op,{value:t}):R.createElement(rp,{value:t,rangePickerController:n,onChange:o,errorMessage:r}),ap=Object(Jo.c)(()=>({actionButtonWrapper:{root:{flexGrow:1,display:"flex",justifyContent:"flex-end",alignItems:"flex-end",margin:"16px 0"}},infoIconStyle:{root:{marginTop:"2px",width:"12px",height:"12px"}}}));function sp(e){return e.reduce((e,{target:t,errorMessage:n})=>(e[t]=null!=n?n:void 0,e),{0:void 0,1:void 0,2:void 0})}const lp=({item:e,rangePickerController:t,updateView:n,onItemSave:o,errors:r,isClosing:i,onCloseButtonClick:a})=>{var s,l,c,u;const[d,p]=R.useState(null!==(s=null==e?void 0:e.name)&&void 0!==s?s:""),[g,h]=R.useState(null!==(l=null==e?void 0:e.reference)&&void 0!==l?l:""),[m,b]=R.useState(null!==(c=null==e?void 0:e.comment)&&void 0!==c?c:""),[f,x]=R.useState(!1),[E,S]=R.useState(sp(null!=r?r:[]));R.useEffect(()=>{x((d!==(null==e?void 0:e.name)||g!==(null==e?void 0:e.reference)||m!==(null==e?void 0:e.comment))&&d.length>0&&g.length>0&&void 0===E[0]&&void 0===E[1]&&void 0===E[2])},[d,g,m,e,E]),R.useEffect(()=>{i&&(null==a||a(d,g,m,null==e?void 0:e.runtimeUid,null==e?void 0:e.type,i))},[d,g,m,null==e?void 0:e.runtimeUid,null==e?void 0:e.type,i,a]);const y=ap();R.useEffect(()=>{S(sp(null!=r?r:[]))},[r]);const C=R.useRef(d),v=R.useRef(g),k=R.useRef(m);return R.useEffect(()=>{d!==C.current&&S(e=>_object_spread_props(_object_spread({},e),{0:void 0})),g!==v.current&&S(e=>_object_spread_props(_object_spread({},e),{1:void 0})),m!==k.current&&S(e=>_object_spread_props(_object_spread({},e),{2:void 0})),C.current=d,v.current=g,k.current=m},[d,g,m]),R.createElement(At.a,{tokens:{padding:"0px 16px",childrenGap:10},verticalFill:!0},R.createElement(At.a.Item,null,R.createElement(tp,{label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerNameInputTitle),required:!0,value:d,id:"name-manager-name-input",placeholder:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerNameInputPlaceholder),errorMessage:E[0],onChange:p})),R.createElement(At.a.Item,null,R.createElement(ip,{type:null==e?void 0:e.type,value:g,rangePickerController:t,onChange:h,errorMessage:E[1]})),R.createElement(At.a.Item,null,R.createElement(tp,{label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerCommentInputTitle),multiline:!0,required:!1,value:m,id:"name-manager-comment-input",placeholder:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerCommentInputPlaceholder),errorMessage:E[2],onChange:b,resizable:!1})),R.createElement(At.a.Item,null,R.createElement(At.a,{horizontal:!0,tokens:{childrenGap:8}},R.createElement(At.a.Item,null,R.createElement(fe.a,{iconName:be.a.InfoFluent_16,styles:y.infoIconStyle})),R.createElement(At.a.Item,null,R.createElement(rs.a,{variant:"small"},1===(null==e?void 0:e.scope)?ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerScopeEditInfoMessageLocalScope).replace("{0}",null!==(u=null==e?void 0:e.referenceSheetName)&&void 0!==u?u:""):ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerScopeEditInfoMessageGlobalScope))))),R.createElement(At.a.Item,{styles:y.actionButtonWrapper},R.createElement(At.a,{horizontal:!0,tokens:{childrenGap:10}},R.createElement(Wd.a,{text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerSaveButtonLabel),id:"name-manager-save-button",onClick:()=>{null==o||o(d,g,m,null==e?void 0:e.runtimeUid,null==e?void 0:e.type)},disabled:!f}),R.createElement(pr.a,{text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameManagerCancelButtonLabel),id:"name-manager-cancel-button",onClick:()=>{null==n||n(0,null)}}))))};var cp=n(153);const up=Object(Jo.c)(e=>({sharedShimmerStyle:{root:{borderRadius:"4px"},shimmerWrapper:{borderRadius:"4px"}},commandBarShimmerStyle:{root:{height:"26px",display:"flex",alignItems:"center",padding:"6px 0 6px 12px"}},cardStackStyle:{root:{padding:"7px 12px"}},documentCardStyle:{root:{padding:"12px",borderRadius:"4px",boxShadow:e.effects.elevation4,height:"30px",display:"flex",alignItems:"center"}}})),dp=()=>R.createElement(we.a,null,e=>{const t=up(e);return R.createElement(le.a,{styles:t.sharedShimmerStyle,shimmerElements:[{type:cp.a.line}],width:120,height:20})}),pp=()=>R.createElement(we.a,null,e=>{const t=up(e);return R.createElement(At.a,null,R.createElement(At.a.Item,{styles:t.commandBarShimmerStyle},R.createElement(dp,null)),R.createElement(At.a.Item,null,R.createElement(qd,{searchText:"",onSearchTextChange:()=>{},isDisabled:!0})),[...Array(4)].map((e,n)=>R.createElement(At.a.Item,{key:n,styles:t.cardStackStyle},R.createElement(P.a,{styles:t.documentCardStyle},R.createElement(dp,null)))))});class gp extends R.Component{static getDerivedStateFromProps(e){return 3===e.activePage?{isClosing:!0}:{isClosing:!1}}componentDidUpdate(e){e.activePage===this.props.activePage&&e.showLoader===this.props.showLoader||this.focus()}render(){return R.createElement("div",{style:{height:"100%"},ref:this.taskPaneContentRef},this.getTaskPaneContent(),this.props.toast&&this.getToast())}getToast(){var e,t,n,o,r,i,a,s,l,c;return R.createElement(Yd,{message:null===(e=this.props.toast)||void 0===e?void 0:e.message,actionButtonText:null===(t=this.props.toast)||void 0===t?void 0:t.actionButtonText,onActionButtonClick:null===(n=this.props.toast)||void 0===n?void 0:n.onActionButtonClick,sequenceNumber:null!==(o=null===(r=this.props.toast)||void 0===r?void 0:r.sequenceNumber)&&void 0!==o?o:0,autoHide:null===(i=null===(a=this.props.toast)||void 0===a?void 0:a.autoHide)||void 0===i||i,allowDismiss:null===(s=null===(l=this.props.toast)||void 0===l?void 0:l.allowDismiss)||void 0===s||s,onCloseButtonClick:null===(c=this.props.toast)||void 0===c?void 0:c.onCloseButtonClick})}getTaskPaneContent(){var e,t,n;if(this.props.showLoader)return R.createElement(pp,null);if(!(0!==(null===(e=this.props.items)||void 0===e?void 0:e.length)||null!==(t=this.listComponentRef.current)&&void 0!==t&&t.isQueryActive()||this.state.isClosing))return R.createElement(Zd,{createDefinedName:()=>{var e,t;null===(e=(t=this.props).updateView)||void 0===e||e.call(t,1,null)}});switch(this.props.activePage){case 0:return R.createElement(Kd,_object_spread_props(_object_spread({items:this.props.items,updateView:this.props.updateView,isMultiSelectView:!1},this.props.callbacks),{ref:this.listComponentRef,filterCountMap:null!==(n=this.props.filterCountMap)&&void 0!==n?n:void 0}));case 1:case 3:return R.createElement(lp,_object_spread_props(_object_spread({item:this.props.items&&1===this.props.items.length?this.props.items[0]:null},this.props.callbacks),{rangePickerController:this.props.rangePickerController,updateView:this.props.updateView,errors:this.props.errors,isClosing:this.state.isClosing}));case 2:return R.createElement(Kd,_object_spread({items:this.props.items,updateView:this.props.updateView,isMultiSelectView:!0},this.props.callbacks));case 4:return R.createElement($d,{onRetryButtonClick:()=>{var e,t;null===(e=(t=this.props).retryHandler)||void 0===e||e.call(t)}})}}constructor(e){super(e),this.taskPaneContentRef=R.createRef(),this.listComponentRef=R.createRef(),this.focus=()=>{const e=0===this.props.activePage?"#NameManagerSearchBox, #IllustratedInfoPrimaryButton":"button, [href], input",t=this.taskPaneContentRef.current.querySelector(e);t&&t.focus()},this.state={isClosing:!1}}}const hp={boxSizing:"content-box",fontSize:"12px",fontStretch:"normal",fontStyle:"normal",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',lineHeight:"normal",fontWeight:600,letterSpacing:"normal",textAlign:"left"},mp=Object(x.isChangeGateEnabled)("OfficeVSO:8821533_ExcelTaskpaneBGColorFix")?_o.a.colorNeutralBackground1Hover:"#edebe9";function bp(){return Object(b.a)().primary}const fp={color:bp(),textAlign:"center"},xp={root:{height:"50%",margin:"auto"},label:[hp,fp]};var Ep=n(2164);const Sp={selectors:{[F.m]:{outline:"1px solid Highlight",color:"Highlight"}}},yp={background:mp,border:"1px solid #c8c6c4",borderRadius:"2px",fontWeight:"normal",overflowY:"auto",height:"80%",minHeight:"31px",maxHeight:"61px",boxSizing:"border-box",color:"#252423",padding:"4px"},Cp={color:"#323130",fontSize:"12px",paddingTop:"2px",marginBottom:"6px"};class vp extends R.PureComponent{componentDidMount(){this.scrollSelectedItemIntoView()}componentDidUpdate(){this.scrollSelectedItemIntoView()}render(){const{preMisspelledWordText:e,misspelledWordText:t,postMisspelledWordText:n}=this.processSearchQuery(this.props),o={cellContent:Object(F.eb)([hp,yp,{selectors:{":focus":_object_spread({outline:"none",border:"1px solid #323130 "},Sp)}}]),misspelledWord:Object(F.eb)({backgroundImage:"url('data:image/gif;base64,R0lGODlhBQAEAJECAP////8AAAAAAAAAACH5BAEAAAIALAAAAAAFAAQAAAIIlGAXCCHrTCgAOw==')",backgroundPosition:"bottom left",backgroundRepeat:"repeat-x"}),misspelledWordTitle:Object(F.eb)(hp,Cp)},r=1===this.props.misspelledWordType?ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SpellCheckRepeatedWordText):ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SpellCheckNotInDictionaryText);return R.createElement("div",{ref:this.misspelledWordBox,className:this.misspelledWorBoxRootClassName},R.createElement("div",{className:o.misspelledWordTitle},r),R.createElement("div",{id:"SpellCheckTaskPaneCellContentId",tabIndex:0,ref:this.cellContent,className:o.cellContent,role:"text","aria-label":ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SpellCheckAriaSpellingErrorText)+". "+r+". "+t+". "+ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SpellCheckAriaOriginalSentenceText)+". "+ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SpellCheckAriaReadOnlyText)+". "+this.props.misspelledWordCellContent},e,R.createElement("span",{ref:this.misspelledWord,className:o.misspelledWord},t),n))}processSearchQuery(e){let t="",n="",o="";if(e){const{misspelledWordCellContent:r,misspelledWordBeginIndex:i,misspelledWordEndIndex:a}=e;t=r?r.substring(0,i):"",n=r?r.substring(i,a):"",o=r?r.substring(a):""}else i.a.shipAssertTag(595731299,a.a.msoulscat_ES_EWAJS,!1,"SpellCheckTaskPane Invalid data received.");return{preMisspelledWordText:t,misspelledWordText:n,postMisspelledWordText:o}}focus(){this.misspelledWordBox&&this.misspelledWordBox.current&&this.misspelledWordBox.current.focus()}constructor(){super(...arguments),this.misspelledWorBoxRootClassName=Object(F.eb)({display:"flex",flexDirection:"column",height:"15%",maxHeight:"85px"}),this.misspelledWordBox=R.createRef(),this.cellContent=R.createRef(),this.misspelledWord=R.createRef(),this.scrollSelectedItemIntoView=()=>{this.misspelledWord&&this.misspelledWord.current&&this.misspelledWord.current.scrollIntoView({block:"center"})}}}const Rp={root:{height:"26px",background:"#ffffff",border:"1px solid #bebbb8",marginRight:"8px",marginTop:"9px",minWidth:"87px",width:"auto",[F.m]:{MsHighContrastAdjust:"auto"}},rootHovered:{backgroundColor:"#e1dfdd",commonHighContrastHoverFocusStyles:ci.n},rootPressed:{backgroundColor:"#c8c6c4"},rootFocused:{border:"1px solid #323130 ",backgroundColor:"#c8c6c4",commonHighContrastHoverFocusStyles:ci.n},label:[hp,{marginLeft:"0px",marginRight:"0px",textAlign:"center"}]};class kp extends R.PureComponent{render(){return R.createElement("div",{style:{height:"auto",width:"100%",marginBottom:"24px"}},R.createElement(Ko.a,{id:"SpellCheckTaskPaneIgnoreButtonId",type:"AppButtonProps",label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SpellCheckIgnoreButtonText),onExecute:this.onIgnoreButtonExecute,styles:Rp,disabled:this.props.disableButtons}),R.createElement(Ko.a,{id:"SpellCheckTaskPaneIgnoreAllButtonId",type:"AppButtonProps",label:1===this.props.misspelledWordType?ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SpellCheckDeleteRepeatedWordButtonText):ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SpellCheckIgnoreAllButtonText),onExecute:this.onIgnoreAllOrDeleteButtonExecute,styles:Rp,disabled:this.props.disableButtons}))}constructor(){super(...arguments),this.onIgnoreButtonExecute=()=>{this.props.showSpinner(),this.props.onIgnoreButtonExecute?this.props.onIgnoreButtonExecute():i.a.shipAssertTag(595730589,a.a.msoulscat_ES_EWAJS,!1,"SpellCheckTaskPane onIgnoreButtonExecute not set.")},this.onIgnoreAllOrDeleteButtonExecute=()=>{this.props.showSpinner(),this.props.onIgnoreAllOrDeleteButtonExecute?this.props.onIgnoreAllOrDeleteButtonExecute():i.a.shipAssertTag(595730590,a.a.msoulscat_ES_EWAJS,!1,"SpellCheckTaskPane onIgnoreAllButtonExecute not set.")}}}const Tp={width:"100%",color:"#323130",fontSize:"12px",background:mp},_p={root:{borderRadius:"2px",height:"100%",width:"auto",selectors:{" :focus":{outline:"none",border:"1px solid #323130 ",selectors:{" .ms-Dropdown-title":{outline:"none",border:"none",top:"unset !important",left:"unset !important"}}}}},dropdownItem:{selectors:{":hover":{background:"#e1dfdd",commonHighContrastHoverFocusStyles:ci.n},":active":{background:"#c8c6c4"}}},dropdownOptionText:[hp,{fontWeight:"normal"}],dropdownItemsWrapper:{border:"1px solid transparent"},dropdownItemSelected:{backgroundColor:mp},label:[hp,Tp],title:[hp,{border:"1px solid #bebbb8",boxSizing:"border-box",fontWeight:"normal",padding:"5px",textAlign:"left",width:"auto",height:"auto",background:"#ffffff",color:"#252423"}]};var wp=n(66);class Dp extends R.PureComponent{static getDerivedStateFromProps(e,t){return e&&e.currentLocale?{selectedItem:{key:e.currentLocale.localeId,text:e.currentLocale.localeName}}:null}render(){const{selectedItem:e}=this.state;return 0===this.languageList.length&&this.props.supportedLocaleInfoList&&this.props.supportedLocaleInfoList.length>0&&this.updateSupportedLanguageList(this.props),R.createElement("div",{style:this.props.isLanguageErrorTab?{boxSizing:"border-box",left:"0px",width:"100%"}:{bottom:"26px",boxSizing:"border-box",display:"inline-flex",flexDirection:"column",position:"inherit",width:"100%"}},R.createElement(Lt.a,{label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SpellCheckDictionaryLanguageText),options:this.languageList,placeholder:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SpellCheckLanguageListPlaceHolder),selectedKey:e?e.key:"",onChange:this.onSelectedLanguageChanged,disabled:this.props.disableList,styles:_p,onRenderCaretDown:this.onRenderCaretDown,calloutProps:{calloutMaxHeight:180,bounds:wp.getBoundingWindowWithPaddingFabric}}))}updateSupportedLanguageList(e){if(e.supportedLocaleInfoList){for(const t of e.supportedLocaleInfoList){const e=t?t.localeId:null,n=t?t.localeName:null;e&&n&&this.languageList.push({key:e.toUpperCase(),text:n})}this.languageList.sort(this.compareLocale)}}compareLocale(e,t){return e.text.localeCompare(t.text)}constructor(){super(...arguments),this.languageList=[],this.state={selectedItem:void 0},this.onSelectedLanguageChanged=(e,t)=>{this.props.showSpinner(),t&&this.setState({selectedItem:t}),this.props.onLanguageChangeExecute&&t?this.props.onLanguageChangeExecute(t.key.toString()):i.a.shipAssertTag(595730638,a.a.msoulscat_ES_EWAJS,!1,"SpellCheckTaskPane Error while changing the proofing language.")},this.onRenderCaretDown=()=>R.createElement(fe.a,{iconName:Po.a.downChevron?Po.a.downChevron.icon12:"CommonControlChevronDownGlyph_12",style:{height:"12px",width:"12px"}})}}const Pp={root:{border:"1px solid #bebbb8",background:"#ffffff",boxShadow:"0 2px 4px -0.8px rgba(0, 0, 0, 0.1)",height:"32px",width:"100%",padding:"4px 8px",[F.m]:{MsHighContrastAdjust:"auto"}},rootHovered:{background:"#e1dfdd",commonHighContrastHoverFocusStyles:ci.n},rootPressed:{background:"#c8c6c4"},rootDisabled:{background:"transparent !important",boxShadow:"unset",opacity:.33,border:"1px solid #bebbb8 !important"},label:[hp,{padding:"0px",textOverflow:"ellipsis",overflow:"hidden",margin:"0px"}],splitButtonContainer:{borderRadius:"2px",height:"32px",marginBottom:"9px",width:"100%"},splitButtonContainerDisabled:{selectors:{":focus":{border:"1px solid #323130 "}}},splitButtonDividerDisabled:{height:"0px",width:"0px"},splitButtonDivider:{top:"50%",transform:"translateY(-50%)"},labelDisabled:[hp,{fontWeight:"normal",padding:"0px",textOverflow:"ellipsis",overflow:"hidden",margin:"0px"}],splitButtonContainerFocused:{selectors:{" .splitPrimaryButton":{border:"1px solid #323130 ",borderRight:"none !important"}," .splitMenuButton":{border:"1px solid #323130 ",borderLeft:"none !important"}}},splitButtonMenuIconDisabled:{height:"0px",width:"0px"},splitButtonMenuIcon:{height:"12px",width:"12px",margin:"8px 9px"},splitButtonMenuButtonDisabled:{display:"none"},splitButtonMenuButtonExpanded:{background:"#e1dfdd",height:"32px"},textContainer:[hp],splitButtonMenuButton:{background:"#ffffff",border:"1px solid #bebbb8",boxShadow:"2px 2px 4px -0.8px rgba(0, 0, 0, 0.1)",height:"32px",selectors:{[F.m]:{MsHighContrastAdjust:"auto"},":hover":{background:"#e1dfdd",commonHighContrastHoverFocusStyles:ci.n},":active":{background:"#c8c6c4"}},width:"auto",minWidth:"32px",marginLeft:"0px"}};var Ip=n(1208),Fp=n(962);const Bp={marginLeft:"0px",marginRight:"0px",textAlign:"center"},Mp=Object(Jo.c)(e=>Object(F.db)({root:{height:24,lineHeight:24,selectors:{":hover":{background:"#e1dfdd"},":active":{background:"#c8c6c4"}}},linkContent:{height:22},icon:{height:16,width:16,lineHeight:16},label:[hp,Bp],subMenuIcon:{height:12}},e)),jp=Object(Jo.c)(e=>t=>{const{controlProps:n,location:o}=t;return n.filter(e=>Object(cl.e)(e)>0).map(t=>{const n=_object_spread_props(_object_spread({},t),{location:o,appStrings:e});switch(n.type){case"AppButtonProps":return Object(Fp.a)(Object(Ip.a)(n.id,n.location),_object_spread_props(_object_spread({},n),{shouldTakeFocus:void 0===n.shouldTakeFocus||n.shouldTakeFocus}),Mp());default:throw new Error(`The control of type ${n.type} is not valid in a  Box menu`)}})});class Op extends R.PureComponent{render(){const{suggestion:e}=this.props,t=e?e.suggestionText:"";let n=!!this.props.disableButtons&&this.props.disableButtons;return n||t&&0!==t.length||(n=!0),R.createElement(Vc.a,{styles:Pp,id:"SpellCheckTaskPaneSuggestionButtonId",type:"AppSplitButtonProps",onExecute:this.onChangeButtonExecute,label:t||ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SpellCheckNoSuggestionText),hideLabel:!1,controlInMenuRendererFunction:jp(Object(f.a)()),downChevronIcon:Po.a?Po.a.downChevron:"CommonControlChevronDownGlyph_12",icon:"",menuDefinition:this.getMenuDefinition(),disabled:n,useTargetAsMinWidth:!1,ariaDescription:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SpellCheckSuggestionsTitle),ariaRoleDescription:OfficeCommonStringsManager.get(OfficeCommonStringsEnum.SplitButtonRoleDescription),splitButtonAriaLabel:t||ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SpellCheckNoSuggestionText)})}constructor(){super(...arguments),this.onChangeButtonExecute=()=>{this.props.showSpinner(),this.props.onChangeButtonExecute&&this.props.suggestion?this.props.onChangeButtonExecute(this.props.suggestion.changeId):i.a.shipAssertTag(595731297,a.a.msoulscat_ES_EWAJS,!1,"SpellCheckTaskPane onChangeButtonExecute not set.")},this.onChangeAllButtonExecute=()=>{this.props.showSpinner(),this.props.onChangeAllButtonExecute&&this.props.suggestion?this.props.onChangeAllButtonExecute(this.props.suggestion.changeAllId):i.a.shipAssertTag(595731298,a.a.msoulscat_ES_EWAJS,!1,"SpellCheckTaskPane onChangeAllButtonExecute not set.")},this.getMenuDefinition=()=>{let e="SpellCheckTaskPaneChangeAllId";return this.props.suggestion&&(e+=this.props.suggestion.changeAllId),{sections:[{controls:[{type:"AppButtonProps",id:e,label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SpellCheckChangeAllButtonText),onExecute:this.onChangeAllButtonExecute}]}]}}}}const Lp={color:"#323130",fontSize:"12px",marginTop:"17px",marginBottom:"6px"},Ap={root:{width:"100%",boxSizing:"border-box",margin:"0px",background:"#f5f5f5 !important",display:"flex",justifyContent:"center"},iconContainer:{margin:"4px 4px 4px 4px"},text:[hp,{float:"left",width:"100%",margin:"4px",color:"#201F1E",fontSize:"12px",fontWeight:"normal"}]},Np={root:Object(F.eb)({opacity:.55,background:"transparent",border:"1px solid #bebbb8",height:"136px",marginTop:"4px",marginBottom:"9px",width:"100%",selectors:{":focus":_object_spread({outline:"none",border:"1px solid #323130 "},Sp)}}),text:Object(F.eb)([hp,{margin:"0px",padding:"0px",position:"relative",textAlign:"center",top:"50%",transform:"translateY(-50%)"}])};var Wp=n(2636),zp=n(123);class Hp extends R.PureComponent{render(){const{misspelledWordBoxContent:e}=this.props,{previousChangeAllActionInfo:t}=this.props,{suggestionBoxContent:n}=this.props,o=!!n&&!!n.suggestions;return R.createElement("div",{className:Object(F.eb)([{height:"100%",display:"flex",flexDirection:"column",minHeight:"500px",overflow:"hidden",paddingLeft:"16px",paddingRight:"16px",position:"relative",animationName:Object(F.bb)({from:{opacity:0},to:{opacity:1}}),animationDuration:"0.25s",animationTimingFunction:"ease-in"}])},R.createElement(vp,{ref:this.misspelledWordBox,misspelledWordType:e?e.misspelledWordType:0,misspelledWordBeginIndex:e?e.misspelledWordBeginIndex:0,misspelledWordEndIndex:e?e.misspelledWordEndIndex:0,misspelledWordCellContent:e?e.misspelledWordCellContent:""}),this.renderSuggestionTitle(this.props),o?this.createSuggestionsView(this.props):this.createNoSuggestionsView(),R.createElement("div",{style:{display:"inline-flex",flexDirection:"column",alignItems:"flex-start",flexGrow:1,marginBottom:"32px"}},R.createElement(kp,_object_spread({disableButtons:this.props.disableButtons,misspelledWordType:e?e.misspelledWordType:null,showSpinner:this.props.showSpinner},this.props.userActionButtons)),t&&t.changeCount&&R.createElement("div",{style:{width:"100%",background:"#f5f5f5 !important"}},R.createElement(Wp.a,{messageBarType:zp.a.info,styles:Ap},R.createElement("span",null,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SpellCheckPreviousChangeInfoText).replace("{0}",t.changeCount.toString()).replace("{1}",t.suggestionApplied?t.suggestionApplied:""))))),R.createElement(Dp,_object_spread({disableList:this.props.disableButtons,showSpinner:this.props.showSpinner},this.props.localeInfo)))}renderSuggestionTitle(e){const t=e.suggestionBoxContent&&e.suggestionBoxContent.suggestions?ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SpellCheckSuggestionsTitle):ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SpellCheckNoSuggestionsTitle);return R.createElement("div",{id:"SpellCheckTaskPaneSuggestionsTitleId",role:"heading","aria-level":1,className:Object(F.eb)([hp,Lp])},t)}createSuggestionsView(e){const{suggestionBoxContent:t}=this.props,n=t?t.suggestions:null;if(n){const o=n.map((function(n){return R.createElement("div",{role:"group",key:n.id},R.createElement(Op,{suggestion:n,disableButtons:e.disableButtons,onChangeButtonExecute:t?t.onChangeButtonExecute:null,onChangeAllButtonExecute:t?t.onChangeAllButtonExecute:null,showSpinner:e.showSpinner}))}));return R.createElement("div",{role:"list","aria-label":ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SpellCheckSuggestionsTitle)},o)}return null}createNoSuggestionsView(){return R.createElement("div",{tabIndex:0,className:Np.root,"aria-label":ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SpellCheckSuggestionsTitle)+". "+ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SpellCheckNoSuggestionFoundText)},R.createElement("p",{className:Np.text},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SpellCheckNoSuggestionFoundText)))}focus(){this.misspelledWordBox&&this.misspelledWordBox.current&&this.misspelledWordBox.current.focus()}constructor(){super(...arguments),this.misspelledWordBox=R.createRef()}}function Vp(){return Object(b.a)()}const Up={root:{backgroundColor:"#ffffff",borderRadius:"2px",border:"1px solid #bebbb8",height:"26px",marginTop:"16px"},rootHovered:{backgroundColor:"#e1dfdd"},rootPressed:{backgroundColor:"#c8c6c4"},rootFocused:{border:"1px solid #323130 "},label:[hp,{marginLeft:"0px",marginRight:"0px",textAlign:"center"}]},Gp={fontSize:"14px",fontWeight:"normal",boxSizing:"border-box",paddingLeft:"8px",width:"calc(100% - 35px)"},qp={root:{marginTop:"24px",padding:"0px",background:"#f5f5f5"},iconContainer:{marginLeft:"4px"},text:[hp,{color:"#201F1E",fontWeight:"normal",fontSize:"12px",float:"left"}]},Qp={link:{color:"#0078D4",textDecoration:"none",":visited":{color:"#0078D4",textDecoration:"none"},":focus":{border:"1px solid #323130 ",outline:"none"}}};class Kp extends R.PureComponent{render(){const e=Up;let t=!1,n="",o=Object(F.eb)({border:"1px solid transparent",boxSizing:"border-box",fill:Vp().primary,float:"left",height:"20px",width:"20px",padding:"auto",display:"inline-flex",marginTop:"1px"}),r=!!this.props.showOutOfSyncNotification&&this.props.showOutOfSyncNotification;switch(r&&5!==this.props.activeTab&&6!==this.props.activeTab&&8!==this.props.activeTab&&(r=!1,i.a.sendTraceTag(595718811,a.a.msoulscat_ES_EWAJS,s.a.Error,`SpellCheckTaskPane Error :: show out of sync notification received on incorrect tab ${this.props.activeTab} .`)),this.props.activeTab){case 3:case 2:t=!0,n=be.a.Info_20;break;case 7:case 4:t=!0,n=be.a.AlertWarning_20,o=Object(F.eb)({border:"1px solid transparent",boxSizing:"border-box",fill:Vp().primary,float:"left",height:"20px",width:"20px",padding:"auto",display:"inline-flex",marginTop:"0px"});break;case 6:case 5:case 8:t=!0,n=Po.a?Po.a.checkboxCheckmark:"CheckmarkWithDynamicColor_12",o=Object(F.eb)({borderRadius:"50%",border:"1px solid "+Vp().primary,boxSizing:"border-box",fill:Vp().primary,float:"left",height:"20px",padding:"auto",display:"inline-flex",width:"20px",marginTop:"4px"})}return R.createElement("div",{className:Object(F.eb)([{display:"flex",flexDirection:"column",justifyContent:"flex-start",marginTop:"5px",paddingLeft:"16px",paddingRight:"16px",animationName:Object(F.bb)({from:{opacity:0},to:{opacity:1}}),animationDuration:"0.25s",animationTimingFunction:"ease-in"}])},R.createElement("div",{style:{display:"flex"}},t&&R.createElement(fe.a,{className:o,iconName:n}),0!==this.props.message.length&&R.createElement("div",{className:Object(F.eb)([hp,Gp])},this.props.message)),R.createElement("div",null,4===this.props.activeTab&&this.showSupportedLanguageList()),this.props.showButton&&R.createElement(Ko.a,{id:"SpellCheckTaskPaneMessageButtonId",type:"AppButtonProps",label:this.props.buttonLabel,onExecute:this.onMessageButtonExecute,styles:e,disabled:this.props.disableButtons,role:"button",ariaDescription:this.props.message}),R.createElement("div",{role:"alert","aria-live":"polite"},r&&R.createElement(Wp.a,{messageBarType:zp.a.info,styles:qp},R.createElement("span",{"aria-hidden":"true",id:"SpellCheckTaskPaneContentChangedId",style:{lineHeight:"normal"}},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SpellCheckWorkbookContentChangedText)),R.createElement("a",{href:"#",id:"SpellCheckTaskPaneCheckAgainId",onClick:this.onRecheckClick,"aria-labelledby":"SpellCheckTaskPaneContentChangedId SpellCheckTaskPaneCheckAgainId",style:Qp.link,"aria-disabled":!1,role:"button"},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SpellCheckCheckAgainText)))))}showSupportedLanguageList(){return this.props.localeInfo&&this.props.localeInfo.supportedLocaleInfoList&&this.props.localeInfo.supportedLocaleInfoList.length||i.a.shipAssertTag(595730639,a.a.msoulscat_ES_EWAJS,!1,"SpellCheckTaskPane.showSupportedLanguageList Invalid supported language list received."),R.createElement("div",null,R.createElement(Dp,{disableList:this.props.disableButtons,showSpinner:this.props.showSpinner,currentLocale:{localeId:"EN-US"},supportedLocaleInfoList:this.props.localeInfo?this.props.localeInfo.supportedLocaleInfoList:null,onLanguageChangeExecute:this.props.localeInfo?this.props.localeInfo.onLanguageChangeExecute:null,isLanguageErrorTab:!0}))}constructor(){super(...arguments),this.onRecheckClick=()=>{i.a.sendTraceTag(595718999,a.a.msoulscat_ES_EWAJS,s.a.Info,`SpellCheckTaskPane Recheck button clicked on notification on active tab ${this.props.activeTab} .`),this.props.showSpinner(),this.props.onRecheckExecute?this.props.onRecheckExecute():i.a.shipAssertTag(595718812,a.a.msoulscat_ES_EWAJS,!1,"SpellCheckTaskPane onRecheckExecute not set.")},this.onMessageButtonExecute=()=>{i.a.sendTraceTag(595719e3,a.a.msoulscat_ES_EWAJS,s.a.Info,`SpellCheckTaskPane Message button clicked on active tab ${this.props.activeTab} .`),this.props.showSpinner(),this.props.onButtonExecute?this.props.onButtonExecute(this.props.activeTab):i.a.shipAssertTag(595731296,a.a.msoulscat_ES_EWAJS,!1,"SpellCheckTaskPane onMessageButtonExecute not set.")}}}var Jp=n(1417),Yp=n(399),Zp=n(971);class $p extends R.Component{componentDidMount(){this.registerInformationIcon()}componentDidUpdate(){this.spellCheckPane&&this.spellCheckPane.current&&(this.spellCheckPane.current.scrollTop=0),this.buttonClick&&(this.focus(),this.stopWatch.stop(),this.buttonClick=!1)}componentWillUnmount(){this.unRegisterInformationIcon()}componentWillReceiveProps(e){e.showLoadingIcon!==this.state.showLoading&&this.showSpinner(e.showLoadingIcon)}render(){const e=1===this.props.activeTab;return e||this.createMessageTabTexts(this.props.activeTab,this.props.localeInfoContent?this.props.localeInfoContent.currentLocale:null,this.props.worksheetName),R.createElement("div",{ref:this.spellCheckPane,className:Object(F.eb)({height:"100%",overflowX:"hidden",overflowY:"auto",display:"contents",background:mp})},e&&R.createElement(Hp,{ref:this.spellCheck,disableButtons:this.state.disableButtons,misspelledWordBoxContent:this.props.misspelledWordBoxContent,suggestionBoxContent:this.props.suggestionBoxContent,userActionButtons:this.props.userActionButtons,localeInfo:this.props.localeInfoContent,showSpinner:this.showSpinner,previousChangeAllActionInfo:this.props.previousChangeAllActionInfo}),!e&&R.createElement(Kp,{message:this.message,disableButtons:this.state.disableButtons,activeTab:this.props.activeTab,showButton:this.showButtonMessageTab,buttonLabel:this.buttonLabel,showSpinner:this.showSpinner,localeInfo:this.props.localeInfoContent,onButtonExecute:this.props.onMessageButtonExecute,showOutOfSyncNotification:this.props.showOutOfSyncNotification,onRecheckExecute:this.props.onRecheckExecute}),this.state.showLoading&&R.createElement(Ep.a,{className:Object(F.eb)({height:"auto",zIndex:2,backgroundColor:Object(x.isChangeGateEnabled)("OfficeVSO:8821533_ExcelTaskpaneBGColorFix")?"inherit":"rgba(237, 235, 233, .8)",position:"absolute",marginTop:"44px"})},R.createElement(Jp.a,{styles:xp,className:Object(F.eb)({selectors:{"& .ms-Spinner-circle":{borderColor:"#dddddd",borderTopColor:bp(),color:bp(),margin:"0px"}}}),size:Yp.a.large,label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SpellCheckSpinnerText)})))}createMessageTabTexts(e,t,n){switch(this.message="",this.showButtonMessageTab=!1,this.buttonLabel="",e){case 4:let e="";t?e=t.localeName:i.a.sendTraceTag(595730640,a.a.msoulscat_ES_EWAJS,s.a.Error,"SpellCheckTaskPane invalid current locale received."),this.message=ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SpellCheckLanguageErrorText).replace("{0}",e);break;case 2:this.message=ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SpellCheckResumeText),this.showButtonMessageTab=!0,this.buttonLabel=ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SpellCheckResumeButtonText);break;case 3:this.message=ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SpellCheckSwitchWorkSheetErrorText),this.showButtonMessageTab=!0,this.buttonLabel=ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SpellCheckReCheckButtonText);break;case 6:this.message=ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SpellCheckCompleteText);break;case 5:this.props.worksheetName||i.a.sendTraceTag(595730641,a.a.msoulscat_ES_EWAJS,s.a.Error,"SpellCheckTaskPane invalid worksheet received."),this.message=ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SpellCheckSwitchWorkSheetText).replace("{0}",n||""),this.showButtonMessageTab=!0,this.buttonLabel=ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SpellCheckCheckOtherSheetsButtonText);break;case 8:this.message=ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SpellCheckCompleteOnRangeText),this.showButtonMessageTab=!0,this.buttonLabel=ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SpellCheckReCheckButtonText);break;case 7:default:this.message=ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SpellCheckErrorText),this.showButtonMessageTab=!0,this.buttonLabel=ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SpellCheckTryAgainButtonText)}}unRegisterInformationIcon(){Object(F.mb)(["Info"])}registerInformationIcon(){Object(F.ib)({icons:{Info:R.createElement(fe.a,{className:Object(F.eb)({boxSizing:"border-box",fill:"#605e5c",float:"left",height:"16px",width:"16px",padding:"auto",display:"inline-flex"}),iconName:be.a.Info_20})}})}constructor(e){super(e),this.spellCheck=R.createRef(),this.spellCheckPane=R.createRef(),this.showButtonMessageTab=!1,this.message="",this.buttonLabel="",this.buttonClick=!1,this.focus=()=>{if(!this.state.showLoading){const e=this.spellCheckPane.current.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"]), div[data-is-focusable="true"]');e&&e[0]&&e[0].focus()}},this.showSpinner=(e=!0)=>{e&&!this.state.showLoading?this.stopWatch.reset():!e&&this.state.showLoading&&(this.buttonClick=!0),this.setState({showLoading:e,disableButtons:e})},this.state={showLoading:e.showLoadingIcon,disableButtons:!1},this.showSpinner=this.showSpinner.bind(this),this.stopWatch=Object(Zp.a)("SpellCheckTaskPane.SpellCheckSpinnerDuration")}}const Xp={border:"1px solid #b0b0b0",selectors:{":hover":{border:"1px solid #b0b0b0"}}},eg=Object(Jo.c)(()=>Object(F.db)({root:{display:"flex",flexDirection:"column",height:"100%",paddingLeft:"16px",paddingRight:"16px"},description:[rg,{marginBottom:"8px"}],controlGroup:{marginBottom:"4px",display:"flex",alignItems:"center"},spinnerContainer:{display:"flex",height:"100%",justifyContent:"center",alignItems:"center"}})),tg={root:{marginRight:"4px"},dropdown:{width:"100px",fontSize:"12px"},title:[Xp,{height:"24px",lineHeight:"24px"}],caretDownWrapper:{height:"24px",lineHeight:"24px"},dropdownItem:{minHeight:"28px",fontSize:"12px"},dropdownItemSelected:{minHeight:"28px",fontSize:"12px"}},ng=Object(Jo.c)(()=>Object(F.eb)([{marginBottom:"16px"}])),og={height:"12px",width:"12px",marginLeft:"auto",cursor:"pointer"},rg={fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"12px"},ig={[F.m]:{backgroundColor:"Highlight",selectors:{"svg > path.OfficeIconColors_HighContrast":{fill:"HighlightText"}}}},ag={root:{height:"24px",minWidth:"24px",padding:0},icon:{height:"16px",width:"16px"},menuIcon:{height:"8px",width:"8px",lineHeight:"8px",margin:0},rootExpanded:{backgroundColor:"#D2D0CE",selectors:ig},rootHovered:{backgroundColor:"#E1DFDD",selectors:ig},rootFocused:{selectors:ig},rootPressed:{selectors:ig}},sg={root:{height:"28px",lineHeight:"28px"},label:{fontSize:"12px",height:"28px",lineHeight:"28px"},icon:{height:"28px",lineHeight:"28px"},checkmarkIcon:{display:"none"}},lg={calloutMain:{overflow:"hidden",selectors:{[F.m]:{selectors:{"button[aria-checked='true'] svg > path.OfficeIconColors_HighContrast":{fill:"ButtonText"}}}}}},cg={root:{height:"12px",width:"12px"}},ug={backgroundColor:"#F3F2F1"},dg={outline:"1px solid #605E5C",outlineOffset:"-2px",selectors:{".fieldItemMenuIconWrapper":{visibility:"visible !important"}}},pg={outline:"none",backgroundColor:"Highlight",color:"HightlightText",selectors:{"svg > path.OfficeIconColors_HighContrast":{fill:"HighlightText"},".fieldItemLabel":{color:"HighlightText",backgroundColor:"Highlight",forcedColorAdjust:"none"}}};var gg=n(1214),hg=n(170),mg=n(2459);class bg extends R.PureComponent{render(){return R.createElement(bu.a,_object_spread_props(_object_spread({},this.props),{styles:this.props.styles?Object(mg.b)(this.props.styles,gl.a.Small):Object(mg.a)(gl.a.Small)}))}}const fg=Object(Jo.c)((e,t,n,o,r,i)=>Object(F.db)({root:{display:"flex",alignItems:"center",width:"100%",height:"100%",minHeight:"18px",boxSizing:"border-box",paddingLeft:t?n?16*e+2:16*e+18:i&&!n?16:16*e,paddingRight:4,selectors:{":hover":ug,":focus-visible":dg,[F.m]:{selectors:{":hover, :focus":pg}}}},icon:{height:"16px",width:"16px",overflow:"hidden"},hierarchicalIcon:{height:"16px",width:"16px",overflow:"hidden",marginLeft:"4px"},label:[rg,{fontWeight:o||r?"600":"normal",padding:"0 0 0 4px",textOverflow:"ellipsis",overflow:"hidden",flex:"1",cursor:"default",whiteSpace:"nowrap"}],menuIcon:[og],menuIconWrapper:{visibility:"hidden",height:"18px",lineHeight:"18px"}})),xg={root:{height:"12px",width:"12px",marginRight:"2px",marginLeft:"2px",padding:0},checkbox:{height:"12px",width:"12px"},checkmark:{fontSize:"12px",height:"12px",width:"12px"}},Eg=Object(Jo.c)(e=>Object(F.db)({root:{display:"flex",alignItems:"center",width:"100%",height:"18px",boxSizing:"border-box",borderTop:e?"1px solid #0f9900":"1px solid transparent",borderBottom:"1px solid transparent",paddingLeft:"4px",paddingRight:"4px",selectors:{":hover":ug,":focus-visible":dg,[F.m]:{borderTop:e?"1px solid Highlight":"1px solid Window",borderBottom:"1px solid Window",selectors:{":hover, :focus":pg}}}},label:[rg,{padding:"0 0 0 4px",textOverflow:"ellipsis",overflow:"hidden",flex:"1",cursor:"default",whiteSpace:"nowrap"}],menuIcon:[og],menuIconWrapper:{visibility:"hidden",height:"18px",lineHeight:"18px"}})),Sg=Object(Jo.c)(e=>Object(F.db)({root:{marginBottom:e?0:"16px"},title:[rg,{alignItems:"center",display:"flex",fontWeight:600,height:"16px",marginBottom:"4px"}],titleIcon:{height:"16px",width:"16px",marginRight:"4px"},content:{background:"#FFFFFF",border:"1px solid #b0b0b0",borderRadius:"2px",boxSizing:"border-box",overflowY:"auto"}})),yg=Object(Jo.c)(e=>({height:-1===e?"auto":18*e+2})),Cg=Object(Jo.c)((e,t)=>Object(F.eb)([{height:t?"18px":"36px",width:"100%",boxSizing:"border-box",borderTop:e?"1px solid #0f9900":"1px solid transparent",selectors:{[F.m]:{borderTop:e?"1px solid Highlight":"1px solid Window"}}}]));function vg(e,t,n,o,r){if(null==e||null==e.current)return[-1,-1,-1,-1];let i=e.current.offsetHeight-64-16-48-8;i<72?(i=72,e.current.style.overflowY="auto"):e.current.style.overflowY="hidden";const a=i/18-.1,s=0===t?t+2:t+1,l=0===n?n+2:n+1,c=0===o?o+2:o+1,u=0===r?r+2:r+1,d=s+l+c+u;if(a>=d)return[-1,-1,-1,-1];const p=[{type:4,size:s},{type:2,size:l},{type:1,size:c},{type:8,size:u}];p.sort((function(e,t){return t.size-e.size}));let g=d-a;const h=new Map;return p[0].size-p[1].size>=g?h.set(p[0].type,p[0].size-g):(g-=p[0].size-p[1].size,2*(p[1].size-p[2].size)>=g?(h.set(p[0].type,p[1].size-g/2),h.set(p[1].type,p[1].size-g/2)):(g-=2*(p[1].size-p[2].size),3*(p[2].size-p[3].size)>=g?(h.set(p[0].type,p[2].size-g/3),h.set(p[1].type,p[2].size-g/3),h.set(p[2].type,p[2].size-g/3)):p.forEach(e=>{h.set(e.type,a/4)}))),[4,2,1,8].forEach(e=>{h.has(e)||h.set(e,-1)}),[h.get(4),h.get(2),h.get(1),h.get(8)]}Object(Jo.c)(()=>Object(F.eb)([{borderTop:"1px solid #0f9900"}]));const Rg=(e,t,n,o)=>{if(null==e||null==e.current)return;const r=t?"fieldItemOnFocus":"fieldItemOnHover";n?(e.current.classList.add(r),e.current.style.visibility="visible"):(e.current.classList.remove(r),o||e.current.classList.contains("fieldItemMenuOpen")||(e.current.style.visibility="hidden"))},kg=Object(Jo.c)(e=>{switch(e){case 2:return"fieldWellColumnsTitle";case 8:return"fieldWellDataTitle";case 1:return"fieldWellRowsTitle";case 4:return"fieldWellFilterTitle";default:return""}}),Tg=e=>`fieldItem_${e}_MenuIcon`;class _g{static updateData(e,t){_g.isV2Enabled=t,_g.onSaveFieldListSizePercentage=e.onSaveFieldListSizePercentage||(()=>{}),_g.onSelectedTabChanged=e.onSelectedTabChanged||(()=>{}),_g.onSortOrderChanged=e.onSortOrderChanged||(()=>{}),_g.onExpandCollapseAll=e.onExpandCollapseAll||(()=>{}),_g.onFieldMove=e.onFieldMove||(()=>{}),_g.onFieldExpandCollapse=e.onFieldExpandCollapse||(()=>{}),_g.onFieldCheckedChanged=e.onFieldCheckedChanged||(()=>{}),_g.onFieldWellItemMenuClickV2=e.onFieldWellItemMenuClickV2||(()=>{}),_g.onFieldListItemMenuClickV2=e.onFieldListItemMenuClickV2||(()=>{}),_g.onSearchInputChanged=e.onSearchInputChanged||(()=>{})}}class wg extends R.Component{componentDidMount(){const{dragDropHelper:e}=this.props;this.updateItemCheckboxAriaLabel(),e&&this.rootDiv.current?this.dragDropSubscription=e.subscribe(this.rootDiv.current,this.events,this.getDragDropOptions()):i.a.sendTraceTag(554297423,a.a.msoulscat_ES_EWAJS,s.a.Error,"FieldListItemContainer.ComponentDidMount: root div is null, failed to register drag and drop."),-1!==this.props.focusResetId&&this.props.item.id===this.props.focusResetId&&null!=this.rootComponentRef.current&&this.rootComponentRef.current.focus()}componentDidUpdate(e){this.props.item.id!==e.item.id&&this.updateItemCheckboxAriaLabel(),this.props.itemIndex===e.itemIndex&&this.props.item===e.item&&this.props.dragDropHelper===e.dragDropHelper||(this.dragDropSubscription&&(this.dragDropSubscription.dispose(),delete this.dragDropSubscription),this.props.dragDropHelper&&this.rootDiv.current&&(this.dragDropSubscription=this.props.dragDropHelper.subscribe(this.rootDiv.current,this.events,this.getDragDropOptions()))),-1!==this.props.focusResetId&&this.props.focusResetId!==e.focusResetId&&this.props.item.id===this.props.focusResetId&&null!=this.rootComponentRef.current&&this.rootComponentRef.current.focus()}componentWillUnmount(){this.dragDropSubscription&&(this.dragDropSubscription.dispose(),delete this.dragDropSubscription),this.events.dispose()}render(){const{item:e}=this.props,t=this.getFieldListItemIconName(e,this.props.isDataModel),n=this.props.nestingDepth>0&&(e.isCollapsible||!e.isCollapsible&&(""===t||3===e.type)),o=fg(this.props.nestingDepth,n,e.isCollapsible,e.isChecked,e.isBolded,this.props.isRichPivotFieldList),r=`fieldItem_${e.id}_label`;return R.createElement(Cd.a,{id:"fieldItem_"+e.id,"data-is-focusable":!0,role:"treeitem",elementRef:this.rootDiv,componentRef:this.rootComponentRef,className:o.root,"aria-checked":e.showCheckBox?e.isChecked:void 0,"aria-expanded":e.isCollapsible?!e.isCollapsed:void 0,"aria-haspopup":!!e.showMenu&&"menu","aria-labelledby":r,draggable:e.canDrag,allowFocusRoot:!0,onClick:this.onFieldListItemClick,onKeyDown:this.onFieldListItemKeyDown,onFocus:this.onFieldListItemFocus,onBlur:this.onFieldListItemBlur,onMouseEnter:this.onFieldListItemMouseEnter,onMouseLeave:this.onFieldListItemMouseLeave},e.isCollapsible?R.createElement(fe.a,{className:o.icon,iconName:e.isCollapsed?be.a.XLFieldListExpanderPlus_16:be.a.XLFieldListExpanderMinus_16}):null,""!==t&&66!==e.type&&3!==e.type?R.createElement(fe.a,{className:o.icon,iconName:t}):null,e.showCheckBox?R.createElement(Cd.a,{disabled:!0},R.createElement("div",{onClick:this.onCheckBoxDivClick},R.createElement(bg,{id:`fieldItem_${e.id}_checkbox`,type:"AppCheckboxProps",label:"",styles:xg,checked:e.isChecked,checkmarkIcon:Po.a.checkboxCheckmark,onExecute:this.onCheckboxChange}))):null,""===t||66!==e.type&&3!==e.type?null:R.createElement(fe.a,{className:o.hierarchicalIcon,iconName:t}),R.createElement("div",{id:r,title:e.name?e.name:"",className:o.label+" fieldItemLabel","aria-hidden":!0},e.name),e.showMenu?R.createElement("div",{id:Tg(e.id),role:"button","aria-labelledby":r,"aria-haspopup":"menu",className:o.menuIconWrapper+" fieldItemMenuIconWrapper",ref:this.itemMenuIconRef,onClick:this.onFieldListItemMenuClick,"data-testid":"FieldMenuIcon"},R.createElement(fe.a,{className:o.menuIcon,iconName:be.a.CommonControlChevronDown_12})):null)}getDragDropOptions(){const{item:e,itemIndex:t,dragDropEvents:n}=this.props;return{selectionIndex:t,context:{data:e,index:t},canDrag:n.canDrag,onDragStart:n.onDragStart,updateDropState:this.updateDroppingState,onDragEnd:n.onDragEnd}}constructor(e){super(e),this.itemMenuIconRef=R.createRef(),this.rootDiv=R.createRef(),this.rootComponentRef=R.createRef(),this.updateDroppingState=(e,t)=>{},this.getFieldListItemIconName=(e,t)=>{if(e.isMoreFields)return be.a.XLFieldListFieldsOpenIcon_16;switch(e.type){case 11:return t?be.a.XLFieldListWbkTableIcon_16:be.a.XLFieldListDimensionIcon_16;case 19:return be.a.XLFieldListValues_16;case 3:return c.a.Function_16;case 29:case 31:return be.a.XLFieldListKPIIcon_16;case 23:return e.isCollapsed?be.a.Folder_16:be.a.Open_16;case 13:return e.isCollapsed?be.a.XLFieldListSetsClosedIcon_16:be.a.XLFieldListSetsOpenIcon_16;case 66:return be.a.Entity_16;default:return""}},this.onFieldListItemClick=()=>{this.props.item.isCollapsible&&_g.onFieldExpandCollapse(this.props.item.id)},this.onFieldListItemMenuClick=e=>{e.stopPropagation(),this.onFieldListItemMenuClickHelper(this.props.item.id,!1)},this.onFieldListItemMenuClickHelper=(e,t)=>{_g.onFieldListItemMenuClickV2(e,Tg(e),t)},this.onCheckBoxDivClick=e=>{e.stopPropagation()},this.onFieldListItemFocus=()=>{this.isFocused=!0,Rg(this.itemMenuIconRef,!0,!0,!1)},this.onFieldListItemBlur=()=>{this.isFocused=!1,Rg(this.itemMenuIconRef,!0,!1,!1)},this.onFieldListItemMouseEnter=()=>{Rg(this.itemMenuIconRef,!1,!0,!1)},this.onFieldListItemMouseLeave=()=>{Rg(this.itemMenuIconRef,!1,!1,this.isFocused)},this.onFieldListItemKeyDown=e=>{const t=this.props.item;switch(e.key){case"Enter":e.preventDefault(),this.onFieldListItemMenuClickHelper(t.id,!0);break;case"ArrowLeft":case"ArrowRight":case"Left":case"Right":t.isCollapsible&&_g.onFieldExpandCollapse(t.id);break;case"ArrowDown":case"Down":e.altKey&&(e.preventDefault(),this.onFieldListItemMenuClickHelper(t.id,!0));break;case" ":case"Spacebar":e.preventDefault(),t.showCheckBox&&_g.onFieldCheckedChanged(t.id,!t.isChecked)}},this.onCheckboxChange=e=>{_g.onFieldCheckedChanged(this.props.item.id,e.checked)},this.updateItemCheckboxAriaLabel=()=>{const e=`fieldItem_${this.props.item.id}_checkbox`,t=document.querySelector(`input[data-unique-id='${e}-input']`);var n;t&&t.setAttribute("aria-label",null!==(n=this.props.item.name)&&void 0!==n?n:"")},this.isFocused=!1,this.events=new hg.a(this)}}class Dg extends R.PureComponent{render(){return this.props.items?R.createElement(Pl.a,{"data-testid":"fieldList",role:0===this.props.nestingDepth?"tree":"group",items:this.props.items,onRenderCell:this.onRenderFieldListCell}):null}getDragDropEvents(){return{canDrag:e=>!!e&&e.canDrag,onDragStart:e=>{e?this.props.setDragItemInfo(0,e):i.a.sendTraceTag(554297424,a.a.msoulscat_ES_EWAJS,s.a.Error,"FieldList.OnDragStart: field list item is undefined.")},onDragEnd:()=>{this.props.setDragItemInfo(0,null)}}}constructor(e){super(e),this.dragDropHelper=new gg.a({selection:new ku.a}),this.onRenderFieldListCell=(e,t,n)=>{if(e&&"number"==typeof t&&t>-1){const n=e.showSeparator||11===e.type||19===e.type||29===e.type||13===e.type;return R.createElement("div",null,e.isMoreFields?null:R.createElement(wg,{item:e,itemIndex:t,nestingDepth:this.props.nestingDepth,isDataModel:this.props.isDataModel,dragDropEvents:this.dragDropEvents,dragDropHelper:this.dragDropHelper,focusResetId:this.props.focusResetId,isRichPivotFieldList:this.props.isRichPivotFieldList}),(e.isCollapsible&&!e.isCollapsed||e.isMoreFields)&&e.children&&e.children.length>0?R.createElement("div",null,R.createElement(Dg,{items:e.children,nestingDepth:e.isMoreFields?this.props.nestingDepth:this.props.nestingDepth+1,isDataModel:this.props.isDataModel,setDragItemInfo:this.props.setDragItemInfo,getDragItemInfo:this.props.getDragItemInfo,focusResetId:this.props.focusResetId,isRichPivotFieldList:this.props.isRichPivotFieldList})):null,n?R.createElement("div",{className:ng()}):null)}return null},this.dragDropEvents=this.getDragDropEvents()}}class Pg extends R.Component{componentDidMount(){const{dragDropHelper:e}=this.props;e&&this.rootDiv.current?this.dragDropSubscription=e.subscribe(this.rootDiv.current,this.events,this.getDragDropOptions()):i.a.sendTraceTag(554297419,a.a.msoulscat_ES_EWAJS,s.a.Error,"FieldWellItemContainer.ComponentDidMount: root div is null, failed to register drag and drop."),-1!==this.props.focusResetId&&this.props.item.id===this.props.focusResetId&&this.rootComponentRef.current&&this.rootComponentRef.current.focus()}componentDidUpdate(e){this.props.itemIndex===e.itemIndex&&this.props.item===e.item&&this.props.dragDropHelper===e.dragDropHelper||(this.dragDropSubscription&&(this.dragDropSubscription.dispose(),delete this.dragDropSubscription),this.props.dragDropHelper&&this.rootDiv.current&&(this.dragDropSubscription=this.props.dragDropHelper.subscribe(this.rootDiv.current,this.events,this.getDragDropOptions()))),-1!==this.props.focusResetId&&this.props.focusResetId!==e.focusResetId&&this.props.item.id===this.props.focusResetId&&this.rootComponentRef.current&&this.rootComponentRef.current.focus()}componentWillUnmount(){this.dragDropSubscription&&(this.dragDropSubscription.dispose(),delete this.dragDropSubscription),this.events.dispose()}render(){const{item:e}=this.props,t=Eg(this.state.isDraggingOver),n=kg(this.props.type),o=`fieldItem_${e.id}_label`;return R.createElement(Cd.a,{id:"fieldItem_"+e.id,"data-is-focusable":!0,role:"listitem",elementRef:this.rootDiv,componentRef:this.rootComponentRef,className:t.root,"aria-labelledby":`${n} ${o}`,"aria-haspopup":"menu",draggable:!0,allowFocusRoot:!0,onKeyDown:this.onFieldWellItemKeyDown,onFocus:this.onFieldWellItemFocus,onBlur:this.onFieldWellItemBlur,onMouseEnter:this.onFieldWellItemMouseEnter,onMouseLeave:this.onFieldWellItemMouseLeave},R.createElement("div",{id:o,className:t.label+" fieldItemLabel",title:e.name,"aria-hidden":!0},e.name),R.createElement("div",{id:Tg(e.id),"data-testid":"fieldWellItemIcon",role:"button","aria-labelledby":`${n} ${o}`,"aria-haspopup":"menu",className:t.menuIconWrapper+" fieldItemMenuIconWrapper",ref:this.itemMenuIconRef,onClick:this.onFieldWellItemMenuClick},R.createElement(fe.a,{className:t.menuIcon,iconName:be.a.CommonControlChevronDown_12})))}getDragDropOptions(){const{item:e,itemIndex:t,dragDropEvents:n}=this.props;return{selectionIndex:t,context:{data:e,index:t},canDrag:n.canDrag,canDrop:n.canDrop,onDragStart:n.onDragStart,onDragEnd:n.onDragEnd,updateDropState:this.updateDroppingState,onDrop:n.onDrop}}constructor(e){super(e),this.itemMenuIconRef=R.createRef(),this.rootDiv=R.createRef(),this.rootComponentRef=R.createRef(),this.updateDroppingState=(e,t)=>{const{isDraggingOver:n}=this.state;n!==e&&this.setState({isDraggingOver:e})},this.onFieldWellItemMenuClickHelper=(e,t,n)=>{_g.onFieldWellItemMenuClickV2(e,t,Tg(e),n)},this.onFieldWellItemKeyDown=e=>{("Enter"===e.key||("ArrowDown"===e.key||"Down"===e.key)&&e.altKey)&&(e.preventDefault(),this.onFieldWellItemMenuClickHelper(this.props.item.id,this.props.type,!0))},this.onFieldWellItemMenuClick=e=>{this.onFieldWellItemMenuClickHelper(this.props.item.id,this.props.type,!1)},this.onFieldWellItemFocus=()=>{this.isFocused=!0,Rg(this.itemMenuIconRef,!0,!0,!1)},this.onFieldWellItemBlur=()=>{this.isFocused=!1,Rg(this.itemMenuIconRef,!0,!1,!1)},this.onFieldWellItemMouseEnter=()=>{Rg(this.itemMenuIconRef,!1,!0,!1)},this.onFieldWellItemMouseLeave=()=>{Rg(this.itemMenuIconRef,!1,!1,this.isFocused)},this.isFocused=!1,this.events=new hg.a(this),this.state={isDraggingOver:!1}}}class Ig extends R.PureComponent{componentDidMount(){this.emptyRowDiv.current?this.dragDropSubscription=this.dragDropHelper.subscribe(this.emptyRowDiv.current,this.events,this.getEmptyRowDragDropOptions()):i.a.sendTraceTag(554297420,a.a.msoulscat_ES_EWAJS,s.a.Error,"FieldWell.ComponentDidMount: empty row div is null, failed to register drag and drop.")}componentWillUnmount(){this.dragDropSubscription&&(this.dragDropSubscription.dispose(),delete this.dragDropSubscription),this.events.dispose()}render(){const{type:e,items:t}=this.props,n=this.getFieldWellTitleIconName(e),o=Sg(8===this.props.type);return R.createElement("div",{className:o.root,"data-testid":"fieldWell"},R.createElement("div",{className:o.title},""!==n?R.createElement(fe.a,{className:o.titleIcon,iconName:n}):null,R.createElement("div",{id:kg(this.props.type)},this.props.title)),R.createElement("div",{className:o.content+" fieldWellContent",style:yg(this.props.rowsLimitToOverflow)},R.createElement(Cd.a,{direction:qo.a.vertical,isCircularNavigation:!0},t?R.createElement(Pl.a,{role:"list",items:t,onRenderCell:this.onRenderListRow}):null),R.createElement("div",{className:Cg(this.state.isDraggingToEmptyRow,!!t&&t.length>0),ref:this.emptyRowDiv})))}getDragDropEvents(){return{canDrop:()=>!0,canDrag:()=>!0,onDrop:(e,t)=>{null==t||t.stopPropagation(),null==t||t.preventDefault();const n=this.props.getDragItemInfo();if(this.props.setDragItemInfo(0,null),null==e||null==this.props.items)return;if(null==n.dragItem||e.id===n.dragItem.id)return;const o=this.props.items.indexOf(e);_g.onFieldMove(n.dragItem.id,n.dragItemSourceAxis,this.props.type,o)},onDragStart:e=>{e?this.props.setDragItemInfo(this.props.type,e):i.a.sendTraceTag(554297421,a.a.msoulscat_ES_EWAJS,s.a.Error,"FieldWell.OnDragStart: field well item is undefined.")},onDragEnd:()=>{this.props.setDragItemInfo(0,null)}}}getEmptyRowDragDropOptions(){return{selectionIndex:0,context:{data:null,index:0},canDrop:this.canFieldWellEmptyRowDrop,onDrop:this.onFieldWellEmptyRowDrop,updateDropState:this.updateFieldWellEmptyRowDroppingState}}constructor(e){super(e),this.dragDropHelper=new gg.a({selection:new ku.a}),this.emptyRowDiv=R.createRef(),this.getFieldWellTitleIconName=e=>{switch(e){case 4:return be.a.XLFieldListFilter_16;case 1:return be.a.XLFieldListRows_16;case 2:return be.a.XLFieldListColumns_16;case 8:return be.a.XLFieldListValues_16;default:return""}},this.onRenderListRow=(e,t,n)=>e&&"number"==typeof t&&t>-1?R.createElement(Pg,{item:e,itemIndex:t,type:this.props.type,focusResetId:this.props.focusResetId,dragDropEvents:this.dragDropEvents,dragDropHelper:this.dragDropHelper}):null,this.canFieldWellEmptyRowDrop=()=>!0,this.onFieldWellEmptyRowDrop=(e,t)=>{null==t||t.stopPropagation(),null==t||t.preventDefault();const n=this.props.getDragItemInfo();if(this.props.setDragItemInfo(0,null),null==this.props.items)return;const o=this.props.items.length;null==n.dragItem||o>0&&this.props.items[o-1].id===n.dragItem.id||_g.onFieldMove(n.dragItem.id,n.dragItemSourceAxis,this.props.type,this.props.items.length)},this.updateFieldWellEmptyRowDroppingState=(e,t)=>{const{isDraggingToEmptyRow:n}=this.state;n!==e&&this.setState({isDraggingToEmptyRow:e})},this.dragDropEvents=this.getDragDropEvents(),this.state={isDraggingToEmptyRow:!1},this.events=new hg.a(this)}}const Fg=Object(Jo.c)(e=>Object(F.db)({root:{display:"flex",flex:"1",flexDirection:"row",height:"100%",overflow:"hidden",paddingBottom:"16px"},fieldListWithSearchArea:{flex:"1",display:"flex",flexDirection:"column"},fieldListArea:{background:"#FFFFFF",border:"1px solid #b0b0b0",borderRadius:"2px",boxSizing:"border-box",flex:"1",overflowY:"auto",display:"flex",flexDirection:"column"},fieldWellsArea:{overflowY:"hidden",flex:"1",marginTop:e?"4px":0},resizeBar:{width:"10px",cursor:"col-resize",boxSizing:"border-box",selectors:{":focus-visible":{outline:"1px solid #605E5C",outlineOffset:"-2px"}}},noMatchArea:{flex:"1",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px"}}));var Bg=n(1629);const Mg={root:[Xp,{height:"24px",marginBottom:"4px"}],icon:{height:"16px",width:"16px"},field:{fontSize:"12px",padding:0},clearButton:{selectors:{[F.m]:{selectors:{"button:hover, button:focus":{backgroundColor:"Highlight !important"}}}}}};class jg extends R.PureComponent{static getDerivedStateFromProps(e,t){return t.savedProps!==e?e.needSearchRestore?{value:e.searchRestoreValue,savedProps:e}:e.needSearchReset?{value:"",savedProps:e}:{savedProps:e}:null}render(){return R.createElement(Bg.a,{id:"fieldListSearchbox",placeholder:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FieldListSearch),ariaLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FieldListSearchDescription),autoComplete:"off",onChange:this.onSearchChange,value:this.state.value,styles:Mg,iconProps:Object(mi.a)(c.a.Search_20),clearButtonProps:{title:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FieldListSearchClear),ariaLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FieldListSearchClear),iconProps:Object(mi.a)(c.a.CancelGlyph_16)}})}constructor(e){super(e),this.onSearchChange=(e,t)=>{this.state.value!==t&&(_g.onSearchInputChanged(t||""),this.setState({value:t||""}))},this.state={value:"",savedProps:this.props}}}class Og{register(e,t){if(this.observer=new ResizeObserver(t),this.observer)for(let t=0;t<e.length;t+=1)this.observer.observe(e[t])}dispose(){this.observer&&(this.observer.disconnect(),delete this.observer)}}class Lg extends R.Component{componentWillUnmount(){document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("dragover",this.onDocumentDragOver),document.removeEventListener("drop",this.onDocumentDrop),this.resizeObserver&&this.resizeObserver.dispose(),this.dragDropSubscription&&(this.dragDropSubscription.dispose(),delete this.dragDropSubscription),this.events.dispose(),_g.onSaveFieldListSizePercentage(this.fieldListSizePercentage)}componentDidMount(){if(document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp),document.addEventListener("dragover",this.onDocumentDragOver),document.addEventListener("drop",this.onDocumentDrop),this.fieldListRef.current?this.dragDropSubscription=this.dragDropHelper.subscribe(this.fieldListRef.current,this.events,this.getFieldListAreaDragDropOptions()):i.a.sendTraceTag(554297425,a.a.msoulscat_ES_EWAJS,s.a.Error,"DragDropArea.ComponentDidMount: field list ref is null, failed to register drag and drop."),this.fieldListWithSearchRef.current&&(this.fieldListWithSearchRef.current.style.flex="none",this.fieldListWithSearchRef.current.style.width=`calc((100% - 10px) *${this.fieldListSizePercentage})`),null==this.state.fieldWellsRef.current)return void i.a.sendTraceTag(554297426,a.a.msoulscat_ES_EWAJS,s.a.Error,"DragDropArea.ComponentDidMount: field wells ref is null, failed to register resize observer.");if(this.fieldWellAreaHeight=this.state.fieldWellsRef.current.offsetHeight,this.resizeObserver.register([this.state.fieldWellsRef.current],()=>{window.requestAnimationFrame(()=>{if(null==this.state.fieldWellsRef.current)return;const e=this.state.fieldWellsRef.current.offsetHeight;if(e!==this.fieldWellAreaHeight){this.fieldWellAreaHeight=e;const t=this.props.fieldWellsItems;if(t){const e=vg(this.state.fieldWellsRef,t.filtersWellItems.length,t.columnsWellItems.length,t.rowsWellItems.length,t.valuesWellItems.length);this.setState({filterWellRowsLimit:e[0],columnsWellRowsLimit:e[1],rowsWellRowsLimit:e[2],valuesWellRowsLimit:e[3]})}}})}),null==this.props.fieldWellsItems)return;const e=this.props.fieldWellsItems.filtersWellItems.length,t=this.props.fieldWellsItems.columnsWellItems.length,n=this.props.fieldWellsItems.rowsWellItems.length,o=this.props.fieldWellsItems.valuesWellItems.length,r=vg(this.state.fieldWellsRef,e,t,n,o);this.setState({filterWellRowsLimit:r[0],columnsWellRowsLimit:r[1],rowsWellRowsLimit:r[2],valuesWellRowsLimit:r[3],filtersWellItemsLength:e,columnsWellItemsLength:t,rowsWellItemsLength:n,valuesWellItemsLength:o})}static getDerivedStateFromProps(e,t){const n=e.fieldWellsItems;if(null==n||null==t.fieldWellsRef.current)return null;const o=n.filtersWellItems.length,r=n.columnsWellItems.length,i=n.rowsWellItems.length,a=n.valuesWellItems.length;if(t.filtersWellItemsLength===o&&t.columnsWellItemsLength===r&&t.rowsWellItemsLength===i&&t.valuesWellItemsLength===a)return null;const s=vg(t.fieldWellsRef,o,r,i,a);return{filterWellRowsLimit:s[0],columnsWellRowsLimit:s[1],rowsWellRowsLimit:s[2],valuesWellRowsLimit:s[3],filtersWellItemsLength:o,columnsWellItemsLength:r,rowsWellItemsLength:i,valuesWellItemsLength:a}}render(){const e=Fg(_g.isV2Enabled),t={setDragItemInfo:this.setDragItemInfo,getDragItemInfo:this.getDragItemInfo},{fieldListItems:n,fieldWellsItems:o}=this.props;return R.createElement("div",{className:e.root,ref:this.dragDropAreaRef,"data-testid":"DragDropArea"},R.createElement("div",{className:e.fieldListWithSearchArea,ref:this.fieldListWithSearchRef},_g.isV2Enabled?R.createElement(jg,{searchRestoreValue:this.props.fieldListSearchInfo&&this.props.fieldListSearchInfo.searchRestoreValue?this.props.fieldListSearchInfo.searchRestoreValue:"",needSearchRestore:!!this.props.fieldListSearchInfo&&this.props.fieldListSearchInfo.needSearchRestore,needSearchReset:!!this.props.fieldListSearchInfo&&this.props.fieldListSearchInfo.needSearchReset}):null,R.createElement("div",{className:e.fieldListArea,ref:this.fieldListRef},_g.isV2Enabled&&this.props.fieldListSearchInfo&&this.props.fieldListSearchInfo.searchWithNoMatch?R.createElement("div",{id:"fieldListSearchNoMatch",className:e.noMatchArea,"data-testid":"fieldListSearchNoMatch"},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FieldListSearchNoMatches)):R.createElement(Cd.a,{direction:qo.a.vertical,isCircularNavigation:!0},R.createElement(Dg,_object_spread_props(_object_spread({items:n,nestingDepth:0,isDataModel:this.props.isDataModel,focusResetId:this.props.fieldListFocusResetId},t),{isRichPivotFieldList:this.props.isRichPivotFieldList}))))),R.createElement("div",{id:"fieldListResizeBar",className:e.resizeBar,"data-testid":"fieldListResizeBar",tabIndex:0,role:"button","aria-label":ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FieldListResizeAriaLabel),onMouseDown:this.onResizeBarMouseDown,onKeyDown:this.onResizeBarKeyDown}),R.createElement("div",{className:e.fieldWellsArea,ref:this.state.fieldWellsRef},R.createElement(Ig,_object_spread({type:4,title:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FieldListFilters),rowsLimitToOverflow:this.state.filterWellRowsLimit,items:o?o.filtersWellItems:null,focusResetId:this.props.fieldWellFocusResetId},t)),R.createElement(Ig,_object_spread({type:1,title:this.props.isPivotChart?ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FieldListPivotChartRows):ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FieldListRows),rowsLimitToOverflow:this.state.rowsWellRowsLimit,items:o?o.rowsWellItems:null,focusResetId:this.props.fieldWellFocusResetId},t)),R.createElement(Ig,_object_spread({type:2,title:this.props.isPivotChart?ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FieldListPivotChartColumns):ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FieldListColumns),rowsLimitToOverflow:this.state.columnsWellRowsLimit,items:o?o.columnsWellItems:null,focusResetId:this.props.fieldWellFocusResetId},t)),R.createElement(Ig,_object_spread({type:8,title:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FieldListValues),rowsLimitToOverflow:this.state.valuesWellRowsLimit,items:o?o.valuesWellItems:null,focusResetId:this.props.fieldWellFocusResetId},t))),R.createElement(Sd.a,{"aria-live":"polite",message:this.state.resizeStatusMessage}))}getFieldListAreaDragDropOptions(){return{selectionIndex:0,context:{data:null,index:0},canDrop:this.canFieldListAreaDrop,onDrop:this.onFieldListAreaDrop,updateDropState:this.updateDroppingState}}constructor(e){super(e),this.fieldListWithSearchRef=R.createRef(),this.fieldListRef=R.createRef(),this.dragDropAreaRef=R.createRef(),this.dragDropHelper=new gg.a({selection:new ku.a}),this.setDragItemInfo=(e,t)=>{this.dragItemInfo={dragItemSourceAxis:e,dragItem:t}},this.getDragItemInfo=()=>this.dragItemInfo,this.canFieldListAreaDrop=()=>!0,this.onFieldListAreaDrop=(e,t)=>{null==t||t.stopPropagation(),null==t||t.preventDefault();const n=this.getDragItemInfo();this.setDragItemInfo(0,null),null!=n.dragItem&&0!==n.dragItemSourceAxis&&_g.onFieldMove(n.dragItem.id,n.dragItemSourceAxis,0,0)},this.updateDroppingState=(e,t)=>{},this.elementInFieldListOrWellContentArea=e=>{if(null==e)return!1;if(this.fieldListRef.current&&this.fieldListRef.current.contains(e))return!0;const t=document.getElementsByClassName("fieldWellContent");for(let n=0;n<t.length;n+=1)if(t[n].contains(e))return!0;return!1},this.onDocumentDragOver=e=>{if(null!=e.target&&this.elementInFieldListOrWellContentArea(e.target))return;const t=this.getDragItemInfo();null!=t.dragItem&&0!==t.dragItemSourceAxis&&(e.stopPropagation(),e.preventDefault())},this.onDocumentDrop=e=>{if(null!=e.target&&this.elementInFieldListOrWellContentArea(e.target))return;const t=this.getDragItemInfo();this.setDragItemInfo(0,null),null!=t.dragItem&&0!==t.dragItemSourceAxis&&(e.stopPropagation(),e.preventDefault(),_g.onFieldMove(t.dragItem.id,t.dragItemSourceAxis,0,0))},this.updateFieldListWidth=(e,t)=>{if(null==this.fieldListWithSearchRef.current||null==this.dragDropAreaRef.current)return void i.a.sendTraceTag(554297427,a.a.msoulscat_ES_EWAJS,s.a.Error,"DragDropArea.UpdateFieldListWidth: field list or drag drop area ref is null, failed to resize.");let n=(Object(ue.a)()?this.fieldListWithSearchRef.current.offsetWidth-e:this.fieldListWithSearchRef.current.offsetWidth+e)/(this.dragDropAreaRef.current.offsetWidth-10);if(n=Number(n.toFixed(2)),n<.3&&(n=.3),n>.7&&(n=.7),this.fieldListSizePercentage=n,this.fieldListWithSearchRef.current.style.flex="none",this.fieldListWithSearchRef.current.style.width=`calc((100% - 10px) *${n})`,t){const e=(100*n).toString();let t="";t=.3===n?ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FieldListResizeMinPercentage).replace("{0}",e):.7===n?ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FieldListResizeMaxPercentage).replace("{0}",e):ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FieldListResizeCurrentPercentage).replace("{0}",e),this.setState({resizeStatusMessage:t})}},this.onResizeBarKeyDown=e=>{"ArrowLeft"===e.key||"Left"===e.key?this.updateFieldListWidth(-10,!0):"ArrowRight"!==e.key&&"Right"!==e.key||this.updateFieldListWidth(10,!0)},this.onResizeBarMouseDown=e=>{this.resizeBarXPosition=e.clientX},this.onMouseMove=e=>{if(null==this.resizeBarXPosition)return;const t=e.clientX-this.resizeBarXPosition;this.resizeBarXPosition=e.clientX,this.updateFieldListWidth(t,!1)},this.onMouseUp=()=>{null!=this.resizeBarXPosition&&(this.resizeBarXPosition=null)},this.dragItemInfo={dragItemSourceAxis:0,dragItem:null},this.events=new hg.a(this),this.resizeBarXPosition=null,this.resizeObserver=new Og,this.fieldWellAreaHeight=0,this.fieldListSizePercentage=e.fieldListSizePercentage,this.state={filterWellRowsLimit:-1,columnsWellRowsLimit:-1,rowsWellRowsLimit:-1,valuesWellRowsLimit:-1,filtersWellItemsLength:-1,columnsWellItemsLength:-1,rowsWellItemsLength:-1,valuesWellItemsLength:-1,fieldWellsRef:R.createRef(),resizeStatusMessage:""}}}const Ag=[{key:1,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FieldListDisplayActive)},{key:0,text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FieldListDisplayAll)}];class Ng extends R.Component{static getDerivedStateFromProps(e){return 0===e.dataUpdateType?{fieldListItems:e.fieldListItems,isDataModel:e.isDataModel,isSortAscending:e.isSortAscending,selectedTab:e.selectedTab,isLoadingData:!1,fieldListFocusResetId:2===e.focusResetType?e.focusResetId:-1,isRichPivotFieldList:e.isRichPivotFieldList,fieldListSearchInfo:e.fieldListSearchInfo}:1===e.dataUpdateType?{fieldWellsItems:e.fieldWellsItems,isLoadingData:!1,fieldWellFocusResetId:3===e.focusResetType?e.focusResetId:-1}:null}componentDidUpdate(e){if(1===this.props.focusResetType&&this.props.focusResetId!==e.focusResetId){const e=this.state.isDataModel?"fieldListAllActiveDropdown":"fieldListToolsButton",t=document.getElementById(e);null==t||t.focus()}}render(){var e;const t=eg();return this.state.isLoadingData?R.createElement("div",{id:"fieldListLoadSpinner",className:t.spinnerContainer,"data-testid":"fieldListLoadSpinner"},R.createElement(Jp.a,{size:Yp.a.large})):R.createElement("div",{className:t.root},R.createElement("div",{className:t.description},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FieldListDragDropAreaDescription)),R.createElement("div",{className:t.controlGroup},this.state.isDataModel?R.createElement(Lt.a,{id:"fieldListAllActiveDropdown","data-testid":"fieldListAllActiveDropdown",ariaLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FieldListDisplayModeAriaLabel),options:Ag,styles:tg,selectedKey:this.state.selectedTab,onChange:this.onDropdownOptionChanged,onRenderCaretDown:this.onDropDownRenderCaretDown}):null,R.createElement(Ee.a,{content:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FieldListTools),directionalHint:Se.a.bottomCenter},R.createElement(vd.a,{id:"fieldListToolsButton","data-testid":"fieldListToolsButton",iconProps:Object(mi.a)(be.a.Gear_20),ariaLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FieldListTools),menuProps:this.getToolsButtonMenuProps(),menuIconProps:Object(mi.a)(be.a.CommonControlChevronDown_12),styles:ag}))),R.createElement(Lg,{fieldListItems:this.state.fieldListItems,fieldWellsItems:this.state.fieldWellsItems,isDataModel:this.state.isDataModel,isPivotChart:this.props.isPivotChart,fieldListSizePercentage:null!==(e=this.props.fieldListSizePercentage)&&void 0!==e?e:.5,fieldListFocusResetId:this.state.fieldListFocusResetId,fieldWellFocusResetId:this.state.fieldWellFocusResetId,isRichPivotFieldList:this.state.isRichPivotFieldList,fieldListSearchInfo:this.state.fieldListSearchInfo}))}constructor(e){super(e),this.onDropDownRenderCaretDown=()=>R.createElement(fe.a,{iconName:be.a.CommonControlChevronDown_12,styles:cg}),this.onDropdownOptionChanged=(e,t)=>{t?_g.onSelectedTabChanged(Number(t.key)):i.a.sendTraceTag(554297422,a.a.msoulscat_ES_EWAJS,s.a.Error,"FieldListTaskPane.OnDropdownOptionChanged: selected dropdown option is undefined.")},this.getToolsButtonMenuProps=()=>({calloutProps:{styles:lg},items:[{id:"fieldListExpandAll",key:"fieldListExpandAll",text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FieldListExpandAll),disabled:!this.props.isOlap&&!this.state.isRichPivotFieldList,itemProps:{styles:sg},onClick:this.onExpandAllExecute},{id:"fieldListCollapseAll",key:"fieldListCollapseAll",text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FieldListCollapseAll),disabled:!this.props.isOlap&&!this.state.isRichPivotFieldList,styles:sg,itemProps:{styles:sg},onClick:this.onCollapseAllExecute},{key:"fieldListToolsButtonMenuDivider",itemType:Go.a.Divider},{id:"fieldListSortAscending",key:"fieldListSortAscending",text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FieldListSortAscending),iconProps:this.props.isOlap&&!this.state.isDataModel||!this.state.isSortAscending?void 0:Object(mi.a)(Po.a.checkboxCheckmark),disabled:this.props.isOlap&&!this.state.isDataModel,canCheck:!this.props.isOlap||this.state.isDataModel,checked:(!this.props.isOlap||this.state.isDataModel)&&this.state.isSortAscending,itemProps:{styles:sg},onClick:this.onSortAscendingExecute},{id:"fieldListSortInDataSource",key:"fieldListSortInDataSource",text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FieldListSortInDataSourceOrder),iconProps:this.props.isOlap&&!this.state.isDataModel||this.state.isSortAscending?void 0:Object(mi.a)(Po.a.checkboxCheckmark),disabled:this.props.isOlap&&!this.state.isDataModel,canCheck:!this.props.isOlap||this.state.isDataModel,checked:(!this.props.isOlap||this.state.isDataModel)&&!this.state.isSortAscending,itemProps:{styles:sg},onClick:this.onSortInDataSourceExecute}]}),this.onExpandAllExecute=()=>{_g.onExpandCollapseAll(!0)},this.onCollapseAllExecute=()=>{_g.onExpandCollapseAll(!1)},this.onSortAscendingExecute=()=>{_g.onSortOrderChanged(!0)},this.onSortInDataSourceExecute=()=>{_g.onSortOrderChanged(!1)},this.state={fieldListItems:null,fieldWellsItems:null,isDataModel:!1,isSortAscending:!1,selectedTab:-1,isLoadingData:!0,fieldListFocusResetId:-1,fieldWellFocusResetId:-1,isRichPivotFieldList:!1,fieldListSearchInfo:null},_g.updateData(e,Object($c.h)("PivotTableReactFieldListV2"))}}const Wg={fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif'},zg={fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',color:"#252423"},Hg={fontSize:"12px",fontWeight:400},Vg={paddingTop:"4px",paddingBottom:"4px"},Ug={marginTop:0,marginBottom:"4px"},Gg={marginTop:"4px",marginBottom:"24px"},qg={fontSize:"12px",fontWeight:600,marginBottom:"4px"},Qg={marginTop:"4px",marginBottom:"16px"},Kg={marginTop:"16px",marginBottom:"16px"},Jg=Object(Jo.c)(()=>Object(F.db)({firstRoot:[Qg],root:[Kg],label:[qg,Vg,zg]})),Yg=Object(Jo.c)(()=>Object(F.eb)({marginBottom:"24px"})),Zg=Object(Jo.c)(()=>Object(F.eb)([Hg,Vg,zg])),$g=Object(Jo.c)(()=>Object(F.eb)({height:"100%",paddingLeft:"16px",paddingRight:"16px",overflowY:"auto"})),Xg=Object(Jo.c)(e=>({root:{height:"32px",backgroundColor:"transparent",borderColor:"transparent",padding:0,width:"100%",selectors:{[F.m]:{selectors:{"&[aria-expanded='true'] svg > path.OfficeIconColors_HighContrast":{fill:"ButtonText"}}}}},rootHovered:{selectors:{[F.m]:{selectors:{"svg > path.OfficeIconColors_HighContrast":{fill:"HighlightText"}}}}},rootFocused:{selectors:{[F.m]:{selectors:{"svg > path.OfficeIconColors_HighContrast":{fill:"HighlightText"}}}}},icon:{height:"100%",width:"12px",flexShrink:0},label:[Wg,{fontSize:"14px",fontWeight:e?400:600,marginRight:0}]})),eh=Object(Jo.c)(e=>Object(F.eb)([Gg,{marginLeft:"20px",display:e?"block":"none"}])),th=Object(Jo.c)(e=>Object(F.eb)([Gg,{width:"250px",marginLeft:"20px",display:e?"block":"none"}])),nh=Object(Jo.c)(()=>Object(F.eb)([Hg,zg,Qg,{paddingTop:0,paddingBottom:0}]));class oh extends R.PureComponent{componentWillUnmount(){this.props.onSaveSectionCollapseState&&this.props.onSaveSectionCollapseState(this.props.type,this.state.isCollapsed)}render(){return R.createElement(Ys.b,{type:"AppButtonProps",label:this.props.displayName,id:"sectionHeader_"+this.props.divId,onExecute:this.onToggleDisplay,ariaExpanded:!this.state.isCollapsed,styles:Xg(this.state.isCollapsed),icon:this.state.isCollapsed?Object(ue.a)()?c.a.CommonControlChevronLeft_12:c.a.CommonControlChevronRight_12:c.a.CommonControlChevronDownGlyph_12})}onToggleDisplay(){const e=this.props.divId,t=document.getElementById(e);null!==t&&("none"===window.getComputedStyle(t).display?(t.style.display="block",this.setState({isCollapsed:!1})):(t.style.display="none",this.setState({isCollapsed:!0})))}constructor(e){super(e),this.state={isCollapsed:e.collapse},this.onToggleDisplay=this.onToggleDisplay.bind(this)}}var rh=n(132),ih=n(103);const ah=Object(Jo.c)(e=>t=>{const{disabled:n,focused:o,multiline:r,theme:i}=t,a=Object(ih.a)(i);return Object(F.db)({root:{selectors:{"input[type=text]":{padding:"0 8px"},"&& label":{cursor:"auto"}}},wrapper:{},fieldGroup:[{backgroundColor:a.inputBackgroundColor,height:24,border:"1px solid "+a.inputBorderColor,borderRadius:2},r&&{height:"auto",minHeight:72},!o&&!n&&{selectors:{":hover":{borderColor:a.textFieldHoverBorderColor}}},o&&{borderColor:a.inputFocusBorderColor},n&&{backgroundColor:a.disabledBackgroundColor,borderColor:a.inputBorderColor}],field:[{fontSize:12,height:16,marginTop:3,padding:"0 8px",color:a.inputTextColor,selectors:{"::selection":{backgroundColor:a.inputSelectionBackgroundColor,color:a.inputSelectionTextColor}}},n&&{color:a.inputTextDisabledColor,selectors:{"::placeholder":{color:a.inputTextDisabledColor,opacity:1},":-ms-input-placeholder":{color:a.inputTextDisabledColor,opacity:1}}}],icon:{},description:{},errorMessage:{},prefix:{},suffix:{},subComponentStyles:{label:{root:[{fontWeight:600,fontSize:12},n&&{color:a.textFieldLabelColor}]}}},e)}),sh=Object(rh.a)(),lh=R.forwardRef((e,t)=>R.createElement(Xd.a,_object_spread_props(_object_spread({},e),{styles:ah(sh(e.styles)),ref:t}))),ch={root:[Ug],subComponentStyles:{label:{root:[Vg,zg]}},field:[Wg]};class uh extends R.PureComponent{static getDerivedStateFromProps(e,t){return t.savedProps!==e?{value:e.value,savedProps:e}:null}componentDidUpdate(e){this.props!==e&&(this.lastCommitValue=this.props.value,this.currentValue=this.props.value)}render(){const e={role:"textbox",id:this.props.id,value:this.state.value,multiline:this.props.multiline,disabled:this.props.disabled,styles:ch,onChange:this.onTextChange,onBlur:this.onTextBlur,onKeyDown:this.onKeyDown};return R.createElement(lh,_object_spread({type:"AppInputProps",label:this.props.label,hideLabel:this.props.hideLabel},e))}onTextChange(e){this.currentValue=e||"",this.setState({value:e||""})}commitCurrentValue(){this.currentValue!==this.lastCommitValue&&null!=this.currentValue&&(this.props.onSettingChange?(this.lastCommitValue=this.currentValue,this.props.onSettingChange(this.props.actionType,this.currentValue,0)):this.props.onSettingChangeWithFloatV2?(this.lastCommitValue=this.currentValue,this.props.onSettingChangeWithFloatV2(this.props.actionType,this.currentValue,0,0,null)):this.props.onSettingChangeWithFloat&&(this.lastCommitValue=this.currentValue,this.props.onSettingChangeWithFloat(this.props.actionType,this.currentValue,0,0)))}onTextBlur(){this.commitCurrentValue()}onKeyDown(e){"Enter"===e.key&&(e.preventDefault(),this.commitCurrentValue())}constructor(e){super(e),this.state={value:this.props.value,savedProps:this.props},this.lastCommitValue=this.props.value,this.currentValue=this.props.value,this.onTextChange=this.onTextChange.bind(this),this.onTextBlur=this.onTextBlur.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.commitCurrentValue=this.commitCurrentValue.bind(this)}}class dh extends R.PureComponent{render(){return R.createElement("div",null,R.createElement(oh,{displayName:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsAltTextSectionHeader),divId:"altTextSection",paneId:"pivotTableSettings",collapse:this.props.isCollapsed,type:this.props.type,onSaveSectionCollapseState:this.props.onSaveSectionCollapseState}),R.createElement("div",{id:"altTextSection",className:eh(!this.props.isCollapsed)},R.createElement(jt.a,{className:nh()},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsAltTextSectionDescription)),R.createElement(uh,{id:"altText",label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsAltTextTitle),hideLabel:!1,value:this.props.altText,multiline:!1,disabled:!1,actionType:16,onSettingChange:this.props.onSettingChange,needCommit:this.props.isRangeChanged}),R.createElement(uh,{id:"altTextSummary",label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsAltTextDescription),hideLabel:!1,value:this.props.altTextSummary,multiline:!0,disabled:!1,actionType:17,onSettingChange:this.props.onSettingChange,needCommit:this.props.isRangeChanged})))}constructor(e){super(e)}}const ph={root:[Ug,{paddingLeft:"3px",paddingRight:"3px",marginRight:"4px"}],rootFocused:{borderColor:"#605E5C"},rootDisabled:{borderColor:"#BEBBB8"},label:[Wg]};class gh extends R.PureComponent{render(){return R.createElement(Ys.b,{type:"AppButtonProps",label:this.props.label,id:this.props.id,styles:ph,onExecute:this.onButtonClick,disabled:this.props.disabled})}onButtonClick(){this.props.onSettingChange&&this.props.onSettingChange(this.props.actionType,"",this.props.valueToSet)}constructor(e){super(e),this.onButtonClick=this.onButtonClick.bind(this)}}const hh={root:[Ug,{height:"auto",lineHeight:"normal",minHeight:"24px",paddingLeft:0,paddingRight:0}],checkbox:{background:"#FFFFFF"},label:[Wg]};class mh extends R.PureComponent{render(){return R.createElement(bg,{type:"AppCheckboxProps",label:this.props.label,id:this.props.id,styles:hh,checked:this.props.checked,checkmarkIcon:Po.a.checkboxCheckmark,onExecute:this.onCheckboxExecute,disabled:this.props.disabled})}onCheckboxChange(e){this.props.onSettingChange?this.props.onSettingChange(this.props.actionType,"",Number(e)):this.props.onSettingChangeWithFloatV2?this.props.onSettingChangeWithFloatV2(this.props.actionType,null,Number(e),0,null):this.props.onSettingChangeWithFloat&&this.props.onSettingChangeWithFloat(this.props.actionType,"",Number(e),0)}onCheckboxExecute(e){this.onCheckboxChange(e.checked)}constructor(e){super(e),this.onCheckboxChange=this.onCheckboxChange.bind(this),this.onCheckboxExecute=this.onCheckboxExecute.bind(this)}}class bh extends R.PureComponent{render(){const e=Jg();return R.createElement("div",null,R.createElement(oh,{displayName:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsGrandSubTotalsSectionHeader),divId:"grandTotalsAndSubtotals",paneId:"pivotTableSettings",collapse:this.props.isCollapsed,type:this.props.type,onSaveSectionCollapseState:this.props.onSaveSectionCollapseState}),R.createElement("div",{id:"grandTotalsAndSubtotals",className:eh(!this.props.isCollapsed)},R.createElement("div",{className:e.firstRoot},R.createElement(jt.a,{className:e.label},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsGrandTotalsGroupHeader)),R.createElement(mh,{label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsGrandTotalsShowForRows),id:"rwGrandTotalOn",checked:this.props.rwGrandTotalOn,actionType:2,onSettingChange:this.props.onSettingChange,disabled:!1}),R.createElement(mh,{label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsGrandTotalsShowForColumns),id:"colGrandTotalOn",checked:this.props.colGrandTotalOn,actionType:3,onSettingChange:this.props.onSettingChange,disabled:!1})),R.createElement("div",{className:e.root},R.createElement(jt.a,{className:e.label},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsSubTotalsGroupHeader)),R.createElement(gh,{label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsSubTotalsDoNotShow),id:"subTotalsDoNotShow",actionType:18,valueToSet:0,onSettingChange:this.props.onSettingChange,disabled:this.props.hasLessThanTwoRowFields}),R.createElement(gh,{label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsSubTotalsShowOnTop),id:"subTotalsShowOnTop",actionType:18,valueToSet:1,onSettingChange:this.props.onSettingChange,disabled:this.props.hasLessThanTwoRowFields}),R.createElement(gh,{label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsSubTotalsShowOnBottom),id:"subTotalsShowOnBottom",actionType:18,valueToSet:2,onSettingChange:this.props.onSettingChange,disabled:this.props.hasLessThanTwoRowFields}))))}constructor(e){super(e)}}const fh=Object(Jo.c)(e=>({root:[Ug,{height:"auto",display:e?"flex":"block",padding:0,overflow:"auto"}],spinButtonWrapper:{width:e?"80px":"42px",minWidth:e?"80px":"42px",height:"24px",boxSizing:"border-box"},label:[Hg,zg,{paddingTop:0,paddingBottom:0,lineHeight:"normal"}],labelWrapper:[{height:"auto",minHeight:"24px",width:e?"calc(100% - 80px)":"calc(100% - 46px)"},e?{marginRight:0}:{marginLeft:0}]})),xh=Object(Jo.c)((e,t,n,o)=>[{unitType:e,unitPlaceholder:"Inch"===e?'{0}"':"{0}",minValue:t,maxValue:n,step:o}]),Eh=Object(Jo.c)(e=>({negativeSign:"-",numberDecimalDigits:e,numberDecimalSeparator:".",numberNegativePattern:1,numberGroupSeparator:",",numberGroupSizes:[3]}));var Sh=n(2457);const yh=Object(Jo.c)(e=>Object(F.I)({root:{paddingLeft:0},spinButtonWrapper:{borderRadius:2,marginLeft:0,marginRight:0}},e)),Ch=R.forwardRef((e,t)=>{const n=Object(Sh.a)(gl.a.Small,yh(e.styles));return R.createElement(fc.a,_object_spread_props(_object_spread({},e),{ref:t,styles:n.spinButtonStyles,buttonStyles:n.buttonStyles}))});class vh extends R.PureComponent{static getDerivedStateFromProps(e,t){return t.savedProps!==e?{value:e.value,savedProps:e}:null}render(){return R.createElement(Ch,{type:"AppSpinButtonProps",id:this.props.id,label:this.props.label,labelPosition:this.props.labelOnLeft?mc.a.start:mc.a.end,validUnits:xh(this.props.unit,this.props.min,this.props.max,this.props.step),incrementButtonIcon:c.a.CommonControlChevronUp_8,incrementAriaLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SpinnerIncrementButtonAriaLabel),decrementButtonIcon:c.a.CommonControlChevronDown_8,decrementAriaLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SpinnerDecrementButtonAriaLabel),onExecute:this.onExecuteSpinButton,unitType:this.props.unit,value:this.state.value,numberFormatInfo:Eh(this.props.precision),disabled:this.props.disabled,styles:fh(this.props.labelOnLeft)})}processFloat(e,t){return parseFloat(this.toFixedHelper(e,t))}toFixedHelper(e,t){return(Math.round(e*Math.pow(10,t))/Math.pow(10,t)).toFixed(t)}constructor(e){super(e),this.onExecuteSpinButton=e=>{if("number"!=typeof e.value)return;const t=this.props.isInteger?Math.round(e.value):this.processFloat(e.value,this.props.precision);this.props.onSettingChange?(this.props.onSettingChange(this.props.actionType,"",t),this.setState({value:e.value})):this.props.onSettingChangeWithFloatV2?(this.props.onSettingChangeWithFloatV2(this.props.actionType,null,this.props.isInteger?t:0,this.props.isInteger?0:t,null),this.setState({value:t})):this.props.onSettingChangeWithFloat&&(this.props.onSettingChangeWithFloat(this.props.actionType,"",this.props.isInteger?t:0,this.props.isInteger?0:t),this.setState({value:t}))},this.state={value:this.props.value,savedProps:this.props}}}class Rh extends R.PureComponent{render(){const e=Jg();return R.createElement("div",null,R.createElement(oh,{displayName:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsLayoutSectionHeader),divId:"layoutSection",paneId:"pivotTableSettings",collapse:this.props.isCollapsed,type:this.props.type,onSaveSectionCollapseState:this.props.onSaveSectionCollapseState}),R.createElement("div",{id:"layoutSection",className:eh(!this.props.isCollapsed)},R.createElement("div",{className:e.firstRoot},R.createElement(jt.a,{className:e.label},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsLayoutColumnsGroupHeader)),R.createElement(gh,{label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsLayoutColumnsSeparate),id:"compactOff",actionType:19,valueToSet:0,onSettingChange:this.props.onSettingChange,disabled:this.props.hasLessThanTwoRowFields}),R.createElement(gh,{label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsLayoutCompact),id:"compactOn",actionType:19,valueToSet:1,onSettingChange:this.props.onSettingChange,disabled:this.props.hasLessThanTwoRowFields}),R.createElement(vh,{id:"indentIncrement",value:this.props.indentIncrement,min:0,max:127,step:1,stepPrecision:0,label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsLayoutCompactIndent),labelOnLeft:!1,disabled:this.props.hasLessThanTwoRowFields,isInteger:!0,precision:0,unit:"None",actionType:20,onSettingChange:this.props.onSettingChange,needCommit:this.props.isRangeChanged})),R.createElement("div",{className:e.root},R.createElement(jt.a,{className:e.label},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsLayoutItemLabelsGroupHeader)),R.createElement(gh,{label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsLayoutRepeatLabels),id:"repeatLabelOn",actionType:4,valueToSet:1,onSettingChange:this.props.onSettingChange,disabled:this.props.hasLessThanTwoRowFields}),R.createElement(gh,{label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsLayoutDoNotRepeatLabels),id:"repeatLabelOff",actionType:4,valueToSet:0,onSettingChange:this.props.onSettingChange,disabled:this.props.hasLessThanTwoRowFields})),R.createElement("div",{className:e.root},R.createElement(jt.a,{className:e.label},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsLayoutBlankLineGroupHeader)),R.createElement(gh,{label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsLayoutBlankLine),id:"blankLineOn",actionType:5,valueToSet:1,onSettingChange:this.props.onSettingChange,disabled:this.props.hasLessThanTwoRowFields}),R.createElement(gh,{label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsLayoutNoBlankLine),id:"blankLineOff",actionType:5,valueToSet:0,onSettingChange:this.props.onSettingChange,disabled:this.props.hasLessThanTwoRowFields}))))}constructor(e){super(e)}}class kh extends R.PureComponent{render(){return R.createElement("div",null,R.createElement(oh,{displayName:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsRefreshSaveSectionHeader),divId:"refreshAndSave",paneId:"pivotTableSettings",collapse:this.props.isCollapsed,type:this.props.type,onSaveSectionCollapseState:this.props.onSaveSectionCollapseState}),R.createElement("div",{id:"refreshAndSave",className:eh(!this.props.isCollapsed)},R.createElement(mh,{label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsRefreshSaveSourceDataWithFile),id:"saveSourceDataWithFile",checked:this.props.saveSourceDataWithFile,actionType:14,onSettingChange:this.props.onSettingChange,disabled:this.props.disableSaveSourceData}),R.createElement(mh,{label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsRefreshSaveRefreshOnLoad),id:"refreshOnLoad",checked:this.props.refreshOnLoad,actionType:15,onSettingChange:this.props.onSettingChange,disabled:!1}),Object($c.h)("Microsoft.Office.Excel.NativePivotTableDataSourceDirtiness",!1)&&R.createElement(mh,{label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsRefreshSaveAutoRefresh),id:"autoRefresh",checked:this.props.autoRefresh,actionType:22,onSettingChange:this.props.onSettingChange,disabled:this.props.disableAutoRefresh})))}constructor(e){super(e)}}class Th extends R.PureComponent{render(){const e=Jg();return R.createElement("div",null,R.createElement(oh,{displayName:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsSortDisplaySectionHeader),divId:"sortAndDisplay",paneId:"pivotTableSettings",collapse:this.props.isCollapsed,type:this.props.type,onSaveSectionCollapseState:this.props.onSaveSectionCollapseState}),R.createElement("div",{id:"sortAndDisplay",className:eh(!this.props.isCollapsed)},R.createElement(mh,{label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsSortDisplayAutoFit),id:"autoFormatOnUpdate",checked:this.props.autoFormatOnUpdate,actionType:6,onSettingChange:this.props.onSettingChange,disabled:!1}),R.createElement(mh,{label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsSortDisplayShowExpandCollapse),id:"showDrillIndicators",checked:this.props.showDrillIndicators,actionType:7,onSettingChange:this.props.onSettingChange,disabled:!1}),this.props.isNativePivotTable?null:R.createElement("div",{className:e.root},R.createElement(jt.a,{className:e.label},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsSortDisplayItemsWithNoDataGroupHeader)),R.createElement(mh,{label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsSortDisplayItemsWithNoDataShowOnRows),id:"showItemsWithNoDataOnRw",checked:this.props.showItemsWithNoDataOnRw,actionType:8,onSettingChange:this.props.onSettingChange,disabled:!1}),R.createElement(mh,{label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsSortDisplayItemsWithNoDataShowOnColumns),id:"showItemsWithNoDataOnCol",checked:this.props.showItemsWithNoDataOnCol,actionType:9,onSettingChange:this.props.onSettingChange,disabled:!1})),R.createElement(mh,{label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsSortDisplayErrorString),id:"displayErrorString",checked:this.props.displayErrorString,actionType:10,onSettingChange:this.props.onSettingChange,disabled:!1}),R.createElement(uh,{id:"errorString",label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsSortDisplayErrorString),hideLabel:!0,value:this.props.errorString,disabled:!this.props.displayErrorString,multiline:!1,actionType:12,onSettingChange:this.props.onSettingChange,needCommit:this.props.isRangeChanged}),R.createElement(mh,{label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsSortDisplayNullString),id:"displayNullString",checked:this.props.displayNullString,actionType:11,onSettingChange:this.props.onSettingChange,disabled:!1}),R.createElement(uh,{id:"nullString",label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsSortDisplayNullString),hideLabel:!0,value:this.props.nullString,disabled:!this.props.displayNullString,multiline:!1,actionType:13,onSettingChange:this.props.onSettingChange,needCommit:this.props.isRangeChanged})))}constructor(e){super(e)}}var _h=n(1526),wh=n(146),Dh=n(1524);const Ph={root:{overflow:"hidden",border:"1px solid #8a8886",borderRadius:"2px",selectors:{".ms-List-cell":{minHeight:"24px",height:"24px",verticalAlign:"middle",alignItems:"middle",textOverflow:"ellipsis"}}}},Ih={root:{height:"24px",lineHeight:"normal",verticalAlign:"middle",fontSize:"12px",padding:0,maxWidth:"100%",selectors:{".ms-DetailsHeader-cellName":{fontSize:"12px",height:"16px",verticalAlign:"baseline",alignItems:"baseline",padding:"4px 4px 4px 4px"},".ms-DetailsHeader-cell":{height:"24px"}}}},Fh={container:{overflow:"auto",padding:0},cellStyles:{cellExtraRightPadding:0,cellLeftPadding:0,cellRightPadding:0}},Bh={key:"connectionCheckbox",name:"",minWidth:22,maxWidth:22,styles:{root:{padding:"0px 2px 0px 2px"}},isResizable:!1,isCollapsable:!1,columnActionsMode:wh.b.disabled},Mh={key:"connectionCaption",name:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsSlicerConnectionsCaptionColumnHeader),minWidth:75,maxWidth:75,isResizable:!0,isCollapsable:!1,columnActionsMode:wh.b.disabled},jh={key:"connectionName",name:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsSlicerConnectionsNameColumnHeader),minWidth:75,maxWidth:75,isResizable:!0,isCollapsable:!1,columnActionsMode:wh.b.disabled},Oh={key:"connectionSheetName",name:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsSlicerConnectionsSheetNameColumnHeader),minWidth:75,maxWidth:75,isResizable:!0,isCollapsable:!1,columnActionsMode:wh.b.disabled},Lh={key:"pivotTableName",name:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsSlicerConnectionsNameColumnHeader),minWidth:112,maxWidth:112,isResizable:!0,isCollapsable:!1,columnActionsMode:wh.b.disabled},Ah={key:"pivotTableSheetName",name:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsSlicerConnectionsSheetNameColumnHeader),minWidth:112,maxWidth:112,isResizable:!0,isCollapsable:!1,columnActionsMode:wh.b.disabled},Nh=[Bh,Mh,jh,Oh],Wh=[Bh,Lh,Ah],zh={root:{height:"24px",minHeight:"24px",lineHeight:"normal",padding:0,verticalAlign:"middle",selectors:{":hover":{background:"#FFFFFF"}}},cell:{paddingTop:0,paddingBottom:0,height:"24px",minHeight:"24px",verticalAlign:"middle",lineHeight:"normal"}},Hh={root:[Ug,{height:"24px",lineHeight:"normal",minHeight:"24px",paddingLeft:2,paddingRight:2}],checkbox:{background:"#FFFFFF"}},Vh=Object(Jo.c)(()=>Object(F.eb)([zg,{textOverflow:"ellipsis",height:"16px",verticalAlign:"middle",lineHeight:"24px",fontSize:"12px",padding:"4px 4px 4px 4px",cursor:"default"}]));class Uh extends R.PureComponent{componentDidMount(){null!=this.props.rowProps.item&&this.connectionRowRef.current&&this.connectionRowRef.current.firstElementChild&&this.connectionRowRef.current.firstElementChild.setAttribute("aria-selected",this.props.rowProps.item.enabled)}componentDidUpdate(){null!=this.props.rowProps.item&&this.connectionRowRef.current&&this.connectionRowRef.current.firstElementChild&&this.connectionRowRef.current.firstElementChild.setAttribute("aria-selected",this.props.rowProps.item.enabled)}render(){return R.createElement("div",{ref:this.connectionRowRef,onKeyDown:this.onConnectionRowKeyDown},R.createElement(Tu.a,_object_spread_props(_object_spread({},this.props.rowProps),{getRowAriaLabel:this.getRowAriaLabel,onRenderItemColumn:this.onRenderItemColumn,styles:zh})))}constructor(e){super(e),this.connectionRowRef=R.createRef(),this.getRowAriaLabel=()=>null==this.props.rowProps.item?"":"slicerConnections"===this.props.listType?`${ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsSlicerConnectionsCaptionColumnHeader)} ${this.props.rowProps.item.caption}\n    ${ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsSlicerConnectionsNameColumnHeader)} ${this.props.rowProps.item.name} ${ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsSlicerConnectionsSheetNameColumnHeader)} ${this.props.rowProps.item.sheet}`:`${ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsSlicerConnectionsNameColumnHeader)} ${this.props.rowProps.item.name} ${ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsSlicerConnectionsSheetNameColumnHeader)} ${this.props.rowProps.item.sheet}`,this.onConnectionRowKeyDown=e=>{if(" "===e.key||"Spacebar"===e.key){e.preventDefault();const t=this.props.rowProps.item;if(null==t||null==t.name||"pivotTableConnections"===this.props.listType&&null==t.sheet)return;this.props.onSettingChange?this.props.onSettingChange(21,t.name,Number(!t.enabled)):this.props.onSettingChangeWithFloatV2&&this.props.onSettingChangeWithFloatV2(16,t.name,Number(!t.enabled),0,t.sheet)}},this.onRenderItemColumn=(e,t,n)=>{if(null==e||null==t||null==n)return null;const o=e.name||"",r=e.caption||"",i=e.sheet||"",a=e.enabled||!1,s=t;switch(null==n?void 0:n.key){case"connectionCheckbox":return R.createElement(bg,{type:"AppCheckboxProps",label:o,id:"slicerConnections"===this.props.listType?"slicerConnection"+s:"pivotTableConnection"+s,styles:Hh,checked:a,checkmarkIcon:Po.a.checkboxCheckmark,onExecute:this.onCheckboxExecute});case"connectionName":case"pivotTableName":return R.createElement("span",{className:Vh(),title:o},o);case"connectionSheetName":case"pivotTableSheetName":return R.createElement("span",{className:Vh(),title:i},i);case"connectionCaption":return R.createElement("span",{className:Vh(),title:r},r);default:return null}},this.onCheckboxExecute=e=>{if(null==this.props.rowProps.item||null==this.props.rowProps.item.name||"pivotTableConnections"===this.props.listType&&null==this.props.rowProps.item.sheet)return;const t=this.props.rowProps.item.name,n=this.props.rowProps.item.sheet;this.props.onSettingChange?this.props.onSettingChange(21,t,Number(e.checked)):this.props.onSettingChangeWithFloatV2&&this.props.onSettingChangeWithFloatV2(16,t,Number(e.checked),0,n)}}}class Gh extends R.PureComponent{render(){return R.createElement(Cd.a,{direction:qo.a.vertical,"data-is-scrollable":"true",style:Fh.container},R.createElement(Dh.a,{items:this.props.items,columns:this.props.columns,selectionMode:_u.d.none,onRenderDetailsHeader:this.onRenderDetailsHeader,onRenderRow:this.onRenderRow,cellStyleProps:Fh.cellStyles,compact:!0,constrainMode:wh.d.unconstrained,styles:Ph,layoutMode:wh.e.justified,checkboxVisibility:wh.a.hidden}))}constructor(e){super(e),this.onRenderDetailsHeader=e=>{const t=e||{};return R.createElement(_h.a,_object_spread_props(_object_spread({},t),{styles:Ih,layoutMode:wh.e.justified}))},this.onRenderRow=e=>e?R.createElement(Uh,{rowProps:e,listType:this.props.listType,onSettingChange:this.props.onSettingChange,onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2}):null}}class qh extends R.PureComponent{render(){const e=this.props.slicerConnections;return!e||e.length<=0?null:R.createElement("div",null,R.createElement(oh,{displayName:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsSlicerConnectionsSectionHeader),divId:"slicerConnections",paneId:"pivotTableSettings",collapse:this.props.isCollapsed,type:5,onSaveSectionCollapseState:this.props.onSaveSectionCollapseState}),R.createElement("div",{id:"slicerConnections",className:th(!this.props.isCollapsed)},R.createElement(Gh,{items:e,columns:Nh,onSettingChange:this.props.onSettingChange,listType:"slicerConnections"})))}constructor(e){super(e)}}class Qh extends R.Component{componentDidUpdate(e){var t;this.props.needFocusOnFirstElement&&this.props.needFocusOnFirstElement!==e.needFocusOnFirstElement&&(null===(t=document.getElementById("PivotTableName"))||void 0===t||t.focus())}render(){return null!=this.props.settingsInfo&&R.createElement("div",{className:$g()},R.createElement("div",{className:Yg()},R.createElement(uh,{id:"PivotTableName",label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsPivotTableName),hideLabel:!1,value:this.props.settingsInfo.pivotTableName,multiline:!1,disabled:!1,actionType:1,onSettingChange:this.props.onSettingChange,needCommit:this.props.isRangeChanged})),R.createElement(bh,{colGrandTotalOn:this.props.settingsInfo.colGrandTotalOn,rwGrandTotalOn:this.props.settingsInfo.rwGrandTotalOn,onSettingChange:this.props.onSettingChange,hasLessThanTwoRowFields:this.props.hasLessThanTwoRowFields,type:1,isCollapsed:!!this.props.sectionCollapseStates&&this.props.sectionCollapseStates[1],onSaveSectionCollapseState:this.props.onSaveSectionCollapseState}),R.createElement(Rh,{indentIncrement:this.props.settingsInfo.indentIncrement,onSettingChange:this.props.onSettingChange,isRangeChanged:this.props.isRangeChanged,hasLessThanTwoRowFields:this.props.hasLessThanTwoRowFields,type:2,isCollapsed:!!this.props.sectionCollapseStates&&this.props.sectionCollapseStates[2],onSaveSectionCollapseState:this.props.onSaveSectionCollapseState}),R.createElement(Th,{autoFormatOnUpdate:this.props.settingsInfo.autoFormatOnUpdate,showDrillIndicators:this.props.settingsInfo.showDrillIndicators,showItemsWithNoDataOnRw:this.props.settingsInfo.showItemsWithNoDataOnRw,showItemsWithNoDataOnCol:this.props.settingsInfo.showItemsWithNoDataOnCol,displayErrorString:this.props.settingsInfo.displayErrorString,displayNullString:this.props.settingsInfo.displayNullString,errorString:this.props.settingsInfo.errorString,nullString:this.props.settingsInfo.nullString,onSettingChange:this.props.onSettingChange,isRangeChanged:this.props.isRangeChanged,isNativePivotTable:this.props.isNativePivotTable,type:4,isCollapsed:!!this.props.sectionCollapseStates&&this.props.sectionCollapseStates[4],onSaveSectionCollapseState:this.props.onSaveSectionCollapseState}),R.createElement(kh,{saveSourceDataWithFile:this.props.settingsInfo.saveSourceDataWithFile,refreshOnLoad:this.props.settingsInfo.refreshOnLoad,autoRefresh:this.props.settingsInfo.autoRefresh,onSettingChange:this.props.onSettingChange,disableSaveSourceData:!this.props.isNativePivotTable,disableAutoRefresh:!this.props.supportsAutoRefresh,type:3,isCollapsed:!!this.props.sectionCollapseStates&&this.props.sectionCollapseStates[3],onSaveSectionCollapseState:this.props.onSaveSectionCollapseState}),R.createElement(qh,{slicerConnections:this.props.settingsInfo.slicerConnections,onSettingChange:this.props.onSettingChange,type:5,isCollapsed:!!this.props.sectionCollapseStates&&this.props.sectionCollapseStates[5],onSaveSectionCollapseState:this.props.onSaveSectionCollapseState}),R.createElement(dh,{altText:this.props.settingsInfo.altText,altTextSummary:this.props.settingsInfo.altTextSummary,onSettingChange:this.props.onSettingChange,isRangeChanged:this.props.isRangeChanged,type:0,isCollapsed:!!this.props.sectionCollapseStates&&this.props.sectionCollapseStates[0],onSaveSectionCollapseState:this.props.onSaveSectionCollapseState}))}constructor(e){super(e)}}const Kh=R.createContext({}),Jh=R.createContext(e=>{});function Yh({children:e}){const[t,n]=R.useState({});return R.createElement(Kh.Provider,{value:t},R.createElement(Jh.Provider,{value:e=>{n(e)}},e))}var Zh=n(1226),$h=n(139);const Xh=Object(Jo.c)((e,t,n)=>{var o,r;return{root:{marginTop:"3px",marginRight:"8px",marginLeft:"8px"},expand:{color:null===(o=e.semanticColors)||void 0===o?void 0:o.menuItemText},title:!n&&{width:"100%",cursor:"default",padding:0,selectors:{span:{display:"inline-block",overflow:"hidden",textOverflow:"ellipsis",maxWidth:220-16*t+"px"}}},groupHeaderContainer:{height:"auto",selectors:{":hover":[{backgroundColor:null===(r=e.semanticColors)||void 0===r?void 0:r.listItemBackgroundHovered}]}},headerCount:{whiteSpace:"nowrap",overflow:"visible"}}}),em=e=>Object(Jo.c)(t=>{var n,o,r,i,a;return{root:{width:"100%"},fieldGroup:{border:"1px solid",borderColor:t.focused?null===(n=e.semanticColors)||void 0===n?void 0:n.focusBorder:null===(o=e.semanticColors)||void 0===o?void 0:o.inputBorder,boxSizing:"border-box",borderRadius:F.e.roundedCorner2,height:"24px",color:null===(r=e.semanticColors)||void 0===r?void 0:r.inputText,backgroundColor:null===(i=e.semanticColors)||void 0===i?void 0:i.inputBackground},field:{lineHeight:"16px",fontSize:"12px"},errorMessage:{color:null===(a=e.semanticColors)||void 0===a?void 0:a.errorText}}}),tm={childrenGap:2,margin:"0px 6px"},nm=(e,t,n,o)=>o?Object(F.I)(om(e,t,n),im(e)):om(e,t,n),om=(e,t,n)=>{var o,r,i,a,s;return{root:{height:(n?115:85)+"px",padding:"0px 0px 2px 16px",margin:"0px 8px 3px 8px",boxShadow:"none",background:"none",paddingLeft:16*(t+1)+"px",maxWidth:"inherit",selectors:{":hover":[{backgroundColor:Object(x.isChangeGateEnabled)("OfficeVSO:8279522_FixQueryHoverHighlight")?null===(o=e.semanticColors)||void 0===o?void 0:o.listItemBackgroundCheckedHovered:null===(r=e.semanticColors)||void 0===r?void 0:r.listItemBackgroundHovered},ci.n],":focus":{selectors:{":focus":[{backgroundColor:null===(i=e.semanticColors)||void 0===i?void 0:i.listItemBackgroundChecked},ci.n],":focus:hover":[{backgroundColor:null===(a=e.semanticColors)||void 0===a?void 0:a.listItemBackgroundCheckedHovered},ci.n],":active":[{backgroundColor:null===(s=e.semanticColors)||void 0===s?void 0:s.listItemBackgroundChecked},ci.n]}}}}}},rm=Object(Jo.c)(()=>({root:{flex:1,minWidth:0,marginLeft:"2px"}})),im=e=>{var t;return{root:{border:"none",backgroundColor:null===(t=e.semanticColors)||void 0===t?void 0:t.listItemBackgroundChecked,commonHighContrastHoverFocusStyles:ci.n}}};function am(e){var t,n,o,r;return{root:{backgroundColor:"transparent",padding:"1px",border:0,borderColor:"transparent",color:null==e||null===(t=e.semanticColors)||void 0===t?void 0:t.buttonText},rootDisabled:{backgroundColor:"transparent",padding:"1px",border:0,borderColor:"transparent",color:null==e||null===(n=e.semanticColors)||void 0===n?void 0:n.buttonText,selectors:{[`.${$h.a} &:focus`]:[{backgroundColor:"transparent"}]}},rootHovered:{backgroundColor:null==e||null===(o=e.semanticColors)||void 0===o?void 0:o.buttonBackgroundHovered,padding:"1px",border:0,borderColor:"transparent"},rootPressed:{backgroundColor:null==e||null===(r=e.semanticColors)||void 0===r?void 0:r.buttonBackgroundHovered,padding:"1px",border:0,borderColor:"transparent"}}}const sm=Object(Jo.c)((e,t,n)=>{var o,r;return{root:[{float:"left",padding:"0",width:"97%",minWidth:"0",flex:"1"}],label:[t&&{height:"26px",whiteSpace:"nowrap",fontWeight:"600",overflow:"hidden",textOverflow:"ellipsis",marginLeft:"5px",padding:"3px 0px 2px 0px",position:"relative",color:null===(o=e.semanticColors)||void 0===o?void 0:o.listText},!t&&{whiteSpace:"nowrap",fontWeight:"normal",overflow:"hidden",textOverflow:"ellipsis",marginTop:"0px",marginLeft:"7px",padding:"0px 0px 0px 0px",color:null===(r=e.semanticColors)||void 0===r?void 0:r.listText},{selectors:{[F.m]:{color:n?"HighlightText":"inherit"}}}]}}),lm={paddingTop:"2px",height:"20px",width:"22px"},cm={width:20,height:20,alignItems:"center",paddingRight:0,paddingLeft:"5px"},um=e=>Object(Jo.c)(t=>{var n,o,r,i,a;return{root:{width:"100%"},fieldGroup:{border:"1px solid",borderColor:t.focused?null===(n=e.semanticColors)||void 0===n?void 0:n.focusBorder:null===(o=e.semanticColors)||void 0===o?void 0:o.inputBorder,boxSizing:"border-box",borderRadius:F.e.roundedCorner2,height:"24px",color:null===(r=e.semanticColors)||void 0===r?void 0:r.inputText,backgroundColor:null===(i=e.semanticColors)||void 0===i?void 0:i.inputBackground},field:{lineHeight:"16px"},errorMessage:{color:null===(a=e.semanticColors)||void 0===a?void 0:a.errorText}}}),dm={marginTop:"6px"};class pm extends R.Component{render(){return R.createElement("div",{"data-testid":"QueryErrorComponent"},R.createElement(we.a,null,e=>R.createElement(Yl.a,{type:"AppLabelProps",id:"QueryError-"+this.props.id,forId:"QueryError-"+this.props.id,label:this.getErrorString(this.props.query.queryError),styles:sm(e,!1,this.props.isCardHovered),iconProps:{iconName:be.a.AlertWarning_20,style:cm}})))}constructor(e){super(e),this.getErrorString=e=>{switch(e){case 3:return ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.DownloadFailed);case 4:return ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.DownloadDidNotComplete);case 1:return ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.LoadToWorksheetFailed);case 2:return ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.LoadToDataModelFailed);default:return i.a.sendTraceTag(574374984,a.a.msoulscat_ES_EWAJS,s.a.Error,"QueryErrorComponent: Unknown query error"),""}}}}var gm=n(2646),hm=n(2475);const mm={onQuerySelected:()=>{},onQueryRefresh:()=>{},handleQueryGroupOperation:()=>{},onCancelQueryRefresh:()=>{},onLegacyConnectionRefresh:()=>{},onLegacyConnectionCancelRefresh:()=>{},onLegacyConnectionDelete:()=>{},onCancelKeyboardReorder:()=>{},onSetQueryProperties:()=>{},getAllReferencedQueriesAsync:([])=>Promise.resolve([])},bm=R.createContext(mm);function fm(){return R.useContext(bm)}const xm=bm.Provider;var Em;!function(e){e[e.Home=0]="Home",e[e.GroupProperties=1]="GroupProperties",e[e.QueryProperties=2]="QueryProperties",e[e.MoveToGroup=3]="MoveToGroup"}(Em||(Em={}));const Sm=R.createContext({type:Em.Home}),ym=R.createContext(e=>{});function Cm(){return R.useContext(ym)}function vm({children:e}){const[t,n]=R.useState({type:Em.Home});return R.createElement(Sm.Provider,{value:t},R.createElement(ym.Provider,{value:e=>{n(e)}},e))}var Rm=n(2242);const km={borderRadius:"0px",buttonBorderLine:"1px",margin:"0px",isCancelButtonFirst:!1},Tm=R.createContext(km),_m=()=>{const{borderRadius:e}=Object(R.useContext)(Tm);return{root:{borderRadius:e,height:"24px",selectors:{div:{height:"24px"}}},rootDisabled:{borderRadius:e,height:"24px",selectors:{div:{height:"24px"}}},rootHovered:{borderRadius:e,height:"24px",selectors:{div:{height:"24px"}}},rootPressed:{borderRadius:e,height:"24px",selectors:{div:{height:"24px"}}},icon:{height:"24px",width:"20px"},iconHovered:{height:"24px",width:"20px"},iconPressed:{height:"24px",width:"20px"},iconExpanded:{height:"24px",width:"20px"},label:{lineHeight:"inherit"}}},wm=e=>{const{styles:t}=e,n=_object_without_properties(e,["styles"]);return R.createElement(Ys.b,_object_spread_props(_object_spread({},n),{styles:Object(F.I)(e.styles,_m())}))};var Dm=n(1580),Pm=n(1142),Im=n(1143),Fm=n(183),Bm=n(1485),Mm=n(3096);const jm=Object(Fm.a)((e,t,n,o)=>({key:e,data:t,onRender:(e,t)=>R.createElement("span",{key:e.key},Object(Mm.a)(e.data,Object(Bm.a)(t),Number(e["aria-posinset"]),Number(e["aria-setsize"]),n,o)),customOnRenderListLength:Object(cl.e)(t)})),Om=Object(Jo.c)((e,t,n)=>o=>{const{controlProps:r,subComponentStyles:i,location:a,arePerfImprovementsEnabled:s,onMenuItemExecuted:l,onSubMenuPositioned:c,terminalParentControlId:u,useFullDescriptionLabelOnly:d,isExperimentalFeatureEnabled:p}=o;return r.filter(e=>Object(cl.e)(e)>0).map(o=>{const r=_object_spread_props(_object_spread({},Object(cl.a)(o,l)),{keytipProps:void 0,location:a,appStrings:t,terminalParentControlId:u}),g=r.id;switch(r.type){case"AppButtonProps":return(n?Fp.b:Fp.a)(Object(Ip.a)(r.id,r.location),r,i,void 0,void 0,d);case"AppToggleButtonProps":return Object(Dm.a)(r,i,void 0,d);case"AppFlyoutAnchorProps":return(s?Pm.b:Pm.a)(Object(Ip.a)(r.id,r.location),r,Om(e,t),e,c,i,i,s,l,d);case"AppSplitButtonProps":return(s?Im.b:Im.a)(Object(Ip.a)(r.id,r.location),r,Om(e,t),e,c,i,i,s,l,p);case"AppFontStylesFullGalleryProps":return jm(g,r,Om(e,t,!0),e);case"AppPersonaButtonProps":case"AppColorPickerProps":case"AppListGalleryProps":case"AppIconFullGalleryProps":case"AppCharacterCodeGalleryProps":case"AppCompoundButtonProps":case"RibbonChangeColorsFullGalleryProps":return jm(g,r);default:throw new Error(`The control of type ${r.type} is not valid in a Floatie menu`)}})});class Lm extends R.Component{render(){const e=Object(x.isChangeGateEnabled)("OfficeVSO:7111771_PowerQueryRefreshWeb")&&this.props.getProperty("isAADDocumentHost")&&this.props.getRefreshOrCancelButton;return R.createElement(we.a,null,t=>{var n,o,r,i;return R.createElement(At.a,{horizontal:!0},e&&this.props.getRefreshOrCancelButton(),this.props.shouldRenderOtherOptions&&R.createElement(bl,{id:"PowerQueryTaskPaneEllipsesFlyoutId-"+this.props.id,label:ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.OverflowWellLabel),type:"AppFlyoutAnchorProps",hideLabel:!0,hideChevron:!0,directionalHint:Se.a.bottomRightEdge,icon:c.a.HintBarEllipses_20,menuDefinition:this.props.menuDefinition,menuClassNames:this.props.menuClassNames,styles:Object(F.I)({root:{selectors:{".ms-Icon":{height:"20px",width:"20px"}}},rootHovered:{backgroundColor:null===(n=t.semanticColors)||void 0===n?void 0:n.buttonBackgroundHovered},rootExpanded:{backgroundColor:null===(o=t.semanticColors)||void 0===o?void 0:o.buttonBackgroundHovered},rootExpandedHovered:{backgroundColor:null===(r=t.semanticColors)||void 0===r?void 0:r.buttonBackgroundHovered},rootPressed:{backgroundColor:null===(i=t.semanticColors)||void 0===i?void 0:i.buttonBackgroundHovered}},this.props.styles),controlInMenuRendererFunction:this.controlInMenuRendererFunction,onAfterMenuDismiss:()=>{this.onMenuShowHide(!1)},onExecute:()=>{this.onMenuShowHide(!0)},directionalHintFixed:!1,shouldDismissOnWindowFocus:!0}))})}constructor(e){super(e),this.controlInMenuRendererFunction=Om(Po.a,Object(Fr.a)()),this.onMenuShowHide=e=>{this.props.onMenuShowHide&&this.props.onMenuShowHide(e)},this.controlInMenuRendererFunction.bind(this)}}Lm.contextType=bm;const Am=e=>{const{borderRadius:t,margin:n}=R.useContext(Tm),o=_m();function r(e){return e.sections.forEach(e=>{e.controls.forEach(e=>{const t=Object(F.I)(e.styles,o);e.styles=t})}),e}const{styles:i,menuDefinition:a,menuClassNames:s}=e,l=_object_without_properties(e,["styles","menuDefinition","menuClassNames"]);return R.createElement(we.a,null,i=>{var s,c,u;return R.createElement(Lm,_object_spread_props(_object_spread({},l),{menuDefinition:r(a),styles:Object(F.I)(e.styles,o),menuClassNames:{subComponentStyles:{callout:{root:{selectors:{".ms-FocusZone":{margin:n}}},calloutMain:{borderRadius:t&&"0px"!==t?t:F.e.roundedCorner2,color:null===(s=i.semanticColors)||void 0===s?void 0:s.menuItemText,background:null===(c=i.semanticColors)||void 0===c?void 0:c.menuBackground,selectors:{"& button:hover":{backgroundColor:null===(u=i.semanticColors)||void 0===u?void 0:u.menuItemBackgroundHovered},"& button:disabled":{backgroundColor:"transparent"}}}},menuItem:{}}}}))})},Nm=e=>{const{styles:t,partialTheme:n}=e,o=_object_without_properties(e,["styles","partialTheme"]),r=(e=>{var t;const{borderRadius:n,buttonBorderLine:o}=Object(R.useContext)(Tm);return{root:{borderRadius:n,selectors:{":focus":[{border:`${o} solid ${null===(t=e.semanticColors)||void 0===t?void 0:t.focusBorder}`,outline:0}]}}}})(n);return R.createElement(At.a,_object_spread_props(_object_spread({},o),{styles:Object(F.I)(e.styles,r)}))};class Wm extends R.Component{componentDidMount(){this.props.selected&&this.props.focusSelected&&this.props.focusSelected(this.state.isFocused)}componentDidUpdate(e){var t,n,o,r;this.props.queries!==e.queries&&this.state.isRenaming&&this.setState({errorMessage:Object(Rm.t)(e.query.name,null===(t=this.nameInput.current)||void 0===t?void 0:t.value,null!==(n=null===(o=this.props.queries)||void 0===o?void 0:o.map(e=>e.name))&&void 0!==n?n:[])}),this.state.isRenaming&&(null===(r=this.nameInput.current)||void 0===r||r.focus())}onQueryRename(e){const t=this.state.errorMessage,n=this.props.query.name,o=this.setRenameEnd;return function(r){const i=null==r?void 0:r.trim();!t&&i&&i!==n&&e.handleQueryAction(2,{name:n,extraData:i}),o()}}handlePasteQueryAction(e){var t=this;return _async_to_generator((function*(){const n=yield Object(Rm.m)(e.showClipboardAccessPermissionDialog);var o;0===n.queries.length&&0===n.queryGroups.length||e.onPowerQueryPaste(null===(o=t.props.query.groupKey)||void 0===o?void 0:o.replace(Rm.h,""),n.queries,n.queryGroups)}))()}handleCopyQueryAction(e){var t=this;return _async_to_generator((function*(){const n=yield e.getAllReferencedQueriesAsync([t.props.query.name]),o=t.props.queries.filter(e=>!!e&&n.includes(e.name));yield Object(Rm.r)(void 0,[],[t.props.query].concat(o))}))()}render(){this.paneLayoutUpdate=this.context.bind(this);const e=0!==this.props.query.queryError,t=this.isConnectionOnly(),n=this.state.isRenaming,o=this.isContextMenuShown(n);return R.createElement(we.a,null,n=>R.createElement(bm.Consumer,null,r=>{var i,a,s,l;return R.createElement("div",{ref:this.props.forwardRef,"data-testid":"QueryContainer"},R.createElement(Nm,{"data-testid":"PowerQueryContainerId",id:"PowerQueryContainerId-"+this.props.id,horizontal:!1,tokens:tm,styles:nm(n,this.props.nestingDepth,void 0!==this.state.errorMessage,this.props.selected),"data-is-focusable":!0,onFocus:this.onFocus,onBlur:this.onBlur,onMouseOver:this.onHover,onMouseLeave:this.onNotHover,onClick:this.onCardClick,onDoubleClick:this.getOnCardDoubleClick(r),onKeyDown:this.onCardSectionKeyDown(r),partialTheme:n},R.createElement(At.a,{horizontal:!0},R.createElement(At.a,null,this.props.query.inRefresh?R.createElement(gm.a,{type:"AppSpinnerProps",id:"QueryRefreshSpinner"+this.props.id,spinnerSize:Yp.a.medium,appColors:Object(b.a)(),styles:{circle:[{borderBottomColor:null===(i=n.palette)||void 0===i?void 0:i.neutralQuaternary,borderLeftColor:null===(a=n.palette)||void 0===a?void 0:a.neutralQuaternary,borderRightColor:null===(s=n.palette)||void 0===s?void 0:s.neutralQuaternary,borderTopColor:null===(l=n.palette)||void 0===l?void 0:l.black}]}}):R.createElement(fe.a,{style:lm,iconName:be.a.Table_20})),R.createElement(At.a,{horizontal:!1,styles:rm},R.createElement(At.a,{horizontal:!0,styles:Object(Zh.d)(n)},R.createElement(hm.a,{disableTooltip:!this.props.getProperty("isTooltipEnabled")},this.onRenderTitle(n,r),o&&this.getFocusZone(r,n))),R.createElement(At.a,{horizontal:!1},this.onRenderQueryDetails(e,t))))))}))}constructor(e){super(e),this.nameInput=R.createRef(),this.menuShown=!1,this.isDeleteEnabled=!1,this.isRenameEnabled=!1,this.isEditQueryEnabled=!1,this.isPasteEnabled=this.props.getProperty("Microsoft.Office.Excel.PowerQueryPaste")&&this.props.getProperty("isPowerQueryEditEnabled"),this.isCopyEnabled=this.props.getProperty("Microsoft.Office.Excel.PowerQueryCopy")&&this.props.getProperty("isPowerQueryEditEnabled"),this.paneLayoutUpdate=e=>{},this.fillObjectTypeToString=e=>{switch(e){case 1:return ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.LoadedToConnectionOnly);case 0:return ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.LoadedToTable);case 2:return ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.LoadedToPivotTable);case 3:return ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.LoadedToPivotChart);default:return i.a.sendTraceTag(573191066,a.a.msoulscat_ES_EWAJS,s.a.Error,"QueryProperties: Unknown fill object type"),""}},this.onHover=()=>{this.menuShown||this.setState({isHovered:!0})},this.onNotHover=()=>{this.menuShown||this.setState({isHovered:!1})},this.onFocus=()=>{this.menuShown||this.setState({isFocused:!0})},this.onBlur=()=>{this.menuShown||this.setState({isFocused:!1})},this.onCardClick=e=>{this.props.onQuerySelected(this.props.query),this.props.focusSelected&&this.props.focusSelected(this.state.isFocused)},this.getOnCardDoubleClick=e=>t=>{this.isEditQueryEnabled&&e.onEditQuery(this.props.query.name)},this.onInputClick=e=>{null==e||e.stopPropagation()},this.onCardSectionKeyDown=e=>{var t,n=this;return t=_async_to_generator((function*(t){n.state.isRenaming||n.state.ContextMenuSectionFocused||!t||t.keyCode!==xe.a.enter&&t.which!==xe.a.space||(n.props.onQuerySelected(n.props.query),n.props.focusSelected&&n.props.focusSelected(n.state.isFocused),t.preventDefault()),n.isCopyEnabled&&t&&(t.ctrlKey||t.metaKey)&&("c"===t.key||"C"===t.key)&&(yield n.handleCopyQueryAction(e),t.preventDefault()),n.isCopyEnabled&&t&&(t.ctrlKey||t.metaKey)&&("v"===t.key||"V"===t.key)&&(yield n.handlePasteQueryAction(e),t.preventDefault())})),function(e){return t.apply(this,arguments)}},this.getErrorCountString=()=>!this.props.query.rowsWithError||this.props.query.rowsWithError<=0?"":this.props.query.rowsWithError>1?ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.ErrorsCount).replace("{0}",this.props.query.rowsWithError.toString()):ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.OneError),this.getRowsLoadedLine=()=>{const e=this.props.query.rowsLoaded>1?ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.QueryRowsLoaded).replace("{0}",(new Intl.NumberFormat).format(this.props.query.rowsLoaded)):ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.QueryRowLoaded);return this.props.query.rowsWithError&&this.props.query.rowsWithError>0?`${e} ${this.getErrorCountString()}`:e},this.getLoadedToRow=e=>e?this.props.query.loadedToDataModel?ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.LoadedTo).replace("{0}",ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.DataModel)):this.fillObjectTypeToString(this.props.query.fillObjectType):this.props.query.loadedToDataModel?ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.LoadedToDataModel).replace("{0}",this.fillObjectTypeToString(this.props.query.fillObjectType)):ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.LoadedTo).replace("{0}",this.fillObjectTypeToString(this.props.query.fillObjectType)),this.onRenderTitle=(e,t)=>e?this.state.isRenaming?R.createElement("div",{onClick:this.onInputClick},R.createElement(Xd.a,{ref:this.nameInput,id:"QueryNameInput",type:"AppInputProps",defaultValue:this.props.query.name,autoComplete:"off",styles:um(e),onChange:this.onQueryNameChange,errorMessage:this.state.errorMessage,executeOnEnter:!0,executeOnBlur:!0,onExecute:this.onQueryRename(t),onKeyDown:this.onAppInputKeyDown})):R.createElement(Yl.a,{type:"AppLabelProps",id:"QueryName-"+this.props.id,forId:"QueryName-"+this.props.id,label:this.props.query.name,styles:sm(e,!0,this.state.isHovered),customTooltip:this.props.query.name}):null,this.onQueryNameChange=e=>{var t,n;this.setState({errorMessage:Object(Rm.t)(this.props.query.name,e,null!==(t=null===(n=this.props.queries)||void 0===n?void 0:n.map(e=>e.name))&&void 0!==t?t:[])})},this.setRenameStart=()=>{this.menuShown=!1,this.props.onRenameStartedOrEnd(this.props.query.name),this.setState({isRenaming:!0})},this.setRenameEnd=()=>{this.props.onRenameStartedOrEnd(""),this.setState({isRenaming:!1,errorMessage:void 0,isFocused:!1,isHovered:!1})},this.onAppInputKeyDown=e=>{var t;e.which===xe.a.escape&&(null===(t=this.nameInput.current)||void 0===t||t.resetState(),this.setRenameEnd(),e.stopPropagation(),e.preventDefault())},this.onRenderQueryDetails=(e,t)=>{const n=[];return this.isDeleting()?n.push(this.onRenderQueryDeleting()):(n.push(this.onRenderQueryRowsLoaded(e,t)),n.push(this.onRenderQueryLastRefreshed()),n.push(this.onRenderQueryLoadedTo(t))),n},this.onRenderQueryDeleting=()=>R.createElement(we.a,null,e=>R.createElement(Yl.a,{type:"AppLabelProps",id:"QueryDeleting-"+this.props.id,forId:"QueryDeleting-"+this.props.id,label:ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.QueryDeleting),styles:sm(e,!1,this.state.isHovered)})),this.onRenderQueryLoadedTo=e=>R.createElement(we.a,null,t=>R.createElement(Yl.a,{type:"AppLabelProps",id:"QueryLoadedTo-"+this.props.id,forId:"QueryLoadedTo-"+this.props.id,label:this.getLoadedToRow(e),styles:sm(t,!1,this.state.isHovered)})),this.onRenderQueryLastRefreshed=()=>R.createElement(we.a,null,e=>R.createElement(Yl.a,{type:"AppLabelProps",id:"QueryLastRefreshed-"+this.props.id,forId:"QueryLastRefreshed-"+this.props.id,label:ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.QueryLastRefreshed).replace("{0}",new Date(this.props.query.lastRefresh).toLocaleString()),styles:sm(e,!1,this.state.isHovered)})),this.onRenderQueryRowsLoaded=(e,t)=>e?R.createElement(pm,{query:this.props.query,id:this.props.id,isCardHovered:this.state.isHovered}):(!t||this.props.query.loadedToDataModel)&&R.createElement(we.a,null,e=>R.createElement("div",{"data-testid":"QueryRowsLoaded"},R.createElement(Yl.a,{type:"AppLabelProps",id:"QueryRowsLoaded-"+this.props.id,forId:"QueryRowsLoaded-"+this.props.id,label:this.getRowsLoadedLine(),styles:sm(e,!1,this.state.isHovered)}))),this.isConnectionOnly=()=>1===this.props.query.fillObjectType,this.isDeletingEnabled=()=>this.props.getProperty("Microsoft.Office.Excel.PowerQueryTaskPaneDeleteQuery")&&this.props.getProperty("isPowerQueryEditEnabled")&&this.props.getProperty("isAADDocumentHost"),this.isDeleting=()=>this.isDeleteEnabled&&1===this.props.query.currentRunningOperation,this.isRenamingEnabled=()=>this.props.getProperty("Microsoft.Office.Excel.PowerQueryTaskPaneRenameQuery")&&this.props.getProperty("isPowerQueryEditEnabled")&&this.props.getProperty("isAADDocumentHost"),this.isEditingQueryEnabled=()=>this.props.getProperty("Microsoft.Office.Excel.PowerQueryImport")&&this.props.getProperty("isPowerQueryEditEnabled")&&this.props.getProperty("isAADDocumentHost"),this.isContextMenuShown=e=>(Object(x.isChangeGateEnabled)("OfficeVSO:7111771_PowerQueryRefreshWeb")&&this.props.getProperty("isAADDocumentHost")||this.props.getProperty("isPowerQueryEditEnabled"))&&(this.state.isFocused||this.state.isHovered||this.menuShown)&&!e&&!this.isDeleting(),this.shouldDisableRefreshButton=()=>!Object(x.isChangeGateEnabled)("OfficeVSO:7111771_PowerQueryRefreshWeb")||!this.props.getProperty("isAADDocumentHost")||this.props.query.loadedToDataModel||1===this.props.query.fillObjectType||!this.props.query.refreshEnabled||this.props.query.inRefresh||this.isOperationRunning(),this.setContextMenuSectionFocused=e=>{this.setState({ContextMenuSectionFocused:e})};var t,n=this;this.onMenuShowHide=(t=_async_to_generator((function*(e){if(n.menuShown=e,e&&n.onCardClick(void 0),n.props.getProperty("Microsoft.Office.Excel.PowerQueryPaste")){const e=yield Object(Rm.i)();e&&!n.state.isPasteEnabled?n.setState({isPasteEnabled:!0,isFocused:!1,isHovered:!1}):!e&&n.state.isPasteEnabled&&n.setState({isPasteEnabled:!1,isFocused:!1,isHovered:!1})}else n.setState({isFocused:!1,isHovered:!1})})),function(e){return t.apply(this,arguments)}),this.onRefresh=()=>{this.props.onQueryRefresh(this.props.query.name)},this.onCancelRefresh=e=>{e.onCancelQueryRefresh(this.props.query.name)},this.switchTaskPaneLayout=e=>{var t;switch(e){case Em.MoveToGroup:this.paneLayoutUpdate({type:e,groupOperationPayload:{id:null===(t=this.props.query.groupKey)||void 0===t?void 0:t.replace(Rm.h,""),name:this.props.query.name},isGroupMoving:!1});break;case Em.QueryProperties:i.a.sendTraceTag(507606347,a.a.msoulscat_ES_EWAJS,s.a.Info,"Openning Query Properties task pane view."),this.paneLayoutUpdate({type:e,queryOperationPayload:{id:this.props.query.name,name:this.props.query.name,description:this.props.query.description},queryPropertiesPayload:{lastRefresh:this.props.query.lastRefresh,propertiesControls:this.props.query.propertiesControls}});break;default:i.a.debugAssertTag(508699338,a.a.msoulscat_ES_EWAJS,!1,"Unexpected PowerQueryTaskPaneType: "+e)}},this.getQueryActionCallback=(e,t,n)=>()=>{e.handleQueryAction(t,{name:n})},this.getRefreshOrCancelButton=(e,t)=>{if(this.props.query.inRefresh&&Object(x.isChangeGateEnabled)("OfficeVSO:7111771_PowerQueryRefreshWeb")){const n=Object(Rm.l)(ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.Cancel),"ExternalCancelRefreshButton-"+this.props.id,()=>this.onCancelRefresh(e),Po.a.closeIcon,!1,t),{styles:o}=n,r=_object_without_properties(n,["styles"]);return R.createElement(wm,_object_spread_props(_object_spread({},r),{hideLabel:!0,styles:Object(F.I)(o,am(t))}))}const n=Object(Rm.l)(ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.Refresh),"ExternalRefreshButton-"+this.props.id,this.onRefresh,be.a.RefreshConnection_20,this.shouldDisableRefreshButton(),t),{styles:o}=n,r=_object_without_properties(n,["styles"]);return R.createElement(wm,_object_spread_props(_object_spread({},r),{hideLabel:!0,styles:Object(F.I)(o,am(t))}))},this.isOperationRunning=()=>Object(x.isChangeGateEnabled)("OfficeVSO:7739992_AddingCurrentRunningOperation")&&void 0!==this.props.query.currentRunningOperation&&-1!==this.props.query.currentRunningOperation,this.isDuplicateQueryEnabled=()=>(0===this.props.query.fillObjectType||1===this.props.query.fillObjectType)&&!this.props.query.loadedToDataModel&&!this.isOperationRunning()&&!this.props.getProperty("isDocumentStructureLocked")&&(this.props.query.refreshEnabled||!Object(x.isChangeGateEnabled)("OfficeVSO:8916712_DisableOperationsForBrokenConnection")),this.shouldDisableActionButton=e=>{switch(e){case 0:case 3:return this.isOperationRunning();case 4:return!this.isDuplicateQueryEnabled();case 1:return this.shouldDisableQueryEditing(!1);case 2:case 5:return Object(x.isChangeGateEnabled)("OfficeVSO:8916712_DisableOperationsForBrokenConnection")&&!this.props.query.refreshEnabled||this.shouldDisableQueryEditing(!1);default:return!0}},this.shouldDisableQueryEditing=e=>this.isOperationRunning()||this.props.query.loadedToDataModel||this.props.getProperty("isDocumentStructureLocked")||!e&&this.props.query.inRefresh,this.isQueryEditingEnabled=()=>this.isRenameEnabled||this.isDeleteEnabled||this.isEditQueryEnabled,this.getCopyPasteSection=(e,t)=>{const n={controls:[]};if(this.isPasteEnabled){var o=this;n.controls.push(Object(Rm.l)(ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.PasteOption),"Paste-"+this.props.id,_async_to_generator((function*(){yield o.handlePasteQueryAction(e)})),be.a.Paste_24,!this.state.isPasteEnabled,t))}if(this.isCopyEnabled){var r=this;n.controls.push(Object(Rm.l)(ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.CopyOption),"Copy-"+this.props.id,_async_to_generator((function*(){yield r.handleCopyQueryAction(e)})),be.a.Copy_24,!1,t))}return n},this.getEditQuerySection=(e,t)=>{const n={controls:[]};return this.isEditQueryEnabled&&n.controls.push(Object(Rm.l)(ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.EditQueryOption),"QueryEditButton-"+this.props.id,()=>e.onEditQuery(this.props.query.name),be.a.EditQuery_20,this.shouldDisableQueryEditing(!0),t)),this.isDeleteEnabled&&n.controls.push(Object(Rm.l)(ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.DeleteQueryOption),"QueryDeleteButton-"+this.props.id,this.getQueryActionCallback(e,1,this.props.query.name),be.a.Delete_20,this.shouldDisableActionButton(1),t)),this.isRenameEnabled&&n.controls.push(Object(Rm.l)(ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.RenameQueryOption),"QueryRenameButton-"+this.props.id,this.setRenameStart,Object(x.isChangeGateEnabled)("OfficeVSO:8339757_ExternalLinkAndRenameQuestionIconResize")?hr.a.RenameColumn_20:d.a.RenameColumn_32,this.shouldDisableActionButton(2),t)),n},this.getRefreshQuerySection=e=>{const t={controls:[]};return t.controls.push(Object(Rm.l)(ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.Refresh),"QueryRefreshButton-"+this.props.id,this.onRefresh,be.a.RefreshConnection_20,this.shouldDisableRefreshButton(),e)),t},this.getOtherCommandSection=(e,t)=>{const n={controls:[]};return this.props.getProperty("Microsoft.Office.Excel.PowerQueryTaskPaneDuplicateQuery")&&n.controls.push(Object(Rm.l)(ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.DuplicateQueryOption),"QueryDuplicateButton-"+this.props.id,this.getQueryActionCallback(e,4,this.props.query.name),be.a.Duplicate_24,this.shouldDisableActionButton(4),t)),this.props.shouldShowMoveQueryButton&&this.props.getProperty("isPowerQueryEditEnabled")&&n.controls.push(Object(Rm.l)(ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.MoveQueryToGroupOption),"QueryMoveToGroupButton-"+this.props.id,()=>this.switchTaskPaneLayout(Em.MoveToGroup),void 0,this.shouldDisableActionButton(0),t)),this.props.getProperty("Microsoft.Office.Excel.PowerQueryTaskPaneQueryProperties")&&n.controls.push(Object(Rm.l)(ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.PropertiesOption),"QueryPropertiesButton-"+this.props.id,()=>this.switchTaskPaneLayout(Em.QueryProperties),be.a.Info_20,this.shouldDisableActionButton(5))),n},this.getMenuDefinition=(e,t)=>{const n={sections:[{controls:[]}]};return(this.isPasteEnabled||this.isCopyEnabled)&&n.sections.push(this.getCopyPasteSection(e,t)),this.isQueryEditingEnabled()&&n.sections.push(this.getEditQuerySection(e,t)),n.sections.push(this.getRefreshQuerySection(t)),n.sections.push(this.getOtherCommandSection(e,t)),n},this.getContextMenu=(e,t)=>R.createElement(Am,{id:"Query-"+this.props.id.toString(),onMenuShowHide:this.onMenuShowHide,getRefreshOrCancelButton:()=>this.getRefreshOrCancelButton(e,t),menuDefinition:this.getMenuDefinition(e,t),shouldRenderOtherOptions:!0,getProperty:this.props.getProperty}),this.getFocusZone=(e,t)=>R.createElement(Cd.a,{onFocus:()=>this.setContextMenuSectionFocused(!0),onBlur:()=>this.setContextMenuSectionFocused(!1)},this.getContextMenu(e,t)),this.state={isHovered:!1,isFocused:!1,ContextMenuSectionFocused:!1,isRenaming:!1,errorMessage:void 0,isPasteEnabled:!1},this.isDeleteEnabled=this.isDeletingEnabled(),this.isRenameEnabled=this.isRenamingEnabled(),this.isEditQueryEnabled=this.isEditingQueryEnabled()}}Wm.contextType=bm,Wm.contextType=ym;var zm=n(1622),Hm=n(112),Vm=n(2510);const Um=()=>{const{borderRadius:e}=Object(R.useContext)(Tm);return{root:{borderRadius:e},expand:{borderRadius:e,selectors:{":hover":{backgroundColor:"transparent"},":active":{backgroundColor:"transparent"}}},groupHeaderContainer:{selectors:{":hover":[{borderRadius:e}]}}}},Gm=Object(rh.a)(),qm=R.createRef();class Qm extends R.Component{componentDidUpdate(e){var t,n,o,r,i,a,s;(null===(t=this.props.groupDividerProps)||void 0===t?void 0:t.groups)!==(null===(n=e.groupDividerProps)||void 0===n?void 0:n.groups)&&this.state.isRenaming&&this.setState({errorMessage:Object(Rm.s)(null===(o=qm.current)||void 0===o?void 0:o.value,null!==(r=null===(i=this.props.groupDividerProps)||void 0===i||null===(i=i.groups)||void 0===i?void 0:i.map(e=>e.name))&&void 0!==r?r:[],null===(a=this.props.groupDividerProps)||void 0===a||null===(a=a.group)||void 0===a?void 0:a.name)}),this.state.isRenaming&&(null===(s=qm.current)||void 0===s||s.focus())}handleCopyGroupAction(){var e=this;return _async_to_generator((function*(){var t,n;yield Object(Rm.r)(null===(t=e.props.groupDividerProps)||void 0===t||null===(t=t.group)||void 0===t?void 0:t.key,[null===(n=e.props.groupDividerProps)||void 0===n?void 0:n.group],e.props.queries)}))()}handlePasteGroupAction(e){var t=this;return _async_to_generator((function*(){const n=yield Object(Rm.m)(null==e?void 0:e.showClipboardAccessPermissionDialog);var o,r;0===n.queries.length&&0===n.queryGroups.length||null==e||e.onPowerQueryPaste((null===(o=t.props.groupDividerProps)||void 0===o||null===(o=o.group)||void 0===o?void 0:o.key)===Rm.g?null:null===(r=t.props.groupDividerProps)||void 0===r||null===(r=r.group)||void 0===r?void 0:r.key,n.queries,n.queryGroups)}))()}render(){var e,t,n,o;const r=0!==(null===(e=this.props.groupDividerProps)||void 0===e||null===(e=e.group)||void 0===e?void 0:e.count)||!(null===(t=this.props.groupDividerProps)||void 0===t||null===(t=t.group)||void 0===t||!t.children)&&(null===(n=this.props.groupDividerProps)||void 0===n||null===(n=n.group)||void 0===n?void 0:n.children.length)>0;return R.createElement(At.a,{grow:1,horizontal:!0,verticalAlign:"center",onMouseOver:this.onHover(!0),onMouseLeave:this.onHover(!1),onFocus:this.onFocus(!0),onBlur:this.onFocus(!1),id:(null===(o=this.props.groupDividerProps)||void 0===o||null===(o=o.group)||void 0===o?void 0:o.key)+"GroupHeader"},R.createElement(At.a.Item,{grow:1},R.createElement(we.a,null,e=>{var t,n;return R.createElement(Vm.a,{tooltipLabel:null===(t=this.props.groupDividerProps)||void 0===t||null===(t=t.group)||void 0===t?void 0:t.data,tooltipId:"GroupHeaderToolTip",tooltipDirection:Se.a.bottomCenter,updateTooltipsHidden:this.context.updateTooltipsHidden,setTooltipElement:this.context.setTooltipElement},this.props.defaultRender(_object_spread_props(_object_spread({},this.props.groupDividerProps),{expandButtonProps:{style:{visibility:r?"unset":"hidden"}},selectionMode:_u.d.none,indentWidth:16,styles:Object(F.db)(Xh(e,null===(n=this.props.groupDividerProps)||void 0===n?void 0:n.groupLevel,!!this.state.isRenaming),Um()),onRenderTitle:t=>this.onRenderTitle(e,t)})))})))}constructor(e){var t;super(e),this.menuShown=!1,this.isPasteEnabled=this.props.getProperty("Microsoft.Office.Excel.PowerQueryPaste"),this.isCopyEnabled=this.props.getProperty("Microsoft.Office.Excel.PowerQueryCopy");var n,o=this;this.onMenuShowHide=(n=_async_to_generator((function*(e){if(o.menuShown=e,o.props.getProperty("Microsoft.Office.Excel.PowerQueryPaste")){const e=yield Object(Rm.i)();e&&!o.state.isPasteEnabled?o.setState({isPasteEnabled:!0,isFocused:!1,isHovered:!1}):!e&&o.state.isPasteEnabled&&o.setState({isPasteEnabled:!1,isFocused:!1,isHovered:!1})}else o.setState({isFocused:!1,isHovered:!1})})),function(e){return n.apply(this,arguments)}),this.getGroupOperationPayload=()=>{var e,t;const n=null===(e=this.props.groupDividerProps)||void 0===e?void 0:e.group;return{id:null===(t=this.props.groupDividerProps)||void 0===t||null===(t=t.group)||void 0===t?void 0:t.key,name:null==n?void 0:n.name,description:null==n?void 0:n.data}},this.getCopyPasteSection=(e,t)=>{const n=[];if(this.isPasteEnabled){var o,r=this;n.push(Object(Rm.l)(ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.PasteOption),"Paste-"+(null===(o=this.props.groupDividerProps)||void 0===o||null===(o=o.group)||void 0===o?void 0:o.key),_async_to_generator((function*(){yield r.handlePasteGroupAction(e)})),be.a.Paste_24,!this.state.isPasteEnabled,t))}if(this.isCopyEnabled){var i,a=this;n.push(Object(Rm.l)(ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.CopyOption),"Copy-"+(null===(i=this.props.groupDividerProps)||void 0===i||null===(i=i.group)||void 0===i?void 0:i.key),_async_to_generator((function*(){yield a.handleCopyGroupAction()})),be.a.Copy_24,!1,t))}return{controls:n}},this.getMovingGroupOperationSection=(e,t)=>{var n,o,r,i,a;const s=this.getGroupOperationPayload(),l=null===(n=this.props.groupDividerProps)||void 0===n?void 0:n.group,c={controls:[]},u=c.controls;var p,g;return 0!==(null==l?void 0:l.count)&&null!=l&&l.children&&u.push(Object(Rm.l)(ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.UngroupOption),"UngroupGroupButton-"+(null===(p=this.props.groupDividerProps)||void 0===p||null===(p=p.group)||void 0===p?void 0:p.key),this.getGroupOperationFunction(1,s),void 0,this.props.getProperty("isDocumentStructureLocked"),t)),!this.props.getProperty("Microsoft.Office.Excel.PowerQueryDeleteQueryGroup")&&0!==(null==l?void 0:l.count)&&null!=l&&l.children||u.push(Object(Rm.l)(ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.DeleteGroupOption),"DeleteGroupButoon-"+(null===(g=this.props.groupDividerProps)||void 0===g||null===(g=g.group)||void 0===g?void 0:g.key),this.getGroupOperationFunction(2,s),be.a.Delete_20,this.props.getProperty("isDocumentStructureLocked"),t)),u.push(Object(Rm.l)(ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.RenameGroupOption),"RenameGroupButton-"+(null===(o=this.props.groupDividerProps)||void 0===o||null===(o=o.group)||void 0===o?void 0:o.key),this.setRenameStart,d.a.RenameColumn_32,this.props.getProperty("isDocumentStructureLocked"),t)),u.push(Object(Rm.l)(ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.MoveQueryToGroupOption),"MoveToGroupButton-"+(null===(r=this.props.groupDividerProps)||void 0===r||null===(r=r.group)||void 0===r?void 0:r.key),()=>{e({type:Em.MoveToGroup,groupOperation:4,groupOperationPayload:s,isGroupMoving:!0})},void 0,this.props.getProperty("isDocumentStructureLocked"),t)),u.push(Object(Rm.l)(ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.MoveToTopLevelOption),"MoveToTopLevelButton-"+(null===(i=this.props.groupDividerProps)||void 0===i||null===(i=i.group)||void 0===i?void 0:i.key),()=>{s.parentId=null,this.props.handleGroupOperation(4,s)},void 0,0===(null==l?void 0:l.level)||this.props.getProperty("isDocumentStructureLocked"),t)),u.push(Object(Rm.l)(ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.PropertiesOption),"SetPropertiesButton-"+(null===(a=this.props.groupDividerProps)||void 0===a||null===(a=a.group)||void 0===a?void 0:a.key),()=>{var t,n;e({type:Em.GroupProperties,groupOperation:5,groupOperationPayload:s,groupSiblingsNames:null!==(t=null===(n=this.props.groupDividerProps)||void 0===n||null===(n=n.groups)||void 0===n?void 0:n.map(e=>e.name))&&void 0!==t?t:[]})},be.a.Info_20,this.props.getProperty("isDocumentStructureLocked"),t)),c},this.getMenuDefinition=(e,t,n)=>{var o,r;const i={sections:[]};(this.isPasteEnabled||this.isCopyEnabled)&&this.props.getProperty("isPowerQueryEditEnabled")&&i.sections.push(this.getCopyPasteSection(e,n));const a=[];return a.push(Object(Rm.l)(ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.Refresh),"RefreshGroupButton-"+(null===(o=this.props.groupDividerProps)||void 0===o||null===(o=o.group)||void 0===o?void 0:o.key),()=>{this.onRefreshAll(e.onQueryRefresh)},be.a.RefreshConnection_20,this.shouldDisableRefreshButton(),n)),i.sections.push({controls:a}),this.props.getProperty("isPowerQueryEditEnabled")&&(null===(r=this.props.groupDividerProps)||void 0===r||null===(r=r.group)||void 0===r?void 0:r.key)!==Rm.g&&i.sections.push(this.getMovingGroupOperationSection(t,n)),i},this.getGroupOperationFunction=(e,t)=>()=>{this.props.handleGroupOperation(e,t)},this.getContextMenu=(e,t,n)=>{var o;return R.createElement(Am,{id:"Group-"+(null===(o=this.props.groupDividerProps)||void 0===o||null===(o=o.group)||void 0===o?void 0:o.key),onMenuShowHide:this.onMenuShowHide,menuDefinition:this.getMenuDefinition(e,t,n),shouldRenderOtherOptions:!0,getProperty:this.props.getProperty})},this.onHover=e=>()=>{this.menuShown||this.setState({isHovered:e})},this.onFocus=e=>()=>{this.menuShown||this.setState({isFocused:e})},this.onRenderTitle=(e,t)=>{if(!e)return null;const{group:n,ariaColSpan:o}=t;if(!n)return null;let r=n.count;if(n.children&&n.children.length>0){r=n.children.length;const e=n.children.find(e=>e.name.includes(Rm.h));e&&(r--,r+=e.count)}else r=n.count;const i=Gm(t.styles,{theme:t.theme,className:t.className,selected:t.isSelected,isCollapsed:t.group.isCollapsed,compact:t.compact});if(this.state.isRenaming)return R.createElement(Xd.a,{ref:qm,id:"GroupNameInput",type:"AppInputProps",defaultValue:n.name,autoComplete:"off",styles:em(e),onChange:this.onGroupNameChange,errorMessage:this.state.errorMessage,executeOnEnter:!0,executeOnBlur:!0,onExecute:this.onGroupRename,onKeyDown:this.onAppInputKeyDown});const a=(Object(x.isChangeGateEnabled)("OfficeVSO:7111771_PowerQueryRefreshWeb")&&this.props.getProperty("isAADDocumentHost")||this.props.getProperty("isPowerQueryEditEnabled"))&&(this.state.isFocused||this.state.isHovered||this.menuShown)&&!this.state.isRenaming;return R.createElement(bm.Consumer,null,t=>R.createElement(At.a,{grow:1,horizontal:!0,verticalAlign:"center",styles:Object(Zh.d)(e),onKeyDown:this.onGroupHeaderKeyDown(t)},R.createElement("div",{className:i.title,role:"gridcell","aria-colspan":o,tabIndex:0},R.createElement("span",null,n.name),0!==n.count&&R.createElement("span",{className:i.headerCount},"(",r,")")),a&&R.createElement(ym.Consumer,null,n=>this.getContextMenu(t,n,e))))},this.onGroupNameChange=e=>{var t,n,o;this.setState({errorMessage:Object(Rm.s)(e,null!==(t=null===(n=this.props.groupDividerProps)||void 0===n||null===(n=n.groups)||void 0===n?void 0:n.map(e=>e.name))&&void 0!==t?t:[],null===(o=this.props.groupDividerProps)||void 0===o||null===(o=o.group)||void 0===o?void 0:o.name)})},this.onGroupRename=e=>{var t;!this.state.errorMessage&&e&&this.props.handleGroupOperation(3,{id:null===(t=this.props.groupDividerProps)||void 0===t||null===(t=t.group)||void 0===t?void 0:t.key,name:e}),this.setRenameEnd()},this.setRenameStart=()=>{this.menuShown=!1,this.setState({isRenaming:!0})},this.setRenameEnd=()=>{this.setState({isRenaming:!1,errorMessage:void 0,isFocused:!1,isHovered:!1})},this.onRefreshAll=e=>{var t,n;const o=null===(t=this.props.groupDividerProps)||void 0===t||null===(t=t.group)||void 0===t?void 0:t.startIndex,r=o+(null===(n=this.props.groupDividerProps)||void 0===n||null===(n=n.group)||void 0===n?void 0:n.count);this.props.queries.slice(o,r).forEach(t=>{Object(Rm.o)(t)&&e(null==t?void 0:t.name)})},this.shouldDisableRefreshButton=()=>{var e,t;if(!Object(x.isChangeGateEnabled)("OfficeVSO:7111771_PowerQueryRefreshWeb")||!this.props.getProperty("isAADDocumentHost"))return!0;const n=null===(e=this.props.groupDividerProps)||void 0===e||null===(e=e.group)||void 0===e?void 0:e.startIndex,o=n+(null===(t=this.props.groupDividerProps)||void 0===t||null===(t=t.group)||void 0===t?void 0:t.count);return!this.props.queries.slice(n,o).some(e=>Object(Rm.o)(e))},this.onAppInputKeyDown=e=>{var t;e.which===xe.a.escape&&(null===(t=qm.current)||void 0===t||t.resetState(),this.setRenameEnd(),e.stopPropagation(),e.preventDefault())},this.onGroupHeaderKeyDown=e=>{var t=this;return function(){var n=_async_to_generator((function*(n){t.isCopyEnabled&&n&&(n.ctrlKey||n.metaKey)&&("c"===n.key||"C"===n.key)&&(yield t.handleCopyGroupAction(),n.preventDefault()),t.isPasteEnabled&&n&&(n.ctrlKey||n.metaKey)&&("v"===n.key||"V"===n.key)&&(yield t.handlePasteGroupAction(e),n.preventDefault())}));return function(e){return n.apply(this,arguments)}}()},this.state={isHovered:!1,isFocused:!1,isRenaming:!1,errorMessage:void 0,isPasteEnabled:!1},this.setRenameStart=this.setRenameStart.bind(this),this.onRenderTitle=this.onRenderTitle.bind(this),this.onGroupRename=this.onGroupRename.bind(this),null===(t=this.props.defaultRender)||void 0===t||t.bind(this)}}Qm.contextType=Hm.a;var Km,Jm=n(1375),Ym=(n(230),n(2562));function Zm(e,t,n){return{dataCategories:e,diagnosticLevel:t,samplingPolicy:n,costPriority:Ym.a.CostPriority.Normal,persistencePriority:Ym.a.PersistencePriority.Normal}}!function(e){e[e.UxppRuntime=0]="UxppRuntime",e[e.PowerOptions=1]="PowerOptions",e[e.PowerQuery=2]="PowerQuery",e[e.DataCleansing=3]="DataCleansing"}(Km||(Km={}));var $m=n(122);let Xm,eb=void 0;class tb extends R.Component{componentDidUpdate(e){var t;this.isFirstRender&&(this.isFirstRender=!1),Object(x.isChangeGateEnabled)("OfficeVSO:8680670_SetSelectedQueryOnComponentUpdate")&&this.selection.setItems(this.props.queries,!1),e.selectedQueryKey!==this.props.selectedQueryKey&&this.state.selectedQueryKey!==this.props.selectedQueryKey&&this.props.selectedQueryKey&&(Object(x.isChangeGateEnabled)("OfficeVSO:8680670_SetSelectedQueryOnComponentUpdate")?(this.selection.setKeySelected(this.props.selectedQueryKey,!0,!0),this.setState({selectedQueryKey:this.props.selectedQueryKey}),null===(t=this.list.current)||void 0===t||t.forceUpdate()):(this.selection.setKeySelected(this.props.selectedQueryKey,!1,!0),this.setState({selectedQueryKey:this.props.selectedQueryKey}))),Object(x.isChangeGateEnabled)("OfficeVSO:8680670_SetSelectedQueryOnComponentUpdate")||this.selection.setItems(this.props.queries,!1)}render(){return this.paneDataUpdate=this.context.bind(this),this.dragAndDropEnabled?R.createElement(Kh.Consumer,null,e=>R.createElement(R.Suspense,{fallback:()=>(Object(Jm.a)().sendTelemetryEvent({eventName:"Office.Excel.Client.PowerQuery",dataFields:[Object($m.a)("ReactDND.Load.Fallback",!0)],eventFlags:Zm(Ym.a.DataCategories.ProductServiceUsage,Ym.a.DiagnosticLevel.RequiredServiceData,Ym.a.SamplingPolicy.CriticalBusinessImpact)}),this.getQueriesListJSX(e))},R.createElement(eb,{onRenderComponent:()=>this.getQueriesListJSX(e)}))):this.getQueriesListJSX(null)}getQueriesListJSX(e){this.paneData=e;const t=this.props.searchValueExists?this.filterGroups(this.props.groups):this.props.groups;return R.createElement("div",{"data-testid":"QueriesList",style:dm},R.createElement(yd.a,{selection:this.selection,selectionMode:_u.d.single},R.createElement(we.a,null,e=>R.createElement(zm.a,{componentRef:this.list,items:this.props.queries,onRenderCell:this.onRenderListItem,selectionMode:_u.d.single,focusZoneProps:{isCircularNavigation:!1,preventDefaultWhenHandled:!1,direction:qo.a.vertical,componentRef:this.focusZone},groups:t,groupProps:this.groupProps(e),compact:!0,selection:this.selection,onShouldVirtualize:this.onShouldVirtualize}))))}moveQueryOneLevel(e){var t,n;const o=this.selection.getSelectedIndices();if(1!==o.length)return;const r=o[0],i=this.props.queries[r],a=Object(Rm.d)(i.groupKey,[this.props.groups],e);void 0!==a&&(this.paneDataUpdate({draggedQueryName:i.name,groupKey:a,hoveredQueryName:void 0,searchValue:null===(t=this.paneData)||void 0===t?void 0:t.searchValue,draggedInitialIndex:this.isKeyboardDragging?null===(n=this.paneData)||void 0===n?void 0:n.draggedInitialIndex:r}),this.isKeyboardDragging||(this.isKeyboardDragging=!0))}moveQueryOneStep(e){const t=this.selection.getSelectedIndices();if(1!==t.length)return;const n=t[0],o=this.props.queries[n],r=Object(Rm.e)(n,this.props.queries.length,e),i=void 0!==r?this.props.queries[r]:void 0;if(i&&i.groupKey===o.groupKey){var a;this.paneDataUpdate({draggedQueryName:o.name,groupKey:void 0,hoveredQueryName:i.name,searchValue:null===(a=this.paneData)||void 0===a?void 0:a.searchValue})}else{var s,l;const t=Object(Rm.d)(o.groupKey,[this.props.groups],e);if(void 0===t)return;this.paneDataUpdate({draggedQueryName:o.name,groupKey:t,hoveredQueryName:void 0,searchValue:null===(s=this.paneData)||void 0===s?void 0:s.searchValue,draggedInitialIndex:this.isKeyboardDragging?null===(l=this.paneData)||void 0===l?void 0:l.draggedInitialIndex:n})}this.isKeyboardDragging||(this.isKeyboardDragging=!0)}commitOrCancelDragState(e){var t,n,o,r,l;if(this.isKeyboardDragging=!1,e){if(null!==(n=this.paneData)&&void 0!==n&&n.draggedQueryName&&null!=(null===(o=this.paneData)||void 0===o?void 0:o.groupKey)){var c;const e={name:null===(c=this.paneData)||void 0===c?void 0:c.draggedQueryName,extraData:""===this.paneData.groupKey?Rm.g:this.paneData.groupKey};this.props.callbacks.handleQueryAction(0,e)}else if(null!==(r=this.paneData)&&void 0!==r&&r.draggedQueryName&&null!==(l=this.paneData)&&void 0!==l&&l.hoveredQueryName&&this.shouldCallReorderAction()){var u,d;this.props.callbacks.handleQueryAction(3,{name:null===(u=this.paneData)||void 0===u?void 0:u.draggedQueryName,extraData:null===(d=this.paneData)||void 0===d?void 0:d.hoveredQueryName})}}else this.props.callbacks.onCancelKeyboardReorder();this.paneDataUpdate({draggedQueryName:void 0,groupKey:void 0,hoveredQueryName:void 0,searchValue:null===(t=this.paneData)||void 0===t?void 0:t.searchValue}),i.a.sendTraceTag(509658316,a.a.msoulscat_ES_EWAJS,s.a.Info,"QueriesList.commitOrCancelDragState: User exit the dragging state with commit:"+e)}getRenderGroupSectionFunction(e){return(t,n)=>{var o,r,i,a;return null!=t&&null!==(o=t.group)&&void 0!==o&&o.name&&-1!==(null==t||null===(r=t.group)||void 0===r?void 0:r.name.search(Rm.h))?R.createElement(R.Fragment,null," "):null!=t&&null!==(i=t.group)&&void 0!==i&&i.key&&this.props.getProperty("isPowerQueryEditEnabled")?this.dragAndDropEnabled&&Xm?R.createElement(R.Suspense,{fallback:()=>(Object(Jm.a)().sendTelemetryEvent({eventName:"Office.Excel.Client.PowerQuery",dataFields:[Object($m.a)("ReactDND.Group.Fallback",!0)],eventFlags:Zm(Ym.a.DataCategories.ProductServiceUsage,Ym.a.DiagnosticLevel.RequiredServiceData,Ym.a.SamplingPolicy.CriticalBusinessImpact)}),this.getGroupHeaderElement(t,n))},R.createElement(Xm,{id:null==t||null===(a=t.group)||void 0===a?void 0:a.key,type:"group",moveQueryCallback:this.async.debounce(this.moveQueryToGroup,5)},this.getGroupHeaderElement(t,n))):this.getGroupHeaderElement(t,n):n(_object_spread_props(_object_spread({},t),{selectionMode:_u.d.none,indentWidth:16,styles:Xh(e,null==t?void 0:t.groupLevel)}))}}toggleCollapseAll(e){var t;null===(t=this.list.current)||void 0===t||t.toggleCollapseAll(e)}setQuerySelected(e){var t;0!==e.fillObjectType&&2!==e.fillObjectType&&3!==e.fillObjectType||this.props.onQueySelected(e.name),this.selection.isKeySelected(e.name)||(this.isKeyboardDragging&&this.commitOrCancelDragState(!1),this.selection.setKeySelected(e.name,!0,!0),null===(t=this.list.current)||void 0===t||t.forceUpdate(),this.setState({selectedQueryKey:e.name}))}unselectQuery(){var e;if(0===this.selection.getSelectedCount())return;const t=this.props.queries[this.selection.getSelectedIndices()[0]];this.isKeyboardDragging&&this.commitOrCancelDragState(!1),this.selection.setKeySelected(t.name,!1,!1),this.setState({selectedQueryKey:""}),null===(e=this.list.current)||void 0===e||e.forceUpdate()}constructor(e){super(e),this.list=R.createRef(),this.selectedQuery=R.createRef(),this.focusZone=R.createRef(),this.async=new Ed.a,this.paneData=null,this.paneDataUpdate=e=>{},this.dragAndDropEnabled=this.props.getProperty("isPowerQueryEditEnabled"),this.isFirstRender=!1,this.isKeyboardDragging=!1,this.onShouldVirtualize=()=>!this.dragAndDropEnabled||!this.isFirstRender,this.filterGroups=e=>(null==e||e.forEach(e=>e.children=e.children&&0!==e.children.length?this.filterGroups(e.children):e.children),null==e?void 0:e.filter(e=>0!==e.count)),this.moveQuery=(e,t,n)=>{var o,r,i,a;let s=void 0;null!==(o=this.paneData)&&void 0!==o&&o.draggedQueryName||(s=this.props.queries.findIndex(t=>t.name===e));let l=(null===(r=this.props.queries)||void 0===r?void 0:r.find(e=>e.name===t)).groupKey;if(l.startsWith(Rm.h)&&(l=l.replace(Rm.h,"")),n){var c,u,d,p,g,h,m;if((null===(c=this.paneData)||void 0===c?void 0:c.draggedQueryName)===(null===(u=this.paneData)||void 0===u?void 0:u.hoveredQueryName)&&null!==(d=this.paneData)&&void 0!==d&&d.groupKey){const t={name:e,extraData:this.paneData.groupKey};this.props.callbacks.handleQueryAction(0,t)}else if((null===(p=this.paneData)||void 0===p?void 0:p.draggedQueryName)!==(null===(g=this.paneData)||void 0===g?void 0:g.hoveredQueryName)&&this.shouldCallReorderAction()){var b,f;this.props.callbacks.handleQueryAction(3,{name:null===(b=this.paneData)||void 0===b?void 0:b.draggedQueryName,extraData:null===(f=this.paneData)||void 0===f?void 0:f.hoveredQueryName})}this.paneDataUpdate({draggedQueryName:void 0,groupKey:void 0,hoveredQueryName:void 0,searchValue:null===(h=this.paneData)||void 0===h?void 0:h.searchValue,draggedInitialIndex:this.isKeyboardDragging?null===(m=this.paneData)||void 0===m?void 0:m.draggedInitialIndex:s})}else this.paneDataUpdate({draggedQueryName:e,groupKey:l,hoveredQueryName:t,searchValue:null===(i=this.paneData)||void 0===i?void 0:i.searchValue,draggedInitialIndex:this.isKeyboardDragging?null===(a=this.paneData)||void 0===a?void 0:a.draggedInitialIndex:s})},this.shouldCallReorderAction=()=>{var e;return this.props.queries.findIndex(e=>{var t;return e.name===(null===(t=this.paneData)||void 0===t?void 0:t.draggedQueryName)})!==(null===(e=this.paneData)||void 0===e?void 0:e.draggedInitialIndex)},this.moveQueryToGroup=(e,t,n)=>{var o;let r=t;if(t.startsWith(Rm.h)&&(r=t.replace(Rm.h,"")),n){const n={name:e,extraData:t};return this.props.callbacks.handleQueryAction(0,n),void this.onClearDragDropPreview()}this.paneDataUpdate({draggedQueryName:e,groupKey:r,hoveredQueryName:void 0,searchValue:null===(o=this.paneData)||void 0===o?void 0:o.searchValue})},this.onClearDragDropPreview=()=>{var e;this.paneDataUpdate({draggedQueryName:void 0,groupKey:void 0,hoveredQueryName:void 0,searchValue:null===(e=this.paneData)||void 0===e?void 0:e.searchValue})},this.onRenderListItem=(e,t,n)=>{if(void 0!==t)return this.dragAndDropEnabled&&Xm?R.createElement(R.Suspense,{fallback:()=>(Object(Jm.a)().sendTelemetryEvent({eventName:"Office.Excel.Client.PowerQuery",dataFields:[Object($m.a)("ReactDND.Query.Fallback",!0)],eventFlags:Zm(Ym.a.DataCategories.ProductServiceUsage,Ym.a.DiagnosticLevel.RequiredServiceData,Ym.a.SamplingPolicy.CriticalBusinessImpact)}),this.getQueryContainerElement(t,n))},R.createElement(Xm,{id:t.name,type:"query",index:void 0!==n?n:0,moveQueryCallback:this.async.debounce(this.moveQuery,5),draggable:t.name!==this.state.renamingQueryKey,onClearDragDropPreview:this.onClearDragDropPreview},this.getQueryContainerElement(t,n))):this.getQueryContainerElement(t,n)},this.onRenameStartedOrEndForQuery=e=>{var t;this.setState({renamingQueryKey:e}),null===(t=this.list.current)||void 0===t||t.forceUpdate()},this.getQueryContainer=(e,t,n)=>{const o=this.props.groups&&0!==this.props.groups.length,r=e?{forwardRef:this.selectedQuery,focusSelected:this.focusSelectedElementOnUpdate}:{};return R.createElement(Wm,_object_spread_props(_object_spread({query:t,id:void 0!==n?n+1:0,nestingDepth:t.nestingDepth,onQueryRefresh:this.props.onQueryRefresh,onQuerySelected:this.setQuerySelected,selected:e,shouldShowMoveQueryButton:o,queries:this.props.queries,onRenameStartedOrEnd:this.onRenameStartedOrEndForQuery},r),{getProperty:this.props.getProperty}))},this.getQueryContainerElement=(e,t)=>{var n;const o=ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.QueryAriaLabel).replace("{0}",(t+1).toString()).replace("{1}",this.props.queries.length.toString()),r=this.selection.isKeySelected(e.name);return R.createElement("div",{"aria-label":o,style:{opacity:this.isKeyboardDragging&&(null===(n=this.paneData)||void 0===n?void 0:n.draggedQueryName)===e.name?Rm.c:"unset"},onKeyDown:e=>{r&&this.onQueryKeydown(e)}},this.getQueryContainer(r,e,t))},this.focusSelectedElementOnUpdate=e=>{var t;(this.isKeyboardDragging||e)&&(null===(t=this.focusZone.current)||void 0===t||t.focusElement(this.selectedQuery.current))},this.getGroupHeaderElement=(e,t)=>R.createElement(hm.a,{disableTooltip:!this.props.getProperty("isTooltipEnabled")},R.createElement(Qm,{groupDividerProps:e,defaultRender:t,handleGroupOperation:this.props.handleGroupOperation,queries:this.props.queries,getProperty:this.props.getProperty})),this.groupProps=e=>({onRenderHeader:this.getRenderGroupSectionFunction(e),showEmptyGroups:!0}),this.onQueryKeydown=e=>{if(this.dragAndDropEnabled)if(e.repeat)e.stopPropagation();else if(e.shiftKey&&Object(Rm.f)(e)){let t=!0;switch(e.key){case"ArrowUp":this.moveQueryOneStep(Rm.b.Up);break;case"ArrowDown":this.moveQueryOneStep(Rm.b.Down);break;case"ArrowLeft":this.moveQueryOneLevel(Rm.b.Left);break;case"ArrowRight":this.moveQueryOneLevel(Rm.b.Right);break;default:t=!1}t&&e.stopPropagation()}else!this.isKeyboardDragging||e.shiftKey||Object(Rm.f)(e)?"ArrowUp"!==e.key&&"ArrowDown"!==e.key||this.unselectQuery():(this.commitOrCancelDragState("Enter"===e.key),e.stopPropagation())},this.onRenderListItem=this.onRenderListItem.bind(this),this.setQuerySelected=this.setQuerySelected.bind(this),this.selection=new ku.a({items:this.props.queries,selectionMode:_u.d.single}),this.selection.isRangeSelected=()=>!1,this.state={selectedQueryKey:"",renamingQueryKey:""},this.dragAndDropEnabled&&(eb=R.lazy(()=>Gs(()=>{n.e(34).then(n.bind(null,3095)).then(e=>{Xm=e.default}).catch(e=>{i.a.sendTraceTag(509872344,a.a.msoulscat_ES_EWAJS,s.a.Error,"QueriesList.ctor: cannot load draggableItem after loading react dnd, error:"+e),Object(Jm.a)().sendTelemetryEvent({eventName:"Office.Excel.Client.PowerQuery",dataFields:[Object($m.a)("ReactDND.Load.Failed",!0)],eventFlags:Zm(Ym.a.DataCategories.ProductServiceUsage,Ym.a.DiagnosticLevel.RequiredServiceData,Ym.a.SamplingPolicy.CriticalBusinessImpact)})})})))}}tb.contextType=Jh;var nb=n(1600),ob=n(3),rb=n(709),ib=n(42),ab=n(454),sb={root:"ms-CardItem"},lb={padding:0},cb={margin:0},ub=Object(nb.a)((function(e){var t=Object(rb.b)(e,{root:At.a.Item});return Object(rb.c)(t.root,Object(ob.__assign)({},e))}),{displayName:"CardItem",styles:function(e,t,n){var o=Object(F.R)(sb,t);return{root:[t.fonts.large,o.root,{margin:n.margin,padding:n.padding}]}},tokens:function(e,t){return[lb,e.fill&&cb]}}),db={root:"ms-CardSection"},pb={padding:0},gb={margin:0},hb=Object(nb.a)((function(e){var t=e.children,n=Object(ob.__rest)(e,["children"]);if(R.Children.count(t)<1)return null;var o=Object(rb.b)(e,{root:At.a});return Object(rb.c)(o.root,Object(ob.__assign)({},n),t)}),{displayName:"CardSection",styles:function(e,t,n){var o=Object(F.R)(db,t);return{root:[t.fonts.large,o.root,{margin:n.margin,padding:n.padding}]}},tokens:function(e,t){return[pb,e.fill&&gb]}});function mb(e){return!!e&&"object"==typeof e&&!!e.type}var bb={root:"ms-Card"},fb=function(e,t){return{boxShadow:t.effects.elevation4,childrenGap:12,childrenMargin:0,cursor:"default",height:"inherit",highContrastBoxShadow:"0 1.6px 3.6px 0 Highlight, 0 0.3px 0.9px 0 Highlight",minHeight:"348px",minWidth:"212px",maxWidth:"286px"}},xb={height:"auto",minWidth:"300px",maxWidth:"500px"},Eb=function(e,t){var n=t.effects;return{borderFocused:"1px solid black",boxShadowFocused:n.elevation8,boxShadowHovered:n.elevation8,cursor:"pointer",highContrastBoxShadowHovered:"0 3.2px 7.2px 0 Highlight, 0 0.6px 1.8px 0 Highlight"}},Sb={Item:ub,Section:hb},yb=Object(nb.a)((function(e){var t=Object(rb.b)(e,{root:At.a}),n=e.children,o=(e.styles,e.tokens),r=e.horizontal,i=e.onClick,a=e.onKeyDown,s=Object(ob.__rest)(e,["children","styles","tokens","horizontal","onClick","onKeyDown"]),l=Object(ib.j)(s,ib.k),c=o&&o.childrenGap,u=o&&o.childrenMargin,d=R.Children.count(n),p=R.Children.map(n,(function(e,t){if(!e)return null;var n,o=mb(n=e)&&n.type.displayName===ub.displayName,i=function(e){return mb(e)&&e.type.displayName===hb.displayName}(e);if(o||i){if(!c&&!u)return e;var a=e.props,s=a.fill,l=a.tokens,p=Object(ob.__rest)(a,["fill","tokens"]),g=0;if(u&&!s){var h=0===t?u:0,m=t===d-1?u:0;g=r?u+"px "+m+"px "+u+"px "+h+"px":h+"px "+u+"px "+m+"px"}var b=Object(ob.__assign)({margin:g,childrenGap:i?c:void 0},l);return R.cloneElement(e,Object(ob.__assign)({tokens:b},p))}return Object(ab.b)("The children of a Card component should be of type CardItem or CardSection."),e}));return Object(rb.c)(t.root,Object(ob.__assign)({onClick:i,onKeyDown:function(e){a?a(e):i&&e&&(e.which===xe.a.enter||e.which===xe.a.space)&&(i(),e.preventDefault())},role:i?"button":"presentation",tabIndex:i?0:-1},l,{horizontal:r,horizontalAlign:r?"start":"stretch",tokens:o,verticalAlign:"start",verticalFill:!0}),p)}),{displayName:"Card",styles:function(e,t,n){var o,r,i;return{root:[Object(F.R)(bb,t).root,{borderRadius:"2px",boxShadow:n.boxShadow,cursor:n.cursor,height:n.height,maxWidth:n.maxWidth,minWidth:n.minWidth,outline:"none",transition:"box-shadow 0.5s ease",width:n.width,selectors:(o={":focus":{border:n.borderFocused,boxShadow:n.boxShadowFocused,selectors:(r={},r[F.m]={boxShadow:n.highContrastBoxShadowFocused},r)},":hover":{boxShadow:n.boxShadowHovered,selectors:(i={},i[F.m]={boxShadow:n.highContrastBoxShadowHovered},i)}},o[F.m]={boxShadow:n.highContrastBoxShadow},o)}]}},tokens:function(e,t){return[fb,e.horizontal&&xb,e.onClick&&Eb]},statics:Sb});const Cb=(e,t)=>t?Object(F.I)(vb(e),Tb(e)):vb(e),vb=e=>{var t,n,o,r;return{root:{height:"50px",padding:"2px 0px 2px 3px",margin:"3px 8px 3px 8px",boxShadow:"none",background:"none",maxWidth:"inherit",selectors:{":hover":[{backgroundColor:null===(t=e.semanticColors)||void 0===t?void 0:t.listItemBackgroundHovered},ci.n],":focus":{selectors:{":focus":[{backgroundColor:null===(n=e.semanticColors)||void 0===n?void 0:n.listItemBackgroundChecked},ci.n],":focus:hover":[{backgroundColor:null===(o=e.semanticColors)||void 0===o?void 0:o.listItemBackgroundCheckedHovered},ci.n],":active":[{backgroundColor:null===(r=e.semanticColors)||void 0===r?void 0:r.listItemBackgroundChecked},ci.n]}}}}}},Rb=Object(Jo.c)((e,t)=>({root:[{float:"left",padding:"0",width:"97%",minWidth:"0",flex:"1"}],label:[e&&{height:"26px",whiteSpace:"nowrap",fontWeight:"600",overflow:"hidden",textOverflow:"ellipsis",marginLeft:"5px",padding:"0px 0px 2px 0px",position:"relative"},!e&&{whiteSpace:"nowrap",fontWeight:"normal",overflow:"hidden",textOverflow:"ellipsis",marginTop:"0px",marginLeft:"7px",padding:"0px 0px 0px 0px",fontSize:"12px"},{selectors:{[F.m]:{color:t?"HighlightText":"inherit"}}}]})),kb=Object(Jo.c)(()=>({root:{flex:1,minWidth:0}})),Tb=e=>{var t;return{root:{border:"none",backgroundColor:null===(t=e.semanticColors)||void 0===t?void 0:t.listItemBackgroundChecked,commonHighContrastHoverFocusStyles:ci.n}}};function _b(e){var t,n;return{root:{backgroundColor:"transparent",height:"20px",padding:"1px",border:"0px",borderColor:"transparent",width:"20px"},rootDisabled:{backgroundColor:"transparent",height:"20px",padding:"1px",border:"0px",borderColor:"transparent",width:"20px"},rootHovered:{backgroundColor:null==e||null===(t=e.semanticColors)||void 0===t?void 0:t.buttonBackgroundHovered,height:"20px",padding:"1px",border:"0px",borderColor:"transparent",width:"20px"},rootPressed:{backgroundColor:null==e||null===(n=e.semanticColors)||void 0===n?void 0:n.buttonBackgroundHovered,height:"20px",padding:"1px",border:"0px",borderColor:"transparent",width:"20px"}}}const wb={height:"20px",width:"20px"},Db=e=>{const{styles:t,partialTheme:n}=e,o=_object_without_properties(e,["styles","partialTheme"]),r=(e=>{var t;const{borderRadius:n,buttonBorderLine:o}=Object(R.useContext)(Tm);return{root:{borderRadius:n,selectors:{":focus":[{border:`${o} solid ${null===(t=e.semanticColors)||void 0===t?void 0:t.focusBorder}`}]}}}})(n);return R.createElement(yb,_object_spread_props(_object_spread({},o),{styles:Object(F.I)(e.styles,r)}))};class Pb extends R.Component{onHover(){this.menuShown||this.setState({isFocused:!1,isSelected:!1,isHovered:!0})}onNotHover(){this.menuShown||this.setState({isFocused:!1,isSelected:!1,isHovered:!1})}onFocus(){this.menuShown||this.setState({isFocused:!0,isSelected:!0,isHovered:!1})}onBlur(){this.menuShown||this.setState({isFocused:!1,isSelected:!1,isHovered:!1})}onCardSectionKeyDown(e){var t;this.state.isContextMenuSectionFocused||!e||e.keyCode!==xe.a.enter&&e.which!==xe.a.space||(null===(t=this.card.current)||void 0===t||t.click(),e.preventDefault())}componentDidMount(){if(1===this.props.id){const e=document.getElementById("PowerQueryConnectionContainerId-"+this.props.id);e&&e.focus()}}componentDidUpdate(e){var t;if(null!==(t=this.state)&&void 0!==t&&t.isFocused){const e=document.getElementById("PowerQueryConnectionContainerId-"+this.props.id);e&&e.focus()}}onRenderTitle(){var e;return R.createElement(Yl.a,{type:"AppLabelProps",id:"ConnectionName-"+this.props.id,forId:"ConnectionName-"+this.props.id,label:this.props.connection.name,styles:Rb(!0,null===(e=this.state)||void 0===e?void 0:e.isHovered),customTooltip:this.props.connection.name})}render(){const e=this.isContextMenuShown();return R.createElement(we.a,null,t=>R.createElement(bm.Consumer,null,n=>{var o,r,i,a,s,l;return R.createElement("div",{ref:this.card},R.createElement(Db,{id:"PowerQueryConnectionContainerId-"+this.props.id,horizontal:!1,styles:Cb(t,null===(o=this.state)||void 0===o?void 0:o.isSelected),"data-is-focusable":!0,onFocus:this.onFocus,onBlur:this.onBlur,onMouseOver:this.onHover,onMouseLeave:this.onNotHover,onKeyDown:this.onCardSectionKeyDown,onClick:this.onFocus,partialTheme:t},R.createElement(yb.Section,{horizontal:!0},R.createElement(yb.Section,null,this.props.connection.inRefresh?R.createElement(gm.a,{type:"AppSpinnerProps",id:"ConnectionRefreshSpinner"+this.props.id,spinnerSize:Yp.a.medium,appColors:Object(b.a)(),styles:{circle:[{borderBottomColor:null===(r=t.palette)||void 0===r?void 0:r.neutralQuaternary,borderLeftColor:null===(i=t.palette)||void 0===i?void 0:i.neutralQuaternary,borderRightColor:null===(a=t.palette)||void 0===a?void 0:a.neutralQuaternary,borderTopColor:null===(s=t.palette)||void 0===s?void 0:s.black}]}}):R.createElement(fe.a,{style:wb,iconName:be.a.Table_20})),R.createElement(yb.Section,{horizontal:!1,styles:kb},R.createElement(yb.Section,{horizontal:!0},R.createElement(hm.a,{disableTooltip:!this.props.getProperty("isTooltipEnabled")},this.onRenderTitle()),e&&R.createElement(Cd.a,{onFocus:()=>this.setIsContextMenuSectionFocused(!0),onBlur:()=>this.setIsContextMenuSectionFocused(!1)},this.getContextMenu(n,t))),R.createElement(yb.Section,{horizontal:!1},R.createElement(Yl.a,{type:"AppLabelProps",id:"ConnectionDescription-"+this.props.id,forId:"ConnectionDescription-"+this.props.id,label:this.props.connection.description,styles:Rb(!1,null===(l=this.state)||void 0===l?void 0:l.isHovered)}))))))}))}constructor(e){super(e),this.card=R.createRef(),this.menuShown=!1,this.paneLayoutUpdate=e=>{},this.isContextMenuShown=()=>{var e,t;return this.props.getProperty("isPowerQueryTaskPaneConnectionActionsEnabled")&&((null===(e=this.state)||void 0===e?void 0:e.isFocused)||(null===(t=this.state)||void 0===t?void 0:t.isHovered)||this.menuShown)},this.shouldDisableRefreshButton=()=>this.props.connection.loadedToDataModel||1===this.props.connection.fillObjectType||!this.props.connection.refreshEnabled||this.props.connection.inRefresh,this.setIsContextMenuSectionFocused=e=>{this.setState({isContextMenuSectionFocused:e})},this.onMenuShowHide=e=>{this.menuShown=e,this.setState({isFocused:!1,isHovered:!1})},this.onRefresh=()=>{this.props.onLegacyConnectionRefresh(this.props.connection.name)},this.onCancelRefresh=e=>{e.onLegacyConnectionCancelRefresh(this.props.connection.name)},this.onConnectionDelete=e=>{e.onLegacyConnectionDelete(this.props.connection.name)},this.getRefreshOrCancelButton=(e,t)=>{if(this.props.connection.inRefresh&&Object(x.isChangeGateEnabled)("OfficeVSO:7111771_PowerQueryRefreshWeb")){const n=Object(Rm.l)(ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.Cancel),"ExternalCancelRefreshButton-",()=>this.onCancelRefresh(t),Po.a.closeIcon,!1,e),{styles:o}=n,r=_object_without_properties(n,["styles"]);return R.createElement(wm,_object_spread_props(_object_spread({},r),{hideLabel:!0,styles:Object(F.I)(o,_b(e),Object(Zh.d)(e))}))}const n=Object(Rm.l)(ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.Refresh),"ExternalRefreshButton-",this.onRefresh,be.a.RefreshConnection_20,this.shouldDisableRefreshButton(),e),{styles:o}=n,r=_object_without_properties(n,["styles"]);return R.createElement(wm,_object_spread_props(_object_spread({},r),{hideLabel:!0,styles:Object(F.I)(o,_b(e),Object(Zh.d)(e))}))},this.getMenuDefinition=(e,t)=>{const n={sections:[{controls:[]}]},o=n.sections[0].controls;return o.push(Object(Rm.l)(ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.Refresh),"ConnectionRefreshButton-",this.onRefresh,be.a.RefreshConnection_20,this.shouldDisableRefreshButton(),t)),o.push(Object(Rm.l)(ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.DeleteQueryOption),"ConnectionDeleteButton-",()=>this.onConnectionDelete(e),be.a.Delete_20,this.props.connection.inRefresh,t)),n},this.getContextMenu=(e,t)=>R.createElement(Am,{id:"Connection-"+this.props.id.toString(),onMenuShowHide:this.onMenuShowHide,getRefreshOrCancelButton:()=>this.getRefreshOrCancelButton(t,e),menuDefinition:this.getMenuDefinition(e,t),shouldRenderOtherOptions:!0,styles:Object(Zh.d)(t),getProperty:this.props.getProperty}),this.onHover=this.onHover.bind(this),this.onNotHover=this.onNotHover.bind(this),this.onFocus=this.onFocus.bind(this),this.onBlur=this.onBlur.bind(this),this.onCardSectionKeyDown=this.onCardSectionKeyDown.bind(this),this.onRenderTitle=this.onRenderTitle.bind(this),this.isContextMenuShown=this.isContextMenuShown.bind(this),this.shouldDisableRefreshButton=this.shouldDisableRefreshButton.bind(this),this.setIsContextMenuSectionFocused=this.setIsContextMenuSectionFocused.bind(this),this.onMenuShowHide=this.onMenuShowHide.bind(this),this.onRefresh=this.onRefresh.bind(this),this.onCancelRefresh=this.onCancelRefresh.bind(this),this.onConnectionDelete=this.onConnectionDelete.bind(this),this.setState({isHovered:!1,isFocused:!1,isSelected:!1,isContextMenuSectionFocused:!1})}}Pb.contextType=bm;class Ib extends R.Component{render(){return R.createElement(zm.a,{role:"list",items:this.props.connections,onRenderCell:this.onRenderListItem,selection:this.selection,compact:!0,focusZoneProps:{isCircularNavigation:!1,preventDefaultWhenHandled:!1,direction:qo.a.vertical,componentRef:this.focusZone}})}componentDidUpdate(e){const[t]=this.selection.getSelection();this.selection.setItems(this.props.connections,!1),t?this.selection.setKeySelected(t.key,!0,!0):e.connections&&0!==e.connections.length||this.selection.setIndexSelected(0,!0,!0)}constructor(e){super(e),this.focusZone=R.createRef(),this.onRenderListItem=(e,t,n)=>{if(void 0===t)return;const o=(null!=n?n:0)+1,r=ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.ConnectionAriaLabel).replace("{0}",o.toString()).replace("{1}",this.props.connections.length.toString());return R.createElement("div",{"aria-label":r},R.createElement(Pb,{connection:t,id:o,onLegacyConnectionRefresh:this.props.onLegacyConnectionRefresh,onLegacyConnectionCancelRefresh:this.props.onLegacyConnectionCancelRefresh,onLegacyConnectionDelete:this.props.onLegacyConnectionDelete,getProperty:this.props.getProperty}))},this.onRenderListItem=this.onRenderListItem.bind(this),this.selection=new ku.a({items:this.props.connections,selectionMode:_u.d.single})}}const Fb=e=>{var t;const{children:n,partialTheme:o}=e,r=_object_without_properties(e,["children","partialTheme"]),i=null===(t=(e=>{var t,n;const{borderRadius:o}=Object(R.useContext)(Tm);return{styles:{root:{selectors:{":active":[{backgroundColor:null===(t=e.semanticColors)||void 0===t?void 0:t.listItemBackgroundHovered}],":hover":[{borderRadius:o,backgroundColor:null===(n=e.semanticColors)||void 0===n?void 0:n.listItemBackgroundHovered}]}}}}})(o))||void 0===t?void 0:t.styles,a=[];return R.Children.forEach(n,e=>{if(R.isValidElement(e)){var t;const n=e.props,{headerButtonProps:o}=n,r=_object_without_properties(n,["headerButtonProps"]);a.push(R.createElement($s.a,_object_spread_props(_object_spread({},r),{headerButtonProps:{styles:Object(F.I)(null===(t=e.props.headerButtonProps)||void 0===t?void 0:t.styles,i)}})))}}),R.createElement(Zs.a,_object_spread({},r),a)},Bb={root:{marginRight:"8px"}},Mb={root:{marginRight:"4px"}},jb={paddingTop:"1px",height:"100%",width:"100%"},Ob={link:{marginTop:"1px",marginLeft:"1px",selectors:{":hover":{cursor:"auto"}}}},Lb=e=>{const{partialTheme:t}=e,n=_object_without_properties(e,["partialTheme"]),o=(e=>{var t,n;const{borderRadius:o}=Object(R.useContext)(Tm);return{root:{margin:"6px 8px 6px 7px",background:null===(t=e.semanticColors)||void 0===t?void 0:t.inputBackground,justifyContent:"center",alignItems:"center",selectors:{"::after":{borderColor:null===(n=e.palette)||void 0===n?void 0:n.themePrimary,borderRadius:o}}}}})(t);return R.createElement(Ud.a,_object_spread_props(_object_spread({},n),{styles:o}))};class Ab extends R.Component{componentDidUpdate(e){var t,n;null==e.queries&&null!=this.props&&0===(null===(t=this.props.queries)||void 0===t?void 0:t.length)&&(null===(n=this.queriesCountContainerRef.current)||void 0===n||n.focus())}render(){return R.createElement(we.a,null,e=>R.createElement("div",{style:jb},R.createElement(Fb,{partialTheme:e,styles:Object(x.isChangeGateEnabled)("OfficeVSO:8374443_QueriesConnectionA11yFix")?Ob:void 0,onLinkClick:e=>{var t;Object(Jm.a)().sendTelemetryEvent({eventName:"Office.Excel.Client.PowerQuery",dataFields:[Object($m.d)("Tab.Clicked",null!==(t=null==e?void 0:e.props.itemKey)&&void 0!==t?t:"")],eventFlags:Zm(Ym.a.DataCategories.ProductServiceUsage,Ym.a.DiagnosticLevel.RequiredServiceData,Ym.a.SamplingPolicy.CriticalBusinessImpact)})}},R.createElement($s.a,{itemKey:"Queries",headerText:ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.QueriesTaskPaneTab)},this.getQueriesTaskPane()),R.createElement($s.a,{itemKey:"Connections",headerText:ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.ConnectionsTaskPaneTab)},this.getConnectionsTaskPane()))))}constructor(e){super(e),this.queriesCountContainerRef=R.createRef(),this.queriesListRef=R.createRef(),this.connectionsListRef=R.createRef(),this.asyncInstance=new Ed.a,this.isProtectedWorkbook=!1,this.getQueriesCountLabel=e=>this.props.searchValue?0===e?ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.QueriesSearchNoQueriesFound):1===e?ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.QueriesSearchOneQueryFound):ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.QueriesSearchNumQueriesFound).replace("{0}",e.toString()):1===e?ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.OneQueryTaskpaneHeadline):ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.QueriesCountTaskpaneHeadline).replace("{0}",e.toString()),this.getConnectionsCountLabel=e=>1===e?ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.OneConnectionTaskpaneHeadline):ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.ConnectionsCountTaskpaneHeadline).replace("{0}",e.toString()),this.filterConnections=()=>{var e;return null===(e=this.props.connections)||void 0===e?void 0:e.filter((e,t)=>!(null==e||!e.name)||(i.a.sendTraceTag(512288606,a.a.msoulscat_ES_EWAJS,s.a.Error,"PowerQueryTaskPane.filterConnections: Unknown connection name at index "+t),!1)).map(e=>({name:e.name,description:e.description,fillObjectType:e.fillObjectType,loadedToDataModel:e.loadedToDataModel,inRefresh:e.inRefresh,refreshEnabled:e.refreshEnabled}))},this.filterQueries=()=>{var e;return null===(e=this.props.queries)||void 0===e?void 0:e.filter((e,t)=>!(!e||!e.name)||(i.a.sendTraceTag(540374725,a.a.msoulscat_ES_EWAJS,s.a.Error,"PowerQueryTaskPane.filterQueries: Unknown query name in index"+t),!1))},this.filterGroups=()=>{var e;return null===(e=this.props.groups)||void 0===e?void 0:e.filter((e,t)=>!!(e&&e.name&&e.key)||(i.a.sendTraceTag(540374726,a.a.msoulscat_ES_EWAJS,s.a.Error,"PowerQueryTaskPane.ctor: Unknown group name or key in index"+t),!1))},this.buildQueriesWithKeys=()=>{var e;return null===(e=this.filterQueries())||void 0===e?void 0:e.map(e=>_object_spread_props(_object_spread({},e),{key:null==e?void 0:e.name}))},this.getRefreshButton=(e,t,n)=>{const o=Object(Rm.l)(ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.RefreshAll),e,t,be.a.RefreshConnection_20,this.shouldDisableRefreshButton(),n),{styles:r}=o,i=_object_without_properties(o,["styles"]);return R.createElement(wm,_object_spread_props(_object_spread({},i),{hideLabel:!0,styles:Object(F.I)(r,am(n))}))},this.getConnectionsRefreshButton=(e,t,n)=>{const o=Object(Rm.l)(ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.RefreshAll),e,t,be.a.RefreshConnection_20,this.shouldDisableConnectionsRefreshButton(),n),{styles:r}=o,i=_object_without_properties(o,["styles"]);return R.createElement(wm,_object_spread_props(_object_spread({},i),{hideLabel:!0,styles:Object(F.I)(r,am(n))}))},this.getClearPermissionsSection=e=>{const t={controls:[]};return t.controls.push(Object(Rm.l)(ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.ClearAllPermissions),"ClearAllPermissions-",()=>{var e;return null===(e=this.props.callbacks)||void 0===e?void 0:e.onClearAllCredentials()},be.a.DeleteHyperlink_20,!1,e)),t},this.getCollapseExpandButtonsSection=e=>{const t={controls:[]},n=t.controls;return n.push(Object(Rm.l)(ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.ExpandAllOption),"ExpandAllButton-",()=>{this.toggleCollapseAll(!1)},void 0,!this.props.groups||0===this.props.groups.length,e)),n.push(Object(Rm.l)(ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.CollapseAllOption),"CollapseAllButton-",()=>{this.toggleCollapseAll(!0)},void 0,!this.props.groups||0===this.props.groups.length,e)),t},this.getGeneralMenuDefinition=(e,t)=>{const n={sections:[]};if(this.props.getProperty("isPowerQueryEditEnabled")){const e=[];if(this.props.getProperty("Microsoft.Office.Excel.PowerQueryPaste")){var o=this;e.push(Object(Rm.l)(ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.PasteOption),"Paste-TopLevel",_async_to_generator((function*(){var e,t;const n=yield Object(Rm.m)(null===(e=o.props.callbacks)||void 0===e?void 0:e.showClipboardAccessPermissionDialog);null===(t=o.props.callbacks)||void 0===t||t.onPowerQueryPaste(null,n.queries,n.queryGroups)})),be.a.Paste_24,!this.state.isPasteEnabled,t))}if(this.props.getProperty("Microsoft.Office.Excel.PowerQueryCopy")){var r=this;e.push(Object(Rm.l)(ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.CopyOption),"Copy-TopLevel",_async_to_generator((function*(){var e,t;yield Object(Rm.r)(Rm.k,(null!==(e=r.props.groups)&&void 0!==e?e:[]).filter(e=>!!e),(null!==(t=r.props.queries)&&void 0!==t?t:[]).filter(e=>!!e))})),be.a.Copy_24,!(this.props.queries&&0!==this.props.queries.length||this.props.groups&&0!==this.props.groups.length),t))}e.length>0&&n.sections.push({controls:e})}const i=[];return i.push(Object(Rm.l)(ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.CreateNewGroupOption),"NewGroupButton-",()=>{var t,n;e({type:Em.GroupProperties,groupOperation:0,groupSiblingsNames:null!==(t=null===(n=this.props.groups)||void 0===n?void 0:n.map(e=>null==e?void 0:e.name))&&void 0!==t?t:[]})},be.a.AddQueryGroup_16,this.isProtectedWorkbook,t)),n.sections.push({controls:i}),n.sections.push(this.getCollapseExpandButtonsSection(t)),this.props.getProperty("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh")&&this.props.getProperty("Microsoft.Office.Excel.PowerQueryClearAllCredentialTaskPane")&&n.sections.push(this.getClearPermissionsSection(t)),n};var t,n=this;this.onMenuShowHide=(t=_async_to_generator((function*(e){if(!e||!n.props.getProperty("Microsoft.Office.Excel.PowerQueryPaste"))return;const t=yield Object(Rm.i)();t&&!n.state.isPasteEnabled?n.setState({isPasteEnabled:!0}):!t&&n.state.isPasteEnabled&&n.setState({isPasteEnabled:!1})})),function(e){return t.apply(this,arguments)}),this.getGeneralContextMenu=(e,t,n)=>R.createElement(hm.a,{disableTooltip:!this.props.getProperty("isTooltipEnabled")},R.createElement(Am,{id:"GeneralContextMenu",getRefreshOrCancelButton:()=>this.getRefreshButton("TopLevelRefreshButton-",()=>{this.onRefreshAll(e.onQueryRefresh)},n),styles:Bb,menuDefinition:this.getGeneralMenuDefinition(t,n),shouldRenderOtherOptions:this.props.getProperty("isPowerQueryEditEnabled"),onMenuShowHide:this.onMenuShowHide,getProperty:this.props.getProperty})),this.getQueriesTaskPane=()=>{const e=this.buildQueriesWithKeys(),t=Object(Rm.j)(this.filterGroups());return R.createElement(we.a,null,n=>R.createElement(bm.Consumer,null,o=>{var r,i;return R.createElement("div",null,null==e&&R.createElement("div",{className:Object(Zh.a)(),"data-testid":"PowerQueryTaskPaneSpinner"},R.createElement(gm.a,{type:"AppSpinnerProps",id:"PowerQueryTaskPaneSpinner",appColors:Object(b.a)(),label:ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.SpinnerLoadingLabel)})),null!=e&&R.createElement("div",{"aria-live":"assertive","aria-label":ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.QueriesTaskpaneAriaLabel),style:Zh.c},R.createElement(Lb,{type:"AppSearchBoxProps",id:"searchQueriesId",iconColor:null===(r=n.palette)||void 0===r?void 0:r.neutralSecondaryAlt,icon:"Search",shouldFlipIcon:Object(de.f)(),onChange:this.asyncInstance.debounce(this.onSearchTextChanged,Rm.a),autoComplete:"off",value:this.props.searchValue,placeholder:ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.QueriesSearchPlaceholder),maxLength:Rm.q,partialTheme:n}),R.createElement("div",{tabIndex:0,ref:this.queriesCountContainerRef},R.createElement(At.a,{horizontal:!0,horizontalAlign:"space-between",verticalAlign:"center",styles:Object(Zh.d)(n)},R.createElement(At.a.Item,{grow:1},R.createElement(Yl.a,{type:"AppLabelProps",id:"QueriesCount",forId:"QueriesCount-"+e.length,label:this.getQueriesCountLabel(e.length),styles:Zh.b})),R.createElement(ym.Consumer,null,e=>R.createElement(At.a.Item,{grow:0},(Object(x.isChangeGateEnabled)("OfficeVSO:7111771_PowerQueryRefreshWeb")&&this.props.getProperty("isAADDocumentHost")||this.props.getProperty("isPowerQueryEditEnabled"))&&this.getGeneralContextMenu(o,e,n))))),R.createElement(tb,{queries:e,groups:t,onQueySelected:this.props.callbacks.onQuerySelected,onQueryRefresh:null===(i=this.props.callbacks)||void 0===i?void 0:i.onQueryRefresh,searchValueExists:!!this.props.searchValue&&0!==this.props.searchValue.length,handleGroupOperation:this.props.callbacks.handleQueryGroupOperation,selectedQueryKey:this.props.selectedQueryKey,ref:this.queriesListRef,callbacks:o,getProperty:this.props.getProperty})))}))},this.getConnectionsMenuDefinition=(e,t)=>{const n={sections:[{controls:[]}]};return n.sections[0].controls.push(Object(Rm.l)(ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.RefreshAll),"ConnectionsRefreshAllButton-",()=>{this.onRefreshAllConnections(e.onLegacyConnectionRefresh)},be.a.RefreshConnection_20,this.shouldDisableConnectionsRefreshButton(),t)),n},this.getConnectionsContextMenu=(e,t)=>R.createElement(Am,{id:"ConnectionsContextMenu-",getRefreshOrCancelButton:()=>this.getConnectionsRefreshButton("ConnectionsRefreshAllButton-",()=>{this.onRefreshAllConnections(e.onLegacyConnectionRefresh)},t),styles:Mb,menuDefinition:this.getConnectionsMenuDefinition(e,t),shouldRenderOtherOptions:this.props.getProperty("isPowerQueryTaskPaneConnectionActionsEnabled"),getProperty:this.props.getProperty}),this.getConnectionsTaskPane=()=>{var e;const t=null===(e=this.filterConnections())||void 0===e?void 0:e.map(e=>_object_spread_props(_object_spread({},e),{key:null==e?void 0:e.name}));return R.createElement(we.a,null,e=>R.createElement(bm.Consumer,null,n=>{var o,r,i;return R.createElement("div",null,null==t&&R.createElement("div",{className:Object(Zh.a)()},R.createElement(gm.a,{type:"AppSpinnerProps",id:"PowerQueryConnectionsTaskPaneSpinner",appColors:Object(b.a)(),label:ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.SpinnerLoadingLabel)})),null!=t&&R.createElement("div",{"aria-live":"assertive","aria-label":ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.ConnectionsTaskpaneAriaLabel),style:Zh.c},R.createElement("div",{tabIndex:0},R.createElement(At.a,{horizontal:!0,horizontalAlign:"space-between",verticalAlign:"center",styles:Mb},R.createElement(At.a.Item,{grow:1},R.createElement(Yl.a,{type:"AppLabelProps",id:"ConnectionsCount",forId:"ConnectionsCount-0",label:this.getConnectionsCountLabel(t.length),styles:Zh.b})),R.createElement(At.a.Item,{grow:0,styles:Object(Zh.d)(e)},this.props.getProperty("isPowerQueryTaskPaneConnectionActionsEnabled")&&this.getConnectionsContextMenu(n,e)))),R.createElement(Ib,{connections:t,ref:this.connectionsListRef,onLegacyConnectionRefresh:null===(o=this.props.callbacks)||void 0===o?void 0:o.onLegacyConnectionRefresh,onLegacyConnectionCancelRefresh:null===(r=this.props.callbacks)||void 0===r?void 0:r.onLegacyConnectionCancelRefresh,onLegacyConnectionDelete:null===(i=this.props.callbacks)||void 0===i?void 0:i.onLegacyConnectionDelete,callbacks:n,getProperty:this.props.getProperty})))}))},this.toggleCollapseAll=e=>{var t;null===(t=this.queriesListRef.current)||void 0===t||t.toggleCollapseAll(e)},this.onRefreshAll=e=>{var t;null===(t=this.props.queries)||void 0===t||t.forEach(t=>{!Object(Rm.o)(t)||Object(x.isChangeGateEnabled)("OfficeVSO:8619231_FixRefreshAllInTaskpaneEnabled")&&t.propertiesControls&&void 0!==t.propertiesControls.isRefreshOnRefreshAllEnabled&&!t.propertiesControls.isRefreshOnRefreshAllEnabled||e(null==t?void 0:t.name)})},this.onRefreshAllConnections=e=>{var t;null===(t=this.props.connections)||void 0===t||t.forEach(t=>{Object(Rm.o)(t)&&e(null==t?void 0:t.name)})},this.shouldDisableRefreshButton=()=>{var e;return!(null!==(e=this.props.queries)&&void 0!==e&&e.some(e=>Object(Rm.o)(e)))},this.shouldDisableConnectionsRefreshButton=()=>{var e;return!(null!==(e=this.props.connections)&&void 0!==e&&e.some(e=>Object(Rm.o)(e)))},this.onSearchTextChanged=(e,t)=>{this.context({searchValue:t})},this.isProtectedWorkbook=Object(x.isChangeGateEnabled)("OfficeVSO:8318223_DisableEditOperationsForStructureProtected")&&this.props.getProperty("isDocumentStructureLocked"),this.state={isPasteEnabled:!1}}}function Nb(e){var t;return{root:{top:"3px",bottom:"5px",fontSize:"12px",lineHeight:"16px",padding:"0px"},label:{fontWeight:F.l.semibold,color:null===(t=e.semanticColors)||void 0===t?void 0:t.inputText}}}function Wb(e){return t=>{var n,o,r,i,a;return{root:{background:null===(n=e.semanticColors)||void 0===n?void 0:n.inputBackground},fieldGroup:{border:"1px solid",borderColor:t.focused?null===(o=e.semanticColors)||void 0===o?void 0:o.focusBorder:null===(r=e.semanticColors)||void 0===r?void 0:r.inputBorder,boxSizing:"border-box",borderRadius:F.e.roundedCorner2,color:null===(i=e.semanticColors)||void 0===i?void 0:i.inputText,backgroundColor:null===(a=e.semanticColors)||void 0===a?void 0:a.inputBackground},field:{fontSize:"12px",lineHeight:"16px",height:"48px"}}}}function zb(e){var t,n,o,r;return{root:{width:"fit-content",padding:"5px 20px",backgroundColor:null===(t=e.semanticColors)||void 0===t?void 0:t.buttonBackground},label:{fontSize:"12px",lineHeight:"16px",textAlign:"center",fontWeight:F.l.semibold,[F.m]:{color:"inherit"}},rootHovered:{backgroundColor:null===(n=e.semanticColors)||void 0===n?void 0:n.buttonBackgroundHovered},rootPressed:{backgroundColor:null===(o=e.semanticColors)||void 0===o?void 0:o.buttonBackgroundPressed},rootFocused:{backgroundColor:null===(r=e.semanticColors)||void 0===r?void 0:r.buttonBackground}}}Ab.contextType=Jh;const Hb=(e,t)=>{var n,o,r,i,a,s,l,c,u,d,p,g,h,m,b,f,x,E,S,y,C,v,k,T,_,w,D,P,I;const{borderRadius:F,buttonBorderLine:B}=Object(R.useContext)(Tm);return{root:{borderRadius:F,backgroundColor:e?null===(n=t.semanticColors)||void 0===n?void 0:n.primaryButtonBackground:null==t||null===(o=t.semanticColors)||void 0===o?void 0:o.buttonBackground,color:e?null===(r=t.semanticColors)||void 0===r?void 0:r.primaryButtonText:null===(i=t.semanticColors)||void 0===i?void 0:i.buttonText,borderWidth:B,borderStyle:"solid",borderColor:e?null==t||null===(a=t.semanticColors)||void 0===a?void 0:a.primaryButtonBorder:null==t||null===(s=t.semanticColors)||void 0===s?void 0:s.buttonBorder},rootDisabled:{backgroundColor:e?null===(l=t.semanticColors)||void 0===l?void 0:l.primaryButtonBackgroundDisabled:null==t||null===(c=t.semanticColors)||void 0===c?void 0:c.buttonBackgroundDisabled,borderColor:null==t||null===(u=t.semanticColors)||void 0===u?void 0:u.buttonBorderDisabled,selectors:{[`.${$h.a} &:focus`]:[{backgroundColor:"transparent"}]}},rootHovered:{backgroundColor:F!==km.borderRadius?e?null===(d=t.semanticColors)||void 0===d?void 0:d.primaryButtonBackground:null==t||null===(p=t.semanticColors)||void 0===p?void 0:p.buttonBackground:e?null===(g=t.semanticColors)||void 0===g?void 0:g.primaryButtonBackgroundHovered:null==t||null===(h=t.semanticColors)||void 0===h?void 0:h.buttonBackgroundHovered,borderColor:e?null==t||null===(m=t.semanticColors)||void 0===m?void 0:m.primaryButtonBorder:null==t||null===(b=t.semanticColors)||void 0===b?void 0:b.buttonBorder,color:e?null===(f=t.semanticColors)||void 0===f?void 0:f.primaryButtonText:null===(x=t.semanticColors)||void 0===x?void 0:x.buttonText},rootPressed:{backgroundColor:e?null===(E=t.semanticColors)||void 0===E?void 0:E.primaryButtonBackgroundPressed:null==t||null===(S=t.semanticColors)||void 0===S?void 0:S.buttonBackgroundPressed,color:e?null===(y=t.semanticColors)||void 0===y?void 0:y.primaryButtonText:null===(C=t.semanticColors)||void 0===C?void 0:C.buttonText,borderColor:e?null==t||null===(v=t.semanticColors)||void 0===v?void 0:v.primaryButtonBorder:null==t||null===(k=t.semanticColors)||void 0===k?void 0:k.buttonBorder},rootFocused:{backgroundColor:e?null===(T=t.semanticColors)||void 0===T?void 0:T.primaryButtonBackground:null==t||null===(_=t.semanticColors)||void 0===_?void 0:_.buttonBackground,color:e?null===(w=t.semanticColors)||void 0===w?void 0:w.primaryButtonText:null===(D=t.semanticColors)||void 0===D?void 0:D.buttonText,borderColor:e?null==t||null===(P=t.semanticColors)||void 0===P?void 0:P.primaryButtonBorder:null==t||null===(I=t.semanticColors)||void 0===I?void 0:I.buttonBorder}}},Vb=e=>{const{styles:t,partialTheme:n}=e,o=_object_without_properties(e,["styles","partialTheme"]);return R.createElement(Ys.b,_object_spread_props(_object_spread({},o),{styles:Object(F.I)(e.styles,Hb(e.primary,e.partialTheme))}))},Ub=e=>{var t,n;const{borderRadius:o}=Object(R.useContext)(Tm);return{root:{border:"none",borderRadius:o,background:"transparent",width:"fit-content",paddingLeft:"0px"},rootDisabled:{border:"none",borderRadius:o,background:"transparent"},rootHovered:{border:"none",borderRadius:o,backgroundColor:null==e||null===(t=e.semanticColors)||void 0===t?void 0:t.buttonBackgroundHovered},rootPressed:{border:"none",borderRadius:o,backgroundColor:null==e||null===(n=e.semanticColors)||void 0===n?void 0:n.buttonBackgroundPressed},icon:{height:"20px",width:"20px"},label:{fontSize:"14px",lineHeight:"20px",textAlign:"center",fontWeight:F.l.regular}}},Gb=e=>{const{styles:t,partialTheme:n}=e,o=_object_without_properties(e,["styles","partialTheme"]);return R.createElement(Ys.b,_object_spread_props(_object_spread({},o),{styles:Object(F.I)(e.styles,Ub(e.partialTheme))}))},qb=({id:e,name:t,description:n,operationType:o,siblingNames:r})=>{const[i,a]=R.useState(void 0),[s,l]=R.useState(t),u=R.createRef(),[d,p]=R.useState(n),g=R.createRef(),h=fm(),m=Cm(),b=e=>{l(e),a(Object(Rm.s)(e,r,t))},f=()=>{var t;if(!i&&null!==(t=u.current)&&void 0!==t&&t.value){var n,r;const t={id:e||"{"+ot()+"}",name:null===(n=u.current)||void 0===n?void 0:n.value,description:null===(r=g.current)||void 0===r?void 0:r.value,parentId:""};h.handleQueryGroupOperation(o,t),m({type:Em.Home})}},x=e=>{var t;e.which===xe.a.escape&&(null===(t=u.current)||void 0===t||t.resetState(),e.stopPropagation(),e.preventDefault())};R.useEffect(()=>{var e;null===(e=u.current)||void 0===e||e.focus()},[]);const E=e=>R.createElement(Vb,{type:"AppButtonProps",label:ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.SaveButton),id:"GroupProperties-SaveButton",styles:{root:{width:"fit-content",padding:"5px 20px"},label:{fontSize:"12px",lineHeight:"16px",textAlign:"center",fontWeight:F.l.semibold,[F.m]:{color:"inherit"}}},disabled:!(!i&&s)||5===o&&t===s&&n===d,onExecute:f,partialTheme:e,primary:!0}),S=e=>R.createElement(Vb,{type:"AppButtonProps",label:ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.CancelButton),id:"GroupProperties-CancelsButton",styles:zb(e),onExecute:()=>{m({type:Em.Home})},partialTheme:e,primary:!1}),{isCancelButtonFirst:y}=R.useContext(Tm);return R.createElement(we.a,null,e=>R.createElement(At.a,{horizontal:!1,verticalAlign:"start",styles:{root:{padding:"16px",height:"100%"}},tokens:{childrenGap:12}},R.createElement(Gb,{type:"AppButtonProps",label:ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.QueriesTaskPaneTab),id:"GroupProperties-queriesButton",icon:Object(ue.a)()?c.a.CommonControlChevronRight_12:c.a.CommonControlChevronLeft_12,onExecute:()=>{m({type:Em.Home})},partialTheme:e}),R.createElement(At.a.Item,null,R.createElement(Yl.a,{id:"GroupNameLabel",type:"AppLabelProps",forId:"GroupNameInput",required:!0,label:ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.GroupNameInputLabel),styles:Nb(e)}),R.createElement(Xd.a,{ref:u,id:"GroupNameInput",type:"AppInputProps",value:t,autoComplete:"off",styles:em(e),onChange:b,errorMessage:i,onExecute:f,executeOnEnter:!0,onKeyDown:x})),R.createElement(At.a.Item,null,R.createElement(Yl.a,{id:"GroupDescriptionLabel",type:"AppLabelProps",forId:"GroupDescriptionInput",label:ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.PropertiesDescriptionInputLabel),styles:Nb(e)}),R.createElement(Xd.a,{ref:g,id:"GroupDescriptionInput",type:"AppInputProps",value:n,autoComplete:"off",styles:Wb(e),multiline:!0,resizable:!0,onChange:e=>{p(e)},onExecute:f,executeOnEnter:!0,onKeyDown:x})),R.createElement(At.a,{horizontal:!0,horizontalAlign:"end",tokens:{childrenGap:4}},y?S(e):E(e),y?E(e):S(e))))},Qb=e=>{var t,n;return Object(F.eb)({color:null===(t=e.semanticColors)||void 0===t?void 0:t.errorText,margin:0,paddingTop:5,fontSize:"12px",fontWeight:F.l.regular,background:null===(n=e.semanticColors)||void 0===n?void 0:n.errorBackground})},Kb=e=>{var t;return{root:{padding:"0px"},label:{fontWeight:F.l.semibold,fontSize:"12px",lineHeight:"16px",color:null===(t=e.semanticColors)||void 0===t?void 0:t.inputText}}},Jb=e=>{var t,n;return{width:"100%",height:"210px",backgroundColor:null===(t=e.semanticColors)||void 0===t?void 0:t.listBackground,border:"1px solid "+(null===(n=e.semanticColors)||void 0===n?void 0:n.inputBorder),boxSizing:"border-box",borderRadius:F.e.roundedCorner2,overflow:"auto"}},Yb=Object(Jo.c)((e,t)=>{var n,o,r,i,a;return{root:{margin:"6px 12px 6px 8px",height:"28px",backgroundColor:t?null===(n=e.semanticColors)||void 0===n?void 0:n.listItemBackgroundChecked:"unset",selectors:{":hover":[{backgroundColor:t?null===(o=e.semanticColors)||void 0===o?void 0:o.listItemBackgroundCheckedHovered:null===(r=e.semanticColors)||void 0===r?void 0:r.listItemBackgroundHovered}],":focus":[{backgroundColor:null===(i=e.semanticColors)||void 0===i?void 0:i.listItemBackgroundChecked}]}},label:{fontSize:"12px",lineHeight:"16px",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",color:null===(a=e.semanticColors)||void 0===a?void 0:a.listText}}}),Zb=()=>{const{borderRadius:e}=Object(R.useContext)(Tm);return{root:{borderRadius:e}}},$b=e=>{const{styles:t}=e,n=_object_without_properties(e,["styles"]);return R.createElement(Yl.a,_object_spread_props(_object_spread({},n),{styles:Object(F.I)(e.styles,Zb())}))},Xb=(e,t,n,o,r,i)=>R.createElement(At.a,{horizontal:!0,horizontalAlign:"end",tokens:{childrenGap:4}},r?tf(e,t,o):ef(e,t,i,n),r?ef(e,t,i,n):tf(e,t,o)),ef=(e,t,n,o)=>R.createElement(Vb,{id:e+"-SaveButton",type:"AppButtonProps",label:ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.SaveButton),styles:{root:{width:"fit-content",padding:"5px 20px"},label:{fontSize:"12px",lineHeight:"16px",textAlign:"center",fontWeight:F.l.semibold,[F.m]:{color:"inherit"}}},disabled:n,onExecute:o,partialTheme:t,primary:!0}),tf=(e,t,n)=>R.createElement(Vb,{id:e+"-CancelButton",type:"AppButtonProps",label:ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.CancelButton),styles:{root:{width:"fit-content",padding:"5px 20px"},label:{fontSize:"12px",lineHeight:"16px",textAlign:"center",fontWeight:F.l.semibold,[F.m]:{color:"inherit"}}},onExecute:n,partialTheme:t,primary:!1}),nf=({groups:e,movingObjectId:t,movingObjectName:n,isGroupMoving:o})=>{const r=R.useRef(null),i=fm(),a=Object(Rm.n)(e,t,o),s=Cm(),[l,u]=R.useState(void 0),[d,p]=R.useState(void 0),g=new ku.a({items:a,selectionMode:_u.d.single,onSelectionChanged(){const[e]=g.getSelection();var t;e&&(u(e),p(Object(Rm.p)(a,n,e.key)),null===(t=r.current)||void 0===t||t.forceUpdate())}}),h=(e,t,n)=>R.createElement(we.a,null,n=>R.createElement("div",{"data-selection-select":!0,"data-selection-index":t,"data-is-focusable":!0,"data-selection-touch-invoke":!0},R.createElement($b,{id:"GroupsListItem-"+(null==e?void 0:e.key),type:"AppLabelProps",forId:"GroupNameInput",label:null==e?void 0:e.name,styles:Yb(n,!!l&&l.key===(null==e?void 0:e.key))}))),m=()=>{if(o){const e={id:t,parentId:l.key};i.handleQueryGroupOperation(4,e)}else{const e={name:n,extraData:l.key};i.handleQueryAction(0,e)}s({type:Em.Home})},b=()=>{s({type:Em.Home})},{isCancelButtonFirst:f}=R.useContext(Tm);return R.createElement(we.a,null,e=>R.createElement(At.a,{horizontal:!1,verticalAlign:"start",tokens:{childrenGap:12},styles:{root:{padding:"16px",height:"100%"}}},R.createElement(Gb,{type:"AppButtonProps",label:ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.QueriesTaskPaneTab),id:"GroupProperties-queriesButton",icon:Object(ue.a)()?c.a.CommonControlChevronRight_12:c.a.CommonControlChevronLeft_12,onExecute:()=>{s({type:Em.Home})},partialTheme:e}),R.createElement(At.a.Item,null,R.createElement(Yl.a,{id:"GroupsListTitle",type:"AppLabelProps",label:ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.MoveToPageSelectGroup),forId:"groupsList",styles:Kb(e)}),R.createElement(yd.a,{selection:g},R.createElement(Cd.a,null,R.createElement(Pl.a,{id:"groupsList",items:a,onRenderCell:h,style:Jb(e),componentRef:r}))),d&&R.createElement("div",{role:"alert"},R.createElement("p",{className:Qb(e)},R.createElement("span",null,ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.MoveToConflictNamesErrorMessage).replace(/\{0\}/g,n).replace("{1}",null==l?void 0:l.name))))),Xb("MoveToGroup",e,m,b,f,!l||!!d)))};function of(e){return t=>{var n,o,r,i,a;return{root:{background:null===(n=e.semanticColors)||void 0===n?void 0:n.inputBackground},fieldGroup:{border:"1px solid",borderColor:t.focused?null===(o=e.semanticColors)||void 0===o?void 0:o.focusBorder:null===(r=e.semanticColors)||void 0===r?void 0:r.inputBorder,boxSizing:"border-box",borderRadius:F.e.roundedCorner2,color:null===(i=e.semanticColors)||void 0===i?void 0:i.inputText,backgroundColor:null===(a=e.semanticColors)||void 0===a?void 0:a.inputBackground},field:{fontSize:"12px",lineHeight:"16px",height:"48px"}}}}function rf(e){var t;return{root:{top:"3px",bottom:"5px",fontSize:"12px",lineHeight:"16px",padding:"0px"},label:{fontWeight:F.l.semibold,color:null===(t=e.semanticColors)||void 0===t?void 0:t.inputText}}}const af=({label:e,name:t,description:n,errorMessage:o,onNameChange:r,onDescriptionChange:i})=>{const a=R.createRef(),s=R.createRef(),l=e=>t=>{var n;t.which===xe.a.escape&&(null===(n=e.current)||void 0===n||n.resetState(),t.stopPropagation(),t.preventDefault())};return R.useEffect(()=>{var e;null===(e=a.current)||void 0===e||e.focus()},[]),R.createElement(we.a,null,c=>R.createElement(R.Fragment,null,R.createElement(At.a.Item,null,R.createElement(Yl.a,{id:"NameLabel",type:"AppLabelProps",forId:"NameInput",label:e,required:!0,styles:rf(c)}),R.createElement(Xd.a,{ref:a,id:"NameInput",type:"AppInputProps",value:t,autoComplete:"off",styles:em(c),onChange:r,errorMessage:o,onKeyDown:l(a)})),R.createElement(At.a.Item,null,R.createElement(Yl.a,{id:"DescriptionLabel",type:"AppLabelProps",forId:"DescriptionInput",label:ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.PropertiesDescriptionInputLabel),styles:rf(c)}),R.createElement(Xd.a,{ref:s,id:"DescriptionInput",type:"AppInputProps",value:n,autoComplete:"off",styles:of(c),multiline:!0,resizable:!0,onChange:i,onKeyDown:l(s)}))))},sf=({id:e,originalName:t,originalDescription:n,groupOperation:o,prohibitedNames:r})=>{const[i,a]=R.useState(void 0),[s,l]=R.useState(t),[u,d]=R.useState(n),p=fm(),g=Cm(),h=e=>{l(e),m(e)},m=R.useCallback(e=>{a(Object(Rm.s)(e,r,t))},[t,r]),b=()=>{if(!i&&s){const t={id:e||"{"+ot()+"}",name:s,description:u,parentId:""};p.handleQueryGroupOperation(o,t),g({type:Em.Home})}},f=()=>{g({type:Em.Home})};R.useEffect(()=>{void 0!==s&&m(s)},[s,m]);const{isCancelButtonFirst:x}=R.useContext(Tm);return R.createElement(we.a,null,e=>R.createElement(At.a,{horizontal:!1,verticalAlign:"start",styles:{root:{padding:"16px",height:"100%"}},tokens:{childrenGap:12}},R.createElement(Gb,{type:"AppButtonProps",label:ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.QueriesTaskPaneTab),id:"GroupProperties-queriesButton",icon:Object(ue.a)()?c.a.CommonControlChevronRight_12:c.a.CommonControlChevronLeft_12,onExecute:()=>{g({type:Em.Home})},partialTheme:e}),R.createElement(af,{label:ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.GroupNameInputLabel),name:s,description:u,errorMessage:i,onNameChange:h,onDescriptionChange:d}),Xb("GroupProperties",e,b,f,x,!(!i&&s)||s===t&&u===n)))},lf={marginInlineStart:12},cf=Object(Jo.c)(()=>Object(F.eb)({fontWeight:"600"})),uf=Object(Jo.c)(()=>Object(F.eb)({marginInlineStart:10,fontWeight:400,fontStyle:"italic"})),df={root:{width:"fit-content"}},pf={root:[{marginBottom:5,marginTop:5,display:"block"}],spinButtonWrapper:{width:60,height:24,boxSizing:"border-box"},labelWrapper:[{height:"auto",minHeight:24,width:"calc(100% - 64px)"},{marginInlineStart:0}]},gf={root:{marginBottom:5,marginTop:5}},hf={root:[gf,{lineHeight:14,marginInlineStart:20}]},mf=({originalName:e,originalDescription:t,prohibitedNames:n,lastRefresh:o,queryPropertiesControls:r})=>{const[i,a]=R.useState(void 0),[s,l]=R.useState(e),[u,d]=R.useState(t),[p,g]=R.useState(r.isBackgroundRefreshEnabled),[h,m]=R.useState(r.isIntervalRefreshEnabled),[b,f]=R.useState(r.intervalInMinutes),[x,E]=R.useState(r.isRefreshOnOpenEnabled),[S,y]=R.useState(r.isRemoveDataEnabled),[C,v]=R.useState(r.isRefreshOnRefreshAllEnabled),[k,T]=R.useState(r.isFastDataLoadEnabled),_=fm(),w=Cm(),D=e=>{l(e),P(e)},P=R.useCallback(t=>{a(Object(Rm.t)(e,t,n))},[e,n]),I=()=>{const t={IsBackgroundRefreshEnabled:p,IsIntervalRefreshEnabled:h,IntervalInMinutes:b,IsRefreshOnOpenEnabled:x,IsRemoveDataEnabled:S,IsRefreshOnRefreshAllEnabled:C,IsFastDataLoadEnabled:k},n={OldName:e,NewName:s.trim(),Description:u,RefreshControls:t};_.onSetQueryProperties(n),w({type:Em.Home})},F=()=>{w({type:Em.Home})};R.useEffect(()=>{void 0!==s&&P(s)},[s,P]);const B={negativeSign:"-",numberDecimalDigits:0,numberDecimalSeparator:".",numberNegativePattern:1,numberGroupSeparator:",",numberGroupSizes:[3]},M=Object(Jo.c)((e,t,n,o)=>[{unitType:e,unitPlaceholder:"{0}",minValue:t,maxValue:n,step:o}]),{isCancelButtonFirst:j}=R.useContext(Tm);return R.createElement(we.a,null,n=>R.createElement(At.a,{horizontal:!1,verticalAlign:"start",styles:{root:{padding:"16px",height:"100%"}},tokens:{childrenGap:12}},R.createElement(Gb,{type:"AppButtonProps",label:ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.QueriesTaskPaneTab),id:"QueryProperties-queriesButton",icon:Object(ue.a)()?c.a.CommonControlChevronRight_12:c.a.CommonControlChevronLeft_12,onExecute:()=>{w({type:Em.Home})},partialTheme:n}),R.createElement(af,{label:ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.QueryNameInputLabel),name:s,description:u,errorMessage:i,onNameChange:D,onDescriptionChange:d}),R.createElement(At.a,null,R.createElement(jt.a,{className:cf()},ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.Usage)),R.createElement(At.a,{style:lf},R.createElement(jt.a,{className:uf()},ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.QueryLastRefreshed).replace("{0}",new Date(o).toLocaleString())),void 0!==r.isBackgroundRefreshEnabled&&R.createElement(bg,{id:"EnableBackgroundRefresh",type:"AppCheckboxProps",label:ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.EnableBackgroundRefresh),checked:p,onExecute:()=>g(e=>!e),disabled:r.shouldDisableBackgroundRefreshCheckbox,checkmarkIcon:Po.a.checkboxCheckmark,styles:gf}),void 0!==r.isIntervalRefreshEnabled&&R.createElement(At.a,{horizontal:!0,styles:df},R.createElement(bg,{id:"EnableIntervalRefresh",type:"AppCheckboxProps",label:ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.RefreshEvery),checked:h,onExecute:()=>m(e=>!e),checkmarkIcon:Po.a.checkboxCheckmark,styles:gf}),R.createElement(Ch,{id:"IntervalIncrement",type:"AppSpinButtonProps",value:b,onExecute:e=>{f(Number(e.value))},label:ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.Minutes),labelPosition:mc.a.end,styles:pf,disabled:!h,incrementButtonIcon:c.a.CommonControlChevronUp_8,incrementAriaLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SpinnerIncrementButtonAriaLabel),decrementButtonIcon:c.a.CommonControlChevronDown_8,decrementAriaLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SpinnerDecrementButtonAriaLabel),unitType:"Minutes",validUnits:M("Minutes",1,32767,1),numberFormatInfo:B})),R.createElement("div",{onKeyDown:e=>{e.which===xe.a.escape&&(e.stopPropagation(),e.preventDefault())}},R.createElement(bg,{id:"EnableRefreshOnOpen",type:"AppCheckboxProps",label:ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.RefreshDataOnopen),checked:x,onExecute:()=>E(e=>!e),disabled:r.shouldDisableRefreshOnOpenCheckbox,checkmarkIcon:Po.a.checkboxCheckmark,styles:gf}),void 0!==r.isRemoveDataEnabled&&R.createElement(bg,{id:"EnableRemoveData",type:"AppCheckboxProps",label:ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.RemoveDataFromWorkbook),checked:S,onExecute:()=>y(e=>!e),disabled:r.shouldDisableRemoveDataCheckbox,checkmarkIcon:Po.a.checkboxCheckmark,styles:hf}),R.createElement(bg,{id:"EnableRefreshOnRefreshAll",type:"AppCheckboxProps",label:ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.RefreshOnRefreshAll),checked:C,onExecute:()=>v(e=>!e),disabled:r.shouldDisableRefreshOnRefreshAllCheckbox,checkmarkIcon:Po.a.checkboxCheckmark,styles:gf}),void 0!==r.isFastDataLoadEnabled&&R.createElement(bg,{id:"EnableFastDataLoad",type:"AppCheckboxProps",label:ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.EnableFastDataLoad),checked:k,onExecute:()=>T(e=>!e),checkmarkIcon:Po.a.checkboxCheckmark,styles:gf})))),Xb("QueryProperties",n,I,F,j,!(!i&&s)||s===e&&u===t&&p===r.isBackgroundRefreshEnabled&&h===r.isIntervalRefreshEnabled&&b===r.intervalInMinutes&&x===r.isRefreshOnOpenEnabled&&S===r.isRemoveDataEnabled&&C===r.isRefreshOnRefreshAllEnabled&&k===r.isFastDataLoadEnabled)))};R.createContext(Em.Home);class bf extends R.Component{render(){return R.createElement(xm,{value:this.props.callbacks},R.createElement(vm,null,R.createElement(Sm.Consumer,null,e=>this.getPaneBodyComponent(e))))}getPaneBodyComponent(e){var t,n,o,r,l,c,u,d;switch(e.type){case Em.Home:return R.createElement(Ab,_object_spread({},this.props));case Em.GroupProperties:var p,g,h,m;return this.props.getProperty("Microsoft.Office.Excel.PowerQueryTaskPaneQueryProperties")?R.createElement(sf,{groupOperation:e.groupOperation,id:null===(p=e.groupOperationPayload)||void 0===p?void 0:p.id,originalName:null===(g=e.groupOperationPayload)||void 0===g?void 0:g.name,originalDescription:null!==(h=null===(m=e.groupOperationPayload)||void 0===m?void 0:m.description)&&void 0!==h?h:"",prohibitedNames:e.groupSiblingsNames}):R.createElement(qb,{operationType:e.groupOperation,id:null===(t=e.groupOperationPayload)||void 0===t?void 0:t.id,name:null===(n=e.groupOperationPayload)||void 0===n?void 0:n.name,description:null===(o=e.groupOperationPayload)||void 0===o?void 0:o.description,siblingNames:e.groupSiblingsNames});case Em.QueryProperties:return R.createElement(mf,{originalName:e.queryOperationPayload.name,originalDescription:null!==(r=e.queryOperationPayload.description)&&void 0!==r?r:"",prohibitedNames:null!==(l=null===(c=this.props.queries)||void 0===c?void 0:c.map(e=>null==e?void 0:e.name))&&void 0!==l?l:[],lastRefresh:e.queryPropertiesPayload.lastRefresh,queryPropertiesControls:e.queryPropertiesPayload.propertiesControls});case Em.MoveToGroup:return R.createElement(nf,{groups:this.props.groups,movingObjectId:null===(u=e.groupOperationPayload)||void 0===u?void 0:u.id,movingObjectName:null===(d=e.groupOperationPayload)||void 0===d?void 0:d.name,isGroupMoving:e.isGroupMoving});default:return i.a.sendTraceTag(520447842,a.a.msoulscat_ES_EWAJS,s.a.Error,"PowerQueryTaskPane.render: Unknown pane type."),R.createElement("div",null)}}constructor(e){super(e)}}class ff{cloneTaskPaneData(e,t){const n=[],o=[];return t.forEach(e=>{n.push(this.cloneQueryInfo(e))}),e.forEach(e=>{o.push(this.cloneGroupInfo(e))}),{queries:n,groups:o}}prepareGroupsDataForTaskPane(e){for(const t of e){const e="{00000000-0000-0000-0000-000000000000}"===t.parentKey?"root":t.parentKey;this.groupIdLookupDictionary[t.key]=t,this.appendChildGroupToParent(t,e)}const t={};t.name=ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.OtherQueriesGroupName),t.key="Other Queries",t.order=Number.MAX_VALUE,this.groupIdLookupDictionary["Other Queries"]=t;this.groupIdLookupDictionary.root={name:"root",key:"root",order:0}}prepareQueriesDataForTaskPane(e){for(const t of e){let e=t.groupKey||"Other Queries";const n=this.groupChildrenDictionary[e];if("Other Queries"!==e&&n&&n.length){const n="SubGroupOtherQueries-"+e;if(!this.groupIdLookupDictionary[n]){const t={};t.name=n,t.key=n,t.order=Number.MAX_VALUE,this.groupIdLookupDictionary[n]=t,this.appendChildGroupToParent(t,e)}e=n,t.groupKey=n}this.groupQueriesDictionary[e]?this.groupQueriesDictionary[e].push(t):this.groupQueriesDictionary[e]=[t]}}appendChildGroupToParent(e,t){let n=[e];this.groupChildrenDictionary[t]&&(n=n.concat(this.groupChildrenDictionary[t])),this.groupChildrenDictionary[t]=n}createGroupChildrenForGroup(e,t){let n=[];if(this.groupChildrenDictionary[e]){const o=this.groupChildrenDictionary[e];o.sort((e,t)=>this.numberCompare(e.order,t.order));for(const e of o)n=n.concat(this.createGroupInfoForGroup(e.key,t+1))}return n}createGroupInfoForGroup(e,t){const n=this.groupIdLookupDictionary[e],o=this.createGroupChildrenForGroup(e,t);n.children=this.cloneGroupInfoArray(o),n.level=t,n.count=0,n.children.length&&(n.startIndex=n.children[0].startIndex,n.count=n.children.reduce((e,t)=>e+(t?t.count:0),n.count));const r=this.groupQueriesDictionary[e];var i,a,s;return r&&(n.startIndex=null!==(i=null===(a=this.queriesInfo)||void 0===a?void 0:a.length)&&void 0!==i?i:-1,n.count+=r.length,this.queriesInfo=null===(s=this.queriesInfo)||void 0===s?void 0:s.concat(this.createReactQueryInfoArray(r,e.includes("SubGroupOtherQueries-")?t:t+1))),n}createReactQueryInfoArray(e,t){if(!e)return e;const n=e;return n.forEach(e=>{e.nestingDepth=t}),n}cloneGroupInfoArray(e){const t=[];return null==e||e.forEach(e=>{const n=this.cloneGroupInfo(e);n.children=this.cloneGroupInfoArray(e.children),t.push(n)}),t}cloneGroupInfo(e){const t={};return t.key=e.key,t.name=e.name,t.count=e.count,t.startIndex=e.startIndex,t.data=e.data,t.parentKey=e.parentKey,t.children=[],t.level=e.level,t.order=e.order,t}cloneQueryInfo(e){const t={};return t.fillObjectType=e.fillObjectType,t.groupKey=e.groupKey,t.inRefresh=e.inRefresh,t.lastRefresh=e.lastRefresh,t.loadedToDataModel=e.loadedToDataModel,t.name=e.name,t.nestingDepth=e.nestingDepth,t.queryError=e.queryError,t.refreshEnabled=e.refreshEnabled,t.rowsLoaded=e.rowsLoaded,t.rowsWithError=e.rowsWithError,t.currentRunningOperation=e.currentRunningOperation,t.description=e.description,t.propertiesControls=this.cloneQueryPropertiesControls(e.propertiesControls),t.formula=e.formula,t}cloneQueryPropertiesControls(e){const t={};return e&&(t.intervalInMinutes=e.intervalInMinutes,t.isBackgroundRefreshEnabled=e.isBackgroundRefreshEnabled,t.isFastDataLoadEnabled=e.isFastDataLoadEnabled,t.isIntervalRefreshEnabled=e.isIntervalRefreshEnabled,t.isRefreshOnOpenEnabled=e.isRefreshOnOpenEnabled,t.isRefreshOnRefreshAllEnabled=e.isRefreshOnRefreshAllEnabled,t.isRemoveDataEnabled=e.isRemoveDataEnabled,t.shouldDisableBackgroundRefreshCheckbox=e.shouldDisableBackgroundRefreshCheckbox,t.shouldDisableRemoveDataCheckbox=e.shouldDisableRemoveDataCheckbox,t.shouldDisableRefreshOnOpenCheckbox=e.shouldDisableRefreshOnOpenCheckbox,t.shouldDisableRefreshOnRefreshAllCheckbox=e.shouldDisableRefreshOnRefreshAllCheckbox),t}numberCompare(e,t){return e>t?1:e<t?-1:0}constructor(){this.groupIdLookupDictionary={},this.groupChildrenDictionary={},this.groupQueriesDictionary={},this.queriesInfo=null,this.groupsInfo=null,this.connectionsInfo=null,this.build=(e,t,n)=>{if(this.groupChildrenDictionary={},this.groupIdLookupDictionary={},this.groupQueriesDictionary={},this.queriesInfo=null,this.groupsInfo=null,this.connectionsInfo=n,e)if(this.queriesInfo=[],t&&t.length){var o;this.groupsInfo=[];const n=this.cloneTaskPaneData(t,e);this.prepareGroupsDataForTaskPane(n.groups),this.prepareQueriesDataForTaskPane(n.queries),this.groupsInfo=null===(o=this.createGroupInfoForGroup("root",-1).children)||void 0===o?void 0:o.concat(this.createGroupInfoForGroup("Other Queries",0))}else this.queriesInfo=e;return{queries:this.queriesInfo,groups:this.groupsInfo,connections:this.connectionsInfo}}}}class xf extends R.Component{announceMessage(e){const t=this.ariaNotifierRef.current;null!=t&&t.firstChild&&t.removeChild(t.firstChild);const n=document.createElement("div");n.setAttribute("role","status"),n.setAttribute("aria-label",e),n.setAttribute("aria-live","assertive"),null==t||t.appendChild(n)}componentDidCatch(e,t){i.a.sendTraceTag(509872347,a.a.msoulscat_ES_EWAJS,s.a.Error,"PowerQueryTaskPane: component failed to render: "+t.componentStack),Object(Jm.a)().sendTelemetryEvent({eventName:"Office.Excel.Client.PowerQuery",dataFields:[Object($m.a)("Render.Failed",!0),Object($m.d)("Render.Stack",t.componentStack)],eventFlags:Zm(Ym.a.DataCategories.ProductServiceUsage,Ym.a.DiagnosticLevel.RequiredServiceData,Ym.a.SamplingPolicy.CriticalBusinessImpact)})}static getDerivedStateFromProps(e){return e.queries&&e.groups?{localPaneData:xf.taskPaneDataFactory.cloneTaskPaneData(e.groups,e.queries)}:{localPaneData:{queries:null,groups:null}}}render(){return this.paneDataUpdate=this.context.bind(this),R.createElement(Yh,null,R.createElement(Kh.Consumer,null,e=>R.createElement("div",null,R.createElement("div",{ref:this.ariaNotifierRef}),R.createElement("div",null,this.getTaskPaneJSX(e)))))}getTaskPaneJSX(e){var t,n;const o=null==e||null===(t=e.searchValue)||void 0===t?void 0:t.toLocaleLowerCase();let r=this.dragAndDropEnabled&&null!=e&&e.draggedQueryName?null===(n=this.state.localPaneData)||void 0===n?void 0:n.queries:this.props.queries;var l;if(o&&(r=null===(l=this.props.queries)||void 0===l?void 0:l.filter(e=>{var t;return null==e||null===(t=e.name)||void 0===t?void 0:t.toLocaleLowerCase().includes(o)}),this.writeSearchTelemetry&&o&&(i.a.sendTraceTag(512328398,a.a.msoulscat_ES_EWAJS,s.a.Info,"PowerQueryTaskPane - Search queries in a session"),this.writeSearchTelemetry=!1)),this.dragAndDropEnabled&&null!=e&&e.draggedQueryName){var c;const t=null===(c=r)||void 0===c?void 0:c.findIndex(t=>t.name===e.draggedQueryName);if(-1===t)i.a.sendTraceTag(509872346,a.a.msoulscat_ES_EWAJS,s.a.Error,"PowerQueryTaskPane.getTaskPaneJSX: cannot find dragged or dropped query indexes.");else{var u;const n=r[t],l=e.hoveredQueryName?null===(u=r)||void 0===u?void 0:u.findIndex(t=>t.name===e.hoveredQueryName):-1;var d;-1!==l&&(r.splice(t,1),r.splice(l,0,n)),null!=e.groupKey?(this.announceMessage(ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.QueryReorderOutsideGroup).replace("{0}",e.draggedQueryName).replace("{1}",null===(d=this.props.groups)||void 0===d||null===(d=d.find(t=>(null==t?void 0:t.key)===e.groupKey))||void 0===d?void 0:d.name).replace("{2}",l.toString())),n.groupKey=e.groupKey):this.announceMessage(ExcelPowerqueryTaskpaneStringsManager.get(ExcelPowerqueryTaskpaneStringsEnum.QueryReorder).replace("{0}",e.draggedQueryName).replace("{1}",l.toString())),i.a.sendTraceTag(509872345,a.a.msoulscat_ES_EWAJS,s.a.Info,"PowerQueryTaskPane - Drag and drop was executed, while search has value :"+!!o)}}const p=this.buildTaskPaneData(this.props.groups,r,this.props.connections);return R.createElement(bf,{queries:p.queries,groups:p.groups,callbacks:this.callbacks,connections:p.connections,selectedQueryKey:this.props.selectedQueryKey,type:this.props.type,searchValue:null==e?void 0:e.searchValue,getProperty:e=>this.getBooleanProperty(this.props.getBooleanProperty,e)})}getBooleanProperty(e,t){var n;return null!==(n=null==e?void 0:e(t))&&void 0!==n&&n}constructor(e){super(e),this.ariaNotifierRef=R.createRef(),this.dragAndDropEnabled=this.getBooleanProperty(this.props.getBooleanProperty,"isPowerQueryEditEnabled"),this.callbacks=this.dragAndDropEnabled?_object_spread_props(_object_spread({},this.props.callbacks),{onCancelKeyboardReorder:()=>{this.setState({localPaneData:xf.taskPaneDataFactory.cloneTaskPaneData(this.props.groups,this.props.queries)})}}):this.props.callbacks,this.paneDataUpdate=e=>{},this.buildTaskPaneData=(e,t,n)=>xf.taskPaneDataFactory.build(t,e,n),xf.taskPaneDataFactory=new ff,this.props.queries&&this.props.groups?this.state={localPaneData:xf.taskPaneDataFactory.cloneTaskPaneData(this.props.groups,this.props.queries)}:this.state={localPaneData:{queries:null,groups:null}},this.writeSearchTelemetry=!0}}xf.contextType=Jh;class Ef extends R.PureComponent{render(){return R.createElement("div",null,R.createElement(oh,{displayName:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsAltTextSectionHeader),divId:"slicerAltTextSection",paneId:"slicerSettings",collapse:this.props.isCollapsed,type:this.props.type,onSaveSectionCollapseState:this.props.onSaveSectionCollapseState}),R.createElement("div",{id:"slicerAltTextSection",className:eh(!this.props.isCollapsed)},R.createElement(jt.a,{className:nh()},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SlicerSettingsAltTextSectionDescription)),R.createElement(uh,{id:"altTextTitle",label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsAltTextTitle),hideLabel:!1,value:this.props.altTextTitle,multiline:!1,disabled:!1,actionType:14,needCommit:this.props.isSlicerSwitched,onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat}),R.createElement(uh,{id:"altTextDescription",label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PivotTableSettingsAltTextDescription),hideLabel:!1,value:this.props.altTextDescription,multiline:!0,disabled:!1,actionType:15,needCommit:this.props.isSlicerSwitched,onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat})))}constructor(e){super(e)}}class Sf extends R.PureComponent{render(){return R.createElement("div",null,R.createElement(oh,{displayName:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SlicerSettingsPropertiesSectionHeader),divId:"slicerProperties",paneId:"slicerSettings",collapse:this.props.isCollapsed,type:this.props.type,onSaveSectionCollapseState:this.props.onSaveSectionCollapseState}),R.createElement("div",{id:"slicerProperties",className:eh(!this.props.isCollapsed)},R.createElement(mh,{label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SlicerSettingsPrintObject),id:"slicerPrintObject",checked:this.props.printObject,actionType:12,onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat,disabled:!1}),R.createElement(mh,{label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SlicerSettingsLock),id:"slicerLocked",checked:this.props.isLocked,actionType:13,onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat,disabled:!1})))}constructor(e){super(e)}}const yf={root:{marginTop:"24px",selectors:{".ms-ChoiceField-wrapper":{minHeight:"24px",marginTop:0},".ms-ChoiceField":[Ug,{minHeight:"24px"}],".ms-ChoiceField .ms-ChoiceFieldLabel":[zg,{fontSize:"12px",paddingLeft:"22px"}],".ms-ChoiceField-field::before, .ms-ChoiceField-field:hover::before":{width:"16px",height:"16px",top:"2px"},".ms-ChoiceField-field:hover::after, .ms-ChoiceField-field:focus::after, .ms-ChoiceField-field.is-checked::after":{width:"8px",height:"8px",top:"6px",left:"4px"},".ms-ChoiceField-field.is-checked::after":{borderWidth:"4px"}}}};var Cf=n(2631);class vf extends R.Component{render(){return R.createElement(Cf.a,{id:this.props.id,selectedKey:this.props.selectedKey,options:this.props.options,styles:yf,onChange:this.onChoiceChange})}onChoiceChange(e,t){void 0!==t&&(this.props.onSettingChangeWithFloatV2?this.props.onSettingChangeWithFloatV2(this.props.actionType,null,Number(t.key),0,null):this.props.onSettingChangeWithFloat&&this.props.onSettingChangeWithFloat(this.props.actionType,"",Number(t.key),0))}constructor(e){super(e),this.onChoiceChange=this.onChoiceChange.bind(this)}}class Rf extends R.PureComponent{render(){const e=Jg();return R.createElement("div",null,R.createElement(oh,{displayName:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SlicerSettingsSizePositionSectionHeader),divId:"sizeAndPositionSection",paneId:"slicerSettings",collapse:this.props.isCollapsed,type:this.props.type,onSaveSectionCollapseState:this.props.onSaveSectionCollapseState}),R.createElement("div",{id:"sizeAndPositionSection",className:eh(!this.props.isCollapsed)},R.createElement("div",{className:e.firstRoot},R.createElement(jt.a,{className:e.label},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SlicerSettingsButtonSettingsGroupHeader)),R.createElement(vh,{id:"buttonsPerRow",value:this.props.buttonsPerRow,min:1,max:2e4,step:1,stepPrecision:0,label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SlicerSettingsButtonNumberPerRow),labelOnLeft:!0,disabled:this.props.disableResizeAndMove,isInteger:!0,precision:0,unit:"None",actionType:3,needCommit:this.props.isSlicerSwitched,onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat}),R.createElement(vh,{id:"buttonHeight",value:this.props.buttonHeight,min:0,max:2348,step:.1,stepPrecision:1,label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SlicerSettingsHeight),labelOnLeft:!0,disabled:this.props.disableResizeAndMove,isInteger:!1,precision:2,unit:"Inch",actionType:4,needCommit:this.props.isSlicerSwitched,onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat}),R.createElement(vh,{id:"buttonWidth",value:this.props.buttonWidth,min:0,max:2348,step:.1,stepPrecision:1,label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SlicerSettingsWidth),labelOnLeft:!0,disabled:this.props.disableResizeAndMove,isInteger:!1,precision:2,unit:"Inch",actionType:5,needCommit:this.props.isSlicerSwitched,onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat})),R.createElement("div",{className:e.root},R.createElement(jt.a,{className:e.label},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SlicerSettingsSlicerSizeGroupHeader)),R.createElement(vh,{id:"slicerHeight",value:this.props.slicerHeight,min:0,max:2348,step:.1,stepPrecision:1,label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SlicerSettingsHeight),labelOnLeft:!0,disabled:this.props.disableResizeAndMove,isInteger:!1,precision:2,unit:"Inch",actionType:6,needCommit:this.props.isSlicerSwitched,onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat}),R.createElement(vh,{id:"slicerWidth",value:this.props.slicerWidth,min:0,max:2348,step:.1,stepPrecision:1,label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SlicerSettingsWidth),labelOnLeft:!0,disabled:this.props.disableResizeAndMove,isInteger:!1,precision:2,unit:"Inch",actionType:7,needCommit:this.props.isSlicerSwitched,onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat})),R.createElement("div",{className:e.root},R.createElement(jt.a,{className:e.label},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SlicerSettingsSlicerPositionGroupHeader)),R.createElement(vh,{id:"horizontalPosition",value:this.props.horizontal,min:0,max:2348,step:.1,stepPrecision:1,label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SlicerSettingsHorizontalPosition),labelOnLeft:!0,disabled:this.props.disableResizeAndMove,isInteger:!1,precision:2,unit:"Inch",actionType:8,needCommit:this.props.isSlicerSwitched,onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat}),R.createElement(vh,{id:"verticalPosition",value:this.props.vertical,min:0,max:2348,step:.1,stepPrecision:1,label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SlicerSettingsVerticalPosition),labelOnLeft:!0,disabled:this.props.disableResizeAndMove,isInteger:!1,precision:2,unit:"Inch",actionType:9,needCommit:this.props.isSlicerSwitched,onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat})),R.createElement(mh,{label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SlicerSettingsDisableResizeAndMove),id:"disableResizeAndMove",checked:this.props.disableResizeAndMove,actionType:10,onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat,disabled:!1}),R.createElement(vf,{id:"slicerAnchorType",actionType:11,selectedKey:this.props.slicerAnchorType.toString(),options:[{key:(0).toString(),text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SlicerSettingsMoveAndSizeWithCells)},{key:1..toString(),text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SlicerSettingsMoveButDoNotSizeWithCells)},{key:2..toString(),text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SlicerSettingsDoNotMoveOrSizeWithCells)}],onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat})))}constructor(e){super(e)}}class kf extends R.PureComponent{render(){const e=this.props.pivotTableConnections;return!e||e.length<=0?null:R.createElement("div",null,R.createElement(oh,{displayName:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SlicerSettingsPivotTableConnectionsSectionHeader),divId:"pivotTableConnections",paneId:"slicerSettings",collapse:this.props.isCollapsed,type:3,onSaveSectionCollapseState:this.props.onSaveSectionCollapseState}),R.createElement("div",{id:"pivotTableConnections",className:th(!this.props.isCollapsed)},R.createElement(Gh,{items:e,columns:Wh,onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2,listType:"pivotTableConnections"})))}constructor(e){super(e)}}class Tf extends R.Component{componentDidUpdate(e){var t;this.props.needFocusOnFirstElement&&this.props.needFocusOnFirstElement!==e.needFocusOnFirstElement&&(null===(t=document.getElementById("slicerCaption"))||void 0===t||t.focus())}render(){const{settingsInfo:e}=this.props;return null!=e&&R.createElement("div",{className:$g()},R.createElement("div",{className:Yg()},R.createElement(uh,{id:"slicerCaption",label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SlicerSettingsTitle),hideLabel:!1,value:e.caption,multiline:!1,disabled:!1,actionType:1,needCommit:this.props.isSlicerSwitched,onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat}),R.createElement(mh,{id:"displaySlicerHeader",label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SlicerSettingsShowHeader),checked:e.displayHeader,actionType:2,onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat,disabled:!1}),R.createElement(jt.a,{className:Zg()},`${ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SlicerSettingsDataSource)}: ${e.dataSource}`),R.createElement(jt.a,{className:Zg()},`${ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SlicerSettingsName)}: ${e.name}`)),R.createElement(Rf,{buttonsPerRow:e.buttonsPerRow,buttonHeight:e.buttonHeight,buttonWidth:e.buttonWidth,slicerHeight:e.height,slicerWidth:e.width,horizontal:e.horizontalPosition,vertical:e.verticalPosition,disableResizeAndMove:e.disableResizeAndMove,slicerAnchorType:e.anchorType,isSlicerSwitched:this.props.isSlicerSwitched,type:1,isCollapsed:!!this.props.sectionCollapseStates&&this.props.sectionCollapseStates[1],onSaveSectionCollapseState:this.props.onSaveSectionCollapseState,onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat}),R.createElement(Sf,{printObject:e.printObject,isLocked:e.locked,type:0,isCollapsed:!!this.props.sectionCollapseStates&&this.props.sectionCollapseStates[0],onSaveSectionCollapseState:this.props.onSaveSectionCollapseState,onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat}),R.createElement(kf,{pivotTableConnections:e.pivotTableConnections,onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2,type:3,isCollapsed:!!this.props.sectionCollapseStates&&this.props.sectionCollapseStates[3],onSaveSectionCollapseState:this.props.onSaveSectionCollapseState}),R.createElement(Ef,{altTextTitle:e.altTextTitle,altTextDescription:e.altTextDescription,isSlicerSwitched:this.props.isSlicerSwitched,type:2,isCollapsed:!!this.props.sectionCollapseStates&&this.props.sectionCollapseStates[2],onSaveSectionCollapseState:this.props.onSaveSectionCollapseState,onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat}))}}const _f=Object(Jo.c)(()=>Object(F.db)({taskPaneContent:{height:"100%",width:"100%",border:"none"},appForOfficeContainer:{marginTop:"0 !important",zIndex:899}}));var wf,Df,Pf,If=n(831),Ff=n(2694);!function(e){e[e.Undefined=0]="Undefined",e[e.MinorWithoutParentalConsent=1]="MinorWithoutParentalConsent",e[e.MinorWithParentalConsent=2]="MinorWithParentalConsent",e[e.Adult=3]="Adult",e[e.NotAdult=4]="NotAdult",e[e.MinorNoParentalConsentRequired=5]="MinorNoParentalConsentRequired"}(wf||(wf={})),function(e){e[e.MSA=0]="MSA",e[e.AAD=1]="AAD",e[e.Unauthenticated=2]="Unauthenticated"}(Df||(Df={})),function(e){e[e.NotConfigured=0]="NotConfigured",e[e.Enabled=1]="Enabled",e[e.Disabled=2]="Disabled"}(Pf||(Pf={}));const Bf=e=>{switch(e){case wf.MinorWithoutParentalConsent:return Ff.a.MinorWithoutParentalConsent;case wf.MinorWithParentalConsent:return Ff.a.MinorWithParentalConsent;case wf.NotAdult:return Ff.a.NotAdult;case wf.Adult:return Ff.a.Adult;case wf.MinorNoParentalConsentRequired:return Ff.a.MinorNoParentalConsentRequired;case wf.Undefined:default:return Ff.a.Undefined}},Mf=e=>{switch(e){case Df.MSA:return Ff.b.MSA;case Df.AAD:return Ff.b.AAD;case Df.Unauthenticated:default:return Ff.b.Unauthenticated}},jf=e=>{switch(e){case Pf.Enabled:return Ff.d.Enabled;case Pf.Disabled:return Ff.d.Disabled;case Pf.NotConfigured:default:return Ff.d.NotConfigured}};function Of(e,t,n){const o={timestamp:Date.now(),message:e,stepName:t,clientFeedbackId:n};return JSON.stringify(o)}function Lf(e){let t;return e?e.current:(t=document.getElementById("ocv-inapp-feedback"),t||(t=document.createElement("div"),t.id="ocv-inapp-feedback",document.body.appendChild(t)),t)}function Af(e,t){var n,o;return{hostName:Nf(e.clientName),locale:null!==(n=Wf(null===(o=e.feedbackConfig)||void 0===o?void 0:o.appData).Language)&&void 0!==n?n:"en-us",inAppFeedbackRef:Lf(t),enableUxVersionQueryParam:Object($c.b)("Microsoft.Office.SharedOnline.InAppFeedbackLoader",!1)}}const Nf=e=>{switch(e.toLowerCase()){case"word":return"OfficeWacWordFeedback";case"excel":return"OfficeWacExcelFeedback";case"powerpoint":return"OfficeWacPowerpointFeedback";case"visio":return"OfficeWacVisioFeedback";case"onenote":return"OfficeWacOnenoteFeedback";default:return"OfficeWacFeedback"}},Wf=e=>{try{return JSON.parse(e.replaceAll("\\",""))}catch(e){return void i.a.sendTraceTag(507901579,a.a.msoulscat_Wac_WacFeedback,s.a.Error,Of("Error in parsing app data for feedback at parseApplicationData","parseApplicationData"))}},zf=e=>{e.taskPaneIdToClose&&e.taskPaneLocation?Object(wc.a)(Object(vc.d)(e.taskPaneIdToClose,e.taskPaneLocation)):e.uiType===Ff.g.NoSurfaceWithoutTitle&&i.a.sendTraceTag(507901581,a.a.msoulscat_Wac_WacFeedback,s.a.Error,Of("taskPaneIdToClose is not passed for feedback Taskpane to dispatch removeTaskPanesFromGroup","closeTaskPane"))};function Hf(e){const{customerUiWrapperFeedbackData:t,taskPaneIdToClose:n,taskPaneLocation:o}=e;return t.onDismiss||(t.onDismiss=()=>{zf({taskPaneIdToClose:n,taskPaneLocation:o})}),Vf(t)}function Vf(e){var t,n,o,r,i,a;const s=(e=>{switch(e.toLowerCase()){case"word":return Object(If.a)()?"WordDarkTheme":"WordLightTheme";case"excel":return Object(If.a)()?"ExcelDarkTheme":"ExcelLightTheme";case"powerpoint":return Object(If.a)()?"PowerPointDarkTheme":"PowerPointLightTheme";case"visio":return Object(If.a)()?"VisioDarkTheme":"VisioLightTheme";case"onenote":return Object(If.a)()?"OneNoteDarkTheme":"OneNoteLightTheme";default:return If.a?"OfficeDarkTheme":"OfficeLightTheme"}})(e.Application),l={onDismiss:e.onDismiss,onError:e.onError,onSuccess:e.onSuccess,provideDynamicScreenshot:e.provideDynamicScreenshot,supportCallback:e.supportCallback,initializationComplete:e.initializationComplete},c={connectedExperiences:jf(e.connectedExperiences),policyAllowFeedback:jf(e.policyAllowFeedback),policyAllowSurvey:jf(e.policyAllowSurvey),policyAllowScreenshot:jf(e.policyAllowScreenshot),policyAllowContact:jf(e.policyAllowContact),policyAllowContent:jf(e.policyAllowContent),policyEmailCollectionDefault:jf(e.policyEmailCollectionDefault),policyScreenshotDefault:jf(e.policyScreenshotDefault),policyContentSamplesDefault:jf(e.policyContentSamplesDefault),policyAllowCopilotFeedback:jf(e.policyAllowCopilotFeedback)},u={appData:e.applicationGroup.appData,complianceChecks:c,email:e.userEmail,feedbackForumUrl:e.feedbackForumUrl,feedbackUiType:e.uiType,hostPlatform:e.hostPlatform,initialFeedbackType:e.initialFeedbackType,invocationTimeStamp:e.invocationTimeStamp,isDisplayed:!0,isEmailCollectionEnabled:e.showEmailAddress,isFeedbackForumEnabled:null===(t=e.isFeedbackForumEnabled)||void 0===t||t,isFileUploadEnabled:null===(n=e.isFileUploadEnabled)||void 0===n||n,isMyFeedbackEnabled:null===(o=e.isMyFeedbackEnabled)||void 0===o||o,isScreenRecordingEnabled:(null===(r=e.isScreenRecordingEnabled)||void 0===r||r)&&Uf(e.applicationGroup),isScreenshotEnabled:e.screenshot,isThankYouPageDisabled:e.isThankYouPageDisabled,myFeedbackUrl:e.myFeedbackForumUrl,scenarioConfig:e.scenarioConfig,screenshotInfo:{providedScreenshotType:Uf(e.applicationGroup)?Ff.e.AutoCapture:Ff.e.AutoCaptureWithHtml2Canvas},diagnosticsConfig:{isShareContextDataEnabled:e.isShareContextDataEnabled,getContextData:e.getContextData,isHostManagedContextDataEnabled:e.isHostManagedContextDataEnabled,hostManagedContextDataExplanationUrl:e.hostManagedContextDataExplanationUrl,isRetrieveFormDataEnabled:e.isRetrieveFormDataEnabled,extractFeedbackDataForHost:e.extractFeedbackDataForHost}},d={accountCountryCode:e.telemetryGroup.accountCountryCode,affectedProcessSessionId:e.telemetryGroup.affectedProcessSessionId,appVersion:e.telemetryGroup.appVersion,audience:e.telemetryGroup.audience,audienceGroup:e.telemetryGroup.audienceGroup,browser:e.webGroup.browser,browserVersion:e.webGroup.browserVersion,channel:e.telemetryGroup.channel,clientCountryCode:e.telemetryGroup.clientCountryCode,cpuModel:e.telemetryGroup.cpuModel,dataCenter:e.webGroup.dataCenter,deviceId:e.telemetryGroup.deviceId,deviceType:e.telemetryGroup.deviceType,entryPoint:e.telemetryGroup.entryPoint,errorClassification:e.telemetryGroup.errorClassification,errorCode:e.telemetryGroup.errorCode,errorName:e.telemetryGroup.errorName,featureArea:e.telemetryGroup.featureArea,featureName:e.telemetryGroup.featureName,feedbackOrigin:e.telemetryGroup.feedbackOrigin,flights:e.telemetryGroup.flights,flightSource:e.telemetryGroup.flightSource,fundamentalArea:e.telemetryGroup.fundamentalArea,installationType:e.telemetryGroup.installationType,integrationSource:e.telemetryGroup.integrationSource,isLogIncluded:e.telemetryGroup.isLogIncluded,isUserSubscriber:e.telemetryGroup.isUserSubscriber,officeArchitecture:e.telemetryGroup.officeArchitecture,officeBuild:e.telemetryGroup.officeBuild,officeEditingLang:e.telemetryGroup.officeEditingLang,officeUILang:e.telemetryGroup.officeUILang,osBitness:e.telemetryGroup.osBitness,osBuild:e.telemetryGroup.osBuild,osUserLang:e.telemetryGroup.osUserLang,platform:e.telemetryGroup.platform,processorArchitecture:e.telemetryGroup.processorArchitecture,processorPhysicalCores:e.telemetryGroup.processorPhysicalCores,processSessionId:e.telemetryGroup.processSessionId,ringId:e.telemetryGroup.ringId,sku:e.telemetryGroup.sku,sourceContext:e.telemetryGroup.sourceContext,subFeatureName:e.telemetryGroup.subFeatureName,systemProductName:e.telemetryGroup.systemProductName,systemManufacturer:e.telemetryGroup.systemManufacturer},p={invocationTimestamp:null!==(i=e.invocationTimestamp)&&void 0!==i?i:-1,integrationInitTimestamp:null!==(a=e.integrationInitTimestamp)&&void 0!==a?a:-1};return{appId:e.appId,authenticationType:Mf(e.authenticationType),ageGroup:Bf(e.ageGroup),callbackFunctions:l,clientName:e.Application,clientFeedbackId:e.clientFeedbackId,feedbackConfig:u,isProduction:e.IsProd,performanceTimestamps:p,telemetry:d,tenantId:e.telemetryGroup.tenantId,themeOptions:{baseTheme:s},userData:e.userData,userId:e.telemetryGroup.loggableUserId}}function Uf(e){var t,n,o,r,i,a,s;if(null==e||!e.appData)return!1;const l=Wf(e.appData);return!(void 0===l||null!=l&&null!==(t=l.AppModeExt)&&void 0!==t&&t.toLowerCase().includes("embed_view")||null!=l&&null!==(n=l.UiHost)&&void 0!==n&&n.toLowerCase().includes("teams")||null!=l&&null!==(o=l.App)&&void 0!==o&&o.toLowerCase().includes("powerpoint")&&null!=l&&null!==(r=l.AppModeExt)&&void 0!==r&&r.toLowerCase().includes("view")||null!=l&&null!==(i=l.App)&&void 0!==i&&i.toLowerCase().includes("visio")&&null!=l&&null!==(a=l.Host)&&void 0!==a&&a.toLowerCase().includes("onedrivewopi")&&null!=l&&null!==(s=l.AppModeExt)&&void 0!==s&&s.toLowerCase().includes("view"))}const Gf={};function qf(e,t){var n;e.customerUiWrapperFeedbackData.integrationInitTimestamp=Date.now(),(n=_async_to_generator((function*(){var n;n={taskPaneIdToClose:e.taskPaneIdToClose,taskPaneLocation:e.taskPaneLocation,uiType:e.customerUiWrapperFeedbackData.uiType},Gf.taskPaneIdToClose&&Gf.taskPaneLocation&&n.uiType!==Ff.g.NoSurfaceWithoutTitle&&zf({taskPaneIdToClose:Gf.taskPaneIdToClose,taskPaneLocation:Gf.taskPaneLocation,uiType:n.uiType}),Gf.taskPaneIdToClose=n.taskPaneIdToClose,Gf.taskPaneLocation=n.taskPaneLocation;const o=Hf(e),r=Af(o,t);yield Object(Ff.h)(r),Object(Ff.i)(o)})),function(){return n.apply(this,arguments)})().then(()=>{}).catch(t=>{i.a.sendTraceTag(507807516,a.a.msoulscat_Wac_WacFeedback,s.a.Error,Of("Centro Initialization failed for OCV Inapp Feedback => "+t,"centroAsyncOperation",e.customerUiWrapperFeedbackData.clientFeedbackId))})}function Qf(e){return Kf.apply(this,arguments)}function Kf(){return(Kf=_async_to_generator((function*(e){var t;const n=Hf({customerUiWrapperFeedbackData:e});if(n.clientName&&Wf(null===(t=n.feedbackConfig)||void 0===t?void 0:t.appData).Language){const e=Af(n);yield Object(Ff.j)(e)}}))).apply(this,arguments)}class Jf extends R.PureComponent{componentDidMount(){const{feedbackTaskPaneProps:e}=this.props;try{var t;i.a.sendTraceTag(508956945,a.a.msoulscat_Wac_WacFeedback,s.a.Info,Of("Centro-based Feedback Taskpane invoked:","OOUI OcvFeedbackTaskPane",null==e||null===(t=e.customerUiWrapperFeedbackData)||void 0===t?void 0:t.clientFeedbackId)),e.customerUiWrapperFeedbackData.initializationComplete=t=>{var n;i.a.sendTraceTag(508952738,a.a.msoulscat_Wac_WacFeedback,s.a.Info,Of("Feedback initialization complete result: "+JSON.stringify(t),"OOUI OcvFeedbackTaskPane initializationComplete",null==e||null===(n=e.customerUiWrapperFeedbackData)||void 0===n?void 0:n.clientFeedbackId))},qf(e,this.centroRef)}catch(t){var n;i.a.sendTraceTag(508957004,a.a.msoulscat_Wac_WacFeedback,s.a.Error,Of("Centro Initialization failed due to internal error => "+t,"OOUI OcvFeedbackTaskPane",null==e||null===(n=e.customerUiWrapperFeedbackData)||void 0===n?void 0:n.clientFeedbackId))}}render(){var e;const{feedbackTaskPaneProps:t}=this.props;var n;if(!t||!t.customerUiWrapperFeedbackData)return i.a.sendTraceTag(508957003,a.a.msoulscat_Wac_WacFeedback,s.a.Error,Of("Centro Initialization failed for OCV Inapp Feedback due to missing feedback Taskpane props","OOUI OcvFeedbackTaskPane",null==t||null===(n=t.customerUiWrapperFeedbackData)||void 0===n?void 0:n.clientFeedbackId)),R.createElement("div",null);t.customerUiWrapperFeedbackData.uiType=Ff.g.NoSurfaceWithoutTitle,t.customerUiWrapperFeedbackData.hostPlatform=Ff.c.WacTaskPane;let o=this.taskPaneStyles.taskPaneContent;return"powerpoint"===(null===(e=t.customerUiWrapperFeedbackData)||void 0===e||null===(e=e.Application)||void 0===e?void 0:e.toLowerCase())&&(o=`${o} AddinPanePanelResize ${this.taskPaneStyles.appForOfficeContainer}`),R.createElement("div",{className:o,ref:this.centroRef})}constructor(){super(...arguments),this.centroRef=R.createRef(),this.taskPaneStyles=_f()}}function Yf(e){return class extends R.Component{componentDidMount(){this.props.setFocusCallback&&this.ref.current&&this.props.setFocusCallback(this.props.taskPaneId,this.ref.current.focus)}render(){return R.createElement(e,_object_spread({ref:this.ref},this.props))}constructor(){super(...arguments),this.ref=R.createRef()}}}var Zf=n(53),$f=n(372),Xf=n(2513);class ex extends R.PureComponent{componentDidMount(){this.initializeTooltipHost()}componentWillUnmount(){this.tooltipHost&&(this.tooltipHost.unregisterTooltipHostActions(),this.tooltipHost=void 0)}componentDidUpdate(e){this.props.customTooltip&&e.customTooltip!==this.props.customTooltip&&(this.tooltipHost?this.tooltipHost.updateTooltip(this.props.customTooltip):this.initializeTooltipHost())}initializeTooltipHost(){if(this.context.setTooltipElement&&this.context.updateTooltipsHidden&&this.props.customTooltip){const e=Object(Zf.a)(this.context,Zf.f.findDOMNodeRemoved);this.tooltipHost=new $f.a({updateTooltipsHidden:this.context.updateTooltipsHidden,setTooltipElement:this.context.setTooltipElement,refElement:e?void 0:this.wrapperRef,htmlElement:e?this.wrapperRef.current:void 0,controlId:this.props.id,controlLabel:this.props.customTooltip,tooltipDirection:this.props.tooltipDirection,performSetOnNextFrame:!!Object(Zf.a)(this.context,Zf.f.delayRenderTooltipsIsEnabled),removeFindDomNodeEnabled:e}),this.tooltipHost.registerTooltipHostActions()}}render(){const{label:e,iconProps:t,id:n,ariaLiveAssertiveness:o}=this.props,r=Object(Xf.b)(this.props.styles),i=o;return R.createElement("div",{className:r.root,ref:this.wrapperRef},t&&R.createElement(fe.a,_object_spread_props(_object_spread({},t),{styles:Object(Xf.a)(t)})),"off"!==i&&R.createElement(Sd.a,{"aria-live":null!=i?i:void 0,message:e}),R.createElement("div",{"data-unique-id":n,className:r.label,"aria-hidden":"true"},e))}constructor(){super(...arguments),this.wrapperRef=R.createRef()}}ex.contextType=Hm.a;var tx,nx=n(992);!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Tip=2]="Tip",e[e.IntelligentService=3]="IntelligentService"}(tx||(tx={}));var ox=n(1015),rx=n(542),ix=n(163);const ax={selectors:{"svg > path.OfficeIconColors_HighContrast":{fill:"HighlightText"}}},sx={selectors:{"[aria-expanded='true'] svg > path.OfficeIconColors_HighContrast":{fill:"HighlightText"}}},lx=Object(Jo.c)(()=>Object(F.db)({root:{display:"flex",height:"100%",flexDirection:"column"},recheckButton:{display:"flex",alignItems:"center",justifyContent:"space-between",minHeight:40}})),cx={root:["qa-screener-ignore"],label:["qa-screener-ignore",{fontWeight:600,marginLeft:8}]},ux={root:[{marginRight:16}]},dx=Object(Jo.c)(e=>Object(F.db)({root:{flexGrow:1,height:"100%",minHeight:100,paddingLeft:16,paddingRight:16,paddingTop:4},pivot:{display:"flex",flexDirection:"column",border:"1px solid transparent",height:"100%",width:"100%",backgroundColor:Object(ix.c)()?e.palette.white:"white"},pivotItem:{commonHighContrastBorder:ci.h},listContainer:{backgroundColor:Object(ix.c)()?e.palette.white:"white",minHeight:"auto",paddingTop:4}})),px=Object(Jo.c)(()=>Object(F.db)({root:{overflowX:"unset"},focusZone:{maxWidth:"100%"}})),gx=Object(Jo.c)((e,t)=>Object(F.db)({itemContainer:{overflow:"auto",height:"100%"},icon:{selectors:{"& i":{height:16,width:16,marginTop:4}},height:16,width:16},link:{selectors:{[F.m]:{border:"1px solid ButtonText"},":hover":[ci.s,ci.n],":focus":[ci.s,ci.n],[ci.c+" &:focus"]:{outlineWidth:2,outlineOffset:-1,selectors:{[F.m]:[ci.s,ci.n,{outlineOffset:0}]}}}},linkIsSelected:[ci.t,ci.n,{selectors:{":hover":[ci.s,ci.n,{selectors:{[F.m]:{backgroundColor:"Highlight"}}}],[ci.c+" &:focus"]:{outlineWidth:2,outlineOffset:-1,selectors:{[F.m]:[ci.s,ci.n,{outlineOffset:0}]}},"::before":{backgroundColor:Object(ox.a)(e,t).primaryDefaultBackgroundColor,bottom:1},[F.m]:{selectors:{"::before":{backgroundColor:"HighlightText"}}}}}]})),hx={root:{fontWeight:400,padding:"8px 8px"}},mx={root:{paddingLeft:8,paddingRight:8,paddingTop:16}},bx=Object(Jo.c)((e,t,n)=>({root:{height:"32px",width:"100%",backgroundColor:Object(rx.f)(n).background,display:e&&Object($c.h)("AccCheckerFixItMenuIsEnabled")?"auto":"none"},icon:{transform:t?"rotate(90deg)":"unset"}})),fx=Object(Jo.c)((e,t)=>({root:{height:"32px",width:"100%",backgroundColor:Object(rx.f)(t).background},icon:{transform:e?"rotate(90deg)":"unset"}})),xx=Object(Jo.c)((e,t,n)=>Object(F.db)({root:{display:"flex",bottom:0,padding:"8px 16px",flexDirection:"column",overflow:"hidden",flexShrink:0},title:{fontSize:18,paddingTop:8,paddingBottom:4},body:{paddingTop:8,paddingBottom:8},notification:{display:e?"initial":"none",padding:"0 16px"},fixItContainer:{display:t&&Object($c.h)("AccCheckerFixItMenuIsEnabled")?"auto":"none"},additionalInformationContainer:{display:n?"auto":"none"}})),Ex=Object(Jo.c)(e=>({root:{background:Object(ix.c)()?e.palette.neutralLighterAlt:"rgba(113, 175, 229, 0.2)",color:Object(ix.c)()?e.palette.themeDark:"#00188f"},icon:{color:Object(ix.c)()?e.palette.themeDark:"#00188f"}})),Sx=Object(Jo.c)(()=>Object(F.db)({root:{selectors:{":focus":[ci.s,ci.n,ax,sx],[ci.a]:{outlineWidth:2,outlineOffset:-2,left:0,right:0,top:0,bottom:0,border:"none"}}},groupHeaderContainer:{selectors:{":hover":[ci.s,ci.n,ax,sx]}},expand:{selectors:{"&[aria-expanded='true'] svg > path.OfficeIconColors_HighContrast":{fill:"ButtonText"},":hover":[ci.s,ci.n],":focus":[ci.s,ci.n,ax]}},expandIsCollapsed:{width:14,height:14},title:{overflow:"hidden"}})),yx=Object(Jo.c)(e=>Object(F.db)({root:{width:"100%",selectors:{":hover":{color:e.palette.neutralPrimary,commonHighContrastOutlineHoverFocus:ci.s,commonHighContrastHoverFocusStyles:ci.n,[F.m]:{backgroundColor:"Highlight",outlineColor:"ButtonText",outlineStyle:"dashed",forcedColorAdjust:"none"," [role='gridcell']":{[F.m]:{backgroundColor:"Highlight",color:"HighlightText",forcedColorAdjust:"none"}}}},":focus":{color:e.palette.neutralPrimary,commonHighContrastOutlineHoverFocus:ci.s,commonHighContrastHoverFocusStyles:ci.n,[F.m]:{backgroundColor:"Highlight",outlineColor:"ButtonText",outlineStyle:"dashed",forcedColorAdjust:"none"," [role='gridcell']":{[F.m]:{backgroundColor:"Highlight",color:"HighlightText",forcedColorAdjust:"none"}}}},".ms-GroupSpacer":{flexShrink:0},[ci.a]:{borderWidth:2,left:0,right:0,top:0,bottom:0}}},cell:{color:e.palette.neutralPrimary}}));class Cx extends R.PureComponent{componentDidMount(){this.props.innerRef&&(this.props.innerRef.current=this),this.props.updateLastScanTime&&this.props.updateLastScanTime(this.setLastScanTime)}componentDidUpdate(e){e.innerRef!==this.props.innerRef&&(e.innerRef&&(e.innerRef.current=null),this.props.innerRef&&(this.props.innerRef.current=this))}render(){const{resultsReady:e}=this.props;return e||(this._allErrors=[],this._allWarnings=[],this._allTips=[],this._allIntelligentServices=[],this._errorRules=[],this._warningRules=[],this._tipRules=[],this._intelligentServiceRules=[],this._errorItems=[],this._warningItems=[],this._tipItems=[],this._intelligentServiceItems=[],this._selectionErrors.setAllSelected(!1),this._selectionWarnings.setAllSelected(!1),this._selectionTips.setAllSelected(!1),this._selectionIntelligentServices.setAllSelected(!1),this._repopulateResults=!0),this.setNotificationText(),R.createElement(we.a,null,t=>R.createElement("div",{className:this.accCheckerHeaderClassNames.root},R.createElement("div",{className:this.accCheckerHeaderClassNames.recheckButton},R.createElement(ex,{type:"AppStatusTextProps",id:"LastScanTime",label:this.getLastScanTime(),styles:cx}),R.createElement(Ko.a,{id:"RecheckBtn",type:"AppButtonProps",styles:ux,label:AccessibilityCheckerPaneStringsManager.get(AccessibilityCheckerPaneStringsEnum.RecheckButton),ariaDescription:e?this._notificationText+" "+this._lastScanTimeLabel:AccessibilityCheckerPaneStringsManager.get(AccessibilityCheckerPaneStringsEnum.Scanning),disabled:!e,onExecute:this.onRecheckClick,ref:this.recheckButton})),R.createElement("div",{className:dx(t).root},this.renderList(!e,t)),this.renderNotificationBar(t),R.createElement("div",{id:"AccCheckerFooter",className:this.accCheckerFooterClassNames.root},R.createElement(Ko.a,{type:"AppButtonProps",label:AccessibilityCheckerPaneStringsManager.get(AccessibilityCheckerPaneStringsEnum.RecommendedActions),id:"FixItChevron",icon:this.props.pivotIcons.chevron,styles:bx(this._showFixItMenu,this._expandFixIt,t),onExecute:this.ToggleFixItHeader,ariaExpanded:this._expandFixIt}),R.createElement("div",{id:"FixIt",className:xx(this._showNotification,this._expandFixIt,this._expandAdditionalInformation).fixItContainer},this.renderFixItButtons()),R.createElement(Ko.a,{type:"AppButtonProps",label:AccessibilityCheckerPaneStringsManager.get(AccessibilityCheckerPaneStringsEnum.AdditionalInformationTitle),id:"AdditionalInformationChevron",icon:this.props.pivotIcons.chevron,styles:fx(this._expandAdditionalInformation,t),onExecute:this.ToggleAdditionalInformationHeader,ariaExpanded:this._expandAdditionalInformation}),R.createElement("div",{id:"AdditionalInformation",className:xx(this._showNotification,this._expandFixIt,this._expandAdditionalInformation).additionalInformationContainer},AccessibilityCheckerPaneStringsManager.get(AccessibilityCheckerPaneStringsEnum.AdditionalInformationHeader),R.createElement("div",{className:this.accCheckerFooterClassNames.title},AccessibilityCheckerPaneStringsManager.get(AccessibilityCheckerPaneStringsEnum.AdditionalInformationTitle)),R.createElement("div",{className:this.accCheckerFooterClassNames.body},AccessibilityCheckerPaneStringsManager.get(AccessibilityCheckerPaneStringsEnum.AdditionalInformationBody)),R.createElement(Mu.a,{type:"AppLinkProps",id:"AccCheckerHelpLink",text:AccessibilityCheckerPaneStringsManager.get(AccessibilityCheckerPaneStringsEnum.AdditionalInformationLink),onExecute:this.onHelpLinkClick})))))}renderFixItButtons(){const e=this.props.fixItMenuControlRendererFunction;this._showFixItMenu=!1;const t=[];for(const n in this.props.violationToControlMap)if(n.toString()===this._currentlySelectedRuleId.toString()){this.props.violationToControlMap[n].forEach(n=>{e&&(t.push(e(n)),this._showFixItMenu=!0)});break}return R.createElement("div",{style:{display:"flex",flexDirection:"column"}},t)}renderNotificationBar(e){return this.updateNotifications(),R.createElement("div",{className:xx(this._showNotification,this._expandFixIt,this._expandAdditionalInformation).notification},R.createElement(Wp.a,{styles:this.getMessageBarStyle(e),messageBarType:this._messageBarType},this._notificationText))}renderList(e,t){if(!e&&this._repopulateResults){const{accessibilityCheckResultCollection:e}=this.props;e&&(this._allErrors=this.getViolationsInCategory(e,tx.Error),this._allWarnings=this.getViolationsInCategory(e,tx.Warning),this._allTips=this.getViolationsInCategory(e,tx.Tip),this._allIntelligentServices=this.getViolationsInCategory(e,tx.IntelligentService),this.sortByRuleID(this._allErrors),this.sortByRuleID(this._allWarnings),this.sortByRuleID(this._allTips),this.sortByRuleID(this._allIntelligentServices),e&&e.AccessibilityRules&&(this.populatePivot(this._allErrors,this._errorRules,this._errorItems,e.AccessibilityRules,tx.Error),this.populatePivot(this._allWarnings,this._warningRules,this._warningItems,e.AccessibilityRules,tx.Warning),this.populatePivot(this._allTips,this._tipRules,this._tipItems,e.AccessibilityRules,tx.Tip),this.populatePivot(this._allIntelligentServices,this._intelligentServiceRules,this._intelligentServiceItems,e.AccessibilityRules,tx.IntelligentService))),this._repopulateResults=!1}const{appColors:n,pivotIcons:o}=this.props;return R.createElement(Zs.a,{linkFormat:"links",linkSize:"normal",className:dx(t).pivot,styles:gx(t,n),onLinkClick:this.onLinkClick},R.createElement($s.a,{itemIcon:o.error,itemCount:this._allErrors.length,itemKey:AccessibilityCheckerPaneStringsManager.get(AccessibilityCheckerPaneStringsEnum.ErrorsTab),onRenderItemLink:this.customRenderer(AccessibilityCheckerPaneStringsManager.get(AccessibilityCheckerPaneStringsEnum.ErrorsTab),this.errorsTooltipRef),className:dx(t).pivotItem,ariaLabel:AccessibilityCheckerPaneStringsManager.get(AccessibilityCheckerPaneStringsEnum.ErrorsTab)+", "+this._allErrors.length,id:"ErrorsTab",headerButtonProps:{onFocus:this.onLinkFocus(this.errorsTooltipRef)}},e?this.getShimmeredList(t):this.populateList(this._allErrors,this._errorItems,this._errorRules,this._selectionErrors,AccessibilityCheckerPaneStringsManager.get(AccessibilityCheckerPaneStringsEnum.ErrorsTab),t)),R.createElement($s.a,{itemIcon:o.warning,itemCount:this._allWarnings.length,itemKey:AccessibilityCheckerPaneStringsManager.get(AccessibilityCheckerPaneStringsEnum.WarningsTab),onRenderItemLink:this.customRenderer(AccessibilityCheckerPaneStringsManager.get(AccessibilityCheckerPaneStringsEnum.WarningsTab),this.warningsTooltipRef),className:dx(t).pivotItem,ariaLabel:AccessibilityCheckerPaneStringsManager.get(AccessibilityCheckerPaneStringsEnum.WarningsTab)+", "+this._allWarnings.length,id:"WarningsTab",headerButtonProps:{onFocus:this.onLinkFocus(this.warningsTooltipRef)}},e?this.getShimmeredList(t):this.populateList(this._allWarnings,this._warningItems,this._warningRules,this._selectionWarnings,AccessibilityCheckerPaneStringsManager.get(AccessibilityCheckerPaneStringsEnum.WarningsTab),t)),R.createElement($s.a,{itemIcon:o.tips,itemCount:this._allTips.length,itemKey:AccessibilityCheckerPaneStringsManager.get(AccessibilityCheckerPaneStringsEnum.TipsTab),onRenderItemLink:this.customRenderer(AccessibilityCheckerPaneStringsManager.get(AccessibilityCheckerPaneStringsEnum.TipsTab),this.tipsTooltipRef),className:dx(t).pivotItem,ariaLabel:AccessibilityCheckerPaneStringsManager.get(AccessibilityCheckerPaneStringsEnum.TipsTab)+", "+this._allTips.length,id:"TipsTab",headerButtonProps:{onFocus:this.onLinkFocus(this.tipsTooltipRef)}},e?this.getShimmeredList(t):this.populateList(this._allTips,this._tipItems,this._tipRules,this._selectionTips,AccessibilityCheckerPaneStringsManager.get(AccessibilityCheckerPaneStringsEnum.TipsTab),t)),R.createElement($s.a,{itemIcon:o.intelligentServices,itemCount:this._allIntelligentServices.length,itemKey:AccessibilityCheckerPaneStringsManager.get(AccessibilityCheckerPaneStringsEnum.IntelligentServicesTab),onRenderItemLink:this.customRenderer(AccessibilityCheckerPaneStringsManager.get(AccessibilityCheckerPaneStringsEnum.IntelligentServicesTab),this.intelligentServicesTooltipRef),className:dx(t).pivotItem,ariaLabel:AccessibilityCheckerPaneStringsManager.get(AccessibilityCheckerPaneStringsEnum.IntelligentServicesTab)+", "+this._allIntelligentServices.length,id:"IntelligentServicesTab",headerButtonProps:{onFocus:this.onLinkFocus(this.intelligentServicesTooltipRef)}},e?this.getShimmeredList(t):this.populateList(this._allIntelligentServices,this._intelligentServiceItems,this._intelligentServiceRules,this._selectionIntelligentServices,AccessibilityCheckerPaneStringsManager.get(AccessibilityCheckerPaneStringsEnum.IntelligentServicesTab),t)))}populateList(e,t,n,o,r,i){const a={headerProps:{onGroupHeaderClick:this.onGroupHeaderClick,styles:Sx()},onRenderHeader:this.onRenderGroupHeader};return R.createElement("div",{id:"ResultsContainer",className:dx(i).listContainer},e.length>0?R.createElement(yd.a,{selection:o,selectionMode:_u.d.single,isSelectedOnFocus:!1},R.createElement(zm.a,{items:t,groups:n,listProps:{onShouldVirtualize:()=>!0},selection:o,compact:!0,selectionMode:_u.d.none,groupProps:a,componentRef:this.groupedResultsList,styles:px(),onRenderCell:(e,t,n)=>this.onRenderCell(i,e,t,n)})):R.createElement(jt.a,{styles:hx,"aria-live":"polite"},this.getNoIssuesFoundString(r)))}getShimmeredList(e){return R.createElement("div",{id:"ShimmeredResultsContainer",className:dx(e).listContainer},this.createShimmeredList())}getLastScanTime(){const{resultsReady:e}=this.props,t=AccessibilityCheckerPaneStringsManager.get(AccessibilityCheckerPaneStringsEnum.LastChecked);return e?this._lastScanTimeLabel:t.replace("{0}",AccessibilityCheckerPaneStringsManager.get(AccessibilityCheckerPaneStringsEnum.Scanning))}setOutOfSyncNotification(){this._notificationText=AccessibilityCheckerPaneStringsManager.get(AccessibilityCheckerPaneStringsEnum.OutOfSyncNotification),this._messageBarType=zp.a.info}setPartialResultNotification(){this._notificationText=AccessibilityCheckerPaneStringsManager.get(AccessibilityCheckerPaneStringsEnum.PartialResultNotification),this._messageBarType=zp.a.info}setUnsuccessfulResultsNotification(){this._notificationText=AccessibilityCheckerPaneStringsManager.get(AccessibilityCheckerPaneStringsEnum.UnsuccessfulResultsNotification),this._messageBarType=zp.a.error}clearNotification(){this._notificationText=""}constructor(e){super(e),this._errorItems=[],this._warningItems=[],this._tipItems=[],this._intelligentServiceItems=[],this._errorRules=[],this._warningRules=[],this._tipRules=[],this._intelligentServiceRules=[],this._allErrors=[],this._allWarnings=[],this._allTips=[],this._allIntelligentServices=[],this._selectionErrors=new ku.a,this._selectionWarnings=new ku.a,this._selectionTips=new ku.a,this._selectionIntelligentServices=new ku.a,this._currentlySelectedPivot=AccessibilityCheckerPaneStringsManager.get(AccessibilityCheckerPaneStringsEnum.ErrorsTab),this._showNotification=!1,this._notificationText="",this._messageBarType=zp.a.info,this.recheckButton=R.createRef(),this.groupedResultsList=R.createRef(),this.errorsTooltipRef=R.createRef(),this.warningsTooltipRef=R.createRef(),this.tipsTooltipRef=R.createRef(),this.intelligentServicesTooltipRef=R.createRef(),this._repopulateResults=!0,this._expandFixIt=!1,this._expandAdditionalInformation=!1,this._showFixItMenu=!1,this._currentlySelectedRuleId="",this._lastScanTimeLabel=AccessibilityCheckerPaneStringsManager.get(AccessibilityCheckerPaneStringsEnum.LastChecked).replace("{0}",(new Date).toLocaleTimeString()),this._columns=[{key:"violations",name:"AccessibilityViolations",fieldName:"key",minWidth:100,maxWidth:200,isResizable:!0,ariaLabel:AccessibilityCheckerPaneStringsManager.get(AccessibilityCheckerPaneStringsEnum.ResultsColumnLabel)}],this.accCheckerHeaderClassNames=lx(),this.accCheckerFooterClassNames=xx(),this.onLinkFocus=e=>()=>{var t;null==e||null===(t=e.current)||void 0===t||t.show()},this.onLinkClick=e=>{this._currentlySelectedPivot=e.props.itemKey,this.resetSelection(this._selectionErrors),this.resetSelection(this._selectionWarnings),this.resetSelection(this._selectionTips),this.resetSelection(this._selectionIntelligentServices)},this.getMessageBarStyle=e=>{if(this._messageBarType!==zp.a.error)return Ex(e)},this.resetSelection=e=>{e!==this._selectionErrors&&this._selectionErrors.setAllSelected(!1),e!==this._selectionWarnings&&this._selectionWarnings.setAllSelected(!1),e!==this._selectionTips&&this._selectionTips.setAllSelected(!1),e!==this._selectionIntelligentServices&&this._selectionIntelligentServices.setAllSelected(!1)},this.onViolationSelectionChanged=e=>{null!==e&&0!==e.count?(this.props.onInvokeNavigateExecute&&this.props.onInvokeNavigateExecute(e.getSelection()[0].value.ResultId),this._currentlySelectedRuleId=e.getSelection()[0].value.RuleId):this._currentlySelectedRuleId="",this.forceUpdate()},this.customRenderer=(e,t)=>(n,o)=>R.createElement(Ee.a,{content:e,calloutProps:{gapSpace:0},componentRef:t},o(n)),this.onRenderGroupHeader=e=>{const{pivotIcons:t}=this.props;return R.createElement(nx.a,_object_spread_props(_object_spread({},e),{expandButtonIcon:t.chevron,indentWidth:0}))},this.onRenderCell=(e,t,n,o)=>n&&"number"==typeof o&&o>-1?R.createElement(Tu.a,{columns:this._columns,groupNestingDepth:t,item:n,itemIndex:o,selection:this.getSelection(),selectionMode:_u.d.single,compact:!0,styles:yx(e),checkboxVisibility:wh.a.hidden}):null,this.getSelection=()=>{switch(this._currentlySelectedPivot){case AccessibilityCheckerPaneStringsManager.get(AccessibilityCheckerPaneStringsEnum.ErrorsTab):return this._selectionErrors.setItems(this._errorItems,!1),this._selectionErrors;case AccessibilityCheckerPaneStringsManager.get(AccessibilityCheckerPaneStringsEnum.WarningsTab):return this._selectionWarnings.setItems(this._warningItems,!1),this._selectionWarnings;case AccessibilityCheckerPaneStringsManager.get(AccessibilityCheckerPaneStringsEnum.TipsTab):return this._selectionTips.setItems(this._tipItems,!1),this._selectionTips;case AccessibilityCheckerPaneStringsManager.get(AccessibilityCheckerPaneStringsEnum.IntelligentServicesTab):return this._selectionIntelligentServices.setItems(this._intelligentServiceItems,!1),this._selectionIntelligentServices;default:return this._selectionErrors}},this.createShimmeredList=()=>{const e=[];for(let t=0;t<3;t+=1)for(let t=100;t>=50;t-=25)e.push(R.createElement(le.a,{width:t+"%",shimmerElements:[{type:cp.a.circle},{type:cp.a.gap,width:"2%"},{type:cp.a.line}],styles:mx}));return e},this.getNoIssuesFoundString=e=>{const{accessibilityCheckResultCollection:t}=this.props;let n;return n=t&&t.Results&&t.Results.length>0?AccessibilityCheckerPaneStringsManager.get(AccessibilityCheckerPaneStringsEnum.NoIssuesFoundInCategory).replace("{0}",e.toLowerCase()):AccessibilityCheckerPaneStringsManager.get(AccessibilityCheckerPaneStringsEnum.NoIssuesFound),n},this.onGroupHeaderClick=e=>{e.isCollapsed=!e.isCollapsed,this.groupedResultsList.current&&this.groupedResultsList.current.forceUpdate()},this.setLastScanTime=()=>{let e=AccessibilityCheckerPaneStringsManager.get(AccessibilityCheckerPaneStringsEnum.LastChecked);const t=new Date;e=e.replace("{0}",t.toLocaleTimeString()),this._lastScanTimeLabel=e},this.populatePivot=(e,t,n,o,r)=>{for(const e of Object(cu.f)(o))e.Category===r&&t.push({count:0,key:e.RuleId,name:e.RuleName,startIndex:0,isCollapsed:!0});if(e.forEach(e=>{let o=!1;t.forEach(t=>{o||t.key!==e.RuleId||(t.count=t.count+1,o=!0)}),n.push({key:e.ContentName,value:e})}),t.length>1){t.sort((e,t)=>parseInt(e.key,10)-parseInt(t.key,10));for(let e=0;e<t.length;e+=1)0!==t[e].count?e>0&&(t[e].startIndex=t[e-1].startIndex+t[e-1].count):(t.splice(e,1),e-=1)}},this.getViolationsInCategory=(e,t)=>{const n=[];return null!==e.Results&&e.Results.forEach(o=>{e.AccessibilityRules[o.RuleId].Category===t&&n.push(o)}),n},this.sortByRuleID=e=>{e.sort((e,t)=>parseInt(e.RuleId,10)-parseInt(t.RuleId,10))},this.ToggleFixItHeader=()=>{this._expandFixIt=!this._expandFixIt,this.forceUpdate()},this.ToggleAdditionalInformationHeader=()=>{this._expandAdditionalInformation=!this._expandAdditionalInformation,this.forceUpdate()},this.onRecheckClick=()=>{this._showFixItMenu=!1,this._expandFixIt=!1,this.props.onRecheckExecute&&this.props.onRecheckExecute()},this.onHelpLinkClick=()=>{"true"===Object($c.a)("HelpTabIsEnabled","false")?this.props.showHelpPane&&this.props.showHelpPane():this.openHelpLink()},this.openHelpLink=()=>{window.open(this.props.helpLink)},this.focus=()=>{this.recheckButton&&this.recheckButton.current&&this.recheckButton.current.focus()},this.updateNotifications=()=>{const{outOfSync:e,partialResult:t,accessibilityCheckResultCollection:n}=this.props;let o=!1;n&&(o=!n.IsSuccess),this._showNotification=e||t||o},this.setNotificationText=()=>{const{outOfSync:e,partialResult:t,accessibilityCheckResultCollection:n}=this.props;e?this.setOutOfSyncNotification():t?this.setPartialResultNotification():n&&!n.IsSuccess?this.setUnsuccessfulResultsNotification():this.clearNotification()},this._selectionErrors=new ku.a({onSelectionChanged:()=>{this.resetSelection(this._selectionErrors),this.onViolationSelectionChanged(this._selectionErrors)}}),this._selectionErrors.setItems(this._errorItems),this._selectionWarnings=new ku.a({onSelectionChanged:()=>{this.resetSelection(this._selectionWarnings),this.onViolationSelectionChanged(this._selectionWarnings)}}),this._selectionWarnings.setItems(this._warningItems),this._selectionTips=new ku.a({onSelectionChanged:()=>{this.resetSelection(this._selectionTips),this.onViolationSelectionChanged(this._selectionTips)}}),this._selectionTips.setItems(this._tipItems),this._selectionIntelligentServices=new ku.a({onSelectionChanged:()=>{this.resetSelection(this._selectionIntelligentServices),this.onViolationSelectionChanged(this._selectionIntelligentServices)}}),this._selectionIntelligentServices.setItems(this._intelligentServiceItems)}}const vx=Object(Rc.a)([(e,t)=>t.violationToControlId,kc.V,kc.u],(e,t,n)=>{const o={};for(const r of Object.keys(e)){const i=[];e[r].forEach(e=>{const o=Object(Tc.c)(t,n,e,{});i.push(o)}),o[r]=i}return o});var Rx=n(319);const kx=R.createRef(),Tx=Object(Ic.connect)((e,t)=>{Object(Rx.j)("AccCheckerTaskPane");const n=_object_spread_props(_object_spread({},t),{violationToControlMap:vx(e,t)});return Object(Rx.j)("AccCheckerTaskPane","NonCached"),n},void 0,void 0,{areStatesEqual:Object(Pc.c)("AccCheckerTaskPane")})(Object(Dc.a)(Cx));class _x extends R.PureComponent{focus(){var e;null==kx||null===(e=kx.current)||void 0===e||e.focus()}render(){return R.createElement(Tx,_object_spread({innerRef:kx},this.props))}}var wx=n(432),Dx=n(339),Px=n(49);class Ix extends R.PureComponent{componentDidMount(){this.extensionCollection=Object(Px.g)().getExtensions([Px.b.CommentThread],Dx.a),this.extensionCollection.onUpdated.subscribe(this.onExtensionCollectionStateChange),this.setComponentProvider()}setComponentProvider(){const e=this.getExtensionProvider();if(!e)return void this.setState({componentProvider:void 0});const t=e.getExtension();t.priority!==Px.d.Disabled?Object(wx.d)().getComponent(t.componentKey).then(e=>{e.onStateChanged.subscribe(this.onComponentProviderStateChange),this.setState({componentProvider:e})}).catch(e=>{this.setState({componentProvider:void 0}),i.a.sendTraceTag(571073567,a.a.msoulscat_Wac_TaskPane,s.a.Info,"Failed to fetch provider from ComponentRegistry's getComponent promise. Message: "+e)}):this.setState({componentProvider:void 0})}getExtensionProvider(){const e=this.extensionCollection&&this.extensionCollection.providers.filter(e=>e.scope.contentType===Px.b.CommentThread&&e.scope.renderMode===Px.e.TaskPane);if(!e||!e.length)return;const t=e[0];return Object(Px.j)(t)?t:void 0}render(){var e;return null!==(e=this.state.componentProvider)&&void 0!==e&&e.component?R.createElement(this.state.componentProvider.component,null):null}constructor(e){super(e),this.onComponentProviderStateChange=e=>{e===wx.a.Unregistered&&this.setState({componentProvider:void 0})},this.onExtensionCollectionStateChange=e=>{this.setComponentProvider()},this.focus=()=>{this.props.focusCallback&&this.props.focusCallback()},this.state={componentProvider:void 0}}}const Fx=Object(Jo.c)(e=>({bodyContainer:{position:"absolute",width:"100%",height:"100%",zIndex:1e3,backgroundColor:e.palette.neutralLighterAlt},iconCard:{height:"80px",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:e.palette.neutralLighter},icon:{width:"48px",height:"48px"},mainBody:{width:"100%",height:"100%"},copylinkCard:{height:"210px",padding:"24px 16px"},title:{fontWeight:600,marginBottom:"24px",fontSize:"16px",lineHeight:"22px",color:e.palette.neutralDark},input:{padding:"6px 8px",boxSizing:"border-box",borderRadius:"2px",fontWeight:400,fontSize:"14px",lineHeight:"20px",color:e.palette.neutralDark,backgroundColor:e.palette.neutralLighterAlt},copySucceedMsg:{margin:"8px 0 0 -10px",height:"12px",fontWeight:400,fontSize:"10px",lineHeight:"12px",color:e.palette.neutralDark},copyButton:{marginTop:"24px",display:"flex",justifyContent:"flex-end"}}));var Bx=n(415),Mx=n(1215);class jx extends R.PureComponent{render(){const{sharingLink:e,iconUrl:t}=this.props;return R.createElement(we.a,null,n=>{const o=Fx(n);return R.createElement("div",{style:o.bodyContainer},R.createElement("div",{style:o.iconCard},R.createElement("div",{style:o.icon},t&&Object(Mx.a)(t))),R.createElement("div",{style:o.mainBody},R.createElement("div",{style:o.copylinkCard},R.createElement("div",{style:o.title},this._addinSharingTitle),R.createElement(I.a,{autoFocus:!0,readOnly:!0,componentRef:e=>{this._textField=e},type:"text",value:e,style:o.input}),R.createElement("div",{style:o.copySucceedMsg},R.createElement(Yl.a,{id:"AddingSharingCopiedSuccessMessage",type:"AppLabelProps",label:this.state.successfullyCopied?this._copiedSuccessMessage:"",forId:"AddingSharingCopiedSuccessMessage"})),R.createElement("div",{style:o.copyButton},R.createElement(Wd.a,{id:"AddinSharingCopyLinkButton",styles:Object(Bx.d)(Object(Bx.c)(n,void 0)),text:this._copyButtonLabel,onClick:()=>{this._copySharingLinkToClipboard()}})))))})}constructor(e){super(e),this._copySharingLinkToClipboard=()=>{let e=!1;try{this._textField.focus(),this._textField.setSelectionRange(0,this._textField.value.length),e=document.execCommand("copy")}catch(e){i.a.sendTraceTag(526989392,a.a.msoulscat_Wac_TaskPane,s.a.Error,'Copy link failed by document.execCommand("copy"), error: '+e)}try{const t=window.external.CopyToClipboard(this.props.sharingLink);e=t||void 0===t}catch(e){i.a.sendTraceTag(526989393,a.a.msoulscat_Wac_TaskPane,s.a.Error,"Copy link failed by CopyToClipboard, error: "+e)}e&&this.props.copySuccessCallback&&this.props.copySuccessCallback(),this.setState({successfullyCopied:e})},this.state={successfullyCopied:!1},this._copyButtonLabel=OfficeCommonStringsManager.get(OfficeCommonStringsEnum.AddinSharingCopyLinkButtonLabel),this._copiedSuccessMessage=OfficeCommonStringsManager.get(OfficeCommonStringsEnum.AddingSharingCopiedSuccessMessage),this._addinSharingTitle=OfficeCommonStringsManager.get(OfficeCommonStringsEnum.AddinSharingTitle),this._textField=R.createRef()}}class Ox extends R.PureComponent{render(){const{addinSharingTaskPaneProps:e,showSharingContent:t}=this.props;return R.createElement(R.Fragment,null,e&&t&&R.createElement(jx,_object_spread({},e)),R.createElement("div",{style:{position:"relative",height:"100%",display:e&&t?"none":"block"},ref:this.container}))}componentDidMount(){this.container&&this.container.current&&this.container.current.appendChild(this.props.getContent())}constructor(e){super(e),this.container=R.createRef()}}const Lx=(()=>{const e={root:["ExcelLegacyTaskPaneContainer",{height:"100%"}]};return{root:Object(F.eb)(e.root)}})();class Ax extends R.PureComponent{render(){return R.createElement("div",{className:Lx.root,ref:this.container})}componentDidMount(){this.container&&this.container.current&&this.container.current.appendChild(this.props.getContent())}constructor(){super(...arguments),this.container=R.createRef()}}var Nx,Wx;!function(e){e[e.None=0]="None",e[e.BlockedInSheetView=1]="BlockedInSheetView",e[e.BlockedInProtectedSheet=2]="BlockedInProtectedSheet",e[e.DataExceedsLimit=3]="DataExceedsLimit",e[e.GeneralError=4]="GeneralError",e[e.NoSuggestions=5]="NoSuggestions"}(Nx||(Nx={})),function(e){e[e.Disabled=0]="Disabled",e[e.LoadingSuggestions=1]="LoadingSuggestions",e[e.DisplaySuggestions=2]="DisplaySuggestions"}(Wx||(Wx={}));const zx=()=>R.createElement(At.a,{"data-testid":"Loading",horizontalAlign:"center",verticalAlign:"center",style:{height:"100%"}},R.createElement(Jp.a,{label:"Loading...",labelPosition:"right"})),Hx=R.createContext(null);function Vx(){return R.useContext(Hx)}const Ux=Hx.Provider;var Gx=n(240);function qx(e){const t=Object(Gx.a)(e);return R.useEffect(()=>{Object(ob.__assign)(t,e)},[e,t]),t}const Qx=R.createContext({});function Kx(){return R.useContext(Qx)}const Jx=e=>{const t=qx(e.callbacks);return R.createElement(Qx.Provider,{value:t},e.children)};var Yx=n(456);const Zx={text:{fontSize:12,width:"100%"},root:{paddingInline:10,marginBlockEnd:5},label:{alignItems:"center",width:"100%"},checkbox:{height:16,width:16,"::after":{top:2,left:2}}},$x=({options:e,checkedOptions:t,onChange:n,selectAllLabel:o,testId:r,optionsContainerStyle:i,getOptionLabel:a=String,getOptionCount:s,getOptionsCount:l})=>{const c=Object(Yx.a)(),u=R.useRef(null);if(R.useEffect(()=>{var e;return null===(e=u.current)||void 0===e?void 0:e.forceUpdate()},[t]),null==e||!e.length)return null;const d=t.length>0&&t.length<e.length;return R.createElement(R.Fragment,null,R.createElement(yo.a,{styles:Zx,label:o,indeterminate:d,checked:t.length===e.length,onRenderLabel:(e,t)=>Xx(null==e?void 0:e.label,null==l?void 0:l(),c,[e,t]),onChange:(t,o)=>n(o||d?e:[])}),R.createElement(Pl.a,{"data-testid":r,ref:u,style:i,items:e,getKey:e=>a(e),onRenderCell:e=>R.createElement(yo.a,{inputProps:{"data-testid":e},label:a(e),onRenderLabel:(t,n)=>Xx(null==t?void 0:t.label,null==s?void 0:s(e),c,[t,n]),styles:Zx,checked:t.includes(e),onChange:(o,r)=>{n(r?[...t,e]:t.filter(t=>t!==e))}})}))};function Xx(e,t,n,[o,r]){var i,a;if(void 0===t)return null!==(a=null==r?void 0:r(o))&&void 0!==a?a:null;const s=R.createElement(At.a,{grow:!0,horizontal:!0,horizontalAlign:"space-between","data-testid":"OptionLabel"},R.createElement("span",null,e),R.createElement("span",{style:{color:n.palette.neutralPrimaryAlt}},t));return null!==(i=null==r?void 0:r(_object_spread_props(_object_spread({},o),{label:s})))&&void 0!==i?i:null}function eE(e){return e.type===nE.TextInconsistency}function tE(e){return e.type===nE.NumberFormatInconsistency}var nE,oE;!function(e){e[e.TextInconsistency=0]="TextInconsistency",e[e.NumberFormatInconsistency=1]="NumberFormatInconsistency",e[e.ExtraSpacesTable=2]="ExtraSpacesTable",e[e.DateFormat=3]="DateFormat"}(nE||(nE={})),function(e){e[e.AllNumber=0]="AllNumber",e[e.AllText=1]="AllText",e[e.MixedNumberAndText=2]="MixedNumberAndText"}(oE||(oE={}));const rE=[nE.ExtraSpacesTable,nE.TextInconsistency,nE.NumberFormatInconsistency],iE=[nE.ExtraSpacesTable,nE.TextInconsistency,nE.NumberFormatInconsistency,nE.DateFormat];function aE(){return Object(x.getBooleanFeatureGate)("Microsoft.Office.Excel.AugLoop.TableLint_EnableDateFormat",!1)&&Object(x.getBooleanFeatureGate)("Microsoft.Office.Excel.DataCleansing_ShowDateFormatSuggestionCard",!1)?iE:rE}const sE=({availableTypes:e,selectedTypes:t,tables:n,selectedTables:o,suggestions:r,onFilterChanged:l,isFiltered:c})=>{const[u,d]=R.useState(t),[p,g]=R.useState(o);function h(){d(t),g(o)}R.useEffect(h,[t,o]);const m=[{key:"FilterBySuggestionType",text:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.Filter_FilterByType),itemType:Go.a.Header},{key:"types",onRender:()=>R.createElement($x,{options:e,checkedOptions:u,onChange:d,getOptionLabel:e=>function(e){switch(e){case nE.ExtraSpacesTable:return ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.Filter_ExtraSpacesType);case nE.TextInconsistency:return ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.Filter_TextInconsistencyType);case nE.NumberFormatInconsistency:return ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.Filter_NumberFormatInconsistencyType);case nE.DateFormat:return ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.Filter_DateFormatType);default:return void i.a.sendTraceTag(540378824,a.a.msoulscat_ES_EWAJS,s.a.Warning,"SuggestionsFilter.stringByType: No string for type "+e)}}(e),selectAllLabel:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.Filter_SelectAllTypes),testId:"FilterByTypeList",getOptionsCount:()=>r.length,getOptionCount:e=>r.filter(t=>t.type===e).length})},{key:"FilterByTable",text:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.Filter_FilterByTable),itemType:Go.a.Header},{key:"tables",onRender:()=>R.createElement($x,{options:n,checkedOptions:p,onChange:g,selectAllLabel:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.Filter_SelectAllTables),optionsContainerStyle:{maxHeight:200,overflow:"auto"},testId:"FilterByTableList",getOptionsCount:()=>r.length,getOptionCount:e=>r.filter(t=>t.tableName===e).length})},{key:"Apply",onRender:(e,t)=>R.createElement(Wd.a,{"data-testid":"SuggestionsFilterApply",text:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.Filter_Apply),styles:{root:{margin:"5px 0 10px 10px"}},disabled:0===u.length||0===p.length,onClick:e=>{t(e,!0),l(u,p)}})}];return R.createElement(vd.a,{"data-testid":"SuggestionsFilterButton",iconProps:{iconName:c?be.a.EditFilter_16:be.a.Filter_20},styles:{root:{padding:0,height:25,marginInlineEnd:5}},menuProps:{items:m,doNotLayer:!0,calloutProps:{calloutWidth:225},onMenuDismissed(){h()}}})},lE=R.createContext({});function cE(){return R.useContext(lE)}const uE=lE.Provider,dE=R.createContext(void 0),pE=R.createContext(()=>{});function gE(){return R.useContext(dE)}const hE=({children:e})=>{const t=cE(),[n,o]=R.useState({}),r=R.useCallback((e,t)=>{e?o(n=>_object_spread_props(_object_spread({},n),{[e]:t})):i.a.sendTraceTag(508843221,a.a.msoulscat_ES_EWAJS,s.a.Error,"Set filter failed: sheetId is undefined")},[o]);return R.createElement(pE.Provider,{value:r},R.createElement(dE.Provider,{value:n[t.sheetId]},e))},mE=({isFiltered:e,suggestions:t,sheetId:n})=>{const o=gE(),r=R.useContext(pE),i=Array.from(new Set(t.map(e=>e.tableName))),{filterTables:a,filterSuggestionTypes:s}=function(e,t,n){const o={filterTables:t,filterSuggestionTypes:n};if(e){const n=t.filter(t=>e.filterTables.includes(t));n.length>0&&(o.filterTables=n);const r=aE().filter(t=>e.filterSuggestionTypes.includes(t));r.length>0&&(o.filterSuggestionTypes=r)}return o}(o,i,aE()),[l,c]=R.useState({selectedTypes:s,selectedTables:a});return R.createElement(sE,_object_spread_props(_object_spread({},l),{isFiltered:e,availableTypes:aE(),tables:i,onFilterChanged:function(e,t){c({selectedTypes:e,selectedTables:t}),n&&(null==r||r(n,{filterTables:t,filterSuggestionTypes:e}))},suggestions:t}))},bE=Object(F.eb)({fontWeight:F.l.semibold}),fE=Object(F.eb)({whiteSpace:"pre-line"}),xE=({title:e,subTitle:t,testId:n,children:o})=>R.createElement("div",{"data-testid":n},R.createElement(At.a,{tokens:{childrenGap:8},style:{height:"100%"}},R.createElement(rs.a,{className:bE},e),R.createElement(rs.a,{className:fE,variant:"smallPlus"},t),o)),EE=()=>R.createElement(xE,{testId:"EmptyFilteredSuggestions",title:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.Filter_NoSuggestionTitle),subTitle:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.Filter_NoSuggestionSubheader)}),SE=R.createContext(void 0),yE=SE.Provider;function CE(){return R.useContext(SE)}const vE=()=>{const e=CE();return null!=e&&e.canRefresh?R.createElement(Wp.a,{isMultiline:!1,messageBarType:zp.a.success,styles:{root:{width:"unset"},iconContainer:{display:"none"},content:{alignItems:"center","&.ms-MessageBar-content":{display:"flex"}},actions:{"&.ms-MessageBar-actionsSingleLine":{marginInlineEnd:-2,marginBlockEnd:0}},text:{fontSize:F.k.small,marginInlineStart:10}},actions:R.createElement(Ue.a,{onClick:e.refresh,primary:!0,styles:{textContainer:{fontWeight:F.l.semibold,fontSize:F.k.small}}},ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.RefreshAnnotations_Button))},ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.RefreshAnnotations_Title)):null},RE={top:0,position:"sticky",zIndex:1},kE=({name:e,sticky:t})=>{const n=Object(Yx.a)(),{neutralLight:o,neutralPrimaryAlt:r}=n.palette,i=Object(rx.f)(n).background,a=o;return R.createElement(Xi.a,{styles:{root:_object_spread_props(_object_spread({},t?RE:{}),{backgroundColor:i,":before":{backgroundColor:a}}),content:{backgroundColor:i,padding:"0 "+F.k.size20}}},R.createElement(rs.a,{variant:"small",styles:{root:{color:r,fontWeight:F.l.semibold}}},e))};var TE=n(2477);const _E=R.createContext({isSelected:!1,isHovered:!1}),wE=_E.Provider,DE=({index:e,suggestionId:t,isPreviewEnabled:n,children:o,isSelected:r,onRemoved:i,disabled:a=!1})=>{const s=Vx(),[l,c]=R.useState(!1);return Object(TE.a)(()=>{null==i||i()}),R.createElement("span",{role:"listitem",className:"suggestion-card","data-selection-index":e,onClick:e=>{e.target!==document.activeElement&&e.currentTarget.focus()},onMouseEnter:()=>{var e;c(!0),n&&(null==s||null===(e=s.onSuggestionPreview)||void 0===e||e.call(s,t))},onMouseLeave:()=>{var e;c(!1),n&&(null==s||null===(e=s.onCancelSuggestionPreview)||void 0===e||e.call(s,t))},style:_object_spread({outline:"none",transition:"opacity 0.45s linear",marginBlockEnd:8},a&&{userSelect:"none",opacity:"0.4"}),"data-is-focusable":!0,"data-selection-select":!0,"data-selected-card":r||void 0},R.createElement(wE,{value:{isSelected:r,isHovered:l}},o))};var PE=n(2129),IE=n(1016),FE=({range:e,tooltip:t,style:n})=>{const o=Object(Yx.a)();if(!e)return null;const r={cursor:"default",padding:3,border:"1px solid",borderRadius:3,fontSize:F.k.xSmall,fontWeight:F.l.semibold,color:o.palette.neutralDark,borderColor:o.palette.neutralLight,backgroundColor:o.palette.neutralLight,textOverflow:"ellipsis",whiteSpace:"pre",overflow:"hidden"};return t?R.createElement(Ee.a,{overflowMode:IE.a.Self,directionalHint:Se.a.bottomCenter,content:t,styles:{root:_object_spread({},r,n)}},e):R.createElement(rs.a,{styles:{root:r}},e)};const BE={Apply:be.a.Checkmark_16,Ignore:be.a.DeleteHover_16,Close:c.a.CancelGlyph_16,Actions:c.a.HintBarEllipses_20},ME={icon:{width:12,margin:0},root:{height:"unset",fontSize:F.k.size12,padding:0,":after":{outlineOffset:"6px"}}},jE=Object(Jo.c)((e,t)=>{const n={iconDisabled:{"path.OfficeIconColors_m22":{fill:null==t?void 0:t.neutralTertiaryAlt}}},o={iconHovered:{"path.OfficeIconColors_m22":{fill:null==t?void 0:t.themePrimary}}};return Object(F.db)(ME,n,(null==e?void 0:e.colorIconOnHover)&&o)}),OE={root:{width:16,height:16,marginInlineEnd:-9,marginBlockStart:-9}},LE=Object(Jo.c)((e,t)=>Object(F.eb)({padding:9,borderRadius:"3px",boxSizing:"border-box",boxShadow:PE.a.depth4,border:"2px solid transparent",background:t.palette.white,opacity:"inherit",":hover":{boxShadow:PE.a.depth8}},e&&{borderColor:t.palette.themePrimary})),AE=({menuItems:e,menuString:t})=>{if(!e||0===e.length)return null;if(1===e.length){const[t]=e;return R.createElement(Ue.a,{style:{marginInlineStart:"auto"},onClick:()=>t.onClick(),styles:jE()},t.text)}return R.createElement(Uo.a,{style:{marginInlineStart:"auto"},title:t,menuProps:{items:e},menuIconProps:{iconName:BE.Actions},ariaLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.OverflowWellLabel)})},NE={APPLY:{iconName:BE.Apply},IGNORE:{iconName:BE.Ignore},GENERAL:void 0},WE=({title:e,range:t,rangeTooltipString:n,mainActions:o=[],children:r,isSelected:i=!1,otherActions:a=[],otherActionsString:s,onClose:l,closeString:c,handleTab:u,focusBeforeApply:d=!1,additionalAction:p,actionsRowStyle:g,showRangeBadge:h=!0,aiDisclaimerText:m,showCopilotIcon:b})=>{const f=R.useRef(null),x=Object(Yx.a)(),E=LE(i,x);return R.createElement(Cd.a,{className:E,handleTabKey:u},l&&R.createElement(At.a,{horizontalAlign:"end"},R.createElement(vd.a,{title:c,iconProps:{iconName:BE.Close},onClick:l,styles:OE})),R.createElement(At.a,{style:l?{paddingInlineEnd:7}:{}},R.createElement(At.a,{horizontal:!0,style:{marginBottom:10},tokens:{childrenGap:10},horizontalAlign:"space-between",verticalAlign:"start"},R.createElement(At.a,{horizontal:!0,tokens:{childrenGap:10}},b&&R.createElement(fe.a,{iconName:"XLCoPilot_24"}),b?R.createElement(jt.a,{style:{padding:0,fontSize:18}},e):R.createElement(jt.a,{style:{padding:0}},e)),h&&R.createElement(FE,{range:t,tooltip:n,style:{maxWidth:"25%"}})),r),R.createElement(Xi.a,{styles:{root:{padding:"1px 0",":before":{backgroundColor:x.palette.neutralQuaternaryAlt}}}}),R.createElement(At.a,{horizontal:!0,horizontalAlign:"start",tokens:{childrenGap:6},style:g},R.createElement(zE,{mainActions:o,applyButtonRef:f,focusBeforeApply:d}),p,R.createElement(AE,{menuItems:a,menuString:s})),m&&R.createElement(rs.a,{block:!0,variant:"xSmall",styles:{root:{color:x.palette.neutralSecondaryAlt,paddingBlockStart:"0.6em"}}},m))},zE=({mainActions:e,applyButtonRef:t,focusBeforeApply:n})=>{const o=Object(Yx.a)();return R.createElement(R.Fragment,null,e.map(e=>{var r;const i=((e,t,n)=>"apply"===e.key&&t?()=>{var t,o;null===(t=n.current)||void 0===t||t.focus(),null===(o=e.onClick)||void 0===o||o.call(e)}:()=>{var t;null===(t=e.onClick)||void 0===t||t.call(e)})(e,n,t);return"CallToActionPrimary"===(null==e?void 0:e.buttonStyleFlavor)?R.createElement(Wd.a,{key:e.key,"data-testid":e.testId,disabled:e.disabled,onClick:i},e.text):"CallToActionDefault"===(null==e?void 0:e.buttonStyleFlavor)?R.createElement(pr.a,{key:e.key,"data-testid":e.testId,disabled:e.disabled,onClick:i},e.text):R.createElement(Ue.a,{key:e.key,elementRef:"apply"===e.key?t:null,"data-testid":e.testId,disabled:e.disabled,onClick:i,iconProps:null!==(r=e.iconProps)&&void 0!==r?r:NE[e.kind],styles:jE(e,o.palette)},e.text)}))};var HE=({text:e,spacesRegex:t=/\s/,highlightLeading:n=!0,highlightMiddle:o=!0,highlightTrailing:r=!0,ignoreSingleMiddle:i=!0,whitespaceBaseColor:a="#FF9198",variant:s="thin",wrap:l=!1})=>{if(!e)return null;if(!(n||o||r))return R.createElement(R.Fragment,null,e);const c=((e,t)=>{const n={margin:"0 0.5px",":first-child":{marginInlineStart:0},":last-child":{marginInlineEnd:0}};return Object(F.db)({container:{whiteSpace:t?"pre-wrap":"pre"},space:_object_spread_props(_object_spread({},n),{backgroundColor:e}),spacesContainer:_object_spread_props(_object_spread({},n),{display:"inline-block"})})})(a,l);return R.createElement("span",{className:c.container},function(e,t,n=/\s/){const o=[];let r=0;for(;r<e.length;){let i="";for(;r<e.length&&n.test(e[r]);)i+=e[r],r+=1;i.length>0&&o.push(t(i,r-1));let a="";for(;r<e.length&&!n.test(e[r]);)a+=e[r],r+=1;a.length>0&&o.push(a)}return o}(e,(t,a)=>{const l=a===t.length-1,u=a===e.length-1,d=!(l||u);if(l&&!n||d&&!o||d&&i&&t.length<2||u&&!r)return t;const p=t.replace("\r\n","\n");return R.createElement("span",{key:a,className:c.spacesContainer},Array.from(p).map((e,t)=>R.createElement("span",{key:`${a}|${t}`,className:c.space},"thin"===s?e:e+e)))},t))};const VE=({onChange:e,variations:t,collapsedVariationsToShow:n=(Object(x.isChangeGateEnabled)("OfficeVSO:8642532_IncreaseVariationsToShow")?10:4)})=>{const o=R.useCallback((t,n=!1)=>{var o;return e(null==t||null===(o=t.currentTarget)||void 0===o?void 0:o.name,n)},[e]),[r,i]=R.useState(!1),a=r?t:t.slice(0,n);return R.createElement(At.a,null,R.createElement(At.a,{verticalAlign:"center",styles:{root:{margin:"8px 0",outline:"none"}},tokens:{childrenGap:"6px 0"}},a.map(e=>R.createElement(yo.a,{name:e.value,key:e.value,label:e.value,checked:e.isSelected,onChange:o,onRenderLabel:UE,styles:{text:{fontSize:12},checkbox:{height:16,width:16},label:{maxWidth:"100%",whiteSpace:"pre"}}}))),t.length>n&&R.createElement(At.a,{horizontalAlign:"start",styles:{root:{marginBottom:4}}},R.createElement(Ue.a,{styles:{root:{fontSize:12,height:20}},onClick:()=>i(e=>!e)},r?ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.TextInconsistencyIssue_ShowLess):ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.TextInconsistencyIssue_ShowAll))))},UE=(e,t)=>R.createElement("div",{style:{overflow:"hidden",textOverflow:"ellipsis"}},R.createElement(Ee.a,{content:R.createElement(HE,{text:null==e?void 0:e.label,wrap:!0}),overflowMode:IE.a.Parent},null==t?void 0:t({label:R.createElement(HE,{text:null==e?void 0:e.label})})));var GE,qE=n(1221);function QE(e,t){switch(e.type){case nE.TextInconsistency:return KE[nE.TextInconsistency](e,t);case nE.NumberFormatInconsistency:return KE[nE.NumberFormatInconsistency](e,t)}return e}!function(e){e[e.NoChange=0]="NoChange",e[e.ReplacementValue=1]="ReplacementValue",e[e.VariationSelection=2]="VariationSelection",e[e.CustomNumberFormat=3]="CustomNumberFormat"}(GE||(GE={}));const KE={[nE.TextInconsistency]:(e,t)=>{const n=_object_spread_props(_object_spread({},e),{variations:e.variations.map(e=>_object_spread({},e))});switch(t.type){case GE.NoChange:break;case GE.VariationSelection:{var o;const e=null===(o=n.variations)||void 0===o?void 0:o.find(e=>(null==e?void 0:e.value)===t.variation);e&&(e.isSelected=t.selected);break}case GE.ReplacementValue:var r;n.replacementValue=t.value,null===(r=n.variations)||void 0===r||r.forEach(t=>{(null==t?void 0:t.value)===e.replacementValue&&(t.isSelected=!0),(null==t?void 0:t.value)===n.replacementValue&&(t.isSelected=!1)})}return n},[nE.NumberFormatInconsistency]:(e,t)=>{const n=_object_spread_props(_object_spread({},e),{formats:e.formats.map(e=>_object_spread({},e))});switch(t.type){case GE.NoChange:break;case GE.ReplacementValue:n.replacementFormat=t.value;break;case GE.CustomNumberFormat:{var o,r;const i=null!==(o=null===(r=e.formats)||void 0===r?void 0:r.filter(e=>(null==e?void 0:e.key)!==t.format.key))&&void 0!==o?o:[];n.formats=[...i,t.format],n.replacementFormat=t.format.key;break}}return n}};function JE(e){for(const t of e.variations)if(t.value===e.replacementValue)return t.linters;return["UserCustomValue"]}var YE=n(1190);const ZE=e=>{var{actionsRef:t,onChange:n,onPendingValueChanged:o}=e,r=_object_without_properties(e,["actionsRef","onChange","onPendingValueChanged"]);const l=R.useRef(),c=R.useRef(!1);return R.useEffect(()=>{t&&(t.current={flushChangeEvent(){void 0!==l.current&&(c.current=!0,null==n||n({},void 0,void 0,l.current),i.a.sendTraceTag(540354722,a.a.msoulscat_ES_EWAJS,s.a.Info,"FlushableComboBox: flushed change event"))}})},[t,n]),R.createElement(YE.a,_object_spread_props(_object_spread({},r),{onPendingValueChanged:(e,t,n)=>{void 0!==n&&(l.current=n),null==o||o(e,t,n)},onChange:(e,t,o,r)=>{var s;c.current?(c.current=!1,i.a.debugAssertTag(540312162,a.a.msoulscat_ES_EWAJS,l.current===(null!==(s=null==t?void 0:t.text)&&void 0!==s?s:r),"FlushableComboBox: Skipped with a different value")):null==n||n(e,t,o,r),l.current=void 0}}))};function $E(e){switch(e){case"AllNumber":return oE.AllNumber;case"AllText":return oE.AllText;case"MixedNumberAndText":return oE.MixedNumberAndText;default:throw new TypeError(e+" is not supported for NumberFormatVariationsType")}}function XE(e){switch(e){case nE.ExtraSpacesTable:return"ExtraSpaces";case nE.TextInconsistency:return"TextInconsistency";case nE.NumberFormatInconsistency:return"NumberFormatInconsistency";case nE.DateFormat:return"DateFormat";default:return"UnknownSuggestionType"}}function eS(e){switch(e){case oE.AllNumber:return"AllNumber";case oE.AllText:return"AllText";case oE.MixedNumberAndText:return"MixedNumberAndText";case void 0:default:return"UnknownNumberFormatVariationType"}}function tS(e,t){return new Set(Array.from(e).filter(e=>!t.has(e)))}function nS(e,t){return e.reduce((e,n)=>{const o=t(n);return o in e?e[o]++:e[o]=1,e},{})}function oS(e){const t=[];return e.forEach(e=>t.push(...e)),t}const rS=[Object($m.d)("featureNameField","DataCleansing"),Object($m.d)("ver","1.0.0")],iS={dataCategories:Ym.a.DataCategories.ProductServiceUsage,samplingPolicy:Ym.a.SamplingPolicy.Measure,diagnosticLevel:Ym.a.DiagnosticLevel.Optional},aS={dataCategories:Ym.a.DataCategories.ProductServiceUsage,samplingPolicy:Ym.a.SamplingPolicy.CriticalBusinessImpact,diagnosticLevel:Ym.a.DiagnosticLevel.RequiredServiceData},sS={eventName:"Office.Excel.Client.DataCleansing.Seen",eventFlags:iS,dataFields:[...rS,Object($m.a)("isFeatureSeen",!0)]},lS={eventName:"Office.Excel.Client.DataCleansing.Tried",eventFlags:iS,dataFields:[...rS,Object($m.a)("isFeatureTried",!0)]},cS={eventName:"Office.Excel.Client.DataCleansing.Succeeded",eventFlags:iS,dataFields:[...rS,Object($m.a)("isFeatureSucceeded",!0)]};function uS(e){return e.reduce((e,t)=>(function(e,t){const{tableIdentifier:n}=t;n&&(n in e||(e[n]={}),function(e,t){const n=XE(t.type);n in e||(e[n]=0),e[n]++}(e[n],t))}(e,t),e),{})}function dS(e,t,n=""){const o=XE(e.type);i.a.sendTraceTag(509219931,a.a.msoulscat_ES_EWAJS,s.a.Important,`sendApplyTelemetry: applied ${o} in [sheetId: ${t} tableId: ${e.tableIdentifier}] ${n}`),Object(Jm.a)().sendTelemetryEvent((e=>({eventName:"Office.Excel.Client.DataCleansing.Apply",eventFlags:aS,dataFields:[...rS,Object($m.d)("suggestionType",e)]}))(o))}function pS(e){return nS(oS(e.filter(eE).map(e=>Array.from(function(e){return new Set(oS(e.variations.map(e=>e.linters)))}(e).values()))),e=>e)}function gS(e){return nS(e.filter(tE),e=>{var t;return eS(null!==(t=e.variationsType)&&void 0!==t?t:void 0)})}const hS=R.createContext(void 0);function mS(){return R.useContext(hS)}const bS=hS.Provider;function fS(){const e=mS(),t=Vx();return R.useCallback(n=>{null==e||e.showToast({key:"undo_suggestion",message:n,actionMessage:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.ConfirmationCallout_UndoButton),action:null==t?void 0:t.undoLastAppliedSuggestion,onDismiss:null==t?void 0:t.reportSuggestionSucceeded})},[t,e])}var xS=n(2560);const ES=[nE.ExtraSpacesTable,nE.TextInconsistency,nE.NumberFormatInconsistency];function SS(e,t){if(!e||!t)return e?-1:1;const{suggestionRange:n}=e,{suggestionRange:o}=t;return yS(e.tableRange,t.tableRange)||CS(n,o)||function(e,t){const n=ES.indexOf(e),o=ES.indexOf(t);return(n<0?ES.length:n)-(o<0?ES.length:o)}(e.type,t.type)||vS(n,o)}function yS(e,t){return CS(e,t)||vS(e,t)}function CS(e,t){return e.left-t.left}function vS(e,t){return e.top-t.top}function RS(e){return e.reduce((e,t)=>e+(t.bottom-t.top+1)*(t.right-t.left+1),0)}const kS=new RegExp("d","g"),TS=/[0-9]/gm,_S=/[A-Z]/g,wS=String.raw`=\[\]\.\\\/%#\-\+,;():?"&<>'\!{}~^*\u0024\u0080\u00a2\u00a3\u00a4\u00a5\u20a0\u20a1\u20a2\u20a3\u20a4\u20a5\u20a6\u20a7\u20a8\u20a9\u20aa\u20ab\u20ac\u20ad\u20ae\u20af\u20b0\u20b1\u20b2\u20b3\u20b4\u20b5\u20b6\u20b7\u20b8\u20b9\ua0c2`,DS=new RegExp(`[^\\s${wS}dW]`,"gm");var PS=n(1001);const IS={[nE.ExtraSpacesTable]:{getSuggestionAffectedRanges:e=>oS(Array.from(e.rangesByType.values())),canApplySuggestion:e=>!0},[nE.TextInconsistency]:{getSuggestionAffectedRanges:e=>LS(e.variations.filter(t=>t.ranges&&t.isSelected&&t.value!==e.replacementValue)),canApplySuggestion(e){var t;return Boolean(e.replacementValue&&(null===(t=e.variations)||void 0===t?void 0:t.some(t=>(null==t?void 0:t.isSelected)&&t.value!==e.replacementValue)))}},[nE.NumberFormatInconsistency]:{getSuggestionAffectedRanges:e=>LS(e.formats.filter(t=>t.format!==e.replacementFormat||!t.isApplicable)),canApplySuggestion(e){var t,n;return null!==(t=null===(n=e.formats)||void 0===n?void 0:n.some(e=>null==e?void 0:e.isApplicable))&&void 0!==t&&t}},[nE.DateFormat]:{getSuggestionAffectedRanges:e=>e.ranges,canApplySuggestion:e=>!0}};function FS(e){switch(null==e?void 0:e.type){case nE.ExtraSpacesTable:case nE.TextInconsistency:case nE.NumberFormatInconsistency:case nE.DateFormat:return IS[e.type].canApplySuggestion(e);default:return!1}}function BS(e){let t=[];switch(null==e?void 0:e.type){case nE.ExtraSpacesTable:case nE.TextInconsistency:case nE.NumberFormatInconsistency:case nE.DateFormat:t=IS[e.type].getSuggestionAffectedRanges(e)}return function(e){function t(e,t){const n=e.left===t.left&&e.right===t.right,o=t.top-e.bottom<=1;return n&&o}const n=e.sort(yS),o=[];for(let e=0;e<n.length;e++){for(;e<n.length-1&&t(n[e],n[e+1]);)n[e+1]=(r=n[e+1],i=n[e],{left:Math.min(r.left,i.left),top:Math.min(r.top,i.top),right:Math.max(r.right,i.right),bottom:Math.max(r.bottom,i.bottom)}),e++;o.push(n[e])}var r,i;return o}(t)}function MS(e,t,n){const o=e.filter(e=>!n.has(e.id)),r=o.filter(e=>!t(e));return i.a.sendTraceTag(506995998,a.a.msoulscat_ES_EWAJS,s.a.Info,`filterHiddenSuggestions: ${r.length} out of ${e.length} returned. (removed ${e.length-o.length} applied, ${o.length-r.length} ignored)`),r}function jS(e,t){const n=function(e){switch(e.type){case nE.ExtraSpacesTable:return;case nE.TextInconsistency:return e.variations.map(e=>e.value.replace(kS,"w").replace(TS,"d").replace(_S,"W").replace(DS,"w"));case nE.NumberFormatInconsistency:case nE.DateFormat:return;default:Object(PS.a)(e)}}(e);n&&i.a.sendTraceTag(506995997,a.a.msoulscat_ES_EWAJS,s.a.Important,"DataCleansingSuggestionUtils: "+JSON.stringify({action:t?"apply":"ignore",suggestionType:nE[e.type],linters:OS(e),anonymizedSuggestion:n}))}function OS(e){switch(e.type){case nE.ExtraSpacesTable:return;case nE.TextInconsistency:{const t=e.variations.map(e=>e.linters).flat();return Array.from(new Set(t))}case nE.NumberFormatInconsistency:case nE.DateFormat:return;default:Object(PS.a)(e)}}function LS(e){return oS(e.map(e=>e.ranges))}const AS={root:{fontSize:12,marginTop:12,marginBottom:2}},NS={cursor:"default"},WS={root:{DataCleansingSuggestionTextRootStyle:NS}},zS=({suggestion:e,isSelected:t,baseSuggestionCardProps:n,children:o,cardTitle:r,applyButtonMessage:i,ignoreButtonMessage:a,applyAction:s,showApplyConfirmationMessage:l,createApplyTelemetryAdditionalInfo:c,actionBeforeApply:u})=>{var d;const p=Vx(),g=cE(),h=s,m=YS(n.mainActions,i,()=>{var t;null==u||u(),null==p||null===(t=p.onSuggestionApplied)||void 0===t||null===(t=t.call(p,e.id,h))||void 0===t||t.then(t=>{l(t),c?dS(e,null==g?void 0:g.sheetId,c(t)):dS(e,null==g?void 0:g.sheetId),Object(Jm.a)().sendTelemetryEvent(lS)}).catch(()=>{})},()=>{var t;return null==p||null===(t=p.canApplySuggestion)||void 0===t?void 0:t.call(p,e.id)},a);return R.createElement(WE,_object_spread_props(_object_spread({},n),{title:r,mainActions:m,isSelected:t,range:Object(x.isChangeGateEnabled)("OfficeVSO:8828149_DataCleansingHideCardBadge")?void 0:e.columnName,rangeTooltipString:Object(x.isChangeGateEnabled)("OfficeVSO:8828149_DataCleansingHideCardBadge")?void 0:null!==(d=e.columnName)&&void 0!==d?d:void 0,focusBeforeApply:!0}),o)},HS=({suggestion:e,isSelected:t,baseSuggestionCardProps:n})=>{var o;const r=Vx(),i=Kx(),a=cE(),s=R.useRef(),l=null!==(o=function(e){return e.replacementValue||null}(e))&&void 0!==o?o:void 0,c=fS();function u(t,n=!1){var o;null==r||null===(o=r.onSuggestionValuesChanged)||void 0===o||o.call(r,QE(e,{type:GE.VariationSelection,selected:n,variation:t}))}function d(t,n,o,i){var a,s;null==r||null===(a=r.onSuggestionValuesChanged)||void 0===a||a.call(r,QE(e,{type:GE.ReplacementValue,value:null!==(s=null==n?void 0:n.text)&&void 0!==s?s:i}))}function p(e,t,n){n&&n!==l&&d(0,e,0,n)}const g=(h=_async_to_generator((function*(){var t;const n=BS(e),o=e.variations.filter(t=>t.isSelected&&t.value!==e.replacementValue),r=yield null==i||null===(t=i.replaceMultipleStrings)||void 0===t?void 0:t.call(i,n,o.map(e=>e.value),e.replacementValue,{matchCase:!1,matchEntireCell:!0,replaceWholeWordOnly:!1});if(null==r)throw new Error("TextInconsistencyCard.apply: returned a nullish value.");return r})),function(){return h.apply(this,arguments)});var h;const m=YS(n.mainActions,ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.TextInconsistencyCard_Apply),()=>{var t,n;null===(t=s.current)||void 0===t||t.flushChangeEvent(),null==r||null===(n=r.onSuggestionApplied)||void 0===n||null===(n=n.call(r,e.id,g))||void 0===n||n.then(t=>{const n=1===t?ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.TextInconsistencySuggestionApplicationConfirmationSingular):ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.TextInconsistencySuggestionApplicationConfirmationPlural),o=1===t?{}:{changedVariationsCount:t};c(R.createElement(qE.a,{message:n,values:o}));const r=`Linters: [${JE(e)}]`;dS(e,null==a?void 0:a.sheetId,r),Object(Jm.a)().sendTelemetryEvent(lS)}).catch(()=>{})},()=>{var t;return null==r||null===(t=r.canApplySuggestion)||void 0===t?void 0:t.call(r,e.id)},ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.TextInconsistencyCard_Ignore));return Object(x.isChangeGateEnabled)("OfficeVSO:9066287_RefactorDataCleansingBaseSuggestionCardWithApplyFix")?R.createElement(zS,{suggestion:e,isSelected:t,baseSuggestionCardProps:n,cardTitle:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.TextInconsistencyCardTitle),applyButtonMessage:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.TextInconsistencyCard_Apply),ignoreButtonMessage:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.TextInconsistencyCard_Ignore),applyAction:g,showApplyConfirmationMessage:e=>{const t=1===e?ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.TextInconsistencySuggestionApplicationConfirmationSingular):ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.TextInconsistencySuggestionApplicationConfirmationPlural),n=1===e?{}:{changedVariationsCount:e};c(R.createElement(qE.a,{message:t,values:n}))},createApplyTelemetryAdditionalInfo:()=>`Linters: [${JE(e)}]`,actionBeforeApply:()=>{var e;null===(e=s.current)||void 0===e||e.flushChangeEvent()}},R.createElement(rs.a,{variant:"smallPlus",block:!0,styles:WS},R.createElement(qE.a,{message:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.TextInconsistencyCard_Message),values:{column:R.createElement("b",null,e.columnTitle)}})),R.createElement(VE,{variations:e.variations,onChange:u}),R.createElement(ZE,{allowFreeform:!0,autoComplete:"off",text:l,onChange:d,onPendingValueChanged:p,onRenderItem:VS,actionsRef:s,styles:{root:{height:25},input:{fontSize:12},label:{fontSize:12}},comboBoxOptionStyles:{optionText:{fontSize:12}},label:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.TextInconsistencyCard_VariationsDropdownTitle),useComboBoxAsMenuWidth:!0,options:e.variations.map(e=>({key:e.value,text:e.value}))})):R.createElement(WE,_object_spread_props(_object_spread({},n),{title:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.TextInconsistencyCardTitle),mainActions:m,isSelected:t}),R.createElement(rs.a,{variant:"smallPlus",block:!0,styles:{root:{cursor:"default"}}},R.createElement(qE.a,{message:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.TextInconsistencyCard_Message),values:{column:R.createElement("b",null,e.columnTitle)}})),R.createElement(VE,{variations:e.variations,onChange:u}),R.createElement(ZE,{allowFreeform:!0,autoComplete:"off",text:l,onChange:d,onPendingValueChanged:p,onRenderItem:VS,actionsRef:s,styles:{root:{height:25},input:{fontSize:12},label:{fontSize:12}},comboBoxOptionStyles:{optionText:{fontSize:12}},label:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.TextInconsistencyCard_VariationsDropdownTitle),useComboBoxAsMenuWidth:!0,options:e.variations.map(e=>({key:e.value,text:e.value}))}))},VS=(e,t)=>e&&t?t(_object_spread_props(_object_spread({},e),{title:e.text,text:R.createElement(HE,{text:e.text})})):null,US=({suggestion:e,isSelected:t,baseSuggestionCardProps:n})=>{var o;const r=Vx(),l=Kx(),c=cE(),u=function(e){if(void 0===e)return i.a.sendTraceTag(509436363,a.a.msoulscat_ES_EWAJS,s.a.Error,"NumberFormatInconsistencyCard.useSuggestionDescriptionByType: type is undefined"),"";switch(e){case oE.AllNumber:return ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.NumberFormatInconsistencyCard_MixOfNumberIssue);case oE.AllText:return ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.NumberFormatInconsistencyCard_MixTextIssue);case oE.MixedNumberAndText:return ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.NumberFormatInconsistencyCard_MixOfNumberAndTextIssue);default:Object(PS.a)(e)}}(null!==(o=e.variationsType)&&void 0!==o?o:void 0),d=fS(),p=(g=_async_to_generator((function*(){var t;const n=BS(e);if(null==(yield null===(t=l.formatCells)||void 0===t?void 0:t.call(l,n,"General")))throw new Error("NumberFormatInconsistencyCard.apply: returned a nullish value.");return-1})),function(){return g.apply(this,arguments)});var g;const h=YS(n.mainActions,ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.NumberFormatInconsistencyCard_Apply),()=>{var t;null==r||null===(t=r.onSuggestionApplied)||void 0===t||null===(t=t.call(r,e.id,p))||void 0===t||t.then(()=>{var t;d(ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.NumberFormattingInconsistencySuggestionApplicationConfirmation));const n=`type: [${eS(null!==(t=e.variationsType)&&void 0!==t?t:void 0)}]`;dS(e,null==c?void 0:c.sheetId,n),Object(Jm.a)().sendTelemetryEvent(lS)}).catch(()=>{})},()=>{var t;return null==r||null===(t=r.canApplySuggestion)||void 0===t?void 0:t.call(r,e.id)},ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.NumberFormatInconsistencyCard_Ignore));return Object(x.isChangeGateEnabled)("OfficeVSO:9066287_RefactorDataCleansingBaseSuggestionCardWithApplyFix")?R.createElement(zS,{suggestion:e,isSelected:t,baseSuggestionCardProps:n,cardTitle:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.NumberFormatInconsistencyCard_NumberFormatTitle),applyButtonMessage:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.NumberFormatInconsistencyCard_Apply),ignoreButtonMessage:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.NumberFormatInconsistencyCard_Ignore),applyAction:p,showApplyConfirmationMessage:e=>{d(ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.NumberFormattingInconsistencySuggestionApplicationConfirmation))},createApplyTelemetryAdditionalInfo:()=>{var t;return`type: [${eS(null!==(t=e.variationsType)&&void 0!==t?t:void 0)}]`}},R.createElement(rs.a,{variant:"smallPlus",block:!0,styles:{root:_object_spread_props(_object_spread({},NS),{paddingBottom:10})}},R.createElement(qE.a,{message:u,values:{column:R.createElement("b",null,e.columnTitle),number:R.createElement("b",null,ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.NumberFormatInconsistencyCard_Number)),text:R.createElement("b",null,ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.NumberFormatInconsistencyCard_Text))}})),R.createElement(jt.a,{styles:AS},R.createElement(qE.a,{message:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.NumberFormatInconsistencyCard_Message),values:{text:R.createElement("b",null,ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.NumberFormatInconsistencyCard_Text)),number:R.createElement("b",null,ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.NumberFormatInconsistencyCard_Number))}}))):R.createElement(WE,_object_spread_props(_object_spread({},n),{title:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.NumberFormatInconsistencyCard_NumberFormatTitle),mainActions:h,isSelected:t}),R.createElement(rs.a,{variant:"smallPlus",block:!0,styles:{root:{paddingBottom:10,cursor:"default"}}},R.createElement(qE.a,{message:u,values:{column:R.createElement("b",null,e.columnTitle),number:R.createElement("b",null,ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.NumberFormatInconsistencyCard_Number)),text:R.createElement("b",null,ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.NumberFormatInconsistencyCard_Text))}})),R.createElement(jt.a,{styles:{root:{fontSize:12,marginTop:12,marginBottom:2}}},R.createElement(qE.a,{message:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.NumberFormatInconsistencyCard_Message),values:{text:R.createElement("b",null,ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.NumberFormatInconsistencyCard_Text)),number:R.createElement("b",null,ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.NumberFormatInconsistencyCard_Number))}})))},GS=({suggestion:e,isSelected:t,baseSuggestionCardProps:n})=>{const o=Object(Yx.a)(),r=Vx(),i=Kx(),a=cE(),s=fS(),l=(c=_async_to_generator((function*(){var t;const n=yield null==i||null===(t=i.trimWhitespace)||void 0===t?void 0:t.call(i,BS(e),Array.from(e.rangesByType.keys()));if(null==n)throw new Error("ExtraSpacesTableSuggestion.apply: returned a nullish value.");return n})),function(){return c.apply(this,arguments)});var c;const u=YS(n.mainActions,ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.ExtraSpacesTableCard_Apply),()=>{var t;null==r||null===(t=r.onSuggestionApplied)||void 0===t||null===(t=t.call(r,e.id,l))||void 0===t||t.then(t=>{const n=1===t?ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.ExtraSpacesSuggestionApplicationConfirmationSingular):ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.ExtraSpacesSuggestionApplicationConfirmationPlural),o=1===t?{}:{changedCellsCount:t};s(R.createElement(qE.a,{message:n,values:o}));const r=`changedCellsCount: [${t}] claimedAffectedCellsCount: [${RS(BS(e))}]`;dS(e,null==a?void 0:a.sheetId,r),Object(Jm.a)().sendTelemetryEvent(lS)}).catch(()=>{})},()=>{var t;return null==r||null===(t=r.canApplySuggestion)||void 0===t?void 0:t.call(r,e.id)},ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.ExtraSpacesTableCard_Ignore)),d=R.createElement(qE.a,{message:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.ExtraSpacesTableCard_TableMayHaveMessage),values:{tableName:R.createElement("b",null,e.tableName)}});return Object(x.isChangeGateEnabled)("OfficeVSO:9066287_RefactorDataCleansingBaseSuggestionCardWithApplyFix")?R.createElement(zS,{suggestion:e,isSelected:t,baseSuggestionCardProps:n,cardTitle:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.ExtraSpacesTableCard_Title),applyButtonMessage:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.ExtraSpacesTableCard_Apply),ignoreButtonMessage:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.ExtraSpacesTableCard_Ignore),applyAction:l,showApplyConfirmationMessage:e=>{const t=1===e?ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.ExtraSpacesSuggestionApplicationConfirmationSingular):ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.ExtraSpacesSuggestionApplicationConfirmationPlural),n=1===e?{}:{changedCellsCount:e};s(R.createElement(qE.a,{message:t,values:n}))},createApplyTelemetryAdditionalInfo:t=>`changedCellsCount: [${t}] claimedAffectedCellsCount: [${RS(BS(e))}]`},R.createElement(rs.a,{variant:"smallPlus",block:!0,styles:WS},d),R.createElement(jt.a,{styles:AS},ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.ExtraSpacesTableCard_RemoveQuestion)),R.createElement(rs.a,{variant:"small",styles:{root:{borderColor:o.palette.neutralQuaternary,borderWidth:1,borderStyle:"solid",fontWeight:600,padding:4,cursor:"default"}}})):R.createElement(WE,_object_spread_props(_object_spread({},n),{title:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.ExtraSpacesTableCard_Title),mainActions:u,isSelected:t,focusBeforeApply:!0}),R.createElement(rs.a,{variant:"smallPlus",block:!0,styles:{root:{cursor:"default"}}},d),R.createElement(jt.a,{styles:{root:{fontSize:12,marginTop:12,marginBottom:2}}},ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.ExtraSpacesTableCard_RemoveQuestion)),R.createElement(rs.a,{variant:"small",styles:{root:{borderColor:o.palette.neutralQuaternary,borderWidth:1,borderStyle:"solid",fontWeight:600,padding:4,cursor:"default"}}}))},qS=({suggestion:e,isSelected:t,baseSuggestionCardProps:n})=>{const o=Vx(),r=Kx(),i=fS(),a=cE(),s=(l=_async_to_generator((function*(){const t=BS(e);let n;var o,i;if(n=Object(x.isChangeGateEnabled)("OfficeVSO:9118080_FormatCellsAsDates")?yield null===(o=r.formatCells)||void 0===o?void 0:o.call(r,t,"Date"):yield null===(i=r.formatCells)||void 0===i?void 0:i.call(r,t,"General"),!n)throw new Error("DateFormatCard.apply: returned a nullish value.");return-1})),function(){return l.apply(this,arguments)});var l;const c=YS(n.mainActions,ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.DateFormatCard_Apply),()=>{var t;null==o||null===(t=o.onSuggestionApplied)||void 0===t||null===(t=t.call(o,e.id,s))||void 0===t||t.then(()=>{i(ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.DateFormatSuggestionApplicationConfirmation)),dS(e,null==a?void 0:a.sheetId),Object(Jm.a)().sendTelemetryEvent(lS)}).catch(()=>{})},()=>{var t;return null==o||null===(t=o.canApplySuggestion)||void 0===t?void 0:t.call(o,e.id)},ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.DateFormatCard_Ignore));return Object(x.isChangeGateEnabled)("OfficeVSO:9066287_RefactorDataCleansingBaseSuggestionCardWithApplyFix")?R.createElement(zS,{suggestion:e,isSelected:t,baseSuggestionCardProps:n,cardTitle:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.DateFormatCard_Title),applyButtonMessage:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.DateFormatCard_Apply),ignoreButtonMessage:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.DateFormatCard_Ignore),applyAction:s,showApplyConfirmationMessage:e=>{i(ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.DateFormatSuggestionApplicationConfirmation))}},R.createElement(rs.a,{variant:"smallPlus",block:!0,styles:WS},R.createElement(qE.a,{message:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.DateFormatCard_Message),values:{column:R.createElement("b",null,e.columnTitle)}})),R.createElement(jt.a,{styles:AS},ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.DateFormatCard_DateFormatQuestion))):R.createElement(WE,_object_spread_props(_object_spread({},n),{title:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.DateFormatCard_Title),mainActions:c,isSelected:t,focusBeforeApply:!0}),R.createElement(rs.a,{variant:"smallPlus",block:!0,styles:{root:{cursor:"default"}}},R.createElement(qE.a,{message:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.DateFormatCard_Message),values:{column:R.createElement("b",null,e.columnTitle)}})),R.createElement(jt.a,{styles:{root:{fontSize:12,marginTop:12,marginBottom:2}}},ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.DateFormatCard_DateFormatQuestion)))};function QS(e,t){return 0===t?0:(e%t+t)%t}const KS=({ranges:e,isCardSelected:t})=>{const n=Object(Yx.a)(),o=Kx(),[r,l]=R.useState({index:-1});R.useEffect(()=>{t||l({index:-1})},[t]),R.useEffect(()=>{l({index:-1})},[e]),Object(TE.a)(()=>{var e;-1!==r.index&&(null===(e=o.highlightRangesOnGrid)||void 0===e||e.call(o,[],!0,1))}),R.useEffect(()=>{var e;null===(e=o.highlightRangesOnGrid)||void 0===e||e.call(o,-1===r.index?[]:[r.cell],!0,1)},[r,o]);const c={root:{height:F.k.size24,width:F.k.size24}};return R.createElement(At.a,{horizontal:!0,styles:{root:{flexGrow:1}},horizontalAlign:"end",verticalAlign:"center"},R.createElement(vd.a,{iconProps:{iconName:be.a.CommonControlChevronUp_16},title:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.GridNavigationArrow_Previous),styles:c,disabled:0===e.length,onClick:()=>{l(({index:t})=>{const n=QS(t>=0?t-1:t,e.length);return i.a.sendTraceTag(509747720,a.a.msoulscat_ES_EWAJS,s.a.Important,`GridNavigation: previous button was clicked. indexBeforeClick: ${t}/${e.length}  indexAfterClick: ${n}/${e.length}`),{index:n,cell:e[n]}})}}),R.createElement(rs.a,{styles:{root:{margin:0,textAlign:"center",minWidth:F.k.size32,fontSize:F.k.size12,color:n.palette.neutralDark}}},R.createElement(qE.a,{message:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.GridNavigation_Summary),values:{current:r.index+1,count:e.length}})),R.createElement(vd.a,{iconProps:{iconName:be.a.CommonControlChevronDown_16},title:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.GridNavigationArrow_Next),styles:c,disabled:0===e.length,onClick:()=>{l(({index:t})=>{const n=QS(t+1,e.length);return i.a.sendTraceTag(509747719,a.a.msoulscat_ES_EWAJS,s.a.Important,`GridNavigation: next button was clicked. indexBeforeClick: ${t}/${e.length}  indexAfterClick: ${n}/${e.length}`),{index:n,cell:e[n]}})}}))},JS=R.memo(({suggestion:e,isSelected:t})=>{const{isHovered:n}=R.useContext(_E),o=Vx(),r=R.useMemo(()=>function(e){const t=[];return e.forEach(e=>t.push(...function(e){const t=[],n=e.left;for(let o=e.top;o<=e.bottom;o++)t.push({top:o,bottom:o,left:n,right:n});return t}(e))),t}(BS(e)),[e]),l={isSelected:t,focusBeforeApply:!0,mainActions:[{key:"apply",kind:"APPLY",testId:"SuggestionCardApplyButton"},{key:"ignore",onClick:()=>{var t;return null==o||null===(t=o.onSuggestionIgnored)||void 0===t?void 0:t.call(o,e.id)},kind:"IGNORE",testId:"SuggestionCardIgnoreButton"}],actionsRowStyle:{height:F.k.size20},additionalAction:n||t?R.createElement(KS,{ranges:r,isCardSelected:t}):void 0,showRangeBadge:!1,aiDisclaimerText:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.SuggestionDisclaimer)};switch(e.type){case nE.TextInconsistency:return R.createElement(HS,{key:e.id,suggestion:e,isSelected:t,baseSuggestionCardProps:l});case nE.NumberFormatInconsistency:return R.createElement(US,{key:e.id,suggestion:e,isSelected:t,baseSuggestionCardProps:l});case nE.ExtraSpacesTable:return R.createElement(GS,{key:e.id,suggestion:e,isSelected:t,baseSuggestionCardProps:l});case nE.DateFormat:return Object(x.getBooleanFeatureGate)("Microsoft.Office.Excel.DataCleansing_ShowDateFormatSuggestionCard")?R.createElement(qS,{key:e.id,suggestion:e,isSelected:t,baseSuggestionCardProps:l}):null;default:return i.a.sendTraceTag(559748639,a.a.msoulscat_ES_EWAJS,s.a.Warning,"SuggestionCardRenderer: unknown suggestion type "+e.type),null}});function YS(e,t,n,o,r){return e?e.map(e=>"APPLY"===e.kind?_object_spread_props(_object_spread({},e),{text:t,onClick:n,disabled:!o()}):"IGNORE"===e.kind?_object_spread_props(_object_spread({},e),{text:r}):e):[]}const ZS=({tableName:e,suggestions:t,selection:n,selectedSuggestionId:o})=>R.createElement(R.Fragment,null,R.createElement(kE,{name:e,sticky:!0}),R.createElement(At.a,{role:"group",key:e},t.map(e=>{const t=o===e.id;return R.createElement(DE,{key:e.id,index:n.getItemIndex(e.id),suggestionId:e.id,isPreviewEnabled:0===n.getSelectedCount(),isSelected:t,onRemoved:()=>n.setKeySelected(e.id,!1,!1)},R.createElement(JS,{suggestion:e,isSelected:t}))}))),$S=({origin:e})=>{const t=Kx();return R.createElement(At.a,{horizontal:!1},R.createElement(Ut.a,{styles:{root:{fontSize:F.k.size12,marginTop:"15px",marginBottom:"14px"}},onClick:()=>{var n;i.a.sendTraceTag(507594570,a.a.msoulscat_ES_EWAJS,s.a.Important,"CleanDataHelp: Clicked 'LearnMore' button, origin: "+e),null===(n=t.openLearnMore)||void 0===n||n.call(t)}},ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.LearnMore_Link)))},XS=({suggestions:e})=>{const t=Kx(),[n,o]=R.useState(!1),[r,l]=R.useState(!1),[c,u]=R.useState(!1);return R.useEffect(()=>{function n(){return(n=_async_to_generator((function*(){var n;return(yield null===(n=t.containsHiddenCells)||void 0===n?void 0:n.call(t,e.map(e=>BS(e)).flatMap(e=>e)))||!1}))).apply(this,arguments)}o(!1),function(){return n.apply(this,arguments)}().then(e=>{o(e)},()=>{i.a.sendTraceTag(507642078,a.a.msoulscat_ES_EWAJS,s.a.Error,"HiddenCellsWarning: checkHiddenIntersection failed")})},[t,e]),r||!n?null:(c||(i.a.sendTraceTag(507642141,a.a.msoulscat_ES_EWAJS,s.a.Important,"HiddenCellsWarning: Showed warning"),u(!0)),R.createElement(Wp.a,{messageBarType:zp.a.warning,isMultiline:!0,onDismiss:()=>{l(!0),i.a.sendTraceTag(507642140,a.a.msoulscat_ES_EWAJS,s.a.Important,"HiddenCellsWarning: Acknowledged suggestions on hidden cells")},dismissButtonAriaLabel:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.SuggestionsListHiddenCellsWarningCloseAria)},R.createElement(rs.a,{styles:{root:{fontWeight:F.l.bold,fontSize:F.k.size12}}},ExcelDataCleansingStringsManager.get(Object(x.isChangeGateEnabled)("OfficeVSO:9212661_NewHiddenCellsWarning")?ExcelDataCleansingStringsEnum.SuggestionsListHiddenCellsWarningPrefix:ExcelDataCleansingStringsEnum.SuggestionsListHiddenCellsWarningFixSuggestion)),R.createElement(rs.a,{styles:{root:{fontSize:F.k.size12}}},ExcelDataCleansingStringsManager.get(Object(x.isChangeGateEnabled)("OfficeVSO:9212661_NewHiddenCellsWarning")?ExcelDataCleansingStringsEnum.SuggestionsListHiddenCellsWarningDescription:ExcelDataCleansingStringsEnum.SuggestionsListHiddenCellsWarningReason))))},ey=({selection:e,suggestions:t,selectedSuggestionId:n,containerStyle:o})=>{const r=R.useRef(null),[l,c]=R.useState(!1),[u,d]=R.useState(!1),p=R.useMemo(()=>t.slice(0,15),[t]),g=l?t:p;u||(i.a.sendTraceTag(507793429,a.a.msoulscat_ES_EWAJS,s.a.Important,`SuggestionsList: Showing ${g.length} out of ${t.length} suggestions`),d(!0));const h=R.useMemo(()=>function(e,t){const n=new Map;for(const t of e){var o;const e=t.tableName;n.has(e)||n.set(e,[]),null===(o=n.get(e))||void 0===o||o.push(t)}return n}(g),[g]);return R.createElement(yd.a,{selection:e},R.createElement(Cd.a,{onBlur:({target:t,currentTarget:n,relatedTarget:o})=>{!n.contains(o)&&(e.setAllSelected(!1),function(e,t){const n=e.querySelector("[data-selection-index='0']");n&&(n.tabIndex=0),n!==t&&(t.tabIndex=-1)}(n,t))},shouldFocusOnMount:!1,preventFocusRestoration:!0,isCircularNavigation:!1,componentRef:r,handleTabKey:qo.b.none,direction:qo.a.vertical,shouldEnterInnerZone:ty,shouldFocusInnerElementWhenReceivedFocus:!0,shouldResetActiveElementWhenTabFromZone:!0,onActiveElementChanged:t=>{var n;const o=parseInt(null!==(n=null==t?void 0:t.dataset.selectionIndex)&&void 0!==n?n:"",10);isNaN(o)||e.isIndexSelected(o)||null==e||e.setIndexSelected(o,!0,!0)}},R.createElement(At.a,{role:"list","data-testid":"suggestions-list",className:"suggestions-list",styles:{root:o}},R.createElement(XS,{suggestions:p}),Array.from(h.entries()).map(([t,o])=>R.createElement(ZS,{key:t,tableName:t,suggestions:o,selection:e,selectedSuggestionId:n})),!l&&t.length>g.length&&R.createElement(Ut.a,{styles:{root:{fontSize:F.k.size12,marginTop:"15px"}},onClick:()=>{c(!0),i.a.sendTraceTag(507793428,a.a.msoulscat_ES_EWAJS,s.a.Important,`SuggestionsList: Clicked 'ShowAll' button. showed: ${g.length} showing ${t.length} suggestions`)}},R.createElement(qE.a,{message:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.ShowAllSuggestions),values:{count:t.length}})),R.createElement($S,{origin:"Suggestions List"}))))};function ty(e){return e.keyCode===xe.a.right||e.keyCode===xe.a.enter}const ny=({sheetName:e,suggestionCount:t})=>{const n=Object(Yx.a)();if(!e)return null;const o={root:{fontSize:F.k.size14,fontWeight:F.l.semibold,color:n.palette.neutralDark,cursor:"default"}};return R.createElement(R.Fragment,null,R.createElement(rs.a,{styles:o},e),R.createElement("div",{style:{flexGrow:1}}),R.createElement(Ee.a,{content:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.SheetSuggestionsCount_Tooltip)},R.createElement(rs.a,{styles:o},R.createElement(qE.a,{message:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.SheetSuggestionsCount_Count),values:{count:t}}))))},oy=({worksheetState:e,suggestions:t})=>{var n,o;const r=Kx(),l=gE(),[c,u]=R.useState();R.useEffect(()=>{function e(){return(e=_async_to_generator((function*(){var e;null!=t&&t.length&&((yield null==r||null===(e=r.containsHiddenCells)||void 0===e?void 0:e.call(r,t.map(e=>null==e?void 0:e.suggestionRange)))&&i.a.sendTraceTag(520176270,a.a.msoulscat_ES_EWAJS,s.a.Info,"DataCleansingTaskPane: suggestions with hidden cells displayed"))}))).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[r,t]);const d=R.useMemo(()=>{const e=function(e,t){if(t){const{filterTables:n,filterSuggestionTypes:o}=t;if(o.length!==aE().length||n.length!==e.size)return e=>o.includes(e.type)&&n.includes(e.tableName)}return()=>!0}(new Set(t.map(e=>e.tableName)),l),n=t.filter(e);return i.a.sendTraceTag(508843220,a.a.msoulscat_ES_EWAJS,s.a.Info,`SuggestionsManager: Filter: ${n.length} out of ${t.length} suggestions left`),n},[t,l]),p=0===d.length&&d.length<t.length;R.useEffect(()=>{p&&i.a.sendTraceTag(540840334,a.a.msoulscat_ES_EWAJS,s.a.Info,"SuggestionsManager: No suggestions after filtering")},[p]);const g=function(e,t){const n=Vx(),[o]=R.useState(()=>{let t=null;const r={items:e,getKey:e=>e.id,selectionMode:_u.d.single,onSelectionChanged(){var e;null!==t&&(null==n||null===(e=n.onSuggestionDeselected)||void 0===e||e.call(n,t),t=null);const[r]=o.getSelection();var i;r&&(null==n||null===(i=n.onSuggestionSelected)||void 0===i||i.call(n,r.id),t=r.id),(e=>{var t;u(null!==(t=null==e?void 0:e.id)&&void 0!==t?t:void 0)})(r)}};return new ku.a(r)});return R.useEffect(()=>{o.setItems(e,!1)},[e,o]),o}(d);return R.createElement(R.Fragment,null,R.createElement(At.a,{verticalAlign:"center",horizontal:!0},R.createElement(mE,{key:e.sheetId,suggestions:t,isFiltered:d.length!==t.length,sheetId:null!==(n=e.sheetId)&&void 0!==n?n:void 0}),R.createElement(ny,{sheetName:null!==(o=e.sheetName)&&void 0!==o?o:"",suggestionCount:d.length})),R.createElement(vE,null),p?R.createElement(EE,null):R.createElement(Ft,{trackWidth:Ty/2,containerStyle:{width:`calc(100% + ${Ty}px)`}},R.createElement(ey,{suggestions:d,selectedSuggestionId:c,selection:g,containerStyle:{padding:`0 ${Ty}px 0 0`}})))},ry=({feedbackOrigin:e="DataCleansingTaskPane"})=>{const t=Kx();return null!=t&&t.openFeedback?R.createElement(pr.a,{styles:{root:{border:"none",width:"100%",padding:"1.5em 0",borderRadius:"3px",boxShadow:PE.a.depth8},label:{fontWeight:F.l.regular},rootHovered:{boxShadow:PE.a.depth16}},onClick:()=>{var n;null===(n=t.openFeedback)||void 0===n||n.call(t,e)},text:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.Feedback_Button)}):null},iy=()=>R.createElement(xE,{testId:"BlockedInSheetView",title:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.BlockedInSheetView_Title),subTitle:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.BlockedInSheetView_SubHeader)}),ay=()=>R.createElement(xE,{testId:"BlockedInProtectedSheet",title:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.BlockedInProtectedSheet_Title),subTitle:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.BlockedInProtectedSheet_SubHeader)}),sy=()=>{const e=CE();return R.useEffect(()=>{null!=e&&e.canRefresh&&i.a.sendTraceTag(509694288,a.a.msoulscat_ES_EWAJS,s.a.Warning,"EmptySuggestions but refresh annotations button wants to be rendered")},[e]),R.createElement(xE,{testId:"EmptyState",title:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.NoSuggestionTitle),subTitle:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.NoSuggestionSubTitle)},R.createElement($S,{origin:"Empty Suggestions"}))},ly=()=>R.createElement(xE,{testId:"BlockedInError",title:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.ErrorStateTitle),subTitle:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.ErrorStateSubheader)}),cy=()=>R.createElement(xE,{testId:"DataExceedsLimit",title:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.ErrorStateDataExceedsLimitTitle),subTitle:ExcelDataCleansingStringsManager.get(ExcelDataCleansingStringsEnum.ErrorStateDataExceedsLimitSubheader)}),uy=({messageId:e})=>{switch(R.useEffect(()=>{i.a.sendTraceTag(509690120,a.a.msoulscat_ES_EWAJS,s.a.Info,"Message type changed to "+e)},[e]),e){case Nx.BlockedInSheetView:return R.createElement(iy,null);case Nx.BlockedInProtectedSheet:return R.createElement(ay,null);case Nx.NoSuggestions:return R.createElement(sy,null);case Nx.DataExceedsLimit:return R.createElement(cy,null);case Nx.GeneralError:return R.createElement(ly,null);case Nx.None:return null;default:Object(PS.a)(e)}};class dy{get running(){return void 0!==this.timerId}constructor(e,t){this.onTimeout=e,this.timeout=t,this.start=()=>{this.stop(),this.timerId=setTimeout(this.end,this.timeout)},this.stop=()=>{this.running&&(clearTimeout(this.timerId),this.timerId=void 0)},this.end=()=>{this.running&&(this.stop(),this.onTimeout())}}}function py(){return Object(x.getBooleanFeatureGate)("Microsoft.Office.Excel.DataCleansingLoadingTimeout",!1)}const gy=({worksheetState:e,suggestions:t,messageType:n=Nx.None,viewState:o=Wx.LoadingSuggestions,isFeedbackAllowed:r})=>{const l=Kx(),c=Boolean(null==t?void 0:t.length);R.useEffect(()=>{c&&Object(Jm.a)().sendTelemetryEvent(sS)},[c,l]);const u=o===Wx.Disabled,d=o===Wx.LoadingSuggestions,p=o===Wx.DisplaySuggestions,g=r&&p,[h,m]=R.useState(!1);!function(e,t,n){const o=R.useRef(new dy(()=>{i.a.sendTraceTag(506796162,a.a.msoulscat_ES_EWAJS,s.a.Important,"useLoadingTimer: loading timeout reached after 60s"),n(!0),l(!1)},6e4)),[r,l]=R.useState(!1),[c,u]=R.useState(void 0),d=R.useCallback(e=>{if(!r)return;const t=new Date;if(o.current.stop(),l(!1),c){const n=t.getTime()-c.getTime();i.a.sendTraceTag(506796161,a.a.msoulscat_ES_EWAJS,s.a.Important,`useLoadingTimer: ${e} after ${n}ms`)}u(void 0)},[o,c,r]),p=R.useCallback(()=>{r||(o.current.start(),l(!0),u(new Date),i.a.sendTraceTag(506796160,a.a.msoulscat_ES_EWAJS,s.a.Important,"useLoadingTimer: loading started"))},[o,r]);R.useEffect(()=>{py()&&!e&&(t?p():d("loading stopped"))},[t,r,c,e,p,d]),Object(TE.a)(()=>{py()&&d("task pane closed")})}(h,d,m);const b=py()&&d&&h?Nx.GeneralError:c||u||n!==Nx.None?n:Nx.NoSuggestions,f=d&&(!py()||!h);return R.createElement(At.a,{verticalFill:!0,tokens:{childrenGap:6}},f?R.createElement(zx,null):R.createElement(R.Fragment,null,R.createElement(uy,{messageId:b}),p&&c&&t&&R.createElement(oy,{worksheetState:e,suggestions:t}),g&&R.createElement("div",{style:{flexGrow:1}}),g&&R.createElement(ry,null)))};var hy=n(2512);class my{showToast(e,t=5e3){const{key:n}=e;i.a.sendTraceTag(508638029,a.a.msoulscat_ES_EWAJS,s.a.Info,"ToastManager: showToast: "+n),this.removeToast(n,!0);const o=new dy(()=>{var t;i.a.sendTraceTag(508638028,a.a.msoulscat_ES_EWAJS,s.a.Verbose,`ToastManager: timer ended: ${n}, hiding toast`),null===(t=e.onDismiss)||void 0===t||t.call(e),this.hideToast(n,!1)},t);o.start(),this.timer=o,this.toast=e,"function"==typeof e.action&&(this.wrapperAction=()=>{var e,t,o;i.a.sendTraceTag(508638027,a.a.msoulscat_ES_EWAJS,s.a.Info,"ToastManager: actionClick: "+n),null===(e=this.timer)||void 0===e||e.stop(),null===(t=this.toast)||void 0===t||null===(o=t.action)||void 0===o||o.call(t),this.hideToast(n)}),this.render()}hideToast(e,t=!0){this.removeToast(e,t)&&(i.a.sendTraceTag(508638026,a.a.msoulscat_ES_EWAJS,s.a.Info,"ToastManager: hideToast: "+e),this.render())}getActionForToast(){return this.wrapperAction}onMouseEnter(e){var t;i.a.sendTraceTag(508638025,a.a.msoulscat_ES_EWAJS,s.a.Verbose,`ToastManager onMouseEnter: ${e}, stopping timer`),null===(t=this.timer)||void 0===t||t.stop()}onMouseLeave(e){var t;i.a.sendTraceTag(508638024,a.a.msoulscat_ES_EWAJS,s.a.Verbose,`ToastManager onMouseLeave: ${e}, starting timer`),null===(t=this.timer)||void 0===t||t.start()}removeToast(e,t=!1){var n,o;return(null===(n=this.toast)||void 0===n?void 0:n.key)===e&&(i.a.sendTraceTag(508638023,a.a.msoulscat_ES_EWAJS,s.a.Info,`ToastManager: removeToast: ${e}. endTimer: ${t}`),t&&(null===(o=this.timer)||void 0===o||o.end()),this.toast=void 0,this.wrapperAction=void 0,this.timer=void 0,!0)}render(){var e;null===(e=this.rerender)||void 0===e||e.call(this,this.toast?[this.toast]:[])}constructor(e){this.rerender=e,this.toast=void 0,this.timer=void 0,this.wrapperAction=void 0}}const by=({message:e,action:t,actionMessage:n,onMouseEnter:o,onMouseLeave:r})=>{const i=Object(Yx.a)();return R.createElement("div",{onMouseEnter:o,onMouseLeave:r},R.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 12px"}},R.createElement(rs.a,{variant:"medium",styles:{root:{fontWeight:F.l.semibold,color:i.palette.neutralLighter,whiteSpace:"pre-line"}}},e),Boolean(t&&n)&&R.createElement(pr.a,{style:{backgroundColor:"transparent",color:i.palette.neutralLighter,maxHeight:"24px",minWidth:"54px",padding:"initial"},text:n,onClick:()=>null==t?void 0:t()})))},fy=({targetRef:e,toasts:t})=>{const n=Object(Yx.a)(),o=mS();return o&&t.length?R.createElement(Qi.a,{calloutWidth:264,role:"dialog",directionalHint:Se.a.rightBottomEdge,coverTarget:!0,target:e,gapSpace:20,backgroundColor:n.palette.neutralPrimary,isBeakVisible:!1,style:{borderRadius:"4px"},styles:{root:{boxShadow:PE.a.depth8,marginBottom:10}}},R.createElement(At.a,{tokens:{childrenGap:8}},t.map(({key:e,message:t,actionMessage:n})=>R.createElement(by,{key:e,message:t,actionMessage:n,action:o.getActionForToast(),onMouseEnter:()=>o.onMouseEnter(e),onMouseLeave:()=>o.onMouseLeave(e)})))):null};var xy=new class{get ignoredSuggestionsIds(){return this.ignoredIds}syncIgnoredSuggestions(e){var t;e&&(this.ignoredIds&&!tS(new Set(e),this.ignoredIds).size||(this.ignoredIds=new Set([...Array.from(null!=e?e:[]),...Array.from(null!==(t=this.ignoredIds)&&void 0!==t?t:[])])))}isIgnored(e){var t,n;return null!==(t=null===(n=this.ignoredIds)||void 0===n?void 0:n.has(e.id))&&void 0!==t&&t}ignore(e,t){this.ignoredIds?(i.a.sendTraceTag(506996e3,a.a.msoulscat_ES_EWAJS,s.a.Important,`IgnoreManager.ignore(${e}, ${t.id})`),jS(t,!1),this.ignoredIds.add(t.id)):i.a.sendTraceTag(506996001,a.a.msoulscat_ES_EWAJS,s.a.Error,"IgnoreManager.ignore: this.ignoredIds is not initialized.")}logIgnoreDataForSuggestions(e,t){const n=t.filter(e=>this.isIgnored(e));i.a.sendTraceTag(506995999,a.a.msoulscat_ES_EWAJS,s.a.Important,`IgnoreManager.logIgnoreDataForSuggestions: numberOfIgnoredSuggestions: [${n.length}], worksheetId: [${e}].`)}},Ey=n(2561),Sy=n(910);function yy(e){return e.split(",").map(e=>e.trim())}function Cy(e){return{id:e.id,type:nE.ExtraSpacesTable,tableRange:e.tableRange,suggestionRange:e.tableRange,tableName:e.tableName,tableIdentifier:e.tableIdentifier,rangesByType:new Map([[0,e.rangesWithLeading],[1,e.rangesWithTrailing],[2,e.rangesWithInBetween]])}}function vy(e,t){return R.useMemo(()=>{let n=oS(e.map(e=>function(e){return xS.a.typeGuard(e)?function(e){const t={tableName:e.tableName,columnTitle:e.columnTitle,tableRange:e.tableRange,tableId:e.tableIdentifier},n=e.suggestions.map(e=>{try{return function(e,t){return function(e){return"TextInconsistency"===e.type}(e)?function(e,t){const n=yy(e.suggestedValue.type),o=e.variations.map(e=>yy(e.type)).join(";"),r=e.id;return i.a.sendTraceTag(509199957,a.a.msoulscat_ES_EWAJS,s.a.Important,`createTextInconsistencySuggestion: suggestionId: ${r} numVariations: ${e.variations.length+1} suggestedValueLinters: [${n}] otherVariationsLinters: [${o}]`),Object(Jm.a)().sendTelemetryEvent(((e,t,n,o)=>({eventName:"Office.Excel.Client.DataCleansing.TextInconsistencySuggestionCreation",eventFlags:aS,dataFields:[...rS,Object($m.d)("suggestionId",e),Object($m.c)("variationCount",t),Object($m.d)("suggestedValueLinters",n.join(";")),Object($m.d)("otherVariationsLinters",o)]}))(r,e.variations.length+1,n,o)),{id:r,type:nE.TextInconsistency,tableRange:t.tableRange,tableName:t.tableName,tableIdentifier:t.tableId,columnTitle:t.columnTitle,suggestedValue:e.suggestedValue.value,replacementValue:e.suggestedValue.value,variations:[{isSelected:!1,ranges:e.suggestedValue.ranges,value:e.suggestedValue.value,linters:n},...e.variations.map(e=>({isSelected:!0,ranges:e.ranges,value:e.value,linters:yy(e.type)}))],suggestionRange:e.suggestionRange}}(e,t):function(e){return"NumberFormattingInconsistency"===e.type}(e)?function(e,t){var n;const o=[e.suggestedFormat,...e.otherFormats],r={id:e.id,type:nE.NumberFormatInconsistency,tableRange:t.tableRange,tableName:t.tableName,tableIdentifier:t.tableId,columnTitle:t.columnTitle,suggestionRange:e.suggestionRange,replacementFormat:e.suggestedFormat.value,suggestedFormat:e.suggestedFormat.value,variationsType:$E(e.variationsType),formats:o.map(e=>({isApplicable:Boolean(e.isApplicable),value:e.value,key:e.value,format:e.value,ranges:e.ranges}))},l=null===(n=r.formats)||void 0===n?void 0:n.find(e=>null==e?void 0:e.isApplicable);return null!=l&&l.format&&(r.suggestedFormat=l.format,r.replacementFormat=l.format),FS(r)||i.a.sendTraceTag(506996038,a.a.msoulscat_ES_EWAJS,s.a.Error,"createNumberFormatInconsistencySuggestion: not applicable, suggestionId: "+e.id),r}(e,t):Object(x.getBooleanFeatureGate)("Microsoft.Office.Excel.AugLoop.TableLint_EnableDateFormat")&&function(e){return"DateFormat"===e.type}(e)?Object(x.getBooleanFeatureGate)("Microsoft.Office.Excel.DataCleansing_ShowDateFormatSuggestionCard")?function(e,t){return{id:e.id,type:nE.DateFormat,tableRange:t.tableRange,tableName:t.tableName,tableIdentifier:t.tableId,columnTitle:t.columnTitle,suggestionRange:e.suggestionRange,ranges:e.ranges}}(e,t):void 0:void i.a.sendTraceTag(506996040,a.a.msoulscat_ES_EWAJS,s.a.Error,"createSuggestion: unsupported suggestion type "+(null==e?void 0:e.type))}(e,t)}catch(e){return void i.a.sendTraceTag(506996041,a.a.msoulscat_ES_EWAJS,s.a.Error,"Exception thrown from createSuggestion: "+e)}});return Object(Sy.a)(n)}(e):Ey.a.typeGuard(e)?[Cy(e)]:[]}(e)));return Object(x.getBooleanFeatureGate)("Microsoft.Office.Excel.AugLoop.TableLint_EnableDateFormat")&&(n=function(e,t){const n=Object(x.getBooleanFeatureGate)("Microsoft.Office.Excel.AugLoop.TableLint_EnableDateFormatByLocale"),o=n&&t&&t.dataCultureTag&&t.uiCultureTag&&t.dataCultureTag===t.uiCultureTag;return t&&t.dataCultureTag&&(n?o:"en-US"===t.dataCultureTag)?e:e.filter(e=>e.type!==nE.DateFormat)}(n,t)),n.sort(SS),n},[e,t])}function Ry(e,t,n,o){const r=Object(hy.a)(),l=R.useRef(t),c=R.useRef(t);c.current=t;const u=R.useRef(e);let d=!0;if(c.current!==l.current){if(u.current!==e)d=!0,u.current=e;else{const e=e=>MS(e,e=>o.isIgnored(e),n);p=e(c.current),g=e(l.current),d=function(e,t,n){if(0===tS(t,n).size)return i.a.sendTraceTag(506996036,a.a.msoulscat_ES_EWAJS,s.a.Info,"canAutomaticallyRefresh: true, had no suggestions"),!0;const o=tS(e,t),r=tS(t,e);return o.size>0||r.size>0?!(0!==o.size||0!==tS(r,n).size||(i.a.sendTraceTag(506996034,a.a.msoulscat_ES_EWAJS,s.a.Info,"canAutomaticallyRefresh: true, apply is the only change"),0)):(i.a.sendTraceTag(506996035,a.a.msoulscat_ES_EWAJS,s.a.Info,"canAutomaticallyRefresh: true, no suggestions changed"),!0)}(new Set(p.map(e=>e.id)),new Set(g.map(e=>e.id)),new Set)}d?(i.a.sendTraceTag(506996032,a.a.msoulscat_ES_EWAJS,s.a.Info,"useRefreshSuggestions: quietly refreshed suggestions"),l.current=c.current):i.a.sendTraceTag(506996003,a.a.msoulscat_ES_EWAJS,s.a.Info,"useRefreshSuggestions: canRefreshQuietly is false")}var p,g;return{canRefresh:!d,suggestions:l.current,refresh(){i.a.sendTraceTag(506996002,a.a.msoulscat_ES_EWAJS,s.a.Info,"Refresh button clicked"),l.current=c.current,r()}}}var ky=n(2559);const Ty=16;const _y=e=>{var{hostState:t={},worksheetState:n={},containerRef:o}=e,r=_object_without_properties(e,["hostState","worksheetState","containerRef"]);const l=function(e){const t=R.useRef(new Set);if(Object(x.getBooleanFeatureGate)("Microsoft.Office.Excel.AddAppliedIdsToProps")){const r=new Set(e);(n=r,o=t.current,new Set([...Array.from(tS(n,o)),...Array.from(tS(o,n))])).size&&(t.current=r)}var n,o;return t}(r.appliedSuggestions),c=Kx(),u=R.useRef(),d=Object(hy.a)();var p,g;p=_async_to_generator((function*(){if(!Object(x.getBooleanFeatureGate)("Microsoft.Office.Excel.AddAppliedIdsToProps")){var e;const n=new Set(yield null===(e=c.getAppliedSuggestions)||void 0===e?void 0:e.call(c));if(n&&n.size>0){var t;for(const e of Array.from(n))l.current.add(e);d(),i.a.sendTraceTag(508872083,a.a.msoulscat_ES_EWAJS,s.a.Info,`DataCleansingTaskPane: loaded ${null!==(t=null==n?void 0:n.size)&&void 0!==t?t:0} applied ids from session storage`)}}})),(g=R.useRef(p)).current=p,R.useEffect((function(){var e;null===(e=g.current)||void 0===e||e.call(g)}),[]),xy.syncIgnoredSuggestions(r.ignoredSuggestions);const[h,m]=R.useState([]),b=Object(Gx.a)(()=>new my(m)),f=function(e,t,n,o){return t.errorState?Wx.Disabled:e||!o?Wx.LoadingSuggestions:n.isProtected||n.isInNamedSheetView?Wx.Disabled:Wx.DisplaySuggestions}(!r.annotations.find(ky.a.typeGuard),t,n,xy.ignoredSuggestionsIds),E=function(e,t){var n;return null!=e&&e.errorState?function(e){switch(e){case"EcsProxyClose_MaxNumberOfNonEmptyCellsExceeded":case"EcsProxyClose_MaxRangeRequestsInSeedExceeded":return Nx.DataExceedsLimit;default:return Nx.GeneralError}}(null!==(n=null==e?void 0:e.errorState)&&void 0!==n?n:void 0):null!=t&&t.isInNamedSheetView?Nx.BlockedInSheetView:null!=t&&t.isProtected?Nx.BlockedInProtectedSheet:Nx.None}(t,n),S=vy(r.annotations,t),y=Ry(n.sheetId,S,l.current,xy),{suggestions:C,getSuggestion:v,saveEditedSuggestion:k,setAppliedState:T,setAsIgnored:_}=function(e,t,n,o){const r=Object(hy.a)(),l=n.current,c=Object(Gx.a)(new Map),u=Kx(),d=R.useRef([]);!function(e,t,n){n.logIgnoreDataForSuggestions(e,t),i.a.sendTraceTag(509720396,a.a.msoulscat_ES_EWAJS,s.a.Important,"useAnnotationsSuggestions: "+JSON.stringify({sheetId:e,suggestionsInfo:uS(t),textInconsistencyLinters:pS(t),numberFormatTypes:gS(t)})),Object(Jm.a)().sendTelemetryEvent(((e,t)=>({eventName:"Office.Excel.Client.DataCleansing.TaskPaneSuggestionsInformation",eventFlags:aS,dataFields:[...rS,Object($m.d)("worksheetId",e),Object($m.d)("countByType",JSON.stringify(t))]}))(e,uS(t)))}(e,t,o);const p=MS(t,e=>o.isIgnored(e),l);return d.current=p.map(e=>{var t;return null!==(t=c.get(e.id))&&void 0!==t?t:e}),{suggestions:d.current,saveEditedSuggestion(e){c.set(e.id,e),r()},getSuggestion:e=>d.current.find(t=>t.id===e),setAppliedState(e,t){const n=`useVisibleSuggestions: setAppliedState(${e}, ${t})`;let o;var c,d;(e?t||l.has(e)?t&&l.has(e)&&(o="suggestion is already applied"):o="suggestion is not applied":o="suggestionId is undefined",o)?i.a.sendTraceTag(506995996,a.a.msoulscat_ES_EWAJS,s.a.Error,`${n}: ${o}`):(t?null===(c=u.addToAppliedSuggestions)||void 0===c||c.call(u,e):null===(d=u.removeFromAppliedSuggestions)||void 0===d||d.call(u,e),l[t?"add":"delete"](e),r(),i.a.sendTraceTag(506995995,a.a.msoulscat_ES_EWAJS,s.a.Info,""+n))},setAsIgnored(e,t){var n;const l=`useVisibleSuggestions: setAsIgnored(${e}, ${null==t?void 0:t.id})`;e&&t?(i.a.sendTraceTag(506995993,a.a.msoulscat_ES_EWAJS,s.a.Important,l),o.ignore(e,t),null==u||null===(n=u.addToIgnoredSuggestions)||void 0===n||n.call(u,t.id),r()):i.a.sendTraceTag(506995994,a.a.msoulscat_ES_EWAJS,s.a.Error,l+" worksheetId or suggestion is undefined")}}}(n.sheetId,y.suggestions,l,xy),w=R.useRef(),D=qx({canApplySuggestion:e=>FS(v(e)),onSuggestionIgnored(e){const t=null==n?void 0:n.sheetId,o=v(e);_(t,o)},onSuggestionApplied:(e,t)=>_async_to_generator((function*(){const n=v(e);if(!n){const e="onSuggestionApplied: called with no suggestion";throw i.a.sendTraceTag(509380127,a.a.msoulscat_ES_EWAJS,s.a.Error,e),new Error(e)}var o;jS(n,!0),n.suggestionRange&&(null===(o=c.containsHiddenCells)||void 0===o||null===(o=o.call(c,[n.suggestionRange]))||void 0===o||o.then(e=>{e&&i.a.sendTraceTag(509380126,a.a.msoulscat_ES_EWAJS,s.a.Info,"DataCleansingTaskPane: suggestion with hidden cells applied")}));try{const n=yield t();return u.current=e,T(e,!0),n}catch(e){throw i.a.sendTraceTag(509380125,a.a.msoulscat_ES_EWAJS,s.a.Error,"onSuggestionApplied: applySuggestion threw an error: "+e),e}}))(),onSuggestionSelected(e){var t;w.current=null!=e?e:void 0,null===(t=c.highlightRangesOnGrid)||void 0===t||t.call(c,BS(v(e)),!0,0)},onSuggestionDeselected(e){var t;w.current=void 0,null===(t=c.highlightRangesOnGrid)||void 0===t||t.call(c,[],!0,0)},onSuggestionPreview(e){var t;w.current=e,null===(t=c.highlightRangesOnGrid)||void 0===t||t.call(c,BS(v(e)),!1,0)},onCancelSuggestionPreview(e){var t;w.current=void 0,null===(t=c.highlightRangesOnGrid)||void 0===t||t.call(c,[],!1,0)},onSuggestionValuesChanged(e){var t;k(e),e.id===w.current&&(null===(t=c.highlightRangesOnGrid)||void 0===t||t.call(c,BS(e),!0,0))},undoLastAppliedSuggestion(){var e;i.a.sendTraceTag(508638022,a.a.msoulscat_ES_EWAJS,s.a.Important,`onAppliedUndo: confirmation callout for '${u.current}' triggered undo`),T(u.current,!1),null===(e=c.doUndo)||void 0===e||e.call(c)},reportSuggestionSucceeded(){Object(Jm.a)().sendTelemetryEvent(cS)}});return R.createElement(yE,{value:y},R.createElement(bS,{value:b},R.createElement(Ux,{value:D},R.createElement(gy,{worksheetState:n,suggestions:C,viewState:f,messageType:E,isFeedbackAllowed:null==t?void 0:t.isFeedbackAllowed})),R.createElement(fy,{targetRef:o,toasts:h})))};class wy extends R.Component{componentDidCatch(e,t){i.a.sendTraceTag(509380121,a.a.msoulscat_ES_EWAJS,s.a.Error,`DataCleansingTaskPane: componentDidCatch: ${null==e?void 0:e.message} ${t.componentStack}`)}render(){var e;const t=this.props,{hostAppCallbacks:n,annotations:o}=t,r=_object_without_properties(t,["hostAppCallbacks","annotations"]),i=null==r||null===(e=r.worksheetState)||void 0===e?void 0:e.sheetId;return R.createElement(Jx,{callbacks:n},R.createElement(uE,{value:null==r?void 0:r.worksheetState},R.createElement(hE,null,R.createElement("div",{ref:this.containerRef,style:{height:"100%",padding:`0 ${Ty}px 1em`,boxSizing:"border-box"}},R.createElement(_y,_object_spread({containerRef:this.containerRef,annotations:i?o.filter(e=>e.worksheetId===i):o},r))))))}constructor(){super(...arguments),this.containerRef=R.createRef(),this.selectorsToFocus=[".suggestion-card[data-selected-card]",".suggestions-list","*"],this.focus=()=>{const e=this.containerRef.current;if(e&&!e.contains(document.activeElement)){for(const t of this.selectorsToFocus){const n=e.querySelector(t);if(!n)continue;const o=Object(Il.f)(e,n,!0);if(o&&Object(Il.c)(o))break}var t;i.a.sendTraceTag(509380122,a.a.msoulscat_ES_EWAJS,s.a.Spam,"DataCleansingTaskPane: focused on "+((t=document.activeElement)?t.id||t.className||t.tagName:"nothing"))}}}}let Dy;const Py={AccCheckerTaskPane:Yf(_x),ConditionalFormattingTaskPane:Yf(Js),DataCleansingTaskPane:Yf(wy),ExternalLinksTaskPane:Yf(Ul),FormatCellsTaskPane:Yf(id),LoadBlockingFloatingObjectsTaskPane:Yf(dd),NameManagerTaskPane:Yf(gp),SpellCheckTaskPane:Yf($p),SharedCommentsTaskPane:Yf(Ix),WorkbookOptimizationTaskPane:Yf((Dy||(Dy=R.lazy(()=>Promise.all([n.e(0),n.e(17)]).then(n.bind(null,3084)))),Dy))},Iy={AccCheckerTaskPane:R.memo(Py.AccCheckerTaskPane),ConditionalFormattingTaskPane:R.memo(Py.ConditionalFormattingTaskPane),DataCleansingTaskPane:R.memo(Py.DataCleansingTaskPane),EmbeddedTaskPane:R.memo(Ox),ExcelLegacyTaskPaneWacInfra:Ax,ExternalLinksTaskPane:R.memo(Py.ExternalLinksTaskPane),FieldListTaskPane:R.memo(e=>R.createElement(Ng,_object_spread({},e))),FormatCellsTaskPane:Object(Dc.a)(R.memo(Py.FormatCellsTaskPane)),LoadBlockingFloatingObjectsTaskPane:R.memo(Py.LoadBlockingFloatingObjectsTaskPane),NameManagerTaskPane:R.memo(Py.NameManagerTaskPane),PivotTableSettingsTaskPane:R.memo(Qh),PowerQueryTaskPane:R.memo(xf),SlicerSettingsTaskPane:R.memo(Tf),SpellCheckTaskPane:R.memo(Py.SpellCheckTaskPane),SharedCommentsTaskPane:R.memo(Py.SharedCommentsTaskPane),WorkbookOptimizationTaskPane:R.memo(Py.WorkbookOptimizationTaskPane)};function Fy(e,t){switch(e.type){case"AccCheckerTaskPaneProps":return be.a.AccessibilityChecker_20;case"ConditionalFormattingTaskPaneProps":return g.a.ConditionalFormatting_20;case"ExcelLegacyTaskPaneWacInfraProps":return function(e,t){switch(t){case"FieldManagerTaskPane":case"1":return be.a.SxShowFieldDman_20;case"ParametersTaskPane":case"2":return be.a.NOV_ParameterTaskPane_20;case"CommentTaskPane":case"7":return be.a.CommentsPane_20;case"AccessibilityCheckerTaskPane":case"8":return be.a.AccessibilityChecker_20;case"EnrichmentTaskPane":case"10":return be.a.LinkedRecordsHelp_24;case"LineageTaskPane":case"15":return be.a.ShowChangesExcel_20;case"FA000000066":return be.a.Refresh_20;case"AnalyzeDataTaskPane":return g.a.IdeaNew_20;case"RecommendedChartsTaskPane":return d.a.RecommendedCharts_20;case"PivotTableTaskPane":return d.a.PivotTable_20;case"CopilotSDXTaskpane":return c.a.M365Excel_20;case"HelpTaskPane":return be.a.AboutButton_20;case"ContactSupportTaskPane":return be.a.AccountSupport_20;default:return}}(0,t);case"ExternalLinksTaskPaneProps":return be.a.Links_20;case"FieldListTaskPaneProps":return be.a.SxShowFieldDman_20;case"PivotTableSettingsTaskPaneProps":return be.a.Properties_20;case"PowerQueryTaskPaneProps":return be.a.ShowQueryPane_20;case"SlicerSettingsTaskPaneProps":return be.a.Properties_20;case"SpellCheckTaskPaneProps":return be.a.Spelling_20;case"NameManagerTaskPaneProps":return d.a.NameManager_20;case"SharedCommentsTaskPaneProps":return be.a.CommentsPane_20;case"DataCleansingTaskPaneProps":case"DataCleansingStatefulTaskPaneProps":return be.a.DataCleaning_20;case"FormatCellsTaskPaneProps":return hr.a.PaintBrushandBucket_20;case"OcvFeedbackTaskPaneProps":return be.a.Feedback_20;case"LoadBlockingFloatingObjectsTaskPaneProps":return be.a.EditQuickCommand_Glyph_20;default:return}}var By=n(2421),My=n(25),jy=n(2570),Oy=n(563);const Ly=e=>({backgroundColor:Object(ix.c)()?e.palette.white:Yo.a.white}),Ay=Object(Jo.c)((e,t,n)=>{const o=Object(rx.f)(e,n),r=((e,t)=>({backgroundColor:e,borderColor:Object(ix.c)()?t.palette.neutralPrimary:Yo.a.gray160}))(o.background,e);return{root:[{width:40,height:40,backgroundColor:o.background,marginBottom:1,selectors:{[ci.b]:[r,{selectors:{":hover":Ly(e)}}],[ci.a]:{outline:"none",border:"none"}}},t&&[ci.t,ci.n]],rootPressed:{backgroundColor:o.background},rootHovered:Ly(e),rootFocused:[r,{selectors:{":hover":Ly(e)}}]}}),Ny=Object(Jo.c)((e,t,n)=>Object(Oy.a)(e,Object(pl.a)(e,Ay(e,t,n)))),Wy=Object(Jo.c)((e,t,n,o,r)=>{const i=Object(ci.y)(o),a=Object(rx.f)(e,r);return{resizeGroupRoot:[{position:"relative",backgroundColor:a.background,height:"100%"},t>1&&n&&{borderLeft:"1px solid "+Yo.a.gray50}],buttonContainer:[{position:"relative",height:"100%",width:t>1?40:0,transition:`width ${i}ms ease`,display:"inline-block",backgroundColor:a.background},ci.v]}}),zy=Object(Jo.c)(e=>Object(F.I)({root:{left:"auto",position:"absolute"}},e)),Hy=Object(Jo.c)(e=>({resizeGroupRoot:Object(F.eb)(e.resizeGroupRoot),buttonContainer:Object(F.eb)(e.buttonContainer)})),Vy=Object(Jo.c)(()=>Object(Jo.c)((e,t)=>Object(kd.b)()(e,t,!1))),Uy=Object(Jo.c)((e,t)=>({wrapper:{width:40},pivotHeader:Ny(e,!1,t),selectedPivotHeader:Ny(e,!0,t)})),Gy=Object(Jo.c)(e=>({overflowButton:Ny(e,!1)})),qy=Object(Jo.c)((e,t)=>zy(Object(F.I)(t,{root:{transition:e+" 400ms cubic-bezier(0.17, 0.17, 0.00, 1.00)"}}))),Qy={taskPaneModels:{},leftTaskPanes:[],rightTaskPanes:[]},Ky=(e=Qy,t)=>{if(null===e)return Qy;switch(t.type){case My.z:const n=_object_spread({},e.taskPaneModels);return t.payload.taskPanes.forEach(t=>{const o=n[t.id];t.isPersistedTaskPane&&(!o&&t.hidePersistedPaneInitially?t.hidden=!0:o&&o.hidden&&(t.hidden=!1));const r=e.taskPaneModels[t.id];t.resizeWidth||(t.resizeWidth=r&&r.resizeWidth?r.resizeWidth:t.width),t.activeControls||(t.activeControls=null==r?void 0:r.activeControls),n[t.id]=t}),_object_spread_props(_object_spread({},e),{taskPaneModels:n});case My.Pc:return _object_spread_props(_object_spread({},e),{taskPaneModels:Jy(e.taskPaneModels,t,e.taskPaneModels[t.payload.taskPaneId])});case My.Ub:return _object_spread_props(_object_spread({},e),{taskPaneModels:Yy(e.taskPaneModels,t,e.taskPaneModels[t.payload.taskPaneId])});case My.Qc:return _object_spread_props(_object_spread({},e),{taskPaneModels:Zy(e.taskPaneModels,t,e.taskPaneModels[t.payload.taskPaneId])});case My.Rb:return _object_spread_props(_object_spread({},e),{taskPaneModels:_object_spread_props(_object_spread({},e.taskPaneModels),{[t.payload.taskPaneId]:_object_spread_props(_object_spread({},e.taskPaneModels[t.payload.taskPaneId]),{hideHeader:t.payload.hideHeader})})});case My.A:return $y(e,t.payload.taskPaneIds,t.payload.location);case My.V:return Xy(e,t.payload.taskPaneIds,t.payload.location);case My.Lb:return rC(e,t.payload.taskPaneId,t.payload.location);case My.Z:let o=e.selectedTaskPaneIdRight,r=e.rightTaskPanes,i=e.selectedTaskPaneIdLeft,a=e.leftTaskPanes;t.payload.location===D.a.Left&&(o=e.selectedTaskPaneIdLeft,r=e.leftTaskPanes,i=e.selectedTaskPaneIdRight,a=e.rightTaskPanes);const s=e.taskPaneModels,l=eC(r,s).length>1,c=eC(a,s).length>1;return iC(s,l,c,t.payload.middleContainer,o,t.payload.selectedPaneId,i),e;case My.ab:const u=eC(t.payload.location===D.a.Left?e.leftTaskPanes:e.rightTaskPanes,e.taskPaneModels),d=u.length>0?u[0]:void 0;return rC(e,d,t.payload.location);case My.Xb:{const n=t;return _object_spread_props(_object_spread({},e),{taskPaneModels:oC(e.taskPaneModels,n,e.taskPaneModels[n.payload.taskPaneId])})}case My.Sb:return _object_spread_props(_object_spread({},e),{taskPaneModels:_object_spread_props(_object_spread({},e.taskPaneModels),{[t.payload.taskPaneId]:_object_spread_props(_object_spread({},e.taskPaneModels[t.payload.taskPaneId]),{resizeMode:t.payload.resize})})});default:return e}},Jy=(e,t,n)=>{if(n){const o=_object_spread_props(_object_spread({},n),{renderContent:t.payload.renderContent});return _object_spread_props(_object_spread({},e),{[t.payload.taskPaneId]:o})}return e},Yy=(e,t,n)=>{if(n){const o=_object_spread_props(_object_spread({},n),{showSharingContent:!n.showSharingContent});if(n.renderContent){const e=n.renderContent(),t=R.cloneElement(e,_object_spread_props(_object_spread({},e.props),{showSharingContent:!n.showSharingContent}));o.renderContent=()=>t}return _object_spread_props(_object_spread({},e),{[t.payload.taskPaneId]:o})}return e},Zy=(e,t,n)=>{if(n){const o=_object_spread_props(_object_spread({},n),{resizeWidth:t.payload.resizeWidth});return i.a.sendTraceTag(595077188,a.a.msoulscat_Wac_TaskPane,s.a.Info,"TaskPane has been resized"),_object_spread_props(_object_spread({},e),{[t.payload.taskPaneId]:o})}return e},$y=(e,t,n)=>{const o=[...tC(e,n)];for(const e of t)-1===o.indexOf(e)&&o.push(e);return nC(e,n,o)},Xy=(e,t,n)=>{const o=[...tC(e,n)],r=_object_spread({},e.taskPaneModels);let i=n===D.a.Left?e.selectedTaskPaneIdLeft:e.selectedTaskPaneIdRight,a=i?eC(o,r).indexOf(i):-1;for(const e of t){const t=o.indexOf(e),n=r[e];n&&n.isPersistedTaskPane?r[e]=_object_spread_props(_object_spread({},n),{hidden:!0}):t>=0&&o.splice(t,1)}if(i&&t.indexOf(i)>=0){const e=eC(o,r);if(i=void 0,e.length>0){a>=e.length&&(a=e.length-1);for(let t=a;t<e.length;t+=1){const n=e[t],o=r[n];if(o&&!o.hidden){i=n;break}}}}return n===D.a.Left?_object_spread_props(_object_spread({},e),{leftTaskPanes:o,selectedTaskPaneIdLeft:i,taskPaneModels:r}):_object_spread_props(_object_spread({},e),{rightTaskPanes:o,selectedTaskPaneIdRight:i,taskPaneModels:r})},eC=(e,t)=>e.filter(e=>{const n=t[e];return n&&!n.hidden}),tC=(e,t)=>t===D.a.Left?e.leftTaskPanes:e.rightTaskPanes,nC=(e,t,n)=>t===D.a.Left?_object_spread_props(_object_spread({},e),{leftTaskPanes:n}):_object_spread_props(_object_spread({},e),{rightTaskPanes:n}),oC=(e,t,n)=>{if(n){const o=_object_spread_props(_object_spread({},n),{activeControls:t.payload.controlIdsList});return _object_spread_props(_object_spread({},e),{[t.payload.taskPaneId]:o})}return e},rC=(e,t,n)=>n===D.a.Left?_object_spread_props(_object_spread({},e),{selectedTaskPaneIdLeft:t}):_object_spread_props(_object_spread({},e),{selectedTaskPaneIdRight:t}),iC=(e,t,n,o,r,i,a)=>{const s=aC(e,t,i||r)+"px",l=aC(e,n,a)+"px";Object(ue.a)()?(o.style.left=s,o.style.right=l):(o.style.right=s,o.style.left=l)},aC=(e,t,n)=>{const o=n?e[n]:void 0;return(o?o.enableResize&&o.resizeWidth?o.resizeWidth:o.width:0)+sC(t,o)},sC=(e,t)=>t?e?42:1:e?41:0;var lC,cC=n(215),uC=n(2617),dC=n(2584),pC=n(157),gC=n(1245),hC=n(188),mC=(lC=function(e,t){return(lC=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}lC(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),bC=function(){return(bC=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},fC={top:{width:"100%",height:"10px",top:"-5px",left:"0px",cursor:"row-resize"},right:{width:"10px",height:"100%",top:"0px",right:"-5px",cursor:"col-resize"},bottom:{width:"100%",height:"10px",bottom:"-5px",left:"0px",cursor:"row-resize"},left:{width:"10px",height:"100%",top:"0px",left:"-5px",cursor:"col-resize"},topRight:{width:"20px",height:"20px",position:"absolute",right:"-10px",top:"-10px",cursor:"ne-resize"},bottomRight:{width:"20px",height:"20px",position:"absolute",right:"-10px",bottom:"-10px",cursor:"se-resize"},bottomLeft:{width:"20px",height:"20px",position:"absolute",left:"-10px",bottom:"-10px",cursor:"sw-resize"},topLeft:{width:"20px",height:"20px",position:"absolute",left:"-10px",top:"-10px",cursor:"nw-resize"}},xC=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onMouseDown=function(e){t.props.onResizeStart(e,t.props.direction)},t.onTouchStart=function(e){t.props.onResizeStart(e,t.props.direction)},t}return mC(t,e),t.prototype.render=function(){return R.createElement("div",{className:this.props.className||"",style:bC(bC({position:"absolute",userSelect:"none"},fC[this.props.direction]),this.props.replaceStyles||{}),onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart},this.props.children)},t}(R.PureComponent),EC=n(2802),SC=n.n(EC),yC=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),CC=function(){return(CC=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},vC={width:"auto",height:"auto"},RC=SC()((function(e,t,n){return Math.max(Math.min(e,n),t)})),kC=SC()((function(e,t){return Math.round(e/t)*t})),TC=SC()((function(e,t){return new RegExp(e,"i").test(t)})),_C=function(e){return Boolean(e.touches&&e.touches.length)},wC=SC()((function(e,t,n){void 0===n&&(n=0);var o=t.reduce((function(n,o,r){return Math.abs(o-e)<Math.abs(t[n]-e)?r:n}),0),r=Math.abs(t[o]-e);return 0===n||r<n?t[o]:e})),DC=SC()((function(e,t){return e.substr(e.length-t.length,t.length)===t})),PC=SC()((function(e){return"auto"===(e=e.toString())||DC(e,"px")||DC(e,"%")||DC(e,"vh")||DC(e,"vw")||DC(e,"vmax")||DC(e,"vmin")?e:e+"px"})),IC=function(e,t,n,o){if(e&&"string"==typeof e){if(DC(e,"%"))return t*(Number(e.replace("%",""))/100);if(DC(e,"vw"))return n*(Number(e.replace("vw",""))/100);if(DC(e,"vh"))return o*(Number(e.replace("vh",""))/100)}return e},FC=SC()((function(e,t,n,o,r,i,a){return o=IC(o,e.width,t,n),r=IC(r,e.height,t,n),i=IC(i,e.width,t,n),a=IC(a,e.height,t,n),{maxWidth:void 0===o?void 0:Number(o),maxHeight:void 0===r?void 0:Number(r),minWidth:void 0===i?void 0:Number(i),minHeight:void 0===a?void 0:Number(a)}})),BC=["as","style","className","grid","snap","bounds","size","defaultSize","minWidth","minHeight","maxWidth","maxHeight","lockAspectRatio","lockAspectRatioExtraWidth","lockAspectRatioExtraHeight","enable","handleStyles","handleClasses","handleWrapperStyle","handleWrapperClass","children","onResizeStart","onResize","onResizeStop","handleComponent","scale","resizeRatio","snapGap"],MC=function(e){function t(t){var n=e.call(this,t)||this;return n.ratio=1,n.resizable=null,n.parentLeft=0,n.parentTop=0,n.resizableLeft=0,n.resizableTop=0,n.targetLeft=0,n.targetTop=0,n.ref=function(e){e&&(n.resizable=e)},n.state={isResizing:!1,width:void 0===(n.propsSize&&n.propsSize.width)?"auto":n.propsSize&&n.propsSize.width,height:void 0===(n.propsSize&&n.propsSize.height)?"auto":n.propsSize&&n.propsSize.height,direction:"right",original:{x:0,y:0,width:0,height:0},backgroundStyle:{height:"100%",width:"100%",backgroundColor:"rgba(0,0,0,0)",cursor:"auto",opacity:0,position:"fixed",zIndex:9999,top:"0",left:"0",bottom:"0",right:"0"},flexBasis:void 0},n.onResizeStart=n.onResizeStart.bind(n),n.onMouseMove=n.onMouseMove.bind(n),n.onMouseUp=n.onMouseUp.bind(n),n}return yC(t,e),Object.defineProperty(t.prototype,"parentNode",{get:function(){return this.resizable?this.resizable.parentNode:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"window",{get:function(){return this.resizable&&this.resizable.ownerDocument?this.resizable.ownerDocument.defaultView:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"propsSize",{get:function(){return this.props.size||this.props.defaultSize||vC},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"base",{get:function(){var e=this.parentNode;if(e)for(var t=0,n=[].slice.call(e.children);t<n.length;t++){var o=n[t];if(o.classList.contains("__resizable_base__"))return o}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){var e=0,t=0;if(this.resizable&&this.window){var n=this.resizable.offsetWidth,o=this.resizable.offsetHeight,r=this.resizable.style.position;"relative"!==r&&(this.resizable.style.position="relative"),e="auto"!==this.resizable.style.width?this.resizable.offsetWidth:n,t="auto"!==this.resizable.style.height?this.resizable.offsetHeight:o,this.resizable.style.position=r}return{width:e,height:t}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sizeStyle",{get:function(){var e=this,t=this.props.size,n=function(t){if(void 0===e.state[t]||"auto"===e.state[t])return"auto";if(e.propsSize&&e.propsSize[t]&&DC(e.propsSize[t].toString(),"%")){if(DC(e.state[t].toString(),"%"))return e.state[t].toString();var n=e.getParentSize();return Number(e.state[t].toString().replace("px",""))/n[t]*100+"%"}return PC(e.state[t])};return{width:t&&void 0!==t.width&&!this.state.isResizing?PC(t.width):n("width"),height:t&&void 0!==t.height&&!this.state.isResizing?PC(t.height):n("height")}},enumerable:!1,configurable:!0}),t.prototype.getParentSize=function(){if(!this.base||!this.parentNode)return this.window?{width:this.window.innerWidth,height:this.window.innerHeight}:{width:0,height:0};var e=!1,t=this.parentNode.style.flexWrap,n=this.base.style.minWidth;"wrap"!==t&&(e=!0,this.parentNode.style.flexWrap="wrap"),this.base.style.position="relative",this.base.style.minWidth="100%";var o={width:this.base.offsetWidth,height:this.base.offsetHeight};return this.base.style.position="absolute",e&&(this.parentNode.style.flexWrap=t),this.base.style.minWidth=n,o},t.prototype.bindEvents=function(){this.window&&(this.window.addEventListener("mouseup",this.onMouseUp),this.window.addEventListener("mousemove",this.onMouseMove),this.window.addEventListener("mouseleave",this.onMouseUp),this.window.addEventListener("touchmove",this.onMouseMove,{capture:!0,passive:!1}),this.window.addEventListener("touchend",this.onMouseUp))},t.prototype.unbindEvents=function(){this.window&&(this.window.removeEventListener("mouseup",this.onMouseUp),this.window.removeEventListener("mousemove",this.onMouseMove),this.window.removeEventListener("mouseleave",this.onMouseUp),this.window.removeEventListener("touchmove",this.onMouseMove,!0),this.window.removeEventListener("touchend",this.onMouseUp))},t.prototype.componentDidMount=function(){if(this.resizable&&this.window){var e=this.window.getComputedStyle(this.resizable);this.setState({width:this.state.width||this.size.width,height:this.state.height||this.size.height,flexBasis:"auto"!==e.flexBasis?e.flexBasis:void 0});var t=this.parentNode;if(t&&!this.base){var n=this.window.document.createElement("div");n.style.width="100%",n.style.height="100%",n.style.position="absolute",n.style.transform="scale(0, 0)",n.style.left="0",n.style.flex="0",n.classList?n.classList.add("__resizable_base__"):n.className+="__resizable_base__",t.appendChild(n)}}},t.prototype.componentWillUnmount=function(){if(this.window){this.unbindEvents();var e=this.parentNode;if(!this.base||!e)return;if(!e||!this.base)return;e.removeChild(this.base)}},t.prototype.createSizeForCssProperty=function(e,t){var n=this.propsSize&&this.propsSize[t];return"auto"!==this.state[t]||this.state.original[t]!==e||void 0!==n&&"auto"!==n?e:"auto"},t.prototype.calculateNewMaxFromBoundary=function(e,t){if("parent"===this.props.bounds){var n=this.parentNode;if(n){var o=n.offsetWidth+(this.parentLeft-this.resizableLeft),r=n.offsetHeight+(this.parentTop-this.resizableTop);e=e&&e<o?e:o,t=t&&t<r?t:r}}else"window"===this.props.bounds?this.window&&(o=this.window.innerWidth-this.resizableLeft,r=this.window.innerHeight-this.resizableTop,e=e&&e<o?e:o,t=t&&t<r?t:r):this.props.bounds&&(o=this.props.bounds.offsetWidth+(this.targetLeft-this.resizableLeft),r=this.props.bounds.offsetHeight+(this.targetTop-this.resizableTop),e=e&&e<o?e:o,t=t&&t<r?t:r);return{maxWidth:e,maxHeight:t}},t.prototype.calculateNewSizeFromDirection=function(e,t){var n=this.props.scale||1,o=this.props.resizeRatio||1,r=this.state,i=r.direction,a=r.original,s=this.props,l=s.lockAspectRatio,c=s.lockAspectRatioExtraHeight,u=s.lockAspectRatioExtraWidth,d=a.width,p=a.height,g=c||0,h=u||0;return TC("right",i)&&(d=a.width+(e-a.x)*o/n,l&&(p=(d-h)/this.ratio+g)),TC("left",i)&&(d=a.width-(e-a.x)*o/n,l&&(p=(d-h)/this.ratio+g)),TC("bottom",i)&&(p=a.height+(t-a.y)*o/n,l&&(d=(p-g)*this.ratio+h)),TC("top",i)&&(p=a.height-(t-a.y)*o/n,l&&(d=(p-g)*this.ratio+h)),{newWidth:d,newHeight:p}},t.prototype.calculateNewSizeFromAspectRatio=function(e,t,n,o){var r=this.props,i=r.lockAspectRatio,a=r.lockAspectRatioExtraHeight,s=r.lockAspectRatioExtraWidth,l=void 0===o.width?10:o.width,c=void 0===n.width||n.width<0?e:n.width,u=void 0===o.height?10:o.height,d=void 0===n.height||n.height<0?t:n.height,p=a||0,g=s||0;if(i){var h=(u-p)*this.ratio+g,m=(d-p)*this.ratio+g,b=(l-g)/this.ratio+p,f=(c-g)/this.ratio+p,x=Math.max(l,h),E=Math.min(c,m),S=Math.max(u,b),y=Math.min(d,f);e=RC(e,x,E),t=RC(t,S,y)}else e=RC(e,l,c),t=RC(t,u,d);return{newWidth:e,newHeight:t}},t.prototype.setBoundingClientRect=function(){if("parent"===this.props.bounds){var e=this.parentNode;if(e){var t=e.getBoundingClientRect();this.parentLeft=t.left,this.parentTop=t.top}}if(this.props.bounds&&"string"!=typeof this.props.bounds){var n=this.props.bounds.getBoundingClientRect();this.targetLeft=n.left,this.targetTop=n.top}if(this.resizable){var o=this.resizable.getBoundingClientRect(),r=o.left,i=o.top;this.resizableLeft=r,this.resizableTop=i}},t.prototype.onResizeStart=function(e,t){if(this.resizable&&this.window){var n,o=0,r=0;if(e.nativeEvent&&function(e){return Boolean((e.clientX||0===e.clientX)&&(e.clientY||0===e.clientY))}(e.nativeEvent)){if(o=e.nativeEvent.clientX,r=e.nativeEvent.clientY,3===e.nativeEvent.which)return}else e.nativeEvent&&_C(e.nativeEvent)&&(o=e.nativeEvent.touches[0].clientX,r=e.nativeEvent.touches[0].clientY);if(this.props.onResizeStart&&this.resizable&&!1===this.props.onResizeStart(e,t,this.resizable))return;this.props.size&&(void 0!==this.props.size.height&&this.props.size.height!==this.state.height&&this.setState({height:this.props.size.height}),void 0!==this.props.size.width&&this.props.size.width!==this.state.width&&this.setState({width:this.props.size.width})),this.ratio="number"==typeof this.props.lockAspectRatio?this.props.lockAspectRatio:this.size.width/this.size.height;var i=this.window.getComputedStyle(this.resizable);if("auto"!==i.flexBasis){var a=this.parentNode;if(a){var s=this.window.getComputedStyle(a).flexDirection;this.flexDir=s.startsWith("row")?"row":"column",n=i.flexBasis}}this.setBoundingClientRect(),this.bindEvents();var l={original:{x:o,y:r,width:this.size.width,height:this.size.height},isResizing:!0,backgroundStyle:CC(CC({},this.state.backgroundStyle),{cursor:this.window.getComputedStyle(e.target).cursor||"auto"}),direction:t,flexBasis:n};this.setState(l)}},t.prototype.onMouseMove=function(e){if(this.state.isResizing&&this.resizable&&this.window){if(this.window.TouchEvent&&_C(e))try{e.preventDefault(),e.stopPropagation()}catch(e){}var t=this.props,n=t.maxWidth,o=t.maxHeight,r=t.minWidth,i=t.minHeight,a=_C(e)?e.touches[0].clientX:e.clientX,s=_C(e)?e.touches[0].clientY:e.clientY,l=this.state,c=l.direction,u=l.original,d=l.width,p=l.height,g=this.getParentSize(),h=FC(g,this.window.innerWidth,this.window.innerHeight,n,o,r,i);n=h.maxWidth,o=h.maxHeight,r=h.minWidth,i=h.minHeight;var m=this.calculateNewSizeFromDirection(a,s),b=m.newHeight,f=m.newWidth,x=this.calculateNewMaxFromBoundary(n,o),E=this.calculateNewSizeFromAspectRatio(f,b,{width:x.maxWidth,height:x.maxHeight},{width:r,height:i});if(f=E.newWidth,b=E.newHeight,this.props.grid){var S=kC(f,this.props.grid[0]),y=kC(b,this.props.grid[1]),C=this.props.snapGap||0;f=0===C||Math.abs(S-f)<=C?S:f,b=0===C||Math.abs(y-b)<=C?y:b}this.props.snap&&this.props.snap.x&&(f=wC(f,this.props.snap.x,this.props.snapGap)),this.props.snap&&this.props.snap.y&&(b=wC(b,this.props.snap.y,this.props.snapGap));var v={width:f-u.width,height:b-u.height};d&&"string"==typeof d&&(DC(d,"%")?f=f/g.width*100+"%":DC(d,"vw")?f=f/this.window.innerWidth*100+"vw":DC(d,"vh")&&(f=f/this.window.innerHeight*100+"vh")),p&&"string"==typeof p&&(DC(p,"%")?b=b/g.height*100+"%":DC(p,"vw")?b=b/this.window.innerWidth*100+"vw":DC(p,"vh")&&(b=b/this.window.innerHeight*100+"vh"));var R={width:this.createSizeForCssProperty(f,"width"),height:this.createSizeForCssProperty(b,"height")};"row"===this.flexDir?R.flexBasis=R.width:"column"===this.flexDir&&(R.flexBasis=R.height),this.setState(R),this.props.onResize&&this.props.onResize(e,c,this.resizable,v)}},t.prototype.onMouseUp=function(e){var t=this.state,n=t.isResizing,o=t.direction,r=t.original;if(n&&this.resizable){var i={width:this.size.width-r.width,height:this.size.height-r.height};this.props.onResizeStop&&this.props.onResizeStop(e,o,this.resizable,i),this.props.size&&this.setState(this.props.size),this.unbindEvents(),this.setState({isResizing:!1,backgroundStyle:CC(CC({},this.state.backgroundStyle),{cursor:"auto"})})}},t.prototype.updateSize=function(e){this.setState({width:e.width,height:e.height})},t.prototype.renderResizer=function(){var e=this,t=this.props,n=t.enable,o=t.handleStyles,r=t.handleClasses,i=t.handleWrapperStyle,a=t.handleWrapperClass,s=t.handleComponent;if(!n)return null;var l=Object.keys(n).map((function(t){return!1!==n[t]?R.createElement(xC,{key:t,direction:t,onResizeStart:e.onResizeStart,replaceStyles:o&&o[t],className:r&&r[t]},s&&s[t]?s[t]:null):null}));return R.createElement("span",{className:a,style:i},l)},t.prototype.render=function(){var e=this,t=Object.keys(this.props).reduce((function(t,n){return-1!==BC.indexOf(n)||(t[n]=e.props[n]),t}),{}),n=CC(CC(CC({position:"relative",userSelect:this.state.isResizing?"none":"auto"},this.props.style),this.sizeStyle),{maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight,minWidth:this.props.minWidth,minHeight:this.props.minHeight,boxSizing:"border-box",flexShrink:0});this.state.flexBasis&&(n.flexBasis=this.state.flexBasis);var o=this.props.as||"div";return R.createElement(o,CC({ref:this.ref,style:n,className:this.props.className},t),this.state.isResizing&&R.createElement("div",{style:this.state.backgroundStyle}),this.props.children,this.renderResizer())},t.defaultProps={as:"div",onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},enable:{top:!0,right:!0,bottom:!0,left:!0,topRight:!0,bottomRight:!0,bottomLeft:!0,topLeft:!0},style:{},grid:[1,1],lockAspectRatio:!1,lockAspectRatioExtraWidth:0,lockAspectRatioExtraHeight:0,scale:1,resizeRatio:1,snapGap:0},t}(R.PureComponent);const jC=e=>{const t=Object(ue.a)();return e&&!t||!e&&t};class OC extends R.PureComponent{render(){const{enable:e,defaultSize:t,minWidth:n,maxWidth:o,style:r,handleStyles:i,resizeHandleIcon:a,invertResizeKey:s,enableKeyboardResize:l,resizeStrings:c,className:u}=this.props;return R.createElement(R.Fragment,null,R.createElement(MC,{ref:this.resizableRef,handleStyles:i,style:r,minWidth:n,maxWidth:o,defaultSize:t,enable:e,onResize:this.async.debounce(this.onResize,5,{leading:!1,maxWait:5}),onResizeStart:this.onResizeStart,onResizeStop:this.onResizeStop,className:u},this.props.children,l&&R.createElement(Ko.a,{type:"AppButtonProps",label:(null==c?void 0:c.resizeLabel)||"",hideLabel:!0,id:"resizeHandleButton",ref:this.resizeButtonRef,onKeyDown:this.onKeyDown,onFocus:this.onResizeHandleFocus,onBlur:this.onResizeHandleBlur,styles:WC(!!s,this.state.resizeHandleVisible,Object(wp.isReducedAnimations)()),icon:a})),R.createElement(Sd.a,{"aria-live":"polite",message:this.state.message}))}focusResizeHandle(){var e;this.props.enableKeyboardResize&&(null===(e=this.resizeButtonRef)||void 0===e||null===(e=e.current)||void 0===e||e.focus())}updateSize(e){var t;null===(t=this.resizableRef)||void 0===t||null===(t=t.current)||void 0===t||t.updateSize(e)}constructor(e){super(e),this.async=new Ed.a,this.resizableRef=R.createRef(),this.resizeButtonRef=R.createRef(),this.onResize=(e,t,n)=>{var o,r;null===(o=(r=this.props).onResize)||void 0===o||o.call(r,n.offsetWidth)},this.onResizeStart=()=>{var e,t;null===(e=(t=this.props).onResizeStart)||void 0===e||e.call(t)},this.onResizeStop=(e,t,n)=>{this.props.onResizeEnd&&this.props.onResizeEnd(n.offsetWidth)},this.onResizeHandleBlur=()=>{var e;const{resizeStrings:t}=this.props;if(null!==(e=this.resizableRef)&&void 0!==e&&e.current){var n,o;t&&this.setMessage(t.resizeModeOff),this.setState({resizeHandleVisible:!1});const e=this.resizableRef.current.size.width;null===(n=(o=this.props).onResizeEnd)||void 0===n||n.call(o,e)}},this.onResizeHandleFocus=()=>{const{resizeStrings:e}=this.props;this.onResizeStart(),e&&this.setMessage(e.resizeModeOn),this.setState({resizeHandleVisible:!0})},this.onKeyDown=e=>{const{invertResizeKey:t,keyboardResizeIncrement:n}=this.props,o=n||15,r=jC(!!t)?-o:o;let i=0;e.keyCode===xe.a.left?(this.resizableRef&&this.resizableRef.current&&(i=this.getLeftArrowContentWidth(this.resizableRef.current.size.width-r)),this.handleResizeKey(e,i)):e.keyCode===xe.a.right&&(this.resizableRef&&this.resizableRef.current&&(i=this.getRightArrowContentWidth(this.resizableRef.current.size.width+r)),this.handleResizeKey(e,i))},this.handleResizeKey=(e,t)=>{var n,o,r,i;this.resizableRef&&this.resizableRef.current&&(this.resizableRef.current.updateSize({width:t,height:"100%"}),null===(r=(i=this.props).onResize)||void 0===r||r.call(i,t)),null===(n=this.resizeButtonRef.current)||void 0===n||null===(o=n.removeToolTip)||void 0===o||o.call(n),e.stopPropagation(),e.preventDefault()},this.getLeftArrowContentWidth=e=>{const{invertResizeKey:t,maxWidth:n,minWidth:o}=this.props;let r=e;const i=jC(!!t);return i&&n?r=Math.min(e,n):!i&&o&&(r=Math.max(e,o)),this.calculateNewSizeMessage(r),r},this.getRightArrowContentWidth=e=>{const{invertResizeKey:t,maxWidth:n,minWidth:o}=this.props;let r=e;const i=jC(!!t);return i&&o?r=Math.max(e,o):!i&&n&&(r=Math.min(e,n)),this.calculateNewSizeMessage(r),r},this.calculateNewSizeMessage=e=>{const{maxWidth:t,minWidth:n,resizeStrings:o}=this.props;if(o){let r="";r=e===t?o.resizeMaxValue:e===n?o.resizeMinValue:o.resizeCurrentValue.replace("{0}",e.toString()),this.setMessage(r)}},this.setMessage=e=>{this.setState({message:e})},this.state={message:"",resizeHandleVisible:!1}}}const LC=Object(Jo.c)((e,t)=>jC(e)?{left:t}:{right:t}),AC=Object(Jo.c)(e=>jC(e)?{left:{width:15}}:{right:{width:15}}),NC=Object(Jo.c)((e,t)=>{const n=Object(ci.y)(t);return e?{}:{transition:`width ${n}ms ease`}}),WC=Object(Jo.c)((e,t,n)=>({root:[{paddingLeft:0,paddingRight:0,backgroundColor:"transparent",borderColor:"transparent",position:"absolute",top:0,bottom:0,marginTop:"auto",marginBottom:"auto",pointerEvents:"none",transition:`opacity ${Object(ci.y)(n)}ms ease`},t&&{opacity:1},!t&&{opacity:0},!e&&{right:0,marginRight:-16},e&&{left:0,marginLeft:-16},ci.v],icon:{height:32,width:32}})),zC=(e=!1)=>{const t=Object(ue.a)();return e&&!t||!e&&t},HC=(e,t,n,o,r,i)=>{const{onResizeStart:a,onResizeEnd:s,onResize:l,invertResizeKey:c}=e,u=R.useCallback(()=>{n(e=>_object_spread_props(_object_spread({},e),{[i]:!0})),null==a||a()},[i,a,n]),d=R.useCallback(()=>{n(e=>_object_spread_props(_object_spread({},e),{isKeyboardResizing:!1,isMouseResizing:!1})),null==s||s(t.sidebarWidth),document.body.style.cursor="auto";const o=document.getElementById("resize-cursor-"+e.invertResizeKey);o&&(o.style.display="none")},[n,s,t.sidebarWidth,e.invertResizeKey]),p=R.useCallback(e=>{n(t=>_object_spread_props(_object_spread({},t),{sidebarWidth:e}))},[n]),g=R.useCallback(t=>{let n=t;return e.minWidth&&n<e.minWidth&&(n=e.minWidth),e.maxWidth&&n>e.maxWidth&&(n=e.maxWidth),n},[e.maxWidth,e.minWidth]),h=R.useCallback(({clientX:e})=>{o.current=requestAnimationFrame(()=>{if(t.isMouseResizing&&r.current){const t=r.current.getBoundingClientRect();if(t){const n=zC(c)?t.width-(e-t.left):e-t.left,o=g(n);p(o),null==l||l(o)}}})},[o,t.isMouseResizing,r,c,g,p,l]),m=R.useCallback(({key:e})=>{o.current=requestAnimationFrame(()=>{if(t.isKeyboardResizing){const n=zC(c);"Escape"!==e&&"Enter"!==e||d();let o=t.sidebarWidth;"ArrowLeft"===e&&r.current&&(o=n?t.sidebarWidth+3:t.sidebarWidth-3),"ArrowRight"===e&&(o=n?t.sidebarWidth-3:t.sidebarWidth+3);const i=g(o);p(i),null==l||l(i)}})},[o,t.isKeyboardResizing,t.sidebarWidth,c,r,g,p,l,d]);return{startResizing:u,stopResizing:d,setSidebarWidth:p,resizeTaskPaneViaMouse:h,resizeTaskPaneViaKeyboard:m}},VC=Object(ut.a)({root:_object_spread_props(_object_spread({},pt.a.overflow("hidden")),{display:"flex",height:"100%"}),container:{position:"relative"},resizer:{width:"18px",position:"absolute",top:0,bottom:0,resize:"horizontal",":hover":{cursor:"ew-resize"}},resizerRTL:{right:"2px"},cursor:{pointerEvents:"none",position:"absolute",zIndex:1,display:"none",width:"15px"}}),UC=R.memo(R.forwardRef(e=>{var t;const[n,o]=R.useState(_object_spread({},(e=>{var t;const n=_object_spread_props(_object_spread({},e),{isMouseResizing:!1,isKeyboardResizing:!1,sidebarWidth:parseInt(((null===(t=e.defaultSize)||void 0===t?void 0:t.width)||0).toString(),10)});return _object_spread({},e,n)})(e))),r=(e=>{const t=VC(),n=zC(e);return{resizer:Object(Rt.a)(t.resizer,!n&&t.resizerRTL),root:Object(Rt.a)(t.root),container:Object(Rt.a)(t.container),cursor:Object(Rt.a)(t.cursor)}})(e.invertResizeKey);return R.useEffect(()=>{o(t=>{var n;return _object_spread_props(_object_spread({},t),{sidebarWidth:parseInt(((null===(n=e.defaultSize)||void 0===n?void 0:n.width)||0).toString(),10)})})},[null===(t=e.defaultSize)||void 0===t?void 0:t.width]),((e,t,n,o)=>{const r=R.useRef(0),i=R.useRef(null),a=((e,t,n,o,r)=>{const{startResizing:i,stopResizing:a,resizeTaskPaneViaMouse:s}=HC(e,t,n,o,r,"isMouseResizing");return R.useEffect(()=>{if(e.resizeMode){document.body.style.cursor="none";const a=document.getElementById("resize-cursor-"+e.invertResizeKey);if(a){var t,n,o;i();const s=zC(e.invertResizeKey);a.style.display="block",a.style.transform=`translate3d(${s?-7:null===(t=r.current)||void 0===t?void 0:t.clientWidth}px, ${null!==(n=r.current)&&void 0!==n&&n.getBoundingClientRect().height?(null===(o=r.current)||void 0===o?void 0:o.getBoundingClientRect().height)/2:0}px, 0)`}}},[e.resizeMode,t.sidebarWidth,i,r,e.invertResizeKey]),R.useEffect(()=>(t.isMouseResizing&&(window.addEventListener("mousemove",s),window.addEventListener("mouseup",a)),()=>{cancelAnimationFrame(o.current),window.removeEventListener("mousemove",s),window.removeEventListener("mouseup",a)}),[t.isMouseResizing,s,a,o]),{startResizing:i}})(e,t,n,r,i).startResizing;return((e,t,n,o,r)=>{const{startResizing:i,resizeTaskPaneViaKeyboard:a}=HC(e,t,n,o,r,"isKeyboardResizing");R.useEffect(()=>{e.resizeMode&&i()},[e.resizeMode,i]),R.useEffect(()=>(t.isKeyboardResizing&&window.addEventListener("keydown",a),()=>{cancelAnimationFrame(o.current),window.removeEventListener("keydown",a)}),[t.isKeyboardResizing,a,o])})(e,t,n,r,i),R.createElement("div",{className:o.root},R.createElement(fe.a,{id:"resize-cursor-"+e.invertResizeKey,className:o.cursor,iconName:e.resizeHandleIcon}),R.createElement("div",{className:o.container,ref:i,style:{width:t.sidebarWidth+"px"},onMouseDown:e=>e.preventDefault(),"data-testid":"sidebar"},e.children,R.createElement(()=>R.createElement("div",{"data-testid":"resizable",className:o.resizer,onMouseDown:a}),null)))})(e,n,o,r)}));var GC=n(1025),qC=n(2569);const QC=Object(Jo.c)((e,t,n,o,r,i,a,s,l,c,u,d)=>{const p=Object(rx.f)(e,c),g=t===D.a.Left?0:"auto",h=t===D.a.Left?"auto":0,m=`1px ${p.border} solid`,b=Object(ci.y)(s);return Object(F.I)({resizableContainer:[!o&&{width:"100% !important",flexShrink:"1 !important"}],root:[{height:"100%",display:"flex",flexShrink:0,position:"absolute",left:g,right:h,background:p.background,boxSizing:"border-box"},l&&t===D.a.Left&&{borderRight:u?"none":m},l&&t===D.a.Right&&{borderLeft:m},r&&{width:"100%"}],taskPaneContainer:[{display:"inline-block",height:"100%",position:"relative",width:o||r?"100%":n,transition:`width ${b}ms ease`,backgroundColor:d?_o.a.colorNeutralBackground3:void 0},ci.v]},i,a)}),KC=Object(Jo.c)(e=>({root:Object(F.eb)(e.root),taskPaneContainer:Object(F.eb)(e.taskPaneContainer),resizableContainer:Object(F.eb)(e.resizableContainer)})),JC=(e,t)=>{const{taskPanes:n,overflowTabCount:o}=e,r=Object(pC.c)(n.length,e=>-1),i=Object(pC.e)(n,e=>e.id===t);let a=n.length-1;i>=0&&(r[i]=a,a-=1);for(let e=0;e<r.length;e+=1)-1===r[e]&&(r[e]=a,a-=1);return{items:n.filter((e,t)=>r[t]>=o),overflowItems:n.filter((e,t)=>r[t]<o)}};var YC=n(2471),ZC=n(949),$C=n(2602),XC=n(1472),ev=n(1005),tv=n(1162),nv=n(2244);const ov=R.memo(R.forwardRef((e,t)=>{const n=Object(nv.a)(e,t),o=Object(Ma.a)(n);return Object(Ba.a)(n),((e,t)=>Fa(e,t))(n,o)}));ov.displayName="next/AppTabList";const rv=Object(ut.a)({icon:{padding:_o.a.spacingHorizontalMNudge}});var iv=n(1168);const av=R.memo(R.forwardRef(e=>{var t;const n=Object(Jo.c)(e=>{const t=rv().icon;return e.map(e=>({id:e.id,icon:{children:R.createElement(fe.a,{iconName:e.icon}),className:t},title:"",iconOnly:!0,ariaControls:Object(rx.e)(e.id),tooltipDirection:Se.a.leftCenter,ariaLabel:e.title}))}),{items:o,overflowItems:r,overflowMenuLabel:i,overflowMenuIcon:a,selectedPaneId:s,tabContainerLabel:l,onOverflowMenuOpen:c,onFocus:u}=e;return R.createElement(iv.a,null,R.createElement(ov,{label:l||"",overflowMenuLauncherLabel:i,topLevelTabHeaders:n(o),overflowTabHeaders:n(r),selectedTabId:s||"",overflowTabHeaderMenuLauncherIcon:(null===(t=Object(mi.a)(a))||void 0===t?void 0:t.iconName)||"",onTabHeaderClick:(t,n)=>{e.onTabButtonExecute&&e.onTabButtonExecute(t,n&&n.inputMethod||hC.a.Unknown)},vertical:!0,onOverflowButtonExecute:c,onFocus:u}))})),sv=R.memo(R.forwardRef(e=>{const t={taskPanes:e.taskPanes.filter(e=>!e.hidden),overflowTabCount:0};return R.createElement(ev.a,{data:t,onReduceData:e=>{if(0!==e.taskPanes.length)return _object_spread_props(_object_spread({},e),{overflowTabCount:e.overflowTabCount+1})},onGrowData:e=>{if(0!==e.overflowTabCount)return _object_spread_props(_object_spread({},e),{overflowTabCount:e.overflowTabCount-1})},direction:tv.a.vertical,onRenderData:(()=>{const{selectedPaneId:t,onTabButtonExecute:n,overflowMenuIcon:o,overflowMenuLabel:r,onOverflowMenuOpen:i,tabContainerLabel:a,onFocus:s}=e;return e=>{const l=e.taskPanes.length>1;return R.createElement("div",null,l&&R.createElement(av,_object_spread_props(_object_spread({},JC(e,t)),{selectedPaneId:t,onTabButtonExecute:n,overflowMenuIcon:o,overflowMenuLabel:r,onOverflowMenuOpen:i,tabContainerLabel:a,onFocus:s})))}})()})}));class lv extends R.PureComponent{render(){const{selectedPaneId:e}=this.props,t=this.getVisiblePanes(),n={taskPanes:t,overflowTabCount:0};return R.createElement(we.a,null,o=>{var r,i;const a=null===(r=(i=this.context).isPlatformFeatureEnabled)||void 0===r?void 0:r.call(i,Zf.e.disableTaskpaneRefreshStyling),s=Hy(Wy(o,t.length,e,Object(wp.isReducedAnimations)(),a));return R.createElement("div",{ref:e=>this.tabStripContainer=e},R.createElement(ev.a,{className:s.resizeGroupRoot,data:n,onReduceData:this.onReduceData,onGrowData:this.onGrowData,direction:tv.a.vertical,onRenderData:this.renderResizedTabStrip(s)}),R.createElement("div",{ref:this.indicatorContainer}))})}focus(){this.innerTabStrip&&this.innerTabStrip.focus()}componentDidUpdate(){this.getVisiblePanes().length<2&&this.indicatorContainer.current&&k.render(R.createElement("div",null),this.indicatorContainer.current)}constructor(){super(...arguments),this.tabStripContainer=null,this.innerTabStrip=null,this.indicatorContainer=R.createRef(),this.containsElement=e=>this.innerTabStrip&&this.innerTabStrip.containsElement(e),this.renderResizedTabStrip=e=>{const{selectedPaneId:t,onTabButtonExecute:n,indicatorStyles:o,overflowMenuIcon:r,overflowMenuLabel:i,onOverflowMenuOpen:a,onOverflowMenuClose:s,tabContainerLabel:l,onFocus:c,location:u}=this.props;return d=>{const p=d.taskPanes.length>1;return R.createElement("div",{className:e.buttonContainer},p&&R.createElement(cv,_object_spread_props(_object_spread({ref:e=>this.innerTabStrip=e},JC(d,t)),{selectedPaneId:t,onTabButtonExecute:n,tabStripContainer:this.tabStripContainer,indicatorStyles:o,overflowMenuIcon:r,overflowMenuLabel:i,onOverflowMenuOpen:a,onOverflowMenuClose:s,indicatorContainer:this.indicatorContainer,tabContainerLabel:l,onFocus:c,location:u})))}},this.onReduceData=e=>{if(0!==e.taskPanes.length)return _object_spread_props(_object_spread({},e),{overflowTabCount:e.overflowTabCount+1})},this.onGrowData=e=>{if(0!==e.overflowTabCount)return _object_spread_props(_object_spread({},e),{overflowTabCount:e.overflowTabCount-1})},this.getVisiblePanes=()=>this.props.taskPanes.filter(e=>!e.hidden)}}lv.contextType=Hm.a;class cv extends R.PureComponent{render(){const{items:e,overflowItems:t,overflowMenuLabel:n,overflowMenuIcon:o,selectedPaneId:r,tabContainerLabel:i}=this.props;return R.createElement(we.a,null,a=>{var s,l;const c=null===(s=(l=this.context).isPlatformFeatureEnabled)||void 0===s?void 0:s.call(l,Zf.e.disableTaskpaneRefreshStyling);return R.createElement($C.a,{ref:this.pivotRef,label:i,topLevelItems:this.convertItemsToPivotHeaders(a,e,c),overflowItems:this.convertItemsToPivotHeaders(a,t,c),selectedPivotId:r?this.tabStripButtonId+r:void 0,overflowMenuLauncherLabel:n,onPivotHeaderExecute:this.onTabButtonExecute(),direction:XC.a.Vertical,menuProps:this.getMenuProps(),menuIconProps:Object(mi.a)(o),styles:Gy(a),focusZoneProps:this.getFocusZoneProps(),tooltipDirection:Se.a.leftCenter})})}focus(){this.pivotRef.current&&this.pivotRef.current.focus()}componentDidMount(){this.props.indicatorContainer.current&&this.renderPivotIndicator("all",!0,this.props.selectedPaneId)}componentDidUpdate(e){const t=this.selectedPaneWasInOverflow(e.overflowItems,this.props.selectedPaneId);(this.selectedPane!==this.props.selectedPaneId||this.panesNotEqual(e.items,this.props.items)||this.panesNotEqual(e.overflowItems,this.props.overflowItems)||t)&&this.renderPivotIndicator(this.getTransitionProperties(e.selectedPaneId),e.selectedPaneId!==this.props.selectedPaneId,this.props.selectedPaneId,t)}constructor(e){super(e),this.tabStripButtonId="tabStripButton",this.pivotRef=R.createRef(),this.selectedPane="",this.indicatorState={position:0,offset:0,length:0,thickness:0},this.convertItemsToPivotHeaders=Object(Jo.c)((e,t,n)=>t.map(t=>({id:this.tabStripButtonId+t.id,title:t.title,styles:Uy(e,n),icon:t.icon,hideLabel:!0,ariaControls:Object(rx.e)(t.id),tooltipDirection:Se.a.leftCenter,getMenuItemClassNames:Vy(),ariaLabel:t.title}))),this.containsElement=e=>{const t=document.getElementById(this.focusZoneId);return Object(Ki.a)(t,e)},this.panesNotEqual=(e,t)=>{const n=e.map(e=>e.id),o=t.map(e=>e.id);return!Object(pC.b)(n,o)},this.selectedPaneWasInOverflow=(e,t)=>!!t&&e.map(e=>e.id).indexOf(t)>=0,this.getTransitionProperties=e=>{let t="all";return e||(t="width"),t},this.renderPivotIndicator=(e,t,n,o=!1)=>{this.selectedPane=n,o||(this.indicatorState=this.getPivotIndicatorState(n)),k.render(R.createElement(YC.a,{direction:ZC.a.Vertical,showAnimation:t,position:this.indicatorState.position,length:this.indicatorState.length,thickness:this.indicatorState.thickness,styles:qy(e,this.props.indicatorStyles)}),this.props.indicatorContainer.current)},this.onFocusCapture=e=>{const t=document.getElementById(this.focusZoneId),n=document.activeElement,o=n&&Object(Ki.a)(t,document.activeElement,!1),r=e&&e.relatedTarget,i=r&&!Object(Ki.a)(t,e.relatedTarget,!1),{onFocus:a}=this.props;a&&o&&i&&a();const s=n&&t===document.activeElement,l=n&&o&&n.id!==this.tabStripButtonId+this.props.selectedPaneId;(n||r)&&(s||l)&&i&&(e.preventDefault(),this.focus())},this.getFocusZoneProps=Object(Jo.c)(()=>_object_spread_props(_object_spread({direction:qo.a.vertical,isCircularNavigation:!0,onFocusCapture:this.onFocusCapture,tabIndex:0},{"data-is-focusable":!0}),{id:this.focusZoneId})),this.getPivotIndicatorState=e=>{if(e){const t=document.getElementById(this.tabStripButtonId+e);if(t&&this.props.tabStripContainer)return{position:t.getBoundingClientRect().top-this.props.tabStripContainer.getBoundingClientRect().top,offset:3,length:40,thickness:3}}return{position:this.indicatorState&&this.indicatorState.position||0,offset:this.indicatorState&&this.indicatorState.offset||0,length:this.indicatorState&&this.indicatorState.length||0,thickness:0}},this.onTabButtonExecute=()=>(e,t)=>{const n=e.slice(this.tabStripButtonId.length);this.renderPivotIndicator(this.getTransitionProperties(this.selectedPane),!0,n),this.props.onTabButtonExecute&&this.props.onTabButtonExecute(n,t&&t.inputMethod||hC.a.Unknown)},this.getMenuProps=Object(Jo.c)(()=>({directionalHint:Se.a.leftBottomEdge,onMenuOpened:this.onMenuOpened,onMenuDismissed:this.onMenuDismiss})),this.onMenuDismiss=e=>{const{onOverflowMenuClose:t}=this.props;t&&t()},this.onMenuOpened=e=>{const{onOverflowMenuOpen:t}=this.props;t&&t()},this.props.location===D.a.Left?this.focusZoneId="tabStripFocusZoneLeft":this.focusZoneId="tabStripFocusZone"}}cv.contextType=Hm.a;const uv=R.forwardRef((e,t)=>Object(gC.a)()?R.createElement(sv,_object_spread({ref:t},e)):R.createElement(lv,_object_spread({ref:t},e)));var dv=n(2439),pv=n(808),gv=n(2476);const hv=e=>{const t=Object(gv.a)({tabBehavior:"limited-trap-focus"});return R.createElement(pv.a,_object_spread({id:e.focusZoneId,onKeyDown:e.onKeyDown,onMouseDown:e.onMouseDown,onFocus:e.onFocus,isClickableOutsideFocusTrap:!0,forceFocusInsideTrap:!1,disableFirstFocus:!0,ignoreExternalFocusing:!0,"data-is-focusable":!0,className:e.className,tabIndex:0},t),e.children)};var mv=n(2220);class bv extends R.PureComponent{componentWillUnmount(){Object(wp.unregisterBoundingWindowRectsChanged)("reactTabbedTaskPanes_"+this.props.location)}componentDidMount(){this.props.innerRef&&(this.props.innerRef.current=this)}componentDidUpdate(e){Object(rx.d)(this.persistedPanes,e.taskPanes,this.props.taskPanes);const t=e.selectedPaneId,n=this.props.selectedPaneId,o=n!==t;if(t&&o){const e=this.findPane(t,this.props.taskPanes);e&&e.onHide&&e.onHide(this.lastInputMethod)}if(n){const r=this.findPane(n,this.props.taskPanes);if(o&&r&&r.onShow&&r.onShow(this.lastInputMethod),r&&this.resizable.current){const n=t?this.getResizedPaneWidth(this.findPane(t,e.taskPanes)):void 0,i=this.getResizedPaneWidth(r),a=n&&i!==n;i&&(o||a)&&(this.resizable.current.updateSize({width:i,height:"100%"}),this.onResize(i))}}!n&&this.resizable.current&&this.resizable.current.updateSize({width:0,height:"100%"}),this.setLastInputMethod(hC.a.Unknown),e.innerRef!==this.props.innerRef&&(e.innerRef&&(e.innerRef.current=null),this.props.innerRef&&(this.props.innerRef.current=this))}render(){const{taskPanes:e,location:t,selectedPaneId:n,onTabButtonExecute:o,styles:r,indicatorStyles:i,overflowMenuIcon:a,overflowMenuLabel:s,onOverflowMenuOpen:l,onOverflowMenuClose:c,tabContainerLabel:u,getGroupAdaptiveLayoutStyles:d,stretchWidthToContainer:p,onTabStripFocus:g,useBorderLessTaskPaneContainer:h}=this.props,{windowMode:m,layoutBreakpoint:b}=this.state;let f=0,x=void 0,E=void 0;if(n){if(x=Object(pC.d)(e,e=>e.id===n),!x)throw new Error("Selected pane ID was not found in the TabbedTaskPaneGroup");E=x.useBorderLessStyles,f=x.width}const S=e.filter(e=>!e.hidden),y=R.createElement(uv,{ref:this.tabStrip,taskPanes:e,selectedPaneId:n,onTabButtonExecute:this.getOnTabButtonExecute(o),indicatorStyles:i,overflowMenuIcon:a,overflowMenuLabel:s,onOverflowMenuOpen:l,onOverflowMenuClose:c,tabContainerLabel:u,onFocus:g,location:t});return R.createElement(Hm.a.Consumer,null,e=>R.createElement(we.a,null,n=>{var o,i,a;this.updateInternalState();const s=!!Object(Zf.a)(e,Zf.f.taskPaneResizingIsEnabled);x&&(f=this.getPaneWidth(x,s));const l=null===(o=(i=this.context).isPlatformFeatureEnabled)||void 0===o?void 0:o.call(i,Zf.e.disableTaskpaneRefreshStyling),c=KC(QC(n,t,f,s&&!this.isResizeDisabled(),!!p,r,d&&d(m,b,S.length>0),this.isReducedAnimations(),S.length>0,l,E,h)),u=this.renderPanes(c,s,S.length),g=R.createElement(dv.a,{elementTimingId:"task-pane",hidden:0===S.length,interactivityTrackerContext:null===(a=x)||void 0===a?void 0:a.id}),C=R.createElement(R.Fragment,null,R.createElement(Sd.a,{"aria-live":"polite",message:this.internalState.taskPaneOpeningMessage,"aria-atomic":!0}),R.createElement(hm.a,null,t===D.a.Left?R.createElement(R.Fragment,null,g,y,u):R.createElement(R.Fragment,null,g,u,y)));return R.createElement(hv,{focusZoneId:this.rootId,onMouseDown:this.onRootMouseDown,onFocus:this.onRootFocus,className:c.root},C)}))}focus(){if(this.props.taskPanes.filter(e=>!e.hidden).length>1&&this.tabStrip&&this.tabStrip.current)return void this.tabStrip.current.focus();const e=this.findSelectedPaneRef();e&&e.current?e.current.focus():this.focusPane()}focusResizeHandle(){var e;null===(e=this.resizable)||void 0===e||null===(e=e.current)||void 0===e||e.focusResizeHandle()}constructor(e){super(e),this.animationClassNames=Object(GC.a)(),this.persistedPanes=[],this.nonPersistedPanes=[],this.taskPaneContainer=R.createRef(),this.tabStrip=R.createRef(),this.resizable=R.createRef(),this.lastInputMethod=hC.a.Unknown,this.isReducedAnimations=()=>!!this.props.useReducedAnimations||Object(wp.isReducedAnimations)(),this.getResizedPaneWidth=e=>!this.isResizeDisabled()&&null!=e&&e.resizeWidth?null==e?void 0:e.resizeWidth:null==e?void 0:e.width,this.updateInternalState=()=>{const e=this.internalState,t=this.props,n={prevPanes:e.currPanes,currPanes:t.taskPanes},o=e.currSelectedPaneId,r=t.selectedPaneId,{taskPaneOpeningString:i}=t;let a="";if(i&&void 0!==r&&(o!==r||""!==e.taskPaneOpeningMessage)){const e=Object(pC.d)(t.taskPanes,e=>e.id===r);a=e?i.replace("{0}",e.title):""}this.internalState=_object_spread_props(_object_spread(void 0!==o&&void 0!==r&&o!==r?{prevSelectedPaneId:o,currSelectedPaneId:r}:{prevSelectedPaneId:e.currSelectedPaneId,currSelectedPaneId:r},n),{taskPaneOpeningMessage:a})},this.onRootFocus=e=>{const t=document.getElementById(this.rootId),n=document.activeElement,o=e&&e.relatedTarget,r=!n||!(Object(Ki.a)(t,document.activeElement)&&t!==n),i=!o||!(Object(Ki.a)(t,e.relatedTarget)&&t!==o);((n||o)&&r&&i||!this.props.selectedPaneId&&this.props.taskPanes.filter(e=>!e.hidden).length>=2&&this.tabStrip.current&&!this.tabStrip.current.containsElement(n))&&this.focus()},this.onRootMouseDown=e=>{const t=e.target,n="#"+this.rootId+' [draggable="true"]',o=t.matches||t.webkitMatchesSelector||t.msMatchesSelector;if(o){const r=o.call(t,"input, input *"),i=o.call(t,"textarea, textarea *"),a=o.call(t,'[role="textbox"], [role="textbox"] *'),s=t.closest(n),l=this.isClickTarget(o,t);r||i||a||s||l||e.preventDefault()}},this.isClickTarget=(e,t)=>!!this.props.clickTargetSelectors&&!!this.props.clickTargetSelectors.find(n=>e.call(t,`${n}, ${n} *`)),this.renderPanes=(e,t,n)=>{const{prevSelectedPaneId:o,prevPanes:r}=this.internalState,{isResizing:i}=this.state,{location:a,taskPanes:s,selectedPaneId:l,stretchWidthToContainer:c,resizeStrings:u,resizeHandleIcon:d,getSplashPageContent:p}=this.props;this.persistedPanes=[],this.nonPersistedPanes=[];const g=!!l&&!Object(pC.d)(r,e=>e.id===l),h=Object(rx.b)(s),m=Object(rx.a)(s).concat(h),b=Object(rx.c)(s),f=Object(pC.d)(s,e=>e.id===l),x=!!f&&!(null==f||!f.enableResize),E=f?this.getPaneWidth(f,t):0,S=a===D.a.Right,y=t?{ref:this.resizable,enable:LC(S,this.taskPaneResizingIsEnabled(t,x)),handleStyles:AC(S),style:NC(i,this.isReducedAnimations()),className:e.resizableContainer,defaultSize:{width:E,height:"100%"},minWidth:i&&x?null==f?void 0:f.minResizeWidth:void 0,maxWidth:i&&x?null==f?void 0:f.maxResizeWidth:void 0,onResize:this.onResize,onResizeStart:this.onResizeStart,onResizeEnd:this.onResizeEnd,invertResizeKey:S,resizeStrings:u,resizeHandleIcon:d,resizeMode:this.state.resizeMode,enableKeyboardResize:x}:void 0,C=Object(gC.a)(),v=t?C?UC:OC:R.Fragment;let k=void 0;return 0===n&&p&&c&&(k=p()),R.createElement(v,_object_spread({},y),R.createElement("div",{className:e.taskPaneContainer,ref:this.taskPaneContainer},k,b.map(e=>{const n=R.createRef();this.persistedPanes.push(n);const r=e.id===l,a=!C&&Object(GC.d)(r,g&&r,i,!!c,!!o,this.isReducedAnimations())||void 0;return R.createElement(qC.a,_object_spread_props(_object_spread({},e),{key:e.id,ref:n,styles:a,onResizeModeToggle:this.toggleResizeMode,"data-is-visible":r,role:"tabpanel",width:this.getPaneWidth(e,t),resizeButtonProps:e.resizeButtonProps,isTabbedTaskPane:!0,tabbedTaskPaneProps:{isSelected:r,isNewPane:g,isResizing:i,stretchWidth:!!c,prevSelectedPaneId:!!o,isReducedAnimations:this.isReducedAnimations()}}))}),R.createElement(uC.a,{component:null},m.map(e=>{const n=R.createRef();e.isPersistedTaskPane?this.persistedPanes.push(n):this.nonPersistedPanes.push(n);const r=l===e.id,a=this.getResizeChatButtonProps(e),s=!C&&Object(GC.d)(r,g&&r,i,!!c,!!o,this.isReducedAnimations())||void 0;return R.createElement(dC.a,{key:e.id,classNames:this.animationClassNames,timeout:Object(ci.y)(this.isReducedAnimations()),onEntering:e.onOpen,onExiting:e.onClose},R.createElement(qC.a,_object_spread_props(_object_spread({key:e.id,ref:n},e),{onResizeModeToggle:this.toggleResizeMode,disableResize:!e.enableResize,styles:s,"data-is-visible":r,role:"tabpanel",width:this.getPaneWidth(e,t),resizeChatButtonProps:a,resizeButtonProps:e.resizeButtonProps,isTabbedTaskPane:!0,tabbedTaskPaneProps:{isSelected:r,isNewPane:g&&r,isResizing:i,stretchWidth:!!c,prevSelectedPaneId:!!o,isReducedAnimations:this.isReducedAnimations()}})))}))))},this.getResizeChatButtonProps=Object(Jo.c)(e=>{if(e.resizeChatButtonProps)return _object_spread_props(_object_spread({},e.resizeChatButtonProps),{onExecute:this.getOnChatResizeExecute(e)})}),this.getOnChatResizeExecute=e=>t=>{var n,o;let r=mv.a;var i,a;e.resizeWidth&&e.resizeWidth>e.width?r=e.width:null!==(i=(a=this.context).isExperimentalFeatureEnabled)&&void 0!==i&&i.call(a,Zf.f.copilotMaxTaskpaneWidthIsEnabled)&&e.maxResizeWidth&&e.maxResizeWidth>920&&(r=e.maxResizeWidth),this.onResizeStart(),this.resizable.current.updateSize({width:r,height:"100%"}),window.requestAnimationFrame(()=>this.onResizeEnd(r)),null===(n=e.resizeChatButtonProps)||void 0===n||null===(o=n.onExecute)||void 0===o||o.call(n,t)},this.toggleResizeMode=e=>{this.setState({resizeMode:e})},this.onResize=e=>{const{onResize:t,selectedPaneId:n,location:o,taskPanes:r}=this.props;if(t&&n){const i=Object(pC.d)(r,e=>e.id===n);i&&i.enableResize&&t(e,o)}},this.onResizeStart=()=>{const{onResizeStart:e,selectedPaneId:t}=this.props;this.setState({isResizing:!0}),e&&t&&e()},this.onResizeEnd=e=>{const{onResizeEnd:t,selectedPaneId:n}=this.props;this.setState({isResizing:!1}),this.toggleResizeMode(!1),t&&n&&t(n,e)},this.focusPane=()=>{this.getElementAndFocus("TaskPaneActionButton")||this.getElementAndFocus("TaskPaneOptionsFlyoutAnchor")||this.getElementAndFocus("TaskPaneCloseBtn")||this.getElementAndFocus("TaskPaneContent")},this.getElementAndFocus=e=>{const t=document.getElementById(e+this.props.selectedPaneId);if(t){if("TaskPaneContent"!==e)return t.focus(),!0;const n=Object(Il.e)(t,t.firstChild,!0);return n&&n.focus(),!0}return!1},this.findSelectedPaneRef=()=>{let e=Object(pC.d)(this.nonPersistedPanes,e=>{if(e.current&&e.current.props&&e.current.props.id===this.props.selectedPaneId)return e.current});return e||(e=Object(pC.d)(this.persistedPanes,e=>{if(e.current&&e.current.props&&e.current.props.id===this.props.selectedPaneId)return e.current}),e)},this.boundingWindowRectsChanged=(e,t)=>{this.setState({windowMode:t,layoutBreakpoint:Object(wp.getLayoutBreakpoint)()})},this.findPane=(e,t)=>Object(pC.d)(t,t=>t.id===e),this.getOnTabButtonExecute=Object(Jo.c)(e=>(t,n)=>{this.setLastInputMethod(n),e&&e(t)}),this.setLastInputMethod=e=>{this.lastInputMethod=e},this.isResizeDisabled=()=>!!this.props.stretchWidthToContainer,this.getPaneWidth=(e,t)=>e.resizeWidth&&this.taskPaneResizingIsEnabled(t,!!e.enableResize)?e.resizeWidth:e.width,this.taskPaneResizingIsEnabled=(e,t)=>e&&t&&!this.isResizeDisabled(),this.props.location===D.a.Left?this.rootId="tabbedTaskPaneContainerLeft":this.rootId="tabbedTaskPaneContainer",this.state={windowMode:Object(wp.getWindowMode)(),layoutBreakpoint:Object(wp.getLayoutBreakpoint)(),isResizing:!1,resizeMode:!1},this.internalState={prevSelectedPaneId:void 0,currSelectedPaneId:e.selectedPaneId,prevPanes:[],currPanes:e.taskPanes,taskPaneOpeningMessage:""},Object(wp.registerBoundingWindowRectsChanged)("reactTabbedTaskPanes_"+this.props.location,this.boundingWindowRectsChanged)}}bv.contextType=Hm.a;var fv=n(397),xv=n(1277),Ev=n(1768);const Sv=['[id^="cardRoot_"]','[id="GhostCard"]','[id="NewCommentButton"]','[id="LineageScrollablePaneId"]','[id="ConditionalFormattingTaskPane-panel"]'];var yv=n(790),Cv=n(197),vv=n.n(Cv),Rv=n(71);const kv=Object(Rc.a)([fv.j,fv.l,fv.g,fv.n,fv.i,fv.h,fv.e,fv.k,fv.d,fv.c,fv.f,fv.a,fv.b],(e,t,n,o,r,i,a,s,l,c,u,d,p)=>Tv(e,t,n,o,r,i,a,s,l,c,u,d,p)),Tv=Object(Jo.c)((e,t,n,o,r,i,a,s,l,c,u,d,p)=>{const g=Object(xv.b)(e,t);return _v(g,n,o,r,i,a,s,l,c,u,d,p)}),_v=Object(Jo.c)((e,t,n,o,r,i,a,s,l,c,u,d)=>{const p=Object(Ev.a)(),g=Object(Fr.a)(),h=Sv,m=e.map(e=>Dv(e,p,g,t,n,o,r,a,i,s,l,u,d));return{location:t,taskPanes:m,selectedPaneId:i,onTabButtonExecute:Av(!!c,i,a),resizeHandleIcon:Iv(),overflowMenuIcon:p.overflowMenuLauncher,overflowMenuLabel:g.taskPaneOverflowMenuLabel,tabContainerLabel:g.taskPaneTabsContainerLabel,onResize:wv(e,a,i),taskPaneOpeningString:g.taskPaneOpeningString,clickTargetSelectors:h}}),wv=Object(Jo.c)((e,t,n)=>(o,r)=>{if(Gv(t)&&t){const i=e.filter(e=>!e.hidden).length>1,a=n?Object(pC.d)(e,e=>e.id===n):void 0,s=o+sC(i,a)+"px",l=Object(ue.a)();r===D.a.Left&&!l||r===D.a.Right&&l?t.style.left=s:t.style.right=s}}),Dv=Object(Jo.c)((e,t,n,o,r,i,a,s,l,c,u,d,p=Number.MAX_SAFE_INTEGER)=>{const{id:g,title:h,titleTag:m,width:b,hideHeader:f,renderContent:x,isPersistedTaskPane:E,hidePersistedPaneInitially:S,hidden:y,onCloseButtonTabKeyDown:C,icon:v,headerIconId:R,headerIconUrl:k,actionButtonProps:T,rightActionButtonProps:_,showSharingContent:w,canBeShared:D,enableResize:P,minResizeWidth:I,maxResizeWidth:F,resizeWidth:B,isModernPane:M,disableVerticalScrollSpace:j,isNonClosablePane:O,preventCloseCallback:L,onManualClose:A,showResizeChatButton:N,showBackButton:W,useBorderLessStyles:z,taskPaneCustomTheme:H}=e,V=Object($c.h)("TaskPaneResizingIsEnabled")&&P,U=V&&I?Math.max(I,100):b;let G=F&&Math.min(F,p),q=V&&G?Math.min(G,920):b;Object($c.b)("Microsoft.Office.WordOnline.CopilotTaskPaneMaxWidth",!1)&&e.overrideMaxPaneWidthDonotuse&&(G=2*p,q=V&&G?G:b);const Q=B&&G?Math.min(B,G):B;return{id:g,title:h,titleTag:m,width:b,hideHeader:f,useBorderLessStyles:z,taskPaneCustomTheme:H,closeButtonProps:O||D&&w?void 0:Mv(t,n,o,C,L,A),renderContent:x,icon:v||r,headerIconId:R,headerIconUrl:k,onOpen:zv(g,e.onOpen,i,s),onClose:Hv(g,e.onClose,a,s),isPersistedTaskPane:E,hidePersistedPaneInitially:S,hidden:y,actionButtonProps:D&&w?Ov():W?jv(o,C,L,A):T,rightActionButtonProps:D?w?void 0:Lv(null==_?void 0:_.onTabKeyDown,null==_?void 0:_.onExecute):_,resizeChatButtonProps:!N||"Portrait"===Object(wp.getWindowMode)()&&"Small"===Object(wp.getLayoutBreakpoint)()||Q&&Q<b?void 0:Pv(Q,b),resizeButtonProps:Bv(),optionAnchorProps:Fv(),onShow:Vv(g,e.onShow,c),onHide:Uv(g,!l,e.onHide,u),stretchBodyToContainer:M,enableResize:!!V&&P,minResizeWidth:Math.min(U,q),maxResizeWidth:q,roleDescription:n.taskPaneRoleDescription,resizeWidth:Q,addVerticalScrollSpace:!j&&d}}),Pv=Object(Jo.c)((e,t)=>{const n=void 0!==e&&e>t,o=n?vv.a.CollapsePane_20:vv.a.ExpandPane_20,r=n?OfficeCommonStringsManager.get(OfficeCommonStringsEnum.TaskPaneResizeCollapseChatButton):OfficeCommonStringsManager.get(OfficeCommonStringsEnum.TaskPaneResizeExpandChatButton),i=n?"ResizeChatCollapse":"ResizeChatExpand";return{label:r,icon:o,onExecute:()=>{const t=[{name:"WindowWidth",int64:window.innerWidth}];e&&t.push({name:"ResizeWidth",int64:e}),Object(Rv.logUserAction)(i,void 0,void 0,void 0,void 0,void 0,t)}}}),Iv=Object(Jo.c)(()=>vv.a.ResizeGripperColumn_16),Fv=Object(Jo.c)(()=>{const e=vv.a.ArrowForwardWhite_16;return{label:OfficeCommonStringsManager.get(OfficeCommonStringsEnum.TaskPaneOptionFlyoutAnchor),icon:e}}),Bv=Object(Jo.c)(()=>{const e=vv.a.Pane_resizing_20;return{label:OfficeCommonStringsManager.get(OfficeCommonStringsEnum.TaskPaneResizeButton),icon:e}}),Mv=Object(Jo.c)((e,t,n,o,r,i)=>({icon:e.closeIcon,label:t.closeLabel,onExecute:r?Nv(n,r,i):Object(xv.a)(n,i),onTabKeyDown:o})),jv=Object(Jo.c)((e,t,n,o)=>{var r;return{icon:vv.a.BackFluentM22_24,label:null!==(r=Object(Fr.a)().navigationPaneCloseLabel)&&void 0!==r?r:"",onExecute:n?Nv(e,n,o):Object(xv.a)(e,o),onTabKeyDown:t}}),Ov=Object(Jo.c)(()=>({icon:"Back",label:OfficeCommonStringsManager.get(OfficeCommonStringsEnum.AddinSharingActionButtonLabel),onExecute:Wv()})),Lv=Object(Jo.c)((e,t)=>({icon:"Send",label:OfficeCommonStringsManager.get(OfficeCommonStringsEnum.AddinSharingShareButtonLabel),onExecute:Wv(t),onTabKeyDown:e})),Av=Object(Jo.c)((e,t,n)=>o=>{let r=o;if(t&&t===o){if(e)return;r=void 0}n&&Gv(n)?Object(wc.a)([Object(vc.g)(r),Object(vc.e)(n)]):Object(wc.a)(Object(vc.g)(r))}),Nv=Object(Jo.c)((e,t,n)=>o=>{t(()=>{Object(xv.a)(e,n)(o)})}),Wv=Object(Jo.c)(e=>t=>{e&&e(t),Object(wc.a)(Object(vc.i)(t))}),zv=Object(Jo.c)((e,t,n,o)=>r=>{if(n&&n(e,r),t&&t(r),o&&Gv(o)&&Object(wc.a)(Object(vc.e)(o,e)),"FindReplaceTaskPane"!==e){const t=e+":PaneOpen:Start",n=e+":PaneOpen:End";Object(yc.a)(n,t),Object(yv.b)()&&(window.performance.clearMarks(t),window.performance.clearMarks(n))}}),Hv=Object(Jo.c)((e,t,n,o)=>r=>{n&&n(e,r),t&&t(r),o&&Gv(o)&&Object(wc.a)(Object(vc.e)(o))}),Vv=Object(Jo.c)((e,t,n)=>o=>{n&&n(e,o),t&&t(o)}),Uv=Object(Jo.c)((e,t,n,o)=>r=>{o&&o(e,r,t),n&&n(r,t)}),Gv=e=>Object(fv.p)(e);var qv=n(179);const Qv=Object(Jo.c)((e,t,n)=>(o,r)=>{t&&Object(fv.p)(t)?e(Object(qv.batchActions)([Object(vc.k)(o,r),Object(vc.e)(t,o)])):e(Object(vc.k)(o,r)),n&&n()});var Kv=n(2624);const Jv=Object(Ic.connect)((e,t)=>{Object(Rx.j)("TabbedTaskPaneGroup");const n=_object_spread_props(_object_spread({},kv(e,t)),{innerRef:t.innerRef,styles:t.styles,indicatorStyles:t.indicatorStyles,onOverflowMenuClose:t.onOverflowMenuClose,onOverflowMenuOpen:t.onOverflowMenuOpen,onResizeStart:t.onResizeStart,getGroupAdaptiveLayoutStyles:t.getGroupAdaptiveLayoutStyles,stretchWidthToContainer:t.stretchWidthToContainer,resizeStrings:t.resizeStrings,getSplashPageContent:t.getSplashPageContent,addVerticalScrollSpace:t.addVerticalScrollSpace,onTabStripFocus:t.onTabStripFocus,id:"TabbedTaskPaneGroupProps",useReducedAnimations:t.useReducedAnimations,useBorderLessTaskPaneContainer:t.useBorderLessTaskPaneContainer});return Object(Rx.j)("TabbedTaskPaneGroup","NonCached"),n},(e,t)=>{Object(Rx.h)("TabbedTaskPaneGroup");const n=_object_spread({},((e,t)=>({onResizeEnd:Qv(e,t.middleContainer,t.onResizeEnd)}))(e,t));return Object(Rx.h)("TabbedTaskPaneGroup","NonCached"),n},(e,t)=>{Object(Rx.i)("TabbedTaskPaneGroup");const n=_object_spread({},e,t);return Object(Rx.i)("TabbedTaskPaneGroup","NonCached"),n},{areStatesEqual:Object(Pc.c)("TabbedTaskPaneGroup")})(Object(Dc.a)(bv));class Yv extends R.PureComponent{focus(){var e;null===(e=this.tabbedTaskPaneGroup)||void 0===e||null===(e=e.current)||void 0===e||e.focus()}focusResizeHandle(){var e;null===(e=this.tabbedTaskPaneGroup)||void 0===e||null===(e=e.current)||void 0===e||e.focusResizeHandle()}render(){return R.createElement(Kv.a,null,R.createElement(Jv,_object_spread({innerRef:this.tabbedTaskPaneGroup},this.props)))}constructor(){super(...arguments),this.tabbedTaskPaneGroup=R.createRef()}}var Zv=n(264);const $v=Object(Jo.c)(()=>({resizeCurrentValue:OfficeCommonStringsManager.get(OfficeCommonStringsEnum.TaskPaneResizeCurrentValue),resizeLabel:OfficeCommonStringsManager.get(OfficeCommonStringsEnum.TaskPaneResize),resizeMaxValue:OfficeCommonStringsManager.get(OfficeCommonStringsEnum.TaskPaneResizeMaxValue),resizeMinValue:OfficeCommonStringsManager.get(OfficeCommonStringsEnum.TaskPaneResizeMinValue),resizeModeOff:OfficeCommonStringsManager.get(OfficeCommonStringsEnum.TaskPaneResizeModeOff),resizeModeOn:OfficeCommonStringsManager.get(OfficeCommonStringsEnum.TaskPaneResizeModeOn)}));var Xv,eR,tR=n(712),nR=n(2629);class oR extends R.PureComponent{focus(){var e;null===(e=this.tabbedContainer)||void 0===e||null===(e=e.current)||void 0===e||e.focus()}focusResizeHandle(){var e;null===(e=this.tabbedContainer)||void 0===e||null===(e=e.current)||void 0===e||e.focusResizeHandle()}render(){const e=tR.a;return R.createElement(nR.a,{className:Object(F.eb)({fontFamily:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.UserInterfaceFontName),fontSize:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.UserInterfaceFontSize)})},R.createElement(Ic.Provider,{store:Zv.a},R.createElement(e,{as:"span"},R.createElement(Yv,_object_spread_props(_object_spread({ref:this.tabbedContainer},this.props),{useReducedAnimations:this.isReducedTransitionAnimationsEnabled||void 0,resizeStrings:$v(),defaultTabStripIcon:c.a.AppForOfficeLogo_20,resizeHandleIcon:be.a.PaneResizingGrabber_32,styles:{root:{position:"relative",borderLeftColor:"#e0e0e0"}},indicatorStyles:{root:{backgroundColor:Object(b.a)().primary}}})))))}constructor(e){super(e),this.tabbedContainer=R.createRef(),Object(Ev.b)(Po.a),Object(Fr.b)(Object(f.a)()),this.isReducedTransitionAnimationsEnabled=Object(x.getBooleanFeatureGate)("Microsoft.Office.Excel.RemoveTaskPaneAnimations",!1)}}function rR(e,t,n,o){return _object_spread({id:e,title:t,width:n},o)}function iR(e,t){switch(t){case"CopilotSDXTaskpane":case"DataCleansingSDXTaskpaneIcon":return"XLCoPilot_24";default:return}}let aR;!function(e){e[e.Leading=0]="Leading",e[e.Trailing=1]="Trailing",e[e.InBetween=2]="InBetween"}(Xv||(Xv={})),function(e){e[e.DataCleansingBad=0]="DataCleansingBad",e[e.DataCleansingSelectedCell=1]="DataCleansingSelectedCell"}(eR||(eR={}));const sR=[],lR=[],cR=R.createRef();let uR;const dR=e=>{switch(e.type){case"ExcelLegacyTaskPaneWacInfraProps":return!!e.isSharedRuntime;default:return!1}},pR=(e,t)=>function(n){n(Object(qv.batchActions)([Object(vc.a)(hR(e,t)),Object(vc.b)(e,t.location)]))},gR=e=>function(t){t(Object(vc.g)(e))},hR=(e,t)=>{const{title:n,width:o}=t,r=_object_without_properties(t,["title","width"]),i=()=>function(e,t,n){return R.createElement("div",{id:"ExcelTaskPaneContentWrapper",style:{position:"relative",height:"100%",overflowX:"hidden"}},function(e,t,n){switch(t.type){case"AccCheckerTaskPaneProps":return R.createElement(Iy.AccCheckerTaskPane,_object_spread_props(_object_spread({taskPaneId:e,setFocusCallback:n},_object_spread({},t)),{pivotIcons:{error:m.a.CancelRequest_16,warning:m.a.Risks_16,tips:be.a.Lightbulb_16,intelligentServices:g.a.LightningIdeasHandraiseState_20,chevron:Object(ue.a)()?c.a.CommonControlChevronLeft_16:c.a.CommonControlChevronRight_16},appColors:Object(b.a)(),violationToControlId:{},fixItMenuControlRendererFunction:Object(Lc.a)(Po.a,Object(cl.c)(Po.a,Object(Fr.a)()))}));case"ConditionalFormattingTaskPaneProps":return R.createElement(Iy.ConditionalFormattingTaskPane,_object_spread({taskPaneId:e,setFocusCallback:n},t));case"DataCleansingTaskPaneProps":case"DataCleansingStatefulTaskPaneProps":return R.createElement(Iy.DataCleansingTaskPane,_object_spread({taskPaneId:e,setFocusCallback:n},t));case"EmbeddedTaskPaneProps":return R.createElement(Iy.EmbeddedTaskPane,_object_spread({},t));case"ExcelLegacyTaskPaneWacInfraProps":return R.createElement(Iy.ExcelLegacyTaskPaneWacInfra,_object_spread({},t));case"ExternalLinksTaskPaneProps":return R.createElement(Iy.ExternalLinksTaskPane,_object_spread({taskPaneId:e,setFocusCallback:n},t));case"FieldListTaskPaneProps":return R.createElement(Iy.FieldListTaskPane,_object_spread({},t));case"FormatCellsTaskPaneProps":return R.createElement(Iy.FormatCellsTaskPane,_object_spread({taskPaneId:e,setFocusCallback:n},t));case"NameManagerTaskPaneProps":return R.createElement(Iy.NameManagerTaskPane,_object_spread({taskPaneId:e,setFocusCallback:n},t));case"LoadBlockingFloatingObjectsTaskPaneProps":return R.createElement(Iy.LoadBlockingFloatingObjectsTaskPane,_object_spread({taskPaneId:e,setFocusCallback:n},t));case"PivotTableSettingsTaskPaneProps":return R.createElement(Iy.PivotTableSettingsTaskPane,_object_spread({},t));case"PowerQueryTaskPaneProps":return R.createElement(Iy.PowerQueryTaskPane,_object_spread({},t));case"SlicerSettingsTaskPaneProps":return R.createElement(Iy.SlicerSettingsTaskPane,_object_spread({},t));case"SpellCheckTaskPaneProps":return R.createElement(Iy.SpellCheckTaskPane,_object_spread({taskPaneId:e,setFocusCallback:n},t));case"SharedCommentsTaskPaneProps":return R.createElement(Iy.SharedCommentsTaskPane,_object_spread({taskPaneId:e,setFocusCallback:n},t));case"OcvFeedbackTaskPaneProps":return R.createElement(Jf,_object_spread({},t));case"WorkbookOptimizationTaskPaneProps":return R.createElement(R.Suspense,{fallback:R.createElement(le.a,{styles:Object(F.db)({root:{height:"100%"},shimmerWrapper:{height:"100%"}})})},R.createElement(Iy.WorkbookOptimizationTaskPane,_object_spread({taskPaneId:e,setFocusCallback:n},t)));default:throw new Error("Rendering an unspecified TaskPane Type. Trying to render pane with id: "+e+" , props.type: "+t.type)}}(e,t,n))}(e,t.contentProps,aR);if(Object(x.isChangeGateEnabled)("OfficeVSO:5706321_SDXTaskpaneIconIdOverride")){let a=null;return t.iconId?a=Fy(t.contentProps,t.iconId):t.iconUrl?(a=Object(w.a)(t.iconUrl),T.a.registerAddinIcon(a,t.iconUrl)):a=Fy(t.contentProps,e),Object(x.isChangeGateEnabled)("OfficeVSO:7904707_SDXTaskPaneHeaderIconSupport")?rR(e,n,o,_object_spread({renderContent:i,icon:a,headerIconId:iR(t.contentProps,t.iconId||""),isPersistedTaskPane:sR.indexOf(e)>=0||dR(t.contentProps),hidePersistedPaneInitially:lR.indexOf(e)>=0},r)):rR(e,n,o,_object_spread({renderContent:i,icon:a,isPersistedTaskPane:sR.indexOf(e)>=0||dR(t.contentProps),hidePersistedPaneInitially:lR.indexOf(e)>=0},r))}let a="";return t.iconUrl&&(a=Object(w.a)(t.iconUrl),T.a.registerAddinIcon(a,t.iconUrl)),Object(x.isChangeGateEnabled)("OfficeVSO:7904707_SDXTaskPaneHeaderIconSupport")?rR(e,n,o,_object_spread({renderContent:i,icon:t.iconUrl?a:Fy(t.contentProps,e),headerIconId:iR(t.contentProps,t.iconId||""),isPersistedTaskPane:sR.indexOf(e)>=0||dR(t.contentProps),hidePersistedPaneInitially:lR.indexOf(e)>=0},r)):rR(e,n,o,_object_spread({renderContent:i,icon:t.iconUrl?a:Fy(t.contentProps,e),isPersistedTaskPane:sR.indexOf(e)>=0||dR(t.contentProps),hidePersistedPaneInitially:lR.indexOf(e)>=0},r))},mR={renderTaskPaneGroups:function(e,t,n){uR=n.middleContainer,jy.b.register("taskPaneDataModel",Ky),Object(x.isChangeGateEnabled)("OfficeVSO:8362208_ActiveControlsInTaskPaneModel")&&Object(By.b)(),aR=n.setFocusCallback,t&&k.render(R.createElement(oR,_object_spread({ref:cR,location:D.a.Right},n)),t)},showTaskPane:function(e,t){Object(_.a)(e+":PaneOpen:Start"),Object(cC.a)([pR(e,t),gR(e)])},updateTaskPane:function(e,t){Object(cC.a)(Object(vc.a)(hR(e,t)))},hideTaskPane:function(e,t){Object(cC.a)(Object(vc.d)(e,t))},doNotUse_InitializePersistedTaskPane:function(e,t){sR.indexOf(e)<0&&sR.push(e),Object(cC.a)(pR(e,t))},focusTabbedTaskPaneArea:function(){var e;null==cR||null===(e=cR.current)||void 0===e||e.focus()},setSelectedTaskPane:function(e){uR&&Gv(uR)?Object(cC.a)([gR(e),Object(vc.e)(uR,e)]):Object(cC.a)(gR(e))},selectors:Object(fv.m)(Zv.a),focusResizeHandle:function(){var e;null==cR||null===(e=cR.current)||void 0===e||e.focusResizeHandle()},initializeHiddenSharedRuntimeTaskPane:function(e,t){lR.indexOf(e)<0&&lR.push(e),Object(cC.a)(pR(e,t))},actions:{setTaskpaneHideHeader:vc.h,expandCollapseTaskPaneFromResizeButton:vc.c,resizeTaskPane:vc.f}};var bR=n(59),fR=n(2634),xR=n(162),ER=n(95),SR=n(830);class yR extends R.PureComponent{render(){return R.createElement(SR.a,_object_spread_props(_object_spread({},this.props),{bodyRendererFunction:this.bodyRendererFunction,resultHandler:this.colorPickerDialogResultHandler,styles:{root:{selectors:{".ms-Button-label":{textAlign:"center",minWidth:"86px"}}},main:{}}}))}constructor(e){super(e),this.baseResultHandler=this.props.resultHandler,this.bodyRendererFunction=()=>{const{redLabel:e,blueLabel:t,greenLabel:n,hexLabel:o,alphaLabel:r,alphaSliderType:i,alphaAriaLabel:a,hueAriaLabel:s,transparencyAriaLabel:l,svAriaLabel:c,hexError:u,alphaError:d,transparencyError:p,redError:g,greenError:h,blueError:m}=this.props.bodyControls;return R.createElement(fR.a,{color:this.selectedColor,onChange:this.updateColor,showPreview:!0,alphaType:i||"none",styles:{panel:{padding:12},root:{width:352,maxWidth:352},colorRectangle:{height:268,marginBottom:"12px"},flexContainer:{marginBottom:"12px"},colorSquare:{marginLeft:"12px"}},strings:{red:e,blue:t,green:n,hex:o,alpha:r,alphaAriaLabel:a,hueAriaLabel:s,transparencyAriaLabel:l,svAriaLabel:c,hexError:u,alphaError:d,transparencyError:p,redError:g,greenError:h,blueError:m}})},this.updateColor=(e,t)=>{this.selectedColor=t},this.colorPickerDialogResultHandler=e=>{const t={};e===ER.a.Ok&&(t.selectedColorText=this.selectedColor.hex,this.props.bodyControls.alphaSliderType&&"none"!==this.props.bodyControls.alphaSliderType&&(t.alphaValue=this.selectedColor.a)),this.baseResultHandler(e,t)},this.selectedColor=e.bodyControls.initColor&&Object(xR.a)(e.bodyControls.initColor)||Object(xR.a)("#ffffff"),null!=e.bodyControls.alpha&&void 0!==e.bodyControls.alpha&&(this.selectedColor.a=e.bodyControls.alpha)}}var CR=n(270);const vR={paddingTop:20},RR={flexDirection:"column",width:435},kR={paddingTop:16},TR={paddingTop:20,display:"flex",justifyContent:"space-between"},_R={paddingTop:5},wR={root:{width:15,height:15}};class DR extends R.PureComponent{render(){return R.createElement(SR.a,_object_spread_props(_object_spread({},this.props),{bodyRendererFunction:this.bodyRendererFunction,resultHandler:this.props.resultHandler,dialogButtonsOption:ER.b.None}))}renderNoClipboardAccessDialog(e){const{startText:t,endText:n,cutText:o,copyText:r,pasteText:i,cutShortcutText:a,copyShortcutText:s,pasteShortcutText:l,learnMoreLink:c,imageAltText:u,imageSrc:d,imageAltText_2:p,imageSrc_2:g,primaryButtonLabel:h}=this.props.bodyControls,m=Object(x.isChangeGateEnabled)("Microsoft.Office.SharedOnline.ChangeGate.UpdateIconInPasteDialog")?vv.a.ViewSiteInformation_16:vv.a.LockGlyph_24x_24;return R.createElement("div",{style:RR},R.createElement("div",null,t," [",R.createElement(fe.a,{iconName:m,"aria-hidden":!0,styles:wR}),"] ",n),null!=g?R.createElement("img",{src:g,style:kR,alt:p}):R.createElement("div",{style:vR},R.createElement("div",null,R.createElement("b",null,o)," - ",a," | ",R.createElement("b",null,r)," -"," ",s," | ",R.createElement("b",null,i)," - ",l)),R.createElement("img",{src:d,style:kR,alt:u}),R.createElement("div",{style:TR},R.createElement("div",{style:_R},R.createElement(Mu.a,_object_spread_props(_object_spread({},c),{type:"AppLinkProps",id:"learnMoreLink"}))),R.createElement(Ko.a,{id:"okButton",label:h,type:"AppButtonProps",onExecute:this.onClickHandler,styles:e.primaryButton})))}onClickHandler(e){this.props.resultHandler(ER.a.Ok)}constructor(e){super(e),this.bodyRendererFunction=()=>R.createElement(we.a,null,e=>{const t=Object(CR.h)(e,this.props.sharedDialogStyles);return this.renderNoClipboardAccessDialog(t)}),this.onClickHandler=this.onClickHandler.bind(this)}}const PR={fontSize:"28px"},IR=e=>{let t;return void 0!==e?(t=e,t.title=Object(F.eb)(e.title,PR)):t={title:PR},t};class FR extends R.PureComponent{render(){return R.createElement(SR.a,_object_spread_props(_object_spread({},this.props),{bodyRendererFunction:this.bodyRendererFuction,sharedDialogStyles:IR(this.props.sharedDialogStyles),maxWidth:450,focusDefaultButtonWhenOpened:!0}))}constructor(){super(...arguments),this.bodyRendererFuction=()=>{const{extensionStartText:e,extensionLink:t,extensionEndText:n,shortcutsMessageText:o,cutText:r,copyText:i,pasteText:a,pasteTextOnly:s}=this.props.bodyControls;return R.createElement("div",{style:{flexDirection:"column"}},R.createElement("div",{style:{fontWeight:600,fontSize:"16px"}},R.createElement("span",null,e),t&&R.createElement("span",null,R.createElement(Mu.a,_object_spread_props(_object_spread({},t),{shouldTakeFocus:!1}))),n&&R.createElement("span",null,n)),R.createElement("div",{style:{paddingTop:"20px",paddingBottom:"6px",fontSize:"14px"}},o),R.createElement("div",{style:{fontWeight:600,fontSize:"14px"}},R.createElement("div",null,r),R.createElement("div",null,i),R.createElement("div",null,a),R.createElement("div",null,s)))}}}class BR extends R.PureComponent{render(){return R.createElement(SR.a,_object_spread_props(_object_spread({},this.props),{bodyRendererFunction:this.bodyRendererFuction}))}constructor(){super(...arguments),this.bodyRendererFuction=()=>{const{forwardElementText:e,cutText:t,copyText:n,pasteText:o,pasteTextOnly:r,extensionLink:i,suggestionPrefixElement:a,suggestionSuffixElement:s}=this.props.bodyControls;return R.createElement("div",{style:{flexDirection:"column"}},R.createElement("div",null,e),R.createElement("div",{style:{fontWeight:"bold",paddingTop:"20px"}},R.createElement("div",null,t),R.createElement("div",null,n),R.createElement("div",null,o),r&&R.createElement("div",null,r)),i&&R.createElement("div",{style:{paddingTop:"20px"}},a&&R.createElement("span",null,a),R.createElement("span",null,R.createElement(Mu.a,_object_spread({},i))),s&&R.createElement("span",null,s)))}}}const MR=()=>({containingDivStyles:{width:CR.a},displayLinkInput:{field:["txtDisplay"],subComponentStyles:{label:{root:{fontWeight:F.l.semibold}}}},addressLinkInput:{field:["txtLink"],subComponentStyles:{label:{root:{fontWeight:F.l.semibold,paddingTop:8}}}}}),jR=Object(Jo.c)(e=>({pivot:{root:{marginTop:"18px",marginBottom:"20px"}},enterLink:{wrapper:{width:"65px",height:"16px"},pivotHeader:{root:{fontFamily:"Segoe UI",fontSize:"12px",lineHeight:"14px",background:"transparent",padding:"0px 0px"},rootHovered:{color:e.palette.black,background:"transparent"}},selectedPivotHeader:{root:{background:"transparent",color:e.palette.black},rootHovered:{color:e.palette.black,background:"transparent"}},indicator:{margin:"0px 10%",width:"80%",top:"-6px",position:"relative",background:e.palette.themeDark}},thisDocument:{wrapper:{minwidth:"150px",height:"16px",paddingLeft:"10px"},pivotHeader:{root:{background:"transparent",fontFamily:"Segoe UI",fontSize:"12px",lineHeight:"14px",padding:"0px 0px"},rootHovered:{background:"transparent",color:e.palette.black}},selectedPivotHeader:{root:{background:"transparent",color:e.palette.black},rootHovered:{background:"transparent",color:e.palette.black}},indicator:{margin:"0px 10%",width:"75%",insetInlineStart:"5px",top:"-6px",position:"relative",background:e.palette.themeDark}}})),OR=Object(Jo.c)(()=>({addressLinkInput:{root:{marginTop:"15px",marginBottom:"15px"},fieldGroup:{minHeight:"30px"},field:["txtLink",{height:"30px",overflow:"hidden",whiteSpace:"nowrap"}]}})),LR=Object(Jo.c)(e=>({backgroundColor:e.palette.white,height:"130px",boxSizing:"border-box",border:"1px solid "+e.palette.neutralQuaternary,borderRadius:"2px",marginTop:"15px",marginBottom:"15px",overflow:"auto"})),AR=Object(Jo.c)(()=>Object(F.db)({root:{overflowY:"auto"},focusZone:{maxWidth:"100%"}})),NR=Object(Jo.c)(()=>Object(F.db)({headerCount:{display:"none"},groupHeaderContainer:{marginLeft:"-48px"},title:{cursor:"default"}})),WR=Object(Jo.c)(e=>Object(F.db)({root:{width:"calc(100% - 0px)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",display:"inline-block",color:e.palette.black},fields:{marginTop:"-12px",marginLeft:"36px",selectors:{":hover":{overflowX:"auto",display:"block"},":focus":{overflowX:"auto",display:"block"}}}})),zR=Object(Jo.c)(e=>({contextualHelpTextStyle:Object(F.eb)({marginLeft:50,fontFamily:"'Segoe UI', 'Segoe UI Web (West European)', Arial, Verdana, 'Sans-Serif'",fontSize:14,lineHeight:20,color:e.palette.neutralSecondaryAlt}),showMeHowStyle:Object(F.eb)({paddingLeft:"0 !important",border:"none !important",color:e.palette.themePrimary+" !important",fontWeight:"400 !important",backgroundColor:e.palette.white+" !important",selectors:{":hover":{textDecoration:"underline",backgroundColor:e.palette.white+" !important"}}})}));var HR=n(2546);const VR={main:{position:"relative",top:"30% !important",visibility:"hidden"},root:{}};class UR extends R.PureComponent{getPivotHeaders(e){const t=jR(e);return[{id:this.enterLinkTab,title:this.enterLinkTabTxtDisplay,styles:t.enterLink},{id:this.thisDocumentTab,title:this.thisDocumentTabTxtDisplay,styles:t.thisDocument}]}renderTabPanel(e){const{currentlySelectedPivotId:t}=this.state,n=jR(e);return R.createElement("div",null,R.createElement($C.a,{styles:n.pivot,componentRef:this.pivot,selectedPivotId:t,overflowMenuLauncherLabel:"More Tabs",topLevelItems:this.getPivotHeaders(e),onPivotHeaderExecute:this.onPivotItemClicked,displayTabIndicatorPlaceholder:!0,onPivotHeaderFocus:this.onPivotItemClicked}),t===this.thisDocumentTab?this.renderThisDocumentTabPanel(e):this.renderEnterLinkTabPanel())}renderEnterLinkTabPanel(){const e=OR();return R.createElement(Xd.a,{type:"AppInputProps",id:this.txtLink,defaultValue:this.textLinkValue,autoComplete:"off",spellCheck:!1,styles:e.addressLinkInput,onChange:this.onTextLinkChange,selectTextOnFocus:!0,inputType:"url",multiline:!1,resizable:!1,label:this.enterLinkTabTxtDisplay,hideLabel:!0})}renderThisDocumentTabPanel(e){return R.createElement("div",{style:LR(e)},this.populateList(this.items,this.groups,this.selection,e))}populateList(e,t,n,o){const r={headerProps:{styles:NR()},onRenderHeader:e=>this.onRenderGroupHeader(e,o),showEmptyGroups:!0};return R.createElement(yd.a,{selection:n,selectionMode:_u.d.single,isSelectedOnFocus:!0},R.createElement(zm.a,{items:e,groups:t,listProps:{onShouldVirtualize:()=>!1},selection:n,compact:!0,selectionMode:_u.d.single,groupProps:r,componentRef:this.groupedResultsList,onRenderCell:(e,t,n)=>this.onRenderCell(o,e,t,n),styles:AR(),focusZoneProps:{shouldRaiseClicks:!1}}))}renderAddressLinkAppInput(){const{addressLabel:e,txtLink:t}=this.props.bodyControls,n=MR();return R.createElement(Xd.a,{type:"AppInputProps",id:this.txtLink,defaultValue:t||void 0,autoComplete:"off",spellCheck:!1,styles:n.addressLinkInput,onChange:this.onTextLinkChange,selectTextOnFocus:!0,label:e,inputType:"url"})}render(){let e=void 0;return this.props.actionButtonProps&&(e=_object_spread_props(_object_spread({},this.props.actionButtonProps),{disabled:this.state.isCurrentTextLinkEmpty&&!this.state.isAnyItemInDocumentTabSelected})),R.createElement(SR.a,_object_spread_props(_object_spread({},this.props),{actionButtonProps:e,bodyRendererFunction:this.bodyRendererFunction,resultHandler:this.insertLinkDialogResultHandler,firstFocusableSelector:this.props.bodyControls.textDisplayInitialFocus?"txtDisplay":"txtLink",styles:VR,settings:{pinBehaviorIsEnabled:!0}}))}constructor(e){if(super(e),this.baseResultHandler=this.props.resultHandler,this.textDisplayValue="",this.textLinkValue="",this.txtDisplay="txtDisplay",this.txtLink="txtLink",this.thisDocumentTabHeadings="ThisDocumentTabHeadings",this.thisDocumentTabBookmarks="ThisDocumentTabBookmarks",this.isTabPanelEnabled=!1,this.enterLinkTabTxtDisplay="",this.thisDocumentTabTxtDisplay="",this.pivot=R.createRef(),this.enterLinkTab="InsertLinkDialog-EnterLinkTab",this.thisDocumentTab="InsertLinkDialog-ThisDocumentTab",this.items=[],this.groups=[],this.columns=[],this.groupedResultsList=R.createRef(),this.state={currentlySelectedPivotId:this.enterLinkTab,isCurrentTextLinkEmpty:""===this.textLinkValue,isAnyItemInDocumentTabSelected:!1},this.onPivotItemClicked=e=>{this.setState({currentlySelectedPivotId:e}),e===this.enterLinkTab?this.setState({isAnyItemInDocumentTabSelected:!1,isCurrentTextLinkEmpty:""===this.textLinkValue}):e===this.thisDocumentTab&&(this.syncStateWithSelection(),this.setState({isCurrentTextLinkEmpty:!0}))},this.syncStateWithSelection=()=>{const e=this.selection.getSelection().length>0;this.setState({isAnyItemInDocumentTabSelected:e})},this.onGroupHeaderClick=e=>{e.onToggleCollapse&&e.group&&e.onToggleCollapse(e.group)},this.onGroupHeaderKeyDown=(e,t)=>{"Enter"!==e.key&&" "!==e.key||(e.stopPropagation(),e.preventDefault(),this.onGroupHeaderClick(t))},this.onRenderGroupHeader=(e,t)=>{var n,o;const{group:r}=e,l=this.props.bodyControls.emptyHeadingsGroup,c=this.props.bodyControls.emptyBookmarksGroup,u=r&&0===r.count&&!r.isCollapsed;let d;u&&(null==r?void 0:r.key)===this.thisDocumentTabHeadings&&i.a.sendTraceTag(507115210,a.a.msoulscat_Wac_WordViewer,s.a.Info,"Empty group headings shown in InsertLinkDialog."),(null==r?void 0:r.key)===this.thisDocumentTabHeadings?d=l:(null==r?void 0:r.key)===this.thisDocumentTabBookmarks&&(d=c);const p=zR(t);return R.createElement("div",null,R.createElement("div",{onClick:()=>this.onGroupHeaderClick(e),onKeyDown:t=>this.onGroupHeaderKeyDown(t,e)},R.createElement(nx.a,_object_spread_props(_object_spread({},e),{expandButtonIcon:"",useFastIcons:!1,indentWidth:0,selected:!1,isSelected:!1}))),d&&u&&R.createElement("div",{className:p.contextualHelpTextStyle},d.firstHelpText,null===(n=d.secondHelpText)||void 0===n?void 0:n.split("{0}")[0],R.createElement("span",{style:{fontWeight:F.l.bold}},d.placeHolderHomeString," > ",d.placeHolderStylesString),null===(o=d.secondHelpText)||void 0===o?void 0:o.split("{0}")[1],(null==l?void 0:l.showMeHowButtonString)&&(null==r?void 0:r.key)===this.thisDocumentTabHeadings&&R.createElement("div",null,R.createElement(HR.a,{className:p.showMeHowStyle,onExecute:this.onHeadingsGroupShowMeHowClick,label:l.showMeHowButtonString,type:"AppButtonProps",id:"LinkDialogShowMeHowButton"}))))},this.onHeadingsGroupShowMeHowClick=()=>{this.insertLinkDialogResultHandler(ER.a.SecondaryAction)},this.onRenderCell=(e,t,n,o)=>n&&"number"==typeof o&&o>-1?R.createElement(Tu.a,{columns:this.columns,groupNestingDepth:t,item:n,itemIndex:o,selection:this.selection,selectionMode:_u.d.single,compact:!0,checkboxVisibility:wh.a.hidden,styles:WR(e)}):null,this.bodyRendererFunction=()=>{const{displayTextLabel:e,txtDisplay:t,textDisplayDisabled:n}=this.props.bodyControls,o=MR();return R.createElement(we.a,null,r=>R.createElement("div",{style:o.containingDivStyles},R.createElement(Xd.a,{type:"AppInputProps",id:this.txtDisplay,defaultValue:t||void 0,autoComplete:"off",spellCheck:!1,styles:o.displayLinkInput,disabled:n,onChange:this.onTextDisplayChange,selectTextOnFocus:!0,label:e}),this.isTabPanelEnabled?this.renderTabPanel(r):this.renderAddressLinkAppInput()))},this.onTextDisplayChange=e=>{this.textDisplayValue=e||""},this.onTextLinkChange=e=>{this.textLinkValue=(null==e?void 0:e.trim())||"",this.setState({isCurrentTextLinkEmpty:""===this.textLinkValue})},this.insertLinkDialogResultHandler=e=>{let t={};const{currentlySelectedPivotId:n}=this.state;if(this.isTabPanelEnabled&&n===this.thisDocumentTab&&null!==this.selection&&0!==this.selection.count){const e=this.selection.getSelection()[0];t=e.isHeading?{txtDisplay:this.textDisplayValue,linkurl:e.linkurl,isHeading:!0,startCp:e.startCp,endCp:e.endCp,paragraphNode:e.paragraphNode}:{txtDisplay:this.textDisplayValue,linkurl:e.linkurl,isHeading:!1}}else t={txtDisplay:this.textDisplayValue,txtLink:this.textLinkValue};this.baseResultHandler(e,t)},this.textDisplayValue=e.bodyControls.txtDisplay||"",this.textLinkValue=e.bodyControls.txtLink||"",this.state.isCurrentTextLinkEmpty=""===this.textLinkValue,this.state.isAnyItemInDocumentTabSelected=!1,this.selection=new ku.a({onSelectionChanged:()=>this.syncStateWithSelection()}),e.bodyControls.insertInternalLinkEnabled&&(this.isTabPanelEnabled=!0,this.enterLinkTabTxtDisplay=e.bodyControls.enterLinkTabLabel||"",this.thisDocumentTabTxtDisplay=e.bodyControls.thisDocumentTabLabel||"",e.bodyControls.groupedList)){this.items=e.bodyControls.groupedList.items||[],this.groups=e.bodyControls.groupedList.groups||[],this.columns=[{key:"name",name:"Name",fieldName:"linkurl",minWidth:200,isResizable:!0}],this.selection.setItems(this.items,!0);const t=e.bodyControls.groupedList.selectedItem;if(t){const e=t.selectedIndex,n=t.selectedGroupId;this.selection.setIndexSelected(e,!0,!1),this.groups[n].isCollapsed=!1,this.state.currentlySelectedPivotId=this.thisDocumentTab}}}}class GR extends R.PureComponent{render(){return R.createElement(SR.a,_object_spread_props(_object_spread({},this.props),{bodyRendererFunction:this.bodyRendererFuction}))}constructor(){super(...arguments),this.bodyRendererFuction=()=>{const{errorMessage:e,errorFileDownloadOffer:t,helpLink:n,macOfficePreLinkText:o,macOfficeLink:r,macOfficePostLinkText:i}=this.props.bodyControls;return R.createElement("div",null,R.createElement("div",null,e),n&&R.createElement("div",{style:{marginTop:"16px"}},R.createElement(Mu.a,_object_spread({},n))),r?R.createElement("div",null,o&&R.createElement("span",null,o),R.createElement("span",null,R.createElement(Mu.a,_object_spread({},r))),i&&R.createElement("span",null,i)):R.createElement("div",{style:{marginTop:"16px"}},t))}}}class qR extends R.PureComponent{render(){return R.createElement(SR.a,_object_spread_props(_object_spread({},this.props),{bodyRendererFunction:this.bodyRendererFuction}))}constructor(){super(...arguments),this.bodyRendererFuction=()=>{const{errorMessage:e,errorFileDownloadOffer:t,helpLink:n}=this.props.bodyControls;return R.createElement("div",null,R.createElement("div",null,e),n&&R.createElement("div",{style:{marginTop:"16px"}},R.createElement(Mu.a,_object_spread({},n))),R.createElement("div",{style:{marginTop:"16px"}},t))}}}class QR extends R.PureComponent{render(){return R.createElement(SR.a,_object_spread_props(_object_spread({},this.props),{bodyRendererFunction:this.bodyRendererFuction}))}constructor(){super(...arguments),this.bodyRendererFuction=()=>{const{errorMessage:e,offerString:t,helpLink:n}=this.props.bodyControls;return R.createElement("div",null,R.createElement("div",null,e),R.createElement("div",{style:{marginTop:"16px"}},t),n&&R.createElement("div",null,R.createElement(Mu.a,_object_spread({},n))))}}}const KR="@media only screen and (max-width: 600px)",JR={gridColumn:"1",gridRow:"1","-ms-grid-row":"1","-ms-grid-column":"1"},YR={gridColumn:"2",gridRow:"1","-ms-grid-row":"1","-ms-grid-row-span":"1","-ms-grid-column":"2","-ms-grid-column-span":"1"},ZR={gridColumn:"1",gridRow:"2","-ms-grid-row":"2","-ms-grid-row-span":"1","-ms-grid-column":"1","-ms-grid-column-span":"1"},$R={display:"flex",paddingRight:0,paddingLeft:0,minWidth:228},XR=Object(Jo.c)(e=>({display:e?"inline-flex":"flex",marginRight:0,width:"100%"})),ek=Object(Jo.c)(e=>Object(F.eb)([JR,{paddingRight:e?40:0,selectors:{[KR]:{paddingRight:0}}}])),tk=Object(Jo.c)(e=>({labelStyles:{label:{fontWeight:"bold",lineHeight:"normal"},root:{padding:"15px 0 0 0"}},spinButtonStyles:{root:$R,labelWrapper:{flex:1,float:"none",marginLeft:10,marginRight:0,height:40},label:{lineHeight:"normal"},spinButtonWrapper:{flex:1}},comboBoxStyles:{container:XR(e),root:{flex:1,padding:0},textContainer:{paddingLeft:10,flex:1},label:{margin:0,lineHeight:"normal",minHeight:"initial"}},comboBoxOptionsStyles:{optionText:{fontSize:"inherit"}},containerStyles:{display:e?"-ms-grid":"grid"}}));var nk=n(1216);class ok extends R.PureComponent{render(){return R.createElement(SR.a,_object_spread_props(_object_spread({},this.props),{bodyRendererFunction:this.bodyRendererFunction,resultHandler:this.paragraphDialogResultHandler}))}constructor(e){super(e),this.didChangeSpecialIndentationComboBoxValue=!1,this.baseResultHandler=this.props.resultHandler,this.indentationNoneValue="0",this.bodyRendererFunction=()=>{const{alignmentComboBoxProps:e,hideGeneralOptions:t,specialIndentationComboBoxProps:n,hideIndentationOptions:o,lineSpacingComboBoxProps:r,hideSpacingOptions:i,beforeTextSpinButtonProps:a,afterTextSpinButtonProps:s,bySpinButtonProps:l,beforeSpacingSpinButtonProps:c,afterSpacingSpinButtonProps:u,atSpinButtonProps:d,generalLabelProps:p,indentationLabelProps:g,spacingLabelProps:h,contextualSpacingCheckboxProps:m}=this.state.bodyStateProps,b="undefined"!=typeof navigator?navigator:void 0,f=!(!b||!/rv:11.0/i.test(b.userAgent)),x=tk(f);return R.createElement("div",{style:x.containerStyles,className:(E=this.props.bodyProps.customContainerStyles,Object(F.eb)({gridTemplateColumns:"1fr 1fr",gridTemplateRows:"auto",gridColumnGap:"40px",selectors:{[KR]:{gridTemplateColumns:"1fr",gridTemplateRows:"1fr auto",gridColumnGap:"0"}}},E))},R.createElement("div",{id:"LeftGroup",className:ek(f)},!t&&p&&e&&R.createElement("div",{id:p.forId,"aria-labelledby":p.id,role:"group"},R.createElement(Yl.a,_object_spread_props(_object_spread({},p),{styles:x.labelStyles})),R.createElement(Wc.a,_object_spread_props(_object_spread({},e),{calloutHostLayerId:nk.a,onExecute:this.onAlignmentComboBoxExecute,styles:x.comboBoxStyles,optionStyles:x.comboBoxOptionsStyles}))),!o&&g&&R.createElement("div",{id:g.forId,"aria-labelledby":g.id,role:"group"},R.createElement(Yl.a,_object_spread_props(_object_spread({},g),{styles:x.labelStyles})),a&&R.createElement(fc.a,_object_spread_props(_object_spread({},a),{styles:x.spinButtonStyles,onExecute:this.onBeforeTextSpinButtonChange})),s&&R.createElement(fc.a,_object_spread_props(_object_spread({},s),{styles:x.spinButtonStyles,onExecute:this.onAfterTextSpinButtonChange})),n&&R.createElement(Wc.a,_object_spread_props(_object_spread({},n),{calloutHostLayerId:nk.a,onExecute:this.onIndentationComboBoxExecute,styles:x.comboBoxStyles,optionStyles:x.comboBoxOptionsStyles})),l&&R.createElement(fc.a,_object_spread_props(_object_spread({},l),{styles:x.spinButtonStyles,onExecute:this.onByTextSpinButtonChange})))),!i&&h&&R.createElement("div",{className:Object(F.eb)([YR,{selectors:{[KR]:ZR}}]),id:h.forId,"aria-labelledby":h.id,role:"group"},R.createElement(Yl.a,_object_spread_props(_object_spread({},h),{styles:x.labelStyles})),c&&R.createElement(fc.a,_object_spread_props(_object_spread({},c),{styles:x.spinButtonStyles,onExecute:this.onBeforeSpacingSpinButtonChange})),u&&R.createElement(fc.a,_object_spread_props(_object_spread({},u),{styles:x.spinButtonStyles,onExecute:this.onAfterSpacingSpinButtonChange})),r&&R.createElement(Wc.a,_object_spread_props(_object_spread({},r),{calloutHostLayerId:nk.a,onExecute:this.onLineSpacingComboBoxExecute,styles:x.comboBoxStyles,optionStyles:x.comboBoxOptionsStyles})),d&&R.createElement(fc.a,_object_spread_props(_object_spread({},d),{styles:x.spinButtonStyles,onExecute:this.onAtSpinButtonChange})),m&&R.createElement(bu.a,_object_spread_props(_object_spread({},m),{onExecute:this.onContextualSpacingCheckboxChange})),this.props.paginationRendererFunction&&this.props.paginationRendererFunction()));var E},this.paragraphDialogResultHandler=e=>{const t=_object_spread_props(_object_spread({},this.state.bodyStateProps),{didChangeSpecialIndentationComboBoxValue:this.didChangeSpecialIndentationComboBoxValue,keepWithNextCheckboxProps:this.props.keepWithNextCheckboxProps,widowOrphanCheckboxProps:this.props.widowOrphanCheckboxProps,keepTogetherCheckboxProps:this.props.keepTogetherCheckboxProps,pageBreakBeforeCheckboxProps:this.props.pageBreakBeforeCheckboxProps});this.baseResultHandler(e||ER.a.Cancel,t)},this.onAlignmentComboBoxExecute=e=>{"string"!=typeof e.newValue&&this.setState(t=>{const n=t.bodyStateProps.alignmentComboBoxProps?_object_spread_props(_object_spread({},t.bodyStateProps.alignmentComboBoxProps),{selectedKey:e.newValue.key}):void 0;return{bodyStateProps:_object_spread_props(_object_spread({},t.bodyStateProps),{alignmentComboBoxProps:n})}})},this.getIndentBySpinButtonValue=(e,t,n)=>e.key===this.indentationNoneValue?0:t&&t===this.indentationNoneValue?.5:n,this.onIndentationComboBoxExecute=e=>{this.didChangeSpecialIndentationComboBoxValue=!0,"string"!=typeof e.newValue&&this.setState(t=>{const n=t.bodyStateProps.specialIndentationComboBoxProps?_object_spread_props(_object_spread({},t.bodyStateProps.specialIndentationComboBoxProps),{selectedKey:e.newValue.key}):void 0,o=t.bodyStateProps.bySpinButtonProps&&t.bodyStateProps.specialIndentationComboBoxProps?_object_spread_props(_object_spread({},t.bodyStateProps.bySpinButtonProps),{value:this.getIndentBySpinButtonValue(e.newValue,t.bodyStateProps.specialIndentationComboBoxProps.selectedKey,t.bodyStateProps.bySpinButtonProps.value)}):void 0;return{bodyStateProps:_object_spread_props(_object_spread({},t.bodyStateProps),{bySpinButtonProps:o,specialIndentationComboBoxProps:n})}})},this.onLineSpacingComboBoxExecute=e=>{"string"!=typeof e.newValue&&this.setState(t=>{const n=e.newValue,o=t.bodyStateProps.lineSpacingComboBoxProps?_object_spread_props(_object_spread({},t.bodyStateProps.lineSpacingComboBoxProps),{selectedKey:n.key}):void 0;let r=void 0;if(t.bodyStateProps.atSpinButtonProps)switch(n.key){case"1.00":case"1.50":case"2.00":r=_object_spread_props(_object_spread({},t.bodyStateProps.atSpinButtonProps),{reservedValue:"",value:n.index,unitType:"None"});break;case"at least":case"exactly":r=_object_spread_props(_object_spread({},t.bodyStateProps.atSpinButtonProps),{reservedValue:void 0,value:12,unitType:"Point"});break;case"multiple":r=_object_spread_props(_object_spread({},t.bodyStateProps.atSpinButtonProps),{reservedValue:void 0,value:3,unitType:"None"})}return{bodyStateProps:_object_spread_props(_object_spread({},t.bodyStateProps),{lineSpacingComboBoxProps:o,atSpinButtonProps:r})}})},this.onBeforeTextSpinButtonChange=e=>{this.setState(t=>{const n=t.bodyStateProps.beforeTextSpinButtonProps?_object_spread_props(_object_spread({},t.bodyStateProps.beforeTextSpinButtonProps),{value:e.value,unitType:e.unitType}):void 0;return{bodyStateProps:_object_spread_props(_object_spread({},t.bodyStateProps),{beforeTextSpinButtonProps:n})}})},this.onAfterTextSpinButtonChange=e=>{this.setState(t=>{const n=t.bodyStateProps.afterTextSpinButtonProps?_object_spread_props(_object_spread({},t.bodyStateProps.afterTextSpinButtonProps),{value:e.value,unitType:e.unitType}):void 0;return{bodyStateProps:_object_spread_props(_object_spread({},t.bodyStateProps),{afterTextSpinButtonProps:n})}})},this.onByTextSpinButtonChange=e=>{this.setState(t=>{const n=t.bodyStateProps.bySpinButtonProps?_object_spread_props(_object_spread({},t.bodyStateProps.bySpinButtonProps),{value:e.value,unitType:e.unitType}):void 0,o=t.bodyStateProps.specialIndentationComboBoxProps&&t.bodyStateProps.specialIndentationComboBoxProps.selectedKey,r=t.bodyStateProps.specialIndentationComboBoxProps?_object_spread_props(_object_spread({},t.bodyStateProps.specialIndentationComboBoxProps),{selectedKey:e.value>0&&o===this.indentationNoneValue?"1":o}):void 0;return{bodyStateProps:_object_spread_props(_object_spread({},t.bodyStateProps),{bySpinButtonProps:n,specialIndentationComboBoxProps:r})}})},this.onBeforeSpacingSpinButtonChange=e=>{this.setState(t=>{if(t.bodyStateProps.beforeSpacingSpinButtonProps){const n=e.reservedValue?_object_spread_props(_object_spread({},t.bodyStateProps.beforeSpacingSpinButtonProps),{reservedValue:e.reservedValue,unitType:e.unitType}):_object_spread_props(_object_spread({},t.bodyStateProps.beforeSpacingSpinButtonProps),{value:e.value,unitType:e.unitType,reservedValue:void 0});return{bodyStateProps:_object_spread_props(_object_spread({},t.bodyStateProps),{beforeSpacingSpinButtonProps:n})}}return _object_spread({},t)})},this.onAfterSpacingSpinButtonChange=e=>{this.setState(t=>{if(t.bodyStateProps.afterSpacingSpinButtonProps){const n=e.reservedValue?_object_spread_props(_object_spread({},t.bodyStateProps.afterSpacingSpinButtonProps),{reservedValue:e.reservedValue,unitType:e.unitType}):_object_spread_props(_object_spread({},t.bodyStateProps.afterSpacingSpinButtonProps),{value:e.value,unitType:e.unitType,reservedValue:void 0});return{bodyStateProps:_object_spread_props(_object_spread({},t.bodyStateProps),{afterSpacingSpinButtonProps:n})}}return _object_spread({},t)})},this.onAtSpinButtonChange=e=>{this.setState(t=>{if(t.bodyStateProps.atSpinButtonProps&&t.bodyStateProps.lineSpacingComboBoxProps){const n="multiple"===t.bodyStateProps.lineSpacingComboBoxProps.selectedKey;let o=void 0;0===e.value&&void 0!==e.reservedValue||("None"===t.bodyStateProps.atSpinButtonProps.unitType?o="multiple":"Point"===t.bodyStateProps.atSpinButtonProps.unitType&&(o=t.bodyStateProps.lineSpacingComboBoxProps.selectedKey));const r=t.bodyStateProps.lineSpacingComboBoxProps?_object_spread_props(_object_spread({},t.bodyStateProps.lineSpacingComboBoxProps),{selectedKey:o}):void 0,i=e.reservedValue&&!n?_object_spread_props(_object_spread({},t.bodyStateProps.atSpinButtonProps),{reservedValue:e.reservedValue}):_object_spread_props(_object_spread({},t.bodyStateProps.atSpinButtonProps),{value:e.value,reservedValue:void 0});return{bodyStateProps:_object_spread_props(_object_spread({},t.bodyStateProps),{lineSpacingComboBoxProps:r,atSpinButtonProps:i})}}return _object_spread({},t)})},this.onContextualSpacingCheckboxChange=e=>{this.setState(t=>{const n=t.bodyStateProps.contextualSpacingCheckboxProps?_object_spread_props(_object_spread({},t.bodyStateProps.contextualSpacingCheckboxProps),{checked:e.checked}):void 0;return{bodyStateProps:_object_spread_props(_object_spread({},t.bodyStateProps),{contextualSpacingCheckboxProps:n})}})},this.state={bodyStateProps:e.bodyProps}}}class rk extends R.PureComponent{render(){return R.createElement(SR.a,_object_spread_props(_object_spread({},this.props),{bodyRendererFunction:this.bodyRendererFunction,maxWidth:400}))}constructor(){super(...arguments),this.bodyRendererFunction=()=>{const{spinnerProps:e}=this.props.bodyControls;return R.createElement("div",{className:Object(F.eb)({margin:"0 auto"})},R.createElement(gm.a,_object_spread_props(_object_spread({},e),{appColors:this.props.appColors,labelPosition:"bottom",customTooltip:OfficeCommonStringsManager.get(OfficeCommonStringsEnum.SpinnerFallbackTooltipLabel)})))}}}const ik=Object(Jo.c)(()=>({containingDivStyles:{width:CR.a},nameInput:{field:["nameInputField"],root:{minHeight:80},subComponentStyles:{label:{root:{fontWeight:F.l.semibold}}}}}));class ak extends R.PureComponent{render(){const e=this.props,{actionButtonProps:t}=e,n=_object_without_properties(e,["actionButtonProps"]);return R.createElement(SR.a,_object_spread_props(_object_spread({},n),{bodyRendererFunction:this.bodyRendererFunction,resultHandler:this.renameDialogResultHandler,firstFocusableSelector:"nameInputField",actionButtonProps:_object_spread_props(_object_spread({},t),{disabled:void 0!==this.state.inputError})}))}constructor(e){super(e),this.baseResultHandler=this.props.resultHandler,this.bodyRendererFunction=()=>{const{id:e,label:t,maxLength:n}=this.props.bodyProps.nameInputProps,o=ik();return R.createElement("div",{style:o.containingDivStyles},R.createElement(dv.a,{elementTimingId:"dialog",hidden:this.props.hidden,interactivityTrackerContext:"dialog-rename"}),R.createElement(Xd.a,{type:"AppInputProps",id:e,value:this.state.nameValue,autoComplete:"off",spellCheck:!1,label:t,styles:o.nameInput,onChange:this.onInputChange,maxLength:n,errorMessage:this.state.inputError}))},this.onInputChange=e=>{this.props.validateOnChange?this.setState({nameValue:e,inputError:this.getNameValidation(e)}):(this.setState({nameValue:e}),this.state.inputError&&this.setState({inputError:void 0}))},this.renameDialogResultHandler=e=>{const t={};e===ER.a.Ok?this.validateNameInput()&&(t.txtDocumentName=this.state.nameValue,this.baseResultHandler(e,t)):this.baseResultHandler(e,t)},this.validateNameInput=()=>{const e=this.getNameValidation(this.state.nameValue);return void 0===e||(this.setState({inputError:e}),!1)},this.getNameValidation=e=>{var t,n;return(null===(t=(n=this.props).getInputErrorIfInvalid)||void 0===t?void 0:t.call(n,e))||void 0},this.state={nameValue:e.bodyProps.nameInputProps.value||"",inputError:void 0}}}function sk(e){return R.createElement(ak,_object_spread_props(_object_spread({},e),{bodyProps:e.bodyControls}))}ak.defaultProps={validateOnChange:!0};const lk=Object(Jo.c)(()=>Object(F.eb)({padding:"10px 0",minWidth:360})),ck=Object(Jo.c)(()=>Object(F.eb)({width:0,height:0})),uk=Object(Jo.c)(e=>Object(F.eb)({borderColor:Object(ih.a)(e).inputBorderColor})),dk={root:{display:"inline-block",maxWidth:"15em"},label:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}};class pk extends R.PureComponent{render(){return R.createElement(SR.a,_object_spread_props(_object_spread({},this.props),{bodyRendererFunction:this.bodyRendererFunction,maxWidth:450}))}constructor(){super(...arguments),this.frameInitialized=!1,this.bodyRendererFunction=()=>{const{uploadButtonProps:e}=this.props.bodyControls;return R.createElement(we.a,null,t=>R.createElement("div",{className:lk()},R.createElement(Ko.a,_object_spread_props(_object_spread({},e),{id:"InsertFileDialogFileInput",type:"AppButtonProps",className:uk(t),ariaDescription:this.props.uploadStatusLabel})),R.createElement(Yl.a,{id:"InsertFileDialogFileInputLabel",type:"AppLabelProps",forId:"InsertFileDialogFileInput",label:this.props.uploadStatusLabel||"",styles:dk}),R.createElement("div",{ref:this.setFrameContainerRef,className:ck(),"aria-hidden":"true"})))},this.setFrameContainerRef=e=>{var t,n;e&&!this.frameInitialized&&(this.frameInitialized=!0,null===(t=(n=this.props).onFrameReady)||void 0===t||t.call(n,e))}}}const gk={controlBorderColor:Yo.a.gray60,controlFocusBorderColor:Yo.a.gray150,controlHoverBackgroundColor:Yo.a.gray20,primaryTextColor:Yo.a.gray180,secondaryTextColor:Yo.a.gray140,controlFocusBackgroundColor:Yo.a.gray20,controlSelectedBackgroundColor:Yo.a.gray30},hk=Object(Jo.c)(e=>{if(!Object(ix.c)())return gk;const t=Object(ih.a)(e);return{controlBorderColor:t.borderColor,controlFocusBorderColor:e.palette.neutralPrimary,controlHoverBackgroundColor:t.hoverBackgroundColor,primaryTextColor:t.textColor,secondaryTextColor:t.textSecondaryColor,controlFocusBackgroundColor:e.palette.neutralLighterAlt,controlSelectedBackgroundColor:t.selectedBackgroundColor}}),mk=e=>({suffix:{backgroundColor:"transparent"},fieldGroup:e?{borderRadius:"4px",paddingLeft:"10px"}:void 0}),bk={root:{height:14,width:14}},fk={root:{padding:"0px",marginTop:"16px"}},xk=e=>({root:{width:"100%",height:"auto",marginBottom:"2px",paddingLeft:"0px",paddingRight:"8px",borderRadius:e?"4px":void 0},flexContainer:{display:"block",alignItems:"start"}}),Ek=(e,t)=>{const n=hk(e);return{caretDownWrapper:{alignItems:"center",justifyContent:"center",display:"flex",width:"26px",boxSizing:"border-box",cursor:"pointer"},dropdownItemsWrapper:{selectors:{":focus":[ci.t]}},dropdown:{display:"flex",margin:"0px",padding:"0px",boxSizing:"border-box",alignItems:"center",borderRadius:t?"4px":"2px",borderColor:n.controlBorderColor,borderWidth:"1px",borderStyle:"solid",selectors:{[F.m]:_object_spread({color:"ButtonText",borderColor:"buttontext"},Object(F.S)()),":hover":[{backgroundColor:n.controlHoverBackgroundColor,selectors:{[F.m]:{outline:"2px dashed ButtonText",selectors:{"svg > path.OfficeIconColors_HighContrast":{fill:"highlightText"}}}}},ci.s,ci.n],":focus":[ci.s,ci.n,{borderColor:n.controlFocusBorderColor,selectors:{[F.m]:{outline:"2px dashed ButtonText",selectors:{"svg > path.OfficeIconColors_HighContrast":{fill:"highlightText"}}}}}]}},title:{boxSizing:"border-box",display:"block",position:"relative",cursor:"pointer",width:"100%",overflow:"hidden"},callout:{maxHeight:"550px",boxSizing:"border-box"},dropdownItem:{width:"100%",height:"100%",padding:"0px",margin:"0px",border:"1px solid transparent",borderRadius:"0px",selectors:{[F.m]:_object_spread({color:"ButtonText"},Object(F.S)()),":hover":[ci.s,ci.n,{color:n.primaryTextColor,backgroundColor:n.controlHoverBackgroundColor}],[ci.d]:[ci.n,{backgroundColor:n.controlHoverBackgroundColor,outline:"none"}],[ci.b]:[ci.n,{borderColor:n.controlFocusBorderColor,outline:"none"}],[ci.a]:[ci.s]}},dropdownItemSelected:{width:"100%",height:"100%",padding:"0px",margin:"0px",border:"1px solid transparent",borderRadius:"0px",backgroundColor:n.controlSelectedBackgroundColor,selectors:{[F.m]:_object_spread({backgroundColor:"Highlight",color:"HighlightText",marginTop:"1px"},Object(F.S)()),":hover":[ci.s,ci.n,{backgroundColor:n.controlHoverBackgroundColor}],[ci.d]:{outline:"none"},[ci.b]:[ci.n,{borderColor:n.controlFocusBorderColor,outline:"none"}],[ci.a]:[ci.s]}},root:{selectors:{"[aria-expanded='true']":[ci.n,ci.t,{backgroundColor:n.controlSelectedBackgroundColor,selectors:{[F.m]:{selectors:{"svg > path.OfficeIconColors_HighContrast":{fill:"highlightText"}}}}}]}},label:{fontWeight:F.l.regular,fontSize:F.k.medium}}},Sk=(e,t)=>{const n=hk(e);return Object(F.db)({root:{width:"350px",overflow:"hidden"},dialogDescription:t?{fontSize:12,fontWeight:F.l.regular,color:n.secondaryTextColor,paddingBottom:"16px"}:void 0,documentExtension:{color:t?n.secondaryTextColor:void 0,fontWeight:F.l.regular,fontSize:F.k.small},label:{whiteSpace:"nowrap",textAlign:"start",overflow:"hidden",textOverflow:"ellipsis",width:"100%",fontSize:16,color:n.primaryTextColor,fontWeight:F.l.regular,selectors:{[F.m]:_object_spread({color:"inherit"},Object(F.S)())}},description:{whiteSpace:"nowrap",textAlign:"start",overflow:"hidden",textOverflow:"ellipsis",width:"100%",fontSize:12,fontWeight:F.l.regular,color:n.secondaryTextColor,selectors:{[F.m]:_object_spread({color:"inherit"},Object(F.S)())}},controlWrapper:{display:"flex",overflow:"hidden",padding:"10px 8px 10px 8px",width:"100%"},singleLocationWrapper:{borderRadius:t?"4px":"2px",borderColor:n.controlBorderColor,borderWidth:"1px",borderStyle:"solid"},folderIcon:{display:"flex",alignItems:"center"},textContainer:{overflow:"hidden",paddingLeft:"8px",width:"100%"},dropdownContainer:{marginTop:"16px"},moreLocationsDropdownItem:{padding:"10px 8px 10px 8px",fontWeight:t?600:void 0}})},yk=Object(Jo.c)((e,t)=>({classNames:Sk(e,t),fileNameInput:mk(t),dropdownStyle:Ek(e,t),locationLabelStyle:fk,singleLocationButton:xk(t),dropdownIconStyle:bk}));var Ck=n(1576);class vk extends R.PureComponent{render(){const e=this.fileNameHasInvalidChars(this.state.fileName);let t=void 0;return this.props.actionButtonProps&&(t=_object_spread_props(_object_spread({},this.props.actionButtonProps),{disabled:e})),R.createElement(SR.a,_object_spread_props(_object_spread({},this.props),{dialogButtonsOption:ER.b.OkCancel,defaultExecutionButton:ER.a.Ok,actionButtonProps:t,cancelButtonProps:this.props.cancelButtonProps,bodyRendererFunction:this.bodyRendererFunction,resultHandler:this.saveAsDialogResultHandler}))}isExtensionValid(e){return!!(e&&e.length>1&&"."===e[0])}renderLocation(e,t,n){const o=yk(e,this.isDialogImprovementsEnabled);return R.createElement(At.a,{horizontal:!0,verticalAlign:"end",className:o.classNames.controlWrapper},R.createElement("div",{className:o.classNames.folderIcon},R.createElement(fe.a,{iconName:this.isDialogImprovementsEnabled?vv.a.FolderCloudColorFluent_40:"Close_32","aria-hidden":"true",styles:{root:{width:this.isDialogImprovementsEnabled?40:32,height:this.isDialogImprovementsEnabled?40:32}}})),R.createElement(At.a,{horizontalAlign:"start",className:o.classNames.textContainer,id:"locationLabels"},R.createElement("div",{className:o.classNames.label,style:{textAlign:Object(ue.a)()?"right":"left"}},t),n&&R.createElement("div",{className:o.classNames.description,style:{textAlign:Object(ue.a)()?"right":"left"}},n)))}renderSingleLocation(e,t){const n=yk(e,this.isDialogImprovementsEnabled),o=Boolean(this.input.enableMoreLocations);return R.createElement(R.Fragment,null,R.createElement(Yl.a,{type:"AppLabelProps",label:this.isDialogImprovementsEnabled?SaveDialogStringsManager.get(SaveDialogStringsEnum.ChooseLocationSelectionLabel):SaveDialogStringsManager.get(SaveDialogStringsEnum.LocationSelectionLabel),id:"id",forId:"locationButton",styles:n.locationLabelStyle}),!o&&R.createElement("div",{className:n.classNames.singleLocationWrapper},this.renderLocation(e,t.folderName,t.friendlyPath)),o&&R.createElement(xc.a,{styles:n.singleLocationButton,id:"locationButton","aria-describedby":"locationLabels",onClick:this.onMoreLocations},R.createElement(At.a,{horizontal:!0},this.renderLocation(e,t.folderName,t.friendlyPath),R.createElement("div",{className:n.classNames.folderIcon},R.createElement(fe.a,{iconName:"CommonControlChevronRight_12","aria-hidden":"true",styles:{root:{width:12,height:16,transform:Object(ue.a)()?"rotate(180deg)":"none"}}})))))}onRenderOption(e){return t=>{var n;const o=yk(e,this.isDialogImprovementsEnabled);if(null!=t&&null!==(n=t.data)&&void 0!==n&&n.isMoreLocations)return R.createElement("div",{className:o.classNames.moreLocationsDropdownItem},t.text);const r=t.data&&t.data.path;return this.renderLocation(e,t.text,r)}}onRenderTitle(e){return t=>{if(t.length>0){const n=t[0];return this.onRenderOption(e)(n)}return R.createElement(R.Fragment,null)}}getDropdownOptions(e){if(e){const t=new Array(e.length);for(let n=0;n<e.length;n+=1)t[n]={key:n,selected:n===this.state.selectedIndex,text:e[n].folderName,data:{path:e[n].friendlyPath}};return this.input.enableMoreLocations&&t.push({key:e.length,selected:!1,text:SaveDialogStringsManager.get(SaveDialogStringsEnum.MoreLocations),data:{isMoreLocations:!0}}),t}return[]}onRenderCaretDown(e){return()=>{const t=this.isDialogImprovementsEnabled?vv.a.CommonControlChevronDown_12:"CommonControlChevronDownGlyph_12";return R.createElement(fe.a,{iconName:t,styles:e})}}fileNameHasInvalidChars(e){return 0!==(null==e?void 0:e.search(/^[^\/:*?""<>|]+$/))}constructor(e){super(e),this.dropdownBase=R.createRef(),this.onRenderInputSuffix=e=>()=>{const{classNames:t}=yk(e,this.isDialogImprovementsEnabled);return R.createElement("span",{className:t.documentExtension},this.input.extension)},this.maxFileNameLength=()=>{var e;return null!==(e=this.input.maxFileNameLength)&&void 0!==e?e:255},this.filenameError=e=>e?this.fileNameHasInvalidChars(e)?SaveDialogStringsManager.get(SaveDialogStringsEnum.InvalidCharacterError):"":SaveDialogStringsManager.get(SaveDialogStringsEnum.FilenameEmptyError),this.bodyRendererFunction=()=>R.createElement(we.a,null,e=>{const t=yk(e,this.isDialogImprovementsEnabled);return R.createElement("div",{className:t.classNames.root},this.isDialogImprovementsEnabled&&R.createElement("div",{className:t.classNames.dialogDescription},SaveDialogStringsManager.get(SaveDialogStringsEnum.Description)),R.createElement(Xd.a,{type:"AppInputProps",id:"targetFilename",value:this.state.fileName,autoComplete:"off",spellCheck:!1,label:SaveDialogStringsManager.get(SaveDialogStringsEnum.FilenameLabel),onChange:this.onFileNameChange,maxLength:Object(x.isChangeGateEnabled)("SharedOnline.ChangeGate.LimitExcelFileName")?this.maxFileNameLength():255,styles:t.fileNameInput,errorMessage:this.filenameError(this.state.fileName),onRenderSuffix:this.isExtensionValid(this.input.extension)?this.onRenderInputSuffix(e):void 0}),this.isDialogImprovementsEnabled||this.input.saveLocations.length>1?R.createElement("div",{className:t.classNames.dropdownContainer},R.createElement(Ck.a,{id:"saveLocations",ariaLabel:this.isDialogImprovementsEnabled&&Object(x.isChangeGateEnabled)("Microsoft.Office.SharedOnline.ChangeGate.SaveDialogLocationAriaLabel")?SaveDialogStringsManager.get(SaveDialogStringsEnum.ChooseLocationSelectionLabel):void 0,componentRef:this.dropdownBase,options:this.getDropdownOptions(this.input.saveLocations),onRenderOption:this.onRenderOption(e),onRenderTitle:this.onRenderTitle(e),styles:t.dropdownStyle,onRenderCaretDown:this.onRenderCaretDown(t.dropdownIconStyle),onChange:this.onLocationChange,onClick:this.onDropdownClick,label:this.isDialogImprovementsEnabled?SaveDialogStringsManager.get(SaveDialogStringsEnum.ChooseLocationSelectionLabel):SaveDialogStringsManager.get(SaveDialogStringsEnum.LocationSelectionLabel)})):1===this.input.saveLocations.length&&this.renderSingleLocation(e,this.input.saveLocations[0]))}),this.onFileNameChange=e=>{this.setState({fileName:e})},this.onMoreLocations=()=>{this.executeSaveAs(ER.a.Ok,!0)},this.onLocationChange=(e,t,n)=>{var o;null!=t&&null!==(o=t.data)&&void 0!==o&&o.isMoreLocations?this.onMoreLocations():this.setState({selectedIndex:n})},this.onDropdownClick=()=>{var e;null===(e=this.dropdownBase.current)||void 0===e||e.focus(!0)},this.currentLocationGetter=()=>{if(this.input.saveLocations&&void 0!==this.state.selectedIndex&&this.state.selectedIndex<this.input.saveLocations.length)return this.input.saveLocations[this.state.selectedIndex]},this.executeSaveAs=(e,t)=>{const n={fileName:this.state.fileName,moreLocationsSelected:!!t,locationCallback:t?void 0:this.currentLocationGetter};Object(Rv.sendTelemetryEvent)({name:"Office.FileIO.Online.SaveAsDialog",dataFields:[{name:"selectedButton",int64:e},{name:"filenameChanged",bool:this.input.fileName!==this.state.fileName},{name:"scenario",string:this.input.scenario},{name:"locationIndex",int64:this.state.selectedIndex},{name:"locationCount",int64:this.input.saveLocations.length},{name:"allowMoreLocations",bool:this.input.enableMoreLocations},{name:"isMoreLocationSelected",bool:!!t}]}),this.props.resultHandler(e,n)},this.saveAsDialogResultHandler=e=>{this.executeSaveAs(e)},this.input=e.bodyProps.inputPropsCallback(),this.isDialogImprovementsEnabled=!!e.dialogImprovementsEnabled,this.state={fileName:this.input.fileName||"",selectedIndex:this.input.saveLocations.length>0?0:void 0}}}var Rk=n(205);const kk=Object(Rk.strEnum)(["Irrelevant","Incorrect","Other"]);class Tk extends R.PureComponent{render(){return R.createElement(SR.a,_object_spread_props(_object_spread({},this.props),{bodyRendererFunction:this.bodyRendererFunction}))}getJustification(){let e;switch(this.state.justificationChoice){case kk.Irrelevant:e=this.props.justificationIrrelevantLabel;break;case kk.Incorrect:e=this.props.justificationIncorrectLabel;break;case kk.Other:e=this.textAreaContent}return e||""}justificationChanged(){var e,t;null===(e=(t=this.props).onJustificationUpdated)||void 0===e||e.call(t,this.getJustification())}constructor(){super(...arguments),this.textareaMaxCharacterLength=500,this.state={justificationChoice:void 0},this.textAreaContent="",this.bodyRendererFunction=()=>{const{textAreaProps:e,choiceGroupProps:t}=this.props.bodyControls,{infoMessage:n,justificationIncorrectLabel:o,justificationIrrelevantLabel:r,justificationOtherLabel:i}=this.props,a=Object(F.db)({container:{minWidth:""},messageContainer:{paddingBottom:30},textInputContainer:{padding:"10px 0"}});return R.createElement("div",{className:a.container},R.createElement("div",{className:a.messageContainer},R.createElement("span",null,n)),R.createElement(jl.a,_object_spread_props(_object_spread({},t),{type:"AppChoiceGroupProps",id:"JustificationDialogRadio",label:"",options:[{key:kk.Irrelevant,text:r||""},{key:kk.Incorrect,text:o||""},{key:kk.Other,text:i||""}],onChange:this.onChoiceGroupChange})),R.createElement("div",{className:a.textInputContainer},R.createElement(Xd.a,_object_spread_props(_object_spread({},e),{type:"AppInputProps",id:"JustificationDialogTextarea",multiline:!0,resizable:!1,maxLength:this.textareaMaxCharacterLength,disabled:this.state.justificationChoice!==kk.Other,onChange:this.textAreaContentChanged}))))},this.onChoiceGroupChange=e=>{this.setState({justificationChoice:e.key},this.justificationChanged)},this.textAreaContentChanged=e=>{this.textAreaContent=e,this.justificationChanged()}}}const _k=Object(Jo.c)((e,t)=>({padding:0,fontSize:22,color:Object(ox.a)(e,t).primaryTextColor})),wk=Object(Jo.c)((e,t)=>({padding:"0 0 10px",fontSize:19,color:Object(ox.a)(e,t).primaryTextColor})),Dk=Object(Jo.c)(e=>{const t=Object(ix.c)()?e.palette.neutralLight:ac.a.gray40,n=Object(ix.c)()?e.palette.neutralSecondary:ac.a.gray120,o=Object(ix.c)()?e.palette.neutralSecondaryAlt:ac.a.gray110;return Object(F.db)({container:{padding:20},subTitle:{marginBottom:16},infoMessage:{padding:20,backgroundColor:t,border:"1px solid "+n,borderRadius:2,marginBottom:16},optionalExperiencesContainer:{padding:20,border:"1px solid "+o,borderRadius:2,marginBottom:16},optionalExperiencesSubTitle:{margin:"3px 0 10px"},optionalExperiencesCheckbox:{margin:"16px 0"},optionalExperiencesInfoMessage:{padding:20,backgroundColor:t,border:"1px solid "+n,borderRadius:2,marginBottom:16,fontSize:12,display:"flex",alignItems:"center"},infoIcon:{width:24,height:24,marginRight:6}})});class Pk extends R.PureComponent{render(){return R.createElement(SR.a,_object_spread_props(_object_spread({},this.props),{bodyRendererFunction:this.bodyRendererFunction,resultHandler:this.commercialTrustCenterDialogResultHandler,maxWidth:650}))}constructor(){super(...arguments),this.containerGroupId="containerGroupId",this.containerGroupLabelledById="containerGroupLabelledById",this.optionalExperiencesGroupId="optionalExperiencesGroupId",this.optionalExperiencesGroupLabeledById="optionalExperiencesGroupLabeledById",this.state={optionalConnectedExperiencesEnabled:this.props.optionalExperiencesCheckboxInitialValue||!1},this.bodyRendererFunction=()=>{const{optionalConnectedExperiencesCheckboxProps:e,learnMoreLinkProps:t,privacyStatementLinkProps:n}=this.props.bodyControls,{appColors:o,title:r,subTitle:i,infoMessage:a,checkmarkIcon:s,optionalExperiencesTitle:l,optionalExperiencesSubTitle:c,optionalExperiencesInfoMessage:u,optionalExperiencesEnabled:d,optionalExperiencesInfoMessageIcon:p}=this.props;return R.createElement(we.a,null,g=>{const h=Dk(g);return R.createElement("div",{className:h.container,role:"group",id:this.containerGroupId,"aria-labelledby":this.containerGroupLabelledById},R.createElement("div",{id:this.containerGroupLabelledById,style:_k(g,o),role:"heading","aria-level":1},r||""),R.createElement("div",{className:h.subTitle},i),R.createElement("div",{className:h.infoMessage},a),d&&R.createElement("div",{className:h.optionalExperiencesContainer,role:"group",id:this.optionalExperiencesGroupId,"aria-labelledby":this.optionalExperiencesGroupLabeledById},R.createElement("div",{id:this.optionalExperiencesGroupLabeledById,style:wk(g,o),role:"heading","aria-label":l||"","aria-level":2},l||""),R.createElement("div",{className:h.optionalExperiencesSubTitle},c),R.createElement(Mu.a,_object_spread_props(_object_spread({},t),{type:"AppLinkProps",id:"CommercialTrustCenterDialogLearnMore"})),R.createElement("div",{className:h.optionalExperiencesCheckbox},R.createElement(bu.a,_object_spread_props(_object_spread({},e),{id:"OptionalConnectedExperiencesDialogCheckbox",type:"AppCheckboxProps",checkmarkIcon:s||"",checked:this.state.optionalConnectedExperiencesEnabled,onExecute:this.onCheckboxChange}))),R.createElement("div",{className:h.optionalExperiencesInfoMessage},R.createElement("div",null,p&&R.createElement(fe.a,_object_spread({className:h.infoIcon,id:"optionalExperiencesInfoMessageIcon",role:"img","aria-label":p.title},p))),R.createElement("div",null,R.createElement("div",null,u),R.createElement(Mu.a,_object_spread_props(_object_spread({},n),{type:"AppLinkProps",id:"CommercialTrustCenterDialogPrivacyStatement"}))))))})},this.onCheckboxChange=e=>{var t,n;this.setState({optionalConnectedExperiencesEnabled:e.checked}),null===(t=(n=this.props).onOptionalExperiencesCheckboxChanged)||void 0===t||t.call(n,e.checked)},this.commercialTrustCenterDialogResultHandler=e=>{this.props.resultHandler(e,{optionalExperiencesEnabled:!!this.props.optionalExperiencesEnabled,optionalExperiencesCheckboxChecked:this.state.optionalConnectedExperiencesEnabled})}}}var Ik=n(1e3);const Fk={paddingRight:0,paddingLeft:0,width:90};class Bk extends R.PureComponent{render(){return R.createElement(SR.a,_object_spread_props(_object_spread({},this.props),{bodyRendererFunction:this.bodyRendererFunction,resultHandler:this.CustomSizeDialogResultHandler}))}constructor(e){super(e),this.baseResultHandler=this.props.resultHandler,this.bodyRendererFunction=()=>{const{horizontalDimensionSpinButtonProps:e,verticalDimensionSpinButtonProps:t}=this.props.bodyControls,n={spinButtonStyles:{root:Fk,labelWrapper:{lineHeight:20},label:{fontWeight:F.l.semibold},spinButtonWrapper:{width:90,height:30,paddingBottom:1}},containerStyles:{display:Object(Ik.c)()?"-ms-grid":"grid"}};return R.createElement("div",{style:n.containerStyles,className:Object(F.eb)({gridTemplateColumns:"auto auto",gridTemplateRows:"auto",gridColumnGap:"15px"})},R.createElement("div",{className:Object(F.eb)({gridColumn:"1",gridRow:"1",paddingRight:Object(Ik.c)()?15:0,float:"left","-ms-grid-row":"1","-ms-grid-column":"1"})},e&&R.createElement(fc.a,_object_spread_props(_object_spread({},e),{value:this.state.horizontalDimension,labelPosition:mc.a.top,styles:n.spinButtonStyles,onExecute:this.onHorizontalDimensionSpinButtonChange}))),R.createElement("div",{className:Object(F.eb)({gridColumn:"2",gridRow:"1","-ms-grid-row":"1","-ms-grid-row-span":"1","-ms-grid-column":"2","-ms-grid-column-span":"1",marginRight:160,selectors:{"@media only screen and (max-width: 600px)":{marginRight:0}}})},t&&R.createElement(fc.a,_object_spread_props(_object_spread({},t),{labelPosition:mc.a.top,value:this.state.verticalDimension,styles:n.spinButtonStyles,onExecute:this.onVerticalDimensionSpinButtonChange}))))},this.CustomSizeDialogResultHandler=e=>{this.baseResultHandler(e,{horizontalDimension:this.state.horizontalDimension,verticalDimension:this.state.verticalDimension})},this.onHorizontalDimensionSpinButtonChange=e=>{this.setState({horizontalDimension:e.value})},this.onVerticalDimensionSpinButtonChange=e=>{this.setState({verticalDimension:e.value})},this.state={horizontalDimension:e.bodyControls.horizontalDimensionSpinButtonProps.value,verticalDimension:e.bodyControls.verticalDimensionSpinButtonProps.value}}}const Mk=Object(Jo.c)(()=>({field:{fontSize:12}})),jk=Object(Jo.c)(()=>({root:{display:"inline-block",width:50,marginLeft:5}})),Ok=Object(Jo.c)(()=>({root:{display:"inline-flex"}})),Lk=Object(Jo.c)(()=>({root:{width:150,marginLeft:28}})),Ak=Object(Jo.c)((e,t,n)=>({root:{padding:"2px 0",color:Object(ox.a)(e,t).primaryTextColor,opacity:n?1:0}})),Nk=Object(Jo.c)(()=>({root:{padding:"2px 0"}})),Wk=Object(Jo.c)(e=>({root:{padding:0},label:{fontSize:14,fontWeight:F.l.semibold,color:Object(ih.a)(e).textColor}})),zk=Object(Jo.c)(()=>({root:{boxSizing:"border-box"},labelWrapper:{height:"unset",minHeight:40,lineHeight:"inherit"},label:{textAlign:"left",width:80,lineHeight:"inherit"}})),Hk=Object(Jo.c)(e=>({pivot:{root:{marginBottom:20}},pivotHeaders:{wrapper:{height:20},pivotHeader:{root:{fontFamily:"Segoe UI",fontSize:14,lineHeight:20,background:"transparent",textAlign:"center",padding:"0px 0px"}},selectedPivotHeader:{root:{background:"transparent",color:e.palette.black},rootHovered:{background:"transparent",color:e.palette.black}},indicator:{margin:"0px 10%",width:"80%",top:-6,position:"relative",background:e.palette.themePrimary}}}));var Vk=n(2431);class Uk extends R.PureComponent{render(){return R.createElement(SR.a,_object_spread_props(_object_spread({},this.props),{bodyRendererFunction:this.bodyRendererFunction,resultHandler:this.embedDialogResultHandler,isWide:!0,focusDefaultButtonWhenOpened:!0,maxWidth:800}))}renderEmbedCode(e){return R.createElement(R.Fragment,null,R.createElement(Yl.a,{id:this.embedCodeContainerGroupLabeledById,type:"AppLabelProps",forId:this.embedCodeTextAreaId,styles:Wk(e),label:this.props.embedCodeSectionTitle||OfficeCommonStringsManager.get(OfficeCommonStringsEnum.EmbedCode)}),this.renderEmbedCodeInput())}renderEmbedCodeInput(){return R.createElement(Xd.a,{ref:this.setEmbedCodeTextAreaRef,type:"AppInputProps",id:this.embedCodeTextAreaId,multiline:!0,resizable:!1,readOnly:!0,value:this.getEmbedCode(),selectTextOnFocus:!0,styles:Mk()})}renderEmbedUrlInput(){return R.createElement(R.Fragment,null,R.createElement(Xd.a,{ref:this.setEmbedURLTextAreaRef,type:"AppInputProps",id:this.embedUrlTextAreaId,multiline:!0,resizable:!1,readOnly:!0,value:this.props.initialEmbedUrl,selectTextOnFocus:!0,styles:Mk()}))}renderEmbedPivot(e){const{currentlySelectedPivotId:t}=this.state,n=Hk(e);return R.createElement(R.Fragment,null,R.createElement($C.a,{styles:n.pivot,overflowMenuLauncherLabel:"",selectedPivotId:t,topLevelItems:this.getPivotHeaders(e),onPivotHeaderExecute:this.onPivotItemClicked,displayTabIndicatorPlaceholder:!0,onPivotHeaderFocus:this.onPivotItemClicked}),t===this.embedCodeTextAreaPivotItemId?this.renderEmbedCodeInput():this.renderEmbedUrlInput())}renderWhatToShowOptions(e,t){const{whatToShowOptions:n,whatToShowSectionTitle:o,downChevronIcon:r}=this.props;return n?R.createElement("div",{className:t.whatToShowSection,role:"group",id:this.whatToShowContainerGroupId,"aria-labelledby":this.whatToShowContainerGroupLabeledById},R.createElement(Yl.a,{id:this.whatToShowContainerGroupLabeledById,type:"AppLabelProps",forId:this.whatToShowContainerGroupId,styles:Wk(e),label:o||""}),R.createElement(jl.a,{type:"AppChoiceGroupProps",id:"EmbedDialogWhatToShowChoiceGroup",label:"",selectedKey:this.state.whatToShowUserSettings.selectedId,onChange:this.onWhatToShowChoiceChange,options:n.map(e=>_object_spread({key:e.id,text:e.label},e.textInputProps?{onRenderField:(n,o)=>{const r=this.state.whatToShowUserSettings.selectedId===e.id;return R.createElement("div",{className:t.embedOptionWrapper},o(n),R.createElement(Xd.a,_object_spread_props(_object_spread({},e.textInputProps),{id:e.id+"-textinput",type:"AppInputProps",value:r?this.state.whatToShowUserSettings.textValue:"",onChange:this.getOnWhatToShowOptionTextChangeFunction,resizable:!1,disabled:!r,styles:jk()})))}}:{},e.comboBoxProps&&e.comboBoxProps.options?{onRenderField:(t,n)=>{const{id:o,options:i}=e.comboBoxProps;return R.createElement(R.Fragment,null,n(t),R.createElement(Wc.a,_object_spread_props(_object_spread({},e.comboBoxProps),{id:o+"-comboBox",type:"AppComboBoxProps",label:"",allowFreeForm:!1,options:i,defaultSelectedKey:i[0].key,onExecute:this.getOnWhatToShowOptionComboBoxChangeFunction,disabled:this.state.whatToShowUserSettings.selectedId!==e.id,downChevronIcon:r||"",styles:Lk()})))}}:{}))})):null}renderDimensionsOptions(e,t){var n,o,r,i,a,s;const{incrementButtonIcon:l,incrementButtonAriaLabel:c,decrementButtonIcon:u,decrementButtonAriaLabel:d,dimensionsOptions:p,dimensionsSectionTitle:g}=this.props;return p?R.createElement("div",{className:t.dimensionsSection,role:"group",id:this.dimensionsContainerGroupId,"aria-labelledby":this.dimensionsContainerGroupLabeledById},R.createElement(Yl.a,{id:this.dimensionsContainerGroupLabeledById,type:"AppLabelProps",forId:this.dimensionsContainerGroupId,styles:Wk(e),label:g||""}),p.isMultipleChoice&&p.choices?R.createElement(jl.a,{type:"AppChoiceGroupProps",id:"EmbedDialogChoiceGroup",label:null!==(n=p.multipleChoiceLabel)&&void 0!==n?n:"",defaultSelectedKey:(null!==(o=p.defaultChoiceIndex)&&void 0!==o?o:0).toString(),options:p.choices.map((e,t)=>({key:t.toString(),text:`${e.width} x ${e.height}`})),onChange:this.onDimensionsMultipleChoiceChange}):R.createElement(R.Fragment,null,R.createElement(fc.a,_object_spread_props(_object_spread({},this.getAppSpinButtonProps("EmbedDialogWidthInput",null!==(r=p.widthLabel)&&void 0!==r?r:"",null!==(i=null==p?void 0:p.minWidth)&&void 0!==i?i:0)),{value:this.state.dimensionsWidth,onExecute:this.onDimensionsWidthChange,incrementButtonIcon:null!=l?l:"",decrementButtonIcon:null!=u?u:"",incrementAriaLabel:c,decrementAriaLabel:d,styles:zk()})),R.createElement(fc.a,_object_spread_props(_object_spread({},this.getAppSpinButtonProps("EmbedDialogHeightInput",null!==(a=p.heightLabel)&&void 0!==a?a:"",null!==(s=null==p?void 0:p.minHeight)&&void 0!==s?s:0)),{value:this.state.dimensionsHeight,onExecute:this.onDimensionsHeightChange,incrementButtonIcon:null!=l?l:"",decrementButtonIcon:null!=u?u:"",incrementAriaLabel:c,decrementAriaLabel:d,styles:zk()})))):null}renderEmbedOptions(e,t){var n;const o=null!==(n=this.props.checkmarkIcon)&&void 0!==n?n:"";return e.map(e=>{var n,r;const i=null===(n=this.state.embedUserSettings[e.id])||void 0===n?void 0:n.checked;return R.createElement("div",{key:e.id,className:t.embedOptionWrapper},R.createElement(bu.a,{id:e.id+"-checkbox",styles:Ok(),type:"AppCheckboxProps",label:e.checkboxLabel,checkmarkIcon:o,checked:i,onExecute:this.getOnEmbedOptionCheckboxChangeFunction(e.id)}),e.textInputProps&&R.createElement(Xd.a,_object_spread_props(_object_spread({},e.textInputProps),{id:e.id+"-textinput",type:"AppInputProps",value:null===(r=this.state.embedUserSettings[e.id])||void 0===r?void 0:r.textValue,onChange:this.getOnEmbedOptionTextChangeFunction(e.id),resizable:!1,disabled:!i,styles:jk()})))})}renderInteractionOptions(e,t){const{interactionOptions:n,interactionSectionTitle:o}=this.props;return n&&0!==n.length?R.createElement("div",{className:t.interactionSection,role:"group",id:this.interactionContainerGroupId,"aria-labelledby":this.interactionContainerGroupLabeledById},R.createElement(Yl.a,{id:this.interactionContainerGroupLabeledById,type:"AppLabelProps",forId:this.interactionContainerGroupId,styles:Wk(e),label:o||""}),this.renderEmbedOptions(n,t)):null}renderAppearanceOptions(e,t){const{appearanceOptions:n,appearanceSectionTitle:o}=this.props;return n&&0!==n.length?R.createElement("div",{className:t.appearanceSection,role:"group",id:this.appearanceContainerGroupId,"aria-labelledby":this.appearanceContainerGroupLabeledById},R.createElement(Yl.a,{id:this.appearanceContainerGroupLabeledById,type:"AppLabelProps",forId:this.appearanceContainerGroupId,styles:Wk(e),label:o||""}),this.renderEmbedOptions(n,t)):null}getInitialDimensions(){var e,t;const{dimensionsOptions:n}=this.props;if(n){if(n.isMultipleChoice&&n.choices&&n.defaultChoiceIndex)return n.choices[n.defaultChoiceIndex];if(!n.isMultipleChoice&&n.defaultWidth&&n.defaultHeight)return{width:n.defaultWidth,height:n.defaultHeight}}return{width:null!==(e=null==n?void 0:n.minWidth)&&void 0!==e?e:0,height:null!==(t=null==n?void 0:n.minHeight)&&void 0!==t?t:0}}getInitialUserSettings(){var e,t;return(null!==(e=this.props.interactionOptions)&&void 0!==e?e:[]).concat(null!==(t=this.props.appearanceOptions)&&void 0!==t?t:[]).reduce((e,t)=>(e[t.id]={checked:t.checkboxInitialValue},e),{})}getInitialWhatToShowSettings(){var e;return{selectedId:(null===(e=this.props.whatToShowOptions)||void 0===e?void 0:e[0].id)||""}}getEmbedCode(){return this.props.getEmbedCode&&this.isAppSpinValueNumber(this.state.dimensionsWidth)&&this.isAppSpinValueNumber(this.state.dimensionsHeight)?this.props.getEmbedCode(this.state.embedUrl,this.state.dimensionsWidth,this.state.dimensionsHeight):""}isAppSpinValueNumber(e){return""!==e}getControlSettingsIdMap(){var e,t;const n={};return null===(e=this.props.interactionOptions)||void 0===e||e.forEach(e=>{n[e.id]=e}),null===(t=this.props.appearanceOptions)||void 0===t||t.forEach(e=>{n[e.id]=e}),n}updateUrlWithNewUserSetting(e){const t=this.getControlSettingsIdMap()[e].urlTransformFunctionOnChange;if(!t)return;const{checked:n,textValue:o}=this.state.embedUserSettings[e],r=t(this.state.embedUrl,e,n,o);if(r!==this.state.embedUrl){const i=t(this.state.previewUrl,e,n,o);this.setState({embedUrl:r,previewUrl:i,showCodeCopiedStatus:!1})}}constructor(){super(...arguments),this.embedPreviewContainerGroupId="embedPreviewContainerGroupId",this.embedPreviewContainerGroupLabeledById="embedPreviewContainerGroupLabeledById",this.embedCodeTextAreaId="embedDialogTextarea",this.embedCodeTextAreaPivotItemId="embedDialogTextareaPivotItem",this.embedUrlTextAreaId="embedUrlTextarea",this.embedUrlTextAreaPivotItemId="embedUrlTextareaPivotItem",this.embedCodeContainerGroupLabeledById="embedCodeContainerGroupLabeledById",this.dimensionsContainerGroupId="dimensionsContainerGroupId",this.dimensionsContainerGroupLabeledById="dimensionsContainerGroupLabeledById",this.interactionContainerGroupId="interactionContainerGroupId",this.interactionContainerGroupLabeledById="interactionContainerGroupLabeledById",this.appearanceContainerGroupId="appearanceContainerGroupId",this.appearanceContainerGroupLabeledById="appearanceContainerGroupLabeledById",this.whatToShowContainerGroupId="whatToShowContainerGroupId",this.whatToShowContainerGroupLabeledById="whatToShowContainerGroupLabeledById",this.embedCodeTextAreaRef=null,this.embedURLTextAreaRef=null,this.baseResultHandler=this.props.resultHandler,this.state={embedUrl:this.props.initialEmbedUrl||"",previewUrl:this.props.initialPreviewUrl||"",dimensionsWidth:this.getInitialDimensions().width,dimensionsHeight:this.getInitialDimensions().height,embedUserSettings:this.getInitialUserSettings(),whatToShowUserSettings:this.getInitialWhatToShowSettings(),showCodeCopiedStatus:!1,currentlySelectedPivotId:this.embedCodeTextAreaPivotItemId},this.embedDialogResultHandler=e=>{const{currentlySelectedPivotId:t}=this.state;var n,o,r;e===ER.a.Ok?(this.embedCodeTextAreaRef||this.embedURLTextAreaRef)&&(this.props.showEmbedURL?t===this.embedCodeTextAreaPivotItemId?null===(n=this.embedCodeTextAreaRef)||void 0===n||n.select():null===(o=this.embedURLTextAreaRef)||void 0===o||o.select():null===(r=this.embedCodeTextAreaRef)||void 0===r||r.select(),document.execCommand("copy"),this.setState({showCodeCopiedStatus:!0})):this.baseResultHandler(e)},this.setEmbedCodeTextAreaRef=e=>{this.embedCodeTextAreaRef=e},this.setEmbedURLTextAreaRef=e=>{this.embedURLTextAreaRef=e},this.bodyRendererFunction=()=>{const{appColors:e,embedPreviewSectionTitle:t,codeCopiedText:n,viewActualSizeLinkProps:o}=this.props,r=Object(F.db)({container:{display:"flex",flexDirection:"column","@media (min-width: 800px)":{flexDirection:"row"}},previewPane:{maxWidth:450,"@media (min-width: 800px)":{paddingBottom:16},flex:"1 1 450px"},optionsPane:{flex:"1 0 250px",selectors:{"@media (min-width: 800px)":{paddingLeft:50}}},previewFrame:{border:"none",height:288,width:"100%"},embedPreviewSection:{paddingTop:10},embedCodeSection:{paddingTop:10},embedOptionWrapper:{display:"flex",alignItems:"center"},dimensionsSection:{paddingTop:10,overflowX:"hidden"},interactionSection:{paddingTop:10},appearanceSection:{paddingTop:10},whatToShowSection:{paddingTop:10},viewActualSizeLink:{fontSize:12,textAlign:"right"}});return R.createElement(we.a,null,i=>R.createElement("div",{className:r.container},R.createElement("div",{className:r.previewPane},R.createElement("div",{className:r.embedPreviewSection,role:"group",id:this.embedPreviewContainerGroupId,"aria-labelledby":this.embedPreviewContainerGroupLabeledById},R.createElement(Yl.a,{id:this.embedPreviewContainerGroupLabeledById,type:"AppLabelProps",forId:this.embedPreviewContainerGroupId,styles:Wk(i),label:t||""}),o&&R.createElement("div",{className:r.viewActualSizeLink},R.createElement(Mu.a,_object_spread_props(_object_spread({},o),{type:"AppLinkProps",id:"ViewActualSizeLink"}))),R.createElement(Vk.a,{id:"EmbedDialogIFrame",type:"AppIFrameProps",src:this.state.previewUrl,className:r.previewFrame,tabIndex:0})),R.createElement("div",{className:r.embedCodeSection},this.props.showEmbedURL?this.renderEmbedPivot(i):this.renderEmbedCode(i),R.createElement(ex,{type:"AppStatusTextProps",id:"EmbedCodeDisclaimer",label:OfficeCommonStringsManager.get(OfficeCommonStringsEnum.EmbedCodeDisclaimer),styles:Nk()}),n&&R.createElement(ex,{type:"AppStatusTextProps",id:"CodeCopiedStatus",label:this.state.showCodeCopiedStatus?n:"",styles:Ak(i,e,this.state.showCodeCopiedStatus)}))),R.createElement("div",{className:r.optionsPane},this.renderDimensionsOptions(i,r),this.renderWhatToShowOptions(i,r),this.renderInteractionOptions(i,r),this.renderAppearanceOptions(i,r))))},this.getPivotHeaders=e=>{const t=Hk(e).pivotHeaders;return[{id:this.embedCodeTextAreaPivotItemId,title:this.props.embedCodeSectionTitle||OfficeCommonStringsManager.get(OfficeCommonStringsEnum.EmbedCode),styles:t},{id:this.embedUrlTextAreaPivotItemId,title:this.props.embedUrlSectionTitle||OfficeCommonStringsManager.get(OfficeCommonStringsEnum.EmbedURL),styles:t}]},this.onPivotItemClicked=e=>{this.setState({currentlySelectedPivotId:e})},this.getAppSpinButtonProps=Object(Jo.c)((e,t,n)=>({id:e,label:t,type:"AppSpinButtonProps",unitType:"px",validUnits:[{unitType:"px",unitPlaceholder:"{0}",minValue:n,maxValue:1e5,step:1}],numberFormatInfo:{negativeSign:"-",numberDecimalDigits:0,numberDecimalSeparator:".",numberNegativePattern:1,numberGroupSeparator:" ",numberGroupSizes:[3]}})),this.onDimensionsWidthChange=e=>{this.setState({dimensionsWidth:e.value,showCodeCopiedStatus:!1},this.notifyDimensionsChanged)},this.onDimensionsHeightChange=e=>{this.setState({dimensionsHeight:e.value,showCodeCopiedStatus:!1},this.notifyDimensionsChanged)},this.onDimensionsMultipleChoiceChange=e=>{var t,n,o,r;this.setState({dimensionsWidth:null!==(t=null===(n=this.props.dimensionsOptions)||void 0===n||null===(n=n.choices)||void 0===n?void 0:n[parseInt(e.key,10)].width)&&void 0!==t?t:"",dimensionsHeight:null!==(o=null===(r=this.props.dimensionsOptions)||void 0===r||null===(r=r.choices)||void 0===r?void 0:r[parseInt(e.key,10)].height)&&void 0!==o?o:"",showCodeCopiedStatus:!1},this.notifyDimensionsChanged)},this.onWhatToShowChoiceChange=e=>{var t,n;const o=null===(t=this.props.whatToShowOptions)||void 0===t?void 0:t.filter(t=>t.id===e.key),r=null==o?void 0:o[0];let i=(null==r?void 0:r.textInputProps)&&"";var a;null!=r&&null!==(n=r.comboBoxProps)&&void 0!==n&&n.options[0]&&(i=(null==r||null===(a=r.comboBoxProps)||void 0===a?void 0:a.options[0]).text);this.setState({whatToShowUserSettings:{selectedId:e.key,textValue:i},showCodeCopiedStatus:!1},this.updateUrlWithNewWhatToShowSetting)},this.notifyDimensionsChanged=()=>{const{dimensionsWidth:e,dimensionsHeight:t}=this.state;var n,o;this.isAppSpinValueNumber(t)&&this.isAppSpinValueNumber(e)&&(null===(n=this.props.dimensionsOptions)||void 0===n||null===(o=n.onDimensionsChange)||void 0===o||o.call(n,e,t))},this.updateUrlWithNewWhatToShowSetting=()=>{const{whatToShowTransformUrlFunction:e}=this.props;if(!e)return;const{selectedId:t,textValue:n}=this.state.whatToShowUserSettings,o=e(this.state.embedUrl,t,n);if(o!==this.state.embedUrl){const r=e(this.state.previewUrl,t,n);this.setState({embedUrl:o,previewUrl:r,showCodeCopiedStatus:!1})}},this.getOnEmbedOptionTextChangeFunction=Object(Jo.c)(e=>t=>{this.setState({embedUserSettings:_object_spread_props(_object_spread({},this.state.embedUserSettings),{[e]:_object_spread_props(_object_spread({},this.state.embedUserSettings[e]),{textValue:t||""})})},this.updateUrlWithNewUserSetting.bind(this,e))}),this.getOnWhatToShowOptionTextChangeFunction=e=>{this.setState({whatToShowUserSettings:_object_spread_props(_object_spread({},this.state.whatToShowUserSettings),{textValue:e})},this.updateUrlWithNewWhatToShowSetting)},this.getOnWhatToShowOptionComboBoxChangeFunction=e=>{const t="string"==typeof e.newValue?e.newValue:e.newValue.text;this.setState({whatToShowUserSettings:_object_spread_props(_object_spread({},this.state.whatToShowUserSettings),{textValue:t})},this.updateUrlWithNewWhatToShowSetting)},this.getOnEmbedOptionCheckboxChangeFunction=Object(Jo.c)(e=>t=>{this.setState({embedUserSettings:_object_spread_props(_object_spread({},this.state.embedUserSettings),{[e]:_object_spread_props(_object_spread({},this.state.embedUserSettings[e]),{checked:t.checked})})},this.updateUrlWithNewUserSetting.bind(this,e))})}}class Gk extends R.PureComponent{render(){return R.createElement(SR.a,_object_spread_props(_object_spread({},this.props),{bodyRendererFunction:this.bodyRendererFunction,resultHandler:this.fileUploadErrorDialogResultHandler}))}constructor(){super(...arguments),this.textareaMaxCharacterLength=256,this.textAreaContent="",this.state={reportErrorChecked:!0},this.bodyRendererFunction=()=>{const{textAreaProps:e,reportErrorCheckboxProps:t,privacyStatementLinkProps:n}=this.props.bodyControls,{errorMessage:o,errorReportMessage:r,errorTextPrompt:i,checkmarkIcon:a}=this.props,s=Object(F.db)({container:{minWidth:360},messageContainer:{},textInputContainer:{padding:"10px 0"}});return R.createElement("div",{className:s.container},R.createElement("div",{className:s.messageContainer},R.createElement("p",null,o),R.createElement("p",null,r)),e&&R.createElement("div",{className:s.textInputContainer},R.createElement("p",null,i),R.createElement(Xd.a,_object_spread_props(_object_spread({},e),{type:"AppInputProps",id:"FileUploadErrorDialogTextarea",multiline:!0,resizable:!1,maxLength:this.textareaMaxCharacterLength,disabled:!this.state.reportErrorChecked,onChange:this.textAreaContentChanged}))),t&&R.createElement(bu.a,_object_spread_props(_object_spread({},t),{id:"ReportErrorDialogCheckbox",type:"AppCheckboxProps",checkmarkIcon:a||"",checked:this.state.reportErrorChecked,onExecute:this.onCheckboxChange})),R.createElement(Mu.a,_object_spread_props(_object_spread({},n),{type:"AppLinkProps",id:"FileUploadErrorDialogPrivacyStatement"})))},this.onCheckboxChange=e=>{this.setState({reportErrorChecked:e.checked})},this.textAreaContentChanged=e=>{this.textAreaContent=e},this.fileUploadErrorDialogResultHandler=e=>{const t={text:this.textAreaContent,reportErrorChecked:this.state.reportErrorChecked};this.props.resultHandler(e,t)}}}var qk,Qk=n(2448),Kk=n(2451);class Jk extends R.PureComponent{render(){let e=void 0;return this.props.actionButtonProps&&(e=_object_spread_props(_object_spread({},this.props.actionButtonProps),{disabled:void 0===this.state.currentLabelId})),R.createElement(SR.a,_object_spread_props(_object_spread({},this.props),{actionButtonProps:e,bodyRendererFunction:this.bodyRendererFunction,resultHandler:this.mandatoryLabellingDialogResultHandler,firstFocusableSelector:"MandatoryLabelingDialogFlyoutAnchor"}))}constructor(e){var t;super(e),this.baseResultHandler=this.props.resultHandler,this.labelMap={},this.setButtonAction=e=>{const t=this.labelMap[e.id];if(this.setState({currentLabel:t,currentLabelId:e.id}),document){const e=document.getElementById(this.props.bodyProps.labelFlyout.id);e&&e.focus()}},this.flyoutRenderFunction=e=>e.controlProps.map(t=>"AppToggleButtonProps"===t.type?Object(Dm.a)(t):Object(Pm.a)(t.id,t,this.subFlyoutRenderFunction,Object(Ev.a)(),e.onSubMenuPositioned,void 0,void 0,!1,void 0)),this.subFlyoutRenderFunction=e=>e.controlProps.map(e=>Object(Dm.a)(e)),this.bodyRendererFunction=()=>{const e=this.props.bodyProps.learnMoreLink?R.createElement("span",null,R.createElement(Mu.a,_object_spread({},this.props.bodyProps.learnMoreLink))):R.createElement("span",null);return R.createElement("div",null,R.createElement("p",null," ",this.props.bodyProps.descriptionText," "),e,R.createElement("div",{className:this.props.bodyProps.labelFlyout.id,style:{marginTop:"1em"}},R.createElement(dl.a,_object_spread_props(_object_spread({},this.props.bodyProps.labelFlyout),{controlInMenuRendererFunction:this.flyoutRenderFunction,label:this.state.currentLabel,styles:{root:["MandatoryLabelingDialogFlyoutAnchor"],label:{width:"10em",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}},downChevronIcon:Object(Ev.a)().downChevron}))))},this.mandatoryLabellingDialogResultHandler=e=>{const t={selectedLabel:this.state.currentLabelId};this.baseResultHandler(e,t)},this.state={currentLabel:e.bodyProps.initialLabelText,currentLabelId:void 0};const n=null===(t=e.bodyProps.labelFlyout.menuDefinition)||void 0===t?void 0:t.sections[0].controls;if(n)for(const e of n)if(Object(Qk.a)(e))this.labelMap[e.id]=e.label,e.onExecute=this.setButtonAction;else if(Object(Kk.a)(e)){var o;const t=null===(o=e.menuDefinition)||void 0===o?void 0:o.sections[0].controls;t&&t.filter(e=>Object(Qk.a)(e)).map(e=>e).forEach(e=>{this.labelMap[e.id]=e.label,e.onExecute=this.setButtonAction})}}}!function(e){e[e.Unknown=0]="Unknown",e[e.Host=1]="Host",e[e.Addin=2]="Addin"}(qk||(qk={}));class Yk extends R.Component{render(){return R.createElement(SR.a,_object_spread_props(_object_spread({},this.props),{bodyRendererFunction:this.bodyRendererFuction,resultHandler:this.ShortcutsDialogResultHandler}))}constructor(e){super(e),this.baseResultHandler=this.props.resultHandler,this.bodyRendererFuction=()=>{const e=this.props.conflictInfo.shortcutDisplayInfoArray.map((e,t)=>{const n={key:""+t,text:e.actionDescription};return e.ownerType===qk.Addin&&(n.text=e.actionDescription+" ("+e.addinName+")"),n});return R.createElement("div",null,R.createElement(jl.a,{id:"ShortcutChoiceGroup",type:"AppChoiceGroupProps",label:this.props.bodyProps.choiceLabel,options:e,onChange:this.handlePreferenceChange,defaultSelectedKey:"0"}),this.props.bodyProps.preferencesLinkEnabled&&R.createElement("div",{style:{marginTop:15}},R.createElement(Mu.a,{id:"ShortcutPreferencesLink",type:"AppLinkProps",text:this.props.bodyProps.preferencesLinkText,handler:null!=this.props.bodyProps.preferencesHelpLinkOnExecute?this.props.bodyProps.preferencesHelpLinkOnExecute:{href:this.props.bodyProps.preferencesLinkHref,target:"_blank"}})))},this.ShortcutsDialogResultHandler=e=>{const t={};e===ER.a.Ok?t.selectedShortcutIndex=this.state.selectedIndex:t.selectedShortcutIndex=-1,this.baseResultHandler(e,t)},this.handlePreferenceChange=e=>{this.setState({selectedIndex:parseInt(e.key,10)})},this.state={selectedIndex:0}}}var Zk=n(2541),$k=n(216),Xk=n(1591);const eT={textStyles:{margin:0,display:"inline"},listItemStyles:{listStylePosition:"inside"},textSectionStyles:{boxSizing:"border-box"}};class tT extends R.PureComponent{render(){const{textContent:e}=this.props;return this.additionalBodyTextContentIndex=0,R.createElement(R.Fragment,null,e.map(e=>R.createElement("div",{key:Object($k.a)(),className:this.classNames.textSectionStyles},this.isTextList(e)?this.renderTextList(e):this.renderText(e))))}constructor(){super(...arguments),this.classNames=(e=>{const t=eT;return Object(F.db)({textStyles:t.textStyles,listItemStyles:t.listItemStyles,textSectionStyles:t.textSectionStyles},e)})(this.props.customStyles),this.additionalBodyTextContentIndex=0,this.renderAppLink=e=>R.createElement(Mu.a,_object_spread({key:Object($k.a)()},e)),this.interpolateLinksInText=e=>{const t=this.props.links;return t&&this.additionalBodyTextContentIndex<t.length?Object(Xk.a)(e,()=>{const e=this.additionalBodyTextContentIndex;return this.additionalBodyTextContentIndex=this.additionalBodyTextContentIndex+1,this.renderAppLink(t[e])}):[e]},this.renderText=e=>R.createElement("p",{className:this.classNames.textStyles},this.interpolateLinksInText(e)),this.renderTextList=e=>R.createElement("ul",null,e.map(e=>R.createElement("li",{key:Object($k.a)(),className:this.classNames.listItemStyles},this.renderText(e)))),this.isTextList=e=>Array.isArray(e)}}const nT=(e,t)=>{const n=Object(ih.a)(e).textColor;return{standardTextStyles:[{paddingTop:"8px",color:n,boxSizing:"border-box"}],downloadLink:[{paddingTop:"8px",paddingBottom:"8px"}],title:[_object_spread({paddingBottom:4,color:n},t?{whiteSpace:"pre-line"}:{})],errorReportTitleStyles:[{fontWeight:"bold"}]}},oT=(e,t)=>({textSectionStyles:nT(e,t).standardTextStyles});var rT=n(528);const iT=R.memo(R.forwardRef((e,t)=>{const n=Object(Ka.a)(e,t);return Object(rT.b)(n),Object(Qa.a)(n)}));iT.displayName="next/AppCheckbox";var aT=n(2603),sT=n(2153);const lT=Object(ut.a)({textStyles:_object_spread_props(_object_spread({},pt.a.margin(_o.a.spacingVerticalNone)),{display:"inline"}),listItemStyles:{listStylePosition:"inside"},textSectionStyles:{boxSizing:"border-box"}}),cT=(e,t)=>R.createElement("p",{className:t.textStyles},((e,t)=>{const n=t.links;return n&&t.additionalBodyTextContentIndex<n.length?Object(Xk.a)(e,()=>{const e=t.additionalBodyTextContentIndex;return t.additionalBodyTextContentIndex=t.additionalBodyTextContentIndex+1,R.createElement(aT.a,_object_spread({key:e},n[e]))}):[e]})(e,t)),uT=(e,t)=>Object(Ct.a)("ul",{children:e.map((e,n)=>Object(Ct.a)("li",{className:t.listItemStyles,children:cT(e,t)},n))}),dT=e=>{const t=(e=>{const t=_object_spread({},e);return t.additionalBodyTextContentIndex=0,t})(e);return(e=>{const t=lT();e.textStyles=Object(F.eb)(t.textStyles),e.listItemStyles=Object(F.eb)(t.listItemStyles),e.textSectionStyles=Object(F.eb)(t.textSectionStyles)})(t),(e=>{const t=e.textContent,n=e=>Array.isArray(e);return Object(Ct.a)(R.Fragment,{children:t.map((t,o)=>Object(Ct.a)("div",{className:e.textSectionStyles,children:n(t)?uT(t,e):cT(t,e)},o))})})(t)},pT=Object(ut.a)({standardTextStyles:{paddingTop:_o.a.spacingVerticalS,boxSizing:"border-box"},downloadLink:{paddingTop:_o.a.spacingVerticalS,paddingBottom:_o.a.spacingVerticalS},title:{paddingBottom:_o.a.spacingVerticalXS},errorReportTitleStyles:{fontWeight:_o.a.fontWeightBold},checkboxStyles:_object_spread({},pt.a.padding(_o.a.spacingHorizontalNone,_o.a.spacingVerticalNone))}),gT=Object(ut.a)({dialogContentStyle:{alignContent:"center"}}),hT=R.forwardRef((e,t)=>{var n;const{titleText:o,additionalBodyTextContent:r,messageAreaLink:i,downloadLink:a,helpLink:s,feedbackDescription:l,feedbackLink:c,sessionId:u,permanentDismissCheckbox:d,saveErrorReportTitle:p,saveErrorReportDescription:g,privacyPolicyLink:h}=e,m={permanentDismissCheckboxChecked:!1},b=gT(),f=Object(Rt.a)(b.dialogContentStyle);return(e=>{const t=pT();e.standardTextStyles=Object(Rt.a)(t.standardTextStyles),e.downloadLinkClassName=Object(Rt.a)(t.downloadLink),e.title=Object(Rt.a)(t.title),e.errorReportTitleStyles=Object(Rt.a)(t.errorReportTitleStyles)})(m),R.createElement(hm.a,null,R.createElement(sT.a,_object_spread_props(_object_spread({},e),{ref:t,titleText:void 0,focusDefaultButtonWhenOpened:!0,describedById:"DialogContents",isModal:null===(n=e.isModal)||void 0===n||n}),R.createElement("div",{id:"DialogContents",className:f},R.createElement("div",null,o&&R.createElement("span",{className:m.title,id:"ReactDialogText"},o),r&&R.createElement(dT,_object_spread({},r)),i&&R.createElement(aT.a,_object_spread({},i))),a&&R.createElement("div",{className:m.downloadLinkClassName},R.createElement(aT.a,_object_spread({},a))),s&&R.createElement("div",{className:m.standardTextStyles},R.createElement(aT.a,_object_spread({},s))),(l||c)&&R.createElement("div",{className:m.standardTextStyles},l&&R.createElement("div",null,l," "),c&&R.createElement(aT.a,_object_spread_props(_object_spread({},c),{role:"button"}))),u&&R.createElement("div",{className:m.standardTextStyles},R.createElement("span",null,u)),(p||g||h)&&R.createElement("div",{className:m.standardTextStyles},p&&R.createElement("div",{className:m.errorReportTitleStyles},p),g&&R.createElement("div",null,g),h&&R.createElement("div",{className:m.standardTextStyles},R.createElement(aT.a,_object_spread({},h)))),d&&R.createElement("div",{className:m.standardTextStyles},R.createElement(iT,_object_spread_props(_object_spread({},d),{checked:m.permanentDismissCheckboxChecked,onExecute:()=>{var t,n,o;e.permanentDismissCheckbox&&(m.permanentDismissCheckboxChecked=!m.permanentDismissCheckboxChecked,null===(t=e.permanentDismissCheckbox)||void 0===t||null===(n=t.onExecute)||void 0===n||n.call(t,{id:null===(o=e.permanentDismissCheckbox)||void 0===o?void 0:o.id,checked:m.permanentDismissCheckboxChecked}))}}))))))});var mT=n(906);class bT extends R.PureComponent{render(){const{titleText:e,additionalBodyTextContent:t,messageAreaLink:n,downloadLink:o,helpLink:r,feedbackDescription:i,feedbackLink:a,sessionId:s,permanentDismissCheckbox:l,saveErrorReportTitle:c,saveErrorReportDescription:u,privacyPolicyLink:d}=this.props;return R.createElement(hm.a,null,R.createElement(we.a,null,p=>{const g=((e,t)=>{const n=nT(e,t);return Object(F.db)({standardTextStyles:n.standardTextStyles,downloadLink:n.downloadLink,title:n.title,errorReportTitleStyles:n.errorReportTitleStyles})})(p,this.dialogCharacterFixEnabled);return R.createElement(Zk.a,_object_spread_props(_object_spread({},this.props),{titleText:void 0,focusDefaultButtonWhenOpened:!0,describedById:this.dialogContentsId,isAlert:!0}),R.createElement("div",{id:this.dialogContentsId},R.createElement("div",null,e&&R.createElement("span",{className:g.title,id:"ReactDialogText"},e),t&&R.createElement(tT,_object_spread_props(_object_spread({},t),{customStyles:oT(p,this.dialogCharacterFixEnabled)})),n&&R.createElement(Mu.a,_object_spread({},n))),o&&R.createElement("div",{className:g.downloadLink},R.createElement(Mu.a,_object_spread({},o))),r&&R.createElement("div",{className:g.standardTextStyles},R.createElement(Mu.a,_object_spread({},r))),(i||a)&&R.createElement("div",{className:g.standardTextStyles},i&&R.createElement("div",null,i," "),a&&R.createElement(Mu.a,_object_spread_props(_object_spread({},a),{role:"button"}))),s&&R.createElement("div",{className:g.standardTextStyles},R.createElement("span",null,s)),(c||u||d)&&R.createElement("div",{className:g.standardTextStyles},c&&R.createElement("div",{className:g.errorReportTitleStyles},c),u&&R.createElement("div",null,u),d&&R.createElement("div",{className:g.standardTextStyles},R.createElement(Mu.a,_object_spread({},d)))),l&&R.createElement("div",{className:g.standardTextStyles},R.createElement(bu.a,_object_spread_props(_object_spread({},l),{styles:Object(F.db)({root:{padding:"0"}}),checked:this.state.permanentDismissCheckboxChecked,onExecute:this.permanentDismissCheckboxOnExecute})))))}))}constructor(){super(...arguments),this.dialogContentsId="DialogContents",this.dialogCharacterFixEnabled=Object(Zf.a)(this.context,Zf.f.dialogCharacterFixEnabled),this.state={permanentDismissCheckboxChecked:!1},this.permanentDismissCheckboxOnExecute=()=>{this.props.permanentDismissCheckbox&&this.setState(e=>({permanentDismissCheckboxChecked:!e.permanentDismissCheckboxChecked}),()=>{var e,t;null===(e=this.props.permanentDismissCheckbox)||void 0===e||null===(t=e.onExecute)||void 0===t||t.call(e,{id:this.props.permanentDismissCheckbox.id,checked:this.state.permanentDismissCheckboxChecked})})}}}bT.contextType=Hm.a;const fT=R.forwardRef((e,t)=>Object(mT.a)()?R.createElement(hT,_object_spread_props(_object_spread({},e),{ref:t})):R.createElement(bT,_object_spread({},e))),xT={root:{paddingTop:0,paddingLeft:0,paddingRight:0,paddingBottom:0,width:380}},ET={paddingTop:16},ST={paddingTop:20,display:"flex",justifyContent:"space-between"},yT={paddingTop:5};class CT extends R.PureComponent{render(){return void 0!==this.props.microphoneErrorDialogProps?R.createElement(SR.a,_object_spread_props(_object_spread({},this.props),{dialogIcon:this.props.dialogIcon,bodyRendererFunction:this.bodyRendererFunction,resultHandler:this.props.resultHandler,dialogButtonsOption:ER.b.None,maxWidth:450})):R.createElement(fT,_object_spread_props(_object_spread({},this.props),{type:"StandardDialogProps",resultHandler:this.props.resultHandler,dialogIcon:this.props.dialogIcon,dialogButtonsOption:ER.b.Ok,actionButtonProps:{type:"AppButtonProps",title:this.props.primaryButtonLabel,label:this.props.primaryButtonLabel,id:"closeButton"},titleText:this.props.contentLabel,helpLink:void 0}))}renderMicrophoneErrorDialog(e){const{micPermissionsDialogImageSrc:t,micPermissionsDialogImageAltText:n,learnMoreLink:o}=this.props.microphoneErrorDialogProps;return R.createElement("div",null,R.createElement(Yl.a,{type:"AppLabelProps",forId:"AppLabelProps",label:this.props.contentLabel,id:"contentLabel",styles:xT}),R.createElement("img",{src:t,style:ET,alt:n}),R.createElement("div",{style:ST},R.createElement("div",{style:yT},R.createElement(Mu.a,_object_spread_props(_object_spread({},o),{type:"AppLinkProps",id:"learnMoreLink"}))),R.createElement(Ko.a,{id:"tryAgainButton",label:this.props.primaryButtonLabel,type:"AppButtonProps",onExecute:this.onClickHandler,styles:e.primaryButton})),void 0)}onClickHandler(e){this.props.resultHandler(ER.a.Retry)}renderHelpTextDebugLink(e){return void 0===e?void 0:R.createElement(Mu.a,_object_spread_props(_object_spread({},e),{type:"AppLinkProps",id:"helpTextDebugLink"}))}constructor(e){super(e),this.bodyRendererFunction=()=>R.createElement(we.a,null,e=>{const t=Object(CR.h)(e,this.props.sharedDialogStyles);return this.renderMicrophoneErrorDialog(t)}),this.onClickHandler=this.onClickHandler.bind(this)}}const vT=["Permission dismissed","Permission denied","Requested device not found","The request is not allowed by the user agent or the platform in the current context.","Could not start audio source","Device in use","Permission denied by system","Concurrent mic process limit."],RT=["PermissionDeniedError","NotFoundError","NotAllowedError","PermissionDismissedError","NotSupportedError","MediaDeviceNotSupported","DevicesNotFoundError","TrackStartError"];function kT(e){return e&&(e.message&&-1!==vT.indexOf(e.message)||e.name&&-1!==RT.indexOf(e.name)||"OverconstrainedError"===e.name&&"deviceId"===e.constraint)}function TT(e){let t="Exception: ";try{t+=JSON.stringify(e)}catch(e){i.a.sendTraceTag(540947140,a.a.msoulscat_Wac_Dictation,s.a.Error,`ErrorStringFromException error: ${e.message} ${e.stack}`)}return e&&(e.name&&(t+=", name: "+e.name),e.code&&(t+=", code: "+e.code),e.message&&(t+=", message: "+e.message),e.constraint&&(t+=", constraint: "+e.constraint),e.stack&&(t+=", stack: "+e.stack)),t}function _T(e){return{neutralPrimary:Object(ix.c)()?e.palette.neutralPrimary:Yo.a.gray160,neutralQuaternary:Object(ix.c)()?e.palette.neutralQuaternary:Yo.a.gray60}}const wT={paddingBottom:4};function DT(e,t){return{root:{paddingTop:e,paddingLeft:0,paddingRight:0},label:{paddingTop:0,paddingBottom:0,color:_T(t).neutralPrimary}}}const PT={container:{margin:0}},IT={optionText:{whiteSpace:"normal"},root:{height:"100%",width:440,maxWidth:440}},FT={marginTop:6,marginBottom:8,borderSpacing:0,width:"100%",display:"flex",justifyContent:"space-between"};function BT(e){return{root:{paddingTop:8},label:{color:_T(e).neutralPrimary}}}function MT(e,t){return{primaryButton:{root:{backgroundColor:Object(ox.a)(e,t).primaryDefaultBackgroundColor}},title:{color:_T(e).neutralPrimary}}}const jT={borderSpacing:0},OT={width:20,height:20},LT={width:6,height:16,paddingLeft:8};function AT(e,t,n){return{root:{padding:0,selectors:{"svg > path[class*='OfficeIconColors_mDictation']":{fill:e?Object(ox.a)(t,n).textDisabledColorForPrimaryBackground:_T(t).neutralPrimary}}}}}const NT=e=>({root:{padding:0,width:6,height:16,selectors:e}});function WT(e){return NT({"svg > rect":{fill:_T(e).neutralQuaternary}})}function zT(e,t){return NT({"svg > rect":{fill:Object(ox.a)(e,t).primaryDefaultBackgroundColor},[F.m]:{"svg > rect":{fill:"Highlight"}}})}var HT=n(2821),VT=n.n(HT);class UT extends R.PureComponent{componentDidMount(){var e=this;return _async_to_generator((function*(){e._isMounted=!0,yield e.resetAndRunMicAudioCaptureWithVolumeMeterUpdateLoop()}))()}componentWillUnmount(){this.cleanup(),this._isMounted=!1}componentDidUpdate(e,t){var n=this;return _async_to_generator((function*(){e.deviceId!==n.props.deviceId&&(yield n.resetAndRunMicAudioCaptureWithVolumeMeterUpdateLoop())}))()}render(){return R.createElement(we.a,null,e=>R.createElement("table",{style:jT,title:this.state.helpText},R.createElement("tbody",null,R.createElement("tr",null,R.createElement("td",{style:OT},this.getMicIcon(e)),R.createElement("td",null,this.getVolumeBar(e,this.state.currentVolume))))))}getMicIcon(e){return R.createElement(fe.a,{id:"MicIcon",iconName:VT.a.VoicedictationGray_24,theme:e,styles:AT(this.state.isDisabled,e,this.props.appColors)})}getVolumeBar(e,t){const n=[];for(let e=0;e<this.props.countPills;e+=1)n.push(e);return R.createElement("table",{style:jT},R.createElement("tbody",null,R.createElement("tr",null,n.map(n=>{const o=n<t;return R.createElement("td",{key:n,style:LT},R.createElement(fe.a,{id:"VolumeBarPill"+n,iconName:o?VT.a.VolumePillBlue:VT.a.VolumePillGray,theme:e,styles:o?zT(e,this.props.appColors):WT(e)}))}))))}cleanup(){if(this.timer&&(window.clearInterval(this.timer),this.timer=void 0),this.audioSource){var e;const t=null===(e=this.audioSource.mediaStream)||void 0===e?void 0:e.getAudioTracks();if(t)for(const e of t)null==e||e.stop();this.audioSource.disconnect(),this.audioSource=void 0}}resetAndRunMicAudioCaptureWithVolumeMeterUpdateLoop(){var e=this;return _async_to_generator((function*(){if(e._isMounted)if(e.cleanup(),navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){if(e.props.deviceId)try{const t=yield navigator.mediaDevices.getUserMedia({audio:{deviceId:{exact:e.props.deviceId}}}),n=window.AudioContext||window.webkitAudioContext;if(null===n)return void e.setState({helpText:DictationStringsManager.get(DictationStringsEnum.UnsupportedBrowserLabel),isDisabled:!0});const o=new n;e.audioSource=o.createMediaStreamSource(t);const r=o.createAnalyser();r.fftSize=2048,r.minDecibels=-100,r.maxDecibels=-40,r.smoothingTimeConstant=0,e.audioSource.connect(r);const i=new Uint8Array(r.frequencyBinCount),a=Math.abs(r.minDecibels-r.maxDecibels),s=()=>{r.getByteFrequencyData(i);let t=0;i.forEach(e=>{t+=e});const n=t/i.length;n<1?e.setState({currentVolume:0,isDisabled:!1,helpText:DictationStringsManager.get(DictationStringsEnum.MicrophoneMutedLabel)}):e.setState({currentVolume:n/a*e.props.countPills,isDisabled:!1,helpText:""})};e.timer=window.setInterval(s,200)}catch(t){i.a.sendTraceTag(570766667,a.a.msoulscat_Wac_Dictation,kT(t)?s.a.Info:s.a.Error,`AppMicVolumeBar error: ${t.message} ${t.stack}`),e.setState({helpText:DictationStringsManager.get(DictationStringsEnum.UnsupportedBrowserLabel),isDisabled:!0})}}else e.setState({helpText:DictationStringsManager.get(DictationStringsEnum.UnsupportedBrowserLabel),isDisabled:!0})}))()}constructor(e){super(e),this._isMounted=!1,this.state={currentVolume:0,isDisabled:!1,helpText:void 0}}}class GT extends R.PureComponent{componentDidMount(){var e=this;return _async_to_generator((function*(){if(e.isMicrophoneSettingEnabled())try{yield e.getMicrophoneOptionsAndUpdateState(),navigator.mediaDevices.ondevicechange=(t=_async_to_generator((function*(t){yield e.getMicrophoneOptionsAndUpdateState()})),function(e){return t.apply(this,arguments)})}catch(e){i.a.sendTraceTag(544018691,a.a.msoulscat_Wac_Dictation,s.a.Error,"DictationSettingsDialog.componentDidMount error: "+TT(e))}else e.setState({MicrophoneControlDisabled:!0,MicrophoneControlErrorTooltip:DictationStringsManager.get(DictationStringsEnum.UnsupportedBrowserLabel)});var t}))()}componentDidUpdate(e,t){var n=this;return _async_to_generator((function*(){n.firstGetUserMediaUpdateDone&&t.MicrophoneState===n.state.MicrophoneState&&e.MicrophoneState===n.props.MicrophoneState||(yield n.ensureMicPermissionsGetMicrophoneOptionsAndUpdateState(n.state.MicrophoneState))}))()}cleanup(){if(this.mediaStream){const e=this.mediaStream.getAudioTracks();if(e)for(const t of e)null==t||t.stop();this.mediaStream=void 0}}componentWillUnmount(){this.cleanup()}render(){return R.createElement(we.a,null,e=>R.createElement(SR.a,_object_spread_props(_object_spread({},this.props),{bodyRendererFunction:()=>this.bodyRendererFunction(e),resultHandler:this.closeDialogHandler,dialogButtonsOption:ER.b.OkCancel,actionButtonProps:{type:"AppButtonProps",title:DictationStringsManager.get(DictationStringsEnum.DictationSettingSaveButtonLabel),label:DictationStringsManager.get(DictationStringsEnum.DictationSettingSaveButtonLabel),id:"saveButtonId"},maxWidth:480,sharedDialogStyles:MT(e,this.props.appColors)})))}getLanguageSettingControl(e){return this.getSettingWithLabelAndComboBox(DictationStringsManager.get(DictationStringsEnum.DictationSettingsLanguage),"languageSettingLabel",function(e){return DT(16,e)}(e),"languageSettingControl",this.state.LanguageState,this.getLanguageOptions(),this.onLangugageChange,Se.a.topCenter)}isMicrophoneSettingEnabled(){return!!(navigator&&navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices&&navigator.mediaDevices.getUserMedia)}getMicrophoneSettingControl(e){return this.getSettingWithLabelAndComboBox(DictationStringsManager.get(DictationStringsEnum.MicrophoneLabel),"microphoneSettingLabel",function(e){return DT(18,e)}(e),"microphoneSettingControl",this.state.MicrophoneState,this.state.MicrophoneOptions,this.onMicrophoneChange,void 0,this.state.MicrophoneControlDisabled,this.state.MicrophoneControlErrorTooltip)}getMicrophoneVolumeAndHelpLinkControls(){return R.createElement("div",{style:FT},R.createElement("div",null,R.createElement(UT,{deviceId:this.state.MicrophoneState,countPills:10,appColors:this.props.appColors})),R.createElement("div",{"aria-label":this.props.MicProblemsLink.text},R.createElement(Mu.a,_object_spread({},this.props.MicProblemsLink))))}getAutoPunctuationSettingControl(e){return this.getSettingToggle("autoPunctuationSettingControl",this.state.AutoPunctuationState,this.onAutoPunctuationChange,DictationStringsManager.get(DictationStringsEnum.DictationSettingsAutoPunctuation),e)}getProfanityFilterSettingControl(e){return this.getSettingToggle("profanityFilterSettingControl",this.state.ProfanityFilterState,this.onProfanityFilterChange,DictationStringsManager.get(DictationStringsEnum.DictationSettingsProfanityFilter),e)}getQuickAccessInterfaceSettingControl(e){return Object(bR.k)()?this.getSettingToggle("quickAccessInterfaceSettingControl",this.state.QuickAccessInterfaceState,this.onQuickAccessInterfaceChange,"Show Dictation quick access interface",e):void 0}getSettingWithLabelAndComboBox(e,t,n,o,r,i,a,s,l=!1,c){return R.createElement("div",null,this.getSettingLabel(o,e,t,n),R.createElement(Wc.a,{id:o,type:"AppComboBoxProps",label:e,width:440,styles:PT,allowFreeForm:!1,selectedKey:r,downChevronIcon:Object(Ev.a)().downChevron.icon12,options:i,onExecute:a,disabled:l,customTooltip:c,tooltipDirection:s,optionStyles:IT}))}getSettingLabel(e,t,n,o){return R.createElement(Yl.a,{type:"AppLabelProps",forId:e,label:t,id:n,styles:o})}getSettingToggle(e,t,n,o,r){return R.createElement(Ml.a,{type:"AppToggleProps",id:e,label:o,inlineLabel:!0,checked:t,onChange:n,appColors:this.props.appColors,ariaLabel:o,styles:BT(r)})}ensureMicPermissionsGetMicrophoneOptionsAndUpdateState(e){var t=this;return _async_to_generator((function*(){if(t.isMicrophoneSettingEnabled())try{const n=yield navigator.mediaDevices.getUserMedia({audio:{deviceId:{exact:e}}});t.mediaStream!==n&&(t.cleanup(),t.mediaStream=n),t.firstGetUserMediaUpdateDone=!0,yield t.getMicrophoneOptionsAndUpdateState()}catch(e){i.a.sendTraceTag(562157331,a.a.msoulscat_Wac_Dictation,kT(e)?s.a.Info:s.a.Error,"ensureMicPermissionsGetMicrophoneOptionsAndUpdateState error: "+TT(e))}}))()}getMicrophoneOptionsAndUpdateState(){var e=this;return _async_to_generator((function*(){try{const t=yield e.getMicrophoneOptions();if(e.setState({MicrophoneOptions:t}),t.length>0){const n=e.getSelectedMicKeyFromOptions(t);n!==e.state.MicrophoneState&&e.setState({MicrophoneState:n}),e.firstGetUserMediaUpdateDone||(yield e.ensureMicPermissionsGetMicrophoneOptionsAndUpdateState(n))}}catch(e){i.a.sendTraceTag(562157332,a.a.msoulscat_Wac_Dictation,s.a.Error,"getMicrophoneOptionsAndUpdateState error: "+TT(e))}}))()}getSelectedMicKeyFromOptions(e){if(!this.state.MicrophoneState)return e[0].key;let t=!1;for(let n=0;n<e.length;n+=1)if(e[n].key===this.state.MicrophoneState){t=!0;break}return t?this.state.MicrophoneState:e[0].key}getMicrophoneOptions(){var e=this;return _async_to_generator((function*(){try{const t=[],n=yield navigator.mediaDevices.enumerateDevices(),o=new Map;return n.forEach((function(e){"audioinput"!==e.kind||"default"===e.deviceId||"communications"===e.deviceId||o.has(e.groupId)||(t.push({type:"AppComboBoxItem",key:e.deviceId,text:e.label}),o.set(e.groupId,"added"))})),t.length<=0?e.setState({MicrophoneControlDisabled:!0,MicrophoneControlErrorTooltip:DictationStringsManager.get(DictationStringsEnum.NoMicrophoneDetectedLabel)}):e.setState({MicrophoneControlDisabled:!1,MicrophoneControlErrorTooltip:void 0}),t}catch(t){return e.setState({MicrophoneControlDisabled:!0,MicrophoneControlErrorTooltip:DictationStringsManager.get(DictationStringsEnum.UnsupportedBrowserLabel)}),Promise.reject("getMicrophoneOptions error: "+TT(t))}}))()}isPrivatePreviewLanguagesEnabled(){return!(!this.props.PrivatePreviewSupportLanguages||!this.props.PrivatePreviewLanguagesHeader)&&this.props.PrivatePreviewSupportLanguages.length>0}getLanguageOptions(){const e=[];return this.props.ProductionSupportLanguages.forEach(t=>{e.push({type:"AppComboBoxItem",key:t.Tag,text:t.Name})}),e.push({type:"AppComboBoxDivider",key:"divider"}),e.push({type:"AppComboBoxHeader",key:"previewLanguagesHeader",text:this.props.PreviewLanguagesHeader}),this.props.PreviewSupportLanguages.forEach(t=>{e.push({type:"AppComboBoxItem",key:t.Tag,text:t.Name})}),this.isPrivatePreviewLanguagesEnabled()&&(e.push({type:"AppComboBoxDivider",key:"divider"}),e.push({type:"AppComboBoxHeader",key:"privatePreviewLanguagesHeader",text:this.props.PrivatePreviewLanguagesHeader}),this.props.PrivatePreviewSupportLanguages.forEach(t=>{e.push({type:"AppComboBoxItem",key:t.Tag,text:t.Name})})),e}constructor(e){super(e),this.firstGetUserMediaUpdateDone=!1,this.bodyRendererFunction=e=>R.createElement("div",{style:wT},this.getLanguageSettingControl(e),this.getMicrophoneSettingControl(e),this.getMicrophoneVolumeAndHelpLinkControls(),this.getAutoPunctuationSettingControl(e),this.getProfanityFilterSettingControl(e),this.getQuickAccessInterfaceSettingControl(e)),this.onLangugageChange=e=>{this.setState({LanguageState:e.newValue.key})},this.onMicrophoneChange=e=>{this.setState({MicrophoneState:e.newValue.key})},this.onAutoPunctuationChange=(e,t)=>{this.setState({AutoPunctuationState:t})},this.onProfanityFilterChange=(e,t)=>{this.setState({ProfanityFilterState:t})},this.onQuickAccessInterfaceChange=(e,t)=>{this.setState({QuickAccessInterfaceState:t})},this.closeDialogHandler=e=>{e===ER.a.Ok?this.props.resultHandler(e,{LanguageState:this.state.LanguageState,AutoPunctuationState:this.state.AutoPunctuationState,MicrophoneState:this.state.MicrophoneState,ProfanityFilterState:this.state.ProfanityFilterState,QuickAccessInterfaceState:this.state.QuickAccessInterfaceState}):this.props.resultHandler(e)},this.state={LanguageState:e.LanguageState,MicrophoneOptions:[],MicrophoneState:null==e.MicrophoneState?void 0:e.MicrophoneState,MicrophoneControlDisabled:!1,MicrophoneControlErrorTooltip:void 0,AutoPunctuationState:e.AutoPunctuationState,ProfanityFilterState:e.ProfanityFilterState,QuickAccessInterfaceState:e.QuickAccessInterfaceState}}}class qT extends R.Component{render(){return R.createElement(SR.a,_object_spread_props(_object_spread({},this.props),{bodyRendererFunction:this.bodyRendererFunction,resultHandler:this.resultHandler}))}constructor(e){super(e),this.resultHandler=e=>{const t={selectedOption:this.state.selectedOption};this.props.resultHandler(e,t)},this.bodyRendererFunction=()=>{const{dialogChoiceGroupProps:e}=this.props.bodyProps;return R.createElement(jl.a,_object_spread_props(_object_spread({},e),{onChange:this.onChoiceGroupChange}))},this.onChoiceGroupChange=e=>{this.setState({selectedOption:e.key})};const{dialogChoiceGroupProps:t}=e.bodyProps;this.state={selectedOption:t.defaultSelectedKey||""}}}const QT=Object(Jo.c)(e=>{const t=Object(ih.a)(e),n=Object(ix.c)()?e.palette.neutralDark:Yo.a.gray180;return{sectionContainer:{padding:"0 10px"},sectionTitle:{root:{padding:0},label:{fontSize:F.k.large,fontWeight:F.l.semibold,color:t.textColor}},settingsCheckbox:{root:{padding:0,marginTop:"10px"},checkbox:{borderColor:n},text:{color:t.textColor}}}});class KT extends R.PureComponent{render(){return R.createElement(we.a,null,e=>R.createElement(SR.a,_object_spread_props(_object_spread({},this.props),{headerText:AccessibilitySettingsDialogStringsManager.get(AccessibilitySettingsDialogStringsEnum.AccessibilitySettingsDialogTitle),bodyRendererFunction:this.bodyRendererFunction(e),resultHandler:this.resultHandler})))}constructor(e){super(e),this.tooltipPersistenceGroupId="tooltipPersistenceGroup",this.tooltipPersistenceGroupLabelId="tooltipPersistenceGroupLabel",this.textSelectionGroupId="textSelectionGroup",this.textSelectionGroupLabelId="textSelectionGroupLabel",this.bodyRendererFunction=e=>{const t=QT(e),n=(e=>{const t=Object(ih.a)(e);return Object(F.db)({sectionDescription:{color:t.textColor}})})(e);return()=>R.createElement("div",null,R.createElement("div",{role:"group",id:this.tooltipPersistenceGroupId,"aria-labelledby":this.tooltipPersistenceGroupLabelId,style:t.sectionContainer},R.createElement(Yl.a,{id:this.tooltipPersistenceGroupLabelId,type:"AppLabelProps",forId:this.tooltipPersistenceGroupId,label:AccessibilitySettingsDialogStringsManager.get(AccessibilitySettingsDialogStringsEnum.TooltipPersistenceTitle),styles:t.sectionTitle}),R.createElement("div",{className:n.sectionDescription},AccessibilitySettingsDialogStringsManager.get(AccessibilitySettingsDialogStringsEnum.TooltipPersistenceDescription)),R.createElement(bu.a,{type:"AppCheckboxProps",id:"tooltipPersistenceCheckbox",label:AccessibilitySettingsDialogStringsManager.get(AccessibilitySettingsDialogStringsEnum.EnableTooltipPersistence),checkmarkIcon:this.props.checkmarkIcon||"",checked:this.state.tooltipPersistenceEnabled,onExecute:this.onCheckboxChange,styles:t.settingsCheckbox})),R.createElement("div",{role:"group",id:this.textSelectionGroupId,"aria-labelledby":this.textSelectionGroupLabelId,style:t.sectionContainer},R.createElement(Yl.a,{id:this.textSelectionGroupLabelId,type:"AppLabelProps",forId:this.textSelectionGroupId,label:AccessibilitySettingsDialogStringsManager.get(AccessibilitySettingsDialogStringsEnum.AccessibleTextSelectionTitle),styles:t.sectionTitle}),R.createElement("div",{className:n.sectionDescription},AccessibilitySettingsDialogStringsManager.get(AccessibilitySettingsDialogStringsEnum.AccessibleTextSelectionDescription)),R.createElement(bu.a,{type:"AppCheckboxProps",id:"textSelectionHighlightCheckbox",label:AccessibilitySettingsDialogStringsManager.get(AccessibilitySettingsDialogStringsEnum.EnableTextSelectionHighlight),checkmarkIcon:this.props.checkmarkIcon||"",checked:this.state.textSelectionChangeEnabled,onExecute:this.onTextSelectionCheckboxChange,styles:t.settingsCheckbox})))},this.onCheckboxChange=()=>{this.setState({tooltipPersistenceEnabled:!this.state.tooltipPersistenceEnabled})},this.onTextSelectionCheckboxChange=()=>{this.setState({textSelectionChangeEnabled:!this.state.textSelectionChangeEnabled})},this.resultHandler=e=>{this.previousTextSelectionValue!==this.state.textSelectionChangeEnabled&&i.a.sendTraceTag(508864476,a.a.msoulscat_Wac_Telemetry,s.a.Info,"User Modified Text Selection Highlight setting. New value: "+this.state.textSelectionChangeEnabled),this.props.resultHandler(e,{tooltipPersistenceEnabled:this.state.tooltipPersistenceEnabled,textSelectionChangeEnabled:this.state.textSelectionChangeEnabled})},this.previousTextSelectionValue=e.bodyControls.textSelectionChangeEnabled,this.state={tooltipPersistenceEnabled:e.bodyControls.tooltipPersistenceEnabled,textSelectionChangeEnabled:e.bodyControls.textSelectionChangeEnabled}}}const JT=Object(Jo.c)(()=>({containingDivStyles:{width:CR.a},input:{field:["nameInputField"],root:{"input[type=text]":{paddingLeft:"2px",paddingRight:"2px"},textarea:{paddingLeft:"2px",paddingRight:"2px"}},subComponentStyles:{label:{root:{fontWeight:F.l.semibold}}}}}));class YT extends R.Component{render(){return R.createElement(SR.a,_object_spread_props(_object_spread({},this.props),{bodyRendererFunction:this.bodyRendererFunction,resultHandler:this.altTextDialogResultHandler}))}constructor(e){super(e),this.bodyRendererFunction=()=>{const e=JT();return R.createElement("div",{style:e.containingDivStyles},!this.state.hideTitleField&&R.createElement(Xd.a,{id:"AltTextDialog-Title",type:"AppInputProps",value:this.state.titleText,maxLength:100,autoComplete:"off",spellCheck:!1,label:OfficeCommonStringsManager.get(OfficeCommonStringsEnum.Title),styles:e.input,onChange:this.onTitleInputChange}),R.createElement(Xd.a,{id:"AltTextDialog-Description",type:"AppInputProps",value:this.state.descriptionText,multiline:!0,autoComplete:"off",spellCheck:!1,label:OfficeCommonStringsManager.get(OfficeCommonStringsEnum.Description),styles:e.input,onChange:this.onDescriptionInputChange}))},this.onTitleInputChange=e=>{this.setState({titleText:null!=e?e:""})},this.onDescriptionInputChange=e=>{this.setState({descriptionText:null!=e?e:""})},this.altTextDialogResultHandler=e=>{const t={};e===ER.a.Ok&&(t.titleText=this.state.titleText,t.descriptionText=this.state.descriptionText),this.props.resultHandler(e,t)},this.state={titleText:e.bodyControls.titleText||"",descriptionText:e.bodyControls.descriptionText||"",hideTitleField:e.bodyControls.hideTitleField||!1}}}function ZT(e){return R.createElement(YT,_object_spread({},e))}const $T={border:"none",display:"block",maxWidth:"100%"},XT={root:{},main:{selectors:{".ms-Dialog-inner":{padding:"0px"}}}};class e_ extends R.PureComponent{render(){return R.createElement(SR.a,_object_spread_props(_object_spread({styles:XT},this.props),{bodyRendererFunction:this.bodyRendererFuction,isWide:!0}))}componentDidMount(){window.addEventListener("message",this.props.bodyControls.onMessage)}componentWillUnmount(){window.removeEventListener("message",this.props.bodyControls.onMessage)}constructor(){super(...arguments),this.bodyRendererFuction=()=>{const{id:e,src:t,sandbox:n,width:o,height:r}=this.props.bodyControls;return R.createElement("div",{style:{width:"100%"}},R.createElement(Vk.a,{type:"AppIFrameProps",id:e,src:t,style:$T,width:o,height:r,sandbox:n}))}}}const t_={root:{},main:{selectors:{".ms-Dialog-inner":{padding:"0px"}}}};class n_ extends R.PureComponent{render(){return R.createElement(SR.a,_object_spread_props(_object_spread({styles:t_},this.props),{bodyRendererFunction:this.bodyRendererFuction,isWide:!0}))}componentDidMount(){const e=document.getElementById("WACDialogOuterContainer");new MutationObserver((e,t)=>{for(const n of e)n.addedNodes.forEach(e=>{e instanceof HTMLElement&&e.childNodes.length>0&&(t.disconnect(),this.setState({isLoaded:!0}))})}).observe(e,{childList:!0,subtree:!0})}componentDidUpdate(){this.state.isLoaded&&this.props.bodyControls.populateContent()}constructor(e){super(e),this.bodyRendererFuction=()=>{const{width:e,height:t}=this.props.bodyControls;return R.createElement("div",{style:(n=e,o=t,{width:n,height:o}),className:"appsForOfficeInsertDialogContainer"});var n,o},this.state={isLoaded:!1}}}const o_=Object(Jo.c)(e=>Object(F.eb)({display:"flex",justifyContent:e?"left":"right"})),r_=Object(Jo.c)((e,t)=>Object(F.eb)({visibility:e&&t?"visible":"hidden",height:e&&t?"auto":"0px"})),i_=Object(F.eb)({display:"flex",flexDirection:"column",width:"600px",minHeight:"120px"}),a_=Object(F.eb)({display:"flex",flexDirection:"column"}),s_=Object(F.eb)({paddingBottom:"16px",flex:"1"}),l_=Object(F.eb)({flex:"1",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"});var c_=n(303);class u_ extends R.PureComponent{render(){return R.createElement("div",{id:"sharedAuthFrameInnerContainer",className:o_(this.props.rtl),ref:this.props.frameRef})}}class d_ extends R.PureComponent{render(){const{errorText:e,frameLoaded:t,frameLoadSuccess:n}=this.props.bodyControls;return t&&!n?R.createElement(fT,_object_spread_props(_object_spread({},this.props),{type:"StandardDialogProps",dialogButtonsOption:this.props.dialogButtonsOption,titleText:e})):R.createElement(SR.a,_object_spread_props(_object_spread({},this.props),{bodyRendererFunction:this.bodyRendererFunction,resultHandler:this.sharedAuthConsentDialogResultHandler}))}componentDidUpdate(){const{frameLoaded:e,frameLoadSuccess:t}=this.props.bodyControls;if(e&&!t){const e=document.getElementById("DialogCancelButton");null==e||e.focus()}}constructor(e){super(e),this.baseResultHandler=this.props.resultHandler,this.frame=this.props.bodyControls.createFrame(),this.ref=e=>e&&e.appendChild(this.frame),this.bodyRendererFunction=()=>{const{sharedDialogStyles:e}=this.props,{promptMessage:t,frameLoaded:n,frameLoadSuccess:o,rtl:r,resolveDialogStyles:i}=this.props.bodyControls;return R.createElement(we.a,null,a=>(this.dialogStyles||(this.dialogStyles=Object(CR.h)(a,e),i(this.dialogStyles)),R.createElement("div",{id:"sharedAuthDialogContainer",className:Object(c_.a)("SharedOnline.ChangeGate.updateSharedAuthDialogStyle")?i_:a_},!n&&(Object(c_.a)("SharedOnline.ChangeGate.updateSharedAuthDialogStyle")?R.createElement("div",{id:"frameLoadingAppSpinnerDiv`",className:l_},R.createElement(gm.a,{id:"frameLoadingAppSpinner",type:"AppSpinnerProps",appColors:this.props.appColors,label:OfficeCommonStringsManager.get(OfficeCommonStringsEnum.SpinnerFallbackTooltipLabel)})):R.createElement(gm.a,{id:"frameLoadingAppSpinner",type:"AppSpinnerProps",appColors:this.props.appColors,label:OfficeCommonStringsManager.get(OfficeCommonStringsEnum.SpinnerFallbackTooltipLabel)})),n&&o&&R.createElement("div",{id:"promptMessageContainer",className:s_,"aria-hidden":!!this.state.ariaHidePrompt||void 0},t),R.createElement("section",{id:"sharedAuthFrameOuterContainer",className:r_(n,o),tabIndex:-1,onFocus:()=>this.setState({ariaHidePrompt:!0})},R.createElement(u_,{frameRef:this.ref,rtl:r})))))},this.sharedAuthConsentDialogResultHandler=e=>{this.baseResultHandler(e)},this.state={}}}const p_={display:"flex",marginTop:"8px",padding:"0 0 0 0"},g_=Object(Jo.c)(()=>({spinButtonStyles:{root:p_,labelWrapper:{flex:1,float:"none",height:"24px",maxWidth:"128px"},label:{lineHeight:"20px"},spinButtonWrapper:{flex:1,height:"24px",maxWidth:"100px"}}}));class h_ extends R.PureComponent{render(){return R.createElement(SR.a,_object_spread_props(_object_spread({},this.props),{bodyRendererFunction:this.bodyRendererFunction,resultHandler:this.tableSizeDialogResultHandler}))}constructor(e){super(e),this.baseResultHandler=this.props.resultHandler,this.bodyRendererFunction=()=>{const{columnsSpinButtonProps:e,rowsSpinButtonProps:t}=this.props.bodyProps,n=g_();return R.createElement("div",{className:Object(F.eb)({paddingTop:"0px",paddingBottom:"12px",paddingRight:"100px",width:"250px",selectors:{"@media only screen and (max-width: 500px)":{maxWidth:"300px",flexWrap:"wrap"}}},void 0)},e&&R.createElement(fc.a,_object_spread_props(_object_spread({},e),{value:this.state.columns,styles:n.spinButtonStyles,onExecute:this.onColumnsSpinButtonChange})),t&&R.createElement(fc.a,_object_spread_props(_object_spread({},t),{value:this.state.rows,styles:n.spinButtonStyles,onExecute:this.onRowsSpinButtonChange})))},this.tableSizeDialogResultHandler=e=>{const t={rows:this.state.rows,columns:this.state.columns};this.baseResultHandler(e||ER.a.Cancel,t)},this.onColumnsSpinButtonChange=e=>{this.setState({columns:e.value})},this.onRowsSpinButtonChange=e=>{this.setState({rows:e.value})},this.state={columns:this.props.bodyProps.columnsSpinButtonProps.value,rows:this.props.bodyProps.rowsSpinButtonProps.value}}}var m_,b_;!function(e){e[e.PopularList=0]="PopularList",e[e.SearchResult=1]="SearchResult",e[e.StoreDetail=2]="StoreDetail",e[e.CategoriesDetail=3]="CategoriesDetail"}(m_||(m_={})),function(e){e[e.Single=1]="Single",e[e.Double=2]="Double",e[e.Triple=3]="Triple",e[e.SingleWithNoSidebar=4]="SingleWithNoSidebar"}(b_||(b_={}));const f_={viewType:m_.PopularList,columnType:b_.Triple,popularAddins:[],searchResults:[],addinDetail:void 0,isSearchResult:!1,trendingAddins:[],categoriesAddins:{},source:"",isStoreDetailPageCover:!1,selectedCategory:"",showCalloutItemId:""},x_=R.createContext({state:f_,setState:e=>e}),E_=({children:e})=>{const[t,n]=R.useState(f_);return R.createElement(x_.Provider,{value:{state:t,setState:n}},e)},S_=R.createContext({}),y_=()=>R.useContext(S_),C_="https://appsource.microsoft.com/en-us/product/office/";var v_;!function(e){e.ListedSections="AddinDialogControlListedSections",e.ListedSectionsSection="AddinDialogControlListedSectionsSection",e.ListedSectionsSectionTitle="AddinDialogControlListedSectionsSectionTitle",e.ListedSectionsSectionSeeAllButton="AddinDialogControlListedSectionsSectionSeeAllButton",e.ListedSectionsSectionList="AddinDialogControlListedSectionsSectionList",e.LabeledTabs="AddinDialogControlLabeledTabs",e.LabeledTabsLabelButton="AddinDialogControlLabeledTabsLabelButton",e.LabeledTabsTab="AddinDialogControlLabeledTabsTab",e.LabeledTabsTabList="AddinDialogControlLabeledTabsTabList",e.TrendingTitle="AddinDialogControlTrendingTitle",e.TrendingList="AddinDialogControlTrendingList",e.TrendingListItem="AddinDialogControlTrendingListItem",e.SearchBox="AddinDialogControlSearchBox",e.SearchResultsView="AddinDialogControlSearchResultsView",e.SearchResultsViewTitle="AddinDialogControlSearchResultsViewTitle",e.SearchResultsViewList="AddinDialogControlSearchResultsViewList",e.NoSearchResultsView="AddinDialogControlNoSearchResultsView",e.MultiActionButton="AddinDialogControlMultiActionButton",e.AddInListItemWrapper="AddinDialogControlAddInListItemWrapper",e.Root="AddinDialogControlRoot",e.ScrollerContainer="AddinDialogControlScrollerContainer",e.FooterButton="AddinDialogControlFooterButton",e.DataLoadingSpinner="AddinDialogControlDataLoadingSpinner",e.MRUFullGallery="AddinDialogControlMRUFullGallery"}(v_||(v_={}));const R_=e=>{const t=(()=>{const e=R.useContext(x_);if(!e)throw new Error("useGlobalState must be used within GlobalStateProvider");return e.state})();return R.useMemo(()=>e(t),[e,t])},k_=()=>{const e=R.useContext(x_);if(!e)throw new Error("useGlobalStateDispatch must be used within GlobalStateProvider");return R.useCallback(t=>{e.setState(e=>_object_spread({},e,t instanceof Function?t(e):t))},[])};function T_(e){return"AddinDialogControl"+e.solutionId}function __(e){return Promise.all(e.map(e=>e&&e.solutionId&&e.iconUrl?appChrome.addInApi.registerAddinIcon(T_(e),e.iconUrl):Promise.resolve()))}function w_(e,...t){return e?e.replace(/{(\d+)}/g,(e,n)=>void 0!==t[n]&&null!==t[n]?t[n].toString():e):e}var D_=n(1202);const P_=({keyword:e,targetRef:t,focusZoneComponentRef:n,hidden:o,onItemClicked:r,onDismiss:i})=>{const{addinSearchApiManager:a,telemetryForStoreExp:s,theme:l}=y_(),[c,u]=R.useState(0),[d,p]=R.useState([]),g=R.useRef("");R.useEffect(()=>{g.current=e,e?a.getSuggestionsFromAppSourceAsync(e).then(t=>{const n=t.value.filter(e=>"WordSearch"===e.suggestionType).splice(0,8);g.current===e&&p(n),s.sendOtelTelemetry("Office.Extensibility.Host.SearchSuggestionsFromStoreExp",{displayTexts:n.map(e=>e.displayText)})}).catch(()=>{s.sendULSErrorTraceTag("Request failed: getSuggestionsFromAppSource"),g.current===e&&p([])}):p([])},[a,e,s]),R.useEffect(()=>{var e;u(o?0:(null===(e=t.current)||void 0===e?void 0:e.offsetWidth)||900)},[o,t]);const h=R.useMemo(()=>d.map(e=>({key:e.displayText,text:e.displayText,iconProps:{iconName:"Search"}})),[d]);return R.createElement(D_.a,{theme:l,items:h,hidden:o||0===d.length,target:t,onItemClick:(e,t)=>{const n=(null==t?void 0:t.text)||"";r(n),s.sendOtelTelemetry("Office.Extensibility.Host.SuggestionsClickedFromStoreExp",{selectedText:n})},onDismiss:i,shouldFocusOnMount:!1,calloutProps:{styles:{root:{width:c,maxWidth:"100%"}}},focusZoneProps:{componentRef:n}})},I_=()=>{var e;const{getCommonString:t,telemetryForStoreExp:n,addinSearchApiManager:o,appsFlyoutGeneratorContext:r,theme:i}=y_(),a=k_(),s=r.addinFlyoutSearchDebouncingDelay,l=R.useRef(),c=R.useRef(""),[u,d]=R.useState(""),[p,g]=R.useState(""),[h,m]=R.useState(""),[b,f]=R.useState(!0),x=R.useRef(null),E=null!==(e=r.addinFlyoutSearchRecommendedKeyword)&&void 0!==e?e:"";R.useEffect(()=>()=>{l.current&&(window.clearTimeout(l.current),l.current=void 0)},[]);const S=R.useCallback((y=_async_to_generator((function*(e){const t=yield r.flyoutStoreExpSearchWithAppSourceEnabled?o.searchFromAppSourceAsync(e,30):o.searchFromOMEXAsync(e,void 0,30);return yield __(t),t})),function(e){return y.apply(this,arguments)}),[o,r]);var y;const C=R.useCallback(e=>{d(0===e?w_(t("AddInSearchNoResultsAriaText"),c.current):w_(t("AddInSearchMoreResultsAriaText"),c.current,e))},[t]),v=R.useCallback((e,t)=>{c.current=null!=t?t:"",g(null!=t?t:""),f(!t),d(""),l.current&&window.clearTimeout(l.current),l.current=window.setTimeout(()=>{l.current=void 0,m(t),t?S(t).then(e=>{c.current===t&&(a({viewType:m_.SearchResult,searchResults:e}),C(e.length),e&&n.sendOtelTelemetry("Office.Extensibility.Host.SearchingAddinsFromStoreExp",{MoreAddins:e.map(e=>n.getPrivacyCompliantId(e)),HasResults:(e.length>0).toString()}))}).catch(e=>{c.current===t&&(a({viewType:m_.SearchResult,searchResults:[]}),C(0)),n.sendULSErrorTraceTag("Failed to call search addins API"),console.error(e)}):a({viewType:m_.PopularList})},s)},[s,a,S,n,C]),k=R.useMemo(()=>E?w_(t("AddInSearchBoxRecommendationPlaceholder"),E):t("AddInSearchBoxPlaceholder"),[t,E]),T=R.useRef(null),_=R.useRef(null);return R.createElement("div",{ref:T},R.createElement(Ud.a,{id:v_.SearchBox,type:"AppSearchBoxProps",underlined:!0,label:k,ariaLabel:k,placeholder:k,value:p,onChange:v,resultAriaLiveText:u,tabIndex:0,componentRef:x,showIcon:!0,autoComplete:"off",styles:{root:_object_spread({borderRadius:4},!r.flyoutStoreAdvancedUXEnabled&&{background:i.palette.neutralLighterAlt,selectors:{"input::placeholder":{color:i.palette.neutralPrimaryAlt}}})},onKeyDown:r.flyoutStoreAdvancedUXEnabled?e=>{"ArrowDown"===e.key&&!b&&_.current&&(e.preventDefault(),e.stopPropagation(),_.current.focus(!0))}:void 0}),r.flyoutStoreAdvancedUXEnabled&&R.createElement(P_,{keyword:h,targetRef:T,hidden:b,onItemClicked:e=>{v(null,e),f(!0)},onDismiss:()=>f(!0),focusZoneComponentRef:_}))},F_=({display:e="flex",flexDirection:t="row",alignItems:n="initial",justifyContent:o="initial",flexWrap:r="nowrap"}={})=>({display:e,flexDirection:t,alignItems:n,justifyContent:o,flexWrap:r}),B_={[b_.SingleWithNoSidebar]:"100%",[b_.Single]:"100%",[b_.Double]:`calc(50% - ${Math.ceil(6)}px)`,[b_.Triple]:`calc(33.33% - ${Math.ceil(8)}px)`},M_=Object(Jo.c)(e=>Object(F.db)({list:_object_spread_props(_object_spread({},F_({flexWrap:"wrap",justifyContent:"flex-start"})),{listStyle:"none",padding:0,margin:0,gap:"2px 12px"}),item:{width:B_[e]}}));var j_=n(2594);const O_=Object(Jo.c)(()=>Object(F.db)({root:_object_spread({},F_({flexDirection:"column"})),callout:{width:320,maxWidth:"90%",padding:"20px 24px",borderRadius:8},title:{marginBottom:12}})),L_=({addinDetail:e,buttonId:t})=>{var n,o;const{addinSearchApiManager:r,telemetryForStoreExp:i}=y_(),a=O_(),[s,l]=R.useState(null);R.useEffect(()=>{var t;(t=_async_to_generator((function*(){const t=yield r.getRichAddinDetailFromOMEXAsync(e.solutionId);l(t)})),function(){return t.apply(this,arguments)})()},[r,e.solutionId]);const c=null!==(n=null==s?void 0:s.videoUrl)&&void 0!==n?n:"",u=null!==(o=null==s?void 0:s.screenshots)&&void 0!==o?o:[];let d=void 0;return c.startsWith("https://www.youtube.com/watch?v=")&&c.split("v=").length>1&&(d=c.split("v=")[1]),s&&(null==s?void 0:s.solutionId)===e.solutionId?(i.sendOtelTelemetry("Office.Extensibility.Host.AddInCalloutFromStoreExp",{solutionId:i.getPrivacyCompliantId(e),display:d?"video":u&&u.length>0?"screenshots":"null"}),R.createElement(Nl.a,{className:a.callout,role:"dialog",gapSpace:0,target:"#"+t,setInitialFocus:!0,beakWidth:10,directionalHint:12,styles:{beakCurtain:{borderRadius:"8px"}},"aria-label":"AppCallout",tabIndex:0},R.createElement("div",{className:a.root},d?R.createElement("iframe",{title:e.displayName,src:`https://www.youtube.com/embed/${d}?autoplay=1&controls=0`,frameBorder:"0",allow:"autoplay",allowFullScreen:!0,"aria-label":"Video"}):u&&u.length>0?R.createElement(A_,{images:u}):null),R.createElement("h2",{className:a.title},null==s?void 0:s.displayName),R.createElement("p",null,null==s?void 0:s.shortDescription))):R.createElement(R.Fragment,null)},A_=({images:e})=>{const[t,n]=R.useState(0);return R.useEffect(()=>{const t=setInterval(()=>{n(t=>(t+1)%e.length)},3e3);return()=>{clearInterval(t)}},[e]),R.createElement(R.Fragment,null,R.createElement("img",{src:e[t],alt:"Carousel","aria-label":"Carousel images",onClick:()=>window.open(e[t],"_blank")}),R.createElement("div",null,R.createElement("div",{style:{textAlign:"center"}},e.map((e,o)=>R.createElement("span",{key:o,style:{backgroundColor:o===t?"rgb(0, 119, 215)":"rgb(255, 255, 255)",border:"1px solid rgb(155, 155, 155)",borderRadius:"50%",cursor:"pointer",display:"inline-block",height:"5px",width:"5px",margin:"0px 2px",outline:"none"},role:"button",onClick:()=>(e=>{n(e)})(o),"aria-label":o===t?"Selected":"Not selected"})))))},N_=({children:e,addinDetail:t,sourceString:n})=>{const o=k_(),r=R_(e=>e.columnType),i=R_(e=>e.showCalloutItemId),{appsFlyoutGeneratorContext:a}=y_(),s=M_(r),[l,c]=R.useState(!1),u=R.useRef(void 0),d=`${v_.AddInListItemWrapper}${n}${t.solutionId}`,p=R.useCallback(()=>{u.current=setTimeout(()=>{o({showCalloutItemId:d}),c(!0)},1e3)},[o,d]),g=R.useCallback(()=>{u.current&&clearTimeout(u.current),o({showCalloutItemId:""}),c(!1)},[o]),h=R.useCallback(e=>{e&&"touch"===e.pointerType&&p()},[p]),m=R.useCallback(e=>{e&&"touch"===e.pointerType&&g()},[g]),b=R.useCallback(e=>{e&&"keydown"===e.type&&e.which===xe.a.enter&&g(),e.ctrlKey&&e.shiftKey&&e.which===xe.a.f10&&(l?g():p())},[p,g,l]);return a.flyoutStoreAdvancedUXEnabled?R.createElement("li",{key:t.solutionId,className:s.item,id:d,onMouseEnter:p,onMouseDown:g,onMouseLeave:g,onFocus:p,onBlur:g,onPointerEnter:h,onPointerUp:m,onPointerLeave:m,onKeyDown:b},e,i===d&&l&&R.createElement(L_,{addinDetail:t,buttonId:d})):R.createElement("li",{key:t.solutionId,className:s.item},e)},W_=({addinDetails:e,source:t,isSearchResults:n,id:o,ariaLabelledby:r})=>{const i=k_(),a=R_(e=>e.columnType),s=M_(a),{getCommonString:l,addinCommandsHandlerForStoreExp:c,resultHandler:u,telemetryForStoreExp:d}=y_(),p=n?"Search":t,g=R.useCallback(e=>{n?c.handleInstallSearchAddInAndLaunchIt(e,"Search"):c.handleInstallPopularAddInAndLaunchIt(e,t||""),u(void 0,{})},[c,t,n,u]),h=R.useCallback(e=>{i({isStoreDetailPageCover:!0,addinDetail:e,source:t,isSearchResult:n}),d.sendOtelTelemetry("Office.Extensibility.Host.LaunchAddInInstallDialogFromStoreExp",{solutionId:d.getPrivacyCompliantId(e),source:n?"Search":t})},[i,t,n,d]);return R.createElement(Cd.a,{className:s.list,as:"ul",role:"listbox",id:o,"aria-labelledby":r,allowFocusRoot:!1,isCircularNavigation:!0,shouldEnterInnerZone:e=>"ArrowRight"===e.code},e.map(e=>{var o;return R.createElement(N_,{key:e.solutionId,addinDetail:e,sourceString:p},R.createElement(j_.a,{id:`${v_.MultiActionButton}${p}${e.solutionId}`,type:"AppMultiActionButtonProps",label:e.displayName,description:e.description,customTooltip:"",disableCircularNavigation:!0,icon:T_(e),role:"option",styles:{root:{margin:1,width:"100%",boxSizing:"border-box"},icon:{width:38,height:38,minWidth:38}},links:[{text:l("AddinOneLink"),href:C_+(null===(o=e.solutionId)||void 0===o?void 0:o.toLocaleLowerCase())}],onLinkExecute:o=>{d.sendOtelTelemetry("Office.Extensibility.Host.AddInListLinkClickedFromStoreExp",{solutionId:d.getPrivacyCompliantId(e),herf:o,source:n?"Search":t})},actionButtonText:l("AddinListAdd"),onExecute:()=>h(e),onActionButtonExecute:()=>g(e)}))}))};var z_=n(2645);function H_(e,t,n="_blank"){return`<a href="${t}" target="${n}" >${e}</a>`}const V_=Object(Jo.c)(()=>Object(F.db)({root:_object_spread({},F_({flexDirection:"column"})),title:{fontSize:16,fontWeight:600,lineHeight:20,marginTop:16,marginBottom:8}})),U_=()=>{const e=R_(e=>e.searchResults),{getCommonString:t,host:n}=y_(),o=R.useMemo(()=>{const e=H_(t("AddInSearchNoResultsLink1"),"https://aka.ms/Officeaddins"),o=H_(t("AddInSearchNoResultsLink2"),"https://aka.ms/OfficeAddinOverview");return"Excel"===n?w_(t("AddInSearchNoResultsDescription2"),e,o):w_(t("AddInSearchNoResultsDescription3"),o)},[t,n]),r=V_();return e.length<=0?R.createElement(z_.a,{id:v_.NoSearchResultsView,type:"AppErrorViewProps",iconName:"NoSearchResultsV2",title:t("AddInSearchNoResultsTitle"),isNoResultView:!0,linkText:`${t("AddInSearchNoResultsDescription1")} ${o}`,styles:{bodyContainer:{width:"100%",height:"100%","& > div":{maxWidth:550}}}}):R.createElement("div",{className:r.root,id:v_.SearchResultsView},R.createElement("div",{className:r.title,id:v_.SearchResultsViewTitle},t("AddInSearchResultsDivider")),R.createElement(W_,{addinDetails:e,isSearchResults:!0,id:v_.SearchResultsViewList,ariaLabelledby:v_.SearchResultsViewTitle}))},G_=Object(Jo.c)(()=>Object(F.db)({root:_object_spread({},F_({flexDirection:"column"}))})),q_=Object(Jo.c)(e=>Object(F.db)({title:{fontSize:16,fontWeight:600,lineHeight:20,marginTop:16,marginBottom:8},list:_object_spread_props(_object_spread({},F_({flexWrap:"wrap",justifyContent:"flex-start"})),{listStyle:"none",padding:0,paddingTop:4,margin:0,gap:"16px 12px"}),imageContainer:_object_spread_props(_object_spread({margin:"0 8px",height:150},F_({flexWrap:"wrap",alignItems:"center",justifyContent:"center"})),{borderRadius:8}),image:{width:"64px",height:"64px",borderRadius:8,overflow:"hidden"},item:{cursor:"pointer",borderRadius:8,padding:4,boxShadow:"rgba(0, 0, 0, 0.3) 0px 1px 2px 0px",width:B_[e]}})),Q_=({addinDetails:e,showTitle:t=!1})=>{const n=k_(),o=R_(e=>e.columnType),r=q_(o),{getCommonString:i,addinCommandsHandlerForStoreExp:a,resultHandler:s,telemetryForStoreExp:l}=y_(),c=R.useCallback(e=>{a.handleInstallPopularAddInAndLaunchIt(e,"Trending"),s(void 0,{})},[a,s]),u=R.useCallback(e=>{n({isStoreDetailPageCover:!0,addinDetail:e,source:"Trending",isSearchResult:!1}),l.sendOtelTelemetry("Office.Extensibility.Host.LaunchAddInInstallDialogFromStoreExp",{solutionId:l.getPrivacyCompliantId(e),source:"Trending"})},[n,l]),d=R.useMemo(()=>i("AddInCategoryTitleTrendingAddins"),[i]),p=["#abe2f7","#ffb4a1","#88d398"];return R.createElement(R.Fragment,null,t&&R.createElement("div",{className:r.title,id:v_.TrendingTitle},d),R.createElement("div",{className:r.list,id:v_.TrendingList,role:"listbox","aria-label":t?void 0:d,"aria-labelledby":t?v_.TrendingTitle:void 0},e.map((e,t)=>{var n;return R.createElement("div",{className:r.item,onClick:()=>u(e),id:v_.TrendingListItem+e.solutionId,key:v_.TrendingListItem+e.solutionId},R.createElement("div",{className:r.imageContainer,style:{background:p[t]}},R.createElement(fe.a,{iconName:T_(e),className:r.image})),R.createElement(j_.a,{id:v_.MultiActionButton+"Trending"+e.solutionId,type:"AppMultiActionButtonProps",label:e.displayName,description:e.description,role:"option",customTooltip:"",styles:{root:{margin:1,width:"100%",boxSizing:"border-box"},icon:{width:38,height:38,minWidth:38}},links:[{text:i("AddinOneLink"),href:C_+(null===(n=e.solutionId)||void 0===n?void 0:n.toLocaleLowerCase())}],onLinkExecute:t=>{l.sendOtelTelemetry("Office.Extensibility.Host.AddInListLinkClickedFromStoreExp",{solutionId:l.getPrivacyCompliantId(e),herf:t,source:"Trending"})},actionButtonText:i("AddinListAdd"),onExecute:()=>u(e),onActionButtonExecute:()=>c(e)}))})))},K_=Object(Jo.c)(e=>{const t=Object(ih.a)(e);return Object(F.db)({root:_object_spread({},F_({flexDirection:"column"})),header:_object_spread_props(_object_spread({},F_({flexDirection:"row",justifyContent:"space-between",alignItems:"center"})),{paddingRight:16,marginTop:16,marginBottom:8}),title:{fontSize:16,fontWeight:600,lineHeight:20},seeAll:{button:{lineHeight:24,fontSize:14,overflow:"hidden",textDecoration:"none",textOverflow:"ellipsis",whiteSpace:"nowrap",backgroundColor:"transparent",cursor:"pointer",border:"none",color:e.palette.themeDark,selectors:{":visited":{color:e.palette.themeDark},":hover":{color:e.palette.themeDarker},":active":{color:e.palette.themeDarkAlt}},[F.m]:{color:"LinkText"}},"button:hover, button:focus, button:focus-visible":{textDecoration:"underline",[F.m]:ci.n},"button:focus-visible":{outline:"1px solid",outlineColor:t.focusedBorderColor}}})}),J_=({title:e,addinDetails:t,id:n,noCollapse:o})=>{const r=R_(e=>e.columnType),{theme:i,getCommonString:a,telemetryForStoreExp:s}=y_(),[l,c]=R.useState(!1),u=2*r,d=!o&&t.length>u,p=R.useMemo(()=>l||o?t:t.slice(0,u),[l,t,u,o]),g=K_(i);return R.createElement("div",{className:g.root,id:v_.ListedSectionsSection+n,role:"group","aria-labelledby":v_.ListedSectionsSectionTitle+n},R.createElement("div",{className:g.header},R.createElement("div",{className:g.title,id:v_.ListedSectionsSectionTitle+n},e),d&&R.createElement("div",{className:g.seeAll},R.createElement("button",{id:v_.ListedSectionsSectionSeeAllButton+n,"aria-expanded":l,onClick:()=>{c(e=>(s.sendOtelTelemetry("Office.Extensibility.Host.ClickSeeAllSeeLessFromStoreExp",{category:n,action:e?"SeeLess":"SeeAll"}),!e))}},a(l?"AddinsFlyoutSeeLessButtonText":"AddinsFlyoutSeeAllButtonText")))),R.createElement(W_,{addinDetails:p,source:n,id:v_.ListedSectionsSectionList+n,ariaLabelledby:v_.ListedSectionsSectionTitle+n}))},Y_=Object(Jo.c)(()=>Object(F.db)({root:_object_spread_props(_object_spread({},F_({flexDirection:"column"})),{width:"100%"})})),Z_=({sections:e})=>{const t=Y_();return R.createElement("div",{className:t.root,id:v_.ListedSections},e.map(e=>R.createElement(J_,_object_spread({key:v_.ListedSectionsSection+e.id},e))))},$_=()=>{const e=R_(e=>e.popularAddins),t=R_(e=>e.trendingAddins),n=R_(e=>e.categoriesAddins),{getCommonString:o,appFlyoutCategories:r}=y_(),i=G_(),a=R.useMemo(()=>[{id:"PopularSection",title:o("PopularAddins"),addinDetails:e},...Object.entries(n).filter(([e,t])=>(null==t?void 0:t.length)>0).map(([e,t])=>({title:r.getCategoryTitle(e),addinDetails:t,id:e}))],[r,n,o,e]);return R.createElement("div",{className:i.root},R.createElement(Q_,{addinDetails:t}),R.createElement(Z_,{sections:a}))},X_=Object(Jo.c)((e,t,n)=>{const o=e?1200:1e3,r=Object(ih.a)(t);return Object(F.db)({root:_object_spread_props(_object_spread({},F_({flexDirection:"column",justifyContent:"initial",alignItems:"initial"})),{height:640,width:o,maxWidth:"100%","&, & *":{boxSizing:"border-box"}}),innertRootWithSidebar:{display:"flex",gridTemplateColumns:"22% auto",gridTemplateRows:"auto 1fr",rowGap:8,height:576,maxWidth:"100%","&, & *":{boxSizing:"border-box"}},innerRoot:_object_spread_props(_object_spread({},F_({flexDirection:"column"})),{height:576}),sidebar:_object_spread_props(_object_spread({},F_({flexDirection:"column"})),{boxShadow:"rgba(0, 0, 0, 0.3) 0px 0px 2px 0px",marginTop:-32,paddingTop:36,height:608,width:264,flex:"none",backgroundColor:r.disabledBackgroundColor,display:n===b_.SingleWithNoSidebar?"none":"flex"}),searchBox:{width:"100%",padding:e?"0 12px 4px":"0 32px 4px"},scrollContainer:_object_spread_props(_object_spread({},F_({flexDirection:"column"})),{width:"100%",flexGrow:1,overflowY:"auto",overflowX:"hidden",paddingLeft:32,paddingRight:14,marginBottom:3}),container:{flexGrow:1,width:"100%",maxWidth:o-64},divider:{width:"calc(100% - 64px)",margin:"0 32px"},footer:_object_spread_props(_object_spread({},F_({flexDirection:"row-reverse"})),{width:"100%",padding:"16px 32px"})})});function ew(...e){let t=e.map(e=>e&&e.trim()).filter(e=>!!e).join(" ");return t||e.some(e=>""===e)||(t=void 0),t}const tw=Object(Jo.c)((e,t=!1)=>{const n=Object(ih.a)(e);return Object(F.eb)({backgroundColor:n.borderColor,[t?"minWidth":"minHeight"]:"1px"})}),nw=({vertical:e,className:t})=>{const{theme:n}=y_(),o=tw(n,e);return R.createElement("div",{className:ew(o,t)})},ow=Object(Jo.c)(e=>Object(F.db)({root:{height:576},backButton:{marginBottom:"2px",marginLeft:"29px",padding:0},detailPage:_object_spread_props(_object_spread({},F_({flexDirection:"column"})),{height:544,width:e?1200:1e3,maxWidth:"100%",borderColor:"transparent"})})),rw=()=>{const{appsFlyoutGeneratorContext:e}=y_();return e.flyoutStoreAdvancedUXEnabled},iw=({isStoreDetailPageCover:e,source:t,isSearchResult:n})=>{const o=k_(),r=rw(),i=ow(r),{resultHandler:a,host:s,addinCommandsHandlerForStoreExp:l,getCommonString:c}=y_(),u=R_(e=>e.addinDetail),d=`https://inclient.store.office.com/gyro/clientstore/flyoutdetails/${null==u?void 0:u.solutionId}?client=wac_${s}&ui=EN-US&rs=EN-US`,p=R.useMemo(()=>{try{var e;return null!==(e=c("DialogBack"))&&void 0!==e?e:"Back"}catch(e){return"Back"}},[c]),g=R.useCallback(e=>{const o=e.data,r=o?o.split("|"):null;r&&r.length>0&&("REFRESH_REQUIRED"!==r[0]&&"PRELOAD_MANIFEST"!==r[0]||u&&(l.handleInstallPopularAddInAndLaunchIt(u,n?"SearchDetail":t+"Detail"),a(void 0,{})))},[l,u,n,a,t]);return R.useEffect(()=>{const e=e=>g(e);return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[g]),u&&e?R.createElement("div",{className:i.root},R.createElement(Ko.a,{type:"AppButtonProps",label:p,icon:"CommonControlChevronLeft_12",flipIconInRtl:!0,id:"AddinStoreDetailBackButton",onExecute:()=>{o({isStoreDetailPageCover:!1})},className:i.backButton}),R.createElement(Vk.a,{type:"AppIFrameProps",id:"AddinInstallDialog",src:d,sandbox:"allow-scripts allow-forms allow-same-origin ms-allow-popups allow-popups",className:i.detailPage})):null},aw=()=>{const e=R_(e=>e.selectedCategory),t=R_(e=>e.categoriesAddins),{appFlyoutCategories:n}=y_(),o=R.useMemo(()=>{const o=t[e];return{title:n.getCategoryTitle(e),addinDetails:o,id:e,noCollapse:!0}},[t,e,n]);return R.createElement(J_,_object_spread({key:v_.ListedSectionsSection+o.id},o))},sw=Object(Jo.c)(e=>{const t=Object(ih.a)(e),n={padding:"8px 8px",borderRadius:"4px",border:"none",backgroundColor:"transparent",cursor:"pointer",whiteSpace:"nowrap",textAlign:"left",width:"100%",selectors:{":hover":{backgroundColor:t.defaultBackgroundColor}}};return Object(F.db)({root:_object_spread_props(_object_spread({},F_({flexDirection:"column"})),{gridRow:"1 / 3",padding:"12px 12px",gap:2,listStyleType:"none"}),item:n,activeItem:_object_spread_props(_object_spread({},n),{backgroundColor:t.defaultBackgroundColor})})}),lw=()=>{const{appFlyoutCategories:e,theme:t,getCommonString:n,telemetryForStoreExp:o}=y_(),r=sw(t),i=k_(),a=R_(e=>e.selectedCategory),s=R.useCallback((e,t)=>{i({viewType:e,selectedCategory:t}),o.sendOtelTelemetry("Office.Extensibility.Host.SelectCategoryFormAddinDialogNavBar",{category:t,isGroupView:e===m_.PopularList?"true":"false"})},[i,o]),l=R_(t=>[{text:n("GroupApps"),key:"",onClick:()=>s(m_.PopularList,"")},...Object.keys(t.categoriesAddins).map(t=>({text:e.getCategoryTitle(t),key:t,onClick:()=>s(m_.CategoriesDetail,t)}))]);return R.createElement(Cd.a,{as:"li",className:r.root},l.map(e=>R.createElement("button",{key:e.text,className:e.key===a?r.activeItem:r.item,onClick:e.onClick,style:e.text===n("GroupApps")?{fontWeight:"bold"}:{}},e.text)))},cw=()=>{const e=R_(e=>e.viewType),t=R.useRef(e),n=R_(e=>e.isSearchResult),o=R_(e=>e.isStoreDetailPageCover),r=rw(),i=R_(e=>e.addinDetail),a=R_(e=>e.source),s=R.useRef(),l=R.useRef(),c=R.useRef(null),u=R_(e=>e.columnType),{getCommonString:d,addinCommandsHandlerForStoreExp:p,resultHandler:g,telemetryForStoreExp:h,theme:m,appsFlyoutGeneratorContext:b}=y_(),f=k_(),x=X_(r,m,u),E=R.useMemo(()=>{switch(e){case m_.SearchResult:return R.createElement(U_,null);case m_.PopularList:return R.createElement($_,null);case m_.CategoriesDetail:return R.createElement(aw,null);default:return null}},[e]),S=R.useRef();R.useEffect(()=>{var e;const t=()=>{const e=window.innerWidth;let t;t=r?e<=600?b_.SingleWithNoSidebar:e<=864?b_.Single:e<=1064?b_.Double:b_.Triple:e<=600?b_.Single:e<=800?b_.Double:b_.Triple,t!==S.current&&(S.current=t,f({columnType:t}))};t(),window.addEventListener("resize",t);const n=e=>{l.current&&e.target!==l.current&&l.current.blur()};return s.current=document.getElementById(v_.Root),null===(e=s.current)||void 0===e||e.addEventListener("click",n),()=>{var e;window.removeEventListener("resize",t),S.current=void 0,null===(e=s.current)||void 0===e||e.removeEventListener("click",n)}},[r]);const y=R.useCallback(()=>{const e=n?"Search":a;return document.getElementById(`${v_.MultiActionButton}${e}${null==i?void 0:i.solutionId}Item`)},[i,n,a]);return R.useEffect(()=>{t.current=e},[e]),R.useEffect(()=>{var e;o||(l.current=y(),null===(e=l.current)||void 0===e||e.focus())},[y,o]),R.useEffect(()=>{let e=window.setTimeout(()=>{if(e=void 0,c.current){const e=c.current.scrollTop;e>0&&h.sendOtelTelemetry("Office.Extensibility.Host.ScrollableListViewForStoreExp",{scrollTopValue:e.toString()})}},6e4);return()=>{e&&window.clearTimeout(e)}},[]),R.createElement(pv.a,{firstFocusableTarget:()=>document.getElementById(v_.SearchBox),isClickableOutsideFocusTrap:!0,className:x.root,id:v_.Root},R.createElement("div",{style:{display:o?void 0:"none"}},R.createElement(iw,{isStoreDetailPageCover:o,source:a,isSearchResult:n})),R.createElement("div",{className:r?x.innertRootWithSidebar:x.innerRoot,style:{display:o?"none":void 0}},r?R.createElement("div",{className:x.sidebar},R.createElement("div",{className:x.searchBox},R.createElement(I_,null)),R.createElement(lw,null)):R.createElement("div",{className:x.searchBox},R.createElement(I_,null)),R.createElement("div",{id:v_.ScrollerContainer,className:x.scrollContainer,ref:c},R.createElement("div",{className:x.container},E))),R.createElement(nw,{className:x.divider}),b.mosForWXPEnabled?R.createElement(R.Fragment,null):R.createElement("div",{className:x.footer},R.createElement(Ko.a,{id:v_.FooterButton,type:"AppButtonProps",label:b.flyoutStoreFooterLabelString.length>0?b.flyoutStoreFooterLabelString:d("AddinPickerButtonMore"),icon:"GetAddinsCross_16",onExecute:()=>{p.handleLaunchAppForOfficeDialog(),g(void 0,{})}})))},uw=({children:e,value:t})=>R.createElement(S_.Provider,{value:t},e),dw=()=>R.createElement("style",null,"\n.ms-Dialog-main { \n    max-width: unset;\n}\n.ms-Dialog-header {\n    height: 32px;\n}\n.ms-Dialog-title {\n    display: none;\n}\n.ms-Dialog-inner {\n    padding: 0px;\n}\n");var pw,gw;!function(e){e[e.myAddins=0]="myAddins",e[e.adminManaged=1]="adminManaged",e[e.popular=2]="popular"}(pw||(pw={})),function(e){e[e.OK=0]="OK",e[e.notReady=1]="notReady",e[e.storeDisabled=2]="storeDisabled",e[e.invokeFailure=3]="invokeFailure",e[e.serviceDisabled=4]="serviceDisabled",e[e.builtinAddinDetails=5]="builtinAddinDetails"}(gw||(gw={}));const hw=({id:e})=>{const{theme:t}=y_();return R.createElement(gm.a,{id:e,type:"AppSpinnerProps",appColors:{primary:t.palette.themePrimary,shade10:t.palette.themeDarkAlt,shade20:t.palette.themeDark,shade30:t.palette.themeDarker,tint10:t.palette.themeSecondary,tint20:t.palette.themeTertiary,tint30:t.palette.themeLight,tint40:t.palette.themeLighter}})},mw=Object(Jo.c)(()=>Object(F.db)({root:_object_spread_props(_object_spread({},F_({flexDirection:"column"})),{height:640,width:1e3,maxWidth:"100%",padding:"0 32px 16px"}),spinner:_object_spread_props(_object_spread({width:"100%"},F_({justifyContent:"center",alignItems:"center"})),{flexGrow:1}),divider:{width:"100%"},footer:_object_spread({marginTop:16,width:"100%"},F_({justifyContent:"flex-end"}))})),bw=()=>{const{getCommonString:e,resultHandler:t,addinCommandsHandlerForStoreExp:n,appsFlyoutGeneratorContext:o}=y_(),r=mw();return R.createElement("div",{className:r.root},R.createElement("div",{className:r.spinner},R.createElement(hw,{id:v_.DataLoadingSpinner})),R.createElement(nw,{className:r.divider}),o.mosForWXPEnabled?R.createElement("div",null):R.createElement("div",{className:r.footer},R.createElement(Ko.a,{id:v_.FooterButton,type:"AppButtonProps",label:e("AddinPickerButtonMore"),icon:"GetAddinsCross_16",onExecute:()=>{n.handleLaunchAppForOfficeDialog(),t(void 0,{})}})))},fw=({children:e})=>{const{dataProvider:t,host:n,appFlyoutCategories:o,appsFlyoutGeneratorContext:r}=y_(),i=k_(),[a,s]=R.useState(!0),l=R.useCallback(()=>{let e=!0;const r="Excel"===n?["wa200005502","wa200005271","wa200005281"]:"Word"===n?["wa200005502","wa200001011","wa104382081"]:"PowerPoint"===n?["wa200005566","wa200005669","wa104379261"]:[],a=t.getAddinDetails(pw.popular),s=[];a.errorCode===gw.OK&&s.push(...a.addinDetails.filter(e=>(null==e?void 0:e.solutionId)&&!r.includes(e.solutionId.toLowerCase()))),s.length<=0&&(e=!1);const l=r.map(e=>t.getAddinDetailById(e)).filter(e=>!!e);l.length<=0&&(e=!1);const c=o.getStoreExpCategoryAddinsRecord(),u=Object.values(c).flat();return u.length<=0&&(e=!1),__([...s,...l,...u]).finally(()=>{i({popularAddins:s,trendingAddins:l,categoriesAddins:c})}),e},[o,t,i,n]);return R.useEffect(()=>{const e=l();let t;return r.flyoutStoreExpRetryIfNotReady&&!e?t=window.setInterval(()=>{l()&&(s(!1),window.clearInterval(t),t=void 0)},100):s(!1),()=>{t&&window.clearInterval(t)}},[l,r.flyoutStoreExpRetryIfNotReady]),a?R.createElement(bw,null):e},xw=()=>{const e=R.useRef(null);return R.useEffect(()=>{var t,n,o;const r=Ew(e.current,2);null==r||r.removeAttribute("tabindex");const i=Ew(r,3);null==i||null===(t=i.querySelector(".ms-Dialog-header button"))||void 0===t||t.setAttribute("aria-hidden","true");const a=Ew(i,2);var s,l;null!=a&&null!==(n=a.firstElementChild)&&void 0!==n&&n.hasAttribute("tabindex")&&(null==a||null===(s=a.firstElementChild)||void 0===s||s.remove()),null!=a&&null!==(o=a.lastElementChild)&&void 0!==o&&o.hasAttribute("tabindex")&&(null==a||null===(l=a.lastElementChild)||void 0===l||l.remove())},[]),R.createElement("div",{ref:e,style:{display:"none"}})};function Ew(e,t){return t<=0||!e?e:Ew(e.parentElement,t-1)}const Sw=e=>{const t=R.useRef(!1),n=R.useRef(0);return R.useEffect(()=>{var o;const r=e.dataProvider.getAddinDetails(pw.popular).addinDetails.length>0;n.current=Date.now(),null===(o=e.onDialogOpen)||void 0===o||o.call(e,n.current,r);let i=e.appsFlyoutGeneratorContext.flyoutStoreExpUXRenderCheckerEnabled?window.setInterval(()=>{(function(...e){return e.some(e=>!!document.querySelector(`[id^="${e}"]`))})(v_.SearchResultsView,v_.NoSearchResultsView,v_.ListedSectionsSectionList,v_.LabeledTabsTabList)&&(t.current=!0,n.current=Date.now()-n.current,window.clearInterval(i),i=void 0)},100):void 0;return()=>{var o;i&&window.clearInterval(i),null===(o=e.onDialogClose)||void 0===o||o.call(e,Date.now(),r,t.current,t.current?n.current:0)}},[]),R.createElement(E_,null,R.createElement(xw,null),R.createElement(we.a,null,t=>R.createElement(uw,{value:_object_spread_props(_object_spread({},e),{theme:t})},R.createElement(dw,null),R.createElement(fw,null,R.createElement(cw,null)))))},yw=e=>R.createElement(SR.a,_object_spread_props(_object_spread({},e),{bodyRendererFunction:()=>{const t=_object_spread_props(_object_spread({},e),{executeCommand:nc.b});return R.createElement(Sw,_object_spread({},t))}}));function Cw(e){return{title:{margin:"0px",padding:"0px"},inner:{padding:"0px",selectors:{".ms-Dialog-actions":{height:"32px",margin:"24px 0px 0px 0px"},".ms-Dialog-actionsRight":{height:"32px",marginRight:"unset"},".ms-Dialog-action":{margin:"unset"},"#DialogCancelButton":{display:"none"},"#DialogActionButton":{minWidth:"unset",width:"42px",backgroundColor:e.palette.themePrimary,selectors:{[F.m]:{background:"Canvas",color:"ButtonText"}}}}}}}function vw(e){return{root:{},main:{backgroundColor:Object(ih.a)(e).dialogBackgroundColor,padding:"24px",margin:"unset",borderRadius:"12px",selectors:{".ms-Dialog-header":{height:"32px",marginBottom:"24px",selectors:{"@media (max-width: 479px) and (min-width: 320px)":{marginBottom:"50px"}}}}}}}class Rw extends R.PureComponent{render(){return R.createElement(we.a,null,e=>R.createElement(SR.a,_object_spread_props(_object_spread({},this.props),{type:"CustomDialogProps",maxWidth:480,bodyRendererFunction:this.bodyRendererFunction,sharedDialogStyles:Cw(e),styles:vw(e)})))}constructor(e){super(e),this.provenanceDialogSubtext="ProvenanceDialogSubtext",this.provenanceDataHeader="ProvenanceDataHeader",this.provenanceDataTimestamp="ProvenanceDataTimestamp",this.bodyRendererFunction=()=>R.createElement("div",{className:""},R.createElement("div",{style:{display:"flex",flexDirection:"row"}},R.createElement(fe.a,{iconName:vv.a.ContentCredentials_32,styles:{root:{width:"45px",marginRight:"16px",alignSelf:"flex-start",selectors:{"@media (max-width: 479px)":{width:"95px"}}}}}),R.createElement("div",null,R.createElement(Yl.a,{id:this.provenanceDialogSubtext,forId:this.provenanceDialogSubtext,type:"AppLabelProps",label:OfficeCommonStringsEnum.ContentCredentialsDefaultDescription,styles:{root:{padding:"unset",marginBottom:"24px"},label:{padding:"unset",lineHeight:"20px"}}}),R.createElement(Yl.a,{id:this.provenanceDataHeader,forId:this.provenanceDataHeader,type:"AppLabelProps",label:this.props.provenanceDataHeader,styles:{root:{padding:"unset"},label:{padding:"unset",lineHeight:"20px",fontWeight:600}}}),R.createElement(Yl.a,{id:this.provenanceDataTimestamp,forId:this.provenanceDataTimestamp,type:"AppLabelProps",label:this.props.provenanceDataTimestamp,styles:{root:{padding:"unset"},label:{padding:"unset",lineHeight:"20px"}}}))))}}const kw={pinBehaviorIsEnabled:!1,dialogFooterButtonPositionIsEnabled:Object(bR.j)(),pinnedDialogLeftOffset:void 0};var Tw,_w,ww,Dw=n(2730),Pw=n(1787);!function(e){e[e.Password=0]="Password",e[e.Text=1]="Text"}(Tw||(Tw={})),function(e){e[e.Default=0]="Default",e[e.Invalid=1]="Invalid",e[e.Error=2]="Error",e[e.Loading=3]="Loading"}(_w||(_w={})),function(e){e[e.Nil=0]="Nil",e[e.IncorrectPassword=1]="IncorrectPassword",e[e.AttemptThresholdExceeded=2]="AttemptThresholdExceeded",e[e.VerifyPasswordRequestFailure=3]="VerifyPasswordRequestFailure"}(ww||(ww={}));class Iw extends R.PureComponent{render(){return R.createElement(SR.a,_object_spread_props(_object_spread({},this.props),{bodyRendererFunction:this.bodyRendererFunction,resultHandler:this.passwordDialogResultHandler,actionButtonProps:_object_spread_props(_object_spread({},this.props.actionButtonProps),{disabled:this.state.mode===_w.Loading||this.state.mode===_w.Invalid||this.state.mode===_w.Error})}))}constructor(e){super(e),this.bodyRendererFunction=()=>{const e=Object(Dw.c)(),{description:t,placeholderText:n}=this.props.bodyControls;return R.createElement("div",{style:e.bodyContainer},R.createElement("div",{style:e.bodyItemContainer},R.createElement(Yl.a,{id:"PasswordInputDescription",type:"AppLabelProps",label:t,forId:"PasswordInput",styles:e.label})),R.createElement("div",{style:e.bodyItemContainer},R.createElement(Xd.a,{type:"AppInputProps",id:"PasswordInput",disabled:this.state.mode===_w.Loading||this.state.mode===_w.Error&&this.state.errorMode===ww.AttemptThresholdExceeded,placeholder:n,autoComplete:"off",spellCheck:!1,maxLength:255,onChange:this.inputChanged,inputType:this.state.inputMode===Tw.Text?"text":"password",value:this.password,onRenderSuffix:this.state.mode===_w.Loading?this.renderSpinner:this.renderEyeButton,errorMessage:this.state.mode===_w.Error?this.errorMessageMapping.get(this.state.errorMode):void 0,styles:e.input})),this.props.bodyControls.additionalBodyContent&&R.createElement("div",{style:e.bodyItemContainer},R.createElement(tT,_object_spread({},this.props.bodyControls.additionalBodyContent))))},this.renderEyeButton=()=>{const e=this.state.inputMode===Tw.Password?this.props.bodyControls.passwordShowEyeIconAriaLabel:this.props.bodyControls.passwordHideEyeIconAriaLabel,t=Object(Pw.a)().CommonControlEyeOpen_16;return R.createElement(we.a,null,n=>R.createElement(hm.a,{appColors:this.props.appColors},R.createElement(Ko.a,{type:"AppButtonProps",id:"PasswordToggle",disabled:this.state.mode===_w.Loading||this.state.mode===_w.Error&&this.state.errorMode===ww.AttemptThresholdExceeded,label:e,hideLabel:!0,ariaDescription:e,icon:t,onExecute:this.eyeButtonClickHandler,onKeyDown:this.eyeButtonKeyEventHandler,onMouseDown:this.eyeMouseKeyDownEventHandler,takeFocusOnClick:!0,styles:Object(Dw.a)(this.state.inputMode===Tw.Text,this.state.mode===_w.Loading||this.state.mode===_w.Error&&this.state.errorMode===ww.AttemptThresholdExceeded,this.props.appColors,n)})))},this.renderSpinner=()=>R.createElement("div",{style:Object(Dw.b)()},R.createElement(gm.a,{type:"AppSpinnerProps",id:"PasswordSpinner",spinnerSize:Yp.a.small,appColors:this.props.appColors})),this.inputChanged=e=>{this.password=e,this.setState({mode:this.isInputValid(e)?_w.Default:_w.Invalid,errorMode:ww.Nil})},this.isInputValid=e=>void 0!==e&&0!==e.length,this.eyeButtonClickHandler=()=>{this.setState(e=>({inputMode:e.inputMode===Tw.Text?Tw.Password:Tw.Text}))},this.eyeButtonKeyEventHandler=e=>{e.stopPropagation()},this.eyeMouseKeyDownEventHandler=e=>{e.stopPropagation()},this.passwordDialogResultHandler=e=>{e===ER.a.Ok&&void 0!==this.password?(this.setState({mode:_w.Loading}),this.props.bodyControls.verifyPasswordAction(this.password,this.setPasswordDialogResult)):this.props.resultHandler(e)},this.setPasswordDialogResult=e=>{e===ww.Nil?this.props.resultHandler(ER.a.Ok):this.setState({mode:_w.Error,errorMode:e})},this.state={mode:void 0!==e.bodyControls.errorMode&&e.bodyControls.errorMode!==ww.Nil?_w.Error:_w.Invalid,inputMode:Tw.Password,errorMode:e.bodyControls.errorMode?e.bodyControls.errorMode:ww.Nil},this.errorMessageMapping=new Map([[ww.IncorrectPassword,e.bodyControls.incorrectPasswordErrorMessage],[ww.AttemptThresholdExceeded,e.bodyControls.attemptThresholdExceededErrorMessage],[ww.VerifyPasswordRequestFailure,e.bodyControls.verifyPasswordRequestFailureErrorMessage]])}}var Fw=n(1307),Bw=n(1393),Mw=n(1394),jw=n(1395),Ow=n(1396),Lw=n(1305),Aw=n(1397),Nw=n(1383),Ww=n(1409),zw=n(1386),Hw=n(1398),Vw=n(1399),Uw=n(1400),Gw=n(1308),qw=n(1384),Qw=n(1387),Kw=n(1401),Jw=n(1309),Yw=n(1402),Zw=n(1404),$w=n(1310),Xw=n(1311),eD=n(1403),tD=n(1388),nD=n(1406),oD=n(1385),rD=n(1407),iD=n(1392),aD=n(1411),sD=n(1412),lD=n(1413),cD=n(1408),uD=n(1414),dD=n(1381),pD=n(862),gD=n(1410),hD=n(1389),mD=n(1405),bD=n(229),fD=n(386);function xD(e){for(const t in e)"object"==typeof e[t]?xD(e[t]):e[t]=bD.utils.decodeHtml(e[t]);return e}function ED(e,t){Object(x.isChangeGateEnabled)("OfficeVSO:8365361_IsSharedCustomDialogInvestigationEnabled")&&i.a.sendTraceTag(508078243,a.a.msoulscat_ES_EWAJS,s.a.Info,`ShowExcelDialog dialogId: ${e}, dialogType: ${t.type}`);let n=t.dialogIcon?Object(Fw.a)(t.dialogIcon):void 0;const o=Object(Fw.b)(),r=Object(Fw.c)();switch(t.type){case"StandardDialogProps":{const e=function(e){return xD(e)}(_object_spread({},t));return function(e,t){const n=e.permanentDismissCheckbox?_object_spread_props(_object_spread({},e.permanentDismissCheckbox),{checkmarkIcon:t}):void 0;return R.createElement(fT,_object_spread_props(_object_spread({},e),{permanentDismissCheckbox:n}))}(_object_spread_props(_object_spread({},e),{icon:n,closeIconProps:o,msLogoProps:Fw.f,dragOptions:r,settings:kw}),Po.a.checkboxCheckmark)}case"CustomDialogProps":{n=n||t.icon;let l={};const c=function(e){return e.bodyControls=xD(e.bodyControls),e}(_object_spread({},t)),u=_object_spread_props(_object_spread({},c),{icon:n,closeIconProps:o,msLogoProps:Fw.f,dragOptions:r,settings:kw});switch(e){case"ChangeLocaleDialog":return Object(Bw.a)(u);case"ChangeSourceDialog":return Object(Mw.a)(u);case"ChartEditDataDialog":return Object(jw.a)(u);case"ChartEditTitleDialog":return Object(Ow.a)(u);case"ClipboardReadPermissionAskDialog":return Object(Lw.b)(u);case"CommercialTrustCenterDialog":l={checkmarkIcon:Po.a.checkboxCheckmark,optionalExperiencesInfoMessageIcon:Object(Fw.a)(ER.c.Info)};break;case"CoauthInfraStatisticsDialog":return Object(Aw.b)(u);case"CustomSortDialog":return Object(Nw.b)(u);case"CreateTableDialog":return Object(Ww.b)(u);case"DataValidationEditDialog":return Object(zw.b)(u);case"DataValidationErrorDialog":return Object(Hw.a)(u);case"ExcelLiveWelcomeDialog":return Object(Vw.b)(u);case"FindAndReplaceDialog":return Object(Uw.b)(u);case"FunctionDialog":return Object(Gw.a)(u);case"FunctionArgumentsDialog":return Object(qw.a)(u);case"FunctionSignatureDialog":return Object(Qw.a)(u);case"FormatAsTableDialog":return Object(Ww.b)(u);case"GotoDialog":return Object(Kw.a)(u);case"GroupOrUngroupCellsDialog":return Object(Jw.a)(u);case"HyperLinkDialog":return Object(Yw.b)(u);case"KeyboardShortcutsDialog":return Object(Zw.a)(u,Object(b.a)());case"InsertCopiedCutCellsDialog":return Object($w.a)(u);case"InsertDeleteCellsDialog":return Object(Xw.a)(u,Object(b.a)());case"InsertSlicerDialog":case"InsertTimeSlicerDialog":return Object(eD.b)(u);case"KeyboardShortcutsDialog":return Object(Zw.a)(u,Object(b.a)());case"PasswordDialog":return function(e,t){return R.createElement(Iw,_object_spread_props(_object_spread({},e),{appColors:t}))}(u,Object(b.a)());case"PresentModeWelcomeDialog":return Object(tD.b)(u);case"RenameSheetDialog":return sk(u);case"ReorderSheetDialog":return Object(nD.b)(u);case"ResizeHeadersDialog":return Object(oD.a)(u);case"ResizeTableDialog":return Object(rD.b)(u,Object(b.a)());case"AltTextDialog":return Object(x.isChangeGateEnabled)("OfficeVSO:8221342_ReactAltTextDialog")?ZT(u):Object(iD.b)(u);case"TableAltTextDialog":return Object(iD.b)(u);case"UnHideSheetDialog":return Object(aD.b)(u);case"WorkbookStatisticsDialog":return Object(sD.b)(u);case"PageLoadStatsDialog":return Object(lD.b)(u);case"AccessibilitySettingsDialog":l={checkmarkIcon:Po.a.checkboxCheckmark};break;case"SetDefaultPasteDialog":return Object(cD.a)(u);case"WACSessionIdDialog":return Object(uD.a)(u);case"ExcelCopilotStart":return Object(dD.a)(u);case"SuggestionSettingsDialog":return Object(pD.b)(u);case"TimerBasedRedirectDialog":return Object(gD.b)(u);case"UserConsentBasedProgressDialog":return Object(hD.a)(u);case"MoveChartDialog":return Object(mD.b)(u)}return function(e,t,n){switch(e){case"ColorPickerDialog":return function(e){return R.createElement(yR,_object_spread({},e))}(t);case"CopyPasteInstallDialog":return function(e){return R.createElement(FR,_object_spread({},e))}(t);case"CopyPasteNoClipboardAccessDialog":return function(e){return R.createElement(DR,_object_spread({},e))}(t);case"CopyPasteShortcutDialog":return function(e){return R.createElement(BR,_object_spread({},e))}(t);case"CustomSizeDialog":return function(e){return R.createElement(Bk,_object_spread({},e))}(t);case"DictationErrorDialog":return function(e){return R.createElement(CT,_object_spread({},e))}(t);case"DictationSettingsDialog":return function(e,t){return R.createElement(GT,_object_spread_props(_object_spread({},e),{appColors:t}))}(t,n);case"EmbedDialog":return function(e,t){return R.createElement(Uk,_object_spread_props(_object_spread({},e),{appColors:t}))}(t,n);case"FileUploadErrorDialog":return function(e,t){return R.createElement(Gk,_object_spread_props(_object_spread({},e),{appColors:t}))}(t,n);case"InsertLinkDialog":return function(e){return R.createElement(UR,_object_spread({},e))}(t);case"InsertFileDialog":return function(e,t){return R.createElement(pk,_object_spread_props(_object_spread({},e),{appColors:t}))}(t,n);case"JustificationDialog":return function(e,t){return R.createElement(Tk,_object_spread_props(_object_spread({},e),{appColors:t}))}(t,n);case"CommercialTrustCenterDialog":return function(e,t){return R.createElement(Pk,_object_spread_props(_object_spread({},e),{appColors:t}))}(t,n);case"MandatoryLabellingDialog":return function(e){return R.createElement(Jk,_object_spread_props(_object_spread({},e),{bodyProps:e.bodyControls}))}(t);case"OICErrorDialog":return function(e){return R.createElement(GR,_object_spread({},e))}(t);case"OICErrorDialogWithDownload":return function(e){return R.createElement(qR,_object_spread({},e))}(t);case"OICErrorDialogWithTrial":return function(e){return R.createElement(QR,_object_spread({},e))}(t);case"OptionsDialog":return function(e){return R.createElement(qT,_object_spread_props(_object_spread({},e),{bodyProps:e.bodyControls}))}(t);case"ParagraphDialog":return function(e){return R.createElement(ok,_object_spread({},e))}(t);case"ProvenanceDialog":return function(e){return R.createElement(Rw,_object_spread({},e))}(t);case"ProgressDialog":return function(e,t){return R.createElement(rk,_object_spread_props(_object_spread({},e),{appColors:t}))}(t,n);case"RenameDialog":return sk(t);case"SaveAsDialog":return function(e){return R.createElement(vk,_object_spread_props(_object_spread({},e),{bodyProps:e.bodyControls}))}(t);case"SharedAuthConsentDialog":return function(e,t){return R.createElement(d_,_object_spread_props(_object_spread({},e),{appColors:t}))}(t,n);case"ShortcutConflictResolutionDialog":return function(e){return R.createElement(Yk,_object_spread_props(_object_spread({},e),{bodyProps:e.bodyControls,conflictInfo:e.conflictInfo}))}(t);case"AccessibilitySettingsDialog":return i.a.sendTraceTag(508650442,a.a.msoulscat_Wac_Telemetry,s.a.Info,"User opened the AccessibilitySettingsDialog"),function(e){return R.createElement(KT,_object_spread({},e))}(t);case"AltTextDialog":return ZT(t);case"InsertTableDialog":case"SplitTableCellsDialog":return function(e){return R.createElement(h_,_object_spread({},e))}(t);case"AddinInstallDialog":return function(e){return R.createElement(e_,_object_spread({},e))}(t);case"AppsForOfficeInsertionDialog":return function(e){return R.createElement(n_,_object_spread({},e))}(t);case"AddInStoreDialog":return function(e){return R.createElement(yw,_object_spread({},e))}(t);default:return Object(PS.a)(e)}}(e,_object_spread({},u,l),Object(b.a)())}default:return Object(PS.a)(t)}}function SD(e,t){return Object(x.isChangeGateEnabled)("OfficeVSO:7858550_RemovingExcelThemeProvider")?R.createElement(Kv.a,null,ED(e,t)):R.createElement(Kv.a,null,R.createElement(fD.a,null,ED(e,t)))}const yD={initialize:function(e){Object(nk.d)(e,SD,Object(Fw.d)())},show:nk.e,hide:nk.c,update:nk.f,dispose:nk.b};function CD(e={},t){if(null===e)return{};switch(t.type){case My.j:const n=_object_spread({},e);return t.payload.models.forEach(e=>n[e.id]=e),n;default:return e}}function vD(e=[],t){if(null==e)return[];switch(t.type){case My.bb:return t.payload.activeGroups;default:return e}}var RD=n(2703);function kD(e={},t){if(null===e)return{};switch(t.type){case My.fb:return{flyoutAnchorId:t.payload.flyoutAnchorId};default:return e}}function TD(e={},t){if(null===e)return{};switch(t.type){case My.hb:return _object_spread({},e,t.payload.contextualUILayoutModel);case My.I:return e.floatieLayout?_object_spread_props(_object_spread({},e),{floatieLayout:void 0}):e;case My.H:return e.contextMenuLayout?_object_spread_props(_object_spread({},e),{contextMenuLayout:void 0}):e;case My.gb:return _object_spread_props(_object_spread({},e),{contextMenusToShadowRender:t.payload.contextMenusToShadowRender});case My.W:return _object_spread_props(_object_spread({},e),{contextMenuLayout:_object_spread_props(_object_spread({},e.contextMenuLayout),{target:t.payload.target}),floatieLayout:_object_spread_props(_object_spread({},e.floatieLayout),{target:t.payload.target})});default:return e}}var _D=n(2534),wD=n(392),DD=n(29);const PD=e=>e.contextMenuModel.flyoutAnchorId,ID=e=>!!e.contextualUILayoutModel.contextMenuLayout,FD=Object(Rc.a)([PD,kc.V,kc.u,kc.cb],(e,t,n,o)=>{const r=e&&Object(kc.v)(t,n,e);if(r&&"FlyoutAnchorModel"===r.type&&r.menuModel&&!r.hidden)return LD(r.menuModel,t,n,o)}),BD=Object(Rc.a)([kc.V,kc.u,kc.cb,kc.wb,kc.F],(e,t,n,o,r)=>{const i=r[DD.a.ZeroTermContextMenu];var a;return o&&o.queryText&&""!==o.queryText&&o.menuModel?AD(o.menuModel,e,t,n,Jc.a.SearchResult,null==i||null===(a=i.menuModel)||void 0===a||null===(a=a.menuTargetDescriptor)||void 0===a?void 0:a.menuTargetType):i&&i.menuModel&&!i.disabled?AD(i.menuModel,e,t,n,Jc.a.ZeroTermMenu):void 0}),MD=Object(Rc.a)([kc.V,kc.u,kc.cb,e=>e.contextualUILayoutModel.contextMenusToShadowRender],(e,t,n,o)=>{const r=new Map;if(o)return o.forEach(o=>{const i=o&&Object(kc.v)(e,t,o);i&&"FlyoutAnchorModel"===i.type&&i.menuModel?r.set(o,LD(i.menuModel,e,t,n)):r.set(o,void 0)}),r}),jD=Object(Rc.a)([kc.F],e=>!!e[DD.a.ZeroTermContextMenu]),OD=Object(Rc.a)([PD,kc.V,kc.u,kc.F],(e,t,n,o)=>{const r=e&&Object(kc.v)(t,n,e),i=o[DD.a.ZeroTermContextMenu];return r&&"FlyoutAnchorModel"===r.type&&r.menuModel&&r.hidden&&i?Jc.a.ZeroTermMenu:Jc.a.StandardContextMenu}),LD=Object(Je.a)((e,t,n,o)=>Object(wD.a)(e,t,n,o)),AD=Object(Je.a)((e,t,n,o,r,i)=>{var a;const s=Object(wD.a)(e,t,n,o,void 0,void 0,void 0,!0);return _object_spread_props(_object_spread({},s),{menuTargetType:null!==(a=s.menuTargetType)&&void 0!==a?a:i,contextualUILocation:r})});var ND=n(489),WD=n(476),zD=n(2564);const HD=e=>!!e&&!!e.sections&&e.sections.some(e=>e.controls&&e.controls.length>0),VD=e=>HD(e)&&(null==e?void 0:e.contextualUILocation)||Jc.a.StandardContextMenu,UD=e=>{const t=[];return e.floatieProps.hidden||t.push(Jc.a.Floatie),e.contextMenuProps.hidden||(e.contextMenuProps.searchableContextualMenuProps?(t.push(Jc.a.SearchResult),e.contextMenuProps.searchableContextualMenuProps.initialView!==Jc.a.ZeroTermMenu&&t.push(Jc.a.StandardContextMenu),e.contextMenuProps.searchableContextualMenuProps.zeroTermMenuEnabled&&t.push(Jc.a.ZeroTermMenu)):t.push(Jc.a.StandardContextMenu)),t},GD=(e,t)=>{var n;let o=void 0;return null!==(n=e.searchableContextualMenuProps)&&void 0!==n&&n.menuDefinition?o=e.searchableContextualMenuProps.menuDefinition:e.menuDefinition&&(o=e.menuDefinition),qD(t,o)},qD=(e,t)=>{if(!t)return[];const n=[];for(const i of t.sections)for(const t of i.controls){const a={commandId:t.id,location:e};var o,r;i.data&&i.data.itemsMetadata&&i.data.itemsMetadata[t.id]&&(a.source=null===(o=i.data.itemsMetadata[t.id])||void 0===o?void 0:o.source,a.confidenceScore=null===(r=i.data.itemsMetadata[t.id])||void 0===r?void 0:r.confidenceScore),n.push(a)}return n};function QD(e){if(!e)return[];const t=[];for(const n of e.sections)for(const e of n.controls)t.push(e.id);return t}function KD(e){return e?e.map(e=>e.id):[]}function JD(e){const t=[];switch(e.type){case"MultiRowFloatieGroup":const n=e;t.push(...KD(n.topControlsRow)),t.push(...KD(n.bottomControlsRow));break;case"SingleRowFloatieGroup":const o=e;t.push(...KD(o.controls));break;case"SingleControlFloatieGroup":const r=e;r.control&&t.push(r.control.id)}return t}let YD="",ZD="";const $D=(e,t,n)=>{const o=t||DD.a.ContextMenu;Object(WD.c)(o,"FlyoutAnchorModel",e)({id:o,location:Jc.b.ContextMenu,isShadowRendering:n})},XD=Object(zD.a)("ContextualUIPopulate",(e,t,n)=>{$D(e,t,n)}),eP=Object(zD.a)("ContextMenuPopulate",(e,t,n)=>{$D(e,t,n)}),tP=Object(zD.a)("ContextMenuDispatch",(e,t)=>{e(Object(_D.h)(t))}),nP=Object(zD.a)("ContextualUIDispatch",(e,t)=>{e(Object(_D.h)(t))}),oP=Object(zD.a)("FloatieDispatch",(e,t)=>{e(Object(_D.h)(t))}),rP=Object(zD.a)("RepostiionContextualUI",(e,t)=>{e(Object(_D.d)(t))}),iP=e=>!!e&&void 0===!e.x;var aP=n(2245),sP=n(1028),lP=n(3065),cP=n(1510),uP=n(1608),dP=n(1613),pP=n(1194),gP=n(1618),hP=n(1229),mP=n(1625),bP=n(2450);const fP=e=>{let t=0,n=e;for(;n;){const e=parseInt(window.getComputedStyle(n).zIndex,10);if(e){t=e;break}n=n.parentElement}return t};var xP=n(272),EP=n(1027),SP=n(1047),yP=n(706),CP=n(2609),vP=n(369),RP=n(486);const kP=Object(Jo.c)(e=>({width:"260px",display:"flex",flexDirection:e?"column-reverse":"column"})),TP=Object(Jo.c)((e,t)=>{const n=Object(ih.a)(e),o={margin:"1px",selectors:{".ms-Button":_object_spread_props(_object_spread({},ci.h),{borderRadius:"4px",selectors:{":after":{display:"none"},":focus":_object_spread_props(_object_spread({},ci.s),{border:"1px solid "+n.focusedBorderColor}),":hover":_object_spread({},ci.s)}}),i:{width:"20px",height:"20px",selectors:{svg:_object_spread({},Object(ci.A)())}}}};return{root:{margin:t?"4px 12px 6px 12px":"6px 12px 4px 12px",height:"30px",borderRadius:"4px",padding:"0px 0px 0px 8px",borderColor:ac.a.gray50,selectors:{":hover":_object_spread_props(_object_spread({},ci.s),{borderColor:ac.a.gray50,borderRadius:"4px"}),":after":_object_spread_props(_object_spread({},ci.s),{border:"1px solid "+n.focusedBorderColor,borderRadius:"4px"})}},iconContainer:{display:"none"},clearButton:o}}),_P=Object(Jo.c)((e,t)=>{const n=Object(ih.a)(e),o={selectors:{"button span":{textOverflow:"ellipsis",overflow:"hidden"},"li:first-child li:first-child":t?{backgroundColor:n.toggledBackgroundColor,outline:"1px solid "+n.inputBorderColor,outlineOffset:"-1px"}:void 0,'li div[data-automation-type="RibbonComboBox"]':{width:"100%",selectors:{"> div:first-child":{maxWidth:"66%"},i:{flexShrink:0},"i + .textContainer":{overflow:"hidden"},".textContainer":{selectors:{label:{textOverflow:"ellipsis",overflow:"hidden",lineHeight:"normal"}}}}}}};return Object(F.eb)(o)});class wP extends R.Component{render(){return R.createElement(we.a,null,e=>R.createElement("div",{role:"search",style:kP(this.props.searchBoxOnTheBottom)},R.createElement(dv.a,{elementTimingId:"context-menu",hidden:this.props.hidden,interactivityTrackerContext:this.props.menuId}),this.renderSearchBox(e),R.createElement("div",{ref:this.menuRegion,role:"menu",id:this.resultsWrapperId,"aria-label":this.props.appStrings.searchableMenuRegionLabel,className:_P(e,!!this.state.searchBoxFocused&&this.isSearchResult())},this.renderSearchResults())))}componentDidMount(){this.props.hidden||this.onMenuOpen()}componentWillUnmount(){this.props.hidden||this.onMenuClosed()}componentDidUpdate(e){!this.props.hidden&&e.hidden?this.onMenuOpen():this.props.hidden&&!e.hidden&&this.onMenuClosed()}renderSearchBox(e){return R.createElement(Bg.a,{"data-no-horizontal-wrap":"false",type:"text",ariaLabel:this.props.appStrings.searchLabel,"aria-controls":this.resultsWrapperId,id:this.props.searchBoxId,clearButtonProps:{ariaLabel:this.props.appStrings.clearSearch,iconProps:{iconName:this.props.appIcons.closeIcon}},iconProps:{iconName:""},styles:TP(e,this.props.searchBoxOnTheBottom),placeholder:this.props.appStrings.searchPlaceholderLong,onChange:this.onSearchChanged,onSearch:this.onSearchExecuted,onEscape:this.onEscape,autoComplete:"off",value:this.state.query,onClick:this.onClick,onFocus:this.onSearchBoxFocus,onBlur:this.onSearchBoxBlur,onContextMenu:this.onContextMenu})}renderSearchResults(){return this.props.defaultRender(this.props.menuListProps)}onSearchBoxFocus(e){this.setState({searchBoxFocused:!0}),this.props.onSearchBoxFocused&&this.props.onSearchBoxFocused()}onSearchBoxBlur(e){this.setState({searchBoxFocused:!1})}onClick(){this.props.onShowZeroTermMenu&&this.props.zeroTermMenuEnabled&&this.props.initialView!==Jc.a.ZeroTermMenu&&this.props.onShowZeroTermMenu()}onSearchExecuted(e){var t,n;if(null===(t=(n=this.context).isExperimentalFeatureEnabled)||void 0===t||!t.call(n,"Microsoft.Office.SharedOnline.SharedSerpletEnableActionAITab")){if(!this.isSearchResult())return void(!this.state.query&&this.props.onShowZeroTermMenu&&this.props.zeroTermMenuEnabled&&this.props.onShowZeroTermMenu());const e=this.props.menuListProps.items?this.props.menuListProps.items[0]:void 0;if(null!=e&&e.onClick&&!e.disabled)return void e.onClick();if(this.focusFirstMenuItem())return}this.props.onSearchExecuted&&this.props.onSearchExecuted(e)}isSearchResult(){return this.props.contextualUILocation===Jc.a.SearchResult||this.props.contextualUILocation===Jc.a.ZeroTermMenu}focusFirstMenuItem(){const e=this.menuRegion.current;if(!e)return!1;const t=Object(Il.j)(e,e);return!!t&&(t.focus(),!0)}onSearchChanged(e,t){const n=t||"",o=n.length>0;this.props.onSearchStateChanged&&this.props.onSearchStateChanged(o,n),this.setState({query:n})}onEscape(e){if(!this.state.query)return this.props.onHideZeroTermMenu&&this.props.contextualUILocation===Jc.a.ZeroTermMenu&&this.props.initialView!==this.props.contextualUILocation?(this.props.onHideZeroTermMenu(),e.preventDefault(),void e.stopPropagation()):void(this.props.onEscape&&this.props.onEscape(e))}onContextMenu(e){e.preventDefault(),e.stopPropagation()}onMenuOpen(){(new Ed.a).setImmediate(()=>{this.props.onMenuOpened&&this.props.onMenuOpened()})}onMenuClosed(){this.props.onMenuClosed&&this.props.onMenuClosed()}static getDerivedStateFromProps(e,t){return""!==t.query&&e.hidden?{query:""}:null}constructor(e){super(e),this.resultsWrapperId="resultsWrapper",this.menuRegion=R.createRef(),this.onSearchChanged=this.onSearchChanged.bind(this),this.onEscape=this.onEscape.bind(this),this.onSearchExecuted=this.onSearchExecuted.bind(this),this.onClick=this.onClick.bind(this),this.onSearchBoxFocus=this.onSearchBoxFocus.bind(this),this.onSearchBoxBlur=this.onSearchBoxBlur.bind(this),this.state={query:""}}}wP.contextType=Hm.a;const DP=(e,t)=>{const n=Object(ih.a)(e).menuBackgroundColor;return{root:{animation:"none"},container:t&&{opacity:0},calloutMain:Object(ix.c)()&&{backgroundColor:n}}},PP=Object(Jo.c)(()=>({label:{maxWidth:320,textOverflow:"ellipsis",overflowX:"hidden"},divider:{margin:"1px 8px"},root:{},linkContent:{},icon:{},checkmarkIcon:{},secondaryText:{paddingLeft:"20px"},subMenuIcon:{},item:{},anchorLink:{},iconColor:{}})),IP=Object(Jo.c)(e=>({styles:{root:{zIndex:e}}}));class FP extends R.Component{static getDerivedStateFromProps(e,t){return t.isShadowRendering&&!e.hidden?{isShadowRendering:!1}:null}shouldComponentUpdate(e,t){return!(this.props.hidden&&e.hidden&&!t.isShadowRendering||Object(cu.e)(this.props,e)&&Object(cu.e)(this.state,t))}render(){const{id:e,target:t,directionalHint:n,positionAndHide:o,inputMethod:r,hidden:i,useLegacyContextMenu:a}=this.props,s=this.getLayerZIndex();return R.createElement(we.a,null,l=>R.createElement(yP.a.Provider,{value:Object(yP.b)(!!this.state.isShadowRendering)},R.createElement("div",{ref:this.contextMenuWrapper},R.createElement(Mr.a,_object_spread_props(_object_spread({useLegacyContextMenu:a||!1,id:`${Jc.b.ContextMenu}-${e}`,interactivityTrackerContext:e,onRenderMenuList:this.isContextualSearchEnabled()?this.renderSearchableMenuList:this.renderMenuWithReactUiPaintTiming,onDismiss:this.onDismiss,onMenuOpened:this.onContextMenuOpen},this.getContextualMenuProps(l)),{directionalHint:n||Se.a.bottomLeftEdge,directionalHintFixed:!1,alignTargetEdge:!0,target:t,calloutProps:{id:""+e,onPositioned:this.onPositioned,preventDismissOnScroll:!0,preventDismissOnLostFocus:!0,styles:DP(l,o),calloutMaxHeight:this.maxHeight(),layerProps:_object_spread_props(_object_spread({},s>F.G.Layer?IP(s):void 0),{eventBubblingEnabled:!0})},shouldFocusOnContainer:!this.isContextualSearchEnabled()&&r!==hC.a.Keyboard&&!this.controlIdToExpand,shouldFocusOnMount:this.autoOpenSubmenuFixes()?!this.controlIdToExpand:void 0,"data-unique-id":"ContextMenu",hidden:i,shouldUpdateWhenHidden:this.state.isShadowRendering,contextMenuRef:this.props.contextMenuRef,onPositioningEnd:this.props.onPositioningEnd,attachedFloatie:this.props.attachedFloatie,shortcutMetadata:this.props.shortcutMetadata,isSearchExecuting:this.isSearchExecuting,positionAndHide:this.renderV9MenuAndFloatieTogether()&&this.props.positionAndHide})))))}componentDidMount(){this.props.hidden||this.addListeners(),Object(sP.a)(()=>{this.contextualItemRef&&this.contextualItemRef.current&&(this.contextualItemRef.current.openSubMenu(),this.pendingOpenSubmenu=!1)});const{populateMenuCallback:e,id:t}=this.props;Object(EP.a)()&&this.shadowRenderingIsEnabled()&&e&&(window.requestIdleCallback(()=>{e(hC.a.Mouse,t,!0)},void 0,`ContextMenu-${this.props.id}-ShadowMenuOpen`),window.requestIdleCallback(()=>{this.setState({isShadowRendering:!0})},void 0,`ContextMenu-${this.props.id}-StartShadowRendering`))}componentDidUpdate(e){this.props.hidden?(this.isSearchExecuting=!1,this.removeListeners()):this.addListeners(),this.state.isShadowRendering&&void 0!==this.props.menuDefinition&&this.setState({isShadowRendering:!1}),Object(sP.a)(()=>{(e.hidden&&!this.props.hidden||e.menuDefinition!==this.props.menuDefinition||this.autoOpenSubmenuFixes()&&this.pendingOpenSubmenu)&&this.contextualItemRef&&this.contextualItemRef.current&&(this.contextualItemRef.current.openSubMenu(),this.pendingOpenSubmenu=!1)})}componentWillUnmount(){this.removeListeners()}onPositioned(e){const{onPositioned:t}=this.props;t&&t(e),this.targetEdge=(null==e?void 0:e.targetEdge)||mc.b.bottom}renderMenuWithReactUiPaintTiming(e,t){return R.createElement(R.Fragment,null,t(e),R.createElement(dv.a,{elementTimingId:"context-menu",hidden:this.props.hidden,interactivityTrackerContext:this.props.id}))}renderSearchableMenuList(e,t){var n,o,r,i,a,s,l;const c={sessionId:this.props.sessionId,contextualUILocation:this.getContextualUiLocation(),zeroTermMenuEnabled:null===(n=this.props.searchableContextualMenuProps)||void 0===n?void 0:n.zeroTermMenuEnabled,initialView:null!==(o=null===(r=this.props.searchableContextualMenuProps)||void 0===r?void 0:r.initialView)&&void 0!==o?o:Jc.a.StandardContextMenu,menuId:this.props.id,onEscape:e=>this.onDismiss(e,!0),onSearchStateChanged:this.onSearchStateChanged,appStrings:this.props.appStrings,appIcons:this.props.appIcons,hidden:this.props.hidden,searchBoxOnTheBottom:this.targetEdge===mc.b.top,menuListProps:e,defaultRender:t,searchBoxId:this.searchBoxId,onShowZeroTermMenu:this.onShowZeroTermMenu,onHideZeroTermMenu:null===(i=this.props.searchableContextualMenuProps)||void 0===i?void 0:i.onHideZeroTermMenu,onSearchExecuted:null===(a=this.props.searchableContextualMenuProps)||void 0===a?void 0:a.openSearchPane,onMenuOpened:null===(s=this.props.searchableContextualMenuProps)||void 0===s?void 0:s.onAfterMenuOpen,onMenuClosed:null===(l=this.props.searchableContextualMenuProps)||void 0===l?void 0:l.onAfterMenuDismiss,onSearchBoxFocused:this.props.onSearchBoxFocused};return R.createElement(wP,_object_spread({},c))}onShowZeroTermMenu(){this.props.searchableContextualMenuProps&&(Object(Zf.a)(this.context,Zf.f.fixIncorrectMenuShownDuringSearch)&&(this.isSearchExecuting=!0),this.props.onFloatieDismiss&&this.props.onFloatieDismiss(),this.props.searchableContextualMenuProps.onShowZeroTermMenu())}onSearchStateChanged(e,t){this.props.searchableContextualMenuProps&&(Object(Zf.a)(this.context,Zf.f.fixIncorrectMenuShownDuringSearch)&&(this.isSearchExecuting=!0),e&&this.props.onFloatieDismiss&&this.props.onFloatieDismiss(),this.props.searchableContextualMenuProps.onSearchStateChanged(e,t))}isContextualSearchEnabled(){return!!this.props.searchableContextualMenuProps}useSearchableMenu(){var e,t;return(null===(e=this.props.searchableContextualMenuProps)||void 0===e?void 0:e.initialView)===Jc.a.ZeroTermMenu||HD(null===(t=this.props.searchableContextualMenuProps)||void 0===t?void 0:t.menuDefinition)}getContextualMenuItemToExpand(e){if(!this.autoOpenSubmenuFixes())return Object(pC.d)(e,e=>e.key===this.controlIdToExpand);for(const t of e){if(t.key===this.controlIdToExpand)return t;if(t.sectionProps){const e=Object(pC.d)(t.sectionProps.items,e=>e.key===this.controlIdToExpand);if(void 0!==e)return e}}}getMenuItemToExpand(e,t){if(e){this.controlIdToExpand=void 0;for(const n of e.sections)for(const e of n.controls)if((Object(Kk.a)(e)||Object(bP.a)(e))&&e.menuDefinition&&e.menuDefinition.shouldAutoOpen){const n=this.contextualItemRef;if(this.controlIdToExpand=e.id,this.controlIdToExpand&&t){const e=this.getContextualMenuItemToExpand(t.items);this.contextualItemRef=e&&e.componentRef}else this.contextualItemRef=void 0;return void(this.autoOpenSubmenuFixes()&&n!==this.contextualItemRef&&this.contextualItemRef&&(this.pendingOpenSubmenu=!0))}}}addListeners(){this.hasListeners||(window.document.body.addEventListener("mousedown",this.onMouseDown,!0),this.hasListeners=!0)}removeListeners(){this.hasListeners&&(window.document.body.removeEventListener("mousedown",this.onMouseDown,!0),this.hasListeners=!1)}unregisterTooltips(){this.tooltipHostMap.forEach(e=>{e.unregisterTooltipHostActions()}),this.tooltipHostMap.clear()}getContextualUiLocation(){var e;return VD(null===(e=this.props.searchableContextualMenuProps)||void 0===e?void 0:e.menuDefinition)}constructor(e){super(e),this.searchBoxId="contextualSearchBox",this.contextMenuWrapper=R.createRef(),this.pendingOpenSubmenu=!1,this.tooltipHostMap=new Map,this.flyoutDropdownId="FlyoutDropDownId",this.isSearchExecuting=!1,this.autoOpenSubmenuFixes=()=>{var e,t,n,o;return(null===(e=(t=this.context).isExperimentalFeatureEnabled)||void 0===e?void 0:e.call(t,"Microsoft.Office.SharedOnline.AutoOpenSubmenuFixes"))||(null===(n=(o=this.context).isExperimentalFeatureEnabled)||void 0===n?void 0:n.call(o,"Microsoft.Office.WordOnline.ContextualUIImprovementsEnabled"))},this.renderV9MenuAndFloatieTogether=()=>!!Object(Zf.a)(this.context,Zf.f.renderV9MenuAndFloatieTogetherEnabled),this.getLayerZIndex=()=>{var e,t;let n=-1;if(this.props.hidden||null===(e=(t=this.context).isExperimentalFeatureEnabled)||void 0===e||!e.call(t,"SharedOnline.ChangeGate.GenericContextMenusIsEnabled"))return n;const o=document.querySelectorAll(`[ data-contextmenu-id='${this.props.id}']`);if(o)for(let e=0;e<o.length;e+=1)n=Math.max(fP(o[e]),n);return n+1},this.getContextualMenuProps=e=>{var t,n,o,r,i,a,s;const l=this.useSearchableMenu(),c=l?Object(vP.a)(null===(t=this.props.searchableContextualMenuProps)||void 0===t?void 0:t.menuDefinition,this.onItemExecute,void 0,Jc.b.ContextMenu):this.props.menuDefinition,u=Object(SP.b)({menuDefinition:c,controlInMenuRendererFunction:l?this.controlInMenuTellMeRendererFunction:this.controlInMenuRendererFunction,location:Jc.b.ContextMenu,subComponentStyles:PP(),customMenuClassNames:_object_spread_props(_object_spread({},Object(F.db)({header:{padding:"6px 12px",height:"unset",lineHeight:"normal",whiteSpace:"normal"}})),{subComponentStyles:{menuItem:{},callout:{}}}),arePerfImprovementsEnabled:null===(n=(o=this.context).isExperimentalFeatureEnabled)||void 0===n?void 0:n.call(o,"ContextualUIPerfImprovementsIsEnabled"),onMenuItemExecuted:this.useSearchableMenu()?void 0:this.onItemExecute,onSubMenuPositioned:this.onSubmenuPositioned,onMenuPositioned:this.onCalloutReady,theme:e,isMultiWindowSupportEnabled:null===(r=(i=this.context).isExperimentalFeatureEnabled)||void 0===r?void 0:r.call(i,Zf.f.multiWindowSupportIsEnabled),useFullDescriptionLabelOnly:null===(a=(s=this.context).isExperimentalFeatureEnabled)||void 0===a?void 0:a.call(s,Zf.f.useFullDescriptionLabelOnly),isExperimentalFeatureEnabled:this.context.isExperimentalFeatureEnabled},!0,this.context.appWindow);return this.getMenuItemToExpand(c,u),u.focusZoneProps=_object_spread_props(_object_spread({},u.focusZoneProps),{shouldInputLoseFocusOnArrowKey:e=>this.isContextualSearchEnabled()&&e.id===this.searchBoxId}),u},this.onContextMenuOpen=()=>{const{onMenuOpen:e,id:t}=this.props;e&&e({id:t,location:Jc.b.ContextMenu})},this.onDismiss=(e,t)=>{const{onDismiss:n}=this.props;n&&n(e,t),this.tooltipHostMap&&this.unregisterTooltips()},this.onMouseDown=e=>{this.props.onDismiss&&!this.elementIsWithinContextMenu(e)&&this.onDismiss(e)},this.elementIsWithinContextMenu=e=>void 0!==e&&(this.contextMenuWrapper.current===e.target||Object(Ki.a)(this.contextMenuWrapper.current,e.target)),this.shadowRenderingIsEnabled=()=>{var e,t,n,o,r,i;return(null===(e=(t=this.context).isExperimentalFeatureEnabled)||void 0===e?void 0:e.call(t,"ContextMenuShadowRenderingIsEnabled"))&&!(null!==(n=(o=this.context).isExperimentalFeatureEnabled)&&void 0!==n&&n.call(o,"ResponsiveUxIsEnabled"))&&!(null!==(r=(i=this.context).isExperimentalFeatureEnabled)&&void 0!==r&&r.call(i,"Microsoft.Office.SharedOnline.DelayLazyActions"))},this.maxHeight=()=>window.innerHeight-2*RP.a.floatieLargeControlHeight,this.onItemExecute=(e,t)=>{this.props.onItemExecute&&this.props.onItemExecute(e,this.getContextualUiLocation(),t)},this.onSubmenuPositioned=(e,t)=>{t&&(this.tooltipHostMap=Object(mP.a)(e,t+"MenuId",this.tooltipHostMap,this.context.setTooltipElement,this.context.updateTooltipsHidden,!!Object(Zf.a)(this.context,Zf.f.delayRenderTooltipsIsEnabled))),this.props.onItemSubmenuOpen&&this.props.onItemSubmenuOpen(t,this.getContextualUiLocation())},this.onCalloutReady=e=>{0===this.tooltipHostMap.size&&(this.tooltipHostMap=Object(mP.a)(e,this.flyoutDropdownId,this.tooltipHostMap,this.context.setTooltipElement,this.context.updateTooltipsHidden,!!Object(Zf.a)(this.context,Zf.f.delayRenderTooltipsIsEnabled)))},this.state={isShadowRendering:!1},this.renderSearchableMenuList=this.renderSearchableMenuList.bind(this),this.onSearchStateChanged=this.onSearchStateChanged.bind(this),this.onPositioned=this.onPositioned.bind(this),this.onShowZeroTermMenu=this.onShowZeroTermMenu.bind(this),this.renderMenuWithReactUiPaintTiming=this.renderMenuWithReactUiPaintTiming.bind(this),this.controlInMenuRendererFunction=Om(this.props.appIcons,this.props.appStrings),this.controlInMenuTellMeRendererFunction=Object(CP.a)(this.props.appIcons,this.props.appStrings,this.props.appColors),this.hasListeners=!1,this.flyoutDropdownId=Object(xP.c)(this.props,this.props.id)}}FP.contextType=Hm.a;var BP=n(3087),MP=n(2704),jP=n(710),OP=n(1236);function LP(e,t){const n=Object(jP.d)(e);return n===mc.b.top&&t===mc.b.left||n===mc.b.left&&t===mc.b.top?Se.a.topLeftEdge:n===mc.b.bottom&&t===mc.b.left||n===mc.b.left&&t===mc.b.bottom?Se.a.bottomLeftEdge:n===mc.b.bottom&&t===mc.b.right||n===mc.b.right&&t===mc.b.bottom?Se.a.bottomRightEdge:n===mc.b.top&&t===mc.b.right||n===mc.b.right&&t===mc.b.top?Se.a.topRightEdge:Se.a.topLeftEdge}class AP extends R.PureComponent{static getDerivedStateFromProps(e,t){const n=e.contextMenuProps.target,o=e.floatieProps.target;return e.contextMenuProps.hidden||e.floatieProps.hidden||t.lastPropsContextMenuTarget===n||t.lastPropsFloatieTarget===o?{lastPropsContextMenuTarget:n,lastPropsFloatieTarget:o}:{contextMenuPositioned:!1,floatiePositioned:!1,floatieLayoutFromState:void 0,floatieMenuOpened:!1,fullyPositioned:!1,lastPropsContextMenuTarget:n,lastPropsFloatieTarget:o}}componentDidUpdate(e){var t,n;if(this.props.positionInOneFrameIsEnabled&&!this.state.fullyPositioned)if(this.props.floatieProps.attachedContextMenu){const e=this.getWindow().document,t=function(e,t,n,o){var r,i,a,s;let l=Se.a.topLeftEdge,c={top:0,left:0};if(null===e||null==t||void 0===n)return{directionalHint:l,target:c};const u=e.getBoundingClientRect(),d=t.getBoundingClientRect(),p=window.innerWidth,g=window.innerHeight,h=d.width,m=d.height,b=Object(OP.d)(t),f=null!==(r=null==b?void 0:b.top)&&void 0!==r?r:0,x=g-(null!==(i=null==b?void 0:b.bottom)&&void 0!==i?i:0),E=null!==(a=n.left)&&void 0!==a?a:0,S=null!==(s=n.top)&&void 0!==s?s:0,y=S+m<=g-x,C=E+h<=p,v=y||S-m-f>0,R=u.width,k=u.height,T=y?S:v?S-m:f,_=y?S+m:v?S:m,w=C?E:E-h,D=C?E+h:E,P=y?T-(o+k)>0:_+o+k<g,I=!y&&_+x+o+k>g,F=I?D+R<p:w+R<p;return I?F?(l=Se.a.rightTopEdge,c={top:T,left:D}):(l=Se.a.leftTopEdge,c={top:T,left:w}):y&&P&&F||!y&&!P&&F?(l=Se.a.topLeftEdge,c={top:T,left:w}):y&&P&&!F||!y&&!P&&!F?(l=Se.a.topRightEdge,c={top:T,left:D}):y&&!P&&F||!y&&P&&F?(l=Se.a.bottomLeftEdge,c={top:_,left:w}):(l=Se.a.bottomRightEdge,c={top:_,left:D}),{directionalHint:l,target:c}}(e.getElementById(BP.c),e.querySelector(this.getContextMenuSelector()),this.props.contextMenuProps.target,BP.b);this.setState({floatieLayoutFromState:_object_spread_props(_object_spread({},t),{gapSpace:BP.b}),fullyPositioned:!0},this.addListeners)}else this.setState({fullyPositioned:!0},this.addListeners);else this.isContextualUIVisible()?this.addListeners():this.removeListeners();null!==(t=(n=this.context).isExperimentalFeatureEnabled)&&void 0!==t&&t.call(n,Zf.f.isFluentV9DispatchOptimizationEnabled)&&(this.props.contextMenuProps.hidden&&!this.props.contextMenuProps.attachedFloatie||this.props.contextMenuProps.attachedFloatie&&this.props.contextMenuProps.hidden&&this.props.floatieProps.hidden)&&(this.contextMenuRef=this.contextMenuRef=R.createRef());const o=this.isContextualUIVisible(),r=this.isContextualUIVisibleFromProps(e);o&&!r?this.onShow():!o&&r&&this.onHide()}componentDidMount(){this.isContextualUIVisible()&&this.addListeners()}componentWillUnmount(){this.removeListeners()}render(){var e,t,n,o;const r=(null===(e=(t=this.context).isExperimentalFeatureEnabled)||void 0===e?void 0:e.call(t,Zf.f.fluentV9ContextMenuIsEnabled))&&(null===(n=(o=this.context).isExperimentalFeatureEnabled)||void 0===n?void 0:n.call(o,Zf.f.isStopKeyDownEventPropagationInV9MenuEnabled));return R.createElement(gP.a,{hostId:this.props.containerId,eventBubblingEnabled:!r},R.createElement("div",{ref:this.contextualUIWrapper},this.renderContextMenu(),this.renderFloatie()))}menuIdHasBeenRenderedBefore(e){return Object(pC.e)(this.contextMenuIds,t=>t===e)>-1}renderContextMenu(){var e,t;const n=Object(de.g)(),{contextMenuProps:o,contextMenusToShadowRender:r,populateMenuCallback:i,onFloatieDismiss:a,positionInOneFrameIsEnabled:s}=this.props;let l=[];return(null===(e=(t=this.context).isExperimentalFeatureEnabled)||void 0===e?void 0:e.call(t,"IDBasedContextMenusIsEnabled"))?(r&&r.forEach((e,t)=>{this.menuIdHasBeenRenderedBefore(t)||this.contextMenuIds.push(t)}),this.menuIdHasBeenRenderedBefore(o.id)||this.contextMenuIds.push(o.id),l=this.contextMenuIds.map(e=>R.createElement(FP,_object_spread_props(_object_spread({},o),{menuDefinition:r&&r.has(e)?r.get(e):o.menuDefinition,sessionId:this.sessionId,key:e,id:e,onPositioned:s?void 0:this.onContextMenuPositioned,onDismiss:this.onContextMenuDismiss,onFloatieDismiss:a,positionAndHide:this.shouldPositionContextMenuHidden(),hidden:!this.shouldRenderContextMenu(e),populateMenuCallback:i,onItemExecute:this.onContextualItemExecute,onItemSubmenuOpen:this.onSubMenuPositioned,onSearchBoxFocused:this.onSearchBoxFocused,contextMenuRef:this.contextMenuRef,onPositioningEnd:this.onContextMenuRefCreatedAndPositioned,attachedFloatie:this.props.floatieProps.attachedContextMenu,shortcutMetadata:this.props.contextMenuProps.shortcutMetadata,useLegacyContextMenu:this.shouldFallbackToLegacyMenu()})))):l.push(R.createElement(FP,_object_spread_props(_object_spread({},o),{sessionId:this.sessionId,key:o.id,id:o.id,onPositioned:s?void 0:this.onContextMenuPositioned,onDismiss:this.onContextMenuDismiss,onFloatieDismiss:a,positionAndHide:this.shouldPositionContextMenuHidden(),hidden:!this.shouldRenderContextMenu(),onItemExecute:this.onContextualItemExecute,onItemSubmenuOpen:this.onSubMenuPositioned,onSearchBoxFocused:this.onSearchBoxFocused,contextMenuRef:this.contextMenuRef,onPositioningEnd:this.onContextMenuRefCreatedAndPositioned,attachedFloatie:this.props.floatieProps.attachedContextMenu,shortcutMetadata:this.props.contextMenuProps.shortcutMetadata,useLegacyContextMenu:this.shouldFallbackToLegacyMenu()}))),n?l:R.createElement(hm.a,null,l)}renderFloatie(){const e=Object(de.g)(),{floatieProps:t,onFloatieDismiss:n,useSmallScreenLayout:o,floatieGroupsToShadowRender:r,positionInOneFrameIsEnabled:i}=this.props,{floatieLayoutFromState:a}=this.state,s=R.createElement(we.a,null,e=>R.createElement(BP.a,_object_spread_props(_object_spread({},t,t.attachedContextMenu&&a),{originalTarget:t.target,onPositioned:i?void 0:this.onFloatiePositioned,onDismiss:n,onFadedAway:this.onFloatieFadedAway,onMenuToggled:this.onFloatieMenuToggled,positionAndHide:this.shouldPositionFloatieHidden(),hidden:i?!this.shouldRenderFloatieV2():!this.shouldRenderFloatie(),isSmallScreenFloatie:o,scrollStyles:Object(MP.d)(e,Object(ue.a)()),floatieGroupsToShadowRender:r,positionFloatieInSingleFrame:i,onItemExecute:this.onContextualItemExecute,onItemSubmenuOpen:this.onSubMenuPositioned,contextMenuRef:this.contextMenuRef,onPositioningEnd:this.onFloatieRefCreatedAndPositioned})));return e?s:R.createElement(hm.a,{appColors:this.props.floatieProps.appColors},s)}addListeners(){if(!this.hasListeners&&this.fullyPositioned()){if(!this.props.floatieProps.preventAutoDismiss){const e=this.getWindow();e.document.body.addEventListener("pointerdown",this.onPointerDown,!0),e.document.body.addEventListener("wheel",this.onMouseWheel,!0),e.document.body.addEventListener("focus",this.onFocus,!0),e.document.body.addEventListener("pointermove",this.onPointerMove,!0),e.document.body.addEventListener("keydown",this.onKeyDown,!0),Object(hP.t)("ContextualUI",this.onBoundingWindowRectChanged)}this.hasListeners=!0}}removeListeners(){if(this.hasListeners){const e=this.getWindow();e.document.body.removeEventListener("pointerdown",this.onPointerDown,!0),e.document.body.removeEventListener("wheel",this.onMouseWheel,!0),e.document.body.removeEventListener("focus",this.onFocus,!0),e.document.body.removeEventListener("pointermove",this.onPointerMove,!0),e.document.body.removeEventListener("keydown",this.onKeyDown,!0),Object(hP.w)("ContextualUI"),this.hasListeners=!1}}dismissContextualUI(e){var t,n;this.props.floatieProps.hidden||this.props.contextMenuProps.hidden||null===(t=(n=this.context).isExperimentalFeatureEnabled)||void 0===t||!t.call(n,"SharedOnline.ChangeGate.ContextMenuPerfFix")?(!this.props.floatieProps.hidden&&this.props.onFloatieDismiss(e),!this.props.contextMenuProps.hidden&&this.onContextMenuDismiss(e)):this.onContextMenuDismiss(e,!0)}startSessionLog(){this.usageData={sessionId:this.sessionId,menuId:this.props.contextMenuProps.id,menuVisualization:UD(this.props),sessionStart:this.getWindow().performance.now(),sessionDuration:0,visibleSessionStart:0,visibleSessionDuration:0,executedCommands:[],offeredCommands:[],offeredFloatieCommands:[],menuTargetType:"",visualizationAtClose:Jc.a.StandardContextMenu,invocationMethod:this.props.contextMenuProps.inputMethod,menuShown:!this.props.contextMenuProps.hidden,floatieShown:!this.props.floatieProps.hidden,floatieFadedAway:!1,clickedAway:!1}}getMenuTargetType(){var e,t,n,o;return null!==(e=null!==(t=null===(n=this.props.contextMenuProps.menuDefinition)||void 0===n?void 0:n.menuTargetType)&&void 0!==t?t:null===(o=this.props.contextMenuProps.searchableContextualMenuProps)||void 0===o||null===(o=o.menuDefinition)||void 0===o?void 0:o.menuTargetType)&&void 0!==e?e:"Unknown"}completeSessionLog(){var e,t,n,o;this.props.onInteractionCompleted&&this.usageData&&(this.usageData.sessionDuration=this.getWindow().performance.now()-this.usageData.sessionStart,this.usageData.visibleSessionDuration=this.getWindow().performance.now()-this.usageData.visibleSessionStart,this.usageData.visualizationAtClose=VD(null===(e=this.props.contextMenuProps.searchableContextualMenuProps)||void 0===e?void 0:e.menuDefinition),this.usageData.menuTargetType=null!==(t=this.props.menuTargetType)&&void 0!==t?t:this.getMenuTargetType(),this.usageData.floatieShown&&(this.usageData.offeredFloatieCommands=null!=(o=this.props.floatieProps)&&o.groups?o.groups.map(e=>({commandIds:JD(e),location:Jc.a.Floatie})):[]),this.usageData.menuShown&&(this.usageData.offeredCommands=GD(this.props.contextMenuProps,this.usageData.visualizationAtClose)),this.usageData.zeroTermMenuEnabled=null===(n=this.props.contextMenuProps.searchableContextualMenuProps)||void 0===n?void 0:n.zeroTermMenuEnabled,this.props.onInteractionCompleted(this.usageData)),this.sessionId=this.sessionId+1,this.usageData=void 0}elementIsWithinContextualUI(e){return void 0!==e&&(this.contextualUIWrapper.current===e||Object(Ki.a)(this.contextualUIWrapper.current,e))}elementIsWithinFloatie(e){const t=this.getWindow().document.getElementById(BP.c);return void 0!==e&&(this.contextualUIWrapper.current===e.target||Object(Ki.a)(this.contextualUIWrapper.current,e.target))||this.pointIsWithinFloatie(t,e)}pointIsWithinFloatie(e,t){if(!e||!t)return!1;const n=e.getBoundingClientRect();return t.clientX>n.x&&t.clientX<n.x+n.width&&t.clientY>n.y&&t.clientY<n.y+n.height}shouldRenderContextMenu(e){var t,n;return e&&null!==(t=(n=this.context).isExperimentalFeatureEnabled)&&void 0!==t&&t.call(n,"IDBasedContextMenusIsEnabled")?!this.props.contextMenuProps.hidden&&e===this.props.contextMenuProps.id:!this.props.contextMenuProps.hidden}shouldRenderFloatie(){return!this.props.floatieProps.hidden&&(this.props.contextMenuProps.hidden||this.state.contextMenuPositioned)}shouldPositionContextMenuHidden(){const e=Object(Zf.a)(this.context,Zf.f.fluentV9ContextMenuIsEnabled),t=Object(Zf.a)(this.context,Zf.f.fluentV9FloatieIsEnabled),n=Object(Zf.a)(this.context,Zf.f.renderV9MenuAndFloatieTogetherEnabled);return e&&t&&n?!this.props.floatieProps.hidden&&!this.state.contextMenuPositioned:this.props.positionInOneFrameIsEnabled?!(!this.props.contextMenuProps.attachedFloatie||this.state.fullyPositioned):!this.props.floatieProps.hidden&&!this.state.floatiePositioned}shouldPositionFloatieHidden(){return this.props.positionInOneFrameIsEnabled?!(!this.props.floatieProps.attachedContextMenu||this.state.fullyPositioned):!this.props.contextMenuProps.hidden&&!this.state.floatiePositioned}shouldDismissContextualUIOnFocusLost(){const e=Object(Zf.a)(this.context,Zf.f.fluentV9ContextMenuIsEnabled),t=Object(Zf.a)(this.context,Zf.f.fluentV9FloatieIsEnabled);return!(e&&(t&&this.props.floatieProps.attachedContextMenu||!this.props.floatieProps.attachedContextMenu)||this.props.contextMenuProps.hidden)}shouldDismissContextualUIOnScroll(){return!this.props.floatieProps.hidden&&this.props.contextMenuProps.hidden}shouldDismissFloatieOnPointerMove(){return!this.props.floatieProps.hidden&&this.props.contextMenuProps.hidden}isContextualUIVisible(){return this.isContextualUIVisibleFromProps(this.props)}isContextualUIVisibleFromProps(e){return!(e.contextMenuProps.hidden&&e.floatieProps.hidden)}getContextMenuSelector(){return"div#"+this.props.contextMenuProps.id}shouldRenderFloatieV2(){return!this.props.floatieProps.hidden}onShow(){this.startSessionLog()}onHide(){this.completeSessionLog()}getWindow(){var e,t,n;return(null===(e=(t=this.context).isExperimentalFeatureEnabled)||void 0===e?void 0:e.call(t,Zf.f.multiWindowSupportIsEnabled))&&null!==(n=this.context.appWindow)&&void 0!==n?n:window}shouldFallbackToLegacyMenu(){return!(!Object(Zf.a)(this.context,Zf.f.fluentV9FloatieIsEnabled)||!this.props.floatieProps.attachedContextMenu)&&this.props.floatieProps.groups.some(e=>"SingleRowMultiSectionFloatieGroup"!==e.type)}constructor(e){super(e),this.contextualUIWrapper=R.createRef(),this.contextMenuIds=[],this.contextMenuRef=R.createRef(),this.fullyPositioned=()=>{const e=!(this.shouldRenderFloatie()&&!this.state.floatiePositioned),t=!(this.shouldRenderContextMenu()&&!this.state.contextMenuPositioned);return this.props.positionInOneFrameIsEnabled?this.state.fullyPositioned:t&&e},this.onPointerDown=e=>{var t,n,o,r;this.elementIsWithinContextualUI(null==e?void 0:e.target)||(this.usageData&&(this.usageData.clickedAway=!0),this.dismissContextualUI(e),null===(t=(n=this.context).isExperimentalFeatureEnabled)||void 0===t||!t.call(n,"SharedOnline.ChangeGate.PreventDefaultOnDimissContextualUI")||null!==(o=(r=this.context).isExperimentalFeatureEnabled)&&void 0!==o&&o.call(r,"SharedOnline.ChangeGate.PreventDefaultOnDismissContextualUIOnlyAndNotFloatie")&&!this.isContextualUIVisible()||null==e||e.preventDefault())},this.onFocus=e=>{var t,n;const o=!this.elementIsWithinContextualUI(null==e?void 0:e.target),r=!(null===(t=(n=this.context).isExperimentalFeatureEnabled)||void 0===t?void 0:t.call(n,"SharedOnline.ChangeGate.GenericContextMenusIsEnabled"))||this.elementIsWithinContextualUI(null==e?void 0:e.relatedTarget);this.shouldDismissContextualUIOnFocusLost()&&o&&r&&this.dismissContextualUI(e)},this.onMouseWheel=e=>{this.shouldDismissContextualUIOnScroll()&&!this.elementIsWithinContextualUI(null==e?void 0:e.target)&&this.dismissContextualUI(e)},this.onPointerMove=e=>{!this.shouldDismissFloatieOnPointerMove()||this.elementIsWithinFloatie(e)||this.state.floatieMenuOpened||"touch"!==(null==e?void 0:e.pointerType)||this.dismissContextualUI(e)},this.onKeyDown=e=>{e&&e.keyCode===xe.a.escape&&this.props.contextMenuProps.hidden&&!this.props.floatieProps.hidden&&!this.state.floatieMenuOpened&&this.dismissContextualUI(e)},this.onBoundingWindowRectChanged=()=>{this.dismissContextualUI()},this.onContextMenuDismiss=(e,t)=>{this.props.onContextMenuDismiss(e,t,this.props.contextMenuProps.id,this.props.contextMenuProps.attachedFloatie)},this.onContextualItemExecute=(e,t,n)=>{if(this.props.onItemExecute&&this.props.onItemExecute(e,t,n),this.usageData){var o;const r=GD(this.props.contextMenuProps,t),i=t===Jc.a.Floatie||(null===(o=this.usageData.openedSubMenu)||void 0===o?void 0:o.commandId)===n?n:void 0,a=r.filter(t=>t.commandId===(i||e));if(t!==Jc.a.Floatie&&a&&a.length>0){const t=a[0];this.usageData.executedCommands.push(_object_spread_props(_object_spread({},t),{commandId:e,parentId:i}))}else this.usageData.executedCommands.push({commandId:e,location:t,parentId:i})}},this.onSearchBoxFocused=()=>{this.usageData&&0===this.usageData.visibleSessionStart&&(this.usageData.visibleSessionStart=this.getWindow().performance.now())},this.onSubMenuPositioned=(e,t)=>{this.usageData&&(this.usageData.openedSubMenu={commandId:e,location:t})},this.onContextMenuPositioned=e=>{if(this.props.contextMenuProps.attachedFloatie&&!this.state.contextMenuPositioned){const{targetEdge:t,alignmentEdge:n}=e;this.setState({floatieLayoutFromState:{directionalHint:LP(t,n),target:this.getContextMenuSelector(),gapSpace:BP.b},contextMenuPositioned:!0})}else this.state.contextMenuPositioned||this.setState({contextMenuPositioned:!0})},this.onContextMenuRefCreatedAndPositioned=()=>{var e,t;(null!==(e=(t=this.context).isExperimentalFeatureEnabled)&&void 0!==e&&e.call(t,Zf.f.isConditionForV9StandaloneCMEnabled)||this.props.contextMenuProps.attachedFloatie)&&!this.state.contextMenuPositioned&&this.setState({contextMenuPositioned:!0})},this.onFloatiePositioned=e=>{if(this.props.floatieProps.attachedContextMenu&&!this.state.floatiePositioned){const{targetEdge:t,alignmentEdge:n}=e,o=this.getWindow().document.getElementById(BP.c),{target:r,directionalHint:i}=function(e,t,n){const{left:o,right:r,top:i,bottom:a}=e.getBoundingClientRect();return t===mc.b.top&&n===mc.b.left||t===mc.b.right&&n===mc.b.bottom?{directionalHint:Se.a.topLeftEdge,target:{left:o,top:a}}:t===mc.b.bottom&&n===mc.b.right||t===mc.b.left&&n===mc.b.top?{directionalHint:Se.a.bottomRightEdge,target:{left:r,top:i}}:t===mc.b.bottom&&n===mc.b.left||t===mc.b.right&&n===mc.b.top?{directionalHint:Se.a.bottomLeftEdge,target:{left:o,top:i}}:t===mc.b.top&&n===mc.b.right||t===mc.b.left&&n===mc.b.bottom?{directionalHint:Se.a.topRightEdge,target:{left:r,top:a}}:{directionalHint:Se.a.topLeftEdge,target:{left:o,top:a}}}(o,t,n);this.setState({floatieLayoutFromState:{directionalHint:i,target:r,gapSpace:0},floatiePositioned:!0})}else this.state.floatiePositioned||this.setState({floatiePositioned:!0})},this.onFloatieRefCreatedAndPositioned=()=>{this.state.floatiePositioned||this.setState({floatiePositioned:!0})},this.onFloatieFadedAway=()=>{this.usageData&&(this.usageData.floatieFadedAway=!0)},this.onFloatieMenuToggled=e=>{this.setState({floatieMenuOpened:e})},this.state={contextMenuPositioned:!1,floatiePositioned:!1,floatieMenuOpened:!1,fullyPositioned:!1},this.hasListeners=!1,this.sessionId=0}}AP.contextType=Hm.a;var NP=n(2109),WP=n(2429);const zP=(e,t)=>{if(Object($c.h)("ContextMenuSearchIsEnabled")&&HP(t))return{menuDefinition:BD(e),zeroTermMenuEnabled:jD(e),initialView:OD(e),onSearchStateChanged:(e,t)=>{Object(pP.n)()(t,Jc.b.ContextMenu)},onShowZeroTermMenu:()=>{Object(wc.a)(Object(cP.a)("ZeroTermContextMenu",!1))},onHideZeroTermMenu:()=>{Object(wc.a)(Object(cP.a)("ZeroTermContextMenu",!0))},onAfterMenuOpen:Object(pP.g)(Jc.b.ContextMenu,"TellMe",Jc.b.ContextMenu),openSearchPane:Object(pP.i)(Jc.b.ContextMenu)}},HP=e=>{switch(e){case"ContextMenu":case"GridContextMenu":return!0}return!1},VP=e=>e===hC.a.Touch||e===hC.a.Pen,UP=e=>{Object(Qd.isChangeGateEnabled)("DisableContextualUIUsageDataActivityLogging")||Object(Rv.logActivity)("ContextualUIUsageData",!0,e.sessionDuration,(e=>{var t;return[{name:"MenuId",string:e.menuId},{name:"MenuVisualization",string:JSON.stringify(e.menuVisualization)},{name:"OpenedSubMenu",string:JSON.stringify(e.openedSubMenu)},{name:"OfferedCommands",string:JSON.stringify(e.offeredCommands)},{name:"OfferedFloatieCommands",string:JSON.stringify(e.offeredFloatieCommands)},{name:"ExecutedCommands",string:JSON.stringify(e.executedCommands)},{name:"SessionDuration",double:e.visibleSessionDuration},{name:"SessionId",int64:e.sessionId},{name:"MenuTargetType",string:e.menuTargetType},{name:"VisualizationAtClose",string:e.visualizationAtClose},{name:"InvocationMethod",string:hC.a[e.invocationMethod||hC.a.Unknown]},{name:"TellMeCorrelationId",string:Object(NP.a)()},{name:"AcmCorrelationId",string:Object(WP.a)("ACM")},{name:"ZeroTermMenuEnabled",bool:e.zeroTermMenuEnabled},{name:"CtxUiAbandoned",bool:0===(null===(t=e.executedCommands)||void 0===t?void 0:t.length)},{name:"FloatieFadedAway",bool:e.floatieFadedAway},{name:"ClickedAway",bool:e.clickedAway},{name:"Version",int64:4}]})(e)),(e=>{const t=e.zeroTermMenuEnabled,n=e.visualizationAtClose,o=t?[Object(uP.a)("ContextMenu",!1),Object(cP.a)("ZeroTermContextMenu",!0),Object(dP.a)("ZeroTermContextMenu",[])]:[];Object(NP.a)()?Object(pP.f)(Jc.b.ContextMenu,"TellMe")(o,Jc.b.ContextMenu):t&&Object(wc.a)(o),Object(WP.b)("ACM",""),t&&n===Jc.a.ZeroTermMenu&&Object(WD.d)(e)})(e)},GP=(e,t,n)=>{t===Jc.a.SearchResult&&Object(pP.m)(e,n,Jc.b.ContextMenu)},qP={areStatePropsEqual:(e,t)=>{const n=e.floatieProps.hidden!==t.floatieProps.hidden||!e.floatieProps.hidden,o=e.contextMenuProps.hidden!==t.contextMenuProps.hidden||!e.contextMenuProps.hidden,r=e.contextMenusToShadowRender,i=t.contextMenusToShadowRender;return!n&&!o&&!((e,t)=>{let n=0,o=0;return t&&t.forEach(e=>{void 0===e&&(o+=1)}),e&&e.forEach(e=>{void 0===e&&(n+=1)}),o!==n})(r,i)},areStatesEqual:(e,t)=>{var n;return!(null===(n=Object(Pc.c)("ContextualUI"))||void 0===n||!n(e,t))||!ID(e)&&!ID(t)&&!Object(RD.e)(e)&&!Object(RD.e)(t)}},QP=Object(Ic.connect)((e,t)=>{const n=Object(RD.c)(e),o=(e=>e.contextualUILayoutModel.contextMenuLayout)(e),r=PD(e),i=(e=>e.contextualUILayoutModel.inputMethod)(e),a=(e=>e.contextualUILayoutModel.menuTargetType)(e),s=Object(lP.b)()(e),l=((e,t)=>!(!e||e.attachedContextMenu||0===t.length)&&t.some(e=>("SingleControlFloatieGroup"===e.type||"SingleRowFloatieGroup"===e.type)&&e.preventAutoDismiss))(n,s);return{floatieProps:_object_spread_props(_object_spread({},n),{hidden:!Object(RD.e)(e),groups:s,appIcons:t.appIcons,appStrings:t.appStrings,appColors:t.appColors,preventLightDismiss:l||VP(i),preventAutoDismiss:l}),contextMenuProps:_object_spread_props(_object_spread({},o),{hidden:!ID(e),id:Object($c.h)("IDBasedContextMenusIsEnabled")?null!=r?r:DD.a.ContextMenu:t.contextMenuId,menuDefinition:FD(e),appIcons:t.appIcons,appStrings:t.appStrings,appColors:t.appColors,inputMethod:i,searchableContextualMenuProps:zP(e,r)}),contextMenusToShadowRender:MD(e),floatieGroupsToShadowRender:Object($c.h)("FloatieShadowRenderingIsEnabled")?Object(lP.b)(t.floatieGroupsToShadowRender)(e):void 0,menuTargetType:a}},(e,t)=>({onFloatieDismiss:()=>{e(Object(_D.c)())},onContextMenuDismiss:(n,o,r,i)=>{const a=Object(c_.a)("SharedOnline.ChangeGate.ContextMenuPerfFix");o||((e,t)=>{const n=document.getElementById(e),o=t;return void 0!==o&&"Escape"===o.key&&(n===o.target||Object(Ki.a)(n,o.target))})(t.containerId,n)&&i?a?e(Object(qv.batchActions)([Object(_D.c)(),Object(_D.b)()])):(e(Object(_D.c)()),e(Object(_D.b)())):e(Object(_D.b)());const s=()=>{Object(WD.b)(null!=r?r:t.contextMenuId,"FlyoutAnchorModel")()};a?Object(sP.a)(s):s()}}),(e,t,n)=>{const o=_object_spread_props(_object_spread({},n),{onInteractionCompleted:UP,onItemExecute:e.contextMenuProps.searchableContextualMenuProps?GP:void 0});return _object_spread({},o,e,t)},qP)(AP),KP=e=>R.createElement(Kv.a,null,R.createElement(QP,_object_spread({},e)));class JP extends R.PureComponent{render(){const e=tR.a;return R.createElement(nR.a,null,R.createElement(Ic.Provider,{store:Zv.a},R.createElement(e,null,R.createElement(KP,{appStrings:Object(f.a)(),appIcons:Po.a,appColors:Object(b.a)(),contextMenuId:"ContextMenuContainer",contextMenuCommandId:DD.a.ContextMenu,containerId:this.props.containerId,positionInOneFrameIsEnabled:Object($c.h)("positionInOneFrameIsEnabled"),useSmallScreenLayout:Object($c.h)("SmallScreenContextualUIIsEnabled")&&Object(de.h)(),populateMenuCallback:$D,floatieGroupsToShadowRender:Object($c.h)("FloatieShadowRenderingIsEnabled")?aP.b:void 0}))))}}const YP=Object(RD.d)(Zv.a);var ZP=n(576);const $P={initializeContextualUI:function(e){let t=[Object(ZP.a)(Object(aP.d)()),Object(_D.a)(Object(aP.e)()),Object(_D.f)(DD.a.ContextMenu)];var n,o;Object($c.h)("ContextMenuShadowRenderingIsEnabled")&&(t=t.concat([Object(_D.g)(aP.f)])),n=t,o=cC.a,jy.b.register("floatieGroupModels",CD),jy.b.register("activeFloatieGroups",vD),Object(RD.f)(),jy.b.register("contextMenuModel",kD),jy.b.register("contextualUILayoutModel",TD),o(n),k.render(R.createElement(JP,{containerId:e.id}),e)},showContextMenu:function(e,t,n,o,r,i){const a=window.performance.now();if(!ID(Zv.a.getState()))return(s,l)=>{var c;if(ID(l()))return;n&&s(Object(_D.f)(n));const u=iP(e.target)?{left:e.target.x,top:e.target.y}:e.target;Object(ND.b)("ShowReactContextMenu",()=>{const e=QD(FD(l())).toString(),t=e===YD;return YD=e,t},null!=n?n:PD(l()),void 0,null!==(c=null==i?void 0:i.sharedApiStartTime)&&void 0!==c?c:a),eP(t,n),tP(s,{contextMenuLayout:_object_spread_props(_object_spread({},e),{target:u}),inputMethod:t,useSmallScreenlayout:o,menuTargetType:r})}},showContextualUI:function(e,t,n,o,r,i,a){const s=window.performance.now();if(!Object(RD.e)(Zv.a.getState())||!ID(Zv.a.getState()))return(l,c)=>{var u;if(Object(RD.e)(c())&&ID(c()))return;r&&l(Object(_D.f)(r)),Object(ND.b)("ShowReactContextualUI",()=>{const e=Object(RD.a)(c()).toString(),t=e===ZD;ZD=e;const n=QD(FD(c())).toString(),o=n===YD;return YD=n,t&&o},null!=r?r:PD(c()),void 0,null!==(u=null==a?void 0:a.sharedApiStartTime)&&void 0!==u?u:s),Object($c.h)("ContextualUIDetailedTelemetryIsEnabled")?XD(n,r):eP(n,r);const d=iP(e.target)?{left:e.target.x,top:e.target.y}:e.target,p=iP(t.target)?{left:t.target.x,top:t.target.y}:t.target;nP(l,{floatieLayout:_object_spread_props(_object_spread({},e),{target:d,attachedContextMenu:!0}),contextMenuLayout:_object_spread_props(_object_spread({},t),{target:p,attachedFloatie:!0}),inputMethod:n,useSmallScreenlayout:o,menuTargetType:i})}},showFloatie:function(e,t,n,o,r){const i=window.performance.now();if(!Object(RD.e)(Zv.a.getState()))return(a,s)=>{var l,c;if(Object(RD.e)(s()))return;const u=iP(e.target)?{left:e.target.x,top:e.target.y}:e.target,d=Object(RD.a)(s()),p=null===(l=Object(RD.b)(s())[d[0]])||void 0===l?void 0:l.type;Object(ND.b)("ShowReactFloatie",()=>{const e=d.toString(),t=e===ZD;return ZD=e,t},t===hC.a.Touch?"TouchFloatie-"+p:"NonTouchFloatie-"+p,r,null!==(c=null==r?void 0:r.sharedApiStartTime)&&void 0!==c?c:i),oP(a,{floatieLayout:_object_spread_props(_object_spread({},e),{target:u}),inputMethod:t,useSmallScreenlayout:n,menuTargetType:o})}},hideContextMenu:function(){if(ID(Zv.a.getState()))return(e,t)=>{ID(t())&&e(Object(_D.b)())}},hideContextualUI:function(){if(Object(RD.e)(Zv.a.getState())||ID(Zv.a.getState()))return(e,t)=>{(Object(RD.e)(t())||ID(t()))&&e(Object(qv.batchActions)([Object(_D.c)(),Object(_D.b)()]))}},hideFloatie:function(){if(Object(RD.e)(Zv.a.getState()))return(e,t)=>{Object(RD.e)(t())&&e(Object(_D.c)())}},selectors:YP,getBlockedSmallScreenFloatieGroupList:aP.c,repositionContextualUI:function(e){return t=>{const n=iP(e)?{left:e.x,top:e.y}:e;rP(t,n)}}};var XP=n(200);const eI=Object(ut.a)({root:_object_spread({backgroundColor:"transparent"},pt.a.padding("0","8px"))}),tI=e=>{const t=Object(c_.a)(Zf.f.globalThemePaddingFix),n=(()=>{const e=eI();return Object(XP.a)()?{fluentProviderProps:{className:e.root},themeProviderProps:{style:{background:"transparent"}}}:{}})();if(t){const t=n.fluentProviderProps,o=n.themeProviderProps;return R.createElement(iv.a,null,t&&o?R.createElement("div",{className:Object(Rt.a)(t.className,o.className)},e.children):e.children)}return R.createElement(iv.a,_object_spread({},n),e.children)};var nI=n(2571);const oI={},rI=e=>e.messageBar||oI,iI=Object(Rc.a)([rI],e=>e.dismissIconProps),aI=Object(Rc.a)([rI],e=>e.typeIconsProps),sI=Object(Ic.connect)((e,t)=>{Object(Rx.j)("AppMessageBar");let n=void 0;const o=aI(e);o&&(n=o[t.messageBarType||zp.a.info]),t.messageBarIconProps&&(n=t.messageBarIconProps);const r={dismissIconProps:t.closeable?iI(e):void 0,messageBarIconProps:n,id:"AppMessageBar"};return Object(Rx.j)("AppMessageBar","NonCached"),r},void 0,void 0,{areStatesEqual:Object(Pc.c)("MessageBar")})(Object(Dc.a)(nI.a)),lI=e=>R.createElement(Kv.a,null,R.createElement(sI,_object_spread({},e)));class cI extends R.Component{render(){return R.createElement(nR.a,null,R.createElement(Ic.Provider,{store:Zv.a},R.createElement(tI,null,R.createElement(lI,_object_spread({},this.props)))))}}function uI(e=oI,t){if(null===e)return oI;switch(t.type){case My.Db:{const{typeIconsProps:n}=t.payload;return n?_object_spread_props(_object_spread({},e),{typeIconsProps:n}):e}case My.Cb:{const{dismissIconProps:n}=t.payload;return n?_object_spread_props(_object_spread({},e),{dismissIconProps:n}):e}default:return e}}var dI=n(27);let pI=!1;const gI={initializeMessageBarInStore:function(){var e,t;pI||(jy.b.register("messageBar",uI),Object(cC.a)([(t={iconName:c.a.CancelGlyph_16},Object(dI.a)(My.Cb,{dismissIconProps:t})),(e={[zp.a.info]:{iconName:d.a.AlertInfoLight_16},[zp.a.success]:{iconName:d.a.AlertSuccess_16},[zp.a.warning]:{iconName:d.a.AlertInfoLight_16},[zp.a.severeWarning]:{iconName:d.a.AlertSevereWarning_16},[zp.a.error]:{iconName:d.a.AlertError_16},[zp.a.blocked]:{iconName:d.a.DrmStatus_16}},Object(dI.a)(My.Db,{typeIconsProps:e}))]),i.a.sendTraceTag(587321818,a.a.msoulscat_ES_EWAJS,s.a.Info,"MessageBar store is initialized."),pI=!0)},createNewMessageBar:function(e,t){k.render(R.createElement(cI,_object_spread({},t)),e)},createNewMessageBarWithCallback:function(e,t,n){k.render(R.createElement(cI,_object_spread({},t)),e,n)}};var hI=n(2621),mI=n(1570);const bI={renderLiveMeetingBoundary:hI.a,renderLiveMeetingPill:mI.b};var fI=n(523);const xI={root:{backgroundColor:"#ffffff"},list:{fontSize:"12px"}},EI=e=>({root:{backgroundColor:e?fI.a.selectedBackgroundColor:"#ffffff",selectors:{":focus":{background:fI.a.hoverBackgroundColor+"!important"}}}});var SI=n(816);const yI=[];class CI extends R.Component{render(){return R.createElement(Ee.a,{content:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.TableTotalRowOptionsKeyTip),id:"TotalRowDropDownId",tooltipProps:{style:{overflowY:"auto",display:"block"},calloutProps:{isBeakVisible:!0,beakWidth:10},directionalHint:Se.a.topCenter,delay:SI.a.long}},R.createElement(is.a,{"data-is-focusable":!0,id:"TableTotalRowDropDownIconButtonId",allowDisabledFocus:!1,ariaLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.TableTotalRowOptionsLabel),ariaDescription:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.TableTotalRowOptionsAriaDescription),tabIndex:0,styles:(e=this.state.currentButtonSize,{root:{position:"absolute",top:"0px",left:"0px",padding:"unset",height:e,width:e},flexContainer:{position:"absolute",top:"0px",left:"0px",height:e,width:e},icon:{display:"flex",position:"absolute",top:"0px",left:"0px",margin:"unset",height:e,width:e}}),iconProps:{iconName:be.a.DropdownArrowHover_16},menuTriggerKeyCode:xe.a.alt&xe.a.down,persistMenu:!0,primary:!0,menuProps:{gapSpace:0,focusZoneProps:{allowFocusRoot:!1,isCircularNavigation:!0,doNotAllowFocusEventToPropagate:!1,tabIndex:0,allowTabKey:!0},shouldFocusOnContainer:!1,shouldFocusOnMount:!0,styles:xI,onItemClick:this.tableTotalRowOptionSelected,items:this.state.currentMenuItems}}));var e}static getDerivedStateFromProps(e,t){const n=[];let o;return o=e.buttonSize!==t.currentButtonSize?e.buttonSize:t.currentButtonSize,e.selectedItem!==t.previouslySelectedItem?(yI.forEach((function(t){const o=t;o.text===e.selectedItem?o.itemProps={styles:EI(!0)}:o.itemProps={styles:EI(!1)},n.push(o)})),{currentMenuItems:n,currentButtonSize:o,previouslySelectedItem:e.selectedItem}):{currentMenuItems:yI,currentButtonSize:o}}constructor(e){super(e),this.tableTotalRowOptionSelected=(e,t)=>!!t&&(e&&i.a.sendTraceTag(595636250,a.a.msoulscat_ES_EWAJS,s.a.Verbose,"TableTotalRowOptions.tableTotalRowOptionSelected - Event : "+e.type),this.props.tableTotalRowOptionSelected(t.key));const t=Object.keys(this.props.totalRowOptions);yI.splice(0,yI.length);for(const e of t){const t=this.props.totalRowOptions[e],n={key:e,ariaLabel:t,text:t,itemProps:{styles:EI(!1)}};yI.push(n)}this.state={previouslySelectedItem:"None",currentMenuItems:yI,currentButtonSize:17}}}function vI(e,t,n,o,r){k.render(R.createElement(CI,{totalRowOptions:t,selectedItem:n,buttonSize:o,tableTotalRowOptionSelected:r}),e)}const RI={root:{backgroundColor:ac.a.gray150,color:ac.a.gray40},subComponentStyles:{menuItem:{root:{color:ac.a.gray40,":active":{backgroundColor:ac.a.gray120+" !important",color:ac.a.gray20},":hover, :focus:hover, .ms-Fabric--isFocusVisible &:hover":{backgroundColor:ac.a.gray140,color:ac.a.gray20},".ms-Fabric--isFocusVisible &:focus, .ms-Fabric--isFocusVisible &:focus:hover":{backgroundColor:ac.a.gray150,color:ac.a.gray20}}}}},kI=({target:e,menuItems:t,toggleStateId:n,onShow:o,onHide:r,onRenderComplete:i,isPresentModeOn:a})=>{const[s,l]=R.useState(!1),[c,u]=R.useState(0);R.useLayoutEffect(()=>{n===c&&s&&null!=i&&Object(sP.a)(i)});const d=()=>{l(!1),r()};n!==c&&(s?d():(l(!0),o()),u(n));const p=Object(WD.b)(oc.b.AllSheetsMenu,"FlyoutAnchorModel");return R.createElement("div",null,R.createElement(Mr.a,{items:t,hidden:!s,target:e,onDismiss:d,onMenuOpened:()=>Object(WD.c)(oc.b.AllSheetsMenu,"FlyoutAnchorModel")({id:oc.b.AllSheetsMenu}),onMenuDismissed:p,isBeakVisible:!1,shouldFocusOnMount:!0,styles:a?RI:{},calloutProps:{calloutMaxHeight:400,styles:{root:{animation:"none"}}}}))};function TI(e,t,n,o,r,i,a,s){k.render(R.createElement(kI,{menuItems:n,target:t,toggleStateId:o,onShow:r,onHide:i,onRenderComplete:a,isPresentModeOn:s}),e)}const _I='"Segoe UI", "Segoe UI Web", Arial, Verdana, sans-serif',wI={root:[{position:"relative",height:"22px",width:"69px",marginTop:"4px"}],fieldGroup:[{border:"1px solid #C8C6C4",height:"26px",width:"110px"}],wrapper:[{fontFamily:_I,color:"#484644",lineHeight:"20px"}]},DI=e=>({root:[{position:"relative",margin:"4px 8px 4px 4px",border:"1px solid rgba(0,0,0,0)",padding:"0px",height:"26px",background:"#107C41",alignSelf:"flex-start",selectors:{":active":{backgroundColor:""+e.palette.themeDarkAlt},":hover":{backgroundColor:""+e.palette.themeDarkAlt},":focus::after":{border:"1px solid white !important",outline:"2px solid "+e.palette.themeDarkAlt,outlineOffset:"1px",borderRadius:"2px"},[F.m]:{color:"HighlightText",backgroundColor:"Highlight",":focus::after":{outline:"none",border:"none"}}}}],textContainer:[{fontWeight:"normal",color:"#FFFFFF",selectors:{[F.m]:{color:"inherit"}}}]}),PI=e=>({root:[{position:"relative",margin:"4px 8px 4px 4px",border:"1px solid rgba(0,0,0,0)",padding:"0px",height:"26px",background:"#F3F2F1",alignSelf:"flex-start",selectors:{":active":{backgroundColor:""+e.palette.neutralLighter},":hover":{backgroundColor:""+e.palette.neutralLighter},":focus::after":{border:`1px solid ${e.palette.neutralTertiaryAlt} !important`,outline:"2px solid "+e.palette.neutralSecondaryAlt,outlineOffset:"1px",borderRadius:"2px"},[F.m]:{":focus::after":{outline:"none",border:"none"}}}}],textContainer:[{fontWeight:"normal",color:"#323130",selectors:{[F.m]:{color:"inherit"}}}]}),II={root:[{paddingLeft:"0px",marginLeft:"0px",fontSize:"13px"}]},FI={root:[{boxShadow:"0px 3.2px 7.2px rgba(0, 0, 0, 0.13), 0px 0.6px 1.8px rgba(0, 0, 0, 0.1)",backgroundColor:"#FFFFFF"}]},BI={root:[{paddingLeft:"0px",marginLeft:"0px",marginBottom:"11px"}]},MI={root:[{position:"relative",minWidth:"110px",height:"32px",float:"right",top:"0px",bottom:"0px",border:"0px",boxSizing:"border-box",marginTop:"4px",padding:"6px 36px",background:"#107C41",alignSelf:"center",cursor:"pointer",selectors:{":active":{backgroundColor:"#0F703B"},":hover":{backgroundColor:"#0F703B"},[F.m]:{color:"HighlightText",backgroundColor:"Highlight"}}}],textContainer:[{color:"#FFFFFF",fontFamily:_I,textAlign:"center",selectors:{[F.m]:{color:"inherit"}}}],labelDisabled:[{color:"#EDEBE9"}],labelChecked:[{color:"#0C5F32"}]},jI=()=>Object(F.eb)([{marginLeft:"12px",marginTop:"8px",position:"relative",display:"flex",right:"86px",left:"0px",fontFamily:_I,fontSize:"15px",lineHeight:"16px",color:"#22221E",order:0,fontWeight:F.l.semibold}]),OI=e=>Object(F.eb)([{direction:e?"rtl":"ltr",backgroundColor:"#F3F2F1",position:"relative",maxWidth:"312px",width:"312px",maxHeight:"132px",height:"132px",minHeight:"132px",overflow:"auto",border:"1px solid #BEBBB8",boxSizing:"border-box",margin:"6px 0px"}]),LI=e=>Object(F.eb)([{borderRight:e?"solid 1px /* @noflip */":"solid 0px /* @noflip */",borderLeft:e?"solid 0px /* @noflip */":"solid 1px /* @noflip */",borderColor:"#D2D0CE",minWidth:"60px",fontFamily:_I,fontStyle:"normal",fontWeight:"normal",padding:"3px",fontSize:"12px",color:"#252423",flex:"display"}]);class AI extends R.Component{render(){const{previewTableText:e}=this.props,{rowNumbers:t}=this.props,{isGridRtl:n}=this.props;return R.createElement("pre",{className:OI(n),"aria-hidden":"true"},R.createElement("table",{className:Object(F.eb)([{borderCollapse:"separate",borderSpacing:"0px",height:"12px"}])},R.createElement("tbody",null,e.map((e,o)=>R.createElement("tr",{className:Object(F.eb)([{border:"none",height:"12px"}]),key:o},R.createElement("td",{className:Object(F.eb)([{borderBottom:"solid 1px",borderColor:"#D2D0CE",minWidth:"12px",fontFamily:_I,fontStyle:"normal",fontWeight:"normal",padding:"3px",fontSize:"12px",color:"#252423",flex:"display"}])},t[o]),e.map((e,t)=>R.createElement("td",{className:LI(n),key:t},e)))))))}}class NI extends R.Component{render(){return R.createElement("div",{ref:this.calloutWrapperElement},R.createElement(Qi.a,{role:"alertdialog",className:Object(F.eb)([{display:"flex",flexDirection:"column",position:"absolute",padding:"12px 12px 12px 12px",alignItems:"center"}]),styles:FI,target:this.props.anchorElement,isBeakVisible:!1,hidden:!this.state.isVisible,onDismiss:this.calloutDismissed,setInitialFocus:!0,gapSpace:this.calloutGap,directionalHint:Se.a.rightTopEdge},R.createElement(pv.a,{componentRef:this.focusTrapZone,id:"TextToColumnsContextualCalloutFocus",forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,ignoreExternalFocusing:!0,focusPreviouslyFocusedInnerElement:!0,disableFirstFocus:!1},R.createElement(Cd.a,{componentRef:this.focusZoneRef,direction:qo.a.bidirectional,isCircularNavigation:!0,allowTabKey:!0},R.createElement(rs.a,{className:jI(),styles:BI},this.textToColumnsHeading),R.createElement(hm.a,null,R.createElement(is.a,{type:"AppIconButtonProps",iconProps:Object(mi.a)(c.a.CancelGlyph_16),className:Object(F.eb)([{cursor:"pointer",position:"fixed",top:"0px",right:"0px",height:"32px",maxWidth:"32px",border:"none",color:"black",overflow:"hidden",selectors:{":hover":{backgroundColor:"#F3F2F1"}}}]),onClick:this.calloutDismissed,ariaLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.Close),customTooltip:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.Close),id:"Close"})),R.createElement(rs.a,{className:jI(),styles:II},this.chooseDelimiters),this.renderTextToColumnsDelimitersItems(),this.renderPreview(),this.renderPartialDataIndicator(),R.createElement(Ko.a,{type:"AppButtonProps",styles:MI,onExecute:this.onApplyClicked,id:this.applyButtonText,label:this.applyButtonText,key:this.applyButtonText})))))}renderTextToColumnsDelimitersItems(){const e=R.createElement(we.a,null,e=>{const t=this.delimitersArrKey.map((t,n)=>R.createElement(Ko.a,{id:t,fullDescriptionLabel:this.getDelimiterAriaLabel(n),type:"AppButtonProps",styles:this.state.delimiterButtons[t]?DI(e):PI(e),label:this.delimitersArr[n],key:t,onExecute:this.onDelimiterButtonChange}));return t.push(this.renderCustomDelimiterTextBox()),t});return R.createElement("div",{id:this.delimiters,className:Object(F.eb)([{display:"flex",flexDirection:"row",flexWrap:"wrap",position:"static",alignSelf:"flex-start",marginTop:"4px",maxWidth:"312px"}])},e)}renderCustomDelimiterTextBox(){return R.createElement("div",{className:Object(F.eb)([{boxSizing:"border-box",position:"relative",background:"#FFFFFF",fontSize:"4px",bottom:"0px",borderRadius:"2px",flex:"none",alignSelf:"flex-start",marginBottom:"4px"}])},R.createElement(I.a,{className:Object(F.eb)([{position:"absolute",bottom:0,fontSize:"2px",display:"flex"}]),styles:wI,value:this.state.customDelimiter,maxLength:1,onChange:this.customDelimiterChanged,placeholder:this.customDelimiterPlaceHolder,ariaLabel:this.customDelimiterPlaceHolder}))}renderPreview(){var e;return this.preview=this.props.GenerateTextToColumnsPreview(this.state.delimiterButtons,null!==(e=this.state.customDelimiter)&&void 0!==e?e:""),[R.createElement(rs.a,{className:jI(),key:this.previewText,styles:II},this.previewText),R.createElement(AI,{previewTableText:this.preview[this.splitTextKey],rowNumbers:this.preview[this.rowNumbersKey],key:this.previewTableKey,isGridRtl:this.props.isGridRtl})]}renderPartialDataIndicator(){return this.preview[this.partialDataKey]?[R.createElement("div",{className:Object(F.eb)([{height:"16px",left:"25.18px",fontFamily:_I,fontSize:"12px",lineHeight:"14px",color:"#545454",flex:"display",alignSelf:"center",marginTop:"6px",marginLeft:"0px"}]),style:{display:"flex"},key:this.partialDataKey},R.createElement(fe.a,{iconName:be.a.Info_20,className:Object(F.eb)([{position:"relative",height:"16px",marginRight:"2px",maxWidth:"20px",color:"#545454",flex:"none",marginLeft:"0px",filter:"grayscale(100%)"}]),style:{color:"black"}}),this.partialDataText)]:[]}componentWillReceiveProps(e){e.isVisible!==this.state.isVisible&&(this.setState({isVisible:!0}),this.addListeners(),this.focus())}componentDidMount(){this.addListeners(),this.setInitialFocus()}addListeners(){this.hasListeners||(window.document.body.addEventListener("wheel",this.onMouseWheel,{passive:!1}),this.hasListeners=!0)}removeListeners(){this.hasListeners&&(window.document.body.removeEventListener("wheel",this.onMouseWheel),this.hasListeners=!1)}selectAutomaticDelimiter(e){let t=!1;return this.props.automaticDelimiter.forEach(n=>{e===n&&(t=!0)}),t}constructor(e){super(e),this.focusTrapZone=R.createRef(),this.focusZoneRef=R.createRef(),this.delimiters="delimiters",this.textToColumnsHeading=ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.TextToColumns),this.applyButtonText=ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.TextToColumnsApply),this.previewText=ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.TextToColumnsPreview),this.chooseDelimiters=ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.TextToColumnsSelectDelimiters),this.partialDataText=ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.TextToColumnsPartialDataText),this.customDelimiterPlaceHolder=ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.TextToColumnsCustomDelimiterPlaceHolder),this.textToColumnsDelimiterCustom=ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.TextToColumnsDelimiterCustom),this.selectedAriaLabel=ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.TextToColumnsDelimitersSelectedAriaLabel),this.unSelectedAriaLabel=ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.TextToColumnsDelimitersUnSelectedAriaLabel),this.calloutGap=2,this.splitTextKey="splitText",this.partialDataKey="isPartial",this.rowNumbersKey="rowNumbers",this.previewTableKey="previewTableKey",this.delimitersArr=[ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.TextToColumnsDelimiterTab),ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.TextToColumnsDelimiterSemicolon),ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.TextToColumnsDelimiterComma),ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.TextToColumnsDelimiterSpace),this.textToColumnsDelimiterCustom],this.delimitersArrKey=["Tab","Semicolon","Comma","Space","Custom"],this.hasListeners=!1,this.preview={splitText:[[""]],isPartial:!1,rowNumbers:[0]},this.focus=()=>{const e=document.querySelector("button#"+this.delimitersArrKey[0]);this.focusZoneRef.current&&this.focusZoneRef.current.focusElement(e)},this.setInitialFocus=e=>{this.async.requestAnimationFrame(()=>this.focus())},this.calloutDismissed=()=>{this.setState({isVisible:!1}),this.removeListeners(),this.props.OnCalloutDismissHandler()},this.customDelimiterChanged=(e,t)=>{if(this.setState({customDelimiter:t}),null!=(null==t?void 0:t.length)){const e=(null==t?void 0:t.length)>0;this.setState(t=>({delimiterButtons:_object_spread_props(_object_spread({},t.delimiterButtons),{[this.textToColumnsDelimiterCustom]:e})}))}},this.onApplyClicked=()=>{var e;this.setState({isVisible:!1}),this.removeListeners(),this.props.OnCalloutDismissHandler(),this.props.OnApplyTextToColumns(this.state.delimiterButtons,null!==(e=this.state.customDelimiter)&&void 0!==e?e:"")},this.onDelimiterButtonChange=e=>{this.setState(t=>({delimiterButtons:_object_spread_props(_object_spread({},t.delimiterButtons),{[e.id]:!t.delimiterButtons[e.id]})}))},this.onMouseWheel=e=>{void 0!==e&&this.calloutWrapperElement.current&&!Object(Ki.a)(this.calloutWrapperElement.current,e.target)&&e.preventDefault()},this.getDelimiterAriaLabel=e=>{let t="";return"0"===e&&(t=this.textToColumnsHeading+" "+this.chooseDelimiters+" "),t+=this.delimitersArr[e]+" ",t+=this.state.delimiterButtons[this.delimitersArrKey[e]]?this.selectedAriaLabel:this.unSelectedAriaLabel,t},this.async=new Ed.a(this),this.calloutWrapperElement=R.createRef(),this.state={isVisible:!0,customDelimiter:"",delimiterButtons:this.delimitersArrKey.reduce((e,t)=>_object_spread_props(_object_spread({},e),{[t]:this.selectAutomaticDelimiter(t)}),{})},this.onDelimiterButtonChange=this.onDelimiterButtonChange.bind(this),this.getDelimiterAriaLabel=this.getDelimiterAriaLabel.bind(this)}}function WI(e,t,n,o,r,i){k.render(R.createElement(NI,{anchorElement:e,isVisible:!0,OnApplyTextToColumns:t,GenerateTextToColumnsPreview:n,OnCalloutDismissHandler:o,isGridRtl:r,automaticDelimiter:i}),e)}var zI=n(2141);const HI=({target:e,styles:t,onEscape:n,onCardMount:o,children:r,calloutStyles:i})=>{const a=R.useCallback(e=>{e&&o&&(e.focus=()=>Object(Il.c)(e),o(e))},[o]);return R.createElement(os.a,{onKeyDownCapture:e=>{"Escape"===e.key&&n()},isBeakVisible:!1,target:e,focusTrapProps:{isClickableOutsideFocusTrap:!0,disableFirstFocus:!0,forceFocusInsideTrap:!1},directionalHint:Se.a.rightTopEdge,directionalHintForRTL:Se.a.leftTopEdge,gapSpace:5,style:t,styles:i},R.createElement("div",{ref:a},r))},VI=({explanationText:e,onToolTipClose:t,onHyperLinkClick:n,hyperLinkText:o,hyperLinkUrl:r,iconStyles:i})=>{const a=R.useRef(),s=R.createElement(R.Fragment,null,e+" ",R.createElement("a",{href:r,target:"_blank",rel:"noopener noreferrer",onClick:n},o));return R.createElement(Ee.a,{content:s,delay:0,onTooltipToggle:e=>(e=>{if(e)a.current=performance.now();else{const{current:e}=a,n=e?performance.now()-e:0;t(n),a.current=void 0}})(e)},R.createElement(fe.a,{iconName:be.a.Info_16,styles:i}))},UI=Object(Jo.c)(e=>({ShowFormulaButtonStyles:{root:{color:e.palette.themePrimary,height:20,paddingInlineStart:0},label:{margin:0}},bodyContentStyle:{marginBottom:7,minWidth:200,maxWidth:400,overflowWrap:"break-word"}})),GI={root:{paddingLeft:"6px",paddingRight:"6px",width:"16px",height:"16px"}},qI={FormulaSuggestionApply:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaByExampleApply),FormulaSuggestionIgnore:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaByExampleIgnore),FormulaSuggestionTitle:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaByExampleTitle),GiveFeedback:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaByExampleGiveFeedback),FormulaSuggestionBody:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaByExampleBody),FormulaSuggestionCopilotBody:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaByExampleCopilotBody),ShowFormula:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaByExampleShowFormula),HideFormula:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaByExampleHideFormula),RowNumberingTitle:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaByExampleRowNumberingTitle),RowNumberingBody:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaByExampleRowNumberingShortBody),RowNumberingDifferenceExplanation:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaByExampleRowNumberingDifferenceExplanation),ApplyAsFormula:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaByExampleApplyAsFormula),ApplyAsValue:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaByExampleApplyAsValue),LearnMoreText:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaByExampleLearnMore)},QI=({formula:e,range:t,target:n,mainActions:o,onExplicitExit:r,body:i,isCopilotEnabled:a,title:s,onGiveFeedback:l,onShowFormula:c,onCardMount:u,furtherExplanationProps:d})=>{const p=Object(Yx.a)(),g=UI(p),[h,{toggle:m}]=Object(zI.a)(!1);return R.createElement(HI,{target:n,onEscape:r,onCardMount:u},R.createElement(WE,{title:s,mainActions:o,onClose:r,range:t,handleTab:qo.b.all,otherActions:l&&[{text:qI.GiveFeedback,onClick:l,key:"FormulaSuggestionCardGivefeedback"}],aiDisclaimerText:a?ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaByExampleAIDisclaimer):void 0,showCopilotIcon:a},R.createElement(At.a,{style:g.bodyContentStyle,horizontal:!0},R.createElement(rs.a,null,h?e:i),d&&!h?R.createElement(VI,_object_spread({},d)):null),R.createElement(Ue.a,{styles:g.ShowFormulaButtonStyles,onClick:()=>{h||null==c||c(),m()}},h?qI.HideFormula:qI.ShowFormula)))};function KI(e,t){const n=e?qI.FormulaSuggestionCopilotBody:qI.FormulaSuggestionBody;if(t){const o=e?tF.get(t.explanationKey):eF.get(t.explanationKey);if(!o)return i.a.sendTraceTag(507601994,a.a.msoulscat_ES_EWAJS,s.a.Warning,"FormulaByExampleExplanations - No explanation found for key "+t.explanationKey),t.notifyExplanationSuccessful(!1),n;let r=o,l=!0;for(const e of t.replacements)if(r.includes(`{${e.replacementPlaceHolder}}`)){if("Delimiter"===e.replacementPlaceHolder){const t=nF.get(e.replacementValue);t&&(e.replacementValue=t)}r=r.replace(`{${e.replacementPlaceHolder}}`,e.replacementValue)}else i.a.sendTraceTag(507601993,a.a.msoulscat_ES_EWAJS,s.a.Info,`FormulaByExampleExplanations - No replacement in template found for placeholder ${e.replacementPlaceHolder}, key ${t.explanationKey}, genericExplanationTemplate ${o}`);if(XI.some(e=>r.includes(e))&&(i.a.sendTraceTag(507593047,a.a.msoulscat_ES_EWAJS,s.a.Warning,`FormulaByExampleExplanations - Not all placeholders were replaced, key ${t.explanationKey}, genericExplanationTemplate ${o}, replacementKeys: ${t.replacements.map(e=>e.replacementPlaceHolder)}`),l=!1),t.notifyExplanationSuccessful(l),l){i.a.sendTraceTag(507601992,a.a.msoulscat_ES_EWAJS,s.a.Info,"FormulaByExampleExplanations - Generated explanation successfully for key "+t.explanationKey);const e=t.replacements.reduce((e,{replacementPlaceHolder:t,replacementValue:n})=>(e[t]=R.createElement("b",{key:n},n),e),{});return R.createElement(qE.a,{message:o,values:e})}}return n}function JI(e,t,n,o,r,i,a,s,l,c){const u=Object($c.b)("Microsoft.Office.Excel.FormulaByExampleCopilotRollout",!1);k.render(R.createElement(QI,{formula:e,range:t,target:o,mainActions:ZI(r,i),onExplicitExit:i,title:qI.FormulaSuggestionTitle,body:KI(u,c),isCopilotEnabled:u,onGiveFeedback:a,onShowFormula:s,onCardMount:l}),n)}function YI(e,t,n,o,r,i,a,s,l,c,u,d,p){const g=Object($c.b)("Microsoft.Office.Excel.FormulaByExampleCopilotRollout",!1);k.render(R.createElement(QI,{formula:e,range:t,target:o,mainActions:$I(r,i,a),onExplicitExit:s,title:qI.RowNumberingTitle,body:qI.RowNumberingBody,isCopilotEnabled:g,onGiveFeedback:u,onShowFormula:d,onCardMount:p,furtherExplanationProps:{explanationText:qI.RowNumberingDifferenceExplanation,onToolTipClose:l,onHyperLinkClick:c,hyperLinkText:qI.LearnMoreText,hyperLinkUrl:"https://support.microsoft.com/office/automatically-number-rows-76ce49e3-d8d2-459b-bd85-ee1d3973e6e6",iconStyles:GI}}),n)}function ZI(e,t){return[{key:"apply",text:qI.FormulaSuggestionApply,kind:"APPLY",onClick:e,buttonStyleFlavor:"CallToActionPrimary"},{key:"ignore",text:qI.FormulaSuggestionIgnore,kind:"IGNORE",onClick:t,buttonStyleFlavor:"CallToActionDefault"}]}function $I(e,t,n){return[{key:"applyAsFormula",text:qI.FormulaSuggestionApply,kind:"APPLY",onClick:e,buttonStyleFlavor:"CallToActionPrimary"},{key:"applyAsValue",text:qI.ApplyAsValue,kind:"APPLY",onClick:t,buttonStyleFlavor:"CallToActionDefault",disabled:n}]}const XI=["{RightConstant}","{LeftColumnName}","{RightColumnName}","{ColumnNames}","{ColumnName}","{Delta}","{FindText}","{ReplaceText}","{Length}","{LeftPosition}","{RightPosition}","{N}","{Delimiter}"],eF=new Map([["Add/LeftExtractNumber/RightConstant",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationAddLeftExtractNumberRightConstant)],["Add/LeftExtractNumber/RightExtractNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationAddLeftExtractNumberRightExtractNumber)],["Add/LeftExtractNumber/RightParseNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationAddLeftExtractNumberRightParseNumber)],["Add/LeftExtractNumber/RightWholeColumn",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationAddLeftExtractNumberRightWholeColumn)],["Add/LeftParseNumber/RightConstant",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationAddLeftParseNumberRightConstant)],["Add/LeftParseNumber/RightExtractNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationAddLeftParseNumberRightExtractNumber)],["Add/LeftParseNumber/RightParseNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationAddLeftParseNumberRightParseNumber)],["Add/LeftWholeColumn/RightConstant",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationAddLeftWholeColumnRightConstant)],["Add/LeftWholeColumn/RightExtractNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationAddLeftWholeColumnRightExtractNumber)],["Add/LeftWholeColumn/RightParseNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationAddLeftWholeColumnRightParseNumber)],["Add/LeftWholeColumn/RightWholeColumn",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationAddLeftWholeColumnRightWholeColumn)],["Average",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationAverage)],["DateTime/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeFormat)],["DateTime/Part/Hour",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimePartHour)],["DateTime/Part/Hour/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimePartHourFormat)],["DateTime/Part/Minute",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimePartMinute)],["DateTime/Part/Minute/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimePartMinuteFormat)],["DateTime/Part/Month",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimePartMonth)],["DateTime/Part/Month/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimePartMonthFormat)],["DateTime/Part/MonthDay",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimePartMonthDay)],["DateTime/Part/MonthDay/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimePartMonthDayFormat)],["DateTime/Part/MonthDays",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimePartMonthDays)],["DateTime/Part/MonthDays/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimePartMonthDaysFormat)],["DateTime/Part/MonthWeek",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimePartMonthWeek)],["DateTime/Part/MonthWeek/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimePartMonthWeekFormat)],["DateTime/Part/Quarter",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimePartQuarter)],["DateTime/Part/Quarter/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimePartQuarterFormat)],["DateTime/Part/QuarterDay",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimePartQuarterDay)],["DateTime/Part/QuarterDay/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimePartQuarterDayFormat)],["DateTime/Part/QuarterDays",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimePartQuarterDays)],["DateTime/Part/QuarterDays/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimePartQuarterDaysFormat)],["DateTime/Part/QuarterWeek",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimePartQuarterWeek)],["DateTime/Part/QuarterWeek/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimePartQuarterWeekFormat)],["DateTime/Part/Second",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimePartSecond)],["DateTime/Part/Second/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimePartSecondFormat)],["DateTime/Part/WeekDay",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimePartWeekDay)],["DateTime/Part/WeekDay/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimePartWeekDayFormat)],["DateTime/Part/Year",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimePartYear)],["DateTime/Part/Year/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimePartYearFormat)],["DateTime/Part/YearDay",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimePartYearDay)],["DateTime/Part/YearDay/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimePartYearDayFormat)],["DateTime/Part/YearDays",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimePartYearDays)],["DateTime/Part/YearDays/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimePartYearDaysFormat)],["DateTime/Part/YearWeek",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimePartYearWeek)],["DateTime/Part/YearWeek/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimePartYearWeekFormat)],["DateTime/Round/Down/Day",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundDownDay)],["DateTime/Round/Down/Day/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundDownDayFormat)],["DateTime/Round/Down/Hour",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundDownHour)],["DateTime/Round/Down/Hour/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundDownHourFormat)],["DateTime/Round/Down/Minute",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundDownMinute)],["DateTime/Round/Down/Minute/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundDownMinuteFormat)],["DateTime/Round/Down/Month",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundDownMonth)],["DateTime/Round/Down/Month/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundDownMonthFormat)],["DateTime/Round/Down/Quarter",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundDownQuarter)],["DateTime/Round/Down/Quarter/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundDownQuarterFormat)],["DateTime/Round/Down/Second",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundDownSecond)],["DateTime/Round/Down/Second/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundDownSecondFormat)],["DateTime/Round/Down/Week",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundDownWeek)],["DateTime/Round/Down/Week/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundDownWeekFormat)],["DateTime/Round/Down/Year",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundDownYear)],["DateTime/Round/Down/Year/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundDownYearFormat)],["DateTime/Round/Nearest/Day",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundNearestDay)],["DateTime/Round/Nearest/Day/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundNearestDayFormat)],["DateTime/Round/Nearest/Hour",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundNearestHour)],["DateTime/Round/Nearest/Hour/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundNearestHourFormat)],["DateTime/Round/Nearest/Minute",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundNearestMinute)],["DateTime/Round/Nearest/Minute/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundNearestMinuteFormat)],["DateTime/Round/Nearest/Month",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundNearestMonth)],["DateTime/Round/Nearest/Month/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundNearestMonthFormat)],["DateTime/Round/Nearest/Quarter",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundNearestQuarter)],["DateTime/Round/Nearest/Quarter/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundNearestQuarterFormat)],["DateTime/Round/Nearest/Second",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundNearestSecond)],["DateTime/Round/Nearest/Second/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundNearestSecondFormat)],["DateTime/Round/Nearest/Week",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundNearestWeek)],["DateTime/Round/Nearest/Week/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundNearestWeekFormat)],["DateTime/Round/Nearest/Year",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundNearestYear)],["DateTime/Round/Nearest/Year/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundNearestYearFormat)],["DateTime/Round/Up/Day",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundUpDay)],["DateTime/Round/Up/Day/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundUpDayFormat)],["DateTime/Round/Up/Hour",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundUpHour)],["DateTime/Round/Up/Hour/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundUpHourFormat)],["DateTime/Round/Up/Minute",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundUpMinute)],["DateTime/Round/Up/Minute/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundUpMinuteFormat)],["DateTime/Round/Up/Month",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundUpMonth)],["DateTime/Round/Up/Month/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundUpMonthFormat)],["DateTime/Round/Up/Month/LastDay",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundUpMonthLastDay)],["DateTime/Round/Up/Month/LastDay/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundUpMonthLastDayFormat)],["DateTime/Round/Up/Quarter",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundUpQuarter)],["DateTime/Round/Up/Quarter/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundUpQuarterFormat)],["DateTime/Round/Up/Quarter/LastDay",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundUpQuarterLastDay)],["DateTime/Round/Up/Quarter/LastDay/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundUpQuarterLastDayFormat)],["DateTime/Round/Up/Second",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundUpSecond)],["DateTime/Round/Up/Second/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundUpSecondFormat)],["DateTime/Round/Up/Week",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundUpWeek)],["DateTime/Round/Up/Week/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundUpWeekFormat)],["DateTime/Round/Up/Week/LastDay",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundUpWeekLastDay)],["DateTime/Round/Up/Week/LastDay/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundUpWeekLastDayFormat)],["DateTime/Round/Up/Year",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundUpYear)],["DateTime/Round/Up/Year/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundUpYearFormat)],["DateTime/Round/Up/Year/LastDay",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundUpYearLastDay)],["DateTime/Round/Up/Year/LastDay/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDateTimeRoundUpYearLastDayFormat)],["Divide/LeftExtractNumber/RightConstant",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDivideLeftExtractNumberRightConstant)],["Divide/LeftExtractNumber/RightExtractNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDivideLeftExtractNumberRightExtractNumber)],["Divide/LeftExtractNumber/RightParseNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDivideLeftExtractNumberRightParseNumber)],["Divide/LeftExtractNumber/RightWholeColumn",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDivideLeftExtractNumberRightWholeColumn)],["Divide/LeftParseNumber/RightConstant",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDivideLeftParseNumberRightConstant)],["Divide/LeftParseNumber/RightExtractNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDivideLeftParseNumberRightExtractNumber)],["Divide/LeftParseNumber/RightParseNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDivideLeftParseNumberRightParseNumber)],["Divide/LeftWholeColumn/RightConstant",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDivideLeftWholeColumnRightConstant)],["Divide/LeftWholeColumn/RightExtractNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDivideLeftWholeColumnRightExtractNumber)],["Divide/LeftWholeColumn/RightParseNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDivideLeftWholeColumnRightParseNumber)],["Divide/LeftWholeColumn/RightWholeColumn",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationDivideLeftWholeColumnRightWholeColumn)],["ExtractDateTime",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationExtractDateTime)],["ExtractDateTime/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationExtractDateTimeFormat)],["ExtractNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationExtractNumber)],["ExtractNumber/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationExtractNumberFormat)],["Length",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationLength)],["LowerCase",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationLowerCase)],["Multiply/LeftExtractNumber/RightConstant",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationMultiplyLeftExtractNumberRightConstant)],["Multiply/LeftExtractNumber/RightExtractNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationMultiplyLeftExtractNumberRightExtractNumber)],["Multiply/LeftExtractNumber/RightParseNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationMultiplyLeftExtractNumberRightParseNumber)],["Multiply/LeftExtractNumber/RightWholeColumn",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationMultiplyLeftExtractNumberRightWholeColumn)],["Multiply/LeftParseNumber/RightConstant",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationMultiplyLeftParseNumberRightConstant)],["Multiply/LeftParseNumber/RightExtractNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationMultiplyLeftParseNumberRightExtractNumber)],["Multiply/LeftParseNumber/RightParseNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationMultiplyLeftParseNumberRightParseNumber)],["Multiply/LeftWholeColumn/RightConstant",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationMultiplyLeftWholeColumnRightConstant)],["Multiply/LeftWholeColumn/RightExtractNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationMultiplyLeftWholeColumnRightExtractNumber)],["Multiply/LeftWholeColumn/RightParseNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationMultiplyLeftWholeColumnRightParseNumber)],["Multiply/LeftWholeColumn/RightWholeColumn",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationMultiplyLeftWholeColumnRightWholeColumn)],["Number/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationNumberFormat)],["Number/Round/Down",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationNumberRoundDown)],["Number/Round/Down/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationNumberRoundDownFormat)],["Number/Round/Nearest",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationNumberRoundNearest)],["Number/Round/Nearest/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationNumberRoundNearestFormat)],["Number/Round/Up",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationNumberRoundUp)],["Number/Round/Up/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationNumberRoundUpFormat)],["ParseDateTime",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTime)],["ParseDateTime/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeFormat)],["ParseDateTime/Part/Hour",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimePartHour)],["ParseDateTime/Part/Hour/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimePartHourFormat)],["ParseDateTime/Part/Minute",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimePartMinute)],["ParseDateTime/Part/Minute/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimePartMinuteFormat)],["ParseDateTime/Part/Month",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimePartMonth)],["ParseDateTime/Part/Month/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimePartMonthFormat)],["ParseDateTime/Part/MonthDay",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimePartMonthDay)],["ParseDateTime/Part/MonthDay/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimePartMonthDayFormat)],["ParseDateTime/Part/MonthDays",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimePartMonthDays)],["ParseDateTime/Part/MonthDays/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimePartMonthDaysFormat)],["ParseDateTime/Part/MonthWeek",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimePartMonthWeek)],["ParseDateTime/Part/MonthWeek/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimePartMonthWeekFormat)],["ParseDateTime/Part/Quarter",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimePartQuarter)],["ParseDateTime/Part/Quarter/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimePartQuarterFormat)],["ParseDateTime/Part/QuarterDay",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimePartQuarterDay)],["ParseDateTime/Part/QuarterDay/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimePartQuarterDayFormat)],["ParseDateTime/Part/QuarterDays",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimePartQuarterDays)],["ParseDateTime/Part/QuarterDays/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimePartQuarterDaysFormat)],["ParseDateTime/Part/QuarterWeek",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimePartQuarterWeek)],["ParseDateTime/Part/QuarterWeek/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimePartQuarterWeekFormat)],["ParseDateTime/Part/Second",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimePartSecond)],["ParseDateTime/Part/Second/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimePartSecondFormat)],["ParseDateTime/Part/WeekDay",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimePartWeekDay)],["ParseDateTime/Part/WeekDay/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimePartWeekDayFormat)],["ParseDateTime/Part/Year",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimePartYear)],["ParseDateTime/Part/Year/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimePartYearFormat)],["ParseDateTime/Part/YearDay",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimePartYearDay)],["ParseDateTime/Part/YearDay/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimePartYearDayFormat)],["ParseDateTime/Part/YearDays",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimePartYearDays)],["ParseDateTime/Part/YearDays/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimePartYearDaysFormat)],["ParseDateTime/Part/YearWeek",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimePartYearWeek)],["ParseDateTime/Part/YearWeek/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimePartYearWeekFormat)],["ParseDateTime/Round/Down/Day",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundDownDay)],["ParseDateTime/Round/Down/Day/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundDownDayFormat)],["ParseDateTime/Round/Down/Hour",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundDownHour)],["ParseDateTime/Round/Down/Hour/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundDownHourFormat)],["ParseDateTime/Round/Down/Minute",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundDownMinute)],["ParseDateTime/Round/Down/Minute/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundDownMinuteFormat)],["ParseDateTime/Round/Down/Month",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundDownMonth)],["ParseDateTime/Round/Down/Month/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundDownMonthFormat)],["ParseDateTime/Round/Down/Quarter",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundDownQuarter)],["ParseDateTime/Round/Down/Quarter/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundDownQuarterFormat)],["ParseDateTime/Round/Down/Second",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundDownSecond)],["ParseDateTime/Round/Down/Second/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundDownSecondFormat)],["ParseDateTime/Round/Down/Week",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundDownWeek)],["ParseDateTime/Round/Down/Week/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundDownWeekFormat)],["ParseDateTime/Round/Down/Year",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundDownYear)],["ParseDateTime/Round/Down/Year/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundDownYearFormat)],["ParseDateTime/Round/Nearest/Day",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundNearestDay)],["ParseDateTime/Round/Nearest/Day/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundNearestDayFormat)],["ParseDateTime/Round/Nearest/Hour",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundNearestHour)],["ParseDateTime/Round/Nearest/Hour/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundNearestHourFormat)],["ParseDateTime/Round/Nearest/Minute",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundNearestMinute)],["ParseDateTime/Round/Nearest/Minute/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundNearestMinuteFormat)],["ParseDateTime/Round/Nearest/Month",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundNearestMonth)],["ParseDateTime/Round/Nearest/Month/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundNearestMonthFormat)],["ParseDateTime/Round/Nearest/Quarter",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundNearestQuarter)],["ParseDateTime/Round/Nearest/Quarter/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundNearestQuarterFormat)],["ParseDateTime/Round/Nearest/Second",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundNearestSecond)],["ParseDateTime/Round/Nearest/Second/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundNearestSecondFormat)],["ParseDateTime/Round/Nearest/Week",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundNearestWeek)],["ParseDateTime/Round/Nearest/Week/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundNearestWeekFormat)],["ParseDateTime/Round/Nearest/Year",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundNearestYear)],["ParseDateTime/Round/Nearest/Year/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundNearestYearFormat)],["ParseDateTime/Round/Up/Day",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundUpDay)],["ParseDateTime/Round/Up/Day/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundUpDayFormat)],["ParseDateTime/Round/Up/Hour",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundUpHour)],["ParseDateTime/Round/Up/Hour/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundUpHourFormat)],["ParseDateTime/Round/Up/Minute",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundUpMinute)],["ParseDateTime/Round/Up/Minute/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundUpMinuteFormat)],["ParseDateTime/Round/Up/Month",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundUpMonth)],["ParseDateTime/Round/Up/Month/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundUpMonthFormat)],["ParseDateTime/Round/Up/Month/LastDay",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundUpMonthLastDay)],["ParseDateTime/Round/Up/Month/LastDay/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundUpMonthLastDayFormat)],["ParseDateTime/Round/Up/Quarter",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundUpQuarter)],["ParseDateTime/Round/Up/Quarter/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundUpQuarterFormat)],["ParseDateTime/Round/Up/Quarter/LastDay",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundUpQuarterLastDay)],["ParseDateTime/Round/Up/Quarter/LastDay/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundUpQuarterLastDayFormat)],["ParseDateTime/Round/Up/Second",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundUpSecond)],["ParseDateTime/Round/Up/Second/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundUpSecondFormat)],["ParseDateTime/Round/Up/Week",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundUpWeek)],["ParseDateTime/Round/Up/Week/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundUpWeekFormat)],["ParseDateTime/Round/Up/Week/LastDay",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundUpWeekLastDay)],["ParseDateTime/Round/Up/Week/LastDay/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundUpWeekLastDayFormat)],["ParseDateTime/Round/Up/Year",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundUpYear)],["ParseDateTime/Round/Up/Year/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundUpYearFormat)],["ParseDateTime/Round/Up/Year/LastDay",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundUpYearLastDay)],["ParseDateTime/Round/Up/Year/LastDay/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseDateTimeRoundUpYearLastDayFormat)],["ParseNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseNumber)],["ParseNumber/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseNumberFormat)],["ParseNumber/Round/Down",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseNumberRoundDown)],["ParseNumber/Round/Down/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseNumberRoundDownFormat)],["ParseNumber/Round/Nearest",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseNumberRoundNearest)],["ParseNumber/Round/Nearest/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseNumberRoundNearestFormat)],["ParseNumber/Round/Up",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseNumberRoundUp)],["ParseNumber/Round/Up/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationParseNumberRoundUpFormat)],["Product",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationProduct)],["ProperCase",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationProperCase)],["Replace",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationReplace)],["SliceInfix",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationSliceInfix)],["SliceInfix/LeftAbsolute/RightAbsolute",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationSliceInfixLeftAbsoluteRightAbsolute)],["SliceInfix/LeftAbsolute/-RightAbsolute",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationSliceInfixLeftAbsoluteMinusRightAbsolute)],["SliceInfix/-LeftAbsolute/RightAbsolute",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationSliceInfixMinusLeftAbsoluteRightAbsolute)],["SliceInfix/-LeftAbsolute/-RightAbsolute",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationSliceInfixMinusLeftAbsoluteMinusRightAbsolute)],["SlicePrefix",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationSlicePrefix)],["SlicePrefix/Absolute/1",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationSlicePrefixAbsolute1)],["SlicePrefix/Absolute/-1",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationSlicePrefixAbsoluteMinus1)],["SlicePrefix/Absolute/N",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationSlicePrefixAbsoluteN)],["SlicePrefix/Absolute/-N",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationSlicePrefixAbsoluteMinusN)],["SlicePrefix/Find",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationSlicePrefixFind)],["SliceSuffix",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationSliceSuffix)],["SliceSuffix/Absolute/1",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationSliceSuffixAbsolute1)],["SliceSuffix/Absolute/-1",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationSliceSuffixAbsoluteMinus1)],["SliceSuffix/Absolute/N",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationSliceSuffixAbsoluteN)],["SliceSuffix/Absolute/-N",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationSliceSuffixAbsoluteMinusN)],["SliceSuffix/Find",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationSliceSuffixFind)],["Split",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationSplit)],["Split/1",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationSplit1)],["Split/-1",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationSplitMinus1)],["Split/N",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationSplitN)],["Split/-N",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationSplitMinusN)],["Subtract/LeftExtractNumber/RightConstant",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationSubtractLeftExtractNumberRightConstant)],["Subtract/LeftExtractNumber/RightExtractNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationSubtractLeftExtractNumberRightExtractNumber)],["Subtract/LeftExtractNumber/RightParseNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationSubtractLeftExtractNumberRightParseNumber)],["Subtract/LeftExtractNumber/RightWholeColumn",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationSubtractLeftExtractNumberRightWholeColumn)],["Subtract/LeftParseNumber/RightConstant",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationSubtractLeftParseNumberRightConstant)],["Subtract/LeftParseNumber/RightExtractNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationSubtractLeftParseNumberRightExtractNumber)],["Subtract/LeftParseNumber/RightParseNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationSubtractLeftParseNumberRightParseNumber)],["Subtract/LeftWholeColumn/RightConstant",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationSubtractLeftWholeColumnRightConstant)],["Subtract/LeftWholeColumn/RightExtractNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationSubtractLeftWholeColumnRightExtractNumber)],["Subtract/LeftWholeColumn/RightParseNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationSubtractLeftWholeColumnRightParseNumber)],["Subtract/LeftWholeColumn/RightWholeColumn",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationSubtractLeftWholeColumnRightWholeColumn)],["Sum",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationSum)],["Trim",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationTrim)],["UpperCase",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBEExplanationUpperCase)]]),tF=new Map([["Add/LeftExtractNumber/RightConstant",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationAddLeftExtractNumberRightConstant)],["Add/LeftExtractNumber/RightExtractNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationAddLeftExtractNumberRightExtractNumber)],["Add/LeftExtractNumber/RightParseNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationAddLeftExtractNumberRightParseNumber)],["Add/LeftExtractNumber/RightWholeColumn",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationAddLeftExtractNumberRightWholeColumn)],["Add/LeftParseNumber/RightConstant",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationAddLeftParseNumberRightConstant)],["Add/LeftParseNumber/RightExtractNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationAddLeftParseNumberRightExtractNumber)],["Add/LeftParseNumber/RightParseNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationAddLeftParseNumberRightParseNumber)],["Add/LeftWholeColumn/RightConstant",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationAddLeftWholeColumnRightConstant)],["Add/LeftWholeColumn/RightExtractNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationAddLeftWholeColumnRightExtractNumber)],["Add/LeftWholeColumn/RightParseNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationAddLeftWholeColumnRightParseNumber)],["Add/LeftWholeColumn/RightWholeColumn",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationAddLeftWholeColumnRightWholeColumn)],["Average",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationAverage)],["DateTime/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeFormat)],["DateTime/Part/Hour",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimePartHour)],["DateTime/Part/Hour/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimePartHourFormat)],["DateTime/Part/Minute",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimePartMinute)],["DateTime/Part/Minute/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimePartMinuteFormat)],["DateTime/Part/Month",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimePartMonth)],["DateTime/Part/Month/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimePartMonthFormat)],["DateTime/Part/MonthDay",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimePartMonthDay)],["DateTime/Part/MonthDay/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimePartMonthDayFormat)],["DateTime/Part/MonthDays",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimePartMonthDays)],["DateTime/Part/MonthDays/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimePartMonthDaysFormat)],["DateTime/Part/MonthWeek",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimePartMonthWeek)],["DateTime/Part/MonthWeek/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimePartMonthWeekFormat)],["DateTime/Part/Quarter",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimePartQuarter)],["DateTime/Part/Quarter/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimePartQuarterFormat)],["DateTime/Part/QuarterDay",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimePartQuarterDay)],["DateTime/Part/QuarterDay/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimePartQuarterDayFormat)],["DateTime/Part/QuarterDays",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimePartQuarterDays)],["DateTime/Part/QuarterDays/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimePartQuarterDaysFormat)],["DateTime/Part/QuarterWeek",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimePartQuarterWeek)],["DateTime/Part/QuarterWeek/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimePartQuarterWeekFormat)],["DateTime/Part/Second",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimePartSecond)],["DateTime/Part/Second/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimePartSecondFormat)],["DateTime/Part/WeekDay",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimePartWeekDay)],["DateTime/Part/WeekDay/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimePartWeekDayFormat)],["DateTime/Part/Year",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimePartYear)],["DateTime/Part/Year/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimePartYearFormat)],["DateTime/Part/YearDay",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimePartYearDay)],["DateTime/Part/YearDay/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimePartYearDayFormat)],["DateTime/Part/YearDays",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimePartYearDays)],["DateTime/Part/YearDays/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimePartYearDaysFormat)],["DateTime/Part/YearWeek",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimePartYearWeek)],["DateTime/Part/YearWeek/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimePartYearWeekFormat)],["DateTime/Round/Down/Day",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundDownDay)],["DateTime/Round/Down/Day/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundDownDayFormat)],["DateTime/Round/Down/Hour",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundDownHour)],["DateTime/Round/Down/Hour/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundDownHourFormat)],["DateTime/Round/Down/Minute",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundDownMinute)],["DateTime/Round/Down/Minute/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundDownMinuteFormat)],["DateTime/Round/Down/Month",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundDownMonth)],["DateTime/Round/Down/Month/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundDownMonthFormat)],["DateTime/Round/Down/Quarter",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundDownQuarter)],["DateTime/Round/Down/Quarter/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundDownQuarterFormat)],["DateTime/Round/Down/Second",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundDownSecond)],["DateTime/Round/Down/Second/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundDownSecondFormat)],["DateTime/Round/Down/Week",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundDownWeek)],["DateTime/Round/Down/Week/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundDownWeekFormat)],["DateTime/Round/Down/Year",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundDownYear)],["DateTime/Round/Down/Year/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundDownYearFormat)],["DateTime/Round/Nearest/Day",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundNearestDay)],["DateTime/Round/Nearest/Day/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundNearestDayFormat)],["DateTime/Round/Nearest/Hour",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundNearestHour)],["DateTime/Round/Nearest/Hour/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundNearestHourFormat)],["DateTime/Round/Nearest/Minute",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundNearestMinute)],["DateTime/Round/Nearest/Minute/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundNearestMinuteFormat)],["DateTime/Round/Nearest/Month",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundNearestMonth)],["DateTime/Round/Nearest/Month/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundNearestMonthFormat)],["DateTime/Round/Nearest/Quarter",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundNearestQuarter)],["DateTime/Round/Nearest/Quarter/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundNearestQuarterFormat)],["DateTime/Round/Nearest/Second",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundNearestSecond)],["DateTime/Round/Nearest/Second/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundNearestSecondFormat)],["DateTime/Round/Nearest/Week",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundNearestWeek)],["DateTime/Round/Nearest/Week/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundNearestWeekFormat)],["DateTime/Round/Nearest/Year",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundNearestYear)],["DateTime/Round/Nearest/Year/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundNearestYearFormat)],["DateTime/Round/Up/Day",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundUpDay)],["DateTime/Round/Up/Day/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundUpDayFormat)],["DateTime/Round/Up/Hour",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundUpHour)],["DateTime/Round/Up/Hour/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundUpHourFormat)],["DateTime/Round/Up/Minute",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundUpMinute)],["DateTime/Round/Up/Minute/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundUpMinuteFormat)],["DateTime/Round/Up/Month",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundUpMonth)],["DateTime/Round/Up/Month/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundUpMonthFormat)],["DateTime/Round/Up/Month/LastDay",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundUpMonthLastDay)],["DateTime/Round/Up/Month/LastDay/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundUpMonthLastDayFormat)],["DateTime/Round/Up/Quarter",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundUpQuarter)],["DateTime/Round/Up/Quarter/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundUpQuarterFormat)],["DateTime/Round/Up/Quarter/LastDay",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundUpQuarterLastDay)],["DateTime/Round/Up/Quarter/LastDay/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundUpQuarterLastDayFormat)],["DateTime/Round/Up/Second",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundUpSecond)],["DateTime/Round/Up/Second/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundUpSecondFormat)],["DateTime/Round/Up/Week",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundUpWeek)],["DateTime/Round/Up/Week/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundUpWeekFormat)],["DateTime/Round/Up/Week/LastDay",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundUpWeekLastDay)],["DateTime/Round/Up/Week/LastDay/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundUpWeekLastDayFormat)],["DateTime/Round/Up/Year",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundUpYear)],["DateTime/Round/Up/Year/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundUpYearFormat)],["DateTime/Round/Up/Year/LastDay",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundUpYearLastDay)],["DateTime/Round/Up/Year/LastDay/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDateTimeRoundUpYearLastDayFormat)],["Divide/LeftExtractNumber/RightConstant",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDivideLeftExtractNumberRightConstant)],["Divide/LeftExtractNumber/RightExtractNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDivideLeftExtractNumberRightExtractNumber)],["Divide/LeftExtractNumber/RightParseNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDivideLeftExtractNumberRightParseNumber)],["Divide/LeftExtractNumber/RightWholeColumn",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDivideLeftExtractNumberRightWholeColumn)],["Divide/LeftParseNumber/RightConstant",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDivideLeftParseNumberRightConstant)],["Divide/LeftParseNumber/RightExtractNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDivideLeftParseNumberRightExtractNumber)],["Divide/LeftParseNumber/RightParseNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDivideLeftParseNumberRightParseNumber)],["Divide/LeftWholeColumn/RightConstant",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDivideLeftWholeColumnRightConstant)],["Divide/LeftWholeColumn/RightExtractNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDivideLeftWholeColumnRightExtractNumber)],["Divide/LeftWholeColumn/RightParseNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDivideLeftWholeColumnRightParseNumber)],["Divide/LeftWholeColumn/RightWholeColumn",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationDivideLeftWholeColumnRightWholeColumn)],["ExtractDateTime",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationExtractDateTime)],["ExtractDateTime/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationExtractDateTimeFormat)],["ExtractNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationExtractNumber)],["ExtractNumber/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationExtractNumberFormat)],["Length",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationLength)],["LowerCase",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationLowerCase)],["Multiply/LeftExtractNumber/RightConstant",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationMultiplyLeftExtractNumberRightConstant)],["Multiply/LeftExtractNumber/RightExtractNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationMultiplyLeftExtractNumberRightExtractNumber)],["Multiply/LeftExtractNumber/RightParseNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationMultiplyLeftExtractNumberRightParseNumber)],["Multiply/LeftExtractNumber/RightWholeColumn",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationMultiplyLeftExtractNumberRightWholeColumn)],["Multiply/LeftParseNumber/RightConstant",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationMultiplyLeftParseNumberRightConstant)],["Multiply/LeftParseNumber/RightExtractNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationMultiplyLeftParseNumberRightExtractNumber)],["Multiply/LeftParseNumber/RightParseNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationMultiplyLeftParseNumberRightParseNumber)],["Multiply/LeftWholeColumn/RightConstant",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationMultiplyLeftWholeColumnRightConstant)],["Multiply/LeftWholeColumn/RightExtractNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationMultiplyLeftWholeColumnRightExtractNumber)],["Multiply/LeftWholeColumn/RightParseNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationMultiplyLeftWholeColumnRightParseNumber)],["Multiply/LeftWholeColumn/RightWholeColumn",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationMultiplyLeftWholeColumnRightWholeColumn)],["Number/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationNumberFormat)],["Number/Round/Down",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationNumberRoundDown)],["Number/Round/Down/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationNumberRoundDownFormat)],["Number/Round/Nearest",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationNumberRoundNearest)],["Number/Round/Nearest/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationNumberRoundNearestFormat)],["Number/Round/Up",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationNumberRoundUp)],["Number/Round/Up/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationNumberRoundUpFormat)],["ParseDateTime",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTime)],["ParseDateTime/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeFormat)],["ParseDateTime/Part/Hour",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimePartHour)],["ParseDateTime/Part/Hour/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimePartHourFormat)],["ParseDateTime/Part/Minute",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimePartMinute)],["ParseDateTime/Part/Minute/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimePartMinuteFormat)],["ParseDateTime/Part/Month",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimePartMonth)],["ParseDateTime/Part/Month/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimePartMonthFormat)],["ParseDateTime/Part/MonthDay",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimePartMonthDay)],["ParseDateTime/Part/MonthDay/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimePartMonthDayFormat)],["ParseDateTime/Part/MonthDays",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimePartMonthDays)],["ParseDateTime/Part/MonthDays/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimePartMonthDaysFormat)],["ParseDateTime/Part/MonthWeek",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimePartMonthWeek)],["ParseDateTime/Part/MonthWeek/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimePartMonthWeekFormat)],["ParseDateTime/Part/Quarter",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimePartQuarter)],["ParseDateTime/Part/Quarter/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimePartQuarterFormat)],["ParseDateTime/Part/QuarterDay",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimePartQuarterDay)],["ParseDateTime/Part/QuarterDay/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimePartQuarterDayFormat)],["ParseDateTime/Part/QuarterDays",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimePartQuarterDays)],["ParseDateTime/Part/QuarterDays/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimePartQuarterDaysFormat)],["ParseDateTime/Part/QuarterWeek",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimePartQuarterWeek)],["ParseDateTime/Part/QuarterWeek/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimePartQuarterWeekFormat)],["ParseDateTime/Part/Second",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimePartSecond)],["ParseDateTime/Part/Second/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimePartSecondFormat)],["ParseDateTime/Part/WeekDay",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimePartWeekDay)],["ParseDateTime/Part/WeekDay/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimePartWeekDayFormat)],["ParseDateTime/Part/Year",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimePartYear)],["ParseDateTime/Part/Year/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimePartYearFormat)],["ParseDateTime/Part/YearDay",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimePartYearDay)],["ParseDateTime/Part/YearDay/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimePartYearDayFormat)],["ParseDateTime/Part/YearDays",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimePartYearDays)],["ParseDateTime/Part/YearDays/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimePartYearDaysFormat)],["ParseDateTime/Part/YearWeek",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimePartYearWeek)],["ParseDateTime/Part/YearWeek/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimePartYearWeekFormat)],["ParseDateTime/Round/Down/Day",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundDownDay)],["ParseDateTime/Round/Down/Day/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundDownDayFormat)],["ParseDateTime/Round/Down/Hour",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundDownHour)],["ParseDateTime/Round/Down/Hour/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundDownHourFormat)],["ParseDateTime/Round/Down/Minute",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundDownMinute)],["ParseDateTime/Round/Down/Minute/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundDownMinuteFormat)],["ParseDateTime/Round/Down/Month",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundDownMonth)],["ParseDateTime/Round/Down/Month/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundDownMonthFormat)],["ParseDateTime/Round/Down/Quarter",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundDownQuarter)],["ParseDateTime/Round/Down/Quarter/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundDownQuarterFormat)],["ParseDateTime/Round/Down/Second",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundDownSecond)],["ParseDateTime/Round/Down/Second/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundDownSecondFormat)],["ParseDateTime/Round/Down/Week",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundDownWeek)],["ParseDateTime/Round/Down/Week/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundDownWeekFormat)],["ParseDateTime/Round/Down/Year",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundDownYear)],["ParseDateTime/Round/Down/Year/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundDownYearFormat)],["ParseDateTime/Round/Nearest/Day",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundNearestDay)],["ParseDateTime/Round/Nearest/Day/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundNearestDayFormat)],["ParseDateTime/Round/Nearest/Hour",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundNearestHour)],["ParseDateTime/Round/Nearest/Hour/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundNearestHourFormat)],["ParseDateTime/Round/Nearest/Minute",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundNearestMinute)],["ParseDateTime/Round/Nearest/Minute/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundNearestMinuteFormat)],["ParseDateTime/Round/Nearest/Month",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundNearestMonth)],["ParseDateTime/Round/Nearest/Month/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundNearestMonthFormat)],["ParseDateTime/Round/Nearest/Quarter",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundNearestQuarter)],["ParseDateTime/Round/Nearest/Quarter/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundNearestQuarterFormat)],["ParseDateTime/Round/Nearest/Second",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundNearestSecond)],["ParseDateTime/Round/Nearest/Second/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundNearestSecondFormat)],["ParseDateTime/Round/Nearest/Week",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundNearestWeek)],["ParseDateTime/Round/Nearest/Week/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundNearestWeekFormat)],["ParseDateTime/Round/Nearest/Year",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundNearestYear)],["ParseDateTime/Round/Nearest/Year/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundNearestYearFormat)],["ParseDateTime/Round/Up/Day",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundUpDay)],["ParseDateTime/Round/Up/Day/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundUpDayFormat)],["ParseDateTime/Round/Up/Hour",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundUpHour)],["ParseDateTime/Round/Up/Hour/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundUpHourFormat)],["ParseDateTime/Round/Up/Minute",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundUpMinute)],["ParseDateTime/Round/Up/Minute/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundUpMinuteFormat)],["ParseDateTime/Round/Up/Month",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundUpMonth)],["ParseDateTime/Round/Up/Month/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundUpMonthFormat)],["ParseDateTime/Round/Up/Month/LastDay",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundUpMonthLastDay)],["ParseDateTime/Round/Up/Month/LastDay/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundUpMonthLastDayFormat)],["ParseDateTime/Round/Up/Quarter",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundUpQuarter)],["ParseDateTime/Round/Up/Quarter/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundUpQuarterFormat)],["ParseDateTime/Round/Up/Quarter/LastDay",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundUpQuarterLastDay)],["ParseDateTime/Round/Up/Quarter/LastDay/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundUpQuarterLastDayFormat)],["ParseDateTime/Round/Up/Second",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundUpSecond)],["ParseDateTime/Round/Up/Second/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundUpSecondFormat)],["ParseDateTime/Round/Up/Week",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundUpWeek)],["ParseDateTime/Round/Up/Week/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundUpWeekFormat)],["ParseDateTime/Round/Up/Week/LastDay",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundUpWeekLastDay)],["ParseDateTime/Round/Up/Week/LastDay/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundUpWeekLastDayFormat)],["ParseDateTime/Round/Up/Year",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundUpYear)],["ParseDateTime/Round/Up/Year/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundUpYearFormat)],["ParseDateTime/Round/Up/Year/LastDay",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundUpYearLastDay)],["ParseDateTime/Round/Up/Year/LastDay/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseDateTimeRoundUpYearLastDayFormat)],["ParseNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseNumber)],["ParseNumber/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseNumberFormat)],["ParseNumber/Round/Down",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseNumberRoundDown)],["ParseNumber/Round/Down/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseNumberRoundDownFormat)],["ParseNumber/Round/Nearest",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseNumberRoundNearest)],["ParseNumber/Round/Nearest/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseNumberRoundNearestFormat)],["ParseNumber/Round/Up",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseNumberRoundUp)],["ParseNumber/Round/Up/Format",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationParseNumberRoundUpFormat)],["Product",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationProduct)],["ProperCase",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationProperCase)],["Replace",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationReplace)],["SliceInfix",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationSliceInfix)],["SliceInfix/LeftAbsolute/RightAbsolute",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationSliceInfixLeftAbsoluteRightAbsolute)],["SliceInfix/LeftAbsolute/-RightAbsolute",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationSliceInfixLeftAbsoluteMinusRightAbsolute)],["SliceInfix/-LeftAbsolute/RightAbsolute",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationSliceInfixMinusLeftAbsoluteRightAbsolute)],["SliceInfix/-LeftAbsolute/-RightAbsolute",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationSliceInfixMinusLeftAbsoluteMinusRightAbsolute)],["SlicePrefix",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationSlicePrefix)],["SlicePrefix/Absolute/1",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationSlicePrefixAbsolute1)],["SlicePrefix/Absolute/-1",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationSlicePrefixAbsoluteMinus1)],["SlicePrefix/Absolute/N",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationSlicePrefixAbsoluteN)],["SlicePrefix/Absolute/-N",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationSlicePrefixAbsoluteMinusN)],["SlicePrefix/Find",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationSlicePrefixFind)],["SliceSuffix",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationSliceSuffix)],["SliceSuffix/Absolute/1",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationSliceSuffixAbsolute1)],["SliceSuffix/Absolute/-1",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationSliceSuffixAbsoluteMinus1)],["SliceSuffix/Absolute/N",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationSliceSuffixAbsoluteN)],["SliceSuffix/Absolute/-N",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationSliceSuffixAbsoluteMinusN)],["SliceSuffix/Find",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationSliceSuffixFind)],["Split",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationSplit)],["Split/1",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationSplit1)],["Split/-1",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationSplitMinus1)],["Split/N",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationSplitN)],["Split/-N",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationSplitMinusN)],["Subtract/LeftExtractNumber/RightConstant",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationSubtractLeftExtractNumberRightConstant)],["Subtract/LeftExtractNumber/RightExtractNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationSubtractLeftExtractNumberRightExtractNumber)],["Subtract/LeftExtractNumber/RightParseNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationSubtractLeftExtractNumberRightParseNumber)],["Subtract/LeftExtractNumber/RightWholeColumn",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationSubtractLeftExtractNumberRightWholeColumn)],["Subtract/LeftParseNumber/RightConstant",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationSubtractLeftParseNumberRightConstant)],["Subtract/LeftParseNumber/RightExtractNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationSubtractLeftParseNumberRightExtractNumber)],["Subtract/LeftParseNumber/RightParseNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationSubtractLeftParseNumberRightParseNumber)],["Subtract/LeftWholeColumn/RightConstant",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationSubtractLeftWholeColumnRightConstant)],["Subtract/LeftWholeColumn/RightExtractNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationSubtractLeftWholeColumnRightExtractNumber)],["Subtract/LeftWholeColumn/RightParseNumber",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationSubtractLeftWholeColumnRightParseNumber)],["Subtract/LeftWholeColumn/RightWholeColumn",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationSubtractLeftWholeColumnRightWholeColumn)],["Sum",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationSum)],["Trim",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationTrim)],["UpperCase",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FBECopilotExplanationUpperCase)]]),nF=new Map([["space",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.CharacterLabelSpace)],["period",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.CharacterLabelPeriod)],["underscore",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.CharacterLabelUnderscore)],["comma",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.CharacterLabelComma)],["slash",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.CharacterLabelSlash)],["backslash",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.CharacterLabelBackslash)],["colon",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.CharacterLabelColon)],["semicolon",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.CharacterLabelSemicolon)],["dash",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.CharacterLabelDash)],["dollar sign",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.CharacterLabelDollarSign)],["line break",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.CharacterLabelLineBreak)],["nothing",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.CharacterLabelNothing)]]),oF=Object(Jo.c)(e=>({ShowFormulaButtonStyles:{root:{color:e.palette.themePrimary,height:20,paddingInlineStart:0},label:{margin:0}},bodyContentStyle:{marginBottom:7,minWidth:200}})),rF={Apply:"OK",Ignore:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaByExampleIgnore),Title:"You've received an answer",ShowDetails:"Show Details",HideDetails:"Hide Details"},iF=({result:e,tag:t,description:n,target:o,onApply:r,onExplicitExit:i,onCardMount:a})=>{const s=Object(Yx.a)(),l=oF(s),[c,{toggle:u}]=Object(zI.a)(!1),d=[{key:"apply",text:rF.Apply,onClick:r,kind:"APPLY"},{key:"ignore",text:rF.Ignore,onClick:i,kind:"IGNORE"}];return R.createElement(HI,{target:o,onEscape:i,onCardMount:a},R.createElement(WE,{title:rF.Title,mainActions:d,onClose:i,range:t,handleTab:qo.b.all},R.createElement(rs.a,{block:!0,style:l.bodyContentStyle},c?n:e),R.createElement(Ue.a,{styles:l.ShowFormulaButtonStyles,onClick:()=>{u()}},c?rF.HideDetails:rF.ShowDetails)))};function aF(e,t,n,o,r,i,a,s,l){k.render(R.createElement(iF,{result:e,tag:t,description:n,target:r,onApply:i,onExplicitExit:a,onShowDetails:s,onCardMount:l}),o)}const sF={Title:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ExcelIntelligenceTitle),Body:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ExcelIntelligenceBody)},lF=Object(Jo.c)(e=>({calloutStyles:{root:{borderRadius:8,boxShadow:"0px 4px 8px rgba(0, 0, 0, 0.14), 0px 0px 2px rgba(0, 0, 0, 0.12)"}},cardStyle:{background:e.palette.white,width:180,height:68,borderRadius:8},stackStyle:{paddingLeft:12,paddingTop:8,paddingRight:8,paddingBottom:8},titleContentStyle:{color:e.palette.black,padding:0,fontFamily:"Segoe UI",fontWeight:600,fontSize:14},bodyContentStyle:{color:e.palette.black,padding:0,fontFamily:"Segoe UI",fontWeight:400,fontSize:12},closeButtonStyles:{root:{width:8.5,height:8.5}}})),cF=({target:e,onApply:t,onEscape:n,onCancel:o,onCardMount:r})=>{const i=Object(Yx.a)(),a=lF(i),s=Object(If.a)()?c.a.CancelGlyphWhite_16:c.a.CancelGlyph_16,[l,u]=R.useState(!1),d={backgroundColor:l?i.palette.themeLight:i.palette.white};return R.createElement(HI,{target:e,styles:_object_spread({},a.cardStyle,d),onEscape:n,onCardMount:r,calloutStyles:a.calloutStyles},R.createElement(Cd.a,{onMouseEnter:()=>{u(!0)},onMouseLeave:()=>{u(!1)}},R.createElement(At.a,{horizontalAlign:"end"},dF(l,s,o,a.closeButtonStyles)),R.createElement(At.a,{onClick:t,style:a.stackStyle},R.createElement(jt.a,{style:a.titleContentStyle},sF.Title),R.createElement(rs.a,{block:!0,style:a.bodyContentStyle},sF.Body))))};function uF(e,t,n,o,r,i){k.render(R.createElement(cF,{target:t,onApply:n,onEscape:o,onCancel:r,onCardMount:i}),e)}const dF=(e,t,n,o)=>e?R.createElement(vd.a,{iconProps:{iconName:t},onClick:n,style:{position:"absolute",top:14,right:12},styles:o}):R.createElement("img",{src:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjMiIGhlaWdodD0iMjIiIHZpZXdCb3g9IjAgMCAyMyAyMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTguMDYwNjMgMTUuNzAxMUM4LjMzNTM1IDE1Ljg5NTUgOC42NjM1OSAxNi4wMDAxIDkuMDAwMTggMTYuMDAwM0M5LjMxNjQyIDE2LjAwMDIgOS42MjU3OCAxNS45MDc5IDkuODkwNCAxNS43MzQ4QzEwLjE1NSAxNS41NjE2IDEwLjM2MzQgMTUuMzE1MSAxMC40OTAyIDE1LjAyNTNMMTEuMjU5MiAxMi42ODUzQzExLjQ0NjggMTIuMTIyNCAxMS43NjI5IDExLjYxMDggMTIuMTgyNCAxMS4xOTEyQzEyLjYwMTkgMTAuNzcxNSAxMy4xMTMzIDEwLjQ1NTIgMTMuNjc2MiAxMC4yNjczTDE1LjkxNDIgOS41NDAzM0MxNi4yMzE5IDkuNDI5IDE2LjUwNjggOS4yMjA5MiAxNi43MDAyIDguOTQ1MzNDMTYuODQ4OSA4LjczNTkzIDE2Ljk0NTcgOC40OTQxOSAxNi45ODI2IDguMjQwMDVDMTcuMDE5NSA3Ljk4NTkgMTYuOTk1NiA3LjcyNjYyIDE2LjkxMjcgNy40ODM1NUMxNi44Mjk4IDcuMjQwNDkgMTYuNjkwMyA3LjAyMDYgMTYuNTA1NyA2Ljg0MkMxNi4zMjEyIDYuNjYzNDEgMTYuMDk2OCA2LjUzMTIyIDE1Ljg1MTIgNi40NTYzM0wxMy42MzYyIDUuNzM2MzNDMTMuMDczIDUuNTQ5NTkgMTIuNTYxMSA1LjIzNDIxIDEyLjE0MSA0LjgxNTE5QzExLjcyMSA0LjM5NjE3IDExLjQwNDMgMy44ODUwMyAxMS4yMTYyIDMuMzIyMzNMMTAuNDg5MiAxLjA4NTMzQzEwLjM3NzMgMC43Njg0NDUgMTAuMTY5NyAwLjQ5NDE0MSA5Ljg5NTE4IDAuMzAwMzI4QzkuNjE4OTEgMC4xMDk4MjggOS4yOTEyNiAwLjAwNzgxMjUgOC45NTU2OCAwLjAwNzgxMjVDOC42MjAxIDAuMDA3ODEyNSA4LjI5MjQ1IDAuMTA5ODI4IDguMDE2MTggMC4zMDAzMjhDNy43MzcxNiAwLjQ5NzM5NSA3LjUyNzI0IDAuNzc3Mjg3IDcuNDE2MTggMS4xMDAzM0w2LjY3OTE4IDMuMzY1MzNDNi40OTE0OSAzLjkxMzMxIDYuMTgxNTUgNC40MTEzOSA1Ljc3Mjg0IDQuODIxODRDNS4zNjQxMyA1LjIzMjI4IDQuODY3MzYgNS41NDQzMyA0LjMyMDE4IDUuNzM0MzNMMi4wODAxOCA2LjQ2MTMzQzEuNzYxNDQgNi41NzQgMS40ODU3NCA2Ljc4MzIyIDEuMjkxNDUgNy4wNTk4OEMxLjA5NzE2IDcuMzM2NTQgMC45OTM5MjggNy42NjY4OSAwLjk5NjEyOCA4LjAwNDk1QzAuOTk4MzI4IDguMzQzMDEgMS4xMDU4NSA4LjY3MTk4IDEuMzAzNzIgOC45NDYwOUMxLjUwMTYgOS4yMjAyIDEuNzggOS40MjU4MSAyLjEwMDE4IDkuNTM0MzNMNC4zMTYxOCAxMC4yNTMzQzQuODgxMSAxMC40NDIzIDUuMzk0NTQgMTAuNzU5NiA1LjgxNjE4IDExLjE4MDNDNS45MjkxNCAxMS4yOTM0IDYuMDM0NyAxMS40MTM3IDYuMTMyMTggMTEuNTQwM0M2LjM5ODAzIDExLjg4MjggNi42MDMwMSAxMi4yNjg0IDYuNzM4MTggMTIuNjgwM0w3LjQ2NjE4IDE0LjkxNDNDNy41NzgyNCAxNS4yMzE3IDcuNzg1OTIgMTUuNTA2NiA4LjA2MDYzIDE1LjcwMTFaTTE3LjgwNDMgMjEuNzgxNUMxOC4wMDc4IDIxLjkyNDggMTguMjUwOSAyMi4wMDEzIDE4LjQ5OTkgMjIuMDAwM0MxOC43NDczIDIyLjAwMTQgMTguOTg5IDIxLjkyNiAxOS4xOTE5IDIxLjc4NDNDMTkuNDAwMiAyMS42MzY1IDE5LjU1NjMgMjEuNDI2NCAxOS42Mzc5IDIxLjE4NDNMMjAuMDA5OSAyMC4wNDEzQzIwLjA4ODUgMTkuODA0IDIwLjIyMTQgMTkuNTg4MyAyMC4zOTc5IDE5LjQxMTNDMjAuNTc0NSAxOS4yMzQyIDIwLjc4OTggMTkuMTAwNyAyMS4wMjY5IDE5LjAyMTNMMjIuMTkyOSAxOC42NDMzQzIyLjQyODQgMTguNTU5NyAyMi42MzI0IDE4LjQwNTMgMjIuNzc2OSAxOC4yMDEzQzIyLjkyMTggMTcuOTk4IDIyLjk5OTcgMTcuNzU0NSAyMi45OTk3IDE3LjUwNDhDMjIuOTk5NyAxNy4yNTUxIDIyLjkyMTggMTcuMDExNyAyMi43NzY5IDE2LjgwODNDMjIuNjIzMiAxNi41OTYxIDIyLjQwNTYgMTYuNDM4NyAyMi4xNTU5IDE2LjM1OTNMMjEuMDExOSAxNS45ODgzQzIwLjc3NDYgMTUuOTA5NyAyMC41NTg4IDE1Ljc3NjggMjAuMzgxOCAxNS42MDAzQzIwLjIwNDcgMTUuNDIzNyAyMC4wNzEyIDE1LjIwODQgMTkuOTkxOSAxNC45NzEzTDE5LjYxMjkgMTMuODA4M0MxOS41MzExIDEzLjU3MDYgMTkuMzc2OCAxMy4zNjQ2IDE5LjE3MTcgMTMuMjE5M0MxOC45NjY2IDEzLjA3NCAxOC43MjEgMTIuOTk2NyAxOC40Njk2IDEyLjk5ODVDMTguMjE4MiAxMy4wMDAzIDE3Ljk3MzggMTMuMDgwOSAxNy43NzA3IDEzLjIyOTFDMTcuNTY3NiAxMy4zNzczIDE3LjQxNjIgMTMuNTg1NSAxNy4zMzc5IDEzLjgyNDNMMTYuOTYzOSAxNC45NzAzQzE2Ljg4NzMgMTUuMjA0NiAxNi43NTc5IDE1LjQxODEgMTYuNTg1OCAxNS41OTQ0QzE2LjQxMzYgMTUuNzcwOCAxNi4yMDMyIDE1LjkwNTIgMTUuOTcwOSAxNS45ODczTDE0LjgwNDkgMTYuMzY1M0MxNC41NjkzIDE2LjQ0OSAxNC4zNjUzIDE2LjYwMzQgMTQuMjIwOSAxNi44MDczQzE0LjA3NTkgMTcuMDEwNyAxMy45OTggMTcuMjU0MiAxMy45OTggMTcuNTAzOEMxMy45OTggMTcuNzUzNSAxNC4wNzU5IDE3Ljk5NyAxNC4yMjA5IDE4LjIwMDNDMTQuMzY5NSAxOC40MDcgMTQuNTc5NCAxOC41NjE3IDE0LjgyMDkgMTguNjQyM0wxNS45NjQ5IDE5LjAxNDNDMTYuMjAzMiAxOS4wOTMyIDE2LjQxOTYgMTkuMjI2OCAxNi41OTY5IDE5LjQwNDVDMTYuNzc0MyAxOS41ODIyIDE2LjkwNzUgMTkuNzk4OSAxNi45ODU5IDIwLjAzNzNMMTcuMzYzOSAyMS4yMDAzQzE3LjQ0NjggMjEuNDM1MSAxNy42MDA4IDIxLjYzODEgMTcuODA0MyAyMS43ODE1WiIgZmlsbD0idXJsKCNwYWludDBfbGluZWFyXzE0MzVfNjE4NzUpIi8+CjxkZWZzPgo8bGluZWFyR3JhZGllbnQgaWQ9InBhaW50MF9saW5lYXJfMTQzNV82MTg3NSIgeDE9IjgiIHkxPSIxLjU2OTZlLTA3IiB4Mj0iMTcuNTExMyIgeTI9IjIxLjk5NTEiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KPHN0b3Agb2Zmc2V0PSIwLjAxNTYyNSIgc3RvcC1jb2xvcj0iIzEwN0M0MSIvPgo8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiNENEVCOTQiLz4KPC9saW5lYXJHcmFkaWVudD4KPC9kZWZzPgo8L3N2Zz4K",style:{position:"absolute",top:9,right:14}});var pF=n(443);const gF=Object(fD.b)(),hF=Object(F.eb)({maxWidth:"320px",padding:"12px",borderRadius:"4px",background:gF.palette.white}),mF=Object(F.eb)({fontSize:16,paddingRight:10,height:16}),bF={buttonStyles:{root:{borderRadius:4,padding:"8px 12px",height:"auto",minWidth:"auto",marginRight:"8px",marginBottom:"2px"},rootHovered:ci.n,rootFocused:ci.n},descriptionStyle:{root:{paddingBottom:"16px",paddingTop:"8px",fontSize:"12px",display:"inline-block"}},linkStyle:{root:{fontSize:"10px"}}},fF={rootHovered:ci.n,rootFocused:ci.n,rootExpanded:ci.n},xF={More:c.a.EllipsisExcel_16,TableDesignIdeas:be.a.TableDesignIdeas_16,WrapText:be.a.WrapText_16},EF=({target:e,title:t,description:n,primaryButtonText:o,secondaryButtonText:r,onPrimaryAction:i,onSecondaryAction:a,menuItems:s=[],onMouseEnter:l,onMouseLeave:c,icon:u="",direction:d=7,gapSpace:p=5,onDismiss:g,createPrimaryBtnRef:h,setInitialFocus:m,ariaLabel:b,giveFeedbackLinkText:f,onGiveFeedbackLinkAction:x})=>{const E=u.length>0,S=d,y={items:s};return R.createElement(Qi.a,{className:hF,onDismiss:g,onMouseEnter:l,onMouseLeave:c,onFocus:l,onBlur:c,target:e,isBeakVisible:!1,directionalHint:S,gapSpace:p,role:"alert",ariaLabel:b,ariaDescribedBy:"proactive-suggestion-description",setInitialFocus:m},R.createElement(At.a,{horizontal:!0,horizontalAlign:"start"},E&&R.createElement(pF.a,{iconName:xF[u],className:mF}),R.createElement("h1",{style:{verticalAlign:"top",textAlign:"start",height:"20px",fontWeight:"600",fontSize:"14px",marginBlock:"0px"}},t)),R.createElement(rs.a,{styles:bF.descriptionStyle,id:"proactive-suggestion-description"},n),R.createElement(Cd.a,{isCircularNavigation:!0,handleTabKey:qo.b.all},R.createElement(At.a,{horizontal:!0,horizontalAlign:"start"},R.createElement(Wd.a,{styles:bF.buttonStyles,onClick:i,componentRef:h},o),R.createElement(pr.a,{styles:bF.buttonStyles,onClick:a},r),!!s.length&&R.createElement(Uo.a,{title:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.OverflowWellLabel),id:"proactive-suggestion-more",menuProps:y,menuIconProps:{iconName:xF.More},style:{marginInlineStart:"auto"},styles:fF,ariaLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.OverflowWellLabel)})),!!f&&!!x&&R.createElement(Ut.a,{onClick:x,styles:bF.linkStyle},f)))};function SF(e,t,n,o,r,i,a,s,l,c,u,d,p,g,h,m,b,f,x,E){k.render(R.createElement(EF,{target:e,title:n,description:o,primaryButtonText:r,secondaryButtonText:i,onPrimaryAction:a,onSecondaryAction:s,menuItems:l,onMouseEnter:c,onMouseLeave:u,icon:d,direction:p,gapSpace:g,onDismiss:h,createPrimaryBtnRef:m,setInitialFocus:b,ariaLabel:f,giveFeedbackLinkText:x,onGiveFeedbackLinkAction:E}),t)}const yF=Object(fD.b)(),CF=Object(F.eb)({maxWidth:"320px",padding:"12px",borderRadius:"4px",background:yF.palette.white}),vF=({target:e,offset:t})=>{const[n,o]=R.useState();return R.useEffect(()=>{function n(){o({left:e.getBoundingClientRect().right-t,top:e.getBoundingClientRect().bottom-t})}n();const r=new Og;return r.register([e],n),()=>r.dispose()},[e,t]),R.createElement(Qi.a,{className:CF,coverTarget:!0,directionalHint:Se.a.bottomRightEdge,target:n,isBeakVisible:!1},"Proactive Suggestion Debug Pane",R.createElement("table",null,R.createElement("tbody",null,R.createElement("tr",null,R.createElement("td",null,"If LPP is blocking triggers, you may need to clear local storage"),R.createElement("td",null,R.createElement(Wd.a,{onClick:()=>{localStorage.clear(),location.reload()},text:"Clear local storage"}))))))};function RF(e,t,n){k.render(R.createElement(vF,{target:t,offset:n}),e)}const kF={},TF=Object(Rc.a)([e=>e.statusBarModels||kF,(e,t)=>t.id],(e,t)=>e[t]),_F=Object(Rc.a)([TF],e=>null==e?void 0:e.controls),wF=Object(Rc.a)([TF],e=>(null==e?void 0:e.endRegionPrimaryScreenControlsIds)||[]),DF=Object(Rc.a)([TF],e=>(null==e?void 0:e.scalingSteps)||[]),PF=Object(Rc.a)([TF],e=>(null==e?void 0:e.appliedScalingSteps)||{}),IF=Object(Rc.a)([TF],e=>(null==e?void 0:e.appliedScalingStepsCount)||0),FF=Object(Rc.a)([TF],e=>null==e?void 0:e.zoomControlModel),BF=(e,t,n,o)=>{const r=Object(Tc.h)(t,n,e,o);switch(r.type){case"AppButtonProps":case"AppToggleButtonProps":break;case"AppLabelProps":return _object_spread_props(_object_spread({},r),{type:"AppStatusTextProps"});case"AppFlyoutAnchorProps":return _object_spread_props(_object_spread({},r),{downChevronIcon:Object(Ev.a)().downChevron.icon8});case"AppSliderProps":return _object_spread({},r);case"AppComboBoxProps":return _object_spread_props(_object_spread({},r),{downChevronIcon:Object(Ev.a)().downChevron.icon8});default:throw new Error(`The control of type ${r.type} is not a valid StatusBar control`)}return _object_spread({},r)},MF=Object(Je.a)((e,t,n,o)=>({id:e.id,type:"StatusBarZoomControlProps",decreaseZoomButtonProps:BF(e.decreaseZoomControlId,t,n,o),zoomLabelProps:BF(e.zoomLabelId,t,n,o),zoomSliderProps:BF(e.zoomSliderId,t,n,o),zoomLevelButtonProps:BF(e.zoomLevelButtonId,t,n,o),increaseZoomButtonProps:BF(e.increaseZoomControlId,t,n,o),showSlider:e.showSlider})),jF=Object(Rc.a)([_F,FF,kc.V,kc.u,kc.cb],(e,t,n,o,r)=>OF(e,t,n,o,r)),OF=Object(Je.a)((e,t,n,o,r)=>{const i={left:[],center:[],right:[]};return e&&Object.keys(e).forEach(a=>{i[a]=((e,t,n,o,r)=>e?e.filter(e=>t&&t.id===e?!t.hidden:!Object(kc.Eb)(n,o,e)).map(e=>t&&t.id===e?MF(t,n,o,r):BF(e,n,o,r)):[])(e[a],t,n,o,r)}),i}),LF=Object(Rc.a)([_F,FF],(e,t)=>e?t?[t.decreaseZoomControlId,t.zoomLabelId,t.zoomSliderId,t.zoomLevelButtonId,t.increaseZoomControlId].concat(...Object.keys(e).map(t=>e[t])).filter(e=>e!==t.id):[].concat(...Object.keys(e).map(t=>e[t])):[]),AF=Object(Rc.a)([LF,kc.u],(e,t)=>{const n={};return e.forEach(e=>{const o=Object(kc.p)(t,e);n[e]=o.modelType}),n}),NF=Object(Rk.strEnum)(["ExcelViewerToolbar","ExcelStatusBar","ExcelPreviewToolbar"]),WF=(zF=Zv.a,{getStatusBarControlsMap:e=>AF(zF.getState(),{id:e})});var zF,HF=n(93),VF=n(78),UF=n(63),GF=n(1201);function qF(e,t){return Object(dI.a)(My.w,{id:e,controls:t})}function QF(e,t){return Object(dI.a)(My.y,{statusBarId:e,controlId:t})}function KF(e,t){return Object(dI.a)(My.Qb,{statusBarId:e,scalingSteps:t})}function JF(e,t,n){return Object(dI.a)(My.Nc,{statusBarId:e,step:t,removeNotAdd:n})}function YF(e={},t){if(null===e)return{};switch(t.type){case My.w:{const{id:n,controls:o}=t.payload;return n&&o?_object_spread_props(_object_spread({},e),{[n]:{controls:o}}):e}case My.x:{const{statusBarId:n,region:o,controlId:r}=t.payload;if(n&&e[n]&&o&&r){const t=_object_spread_props(_object_spread({},e[n].controls),{[o]:[...e[n].controls[o],r]});return _object_spread_props(_object_spread({},e),{[n]:_object_spread_props(_object_spread({},e[n]),{controls:t})})}return e}case My.y:{const{statusBarId:n,controlId:o}=t.payload;if(n&&e[n]&&o){const t=[...e[n].endRegionPrimaryScreenControlsIds||[],o];return _object_spread_props(_object_spread({},e),{[n]:_object_spread_props(_object_spread({},e[n]),{endRegionPrimaryScreenControlsIds:t})})}return e}case My.Qb:{const{statusBarId:n,scalingSteps:o}=t.payload;return n&&e[n]&&o?_object_spread_props(_object_spread({},e),{[n]:_object_spread_props(_object_spread({},e[n]),{scalingSteps:o})}):e}case My.E:{const{statusBarId:n,zoomControlModel:o}=t.payload;return n&&e[n]&&o?_object_spread_props(_object_spread({},e),{[n]:_object_spread_props(_object_spread({},e[n]),{zoomControlModel:o})}):e}case My.Nc:{const{statusBarId:o,step:r,removeNotAdd:i}=t.payload;if(o&&e[o]&&r){var n;let t=e[o].appliedScalingSteps||{};(Array.isArray(r)?r:[r]).forEach(e=>{const{type:n,controlId:o}=e,r=t[n]||{},{[o]:a}=r,s=_object_without_properties(r,[o].map(_to_property_key));i||(s[o]=!0),t=_object_spread_props(_object_spread({},t),{[n]:s})});const a=null!==(n=e[o].appliedScalingStepsCount)&&void 0!==n?n:0;return _object_spread_props(_object_spread({},e),{[o]:_object_spread_props(_object_spread({},e[o]),{appliedScalingSteps:t,appliedScalingStepsCount:a+(i?-1:1)})})}return e}default:return e}}function ZF(){jy.b.register("statusBarModels",YF)}var $F=n(1279);function XF(e){return[Object(HF.a)($F.a.GiveFeedbackToMicrosoft,e.get(ExcelRibbonStringsEnum.GiveFeedbackToMicrosoft),{iconSet:{default:be.a.Feedback_20}}),Object(HF.a)($F.a.ShowWACSessionIdDialog,e.get(ExcelRibbonStringsEnum.About),{iconSet:{default:be.a.Info_20}}),Object(HF.a)($F.a.ShowTermsOfUse,e.get(ExcelRibbonStringsEnum.TermsOfUse),{iconSet:{default:be.a.Info_20}}),Object(HF.a)($F.a.ThirdPartyNotices,e.get(ExcelRibbonStringsEnum.ThirdPartyNotices),{iconSet:{default:be.a.Info_20}}),Object(HF.a)($F.a.PrivacyStatement,e.get(ExcelRibbonStringsEnum.Privacy),{iconSet:{default:be.a.ProtectForm_20}}),Object(HF.a)($F.a.ShowTrustCenter,e.get(ExcelRibbonStringsEnum.TrustCenter),{iconSet:{default:be.a.ProtectForm_20}}),Object(VF.a)($F.a.MoreViewerOptionsFlyoutAnchor,e.get(ExcelRibbonStringsEnum.SpinnerIncrementButtonAriaLabel),{iconSet:{default:c.a.HintBarEllipses_20},hideChevron:!0,hideLabel:!0,menuModel:Object(UF.a)([Object(UF.b)([$F.a.GiveFeedbackToMicrosoft,$F.a.ShowWACSessionIdDialog,$F.a.ShowTermsOfUse,$F.a.ThirdPartyNotices,$F.a.PrivacyStatement,$F.a.ShowTrustCenter])])})]}const eB=Object(zD.a)("StatusBar:initializeViewerToolbarInStore",()=>{var e;ZF(),Object(cC.a)([Object(ZP.a)((e=ExcelRibbonStringsManager,[Object(GF.a)($F.a.ShowDocumentLabel,"","DocumentName",{iconSet:{default:be.a.Excel_32}}),Object(HF.a)($F.a.UndoInToolbar,e.get(ExcelRibbonStringsEnum.Undo),{iconSet:{default:g.a.Undo_20},customTooltip:e.get(ExcelRibbonStringsEnum.Undo),hideLabel:!0}),Object(HF.a)($F.a.RedoInToolbar,e.get(ExcelRibbonStringsEnum.Redo),{iconSet:{default:c.a.Redo_20},customTooltip:e.get(ExcelRibbonStringsEnum.Redo),hideLabel:!0}),Object(HF.a)($F.a.ShowOpenInAppInEditMode,e.get(ExcelRibbonStringsEnum.Open),{iconSet:{default:be.a.ExcelMonoline_20}}),Object(HF.a)($F.a.ShowOpenInAppDialog,e.get(ExcelRibbonStringsEnum.Edit),{iconSet:{default:be.a.ChangesPaneEdit_20}}),...XF(e)])),...Object(x.getBooleanFeatureGate)("Microsoft.Office.Excel.MiniWACInEditMode",!1)?[qF(NF.ExcelViewerToolbar,{left:[$F.a.ShowDocumentLabel],center:[],right:[$F.a.UndoInToolbar,$F.a.RedoInToolbar,$F.a.ShowOpenInAppDialog,$F.a.ShowOpenInAppInEditMode,$F.a.MoreViewerOptionsFlyoutAnchor]})]:[qF(NF.ExcelViewerToolbar,{left:[$F.a.ShowDocumentLabel],center:[],right:[$F.a.ShowOpenInAppDialog,$F.a.MoreViewerOptionsFlyoutAnchor]})]])}),tB=R.memo(({debounceTimeoutMs:e,children:t})=>{const n=R.useRef(),[,o]=R.useReducer(e=>e+1,0),r=R.useRef();return void 0===r.current?r.current=t:r.current!==t&&(void 0!==n.current&&(window.clearTimeout(n.current),n.current=void 0),n.current=window.setTimeout(()=>{n.current=void 0,r.current=t,o()},e)),R.createElement(R.Fragment,null,r.current)});tB.displayName="DebouncedRenderer";const nB={display:"inline-block",verticalAlign:"top",whiteSpace:"nowrap"},oB=Object(Jo.c)(()=>Object(F.db)({outerContainer:{position:"relative",width:"100%"},innerContainerHidden:_object_spread_props(_object_spread({},nB),{position:"absolute",top:0,left:0,visibility:"hidden",width:"min-content"}),innerContainerDisplayed:_object_spread_props(_object_spread({},nB),{minWidth:"100%"})})),rB=(e,t)=>{var n;const o=t.current;if(!o)return;const r=e.filter(e=>!(e.target!==o||!e.contentBoxSize))[0];return Math.floor(null==r||null===(n=r.contentRect)||void 0===n?void 0:n.width)},iB=new Ed.a,aB=R.memo((function({steps:e,onScalingStepDispatch:t,appliedScalingStepsCount:n,children:o}){const r=R.useRef(),i=R.useRef(),a=R.useRef(null),s=R.useRef(null),l=R.useRef({}),c=R.useRef(!1),u=R.useRef(!1),d=R.useRef(),p=R.useRef(),g=R.useRef(n);g.current=n;const h=R.useCallback(()=>{if(d.current&&p.current)if(l.current[g.current]=p.current,p.current>d.current){if(g.current===e.length)return;const n=g.current+1;c.current=!0,t(n,e[n-1],!1)}else{if(0===g.current)return;const n=g.current-1,o=l.current[n];(!o||o<d.current)&&(c.current=!0,t(n,e[n],!0))}},[e,t]),m=R.useRef(),b=R.useRef(),f=R.useRef(n);R.useEffect(()=>(f.current!==g.current&&(m.current=window.requestAnimationFrame(()=>{b.current=window.setTimeout(()=>{c.current=!1,h()},0)})),f.current=n,()=>{m.current&&window.cancelAnimationFrame(m.current),b.current&&window.clearTimeout(b.current)}),[h,n]);const x=R.useMemo(()=>iB.debounce((function(){u.current=!1,h()}),100,{leading:!1}),[h]),E=R.useCallback(e=>{const t=rB(e,s);void 0!==t&&t!==d.current&&(d.current=t,u.current=!0,x())},[x]),S=R.useCallback(e=>{const t=rB(e,a);void 0!==t&&(p.current=t,u.current||(c.current||(l.current={}),h()))},[h]);R.useEffect(()=>(i.current=new ResizeObserver(iB.throttle(E,20,{leading:!0})),r.current=new ResizeObserver(S),a.current&&s.current&&(i.current.observe(s.current),r.current.observe(a.current)),()=>{r.current&&r.current.disconnect(),i.current&&i.current.disconnect()}),[E,S]);const y=oB();return R.createElement("div",{ref:s,className:y.outerContainer},R.createElement(tB,{debounceTimeoutMs:50},R.createElement("div",{className:y.innerContainerDisplayed},o)),R.createElement("div",{ref:a,className:y.innerContainerHidden},o))})),sB={whiteBackground:ac.a.white,defaultBackground:ac.a.gray20,hoverBackground:ac.a.gray30,pressedBackground:ac.a.gray50,selectedBackground:ac.a.gray40,defaultBorder:ac.a.gray40,focusedBorder:ac.a.gray130,text:ac.a.gray130,textDisabled:ac.a.gray90,previewBackground:ac.a.gray96},lB=e=>Object(ix.c)()?{whiteBackground:e.palette.white,defaultBackground:e.palette.neutralLighterAlt,hoverBackground:e.palette.neutralLighter,pressedBackground:e.palette.neutralQuaternaryAlt,selectedBackground:e.palette.neutralLight,defaultBorder:e.palette.neutralLight,focusedBorder:e.palette.neutralPrimaryAlt,text:e.palette.neutralPrimaryAlt,textDisabled:e.palette.neutralTertiaryAlt,previewBackground:_o.a.colorNeutralBackground3}:sB,cB={label:{fontSize:F.k.small,fontWeight:F.l.regular,fontFamily:'"Segoe UI", "Segoe UI Web", Arial, Verdana, sans-serif',cursor:"default",textAlign:"center",userSelect:"none",whiteSpace:"nowrap",overflow:"visible",textOverflow:"unset",lineHeight:16,margin:"0 4px",paddingTop:0,paddingBottom:0,height:"100%",display:"flex",alignItems:"center"}},uB={root:{height:40,paddingLeft:9,paddingRight:9},label:{lineHeight:20}},dB={width:14,height:14,lineHeight:14,alignItems:"center"},pB={width:16,height:16,lineHeight:16},gB=Object(Jo.c)((e,t,n)=>{const o=lB(e),r=_object_spread_props(_object_spread({},cB),{root:{height:24,minWidth:40,color:o.text,border:"1px solid transparent",borderRadius:0,boxSizing:"border-box",paddingLeft:4,paddingRight:4,paddingTop:0,paddingBottom:0,backgroundColor:"transparent"},rootHovered:{borderColor:"transparent",backgroundColor:o.hoverBackground},rootPressed:{backgroundColor:o.pressedBackground},rootChecked:{backgroundColor:o.selectedBackground},rootDisabled:{backgroundColor:o.defaultBackground,color:o.textDisabled},rootFocused:{borderColor:o.focusedBorder,backgroundColor:o.selectedBackground},rootCheckedHovered:{borderColor:"transparent",backgroundColor:o.hoverBackground},icon:_object_spread({},dB),menuIcon:{height:8,lineHeight:8,width:8,marginLeft:0,marginRight:0}});return Object(F.I)(r,n?uB:{},n?{icon:pB}:{},t)});var hB=n(526);const mB=(e,t)=>R.createElement("span",{className:"ms-Button-label "+hB.d,id:t},e);var bB=n(707);const fB=(e,t)=>{e.isJumbo=!!t};var xB=n(2469),EB=n(1588);const SB={icon:{width:12,height:12,lineHeight:12}},yB={root:{paddingLeft:0,paddingRight:0},label:{justifyContent:"center",minWidth:30,marginLeft:0,marginRight:0}},CB={label:{minWidth:32,justifyContent:"center"}},vB=Object(ut.a)({icon:{width:"12px",height:"12px",lineHeight:"12px"}}),RB=Object(ut.a)({label:{minWidth:"32px",justifyContent:"center"}}),kB=Object(ut.a)({baseIcon:_object_spread({width:"14px",lineHeight:"14px",alignItems:"center"},pt.a.margin("0px")),jumboIcon:_object_spread({width:"16px",lineHeight:"16px"},pt.a.margin("0px"))}),TB=_object_spread({},pt.a.borderColor(_o.a.legacy_black)),_B=Object(xB.a)({height:"24px",["& ."+ci.C]:_object_spread({},ui.p),["& ."+hB.d]:_object_spread_props(_object_spread({},pt.a.margin("0px","4px")),{textAlign:"center",userSelect:"none",whiteSpace:"nowrap",textOverflow:"unset",display:"flex",alignItems:"center"}),[""+ui.a]:_object_spread_props(_object_spread({},Object(F.S)(),ui.d,ui.e,ui.c),{":hover":{backgroundColor:"HighlightText !important",color:"Highlight !important"},":hover:active":{backgroundColor:"HighlightText !important",color:"Highlight !important"},":focus":_object_spread_props(_object_spread({},pt.a.borderColor("transparent")),{backgroundColor:"transparent !important",outlineColor:"Highlight",height:"22px",alignSelf:"center"})})}),wB=Object(ut.a)({root:_object_spread(_object_spread_props(_object_spread({backgroundColor:`var(--1JS-statusBarButton__backgroundColor, ${_o.a.colorNeutralBackground3})`,color:`var(--1JS-statusBarButton__color, ${_o.a.colorNeutralForeground3})`,fontWeight:_o.a.fontWeightRegular,fontSize:_o.a.fontSizeBase200},pt.a.borderColor("transparent")),{minWidth:"var(--1JS-statusBarButton__minWidth, 40px)",paddingLeft:"var(--1JS-statusBarButton__paddingLeft)",paddingRight:"var(--1JS-statusBarButton__paddingRight)",marginLeft:"var(--1JS-statusBarButton__marginLeft)",marginRight:"var(--1JS-statusBarButton__marginRight)",marginBottom:"var(--1JS-statusBarButton__marginBottom)",marginTop:"var(--1JS-statusBarButton__custom-marginTop)",":hover":_object_spread_props(_object_spread({},pt.a.borderColor("transparent")),{backgroundColor:`var(--1JS-statusBarButton__hoverBackgroundColor, ${_o.a.colorNeutralBackground3Hover})`,color:`var(--1JS-statusBarButton__color, ${_o.a.colorNeutralForeground3Hover})`}),":hover:active":_object_spread_props(_object_spread({},pt.a.borderColor("transparent")),{backgroundColor:`var(--1JS-statusBarButton__pressedBackgroundColor, ${_o.a.colorNeutralBackground3Pressed})`,color:`var(--1JS-statusBarButton__color, ${_o.a.colorNeutralForeground3Pressed})`}),":active":{backgroundColor:`var(--1JS-statusBarButton__pressedBackgroundColor, ${_o.a.colorNeutralBackground3Pressed})`},":focus":_object_spread_props(_object_spread({},pt.a.borderColor(_o.a.legacy_black)),{backgroundColor:`var(--1JS-statusBarButton__focusBackgroundColor, ${_o.a.legacy_neutralLight})`}),":focus-visible":TB}),Object(EB.a)(TB)),disabled:{pointerEvents:"none",backgroundColor:_o.a.colorTransparentBackground,color:_o.a.colorNeutralForegroundDisabled,":focus":{backgroundColor:_o.a.colorTransparentBackground+" !important"},[""+ui.a]:_object_spread({},ui.f)}}),DB=Object(ut.a)({root:{height:"40px",paddingLeft:"9px",paddingRight:"9px"},label:{lineHeight:20}}),PB=e=>e>=0?e+"px":void 0,IB=e=>{const t=_B(),n=wB(),o=DB(),r=kB(),i=Object(ui.r)(),a=(e=>{var t,n,o,r,i,a,s,l,c,u,d,p,g;const h=wB();return e.root.style=_object_spread_props(_object_spread({},e.root.style),{"--1JS-statusBarButton__backgroundColor":null===(t=e.styles)||void 0===t||null===(t=t.root)||void 0===t?void 0:t.backgroundColor,"--1JS-statusBarButton__color":null===(n=e.styles)||void 0===n||null===(n=n.root)||void 0===n?void 0:n.color,"--1JS-statusBarButton__hoverBackgroundColor":null===(o=e.styles)||void 0===o||null===(o=o.rootHovered)||void 0===o?void 0:o.backgroundColor,"--1JS-statusBarButton__color":null===(r=e.styles)||void 0===r||null===(r=r.rootHovered)||void 0===r?void 0:r.color,"--1JS-statusBarButton__focusBackgroundColor":null===(i=e.styles)||void 0===i||null===(i=i.rootFocused)||void 0===i?void 0:i.backgroundColor,"--1JS-statusBarButton__pressedBackgroundColor":null===(a=e.styles)||void 0===a||null===(a=a.rootPressed)||void 0===a?void 0:a.backgroundColor,"--1JS-statusBarButton__paddingLeft":PB(null===(s=e.styles)||void 0===s||null===(s=s.root)||void 0===s?void 0:s.paddingLeft),"--1JS-statusBarButton__paddingRight":PB(null===(l=e.styles)||void 0===l||null===(l=l.root)||void 0===l?void 0:l.paddingRight),"--1JS-statusBarButton__minWidth":PB(null===(c=e.styles)||void 0===c||null===(c=c.root)||void 0===c?void 0:c.minWidth),"--1JS-statusBarButton__marginLeft":PB(null===(u=e.styles)||void 0===u||null===(u=u.root)||void 0===u?void 0:u.marginLeft),"--1JS-statusBarButton__marginRight":PB(null===(d=e.styles)||void 0===d||null===(d=d.root)||void 0===d?void 0:d.marginRight),"--1JS-statusBarButton__marginBottom":PB(null===(p=e.styles)||void 0===p||null===(p=p.root)||void 0===p?void 0:p.marginBottom),"--1JS-statusBarButton__custom-marginTop":PB(null===(g=e.styles)||void 0===g||null===(g=g.root)||void 0===g?void 0:g.marginTop)}),h.root})(e),s=e.isJumbo,l=e.applyZoomIconStyles,c=vB();e.root.className=Object(Rt.a)("ms-ButtonNext","ms-Button",t,a,e.disabled&&n.disabled,s&&o.root,s&&o.label,e.root.className),e.icon&&(e.icon.className=Object(Rt.a)("ms-ButtonNext-icon",r.baseIcon,s&&r.jumboIcon,e.disabled&&i.base,l&&c.icon,e.icon.className))},FB=e=>(IB(e),Object(ln.b)(e),e),BB=R.memo(R.forwardRef((e,t)=>{const n=((e,t)=>{const{dataAutomationType:n,label:o,isJumbo:r,applyZoomIconStyles:i}=e,a=Object(bB.a)(),s=Object(sn.a)(_object_spread_props(_object_spread({},e),{children:mB(o,a),dataAutomationType:null!=n?n:"StatusBarButton"}),t);return fB(s,r),((e,t)=>{e.applyZoomIconStyles=!!t})(s,i),s.styles=e.styles,s})(e,t);return FB(n),Object(an.a)(n)}));BB.displayName="next/StatusBarButton";const MB=()=>{const e=R.useContext(Hm.a);return jB(e)},jB=e=>Object(Zf.a)(e,Zf.f.fluentV9StatusBarButtonEnabled)||Object(Zf.a)(e,Zf.f.fluentV9StatusBarButtonInWordPPTVisioEnabled)&&!Object(Zf.a)(e,Zf.f.disableFluentV9StatusBar),OB=R.forwardRef((e,t)=>{const{styles:n,type:o,isJumbo:r}=e,i=_object_without_properties(e,["styles","type","isJumbo"]);return R.createElement(we.a,null,e=>R.createElement(Ko.a,_object_spread_props(_object_spread({ref:t,type:"AppButtonProps",noDomId:!0},i),{styles:gB(e,n,r)})))}),LB=R.forwardRef((e,t)=>{const n=MB();return e.label||e.icon?n?R.createElement(BB,_object_spread_props(_object_spread({},e),{ref:t})):R.createElement(OB,_object_spread({ref:t},e)):null});LB.displayName="StatusBarButton";var AB=n(2447),NB=n(2449),WB=n(1138),zB=n(2516),HB=n(2517),VB=n(1176),UB=n(1789),GB=n(829);function qB(e,t,n,o,r){const i=isNaN(n)?void 0:n,a=isNaN(o)?void 0:o;if(Object(NB.a)(e))return((e,t,n,o)=>R.createElement(we.a,null,r=>R.createElement(zB.a,_object_spread_props(_object_spread({positionInSet:n,setSize:o},Object(UB.a)(e,t)),{keytipProps:Object(GB.a)(e.keytipProps),shouldTakeFocus:void 0===e.shouldTakeFocus||e.shouldTakeFocus,lang:e.lang,enableFocusOnHover:!1,styles:Object(HB.a)(r,Object(VB.b)(r,e.styles)),dataAutomationType:"StatusBarCompoundButton"}))))(e,t,i,a);throw new Error(`The control of type ${e.type} is not valid in a StatusBar menu`)}const QB=Object(Jo.c)((e,t,n)=>{const o=gB(e);return Object(F.I)(o,n?uB:{},t)});var KB=n(2125),JB=n(2126),YB=n(2615),ZB=n(826);const $B=Object(ut.a)({expanded:_object_spread_props(_object_spread({backgroundColor:"var(--1JS-statusBarButton__expandedBackgroundColor)"},pt.a.borderColor("transparent")),{[""+ui.a]:{backgroundColor:"Highlight !important",color:"ButtonFace !important","& path":{fill:"ButtonFace !important"},":hover":{"& path":{fill:"Highlight !important"}}}})});var XB=n(1165);const eM=R.memo(R.forwardRef((e,t)=>{const n=((e,t)=>{const{dataAutomationType:n,label:o,isJumbo:r,applyZoomIconStyles:i,hideChevron:a,hideLabel:s}=e,l=Object(bB.a)(),c=Object(XB.a)(_object_spread_props(_object_spread({},e),{children:mB(o,l),hideLabel:s||""===o,dataAutomationType:null!=n?n:"StatusBarMenuButton"}),t);return a&&void 0!==c.menuIcon&&(c.menuIcon=void 0),fB(c,r),((e,t)=>{e.applyZoomIconStyles=!!t})(c,i),c.styles=e.styles,c})(e,t);return(e=>{const t=(e=>{var t,n;const o=$B(),r=e.menuHidden?void 0:null!==(t=null===(n=e.styles)||void 0===n||null===(n=n.rootExpanded)||void 0===n?void 0:n.backgroundColor)&&void 0!==t?t:_o.a.colorNeutralBackground3Pressed;return e.root.style=_object_spread_props(_object_spread({},e.root.style),{backgroundColor:r}),e.menuHidden?void 0:o.expanded})(e);e.root.className=Object(Rt.a)(t,!e.menuHidden&&"is-expanded",e.root.className),IB(e),Object(Qr.a)(e)})(n),Object(Jr.a)(n)}));eM.displayName="next/StatusBarMenuButton";const tM=R.memo(R.forwardRef((e,t)=>{const n=((e,t)=>{const{dataAutomationType:n,shadowRenderMenu:o,customMenuItemStyles:r,directionalHint:i,isJumbo:a,location:s}=e,l=R.useContext(ev.b),c=Object(YB.a)(_object_spread_props(_object_spread({},e),{dataAutomationType:null!=n?n:"StatusBarFlyoutAnchor",persistMenu:!0,preventCalloutDismissOnScroll:!0,shadowRenderMenu:Object(ZB.b)(o,l.isMeasured),controlInMenuRendererFunction:rM(r),directionalHint:a&&s===Jc.b.ViewerToolbar?Se.a.bottomLeftEdge:s===Jc.b.StatusBar?Se.a.topLeftEdge:i}),t);return c.components&&(c.components.menuButton=eM,c.menuButton[qr.a]=eM),c})(_object_spread({},e),t);return Object(KB.a)(n)}),JB.a);tM.displayName="next/StatusBarFlyoutAnchor";const nM=R.forwardRef((e,t)=>MB()?R.createElement(tM,_object_spread_props(_object_spread({},e),{ref:t})):R.createElement(oM,_object_spread({ref:t},e))),oM=R.forwardRef((e,t)=>{const{styles:n,isJumbo:o,customMenuItemStyles:r}=e,i=_object_without_properties(e,["styles","isJumbo","customMenuItemStyles"]);return e.label||e.icon?R.createElement(we.a,null,e=>R.createElement(dl.a,_object_spread_props(_object_spread({ref:t},i),{styles:QB(e,n,o),controlInMenuRendererFunction:rM(r),directionalHintFixed:!!o}))):null}),rM=Object(Jo.c)(e=>t=>{const{controlProps:n,location:o,useFullDescriptionLabelOnly:r}=t;return n.map(t=>{const n=_object_spread_props(_object_spread({},t),{location:o});if(Object(AB.a)(n))return Object(Fp.a)(Object(Ip.a)(n.id,n.location),n,iM(e),void 0,void 0,r);if(Object(Qk.a)(n))return Object(Dm.a)(n,iM(e),void 0,r);if(Object(NB.a)(n)){const e=_object_spread_props(_object_spread({},n),{styles:Object(F.db)(aM,n.styles)});return Object(WB.b)(e,qB)}throw new Error(`The control of type ${n.type} is not valid in a Peripheral Menu`)})}),iM=Object(Jo.c)(e=>Object(F.db)({icon:{width:16,height:16,lineHeight:16}},e)),aM=Object(F.db)({root:{minHeight:60,padding:"4px 12px"},icon:{width:32,height:32,lineHeight:32}}),sM=Object(Jo.c)((e,t)=>Object(F.I)({root:_object_spread(_object_spread_props(_object_spread({},dB),{paddingRight:0}),t?pB:{})},e.styles)),lM=Object(Jo.c)((e,t,n)=>{const o=lB(e),r=_object_spread_props(_object_spread({},cB),{root:{height:24,boxSizing:"border-box",border:"1px solid transparent",color:o.text,paddingLeft:4,paddingRight:4,paddingTop:0,paddingBottom:0,backgroundColor:"transparent",borderRadius:0}});return Object(F.I)(r,n?uB:{},t)});var cM=n(1507),uM=n(1174);const dM=Object(ut.a)({base:_object_spread({height:"24px",display:"flex",backgroundColor:_o.a.colorNeutralBackground3},pt.a.borderRadius(_o.a.borderRadiusNone),pt.a.padding(_o.a.spacingVerticalNone,_o.a.spacingHorizontalS))}),pM=Object(ut.a)({base:_object_spread_props(_object_spread({color:_o.a.colorNeutralForeground3,fontWeight:_o.a.fontWeightRegular,fontSize:_o.a.fontSizeBase200},pt.a.margin(_o.a.spacingVerticalNone,_o.a.spacingHorizontalXS)),{textAlign:"center",userSelect:"none",whiteSpace:"nowrap",textOverflow:"unset"})}),gM=Object(ut.a)({base:{width:"14px",alignSelf:"center",lineHeight:"14px",paddingRight:"0px"}}),hM=Object(ut.a)({wrapper:{height:"40px"},label:{alignSelf:"center"},icon:{width:"16px",lineHeight:"16px"}});var mM=n(1483),bM=n(1284);const fM=R.memo(R.forwardRef((e,t)=>{const n=((e,t)=>{const{isJumbo:n}=e,o=((e,t)=>{var n,o;const{announcedProps:r={},ariaLiveAssertiveness:i,forId:a,htmlFor:s,children:l,label:c}=e,u=R.useRef(null),d=Object(bM.a)(e,u),p=Object(mM.a)(_object_spread_props(_object_spread({},e),{htmlFor:null!=a?a:s,children:null!=l?l:c,"aria-hidden":!0}),t);return null!==(n=r["aria-live"])&&void 0!==n||(r["aria-live"]=i||void 0),null!==(o=r.message)&&void 0!==o||(r.message=c),_object_spread_props(_object_spread({},e,p),{announcedProps:r,labelWrapperRef:d})})(_object_spread({},e),t);return fB(o,n),o})(e,t);return(e=>{const t=e.isJumbo,n=dM(),o=pM(),r=gM(),i=hM();e.root.className=Object(Rt.a)(o.base,t&&i.label,e.root.className),e.labelWrapperClassName=Object(Rt.a)(n.base,t&&i.wrapper,e.labelWrapperClassName),e.iconProps&&(e.iconProps.className=Object(Rt.a)(r.base,t&&i.icon,e.iconProps.className)),(e=>{(e=>{const t=Object(cM.b)();e.labelWrapperClassName=Object(Rt.a)(t.labelWrapper,e.labelWrapperClassName),e.iconProps&&(e.iconProps.className=Object(Rt.a)(t.icon,e.iconProps.className))})(e),Object(uM.a)(e)})(e)})(n),(e=>{const{announcedProps:t,iconProps:n,id:o,labelWrapperClassName:r,labelWrapperRef:i}=e;return Object(vt.a)(e),Object(Ct.b)("div",{className:r,ref:i,children:[n&&Object(Ct.a)(fe.a,_object_spread({},n)),Object(Ct.a)(Sd.a,_object_spread({},t)),Object(Ct.b)(e.root,{"data-unique-id":o,children:[e.root.children,e.required&&Object(Ct.a)(e.required,{})]})]})})(n)}));fM.displayName="next/StatusBarLabel";const xM=R.forwardRef((e,t)=>{const{styles:n,type:o,iconProps:r,isJumbo:i}=e,a=_object_without_properties(e,["styles","type","iconProps","isJumbo"]);return R.createElement(we.a,null,e=>R.createElement(ex,_object_spread_props(_object_spread({ref:t,type:"AppStatusTextProps"},a),{styles:lM(e,n,i),iconProps:r?_object_spread_props(_object_spread({},r),{styles:sM(r,i)}):void 0})))}),EM=R.forwardRef((e,t)=>{const n=MB();return e.label||e.iconProps?n?R.createElement(fM,_object_spread({ref:t},e)):R.createElement(xM,_object_spread({ref:t},e)):null});EM.displayName="StatusBarLabel";const SM=Object(Jo.c)((e,t,n)=>{const o=gB(e);return Object(F.I)(o,n?uB:{},t)}),yM=Object(ut.a)({root:{paddingTop:"0px",paddingBottom:"0px"},disabled:{[""+ui.a]:_object_spread_props(_object_spread({},ui.f),{":focus":_object_spread({},ui.f)})}}),CM=Object(ut.a)({checked:_object_spread_props(_object_spread({backgroundColor:"var(--1JS-statusBarButton__expandedBackgroundColor)"},pt.a.borderColor("transparent")),{[""+ui.a]:{backgroundColor:"Highlight !important","& path":{fill:"ButtonFace"}}})}),vM=R.memo(R.forwardRef((e,t)=>{const n=((e,t)=>{const{dataAutomationType:n,label:o,isJumbo:r,hideLabel:i}=e,a=Object(bB.a)(),s=Object(Lr.a)(_object_spread_props(_object_spread({},e),{children:mB(o,a),hideLabel:i||""===o,dataAutomationType:null!=n?n:"StatusBarToggleButton"}),t);return fB(s,r),s})(_object_spread({},e),t);return n.styles=e.styles,(e=>{const t=yM(),n=(e=>{var t,n;const o=CM(),r=e.checked?null!==(t=null===(n=e.styles)||void 0===n||null===(n=n.rootExpanded)||void 0===n?void 0:n.backgroundColor)&&void 0!==t?t:_o.a.colorNeutralBackground3Pressed:void 0;return e.root.style=_object_spread_props(_object_spread({},e.root.style),{backgroundColor:r}),e.checked?o.checked:void 0})(e);e.root.className=Object(Rt.a)(t.root,n,(e.disabled||e.disabledFocusable)&&t.disabled,e.root.className),FB(e),Object(Ar.a)(e)})(n),Object(an.a)(n)}));vM.displayName="next/StatusBarToggleButton";const RM=R.forwardRef((e,t)=>{const{styles:n,isJumbo:o}=e,r=_object_without_properties(e,["styles","isJumbo"]);return R.createElement(we.a,null,e=>R.createElement(Ac.a,_object_spread_props(_object_spread({ref:t},r),{styles:SM(e,n,o)})))}),kM=R.forwardRef((e,t)=>{const n=MB();return e.label||e.icon?n?R.createElement(vM,_object_spread_props(_object_spread({},e),{ref:t})):R.createElement(RM,_object_spread({ref:t},e)):null});kM.displayName="StatusBarToggleButton";var TM=n(2176),_M=n(412);const wM=Object(Jo.c)((e,t,n,o)=>{const r=lB(e),i=Object(ox.a)(e,n),a={root:{height:24},slideBox:_object_spread_props(_object_spread({height:24,boxSizing:"border-box",paddingLeft:3,paddingRight:3,paddingBottom:1},t?{pointerEvents:"none"}:{"&:hover, &:active":{".ms-Slider-thumb":{border:0,borderRadius:0,backgroundColor:i.primaryDefaultBackgroundColor},".ms-Slider-active":{backgroundColor:r.focusedBorder},".ms-Slider-inactive":{backgroundColor:r.focusedBorder}}},Object(_M.b)(e,void 0,t)),{[F.m]:{".ms-Slider-thumb, .ms-Slider-active, .ms-Slider-inactive":{border:0,backgroundColor:t?"GrayText":"ButtonText"},"&:hover, &:active, &:focus":_object_spread({".ms-Slider-thumb, .ms-Slider-active, .ms-Slider-inactive":{[F.m]:{backgroundColor:"HighlightText"}}},ci.n,ci.s)}}),thumb:{width:6,height:15,top:-7,border:0,borderRadius:0,backgroundColor:t?r.textDisabled:r.focusedBorder,transition:"none"},activeSection:{height:1,backgroundColor:t?r.textDisabled:r.focusedBorder},inactiveSection:{height:1,backgroundColor:t?r.textDisabled:r.focusedBorder}};return _object_spread_props(_object_spread({},cB,{root:{height:24,maxWidth:100}},o),{slider:Object(F.I)(a,null==o?void 0:o.slider)})});var DM=n(477);const PM=(e,t,n)=>Math.max(t,Math.min(n,e||0));var IM=n(411);const FM={sliderDirectionVar:"--fui-Slider--direction",sliderProgressVar:"--fui-Slider--progress",sliderStepsPercentVar:"--fui-Slider--steps-percent"},{sliderDirectionVar:BM,sliderStepsPercentVar:MM,sliderProgressVar:jM}=FM,OM=Object(io.a)({root:{qhf8xq:"f10pi13n",mc9l5x:"fwk3njj",lpbzjs:"f1sdsnyy",Bt984gj:"f122n59",B7hvi0a:"f1oiokrs"},small:{Bi64ftq:"f1agqo6f",Ba19x4e:"f1i7ztpd",sshi5w:"f1pha7fy"},medium:{Bi64ftq:"f1a78h9h",Ba19x4e:"fuok0yf",sshi5w:"f1nxs5xn"},horizontal:{Bf4jedk:"fyvtabn",wkccdc:"fgfd48t",Budl1dq:"f4t5rw1"},vertical:{sshi5w:"f1pzv1zu",wkccdc:"fktlcaf",Budl1dq:"fiadc6h"},enabled:{B7wi8oa:"f4l8x3l",B250r6j:"f671q34",Bpmy4es:"fvfzmw5",Buw9y6v:"faw1t00",Bq939m0:"fxdgx5",gjzr1t:"fii04fa",tg7hqu:"f36hzz8",ypdvl1:"f1volkfw",Bw5jdd4:"f1xddb6",Bdjie01:"fcdikl",Bvh9j6m:"fhpzgm6",Bvsvvpo:"f1q6pm3h"},disabled:{Bpmy4es:"foojseg",B7wi8oa:"f1lgdqhv",B250r6j:"f1veetlj",ypdvl1:"fu12m3e",Bw5jdd4:"fi9guym",Bdjie01:"fcdjl4u"},focusIndicatorHorizontal:{Brovlpu:"ftqa4ok",B486eqv:"f2hkw1w",Bssx7fj:"f1b1k54r",uh7if5:["f4ne723","fqqcjud"],clntm0:"fh7aioi",Dlk2r6:["fqqcjud","f4ne723"],Bm3wd5j:"f1k55ka9",Bbrhkcr:["fgclinu","f16pcs8n"],f1oku:"fycbxed",aywvf2:["f16pcs8n","fgclinu"],B2j2mmj:"ffht0p2",wigs8:"f1p0ul1q",pbfy6t:"f1c901ms",B0v4ure:"f1alokd7",Byrf0fs:0,Bsiemmq:0,Bwckmig:0,skfxo0:0,Iidy0u:0,B98u21t:0,Bvwlmkc:0,jo1ztg:0,Ba1iezr:0,Blmvk6g:0,B24cy0v:0,Bil7v7r:0,Br3gin4:0,nr063g:0,ghq09:0,Bbgo44z:0,Bseh09z:"fmj8fco",az1dzo:0,Ba3ybja:0,B6352mv:0,vppk2z:0,Biaj6j7:"f1iwowo3",B2pnrqr:"f1pffoy2",B29w5g4:["f1bmyog6","f15fv2gd"],Bhhzhcn:"fs6b7xr",Bec0n69:["f15fv2gd","f1bmyog6"]},focusIndicatorVertical:{Brovlpu:"ftqa4ok",B486eqv:"f2hkw1w",Bssx7fj:"f1b1k54r",uh7if5:["f4ne723","fqqcjud"],clntm0:"fh7aioi",Dlk2r6:["fqqcjud","f4ne723"],Bm3wd5j:"f1k55ka9",Bbrhkcr:["fgclinu","f16pcs8n"],f1oku:"fycbxed",aywvf2:["f16pcs8n","fgclinu"],B2j2mmj:"ffht0p2",wigs8:"f1p0ul1q",pbfy6t:"f1c901ms",B0v4ure:"f1alokd7",Byrf0fs:0,Bsiemmq:0,Bwckmig:0,skfxo0:0,Iidy0u:0,B98u21t:0,Bvwlmkc:0,jo1ztg:0,Ba1iezr:0,Blmvk6g:0,B24cy0v:0,Bil7v7r:0,Br3gin4:0,nr063g:0,ghq09:0,Bbgo44z:0,Bseh09z:"fmj8fco",az1dzo:0,Ba3ybja:0,B6352mv:0,vppk2z:0,Biaj6j7:"f1iwowo3",B2pnrqr:"f1hxpdv8",B29w5g4:["fm5xmfm","femsgmt"],Bhhzhcn:"f1dmxpeg",Bec0n69:["femsgmt","fm5xmfm"]}},{d:[".f10pi13n{position:relative;}",".fwk3njj{display:inline-grid;}",".f1sdsnyy{touch-action:none;}",".f122n59{align-items:center;}",".f1oiokrs{justify-items:center;}",".f1agqo6f{--fui-Slider__thumb--size:16px;}",".f1i7ztpd{--fui-Slider__rail--size:2px;}",".f1pha7fy{min-height:24px;}",".f1a78h9h{--fui-Slider__thumb--size:20px;}",".fuok0yf{--fui-Slider__rail--size:4px;}",".f1nxs5xn{min-height:32px;}",".fyvtabn{min-width:120px;}",".fgfd48t{grid-template-rows:1fr var(--fui-Slider__thumb--size) 1fr;}",".f4t5rw1{grid-template-columns:1fr calc(100% - var(--fui-Slider__thumb--size)) 1fr;}",".f1pzv1zu{min-height:120px;}",".fktlcaf{grid-template-rows:1fr calc(100% - var(--fui-Slider__thumb--size)) 1fr;}",".fiadc6h{grid-template-columns:1fr var(--fui-Slider__thumb--size) 1fr;}",".f4l8x3l{--fui-Slider__rail--color:var(--colorNeutralStrokeAccessible);}",".f671q34{--fui-Slider__progress--color:var(--colorCompoundBrandBackground);}",".fvfzmw5{--fui-Slider__thumb--color:var(--colorCompoundBrandBackground);}",".foojseg{--fui-Slider__thumb--color:var(--colorNeutralForegroundDisabled);}",".f1lgdqhv{--fui-Slider__rail--color:var(--colorNeutralBackgroundDisabled);}",".f1veetlj{--fui-Slider__progress--color:var(--colorNeutralForegroundDisabled);}",".f1b1k54r[data-fui-focus-within]:focus-within{border-top-color:transparent;}",".f4ne723[data-fui-focus-within]:focus-within{border-right-color:transparent;}",".fqqcjud[data-fui-focus-within]:focus-within{border-left-color:transparent;}",".fh7aioi[data-fui-focus-within]:focus-within{border-bottom-color:transparent;}",'.ffht0p2[data-fui-focus-within]:focus-within::after{content:"";}',".f1p0ul1q[data-fui-focus-within]:focus-within::after{position:absolute;}",".f1c901ms[data-fui-focus-within]:focus-within::after{pointer-events:none;}",".f1alokd7[data-fui-focus-within]:focus-within::after{z-index:1;}",[".fmj8fco[data-fui-focus-within]:focus-within::after{border:2px solid var(--colorStrokeFocus2);}",{p:-2}],[".f1iwowo3[data-fui-focus-within]:focus-within::after{border-radius:var(--borderRadiusMedium);}",{p:-1}],".f1pffoy2[data-fui-focus-within]:focus-within::after{top:calc(0px - 2px - -2px);}",".f1bmyog6[data-fui-focus-within]:focus-within::after{right:calc(0px - 2px - 8px);}",".f15fv2gd[data-fui-focus-within]:focus-within::after{left:calc(0px - 2px - 8px);}",".fs6b7xr[data-fui-focus-within]:focus-within::after{bottom:calc(0px - 2px - -2px);}",[".fmj8fco[data-fui-focus-within]:focus-within::after{border:2px solid var(--colorStrokeFocus2);}",{p:-2}],[".f1iwowo3[data-fui-focus-within]:focus-within::after{border-radius:var(--borderRadiusMedium);}",{p:-1}],".f1hxpdv8[data-fui-focus-within]:focus-within::after{top:calc(0px - 2px - 6px);}",".fm5xmfm[data-fui-focus-within]:focus-within::after{right:calc(0px - 2px - 4px);}",".femsgmt[data-fui-focus-within]:focus-within::after{left:calc(0px - 2px - 4px);}",".f1dmxpeg[data-fui-focus-within]:focus-within::after{bottom:calc(0px - 2px - 6px);}"],h:[".faw1t00:hover{--fui-Slider__thumb--color:var(--colorCompoundBrandBackgroundHover);}",".fxdgx5:hover{--fui-Slider__progress--color:var(--colorCompoundBrandBackgroundHover);}"],a:[".fii04fa:active{--fui-Slider__thumb--color:var(--colorCompoundBrandBackgroundPressed);}",".f36hzz8:active{--fui-Slider__progress--color:var(--colorCompoundBrandBackgroundPressed);}"],m:[["@media (forced-colors: active){.f1volkfw{--fui-Slider__rail--color:CanvasText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1xddb6{--fui-Slider__thumb--color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fcdikl{--fui-Slider__progress--color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fhpzgm6:hover{--fui-Slider__thumb--color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1q6pm3h:hover{--fui-Slider__progress--color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fu12m3e{--fui-Slider__rail--color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fi9guym{--fui-Slider__thumb--color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fcdjl4u{--fui-Slider__progress--color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1k55ka9[data-fui-focus-within]:focus-within::after{border-top-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f16pcs8n[data-fui-focus-within]:focus-within::after{border-left-color:Highlight;}.fgclinu[data-fui-focus-within]:focus-within::after{border-right-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fycbxed[data-fui-focus-within]:focus-within::after{border-bottom-color:Highlight;}}",{m:"(forced-colors: active)"}]],f:[".ftqa4ok:focus{outline-style:none;}"],i:[".f2hkw1w:focus-visible{outline-style:none;}"]}),LM=Object(io.a)({rail:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f1kijzfu",Bkecrkj:"f1aehjj5",Ijaq50:"faunodf",nk6f5a:"f88nxoq",Br312pm:"fd46tj4",Bw0ie65:"f1e2fz10",qhf8xq:"f10pi13n",Bvjb7m6:"fdgv6k0",Bcmaq0h:"fizngqt",Bpd4iqm:"fpvhumw",oeaueh:"f1yog68k",Bw0xxkn:"f13sgyd8",Ftih45:"fzhtfnv",Brfgrao:"f1j7ml58",Bbn5juq:"fx36ao7",Brdvuy1:"fux3rle"},horizontal:{a9b677:"fly5x3f",Bqenvij:"f1cy86ho",Fbdkly:["f1heqfse","fkh49vu"],mdwyqc:["fkh49vu","f1heqfse"],Baz25je:"f16tdq4e"},vertical:{a9b677:"fqxfnkd",Bqenvij:"f1l02sjl",Ccq8qp:"f1rik0od",Bciustq:"f14xwovp",lawp4y:"febq2dz"}},{d:[[".f1kijzfu{border-radius:var(--borderRadiusXLarge);}",{p:-1}],".f1aehjj5{pointer-events:none;}",".faunodf{grid-row-start:2;}",".f88nxoq{grid-row-end:2;}",".fd46tj4{grid-column-start:2;}",".f1e2fz10{grid-column-end:2;}",".f10pi13n{position:relative;}",".fdgv6k0{forced-color-adjust:none;}",".fizngqt{background-image:linear-gradient(\n      var(--fui-Slider--direction),\n      var(--fui-Slider__progress--color) 0%,\n      var(--fui-Slider__progress--color) var(--fui-Slider--progress),\n      var(--fui-Slider__rail--color) var(--fui-Slider--progress)\n    );}",".fpvhumw{outline-width:1px;}",".f1yog68k{outline-style:solid;}",".f13sgyd8{outline-color:var(--colorTransparentStroke);}",".fzhtfnv::before{content:'';}",".f1j7ml58::before{position:absolute;}",".fx36ao7::before{background-image:repeating-linear-gradient(\n        var(--fui-Slider--direction),\n        #0000 0%,\n        #0000 calc(var(--fui-Slider--steps-percent) - 1px),\n        var(--colorNeutralBackground1) calc(var(--fui-Slider--steps-percent) - 1px),\n        var(--colorNeutralBackground1) var(--fui-Slider--steps-percent)\n      );}",".fly5x3f{width:100%;}",".f1cy86ho{height:var(--fui-Slider__rail--size);}",".f1heqfse::before{left:-1px;}",".fkh49vu::before{right:-1px;}",".f16tdq4e::before{height:var(--fui-Slider__rail--size);}",".fqxfnkd{width:var(--fui-Slider__rail--size);}",".f1l02sjl{height:100%;}",".f1rik0od::before{width:var(--fui-Slider__rail--size);}",".f14xwovp::before{top:-1px;}",".febq2dz::before{bottom:1px;}"],m:[["@media (forced-colors: active){.fux3rle::before{background-image:repeating-linear-gradient(\n          var(--fui-Slider--direction),\n          #0000 0%,\n          #0000 calc(var(--fui-Slider--steps-percent) - 1px),\n          HighlightText calc(var(--fui-Slider--steps-percent) - 1px),\n          HighlightText var(--fui-Slider--steps-percent)\n        );}}",{m:"(forced-colors: active)"}]]}),AM=Object(io.a)({thumb:{Ijaq50:"faunodf",nk6f5a:"f88nxoq",Br312pm:"fd46tj4",Bw0ie65:"f1e2fz10",qhf8xq:"f1euv43f",a9b677:"f174ca62",Bqenvij:"f1yfdkfd",Bkecrkj:"f1aehjj5",oeaueh:"f1s6fcnf",Bvjb7m6:"fdgv6k0",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f44lkw9",E5pizo:"fof7hq0",De3pzq:"foksa45",Brfgrao:"f1j7ml58",Bciustq:"f14u7mkt",Fbdkly:["f5zrw40","f1ks5ppg"],lawp4y:"fto0uou",mdwyqc:["f1ks5ppg","f5zrw40"],r59vdv:0,Budzafs:0,ck0cow:0,n07z76:0,Gng75u:"fielpny",Bcvre1j:"fyl8oag",Ftih45:"fzhtfnv",Bcgcnre:0,Bqjgrrk:0,qa3bma:0,y0oebl:0,Biqmznv:0,Bm6vgfq:0,Bbv0w2i:0,uvfttm:0,eqrjj:0,Bk5zm6e:0,m598lv:0,B4f6apu:0,ydt019:0,Bq4z7u6:0,Bdkvgpv:0,B0qfbqy:0,kj8mxx:"f1fsco4d"},disabled:{Bcgcnre:0,Bqjgrrk:0,qa3bma:0,y0oebl:0,Biqmznv:0,Bm6vgfq:0,Bbv0w2i:0,uvfttm:0,eqrjj:0,Bk5zm6e:0,m598lv:0,B4f6apu:0,ydt019:0,Bq4z7u6:0,Bdkvgpv:0,B0qfbqy:0,kj8mxx:"f1pv9hn4"},horizontal:{Bz10aip:["f13gfj74","f1nfknbn"],oyh7mz:["f1fj3zth","fcf9u6w"]},vertical:{Bz10aip:"f5cv5a3",B5kzvoi:"feeniun"}},{d:[".faunodf{grid-row-start:2;}",".f88nxoq{grid-row-end:2;}",".fd46tj4{grid-column-start:2;}",".f1e2fz10{grid-column-end:2;}",".f1euv43f{position:absolute;}",".f174ca62{width:var(--fui-Slider__thumb--size);}",".f1yfdkfd{height:var(--fui-Slider__thumb--size);}",".f1aehjj5{pointer-events:none;}",".f1s6fcnf{outline-style:none;}",".fdgv6k0{forced-color-adjust:none;}",[".f44lkw9{border-radius:var(--borderRadiusCircular);}",{p:-1}],".fof7hq0{box-shadow:0 0 0 calc(var(--fui-Slider__thumb--size) * .2) var(--colorNeutralBackground1) inset;}",".foksa45{background-color:var(--fui-Slider__thumb--color);}",".f1j7ml58::before{position:absolute;}",".f14u7mkt::before{top:0px;}",".f5zrw40::before{left:0px;}",".f1ks5ppg::before{right:0px;}",".fto0uou::before{bottom:0px;}",[".fielpny::before{border-radius:var(--borderRadiusCircular);}",{p:-1}],".fyl8oag::before{box-sizing:border-box;}",".fzhtfnv::before{content:'';}",[".f1fsco4d::before{border:calc(var(--fui-Slider__thumb--size) * .05) solid var(--colorNeutralStroke1);}",{p:-2}],[".f1pv9hn4::before{border:calc(var(--fui-Slider__thumb--size) * .05) solid var(--colorNeutralForegroundDisabled);}",{p:-2}],".f13gfj74{transform:translateX(-50%);}",".f1nfknbn{transform:translateX(50%);}",".f1fj3zth{left:var(--fui-Slider--progress);}",".fcf9u6w{right:var(--fui-Slider--progress);}",".f5cv5a3{transform:translateY(50%);}",".feeniun{bottom:var(--fui-Slider--progress);}"]}),NM=Object(io.a)({input:{Bceei9c:"f1k6fduh",abs64n:"fk73vx1",Ijaq50:"f16hsg94",nk6f5a:"f1nzqi2z",Br312pm:"fwpfdsa",Bw0ie65:"fuur7zz",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1mk8lai",jrapky:0,Frg6f3:0,t21cq0:0,B6of3ja:0,B74szlk:"f1s184ao"},disabled:{Bceei9c:"f158kwzp"},horizontal:{Bqenvij:"f1yfdkfd",a9b677:"fly5x3f"},vertical:{Bqenvij:"f1l02sjl",a9b677:"f174ca62",Brp00wb:"f1r9mf01"}},{d:[".f1k6fduh{cursor:pointer;}",".fk73vx1{opacity:0;}",".f16hsg94{grid-row-start:1;}",".f1nzqi2z{grid-row-end:-1;}",".fwpfdsa{grid-column-start:1;}",".fuur7zz{grid-column-end:-1;}",[".f1mk8lai{padding:0;}",{p:-1}],[".f1s184ao{margin:0;}",{p:-1}],".f158kwzp{cursor:default;}",".f1yfdkfd{height:var(--fui-Slider__thumb--size);}",".fly5x3f{width:100%;}",".f1l02sjl{height:100%;}",".f174ca62{width:var(--fui-Slider__thumb--size);}",".f1r9mf01{-webkit-appearance:slider-vertical;}"]}),{sliderStepsPercentVar:WM,sliderProgressVar:zM,sliderDirectionVar:HM}=FM;var VM=n(2170);var UM=n(1039);const GM=(e,t)=>{const{label:n,text:o,value:r}=e,i=o?`${n} ${o}`:n,a=((e,t)=>{const{id:n,customTooltip:o,location:r,tooltipDirection:i}=e,{mergedRef:a}=Object(UM.a)(t,{customTooltip:o,id:n,direction:i,location:r});return a})(e,t),s=(e=>{const{id:t,location:n,onExecute:o}=e;return R.useCallback((e,r)=>{o&&o({id:t,value:r.value,location:n})},[t,n,o])})(e);return((e,t)=>{e=Object(zn.b)(e,{supportsLabelFor:!0});const n=Object(Un.b)({props:e,primarySlotTagName:"input",excludedPropNames:["onChange","size"]}),{disabled:o,vertical:r,size:i="medium",root:a,input:s,rail:l,thumb:c}=e,u={disabled:o,size:i,vertical:r,components:{input:"input",rail:"div",root:"div",thumb:"div"},root:ft.a.always(a,{defaultProps:n.root,elementType:"div"}),input:ft.a.always(s,{defaultProps:_object_spread_props(_object_spread({id:Object(bB.a)("slider-",e.id),ref:t},n.primary),{type:"range",orient:r?"vertical":void 0}),elementType:"input"}),rail:ft.a.always(l,{elementType:"div"}),thumb:ft.a.always(c,{elementType:"div"})};return u.root.ref=Object(Gn.a)(u.root.ref,Object(VM.a)()),((e,t)=>{const{defaultValue:n=0,min:o=0,max:r=100,step:i,value:a}=t,{dir:s}=Object(IM.b)(),[l,c]=Object(DM.a)({state:void 0!==a?PM(a,o,r):void 0,defaultState:PM(n,o,r),initialState:0}),u=((e,t,n)=>n===t?0:(e-t)/(n-t)*100)(l,o,r),d=e.input.onChange,p=t.onChange,g=Object(qn.a)(e=>{const t=Number(e.target.value);c(PM(t,o,r)),d&&d!==p?d(e):p&&p(e,{value:t})}),h={[HM]:e.vertical?"0deg":"ltr"===s?"90deg":"270deg",[WM]:i&&i>0?100*i/(r-o)+"%":"",[zM]:u+"%"};e.root.style=_object_spread({},h,e.root.style),e.input.value=l,e.input.onChange=g})(u,e),u})(_object_spread_props(_object_spread({},e),{value:Math.floor(r),onChange:s,type:"slider","aria-valuetext":i}),a)},qM=R.memo(R.forwardRef((e,t)=>{const n=((e,t)=>{const{dataAutomationType:n}=e;return GM(_object_spread_props(_object_spread({},e),{size:"small",dataAutomationType:null!=n?n:"StatusBarSlider"}),t)})(e,t);return(e=>{const t=OM(),n=LM(),o=AM(),r=NM(),i=e.vertical;e.root.className=Object(Rt.a)("fui-Slider",t.root,i?t.focusIndicatorVertical:t.focusIndicatorHorizontal,t[e.size],i?t.vertical:t.horizontal,e.disabled?t.disabled:t.enabled,e.root.className),e.rail.className=Object(Rt.a)("fui-Slider__rail",n.rail,i?n.vertical:n.horizontal,e.rail.className),e.thumb.className=Object(Rt.a)("fui-Slider__thumb",o.thumb,i?o.vertical:o.horizontal,e.disabled&&o.disabled,e.thumb.className),e.input.className=Object(Rt.a)("fui-Slider__input",r.input,i?r.vertical:r.horizontal,e.disabled&&r.disabled,e.input.className)})(n),((e,t)=>R.createElement("div",{"data-automation-type":e.dataAutomationType||"AppSlider","data-unique-id":Object(xP.a)(e)},(e=>(Object(vt.a)(e),Object(Ct.b)(e.root,{children:[Object(Ct.a)(e.input,{}),Object(Ct.a)(e.rail,{}),Object(Ct.a)(e.thumb,{})]})))(t)))(e,n)}));qM.displayName="next/StatusBarSlider";const QM=R.forwardRef((e,t)=>{const{appColors:n,disabled:o}=e,r=_object_without_properties(e,["appColors","disabled"]);return R.createElement(we.a,null,e=>R.createElement(TM.a,_object_spread_props(_object_spread({ref:t,disabled:o},r),{styles:wM(e,o,n)})))}),KM=R.forwardRef((e,t)=>MB()?R.createElement(qM,_object_spread_props(_object_spread({ref:t},e),{type:"AppSliderProps"})):R.createElement(QM,_object_spread({ref:t},e))),JM=e=>{const{increaseZoomButtonProps:t,decreaseZoomButtonProps:n,zoomLabelProps:o,zoomSliderProps:r,zoomLevelButtonProps:i,showSlider:a,isJumbo:s,appColors:l,location:c}=e,u=Object(Zf.a)(R.useContext(Hm.a),Zf.f.zoomSliderIsEnabled),d={isJumbo:s},p=MB(),g=(h=i.className,Object(Rt.a)(RB().label,h));var h;return u?R.createElement(R.Fragment,null,R.createElement(LB,_object_spread_props(_object_spread({},n,d),{styles:Object(F.I)(SB,n.styles),noDomId:!0,applyZoomIconStyles:!0,location:c})),a?R.createElement(KM,_object_spread_props(_object_spread({},r),{appColors:l,location:c})):R.createElement(LB,_object_spread_props(_object_spread({},i,d),{styles:Object(F.I)(CB,i.styles),className:p?g:i.className,location:c})),R.createElement(LB,_object_spread_props(_object_spread({},t,d),{styles:Object(F.I)(SB,t.styles),noDomId:!0,applyZoomIconStyles:!0,location:c})),a&&R.createElement(LB,_object_spread_props(_object_spread({},i,d),{styles:Object(F.I)(CB,i.styles),className:p?g:i.className,location:c}))):R.createElement(R.Fragment,null,R.createElement(LB,_object_spread_props(_object_spread({},n,d),{styles:Object(F.I)(SB,n.styles),noDomId:!0,applyZoomIconStyles:!0,location:c})),R.createElement(EM,_object_spread_props(_object_spread({},o,d),{styles:yB})),R.createElement(LB,_object_spread_props(_object_spread({},t,d),{styles:Object(F.I)(SB,t.styles),noDomId:!0,applyZoomIconStyles:!0,location:c})))},YM=Object(Rk.strEnum)(["left","center","right"]),ZM={display:"inline-flex",selectors:{":empty":{display:"none"}}},$M={[YM.left]:_object_spread_props(_object_spread({},ZM),{flex:"1 0 0px",justifyContent:"flex-start"}),[YM.center]:_object_spread_props(_object_spread({},ZM),{flex:"1 1 0px",justifyContent:"center",marginLeft:5,marginRight:5}),[YM.right]:_object_spread_props(_object_spread({},ZM),{flex:"1 0 0px",justifyContent:"flex-end"})},XM=Object(Jo.c)((e,t)=>t?Object(F.eb)($M[e],t[e]):Object(F.eb)($M[e])),ej=({position:e,children:t,regionStyles:n})=>R.createElement("div",{className:XM(e,n)},t);var tj=n(288),nj=n.n(tj);function oj(e,t){return _object_spread_props(_object_spread({},e),{cacheKey:rj(t,Object.keys(e.scaledStatusBarControls).map(t=>e.scaledStatusBarControls[t]))})}function rj(e,t){return nj()(JSON.stringify({isSpanning:e,controlRegions:t.map((e,t)=>({regionId:t,controls:e.map(e=>function e(t){switch(t.type){case"AppButtonProps":case"AppToggleButtonProps":case"AppFlyoutAnchorProps":return{controlType:t.type,id:t.id,labelCharacterLength:t.hideLabel?0:t.label.length};case"AppStatusTextProps":return{controlType:t.type,id:t.id,labelCharacterLength:t.label.length};case"AppSliderProps":return{controlType:t.type,id:t.id};case"StatusBarZoomControlProps":return{controlType:t.type,id:t.id,showSlider:String(t.showSlider),increaseZoom:JSON.stringify(e(t.increaseZoomButtonProps)),zoomLabel:JSON.stringify(e(t.zoomLabelProps)),zoomLevelButton:JSON.stringify(e(t.zoomLevelButtonProps)),decreaseZoom:JSON.stringify(e(t.decreaseZoomButtonProps)),zoomSlider:JSON.stringify(e(t.zoomSliderProps))};case"AppComboBoxProps":return{controlType:t.type,id:t.id,labelCharacterLength:t.showLabel?t.label.length:0};default:throw new Error("The following StatusBarControlProps is not valid as a status bar control"+t)}}(e))}))})).toString(36)}function ij(e){return{controlId:e,type:"DropLabel"}}function aj(e){return{controlId:e,type:"HideControl"}}function sj(e){return{controlId:e,type:"CompressControl"}}const lj=Object(Jo.c)((function(e,t,n){const o=uj(t,n),r={left:[],center:[],right:[]};return Object.keys(e).forEach(t=>{r[t]=dj(e[t],o)}),r}));function cj(e,t){const n=lj(e.statusBarControls,e.scalingSteps,t);return _object_spread_props(_object_spread({},e),{scaledStatusBarControls:n,appliedScalingStepCount:t})}const uj=Object(Jo.c)((e,t)=>{const n=e.slice(0,t);let o=[];return n.forEach(e=>{o=o.concat(e)}),o}),dj=Object(Jo.c)((e,t)=>{const n=[...e];return t.forEach(e=>{const t=Object(pC.e)(n,t=>t.id===e.controlId);if(-1!==t)switch(e.type){case"HideControl":n.splice(t,1);break;case"DropLabel":const o=_object_spread({},n[t]);"AppStatusTextProps"===o.type?n.splice(t,1):"StatusBarZoomControlProps"===o.type||("AppComboBoxProps"===o.type?o.showLabel=!1:(o.hideLabel=!0,n.splice(t,1,o)));break;case"CompressControl":const r=_object_spread({},n[t]);"StatusBarZoomControlProps"===r.type&&(r.showSlider=!1,n.splice(t,1,r));break;default:Object(PS.a)(e)}}),n}),pj=Object(Jo.c)((e,t,n,o)=>{const r=lB(e),i={outerContainer:_object_spread_props(_object_spread({display:"flex",position:"relative",width:"100%",maxWidth:void 0,selectors:{"@-moz-document url-prefix()":{maxWidth:"100vw"}},height:t?40:24},t?{}:{borderTop:`1px solid ${o?_o.a.colorNeutralStroke1:r.defaultBorder}\n            `}),{boxSizing:"content-box",overflow:"hidden",backgroundColor:r.defaultBackground}),container:{display:"flex",padding:"0 12px",boxSizing:"border-box",width:"100%",overflow:"hidden",backgroundColor:o?_o.a.colorNeutralBackground3:"transparent"},resizeGroup:{width:"100%",overflow:"hidden"}};return Object(F.db)(i,n)});function gj(e,t){return{borderColor:e?_o.a.colorNeutralStroke1:t.palette.neutralQuaternaryAlt,borderWidth:"1px !important",borderBottomStyle:"none",selectors:{"::after":{boxSizing:"border-box",content:'""',position:"absolute",left:"-1px",bottom:"-1px",right:"-1px",height:`max(3px, ${_o.a.borderRadiusMedium})`,borderBottomLeftRadius:_o.a.borderRadiusMedium,borderBottomRightRadius:_o.a.borderRadiusMedium,borderBottom:"3px solid "+_o.a.colorCompoundBrandStroke,clipPath:"inset(calc(100% - 3px) 0 0)"}}}}const hj=Object(Jo.c)((e,t,n)=>{const o=Object(XP.a)(),r=_object_spread_props(_object_spread({},cB),{root:{height:18,lineHeight:16,fontSize:12,borderRadius:4,borderColor:e.palette.neutralQuaternaryAlt},container:{height:18,marginTop:2,marginRight:0},rootFocused:gj(o,e),rootPressed:gj(o,e),input:{height:16,lineHeight:16,fontSize:12},optionsContainerWrapper:{fontSize:14},optionsContainer:{fontSize:14}});return Object(F.I)(r,n?uB&&{root:{height:30,display:"flex",alignItems:"center"},container:{marginTop:0,height:"100%",display:"flex",alignItems:"center"}}:{},t)}),mj=e=>e?{root:{height:30}}:{root:{height:18}};var bj=n(2647),fj=n(1030);const xj=Object(ut.a)({root:{height:"16px",lineHeight:"16px",fontSize:"12px",minWidth:"var(--acuiStatusBarCombobox--widthToUse)",boxSizing:"inherit",paddingRight:_o.a.spacingHorizontalNone,":hover":{"--acuistatusBarCombobox__expandIcon--backgroundColor":_o.a.colorNeutralBackground1Hover},[""+ui.a]:{":hover":_object_spread({},ui.n),":disabled":_object_spread({},ui.f)}}}),Ej=Object(ut.a)({root:{height:"18px",marginTop:"2px",marginRight:"2px",width:"var(--acuiStatusBarCombobox--widthToUse)"}}),Sj=Object(ut.a)({base:{alignItems:"center",display:"inline-flex",height:"100%",backgroundColor:"var(--acuistatusBarCombobox__expandIcon--backgroundColor)",borderBottomRightRadius:_o.a.borderRadiusMedium,borderTopRightRadius:_o.a.borderRadiusMedium,":hover":{"--acuistatusBarCombobox__expandIcon--backgroundColor":_o.a.colorNeutralBackground1Hover},":active":{"--acuistatusBarCombobox__expandIcon--backgroundColor":_o.a.colorNeutralBackground1Pressed},[""+ui.a]:{":hover":_object_spread_props(_object_spread({},ui.j),{"& path.OfficeIconColors_HighContrast":{fill:"HighlightText"}}),":hover:active":{backgroundColor:"Window"}}},expanded:{"--acuistatusBarCombobox__expandIcon--backgroundColor":_o.a.colorNeutralBackground1Selected}}),yj=Object(ut.a)({root:{height:"16px",lineHeight:"14px",fontSize:"12px",width:"100%",paddingLeft:_o.a.spacingHorizontalXS}}),Cj=Object(ut.a)({root:{height:"30px",lineHeight:"20px",marginBottom:"2px",alignSelf:"center"},input:{width:"16px",height:"16px",lineHeight:"16px"}});var vj=n(2572);const Rj=R.memo(R.forwardRef((e,t)=>{const n=((e,t)=>{const{isJumbo:n,width:o}=e,r=Object(vj.a)(_object_spread_props(_object_spread({},e),{executeOnlyOnEnterKey:!0}),t);return fB(r,n),((e,t)=>{e.wrapper.style=_object_spread_props(_object_spread({},e.wrapper.style),{"--acuiStatusBarCombobox--widthToUse":t?t+"px":"130px"})})(r,o),r})(e,t),o=Object(ro.a)(n);return(e=>{const t=e.isJumbo,n=Cj(),o=xj(),r=yj(),i=Ej(),a=Sj();e.root.className=Object(Rt.a)(o.root,t&&n.root,e.root.className),e.wrapper.className=Object(Rt.a)(i.root,t&&n.root,e.wrapper.className),e.expandIcon&&(e.expandIcon.className=Object(Rt.a)("ms-ComboBox-CaretDown-button",a.base,e.expandIcon["aria-expanded"]&&a.expanded,e.expandIcon.className)),e.input.className=Object(Rt.a)(r.root,e.input.className),Object(fj.b)(e)})(n),Object(bj.a)(n,o)}));Rj.displayName="next/StatusBarCombobox";const kj=R.forwardRef((e,t)=>{const{styles:n,isJumbo:o,downChevronIcon:r}=e,i=_object_without_properties(e,["styles","isJumbo","downChevronIcon"]);return R.createElement(we.a,null,e=>R.createElement(Wc.a,_object_spread({ref:t,directionalHintDynamic:!0,styles:hj(e,n,o),downChevronIcon:r,caretDownButtonStyles:mj(o),optionStyles:{optionText:{fontSize:14}},executeOnlyOnEnterKey:!0},i)))}),Tj=R.forwardRef((e,t)=>{const n=R.useContext(Hm.a),o=Object(Zf.a)(n,Zf.f.fluentV9InputComboboxIsEnabled);return MB()&&o?R.createElement(Rj,_object_spread({ref:t},e)):R.createElement(kj,_object_spread({ref:t},e))});Tj.displayName="StatusBarCombobox";class _j extends R.Component{componentWillUnmount(){Object(wp.unregisterSpanningChanged)(this._spanningChangedStatusBarId)}renderRegionItems(e){return e?this.props.controlRendererFunction?e.map(e=>{var t,n;return null===(t=(n=this.props).controlRendererFunction)||void 0===t?void 0:t.call(n,_object_spread_props(_object_spread({},this.addControlSpecificStyles(e)),{isJumbo:this.props.isJumbo}))}):e.map(e=>this.onRenderItem(_object_spread_props(_object_spread({},e),{isJumbo:this.props.isJumbo}))):null}render(){if(this.props.hidden)return null;const e=this.state.isDoublePortraitLayout;let t=[];if(e){const e=this.props.endRegionPrimaryScreenControlsIds||[];t=this.props.controls.right.filter(t=>e.indexOf(t.id)<0)}const n=(o=this.context,"function"==typeof window.ResizeObserver&&Object(Zf.a)(o,Zf.f.decentralizedScalingLogicIsEnabled)&&!Object(de.e)());var o;const r=!!jB(this.context);return R.createElement(we.a,null,o=>{var i,a;const s=pj(o,this.props.isJumbo,null===(i=this.props.statusBarStyles)||void 0===i?void 0:i.statusBarContainerStyles);return R.createElement(hm.a,null,R.createElement(Cd.a,{direction:qo.a.horizontal,"data-is-focusable":!0,isCircularNavigation:null===(a=this.props.isCircularNavigation)||void 0===a||a,handleTabKey:qo.b.all},R.createElement("div",{className:s.outerContainer},n&&this.props.onScalingStepDispatch&&void 0!==this.props.appliedScalingStepsCount?R.createElement(aB,{steps:this.props.scalingSteps||[],onScalingStepDispatch:this.props.onScalingStepDispatch,appliedScalingStepsCount:this.props.appliedScalingStepsCount},this.renderPrimaryScreenStatusBar(o,r)({scaledStatusBarControls:this.props.controls})):R.createElement(ev.a,{className:s.resizeGroup,direction:tv.a.horizontal,onRenderData:this.renderPrimaryScreenStatusBar(o,r),onReduceData:this.onResizeGroupReduce,onGrowData:this.onResizeGroupGrow,data:oj(this.getInitialScalingState(),this.state.isDoublePortraitLayout)}),e&&this.renderThreeRegionBar(void 0,void 0,t,s.container))))})}getInitialScalingState(){return{scalingSteps:this.props.scalingSteps||[],appliedScalingStepCount:0,statusBarControls:this.props.controls,scaledStatusBarControls:this.props.controls}}renderThreeRegionBar(e,t,n,o){var r,i,a;return R.createElement("div",{className:o},R.createElement(ej,{position:YM.left,regionStyles:null===(r=this.props.statusBarStyles)||void 0===r?void 0:r.statusBarRegionStyles},this.renderRegionItems(e)),R.createElement(ej,{position:YM.center,regionStyles:null===(i=this.props.statusBarStyles)||void 0===i?void 0:i.statusBarRegionStyles},this.renderRegionItems(t)),R.createElement(ej,{position:YM.right,regionStyles:null===(a=this.props.statusBarStyles)||void 0===a?void 0:a.statusBarRegionStyles},this.renderRegionItems(n)))}constructor(e){super(e),this._spanningChangedStatusBarId="statusBar",this.spanningChanged=(e,t)=>{this.setState({isDoublePortraitLayout:e&&"DP"===t})},this.onRenderItem=e=>{var t,n,o,r,i,a,s,l,c,u,d,p,g,h,m,b,f,x,E;const{appliedScalingSteps:S,appColors:y,location:C}=this.props,{type:v,id:k}=e;let T=void 0;if(S){var _,w;if(null!==(_=S.HideControl)&&void 0!==_&&_[k])return null;if(null!==(w=S.DropLabel)&&void 0!==w&&w[k]){if("AppStatusTextProps"===v)return null;T=!0}}switch(C&&(e.location=C),e.type){case"AppButtonProps":const S=_object_spread({},null===(t=this.props.statusBarStyles)||void 0===t?void 0:t.statusBarButtonStyles,e.styles);return R.createElement(LB,_object_spread_props(_object_spread({},e),{hideLabel:null!==(n=T)&&void 0!==n?n:e.hideLabel,key:k,styles:S}));case"AppToggleButtonProps":return R.createElement(kM,_object_spread_props(_object_spread({},e),{hideLabel:null!==(o=T)&&void 0!==o?o:e.hideLabel,key:k,styles:null!==(r=null===(i=this.props.statusBarStyles)||void 0===i?void 0:i.statusBarButtonStyles)&&void 0!==r?r:e.styles}));case"AppStatusTextProps":return R.createElement(EM,_object_spread_props(_object_spread({},e),{iconProps:e.iconProps&&_object_spread_props(_object_spread({},e.iconProps),{styles:null!==(a=null===(s=this.props.statusBarStyles)||void 0===s?void 0:s.statusBarLabelIconStyles)&&void 0!==a?a:e.iconProps.styles}),key:k,styles:null!==(l=null===(c=this.props.statusBarStyles)||void 0===c?void 0:c.statusBarLabelStyles)&&void 0!==l?l:e.styles}));case"AppFlyoutAnchorProps":return R.createElement(nM,_object_spread_props(_object_spread({},e),{hideLabel:null!==(u=T)&&void 0!==u?u:e.hideLabel,key:k,styles:null!==(d=null===(p=this.props.statusBarStyles)||void 0===p?void 0:p.statusBarButtonStyles)&&void 0!==d?d:e.styles,customMenuItemStyles:null===(g=this.props.statusBarStyles)||void 0===g?void 0:g.menuItemStyleClassNames}));case"StatusBarZoomControlProps":return R.createElement(JM,_object_spread_props(_object_spread({},e),{increaseZoomButtonProps:_object_spread_props(_object_spread({},e.increaseZoomButtonProps),{styles:null!==(h=null===(m=this.props.statusBarStyles)||void 0===m?void 0:m.statusBarButtonStyles)&&void 0!==h?h:e.increaseZoomButtonProps.styles}),decreaseZoomButtonProps:_object_spread_props(_object_spread({},e.decreaseZoomButtonProps),{styles:null!==(b=null===(f=this.props.statusBarStyles)||void 0===f?void 0:f.statusBarButtonStyles)&&void 0!==b?b:e.decreaseZoomButtonProps.styles}),zoomLevelButtonProps:_object_spread_props(_object_spread({},e.zoomLevelButtonProps),{styles:null!==(x=null===(E=this.props.statusBarStyles)||void 0===E?void 0:E.statusBarButtonStyles)&&void 0!==x?x:e.zoomLevelButtonProps.styles}),key:k,appColors:y}));case"AppComboBoxProps":return R.createElement(Tj,_object_spread_props(_object_spread({},e),{key:k}));default:return null}},this.addControlSpecificStyles=e=>{var t,n,o,r,i,a,s,l,c,u,d,p,g,h,m;switch(e.type){case"AppButtonProps":case"AppToggleButtonProps":return _object_spread_props(_object_spread({},e),{styles:null!==(t=null===(n=this.props.statusBarStyles)||void 0===n?void 0:n.statusBarButtonStyles)&&void 0!==t?t:e.styles});case"AppStatusTextProps":return _object_spread_props(_object_spread({},e),{iconProps:e.iconProps&&_object_spread_props(_object_spread({},e.iconProps),{styles:null!==(o=null===(r=this.props.statusBarStyles)||void 0===r?void 0:r.statusBarLabelIconStyles)&&void 0!==o?o:e.iconProps.styles}),styles:null!==(i=null===(a=this.props.statusBarStyles)||void 0===a?void 0:a.statusBarLabelStyles)&&void 0!==i?i:e.styles});case"AppFlyoutAnchorProps":return _object_spread_props(_object_spread({},e),{styles:null!==(s=null===(l=this.props.statusBarStyles)||void 0===l?void 0:l.statusBarButtonStyles)&&void 0!==s?s:e.styles,customMenuItemStyles:null===(c=this.props.statusBarStyles)||void 0===c?void 0:c.menuItemStyleClassNames});case"StatusBarZoomControlProps":return _object_spread_props(_object_spread({},e),{increaseZoomButtonProps:_object_spread_props(_object_spread({},e.increaseZoomButtonProps),{styles:null!==(u=null===(d=this.props.statusBarStyles)||void 0===d?void 0:d.statusBarButtonStyles)&&void 0!==u?u:e.increaseZoomButtonProps.styles}),decreaseZoomButtonProps:_object_spread_props(_object_spread({},e.decreaseZoomButtonProps),{styles:null!==(p=null===(g=this.props.statusBarStyles)||void 0===g?void 0:g.statusBarButtonStyles)&&void 0!==p?p:e.decreaseZoomButtonProps.styles}),zoomLevelButtonProps:_object_spread_props(_object_spread({},e.zoomLevelButtonProps),{styles:null!==(h=null===(m=this.props.statusBarStyles)||void 0===m?void 0:m.statusBarButtonStyles)&&void 0!==h?h:e.zoomLevelButtonProps.styles}),appColors:this.props.appColors});default:return e}},this.onResizeGroupReduce=e=>((e,t)=>{const n=function(e){if(e.appliedScalingStepCount===e.scalingSteps.length)return;return cj(e,e.appliedScalingStepCount+1)}(e);if(void 0!==n)return oj(n,t)})(e,this.state.isDoublePortraitLayout),this.onResizeGroupGrow=e=>((e,t)=>{const n=function(e){if(0===e.appliedScalingStepCount)return;return cj(e,e.appliedScalingStepCount-1)}(e);if(void 0!==n)return oj(n,t)})(e,this.state.isDoublePortraitLayout),this.renderPrimaryScreenStatusBar=Object(Jo.c)((e,t)=>n=>{const{left:o,center:r,right:i}=n.scaledStatusBarControls,a=this.state.isDoublePortraitLayout;let s=i;const l=this.props.endRegionPrimaryScreenControlsIds||[];a&&(s=i.filter(e=>l.indexOf(e.id)>=0));const c=pj(e,void 0,void 0,t);return this.renderThreeRegionBar(o,r,s,c.container)}),this.state={isDoublePortraitLayout:Object(wp.isDPMode)()},Object(wp.registerSpanningChanged)(this._spanningChangedStatusBarId,this.spanningChanged)}}_j.contextType=Hm.a;var wj=n(2532),Dj=n(1457),Pj=n(2432),Ij=n(638),Fj=n(495);const Bj=Dj.a.StatusBar,Mj=Object(Ic.connect)((e,t)=>{var n;Object(Rx.j)(Bj);const o={hidden:!(null===(n=TF(e,t))||void 0===n||!n.hidden),controls:jF(e,t),controlRendererFunction:t.controlRendererFunction,endRegionPrimaryScreenControlsIds:wF(e,t),scalingSteps:DF(e,t),isJumbo:t.isJumbo,id:Bj,appliedScalingSteps:PF(e,t),appliedScalingStepsCount:IF(e,t),appColors:t.appColors,statusBarStyles:t.statusBarStyles,location:t.location,isCircularNavigation:t.isCircularNavigation};return Object(Rx.j)(Bj,"Selectors"),o},(e,t)=>({onScalingStepDispatch:(n,o,r)=>Object(Ij.a)().commonSettings().isRelevantSurfacesMappingEnabled()?e(Object(qv.batchActions)([JF(t.id,o,r),Object(wj.a)(Fj.a.StatusBar)])):e(JF(t.id,o,r))}),void 0,{areStatesEqual:(e,t)=>{var n;Object(Rx.f)(Bj);const o=Object(Ij.a)().commandingSettings().isResponsiveUxEnabled()&&!(null===Pj.b||void 0===Pj.b||!Pj.b.includes(Bj))||Object(Ij.a)().commonSettings().isRelevantSurfacesMappingEnabled()&&!(e=>!e.relevantSurfaces||(Fj.a.StatusBar&e.relevantSurfaces)===Fj.a.StatusBar)(e)||!(null===(n=Object(Pc.c)(Bj))||void 0===n||!n(e,t));return Object(Rx.f)(Bj,""+ +o),o}})(Object(Dc.a)(_j)),jj=e=>R.createElement(Kv.a,null,R.createElement(Mj,_object_spread({},e)));var Oj=n(1199),Lj=n(193);const Aj=(e,t)=>Object(Ic.connect)(()=>{let e,t=void 0;return(n,o)=>(t=t||Object(Rx.c)(o.type||o.name||o.displayName||"unknown"),Object(Rx.j)(t),e=_object_spread({},Object(Tc.c)(Object(kc.V)(n),Object(kc.u)(n),o.id,Object(kc.cb)(n),void 0,Object(kc.db)(n),o.location,!0),o),Object(Rx.j)(t,"NC"),e)},void 0,void 0,{areStatesEqual:(e,n,o,r)=>{const i=Object(Rx.c)(o.type||o.name||o.displayName||"unknown");Object(Rx.f)(i);const a=Object(Pc.c)(i),s=a?a(e,n):e===n;if(s||!o.id||!Object(Oj.a)(Object(kc.db)(e),Lj.a))return Object(Rx.f)(i,"_base-"+s),s;const l=null==t?void 0:t(n)[r.id],c=null==t?void 0:t(e)[o.id],u=Object(Pc.a)(l,c);return Object(Rx.f)(i,"_ase-"+u),u}})(Object(Dc.a)(e)),Nj=Aj(LB,kc.g),Wj=Aj(kM,kc.yb),zj=Aj(nM,kc.F),Hj=Aj(Tj,kc.l),Vj=Aj(EM,kc.T),Uj=Aj(KM,kc.lb);class Gj extends R.Component{render(){return R.createElement(nR.a,null,R.createElement(Ic.Provider,{store:Zv.a},R.createElement(we.a,null,e=>{var t,n,o;return R.createElement(jj,{id:this.props.id,isJumbo:this.props.isJumbo,statusBarStyles:null===(t=(n=this.props).getStatusBarStyles)||void 0===t?void 0:t.call(n,e),location:this.props.location,controlRendererFunction:Object(Ij.a)().commonSettings().isStatusBarStoreConnectedEnabled()?(o=Po.a,e=>{switch(e.type){case"AppButtonProps":return t=e,R.createElement(Nj,_object_spread_props(_object_spread({},t),{location:t.location||Jc.b.StatusBar}));case"AppToggleButtonProps":return(e=>R.createElement(Wj,_object_spread_props(_object_spread({},e),{location:e.location||Jc.b.StatusBar})))(e);case"AppFlyoutAnchorProps":return function(e){return t=>R.createElement(zj,_object_spread_props(_object_spread({},t),{downChevronIcon:e.downChevron,location:t.location||Jc.b.StatusBar}))}(o)(e);case"AppComboBoxProps":return function(e){return t=>R.createElement(Hj,_object_spread_props(_object_spread({},t),{downChevronIcon:e.downChevron,location:t.location||Jc.b.StatusBar}))}(o)(e);case"AppStatusTextProps":return(e=>R.createElement(Vj,_object_spread_props(_object_spread({},e),{location:e.location||Jc.b.StatusBar})))(e);case"AppSliderProps":return(e=>R.createElement(Uj,_object_spread_props(_object_spread({},e),{location:e.location||Jc.b.StatusBar})))(e);default:throw new Error("control not implemented in storeConnected renderer "+JSON.stringify(e))}var t}):void 0})})))}}const qj=Object(Jo.c)(e=>{const t=lB(e);return{statusBarButtonStyles:Xj(e),statusBarLabelIconStyles:$j,statusBarLabelStyles:eO(),statusBarRegionStyles:Object(F.db)(Jj(e),Yj()),menuItemStyleClassNames:Zj(t),statusBarContainerStyles:Kj(t)}}),Qj=(e,t,n,o)=>({marginLeft:e,marginRight:t,marginTop:n,marginBottom:o}),Kj=Object(Jo.c)(e=>({outerContainer:{backgroundColor:e.whiteBackground,paddingLeft:0,paddingRight:0,height:22}})),Jj=Object(Jo.c)(e=>({[YM.left]:{justifyContent:"left",left:0,whiteSpace:"nowrap","[data-unique-id=StatusBar-ExternalLinksButton]":{i:{width:"16px",height:"16px"},width:"28px"}},[YM.center]:_object_spread_props(_object_spread({justifyContent:"center"},Qj(5,5,0,0)),{whiteSpace:"nowrap"}),[YM.right]:{justifyContent:"right",whiteSpace:"nowrap","[data-unique-id*=ZoomDecrease]":{width:"28px"},"[data-unique-id*=ZoomIncrease]":{width:"28px"},"[data-unique-id*=ToggleFullScreenButton]":{i:{width:"16px",height:"16px"},width:"28px",paddingBottom:"2px"},"#ToggleFullScreenButton .ms-Button-label":{display:"none"},".ms-Button:first-child svg":{fill:e.palette.neutralPrimaryAlt},"#ZoomStatusBarMenuOpen .ms-Button-label":{minWidth:30,justifyContent:"center"}}})),Yj=Object(Jo.c)(()=>({[YM.right]:{"[data-unique-id=StatusBar-KeyboardShortcutsButton], [data-unique-id=StatusBar-HelpButton], [data-unique-id=StatusBar-GiveFeedbackPane], [data-unique-id=StatusBar-GiveFeedbackButton]":{i:{width:"16px",height:"16px"},width:"28px"}}})),Zj=Object(Jo.c)(e=>Object(F.db)({root:{border:"1px solid transparent",backgroundColor:e.whiteBackground,height:28,paddingLeft:0,paddingRight:0,minWidth:74},linkContent:{height:26,alignItems:"center"},icon:_object_spread_props(_object_spread({width:12,height:12},Qj(7,7,8,8)),{fontSize:0,paddingRight:0,verticalAlign:"top"}),label:_object_spread_props(_object_spread({fontSize:12,fontWeight:400},Qj(7,7,8,8)),{verticalAlign:"top"})})),$j={root:{width:14,height:14}},Xj=Object(Jo.c)(e=>({root:_object_spread_props(_object_spread({paddingLeft:1,paddingRight:1},Qj(2,2,0,0)),{minWidth:0,[F.m]:{MsHighContrastAdjust:"auto"}}),rootHovered:{backgroundColor:e.palette.themeLighter},rootPressed:{backgroundColor:e.palette.themeLight},rootExpanded:{backgroundColor:e.palette.themeLight},rootFocused:{backgroundColor:e.palette.themeLighter},icon:{width:12,height:12}})),eO=Object(Jo.c)(()=>({root:_object_spread({alignItems:"center",userSelect:"none",verticalAlign:"top",paddingLeft:1,paddingRight:1},Qj(2,2,0,0))})),tO=e=>{const t=lB(e);return{statusBarButtonStyles:iO(e),statusBarLabelIconStyles:lO,statusBarLabelStyles:sO,statusBarRegionStyles:oO(t),menuItemStyleClassNames:cO,statusBarContainerStyles:rO(t)}},nO=e=>{const t=lB(e);return{statusBarButtonStyles:aO(e),statusBarLabelIconStyles:lO,statusBarLabelStyles:sO,statusBarRegionStyles:oO(t),menuItemStyleClassNames:cO,statusBarContainerStyles:rO(t)}},oO=e=>({[YM.left]:{flex:"1 0 0px",justifyContent:"flex-start",position:"absolute"},[YM.center]:{flex:"1 1 0px",justifyContent:"center",marginLeft:5,marginRight:5},[YM.right]:{flex:"1 0 0px",justifyContent:"flex-end",position:"absolute",right:0,backgroundColor:e.previewBackground}}),rO=e=>({outerContainer:{height:39,backgroundColor:e.previewBackground}}),iO=e=>({root:{height:42,minWidth:40,border:"1px solid transparent",borderRadius:0,boxSizing:"border-box",paddingLeft:4,paddingRight:4,paddingTop:0,paddingBottom:0,backgroundColor:"transparent"},rootHovered:{backgroundColor:"transparent"},rootExpanded:{backgroundColor:e.palette.themeLight},rootChecked:{backgroundColor:e.palette.themeLight},rootFocused:{backgroundColor:e.palette.themeLight},label:{fontSize:17,fontFamily:'"Segoe UI", "Segoe UI Web", Arial, Verdana, sans-serif',cursor:"default",textAlign:"center",userSelect:"none",whiteSpace:"nowrap",overflow:"visible",textOverflow:"unset",lineHeight:42,margin:"0 4px",paddingTop:0,paddingBottom:0,height:42,display:"flex",alignItems:"center"},icon:{height:20,lineHeight:20,width:20,marginLeft:0,marginRight:0},menuIcon:{height:20,lineHeight:20,width:20,marginLeft:0,marginRight:0}}),aO=e=>({root:{height:42,minWidth:40,border:"1px solid transparent",borderRadius:0,boxSizing:"border-box",paddingLeft:4,paddingRight:4,paddingTop:0,paddingBottom:0,backgroundColor:e.palette.themePrimary,color:e.palette.white},rootHovered:{backgroundColor:e.palette.themeDark,color:e.palette.white},rootExpanded:{backgroundColor:e.palette.themePrimary},rootChecked:{backgroundColor:e.palette.themePrimary},rootFocused:{backgroundColor:e.palette.themePrimary},label:{fontSize:17,fontFamily:'"Segoe UI", "Segoe UI Web", Arial, Verdana, sans-serif',cursor:"default",textAlign:"center",userSelect:"none",whiteSpace:"nowrap",overflow:"visible",textOverflow:"unset",lineHeight:42,margin:"0 4px",paddingTop:0,paddingBottom:0,height:42,display:"flex",alignItems:"center"},icon:{height:20,lineHeight:20,width:20,marginLeft:0,marginRight:0},menuIcon:{height:20,lineHeight:20,width:20,marginLeft:0,marginRight:0}}),sO={root:{display:"flex",flexWrap:"nowrap",alignItems:"center",userSelect:"none",padding:"0 9px 0 0"},label:{overflow:"hidden",overflowX:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontWeight:400,fontSize:17,cursor:"default !important"}},lO={root:{width:32,height:32,alignItems:"center",paddingRight:9,fontWeight:600}},cO=Object(F.db)({outerHeight:50,innerHeight:48,icon:{width:20,height:20,lineHeight:20},label:{fontSize:14},linkContent:{height:50,display:"flex",alignItems:"center",position:"relative"},root:{height:50,lineHeight:50,border:"0px solid transparent",selectors:{":hover":{backgroundColor:"transparent",outlineColor:"transparent"},":focus":{backgroundColor:"transparent",outlineColor:"transparent"}}}});var uO=n(261),dO=n(414),pO=Object(Rk.strEnum)(["ToggleDevServer","ToggleOOUIDevServer","PasteShortcutEnabledLabel","ClassificationLabel","SheetNumber","WorkbookStatisticsButton","FilteredResultsButton","PageLoadStatsDialog","CoauthInfraStatistics","SelectionModeLabel","EndModeLabel","ExternalLinksButton","ExternalLinksRefreshLabel","LongTasksCount","CenterStatusLabel","MergeSuspensionSafeState","OcsConnectionStatus","EnvironmentName","PhaseStatus","DataSourceDirtinessButton","NetworkInformation","ExcelLiveViewState","NetworkDisconnectedLabel","NetworkConnectedLabel","OfficeAddinLabel","QueryAverageLabel","QueryCountLabel","QueryNumericalCountLabel","QueryMinimumLabel","QueryMaximumLabel","QuerySumLabel","CustomizeStatusBarMenuOpen","ToggleAverageButton","ToggleCountButton","ToggleNumericalCountButton","ToggleMinButton","ToggleMaxButton","ToggleSumButton","HelpButton","KeyboardShortcutsButton","GiveFeedbackButton","GiveFeedbackPane","ZoomDecrease","ZoomStatusBarMenuOpen","ZoomIncrease","Zoom200","Zoom175","Zoom150","Zoom125","Zoom100","Zoom75","Zoom50","Zoom25","ToggleFullScreenButton","ZoomComboBox"]);function gO(e){return function(e,t){return e?t.filter(t=>void 0===e[t.id]||e[t.id]):t}(e,[Object(uO.a)(pO.ToggleDevServer,"DevServer Status: Unknown",{toggled:!0}),Object(uO.a)(pO.ToggleOOUIDevServer,"OOUI: Unknown",{toggled:!0}),Object(GF.b)(pO.PasteShortcutEnabledLabel,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.EnterToPaste),{hidden:!0}),Object(GF.b)(pO.ClassificationLabel,"",{hidden:!0,iconSet:{default:c.a.SBStatusBarMarkAsReadOnly_16,icon16:c.a.SBProtectForm_16},ariaLiveAssertiveness:"off"}),Object(HF.a)(pO.SheetNumber,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SheetNumber),{customTooltip:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SheetNumber)}),Object(HF.a)(pO.WorkbookStatisticsButton,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.WorkbookStatistics),{customTooltip:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.WorkbookStatistics)}),Object(HF.a)(pO.FilteredResultsButton,"",{iconSet:{default:c.a.Filter_16},hidden:!0}),Object(HF.a)(pO.PageLoadStatsDialog,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PageLoadStatistics),{customTooltip:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PageLoadStatistics)}),Object(HF.a)(pO.CoauthInfraStatistics,"CoauthInfraStatistics",{customTooltip:"CoauthInfraStatistics"}),Object(GF.b)(pO.SelectionModeLabel,"",{hidden:!0,ariaLiveAssertiveness:"off"}),Object(GF.b)(pO.EndModeLabel,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.EndMode),{hidden:!0,ariaLiveAssertiveness:"off"}),Object(HF.a)(pO.ExternalLinksButton,"",{hidden:!0,customTooltip:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ExternalLinksStatusBarTooltip),iconSet:{default:be.a.LinkStatus_16},hideLabel:!0}),Object(GF.b)(pO.ExternalLinksRefreshLabel,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ExternalLinksRefreshingStatusBarLabel),{hidden:!0,ariaLiveAssertiveness:"off"}),Object(GF.b)(pO.LongTasksCount,"",{customTooltip:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.LongTaskTooltip),hidden:!0,ariaLiveAssertiveness:"off"}),Object(GF.b)(pO.CenterStatusLabel,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.TextForOfficeOnlineInGallatin),{ariaLiveAssertiveness:"off"}),Object(uO.a)(pO.MergeSuspensionSafeState,"",{toggled:!0}),Object(GF.b)(pO.OcsConnectionStatus,"",{hidden:!0,ariaLiveAssertiveness:"off"}),Object(GF.b)(pO.EnvironmentName,"",{hidden:!0,ariaLiveAssertiveness:"off"}),Object(GF.b)(pO.PhaseStatus,"",{hidden:!0,ariaLiveAssertiveness:"off"}),Object(HF.a)(pO.DataSourceDirtinessButton,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.DataSourceDirtiness),{hidden:!0}),Object(GF.b)(pO.NetworkInformation,"",{hidden:!0,ariaLiveAssertiveness:"off"}),Object(GF.b)(pO.ExcelLiveViewState,"",{hidden:!0,ariaLiveAssertiveness:"off"}),Object(GF.b)(pO.NetworkDisconnectedLabel,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.Disconnected),{iconSet:{default:be.a.AlertWarning_16},hidden:!0,ariaLiveAssertiveness:"off"}),Object(GF.b)(pO.NetworkConnectedLabel,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.Connected),{hidden:!0,ariaLiveAssertiveness:"off"}),Object(HF.a)(pO.OfficeAddinLabel,"",{iconSet:{default:c.a.AppForOfficeLogo_20},customTooltip:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.Addins),hidden:!0}),Object(GF.b)(pO.QueryAverageLabel,"",{hidden:!0,ariaLiveAssertiveness:"off"}),Object(GF.b)(pO.QueryCountLabel,"",{hidden:!0,ariaLiveAssertiveness:"off"}),Object(GF.b)(pO.QueryNumericalCountLabel,"",{hidden:!0,ariaLiveAssertiveness:"off"}),Object(GF.b)(pO.QueryMinimumLabel,"",{hidden:!0,ariaLiveAssertiveness:"off"}),Object(GF.b)(pO.QueryMaximumLabel,"",{hidden:!0,ariaLiveAssertiveness:"off"}),Object(GF.b)(pO.QuerySumLabel,"",{hidden:!0,ariaLiveAssertiveness:"off"}),Object(uO.a)(pO.ToggleAverageButton,"",{customTooltip:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.AverageDescription),iconSet:{default:c.a.CheckmarkGlyph_8},toggleUsingIcon:!0,dismissHostingSurfaceOnExecute:!1}),Object(uO.a)(pO.ToggleCountButton,"",{customTooltip:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.CountDescription),iconSet:{default:c.a.CheckmarkGlyph_8},toggleUsingIcon:!0,dismissHostingSurfaceOnExecute:!1}),Object(uO.a)(pO.ToggleNumericalCountButton,"",{customTooltip:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NumericalCountDescription),iconSet:{default:c.a.CheckmarkGlyph_8},toggleUsingIcon:!0,dismissHostingSurfaceOnExecute:!1}),Object(uO.a)(pO.ToggleMaxButton,"",{customTooltip:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.MaximumDescription),iconSet:{default:c.a.CheckmarkGlyph_8},toggleUsingIcon:!0,dismissHostingSurfaceOnExecute:!1}),Object(uO.a)(pO.ToggleMinButton,"",{customTooltip:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.MinimumDescription),iconSet:{default:c.a.CheckmarkGlyph_8},toggleUsingIcon:!0,dismissHostingSurfaceOnExecute:!1}),Object(uO.a)(pO.ToggleSumButton,"",{customTooltip:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SumDescription),iconSet:{default:c.a.CheckmarkGlyph_8},toggleUsingIcon:!0,dismissHostingSurfaceOnExecute:!1}),Object(VF.a)(pO.CustomizeStatusBarMenuOpen,"",{iconSet:{default:c.a.CommonControlChevronDownGlyph_8},customTooltip:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.CustomiseStatusBar),hideChevron:!0,menuModel:Object(UF.a)([Object(UF.b)([pO.ToggleAverageButton,pO.ToggleCountButton,pO.ToggleNumericalCountButton,pO.ToggleMinButton,pO.ToggleMaxButton,pO.ToggleSumButton])],ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.CustomiseStatusBar))}),Object(HF.a)(pO.KeyboardShortcutsButton,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.KeyboardShortcutsDialogButtonLabel),{iconSet:{default:be.a.KeyboardShortcuts_16},customTooltip:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.KeyboardShortcutsDialogButtonLabel),hideLabel:!0}),Object(HF.a)(pO.HelpButton,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.HelpResources),{iconSet:{default:be.a.QuestionCircle_16},customTooltip:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.HelpResources),hideLabel:!0}),Object(HF.a)(pO.GiveFeedbackButton,"",{iconSet:{default:be.a.PersonFeedback_16},customTooltip:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.HelpImproveOffice),hideLabel:!0}),Object(HF.a)(pO.GiveFeedbackPane,"",{iconSet:{default:be.a.PersonFeedback_16},customTooltip:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.HelpImproveOffice),hideLabel:!0}),Object(HF.a)(pO.ZoomDecrease,"",{customTooltip:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.StatusBarZoomOut),iconSet:{default:c.a.CommonControlSliderMinus_12},hideLabel:!0}),...$u.a.isZoomComboBoxEnabledInStatusBar()?[Object(dO.e)(pO.ZoomComboBox,"",{keytip:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ZoomKeytip),iconSet:{default:"",alternateIcon:c.a.ZoomCurrent100_20},selectedKey:"100",options:[Object(dO.d)("25",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ZoomTo25)),Object(dO.d)("50",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ZoomTo50)),Object(dO.d)("75",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ZoomTo75)),Object(dO.d)("100",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ZoomTo100)),Object(dO.d)("125",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ZoomTo125)),Object(dO.d)("150",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ZoomTo150)),Object(dO.d)("175",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ZoomTo175)),Object(dO.d)("200",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ZoomTo200))],customTooltip:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ZoomToolTip),width:52,showLabel:!1},dO.a.FreeForm)]:[Object(HF.a)(pO.Zoom200,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ZoomTo200)),Object(HF.a)(pO.Zoom175,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ZoomTo175)),Object(HF.a)(pO.Zoom150,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ZoomTo150)),Object(HF.a)(pO.Zoom125,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ZoomTo125)),Object(HF.a)(pO.Zoom100,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ZoomTo100)),Object(HF.a)(pO.Zoom75,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ZoomTo75)),Object(HF.a)(pO.Zoom50,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ZoomTo50)),Object(HF.a)(pO.Zoom25,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ZoomTo25)),Object(VF.a)(pO.ZoomStatusBarMenuOpen,"Zoom",{customTooltip:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ZoomToolTip),hideChevron:!0,menuModel:Object(UF.a)([Object(UF.b)([pO.Zoom200,pO.Zoom175,pO.Zoom150,pO.Zoom125,pO.Zoom100,pO.Zoom75,pO.Zoom50,pO.Zoom25])])})],Object(HF.a)(pO.ZoomIncrease,"",{customTooltip:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.StatusBarZoomIn),iconSet:{default:c.a.CommonControlSliderPlus_12},hideLabel:!0}),Object(uO.a)(pO.ToggleFullScreenButton,"",{customTooltip:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FullScreen),iconSet:{default:be.a.FullScreenMaximize_16}})])}function hO(e){const t=bO(e,[pO.ToggleDevServer,pO.ToggleOOUIDevServer,pO.PasteShortcutEnabledLabel,pO.ClassificationLabel,pO.SheetNumber,pO.WorkbookStatisticsButton,pO.FilteredResultsButton,pO.PageLoadStatsDialog,pO.CoauthInfraStatistics,pO.SelectionModeLabel,pO.EndModeLabel,pO.ExternalLinksButton,pO.ExternalLinksRefreshLabel]),n=bO(e,[pO.LongTasksCount,pO.CenterStatusLabel,pO.MergeSuspensionSafeState,pO.OcsConnectionStatus,pO.EnvironmentName,pO.PhaseStatus,pO.DataSourceDirtinessButton,pO.NetworkInformation,pO.ExcelLiveViewState]),o=bO(e,[pO.NetworkDisconnectedLabel,pO.NetworkConnectedLabel,pO.OfficeAddinLabel,pO.QueryAverageLabel,pO.QueryCountLabel,pO.QueryNumericalCountLabel,pO.QueryMinimumLabel,pO.QueryMaximumLabel,pO.QuerySumLabel,pO.CustomizeStatusBarMenuOpen,pO.KeyboardShortcutsButton,pO.HelpButton,pO.GiveFeedbackButton,pO.GiveFeedbackPane,pO.ZoomDecrease,$u.a.isZoomComboBoxEnabledInStatusBar()?pO.ZoomComboBox:pO.ZoomStatusBarMenuOpen,pO.ZoomIncrease,pO.ToggleFullScreenButton]);return[qF(NF.ExcelStatusBar,{left:t,center:n,right:o}),QF(NF.ExcelStatusBar,pO.ZoomDecrease),$u.a.isZoomComboBoxEnabledInStatusBar()?QF(NF.ExcelStatusBar,pO.ZoomComboBox):QF(NF.ExcelStatusBar,pO.ZoomStatusBarMenuOpen),QF(NF.ExcelStatusBar,pO.ZoomIncrease)]}function mO(e){return function(e,t){return e?t.filter(t=>e[t.controlId]):t}(e,[sj(pO.ZoomIncrease),sj(pO.ZoomDecrease),$u.a.isZoomComboBoxEnabledInStatusBar()?sj(pO.ZoomComboBox):sj(pO.ZoomStatusBarMenuOpen),sj(pO.ToggleFullScreenButton),ij(pO.ExcelLiveViewState),ij(pO.NetworkInformation),ij(pO.PhaseStatus),ij(pO.EnvironmentName),ij(pO.OcsConnectionStatus),ij(pO.CenterStatusLabel),ij(pO.LongTasksCount),aj(pO.MergeSuspensionSafeState),aj(pO.DataSourceDirtinessButton),aj(pO.ExternalLinksRefreshLabel),ij(pO.ExternalLinksButton),ij(pO.EndModeLabel),ij(pO.SelectionModeLabel),aj(pO.CoauthInfraStatistics),aj(pO.WorkbookStatisticsButton),aj(pO.FilteredResultsButton),aj(pO.SheetNumber),aj(pO.PageLoadStatsDialog),ij(pO.ClassificationLabel),ij(pO.PasteShortcutEnabledLabel),aj(pO.ToggleOOUIDevServer),aj(pO.ToggleDevServer),ij(pO.NetworkDisconnectedLabel),ij(pO.NetworkConnectedLabel),aj(pO.OfficeAddinLabel),ij(pO.QueryAverageLabel),ij(pO.QueryCountLabel),ij(pO.QueryNumericalCountLabel),ij(pO.QueryMinimumLabel),ij(pO.QueryMaximumLabel),ij(pO.QuerySumLabel),aj(pO.CustomizeStatusBarMenuOpen),aj(pO.GiveFeedbackPane),aj(pO.GiveFeedbackButton),aj(pO.ZoomDecrease),aj(pO.ZoomIncrease),$u.a.isZoomComboBoxEnabledInStatusBar()?aj(pO.ZoomComboBox):aj(pO.ZoomStatusBarMenuOpen)])}function bO(e,t){return e?t.filter(t=>e[t]):t}const fO=Object(zD.a)("StatusBar:initializeStatusBarInStore",e=>{ZF(),Object(cC.a)([Object(x.isChangeGateEnabled)("OfficeVSO:8917687_RestrictModelCreationToWhiteListedControls")?Object(ZP.a)(gO(e)):Object(ZP.a)(gO()),...hO(e),KF(NF.ExcelStatusBar,mO(e))])});var xO=Object(Rk.strEnum)(["SaveAsToOneDrive"]);function EO(){const e=Object($c.h)("OpenFromURLTreatment2"),t=e?ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.SaveAndEdit):OfficeCommonStringsManager.get(OfficeCommonStringsEnum.SaveACopyToOneDriveTitle);return[Object(HF.a)(xO.SaveAsToOneDrive,t,{customTooltip:t,iconSet:{default:e?c.a.EditGeneric_16:c.a.UploadtoCloudMonochromaticGlyph_16}})]}function SO(e){const t=CO(e,[]),n=CO(e,[]),o=CO(e,[xO.SaveAsToOneDrive]);return[qF(NF.ExcelPreviewToolbar,{left:t,center:n,right:o})]}function yO(e){return function(e,t){return e?t.filter(t=>e[t.controlId]):t}(e,[])}function CO(e,t){return e?t.filter(t=>e[t]):t}const vO=Object(zD.a)("StatusBar:initializePreviewToolbarInStore",e=>{ZF(),Object(cC.a)([Object(ZP.a)(EO()),...SO(e),KF(NF.ExcelPreviewToolbar,yO(e))])});let RO="";const kO=Object(zD.a)("StatusBar:initializeNewExcelStatusBar",(e,t,n)=>{switch(n){case NF.ExcelViewerToolbar:RO="StatusBar:renderExcelStatusBar",eB();break;case NF.ExcelStatusBar:RO="StatusBar:renderStatusBar",fO(null==t?void 0:t.whitelistedControlIds);break;case NF.ExcelPreviewToolbar:RO="StatusBar:renderPreviewToolbar",vO(null==t?void 0:t.whitelistedControlIds)}setTimeout(()=>{TO(e,n)},0)}),TO=Object(zD.a)(RO,(e,t)=>{const n=t===NF.ExcelViewerToolbar,o=t===NF.ExcelPreviewToolbar;let r=qj;o?r=nO:n&&(r=tO),e&&k.render(R.createElement(Gj,{id:t,isJumbo:n||o,getStatusBarStyles:r,location:n||o?Jc.b.Ribbon:Jc.b.StatusBar}),e)}),_O={initializeNewStatusBar:kO,selectors:WF};function wO(){return(wO=_async_to_generator((function*(e){yield Qf(e)}))).apply(this,arguments)}const DO={initializeFeedbackModal:function(e,t,n,o){const r=e;r.onDismiss=t,r.onError=n,r.extractFeedbackDataForHost=o,r.uiType=Ff.g.Modal,r.hostPlatform=Ff.c.Web;const l={customerUiWrapperFeedbackData:r};if(l&&l.customerUiWrapperFeedbackData)try{i.a.sendTraceTag(508957007,a.a.msoulscat_Wac_WacFeedback,s.a.Info,Of("Centro-based Feedback Modal invoked ","OOUI initializeFeedbackModal",r.clientFeedbackId));const e=r.initializationComplete;l.customerUiWrapperFeedbackData.initializationComplete=t=>{null==e||e(t),i.a.sendTraceTag(508952737,a.a.msoulscat_Wac_WacFeedback,s.a.Info,Of("Feedback initialization complete result: "+JSON.stringify(t),"OOUI initializeFeedbackModal initializationComplete",r.clientFeedbackId))},qf(l)}catch(e){i.a.sendTraceTag(508956946,a.a.msoulscat_Wac_WacFeedback,s.a.Error,Of("Centro Initialization failed due to internal error => "+e,"OOUI initializeFeedbackModal",r.clientFeedbackId))}else i.a.sendTraceTag(508957008,a.a.msoulscat_Wac_WacFeedback,s.a.Error,Of("Centro Initialization failed for OCV Inapp Feedback due to missing feedback Taskpane props","OOUI initializeFeedbackModal",r.clientFeedbackId))},preloadFeedbackContext:function(e){return wO.apply(this,arguments)},convertCustomerUiWrapperFeedbackDataToHvcFormat:Vf};var PO=n(283),IO=n(2577);const FO={months:[ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.calendarMonth_January),ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.calendarMonth_February),ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.calendarMonth_March),ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.calendarMonth_April),ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.calendarMonth_May),ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.calendarMonth_June),ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.calendarMonth_July),ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.calendarMonth_August),ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.calendarMonth_September),ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.calendarMonth_October),ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.calendarMonth_November),ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.calendarMonth_December)],shortMonths:[ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.januaryAbbreviated),ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.februaryAbbreviated),ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.marchAbbreviated),ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.aprilAbbreviated),ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.mayAbbreviated),ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.juneAbbreviated),ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.julyAbbreviated),ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.augustAbbreviated),ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.septemberAbbreviated),ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.octoberAbbreviated),ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.novemberAbbreviated),ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.decemberAbbreviated)],days:[ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.calendarDayOfWeek_Sunday),ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.calendarDayOfWeek_Monday),ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.calendarDayOfWeek_Tuesday),ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.calendarDayOfWeek_Wednesday),ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.calendarDayOfWeek_Thursday),ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.calendarDayOfWeek_Friday),ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.calendarDayOfWeek_Saturday)],shortDays:[ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.calendarDayOfWeek_Su),ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.calendarDayOfWeek_Mo),ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.calendarDayOfWeek_Tu),ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.calendarDayOfWeek_We),ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.calendarDayOfWeek_Th),ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.calendarDayOfWeek_Fr),ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.calendarDayOfWeek_Sa)],goToToday:ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.goToTodayString),prevMonthAriaLabel:ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.goToPreviousMonthStringLowerCaseText),nextMonthAriaLabel:ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.goToNextMonthStringLowerCaseText),prevYearAriaLabel:ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.goToPreviousYearStringLowerCaseText),nextYearAriaLabel:ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.goToNextYearStringLowerCaseText),prevYearRangeAriaLabel:ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.goToPreviousYearRangeStringLowerCaseText),nextYearRangeAriaLabel:ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.goToNextYearRangeStringLowerCaseText),monthPickerHeaderAriaLabel:ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.monthPickerHeaderAriaLabel),yearPickerHeaderAriaLabel:ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.yearPickerHeaderAriaLabel),weekNumberFormatString:ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.weekNumberFormatString),selectedDateFormatString:ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.selectedDateFormatString),todayDateFormatString:ExcelDatepickerStringsManager.get(ExcelDatepickerStringsEnum.todayDateFormatString)},BO=new Date(1900,0,1),MO=new Date(9999,11,31),jO=R.createRef(),OO=R.memo(R.forwardRef((e,t)=>{const[n,o]=Object(R.useState)(e.isVisible),[r,i]=Object(R.useState)(!1),a=e.onDatePickerMount,s=R.useRef(e.cellDateValue),l=new Date,c=Object(x.isChangeGateEnabled)("OfficeVSO:8849123_EnableGotoTodayDatepicker");Object(R.useEffect)(()=>{s.current=e.cellDateValue,o(e.isVisible),i(!1)},[e.isVisible,e.cellDateValue]),Object(R.useImperativeHandle)(t,()=>({hideDatePicker:()=>{o(!1)}}));const u=R.useCallback(e=>{e&&(e.focus=()=>Object(Il.c)(e),a(e))},[a]);return R.createElement(os.a,{role:"dialog","aria-live":"polite",ariaLabel:r?ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FocusDatePicker):Object(de.f)()?ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ShowDatePickerMac):ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ShowDatePicker),onPointerDown:()=>{r||(i(!0),e.preserveFocus())},onFocus:()=>i(!0),className:Object(F.eb)([{display:"flex",flexDirection:"column",position:"absolute",alignItems:"center"}]),target:e.anchorElement,isBeakVisible:!1,hidden:!n,onDismiss:()=>{o(!1),e.restoreFocus()},setInitialFocus:!1,finalHeight:300,focusTrapProps:{isClickableOutsideFocusTrap:!0,ignoreExternalFocusing:!0,focusPreviouslyFocusedInnerElement:!0,disableFirstFocus:!0},directionalHint:e.isRTL?Se.a.leftTopEdge:Se.a.rightTopEdge},R.createElement("div",{ref:u,"aria-hidden":!r,className:Object(F.eb)({fontFamily:"Segoe UI",display:"flex",flexDirection:"column",width:"221px",boxShadow:"0px 1.2px 3.6px rgba(0, 0, 0, 0.1), 0px 6.4px 14.4px rgba(0, 0, 0, 0.13);",borderRadius:"2px"})},R.createElement(IO.a,{calendarDayProps:{customDayCellRef:c?(t,n,o)=>{var r;if(Object(PO.f)(n,l))o.dayIsToday&&o.daySelected&&(null==t||null===(r=t.firstElementChild)||void 0===r||null===(r=r.classList)||void 0===r||r.replace(o.dayIsToday,o.daySelected));else if(Object(PO.f)(n,e.cellDateValue)){var i;o.dayIsToday&&(null==t||null===(i=t.firstElementChild)||void 0===i||null===(i=i.classList)||void 0===i||i.add(o.dayIsToday))}else{var a;o.dayIsToday&&(null==t||null===(a=t.firstElementChild)||void 0===a||null===(a=a.classList)||void 0===a||a.remove(o.dayIsToday))}}:(e,t,n)=>{var o;Object(PO.f)(t,l)&&n.dayIsToday&&(null==e||null===(o=e.firstElementChild)||void 0===o||null===(o=o.classList)||void 0===o||o.remove(n.dayIsToday))},styles:c?{root:{paddingBottom:"0px"}}:{}},minDate:BO,maxDate:MO,showMonthPickerAsOverlay:!0,highlightSelectedMonth:!0,showGoToToday:c,onSelectDate:t=>{o(!1),e.onDateSelected(t)},value:s.current,strings:FO})))}));function LO(e,t,n,o,r,i,a,s,l){k.render(R.createElement(OO,{ref:jO,anchorElement:t,isVisible:n,cellDateValue:o,onDateSelected:r,restoreFocus:i,preserveFocus:a,onDatePickerMount:s,isRTL:l}),e)}function AO(){var e;null===(e=jO.current)||void 0===e||e.hideDatePicker()}var NO;!function(e){e[e.EMPTY_RANGE=0]="EMPTY_RANGE",e[e.RANGE_CREATED=1]="RANGE_CREATED"}(NO||(NO={}));const WO=Object(Jo.c)(e=>({calloutStyles:{root:{padding:"12px",borderRadius:"4px",boxShadow:e.effects.elevation16,border:"none",marginLeft:"-4px",".nameBox-statusCallout-subText":{padding:"0px 2px",borderRadius:"2px",margin:"0px 4px",fontWeight:600,fontSize:"12px",lineHeight:"16px",backgroundColor:e.palette.neutralLight,color:e.palette.neutralPrimaryAlt,alignSelf:"center"},".nameBox-statusCallout-subTitle":{fontWeight:400,display:"flex"}},beak:{left:"25px !important"},beakCurtain:{borderRadius:"4px"},calloutMain:{lineHeight:"20px"}},headingStyles:{root:{fontSize:"14px",fontWeight:"600",wordBreak:"break-all"}}})),zO=Object(Jo.c)(()=>({[NO.EMPTY_RANGE]:{icon:d.a.AlertError_16,heading:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameRangeStatusCalloutHeaderEmptyRange),subtext:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameRangeStatusCalloutBodyEmptyRange)},[NO.RANGE_CREATED]:{icon:d.a.ToDoTask_16,heading:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.NameRangeStatusCalloutHeaderRangeCreated)}})),HO=e=>{const t=zO()[e.calloutType],n=R.useRef(null),[o,r]=R.useState(!1),i=R.useCallback(()=>{n.current&&clearTimeout(n.current)},[n]),a=R.useCallback(()=>{e.disableAutoDismiss||(n.current=setTimeout(()=>{r(!0)},5e3))},[n,e.disableAutoDismiss]);return R.useEffect(()=>(r(!1),a(),()=>{i()}),[e,a,i]),R.createElement(we.a,null,n=>{const s=WO(n);return R.createElement(Nl.a,_object_spread({target:"#FormulaBar-NameBox",role:"alert",beakWidth:8,directionalHint:Se.a.bottomLeftEdge,directionalHintFixed:!0,calloutWidth:292,hidden:o,styles:s.calloutStyles},Object(x.isChangeGateEnabled)("OfficeVSO:8508794_ChangesNameBoxCalloutDimissLogic")?{dismissOnTargetClick:!0,preventDismissOnEvent:()=>!1,onDismiss:()=>{i(),r(!0)}}:{onMouseEnter:i,onMouseLeave:a}),R.createElement(At.a,{horizontal:!0,tokens:{childrenGap:8}},R.createElement(At.a.Item,null,R.createElement(fe.a,{iconName:t.icon,style:{width:20,height:20}})),R.createElement(At.a.Item,null,R.createElement(At.a,null,R.createElement(At.a.Item,null,R.createElement(rs.a,{as:"h2",styles:s.headingStyles},e.calloutType===NO.EMPTY_RANGE?t.heading:t.heading.replace("{0}",e.rangeName))),R.createElement("div",{className:"nameBox-statusCallout-subTitle"},e.calloutType===NO.EMPTY_RANGE?t.subtext:e.sheetName,e.calloutType===NO.RANGE_CREATED&&R.createElement("span",{className:"nameBox-statusCallout-subText"},e.reference))))))})};function VO(e,t,n,o,r){k.render(R.createElement(HO,{calloutType:t,rangeName:n,sheetName:o,reference:r}),e)}var UO,GO=n(1378);!function(e){e[e.SUCCESS=0]="SUCCESS",e[e.FAILURE=1]="FAILURE"}(UO||(UO={}));const qO=Object(Jo.c)(()=>({[UO.SUCCESS]:{icon:d.a.ToDoTask_16,heading:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.CopySheetStatusCalloutTitle),subtext:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.CopySheetStatusCalloutBody)},[UO.FAILURE]:{icon:d.a.AlertError_16,heading:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.CopySheetStatusFailedCallout)}})),QO=()=>!1,KO=e=>{const t=qO()[e.calloutType],n=R.useRef(null),[o,r]=R.useState(!1),i=R.useCallback(()=>{n.current&&clearTimeout(n.current)},[n]),a=R.useCallback(()=>{e.disableAutoDismiss||(n.current=setTimeout(()=>{r(!0)},5e3))},[n,e.disableAutoDismiss]);return R.useEffect(()=>(r(!1),a(),()=>{i()}),[e,a,i]),R.createElement(we.a,null,n=>{const a=Object(GO.a)(n);return R.createElement(Nl.a,{target:document.querySelector(".tab-active"),role:"tooltip",beakWidth:8,directionalHint:Se.a.topLeftEdge,directionalHintFixed:!0,hidden:o,styles:a.calloutStyles,dismissOnTargetClick:!0,preventDismissOnEvent:QO,onDismiss:()=>{i(),r(!0)},"aria-live":"assertive"},R.createElement(At.a,{horizontal:!0,tokens:{childrenGap:8}},R.createElement(At.a.Item,null,R.createElement(fe.a,{iconName:t.icon,style:a.iconStyles})),R.createElement(At.a.Item,null,R.createElement(At.a,null,R.createElement(At.a.Item,null,R.createElement(rs.a,{as:"h2",styles:a.headingStyles},e.calloutType===UO.SUCCESS?t.heading.replace("{0}",e.sheetName):t.heading)),R.createElement("div",{className:"copySheet-statusCallout-subTitle"},t.subtext)))))})};function JO(e,t){k.render(R.createElement(KO,{sheetName:e,calloutType:t}),document.createElement("div"))}var YO=n(2566);const ZO=Object(Jo.c)(e=>({calloutStyles:{root:{padding:"12px 12px 10px 8px",borderRadius:"4px",boxShadow:e.effects.elevation16,border:"none",marginLeft:"-4px",cursor:"default"},beak:{left:"30px !important"},beakCurtain:{borderRadius:"4px"},calloutMain:{lineHeight:"20px"}},headingStyles:{root:{fontSize:"14px",fontWeight:"600",lineHeight:"20px",color:e.palette.black}},headerTitleAndButtonStyles:{display:"flex",flexDirection:"column",marginLeft:"12px",marginRight:"26px"},buttonStyles:{root:{overflow:"hidden",width:"59px",height:"25px",textAlign:"center",fontSize:"12px",fontWeight:"600",color:e.palette.white,marginBottom:"2px",marginTop:"4px",cursor:"pointer",selectors:{":focus":{[F.m]:{borderColor:"highlight",backgroundColor:"highlight",outline:"2px dashed buttonText"}}}}},cloudIconStyles:{root:{width:"20px",height:"20px",selectors:{[F.m]:{fill:"ButtonText !important"}}}},cancelIconStyles:{root:{width:"16px",height:"16px",cursor:"pointer",float:"right",marginTop:"4px",marginRight:"4px",selectors:{[F.m]:{":focus":{borderColor:"highlight",backgroundColor:"highlight"},":hover":{backgroundColor:"highlight !important"}}}}}}));let $O=!1;const XO=R.memo(({renameCalloutHandler:e,refocus:t,titleString:n,iconName:o,buttonString:r})=>{const[l,u]=R.useState(!$O),d=R.useCallback(()=>{i.a.sendTraceTag(508118339,a.a.msoulscat_ES_EWAJS,s.a.Info,"Callout Show me button clicked"),u(!1),e()},[e]),p=R.useCallback(()=>{i.a.sendTraceTag(508118338,a.a.msoulscat_ES_EWAJS,s.a.Info,"Callout closed on cancel"),u(!1),t()},[t]),g=R.useCallback(()=>{i.a.sendTraceTag(508118337,a.a.msoulscat_ES_EWAJS,s.a.Info,"Callout closed on FocusOut"),u(!1),t()},[t]),h=R.useCallback(()=>{i.a.sendTraceTag(508117123,a.a.msoulscat_ES_EWAJS,s.a.Info,"Callout closed on TimeOut"),u(!1),t()},[t]);return R.useEffect(()=>{if($O=l,l){const e=setTimeout(()=>{h()},1e4);return()=>{clearTimeout(e)}}return()=>{}},[l,h]),R.createElement(we.a,null,e=>{const t=ZO(e);return R.createElement(Nl.a,{target:"#DocumentTitle",role:"dialog",dismissOnTargetClick:!0,directionalHint:Se.a.bottomAutoEdge,directionalHintFixed:!0,onDismiss:g,hidden:!l,styles:t.calloutStyles},R.createElement(pv.a,{isClickableOutsideFocusTrap:!0,forceFocusInsideTrap:!1,firstFocusableTarget:"#RenamePromptCalloutButton"},R.createElement("div",null,R.createElement("div",{className:"RenamePromptCalloutHeader",style:{display:"flex",flexDirection:"row"}},R.createElement("div",{className:"RenamePromptCalloutHeaderIcon"},R.createElement(fe.a,{iconName:o,styles:t.cloudIconStyles})),R.createElement("div",{className:"RenamePromptCalloutHeaderTitleAndButton",style:t.headerTitleAndButtonStyles},R.createElement("div",{className:"RenamePromptCalloutHeaderTitle"},R.createElement(rs.a,{as:"h2",styles:t.headingStyles},n)),R.createElement("div",{className:"RenamePromptCalloutFooter-Button"},R.createElement(Wd.a,{id:"RenamePromptCalloutButton","data-testid":"RenamePromptCalloutButton",text:r,onClick:d,styles:t.buttonStyles,role:"button","aria-label":r}))),R.createElement("div",{className:"RenamePromptCalloutHeaderClose"},R.createElement(is.a,{id:"RenamePromptCalloutCloseButton","data-testid":"RenamePromptCalloutCloseButton",styles:t.cancelIconStyles,onClick:p,iconProps:Object(mi.a)(c.a.CancelGlyph_20),"aria-label":ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.Close)}))))))})});function eL(e,t,n,o,r){k.render(R.createElement(XO,{renameCalloutHandler:e,refocus:t,titleString:n,iconName:o,buttonString:r}),document.createElement("div"))}function tL(){return $O}const nL=Object(Jo.c)(e=>({callOutStyles:{root:{boxShadow:e.effects.elevation16,padding:"10px",borderRadius:"4px"},beakCurtain:{borderRadius:"4px"}},iconStyles:{root:{width:"20px",height:"20px"}},headerTextProps:{style:{fontWeight:600},className:"shortcutkey-callout-headertext"},bodyTextProps:{style:{fontWeight:400},nowrap:!1}})),oL={calloutTarget:'[data-unique-id="StatusBar-KeyboardShortcutsButton"]',autoDismissTimePeriodInMilliSeconds:5e3},rL=R.memo(({shortcutPrefix:e,onKeyDownCallback:t,onDismissCallback:n})=>{const{autoDismissTimePeriodInMilliSeconds:o,calloutTarget:r}=oL,[l,c]=R.useState(!0),[u,d]=R.useState(e),p=R.useCallback(e=>{i.a.sendTraceTag(507790535,a.a.msoulscat_ES_EWAJS,s.a.Info,`CompatShortcutKeyPressedInfoCallout: Dismissed by ${null==e?void 0:e.type} event with prefix ${u}`),e&&n(c)},[u,n]),g=R.useCallback(e=>t(e,c,d),[t]);R.useEffect(()=>{if(l){const e=setTimeout(()=>{i.a.sendTraceTag(507790534,a.a.msoulscat_ES_EWAJS,s.a.Info,"CompatShortcutKeyPressedInfoCallout: Dismissed on timeout"),n(c)},o);return()=>clearTimeout(e)}return()=>{}},[o,l,n]);const h=R.useMemo(()=>ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.CompatShortcutKeyPressedInfoCalloutHeader).replace("${0}",u),[u]);return R.createElement(we.a,null,e=>{const{callOutStyles:t,iconStyles:n,headerTextProps:o,bodyTextProps:i}=nL(e);return R.createElement(Nl.a,{target:r,calloutMaxHeight:87,calloutMaxWidth:288,gapSpace:-5,role:"dialog",directionalHint:Se.a.topCenter,directionalHintFixed:!0,setInitialFocus:!0,beakWidth:8,styles:t,theme:e,onKeyDown:g,onDismiss:p,hidden:!l},R.createElement(pv.a,{isClickableOutsideFocusTrap:!0,forceFocusInsideTrap:!1},R.createElement(At.a,{horizontal:!0,tokens:{childrenGap:8}},R.createElement(At.a.Item,null,R.createElement(fe.a,{iconName:Ha.a.JotKeyboardShortcuts_20,styles:n})),R.createElement(At.a.Item,null,R.createElement(At.a,null,R.createElement(At.a.Item,null,R.createElement(rs.a,_object_spread({},o),h)),R.createElement("div",{style:i},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.CompatShortcutKeyPressedInfoCalloutBody)))))))})});function iL({shortcutPrefix:e,onKeyDownCallback:t,onDismissCallback:n}){i.a.sendTraceTag(507790533,a.a.msoulscat_ES_EWAJS,s.a.Info,"showCompatShortcutKeyPressedInfoCallout: Function call with prefix "+e),e&&k.render(R.createElement(rL,{shortcutPrefix:e,onKeyDownCallback:t,onDismissCallback:n}),document.createElement("div"))}rL.displayName="CompatShortcutKeyCalloutMemo";const aL={calloutTarget:'[data-unique-id="StatusBar-KeyboardShortcutsButton"]'},sL=Object(Jo.c)(e=>({callOutStyles:{root:{boxShadow:e.effects.elevation16,padding:"10px",borderRadius:"4px"},beakCurtain:{borderRadius:"4px"}},iconStyles:{root:{width:"20px",height:"20px"}},headerTextProps:{style:{fontWeight:600}},bodyTextProps:{style:{fontWeight:400},nowrap:!1},cancelIconStyles:{root:{width:"16px",height:"16px",cursor:"pointer",float:"right",marginTop:"0px",marginRight:"0px",marginLeft:"5px",selectors:{[F.m]:{":focus":{borderColor:"highlight",backgroundColor:"highlight"},":hover":{backgroundColor:"highlight !important"}}}}},linkStyles:{root:{marginTop:"10px"}}})),lL=R.memo(e=>{const{openKeyboardShortcutsDialog:t,refocus:n}=e,{calloutTarget:o}=aL,[r,l]=R.useState(!0),u=R.useRef(null),d=R.useCallback(e=>{l(!1),i.a.sendTraceTag(507605792,a.a.msoulscat_ES_EWAJS,s.a.Info,`KeyboardShortcutAwarenessCallout: Dismissed by ${null==e?void 0:e.type} event`)},[]),p=R.useCallback(()=>{i.a.sendTraceTag(507605791,a.a.msoulscat_ES_EWAJS,s.a.Info,"KeyboardShortcutAwarenessCallout: Dismissed by click close button"),l(!1),n()},[n]),g=R.useCallback(()=>{i.a.sendTraceTag(507581642,a.a.msoulscat_ES_EWAJS,s.a.Info,"KeyboardShortcutAwarenessCallout: Dismissed by timeout"),l(!1),n()},[n]),h=R.useCallback(()=>{i.a.sendTraceTag(507605790,a.a.msoulscat_ES_EWAJS,s.a.Info,"KeyboardShortcutAwarenessCallout: Link clicked"),l(!1),t()},[t]),m=Object(Gx.a)(ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.KeyboardShortcutAwarenessCalloutTitle)),b=Object(Gx.a)(ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.KeyboardShortcutAwarenessCalloutSubtitle)),f=Object(Gx.a)(ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.KeyboardShortcutAwarenessCalloutLink));return R.useEffect(()=>r?(u.current=window.setTimeout(()=>{g()},2e4),()=>{u.current&&window.clearTimeout(u.current)}):()=>u.current&&window.clearTimeout(u.current),[r,g]),R.createElement(we.a,null,e=>{const{callOutStyles:t,iconStyles:n,headerTextProps:i,bodyTextProps:a,cancelIconStyles:s,linkStyles:l}=sL(e);return R.createElement(Nl.a,{target:o,calloutMaxHeight:92,calloutMaxWidth:315,gapSpace:-5,role:"dialog",directionalHint:Se.a.topCenter,directionalHintFixed:!0,setInitialFocus:!0,styles:t,beakWidth:8,theme:e,onDismiss:d,hidden:!r,"aria-live":"assertive"},R.createElement(pv.a,{isClickableOutsideFocusTrap:!0,forceFocusInsideTrap:!1,disableFirstFocus:!0},R.createElement(is.a,{id:"KeyboardShortcutAwarenessCalloutCloseButton",styles:s,onClick:p,iconProps:Object(mi.a)(c.a.CancelGlyph_20),"aria-label":ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.Close)}),R.createElement(At.a,{horizontal:!0,tokens:{childrenGap:8}},R.createElement(At.a.Item,null,R.createElement(fe.a,{iconName:Ha.a.JotKeyboardShortcuts_20,styles:n})),R.createElement(At.a.Item,null,R.createElement(At.a,null,R.createElement(At.a.Item,null,R.createElement(rs.a,_object_spread({},i),m)),R.createElement("div",{style:a},b)),R.createElement(At.a.Item,null,R.createElement(Ut.a,{styles:l,onClick:h},f))))))})});function cL(e,t){i.a.sendTraceTag(507605787,a.a.msoulscat_ES_EWAJS,s.a.Info,"showKeyboardShortcutAwarenessCallout: Function called"),k.render(R.createElement(lL,{openKeyboardShortcutsDialog:e,refocus:t}),document.createElement("div"))}lL.displayName="KeyboardShortcutAwarenessCalloutMemo";const uL=Object(Jo.c)(e=>({calloutStyles:{root:{padding:"12px",borderRadius:"4px",boxShadow:e.effects.elevation16,border:"none",marginLeft:"-4px",".nameBox-statusCallout-subText":{padding:"0px 2px",borderRadius:"2px",margin:"0px 4px",fontWeight:600,fontSize:"12px",lineHeight:"16px",backgroundColor:e.palette.neutralLight,color:e.palette.neutralPrimaryAlt,alignSelf:"center"},".nameBox-statusCallout-subTitle":{fontWeight:400,display:"flex"}},beak:{left:"25px !important"},beakCurtain:{borderRadius:"4px"},calloutMain:{lineHeight:"20px"}},headingStyles:{root:{fontSize:"14px",fontWeight:"600"}}})),dL=e=>{const t=R.useRef(null),[n,o]=R.useState(!1),[r,i]=R.useState(!1),a=R.useCallback(()=>{t.current&&clearTimeout(t.current)},[t]),s=R.useCallback(()=>{t.current=setTimeout(()=>{o(!0),i(!0)},1e4)},[t]);return R.useEffect(()=>(e.hide?o(!0):(s(),r||o(!1)),()=>{a()}),[e.hide,r,s,a]),R.createElement(we.a,null,t=>{const o=uL(t);return R.createElement(Nl.a,{target:e.anchorElem,role:"alert",beakWidth:8,gapSpace:5,directionalHint:Se.a.bottomLeftEdge,directionalHintFixed:!1,calloutWidth:400,hidden:n,styles:o.calloutStyles,onMouseEnter:a,onMouseLeave:s},R.createElement(At.a,{horizontal:!0,tokens:{childrenGap:8}},R.createElement(At.a.Item,null,R.createElement(fe.a,{iconName:be.a.Graph_20,style:{width:20,height:20}})),R.createElement(At.a.Item,null,R.createElement(At.a,null,R.createElement(At.a.Item,null,R.createElement(rs.a,{as:"h2",styles:o.headingStyles},e.heading))))))})};function pL(e,t,n,o){k.render(R.createElement(dL,{anchorElem:t,heading:n,hide:o}),e)}},3087:function(e,t,n){"use strict";n.d(t,"b",(function(){return Le})),n.d(t,"c",(function(){return Ne})),n.d(t,"a",(function(){return We}));var o=n(1),r=n.n(o),i=n(94),a=n(765),s=n(220);function l(e,t){return n=e,o=function(e,t){const n={left:e.left,top:e.top};return null!=t&&n.left&&n.top&&(n.left<t.left&&(n.left=t.left),n.left>t.left+t.width&&(n.left=t.left+t.width),n.top<t.top&&(n.top=t.top),n.top>t.top+t.height&&(n.top=t.top+t.height)),n}(e,t),n.left&&n.top&&o.left&&o.top?Math.round(Math.sqrt(Math.pow(n.left-o.left,2)+Math.pow(n.top-o.top,2))):0;var n,o}var c=n(226),u=n(1027),d=n(1590),p=n(1601),g=n(235),h=n(66),m=n(20),b=n(962),f=n(1580),x=n(1142),E=n(1143),S=n(183),y=n(1208),C=n(1485),v=n(222),R=n(3066),k=n(3067),T=n(2820),_=n(5),w=n(2138),D=n(486),P=n(2683),I=n(2684),F=n(2665);const B=Object(m.c)(e=>{const t={root:{padding:"0 2px 0 5px"},splitButtonMenuButton:{height:D.a.floatieRowHeight,width:D.a.menuButtonWidth,padding:0},splitButtonContainer:{height:D.a.floatieRowHeight}};return Object(_.db)(Object(P.b)(e),t)}),M=Object(m.c)(()=>{const e={splitButtonMenuButton:{height:D.a.floatieLargeControlHeight,width:D.a.menuButtonWidth},splitButtonContainer:{height:D.a.floatieLargeControlHeight,padding:"0px 2px 0px 0px",selectors:{":focus:after":{right:2}}}};return Object(_.I)(P.a,e)});class j extends o.PureComponent{render(){return o.createElement(w.a,_object_spread_props(_object_spread({},this.props),{id:Object(F.a)(this.props.id),useLegacyButton:void 0===this.props.useLegacyButton||this.props.useLegacyButton,hideLabel:!0,styles:B(this.props.styles),directionalHintFixed:!1,dataAutomationType:"FloatieSplitButton",variant:"floatieSplitButton",keytipProps:void 0,shadowRenderMenu:!1}))}}class O extends o.PureComponent{render(){return o.createElement(w.a,_object_spread_props(_object_spread({},this.props),{id:Object(F.a)(this.props.id),styles:M(),directionalHintFixed:!1,dataAutomationType:"FloatieLargeSplitButton",useLegacyButton:!0,onRenderText:Object(I.a)(this.props.label),keytipProps:void 0,shadowRenderMenu:!1}))}}var L=n(3068);const A={root:{width:D.a.menuButtonWidth,height:28}},N=(e,t=!1)=>({root:{marginRight:t?8:0,height:28},subComponentStyles:{textFieldStyles:{subComponentStyles:{buttonStyles:A},textInput:{opacity:e?.4:1}},dropDownStyles:{}}});var W=n(2567),z=n(53),H=n(112);const V=e=>{const t=o.useContext(H.a);return o.createElement(W.a,_object_spread_props(_object_spread({},e),{id:Object(F.a)(e.id),styles:N(e.disabled,!!Object(z.a)(t,z.f.fluentV9FloatieIsEnabled)&&!!Object(z.a)(t,z.f.fluentV9InputComboboxIsEnabled)),keytipProps:void 0,directionalHintDynamic:!0}))};var U=n(3096),G=n(1789),q=n(717),Q=n(2586);class K extends o.PureComponent{render(){return o.createElement(g.a,null,e=>o.createElement(Q.a,_object_spread_props(_object_spread({},this.props),{id:Object(F.a)(this.props.id),dataAutomationType:"FloatieCompoundButton",styles:Object(q.a)(e,{label:{fontWeight:_.l.bold,margin:"0"}}),keytipProps:void 0,useLegacyButton:void 0===this.props.useLegacyButton||this.props.useLegacyButton})))}}var J=n(17),Y=n(2175),Z=e=>{var{onExecute:t,onAfterMenuDismiss:n}=e,r=_object_without_properties(e,["onExecute","onAfterMenuDismiss"]);const i=r.galleryButtons.slice(0,1),a=o.useContext(H.a);return Object(z.a)(a,z.f.isFloatieStylesGalleryButtonFixEnabled)?o.createElement(Y.a,_object_spread_props(_object_spread({},r),{galleryButtons:i,styles:{galleryContainer:{root:{display:"flex"}},galleryButtonInPreview:{flexContainer:{backgroundColor:J.a.colorNeutralBackground1}}}})):o.createElement(T.a,_object_spread_props(_object_spread({},oe(r)),{controlInMenuRendererFunction:null==r?void 0:r.controlInMenuRendererFunction,downChevronIcon:null==r?void 0:r.downChevronIcon,onExecute:t,onAfterMenuDismiss:n,useLegacyButton:!1}))};const $=Object(m.c)((e,t)=>n=>{e&&e(!0,n.id,n.isShadowRendering),t&&t(n)}),X=Object(m.c)((e,t)=>n=>{e&&e(!1,n),t&&t(n)}),ee=Object(m.c)((e,t)=>n=>{e&&e(void 0),t&&t(n)}),te=Object(S.a)((e,t,n,r)=>({key:e,data:t,onRender:(e,t)=>o.createElement("span",{key:e.key},function(e,t,n,r,i,a){const s=isNaN(n)?void 0:n,l=isNaN(r)?void 0:r;switch(e.type){case"AppCompoundButtonProps":return o.createElement(K,_object_spread_props(_object_spread({positionInSet:s,setSize:l},Object(G.a)(e,t)),{lang:e.lang,enableFocusOnHover:!0}));case"AppFontStylesFullGalleryProps":return Object(U.a)(e,Object(C.a)(t),n,r,i,a);case"AppPersonaButtonProps":case"AppColorPickerProps":case"AppListGalleryProps":case"AppIconFullGalleryProps":case"AppCharacterCodeGalleryProps":case"RibbonChangeColorsFullGalleryProps":return Object(U.a)(e,Object(C.a)(t),n,r);default:throw new Error(`The control of type ${e.type} is not valid in a Floatie menu`)}}(e.data,Object(C.a)(t),Number(e["aria-posinset"]),Number(e["aria-setsize"]),n,r)),customOnRenderListLength:Object(v.e)(t)})),ne=Object(m.c)((e,t,n,o)=>r=>{const{controlProps:i,subComponentStyles:a,location:s,arePerfImprovementsEnabled:l,onSubMenuPositioned:c,terminalParentControlId:u,useFullDescriptionLabelOnly:d}=r,p=r.onMenuItemExecuted||n;return i.filter(e=>Object(v.e)(e)>0).map(n=>{const r=_object_spread_props(_object_spread({},Object(v.a)(n,p)),{keytipProps:void 0,location:s,appStrings:t,terminalParentControlId:u});switch(r.type){case"AppButtonProps":return(o?b.b:b.a)(Object(y.a)(r.id,r.location),r,a,void 0,void 0,d);case"AppToggleButtonProps":return Object(f.a)(r,a,void 0,d);case"AppFlyoutAnchorProps":return(l?x.b:x.a)(Object(y.a)(r.id,r.location),r,ne(e,t),e,c,a,a,l,p,d);case"AppSplitButtonProps":return(l?E.b:E.a)(Object(y.a)(r.id,r.location),r,ne(e,t),e,c,a,a,l,p);case"AppFontStylesFullGalleryProps":return te(r.id,r,ne(e,t,void 0,!0),e);case"AppPersonaButtonProps":case"AppColorPickerProps":case"AppListGalleryProps":case"AppIconFullGalleryProps":case"AppCharacterCodeGalleryProps":case"AppCompoundButtonProps":case"RibbonChangeColorsFullGalleryProps":return te(r.id,r);default:throw new Error(`The control of type ${r.type} is not valid in a Floatie menu`)}})});function oe(e){const t=e.flyoutAnchorProps;return{type:"AppFlyoutAnchorProps",id:e.id,disabled:e.disabled,icon:t&&t.icon,label:t&&t.label||e.menuLauncherLabel,menuDefinition:e.expandedOptions,onExecute:e.onMenuButtonExecute,onAfterMenuDismiss:e.onAfterMenuDismiss,keytipProps:e.keytipProps}}var re=n(2605),ie=n(2704),ae=n(846);const se=Object(m.c)(e=>Object(_.eb)({padding:"2px 0",display:"flex"},e));class le extends o.PureComponent{render(){const{controls:e,controlRendererFunction:t}=this.props;return o.createElement("div",{className:se()},e.map((e,n,o)=>ue(_object_spread({},e,Object(ae.a)(o,n)),t)))}}class ce extends o.PureComponent{render(){const{controls:e,controlRendererFunction:t}=this.props;return o.createElement("div",{className:se(this.props.customStyles)},e.map(e=>ue(e,t)))}}function ue(e,t){return o.createElement("div",{key:e.id},t(_object_spread_props(_object_spread({},e),{location:c.b.Floatie})))}var de=n(3099),pe=n(136),ge=n(60),he=n(56);const me=Object(pe.a)({root:_object_spread_props(_object_spread({},ge.a.margin("0px","6px"),ge.a.padding("2px","0px")),{display:"flex",alignItems:"center"})}),be=e=>{switch(e){case"FontPicker":return{marginRight:"0px"};case"FontSize":return{marginRight:"6px"};default:return{marginRight:"1px"}}},fe=()=>o.createElement(de.a,{vertical:!0,appearance:"strong"});var xe=({controls:e,controlRendererFunction:t,customStyles:n})=>{const r=(e=>{const t=me();return Object(he.a)(t.root,e)})(n);return o.createElement("div",{className:r},e.map((e,n,r)=>function(e,t){return o.createElement("div",{key:e.id,style:be(e.id)},t(_object_spread_props(_object_spread({},e),{location:c.b.Floatie})))}(_object_spread({},e,Object(ae.a)(r,n)),t)))};class Ee extends o.Component{shouldComponentUpdate(e){return this.props.hidden?this.props.hidden!==e.hidden:!Object(s.e)(this.props,e)}render(){return o.createElement("div",{className:Object(ie.c)(this.props.hidden,this.props.customStyles),id:this.props.id+"Group"},this.props.renderDivider&&this.getDivider(),o.createElement("div",null,this.getFloatieGroupType()))}constructor(){super(...arguments),this.getDivider=()=>"SingleRowMultiSectionFloatieGroup"===this.props.type?o.createElement(fe,null):o.createElement(re.a,{getClassNames:ie.b}),this.getFloatieGroupType=()=>{switch(this.props.type){case"MultiRowFloatieGroup":return o.createElement("div",null,o.createElement(le,{key:this.props.id+"TopRow",controls:this.props.topControlsRow,controlRendererFunction:this.props.controlRendererFunction}),o.createElement(le,{key:this.props.id+"BottomRow",controls:this.props.bottomControlsRow,controlRendererFunction:this.props.controlRendererFunction}));case"SingleRowFloatieGroup":return o.createElement("div",null,o.createElement(ce,_object_spread_props(_object_spread({},this.props),{controlRendererFunction:this.props.controlRendererFunction,customStyles:this.props.customStyles})));case"SingleControlFloatieGroup":const e=_object_spread_props(_object_spread({},this.props),{controls:[this.props.control]});return o.createElement("div",null,o.createElement(ce,_object_spread_props(_object_spread({},e),{controlRendererFunction:e.controlRendererFunction})));case"SingleRowMultiSectionFloatieGroup":const t=this.props.sectionControls.map((e,t)=>o.createElement(xe,{key:`${this.props.id}Section${t}`,controls:e,controlRendererFunction:this.props.controlRendererFunction})),n=t.length,r=t.reduce((e,t,r)=>{const i=o.createElement(fe,{key:"SectionDivider"+r});return r===n-1?[...e,t]:[...e,t,i]},[]);return o.createElement("div",{style:{display:"flex"}},r)}}}}var Se=n(2439),ye=n(1542),Ce=n(1543),ve=n(1541);const Re=()=>{const e=r.a.useContext(H.a);return Object(z.a)(e,z.f.isFluentV9FloatieDispatchOptimizationEnabled)},ke=Object(pe.a)({root:_object_spread(_object_spread_props(_object_spread({},ge.a.padding("0px")),{display:"flex"}),ge.a.borderRadius("8px"))}),Te=Object(pe.a)({root:{visibility:"hidden",position:"absolute"}}),_e=r.a.memo(r.a.forwardRef((e,t)=>{const n=Object(ye.a)(e,t);return(e=>{const t=ke(),n=Te(),o=Re();e.root.className=Object(he.a)(e.root.className,t.root),o&&e.hidden&&(e.root.className=Object(he.a)(e.root.className,n.root)),Object(ve.b)(e)})(_object_spread_props(_object_spread({},n),{hidden:e.hidden})),Object(Ce.a)(n)}));var we=n(1188),De=n(2601),Pe=n(163),Ie=n(1028);function Fe(e){return"x"in e&&"y"in e}const Be=(e,t)=>{var n;const r=o.useRef(null),i=null===(n=e.contextMenuRef)||void 0===n?void 0:n.current,a=o.useCallback((e,t,n)=>{var o;const r=e,i={getBoundingClientRect:((e=0,t=0)=>()=>({width:0,height:0,top:t,right:e,bottom:t,left:e,x:e,y:t}))(r.x,r.y)};null===(o=t.current)||void 0===o||o.setTarget(i),n&&Object(Ie.a)(n)},[]);return o.useLayoutEffect(()=>{const n=e.attachedContextMenu,o=e.target,s=e.onPositioningEnd;if(n)if(i){var l;const e=i.getBoundingClientRect(),t={getBoundingClientRect:()=>({x:e.x,y:e.y,width:e.width,height:e.height,top:e.top,right:e.right,bottom:e.bottom,left:e.left})};null===(l=r.current)||void 0===l||l.setTarget(t),s&&Object(Ie.a)(s)}else t&&void 0!==o&&Fe(o)&&a(o,r,s);else void 0!==o&&Fe(o)&&a(o,r,s)},[e.target,e.attachedContextMenu,e.onPositioningEnd,i,a,t]),r},Me=(e,t)=>_object_spread_props(_object_spread({},e),{open:!!t||!e.hidden,inline:!0}),je=e=>_object_spread_props(_object_spread({},e),{id:e.floatieId}),Oe=o.memo(o.forwardRef((e,t)=>(e=>{var t;const{popOverProps:n,popOverSurfaceProps:o,renderFloatieGroups:i}=e;return r.a.createElement(we.a,{theme:Pe.b.getInstance().getThemeNext()},r.a.createElement(Se.a,{elementTimingId:"floatie",hidden:e.hidden,interactivityTrackerContext:e.interactivityTrackerContext}),r.a.createElement(De.a,_object_spread_props(_object_spread({positioning:null===(t=e.popOverProps)||void 0===t?void 0:t.positioning},n),{closeOnScroll:!0}),r.a.createElement(_e,_object_spread_props(_object_spread({},o),{onClick:e.onClick,"data-unique-id":e.floatieId,hidden:e.hidden}),i())))})(((e,t)=>{var n;const r=Re(),i=o.useRef(!0),a=o.useRef("above"),s=o.useRef("start"),l=null===(n=e.contextMenuRef)||void 0===n||null===(n=n.current)||void 0===n||null===(n=n.dataset)||void 0===n?void 0:n.popperPlacement,c=o.useCallback(e=>{if(e)switch(e){case"top-start":case"top-end":a.current="below";break;case"bottom-start":case"bottom-end":a.current="above"}},[]),u=o.useCallback(e=>{if(e)switch(e){case"top-start":case"bottom-start":s.current="start";break;case"top-end":case"bottom-end":s.current="end"}},[]);return o.useEffect(()=>{e.hidden&&(i.current=!0,s.current="start",a.current="above")},[e.hidden]),u(l),c(l),_object_spread_props(_object_spread({},e),{popOverProps:_object_spread_props(_object_spread({},Me(e,r)),{positioning:{positioningRef:Be(e,i.current),position:a.current,align:s.current,offset:{crossAxis:0,mainAxis:e.attachedContextMenu?6:22}},unstable_disableAutoFocus:!0}),popOverSurfaceProps:je(e),onClick:()=>{i.current=!1}})})(e))));Oe.displayName="next/Floatie";const Le=12,Ae=22,Ne="ReactFloatie";class We extends o.Component{static getDerivedStateFromProps(e,t){return t.isShadowRendering&&e.floatieGroupsToShadowRender&&!e.hidden?{isShadowRendering:!1,itemsToRender:e.floatieGroupsToShadowRender.length}:null}componentWillUnmount(){this.removeListeners()}addListeners(){this.props.hidden||this.props.attachedContextMenu||this.props.preventAutoDismiss||this.props.preventLightDismiss||!this.state.fadeOutFloatie||(this.getWindow().document.body.addEventListener("mousemove",this.onMouseMove,!0),this.hasListeners=!0)}removeListeners(){this.hasListeners&&(this.getWindow().document.body.removeEventListener("mousemove",this.onMouseMove,!0),this.hasListeners=!1)}shouldComponentUpdate(e,t){return!(this.props.hidden&&e.hidden&&!t.isShadowRendering||Object(s.e)(this.props,e)&&Object(s.e)(this.state,t))}render(){var e;const{gapSpace:t=(this.props.attachedContextMenu?Le:Ae),target:n,hidden:r,directionalHint:s=i.a.topLeftEdge,positionAndHide:l}=this.props,c=o.createElement(g.a,null,e=>{var i,c,u;return o.createElement("div",{ref:this.floatieWrapper},o.createElement(a.a,{id:this.floatieId,hidden:r,doNotLayer:!0,gapSpace:t,directionalHint:s,directionalHintForRTL:s,directionalHintFixed:this.props.attachedContextMenu&&this.props.positionFloatieInSingleFrame,alignTargetEdge:!(this.props.attachedContextMenu&&this.props.positionFloatieInSingleFrame),target:n,isBeakVisible:!1,styles:Object(ie.a)(e,l,this.state.opacity,this.props.styles),onPositioned:this.updateFloatieBounds,preventDismissOnScroll:!0,preventDismissOnLostFocus:!0,"data-unique-id":null!==(i=this.props.floatieId)&&void 0!==i?i:"Floatie",bounds:null!==(c=(u=this.context).isExperimentalFeatureEnabled)&&void 0!==c&&c.call(u,z.f.multiWindowSupportIsEnabled)?Object(d.a)(this.context.appWindow):h.getBoundingWindowWithPaddingFabric,shouldUpdateWhenHidden:this.state.isShadowRendering},this.renderFloatieGroups(),o.createElement(Se.a,{elementTimingId:"floatie",hidden:r,interactivityTrackerContext:this.getInteractivityTrackerContext()})))});return this.canUseNextFloatie()&&"SingleRowMultiSectionFloatieGroup"===(null===(e=this.props.groups[0])||void 0===e?void 0:e.type)?o.createElement(Oe,_object_spread_props(_object_spread({},this.props),{interactivityTrackerContext:this.getInteractivityTrackerContext(),renderFloatieGroups:()=>o.createElement(o.Fragment,null,this.renderFloatieGroups())})):c}componentDidMount(){this.props.hidden||this.addListeners(),Object(u.a)()&&this.props.hidden&&this.isShadowRenderingEnabled()&&this.getWindow().requestIdleCallback(()=>{this.setState({isShadowRendering:!0})},void 0,`Floatie-${Ne}-StartShadowRendering`)}componentDidUpdate(){this.state.isShadowRendering?this.renderMoreItemsInIdleCallback():this.props.hidden?(this.removeListeners(),this.floatieBounds=null,this.initialMouseDistance=-1,this.setState(()=>({opacity:"1",inRubberbandState:!1}))):this.hasListeners||this.addListeners()}getInteractivityTrackerContext(){if(this.props.groups&&0!==this.props.groups.length)return this.props.groups.map(e=>e.id).join(", ")}floatieGroupShouldBeShown(e){return this.props.groups.some(t=>t.id===e)}getFloatieGroupRenderFunction(e){switch(e.type){case"MultiRowFloatieGroup":return this.controlRendererFunction;case"SingleControlFloatieGroup":return this.singleControlRendererFunction;case"SingleRowMultiSectionFloatieGroup":return this.singleRowMultiSectionControlRendererFunction;case"SingleRowFloatieGroup":default:return this.singleRowControlRendererFunction}}getFloatieBounds(){const e=this.getWindow();e.requestAnimationFrame(()=>{const t=e.document.getElementById(this.floatieId);this.floatieBounds=t&&t.getBoundingClientRect()})}getWindow(){var e,t,n;return(null===(e=(t=this.context).isExperimentalFeatureEnabled)||void 0===e?void 0:e.call(t,z.f.multiWindowSupportIsEnabled))&&null!==(n=this.context.appWindow)&&void 0!==n?n:window}constructor(e){super(e),this.floatieWrapper=o.createRef(),this.floatieExtraDistance=0,this.initialMouseDistance=-1,this.floatieBounds=null,this.totalShadowRenderingTime=0,this.canUseNextFloatie=()=>{var e,t,n,o;const r=(null===(e=(t=this.context).isExperimentalFeatureEnabled)||void 0===e?void 0:e.call(t,z.f.fluentV9FloatieIsEnabled))||!1,i=(null===(n=(o=this.context).isExperimentalFeatureEnabled)||void 0===n?void 0:n.call(o,z.f.fluentV9ContextMenuIsEnabled))||!1;return this.props.attachedContextMenu?r&&i:r},this.renderFloatieGroups=()=>{let e=this.props.groups;var t,n;return this.isShadowRenderingEnabled()&&(e=this.state.isShadowRendering?null!==(t=null===(n=this.props.floatieGroupsToShadowRender)||void 0===n?void 0:n.slice(0,this.state.itemsToRender))&&void 0!==t?t:[]:this.props.floatieGroupsToShadowRender),this.renderAllFloatieGroups(e,this.props.isSmallScreenFloatie,this.props.scrollStyles)},this.renderAllFloatieGroups=(e,t,n)=>{if(t&&n){const t=e.find(e=>"ContextMenu"===e.id),r=e.filter(e=>"ContextMenu"!==e.id);return o.createElement(o.Fragment,null,o.createElement("div",{className:n.wrapper},o.createElement("div",{className:n.leftFade}),o.createElement("div",{className:n.container,onScroll:this.onSmallScreenSwipe},r.map(e=>this.renderFloatieGroup(e))),o.createElement("div",{className:n.rightFade})),t&&this.renderFloatieGroup(t))}return e.map(e=>this.renderFloatieGroup(e))},this.renderFloatieGroup=e=>{var t;return o.createElement(Ee,_object_spread_props(_object_spread({},e),{key:e.id,renderDivider:this.renderFloatieGroupDivider(e.id),hidden:this.isShadowRenderingEnabled()&&!this.floatieGroupShouldBeShown(e.id),controlRendererFunction:null!==(t=this.props.controlRendererFunction)&&void 0!==t?t:this.getFloatieGroupRenderFunction(e)}))},this.renderFloatieGroupDivider=e=>this.props.groups[0]&&this.props.groups[0].id!==e,this.onMouseMove=e=>{if(!this.props.hidden&&this.state.fadeOutFloatie&&!this.props.attachedContextMenu){const t=255,n=0;this.initialMouseDistance=l(this.props.originalTarget,this.floatieBounds);let o=l({left:e&&e.clientX,top:e&&e.clientY},this.floatieBounds);if(0===o)this.floatieExtraDistance=0,this.setState(()=>({opacity:"1",inRubberbandState:!1}));else{this.state.inRubberbandState&&((0===this.floatieExtraDistance||o<this.floatieExtraDistance)&&(this.floatieExtraDistance=o),o-=this.floatieExtraDistance),o=Math.max(o-this.initialMouseDistance,0);const r=4,i=t-o*r,a=t/r;i<=n&&o>=a?(this.props.onFadedAway&&this.props.onFadedAway(e),this.props.onDismiss&&this.props.onDismiss(e)):this.setState(()=>({opacity:Math.max(i/255,n).toFixed(2)}))}}},this.onSmallScreenSwipe=e=>{const t=e.target;if(!t.parentElement||!t.parentElement.children||t.parentElement.children.length<2)return;const n=t.parentElement,o=n.firstChild,r=n.lastChild,i=0===t.scrollLeft;o.style.visibility=i?"hidden":"visible";const a=t.scrollWidth-t.scrollLeft-t.clientWidth<1;r.style.visibility=a?"hidden":"visible"},this.onMenuToggled=(e,t,n)=>{n||(this.setState({fadeOutFloatie:!e,inRubberbandState:!e}),this.floatieExtraDistance=0,this.props.onMenuToggled&&this.props.onMenuToggled(e),this.openedMenuId=e&&!n?t:void 0)},this.onItemExecuted=e=>{this.props.onItemExecute&&this.props.onItemExecute(e,c.a.Floatie,this.openedMenuId)},this.updateFloatieBounds=e=>{this.getFloatieBounds(),this.props.onPositioned&&this.props.onPositioned(e)},this.renderMoreItemsInIdleCallback=()=>{const{isShadowRendering:e,itemsToRender:t}=this.state,{floatieGroupsToShadowRender:n}=this.props;if(e&&void 0!==n)if(t<n.length){this.currentShadowRenderingStart&&(this.totalShadowRenderingTime+=performance.now()-this.currentShadowRenderingStart);const e=Object(p.a)(this.totalShadowRenderingTime,t);Object(u.a)()&&this.getWindow().requestIdleCallback(()=>{this.currentShadowRenderingStart=performance.now(),this.setState({itemsToRender:t+e})},void 0,`Floatie-${Ne}-ShadowRenderIncrement`)}else this.setState({isShadowRendering:!1})},this.isShadowRenderingEnabled=()=>!!this.props.floatieGroupsToShadowRender;const{appIcons:t,appStrings:n}=e;this.controlInMenuRendererFunction=ne(t,n,this.onItemExecuted),this.controlRendererFunction=function(e,t,n,r){return i=>{const a=Object(v.a)(i,r);switch(a.type){case"AppButtonProps":return o.createElement(R.a,_object_spread({},a));case"AppToggleButtonProps":return o.createElement(k.b,_object_spread({},a));case"AppFlyoutAnchorProps":return o.createElement(T.a,_object_spread_props(_object_spread({},a),{controlInMenuRendererFunction:t,downChevronIcon:e.downChevron,onExecute:$(n,a.onExecute),onAfterMenuDismiss:X(n,a.onAfterMenuDismiss)}));case"AppSplitButtonProps":return o.createElement(j,_object_spread_props(_object_spread({},a),{controlInMenuRendererFunction:t,downChevronIcon:e.downChevron,onMenuButtonExecute:$(n,a.onMenuButtonExecute),onAfterMenuDismiss:X(n,a.onAfterMenuDismiss)}));case"AppComboBoxProps":return o.createElement(L.a,_object_spread_props(_object_spread({},a),{onMenuOpen:$(n,a.onMenuOpen),onAfterMenuDismiss:X(n,a.onAfterMenuDismiss),downChevronIcon:e.downChevron}));case"AppFontPickerProps":return o.createElement(V,_object_spread_props(_object_spread({},a),{onMenuOpen:$(n,a.onMenuOpen),onAfterMenuDismiss:X(n,a.onAfterMenuDismiss),downChevronIcon:e.downChevron}));default:throw new Error(`The control of type ${a.type} is not a valid Floatie control`)}}}(t,this.controlInMenuRendererFunction,this.onMenuToggled,this.onItemExecuted),this.singleRowControlRendererFunction=function(e,t,n,r,i){return a=>{const s=Object(v.a)(a,i);switch(s.type){case"AppButtonProps":return o.createElement(R.b,_object_spread_props(_object_spread({},s),{onExecute:s.dismissHostingSurfaceOnExecute?ee(r,s.onExecute):s.onExecute}));case"AppToggleButtonProps":return o.createElement(k.a,_object_spread_props(_object_spread({},s),{onExecute:s.dismissHostingSurfaceOnExecute?ee(r,s.onExecute):s.onExecute}));case"AppFlyoutAnchorProps":return o.createElement(T.b,_object_spread_props(_object_spread({},s),{controlInMenuRendererFunction:t,downChevronIcon:e.downChevron,onExecute:n?$(n,s.onExecute):s.onExecute,onAfterMenuDismiss:n?X(n,s.onAfterMenuDismiss):s.onAfterMenuDismiss}));case"AppFontStylesPreviewGalleryProps":case"AppIconPreviewGalleryProps":return o.createElement(T.b,_object_spread_props(_object_spread({},oe(s)),{controlInMenuRendererFunction:t,downChevronIcon:e.downChevron,onExecute:n?$(n,s.onMenuButtonExecute):s.onMenuButtonExecute,onAfterMenuDismiss:n?X(n,s.onAfterMenuDismiss):s.onAfterMenuDismiss}));case"AppSplitButtonProps":return o.createElement(O,_object_spread_props(_object_spread({},s),{controlInMenuRendererFunction:t,downChevronIcon:e.downChevron,onMenuButtonExecute:$(n,s.onMenuButtonExecute),onAfterMenuDismiss:n?X(n,s.onAfterMenuDismiss):s.onAfterMenuDismiss}));default:throw new Error(`The control of type ${s.type} is not a valid Floatie large control`)}}}(t,this.controlInMenuRendererFunction,this.onMenuToggled,this.props.onDismiss,this.onItemExecuted),this.singleControlRendererFunction=function(e,t,n,r,i){return a=>{const s=Object(v.a)(a,i);switch(s.type){case"AppFlyoutAnchorProps":return o.createElement(T.b,_object_spread_props(_object_spread({},s),{controlInMenuRendererFunction:t,styles:r,downChevronIcon:e.downChevron,onExecute:n?$(n,s.onExecute):s.onExecute,onAfterMenuDismiss:n?X(n,s.onAfterMenuDismiss):s.onAfterMenuDismiss,isDefaultLabelRendering:!0}));case"AppButtonProps":return o.createElement(R.a,_object_spread({},s));default:throw new Error(`The control of type ${s.type} is not a valid Floatie single control`)}}}(t,this.controlInMenuRendererFunction,this.onMenuToggled,P.c,this.onItemExecuted),this.singleRowMultiSectionControlRendererFunction=function(e,t,n,r){return i=>{const a=Object(v.a)(i,r);switch(a.type){case"AppButtonProps":return o.createElement(R.a,_object_spread_props(_object_spread({},a),{useLegacyButton:!1}));case"AppToggleButtonProps":return o.createElement(k.b,_object_spread_props(_object_spread({},a),{useLegacyButton:!1}));case"AppFlyoutAnchorProps":return o.createElement(T.a,_object_spread_props(_object_spread({},a),{controlInMenuRendererFunction:t,downChevronIcon:e.downChevron,onExecute:$(n,a.onExecute),onAfterMenuDismiss:X(n,a.onAfterMenuDismiss),useLegacyButton:!1}));case"AppSplitButtonProps":return o.createElement(j,_object_spread_props(_object_spread({},a),{controlInMenuRendererFunction:t,downChevronIcon:e.downChevron,onMenuButtonExecute:$(n,a.onMenuButtonExecute),onAfterMenuDismiss:X(n,a.onAfterMenuDismiss),useLegacyButton:!1}));case"AppComboBoxProps":return o.createElement(L.a,_object_spread_props(_object_spread({},a),{onMenuOpen:$(n,a.onMenuOpen),onAfterMenuDismiss:X(n,a.onAfterMenuDismiss),downChevronIcon:e.downChevron,useLegacyCombobox:!1,width:"FontSize"===a.id?D.a.fontSizeComboBoxWidth:a.width}));case"AppFontPickerProps":return o.createElement(V,_object_spread_props(_object_spread({},a),{onMenuOpen:$(n,a.onMenuOpen),onAfterMenuDismiss:X(n,a.onAfterMenuDismiss),downChevronIcon:e.downChevron,width:D.a.fontNameComboBoxWidth}));case"AppFontStylesPreviewGalleryProps":return o.createElement(Z,_object_spread_props(_object_spread({},a),{onExecute:n?$(n,a.onMenuButtonExecute):a.onMenuButtonExecute,onAfterMenuDismiss:n?X(n,a.onAfterMenuDismiss):a.onAfterMenuDismiss,controlInMenuRendererFunction:t,downChevronIcon:e.downChevron}));case"AppIconPreviewGalleryProps":return o.createElement(T.a,_object_spread_props(_object_spread({},oe(a)),{controlInMenuRendererFunction:t,downChevronIcon:e.downChevron,onExecute:n?$(n,a.onMenuButtonExecute):a.onMenuButtonExecute,onAfterMenuDismiss:n?X(n,a.onAfterMenuDismiss):a.onAfterMenuDismiss,useLegacyButton:!1}));default:throw new Error(`The control of type ${a.type} is not a valid Floatie control`)}}}(t,this.controlInMenuRendererFunction,this.onMenuToggled,this.onItemExecuted),this.hasListeners=!1,this.floatieId=this.props.floatieId?this.props.floatieId:Ne,this.state={opacity:"1",fadeOutFloatie:!0,itemsToRender:0}}}We.contextType=H.a},3094:function(e,t,n){"use strict";n.r(t),n.d(t,"initializePresentModeFloatieLazy",(function(){return me})),n.d(t,"showPresentModeFloatieLazy",(function(){return be})),n.d(t,"hidePresentModeFloatieLazy",(function(){return fe})),n.d(t,"updatePresentModeFloatieShyStateLazy",(function(){return xe})),n.d(t,"getPresentModeFloatieControlsMapLazy",(function(){return Ee}));var o=n(1),r=n(264),i=n(189),a=n(2629),s=n(222),l=n(3066),c=n(3068),u=n(2820),d=n(3067),p=n(3087),g=n(20),h=n(5),m=n(54);const b={root:{height:"35px",width:"35px",borderRadius:"4px",margin:"0 5px",":hover, :focus:hover":{backgroundColor:m.a.gray150},":active":{backgroundColor:m.a.gray160+"!important"},"::after":{border:"1px solid "+m.a.gray90+" !important",borderRadius:"4px",backgroundColor:"transparent"}},rootChecked:{backgroundColor:"transparent",".ms-Fabric--isFocusVisible &:focus":{border:"1px solid "+m.a.gray90+" !important",borderRadius:"4px",backgroundColor:"transparent"},".ms-Fabric--isFocusVisible &:focus:hover":{backgroundColor:m.a.gray150}},rootCheckedPressed:{backgroundColor:m.a.gray160+"!important"},rootCheckedHovered:{backgroundColor:m.a.gray150},rootExpanded:{border:"1px solid "+m.a.gray90+" !important",borderRadius:"4px",backgroundColor:"transparent",":hover":{backgroundColor:m.a.gray150}},rootDisabled:{background:"transparent",".ms-Button-menuIcon":{opacity:"0.4"}},icon:{width:"19px",height:"19px"}},f=Object(g.c)(e=>{switch(e){case"TogglePresentModeOverlay":return{rootChecked:{backgroundColor:m.a.gray160}};case"ToggleHeadingsGridlines":return{root:{height:"35px",width:"50px"}};case"PresentModeZoomIn":case"PresentModeZoomOut":return{icon:{width:"16px !important",height:"16px !important"}};default:return{}}}),x=Object(g.c)(e=>Object(h.db)(b,f(e))),E=Object(g.c)(e=>({root:{selectors:{":hover":{backgroundColor:m.a.gray140,selectors:{".checkbox-check":{opacity:0}}},":active":{backgroundColor:m.a.gray120,selectors:{".checkbox-check":{opacity:0}}},".ms-Fabric--isFocusVisible &::after":{border:"1px solid "+m.a.gray90}}},checkbox:{border:"none",background:"transparent !important"},text:{color:e?m.a.gray110:m.a.gray10}})),S=Object(g.c)(e=>({root:{selectors:{":hover":{backgroundColor:m.a.gray140,selectors:{".checkbox-check":{fill:e?m.a.gray110:m.a.gray10}}},":active":{backgroundColor:m.a.gray120,selectors:{".checkbox-check":{fill:e?m.a.gray110:m.a.gray10}}},".ms-Fabric--isFocusVisible &::after":{border:"1px solid "+m.a.gray90}}},checkbox:{border:"none",background:"transparent !important"},text:{color:e?m.a.gray110:m.a.gray10},checkmark:{fill:e?m.a.gray110:m.a.gray10}})),y=Object(g.c)(()=>_object_spread_props(_object_spread({},Object(h.db)({container:{},list:{},header:{},root:{},title:{}})),{subComponentStyles:{menuItem:{},callout:{calloutMain:{background:m.a.gray160}}}})),C={root:{backgroundColor:m.a.gray160,color:m.a.gray10+" !important",":active":{background:m.a.gray120+" !important"}},rootHovered:{background:m.a.gray140+" !important"},rootChecked:{backgroundColor:m.a.gray130,color:m.a.gray10},rootCheckedPressed:{backgroundColor:m.a.gray120},rootCheckedHovered:{backgroundColor:m.a.gray140}},v={root:{margin:"0px !important",background:"transparent !important",border:"transparent !important",height:"35px",lineHeight:"35px",paddingRight:"10px"}},R=Object(g.c)(()=>({container:{backgroundColor:"transparent",height:"35px"},root:{backgroundColor:"transparent",border:"1px solid transparent",borderRadius:"4px",height:"35px",lineHeight:"35px",width:"65px"},rootHovered:{background:m.a.gray150},rootFocused:{background:"transparent",border:"1px solid "+m.a.gray90+" !important",":hover":{backgroundColor:m.a.gray150}},rootPressed:{background:m.a.gray160},rootDisabled:{backgroundColor:"transparent !important",".input":{color:m.a.gray110}},input:{color:m.a.gray10},optionsContainer:{backgroundColor:m.a.gray160}})),k=Object(g.c)(()=>({calloutMain:{background:"transparent",width:"fit-content",padding:"3px 0px",height:"39px"},root:{animation:"none",position:"inherit",background:"rgba(50, 49, 48, 0.9)",width:"100vw",justifyContent:"center"},container:{position:"inherit"}})),T=Object(g.c)(()=>({container:{"span[class^='divider']":{height:"25px !important",selectors:{[h.m]:{"forced-color-adjust":"none"}}}},expanded:{height:"45px"},collapsed:{overflow:"hidden",height:0}}));var _=n(260),w=n(2474),D=n(581),P=n.n(D),I=n(2475);class F extends o.PureComponent{render(){var e;return o.createElement(w.a,{isActive:!!this.props.isActive,popOverState:this.props.popOverState,triggerElement:null===(e=this.props.triggerElement)||void 0===e?void 0:e.id,shyDismissalRegions:this.props.shyDismissalRegions,onPopOverStateChange:this.onPopOverStateChange,onTransitionStart:this.onTransitionStart,onTransitionEnd:this.onTransitionEnd,styles:T()},o.createElement("div",null,o.createElement(p.a,_object_spread_props(_object_spread({},this.props.floatieProps),{target:this.state.target,controlRendererFunction:this.renderControl,preventAutoDismiss:!0,preventLightDismiss:!0,styles:k(),onMenuToggled:this.onMenuToggled,key:this.presentModeFloatieKey}))))}constructor(e){super(e),this.transitionStarted=!1,this.presentModeFloatieKey="presentModeFloatie_"+P()(),this.onPopOverStateChange=e=>{this.transitionStarted||this.props.onFloatieShyStateChanged&&this.props.onFloatieShyStateChanged(e)},this.getOnMenuOpened=Object(g.c)(e=>t=>{e&&e(!0)}),this.getOnAfterMenuDismissed=Object(g.c)(e=>t=>{e&&e(!1)}),this.onMenuToggled=e=>{this.onPopOverStateChange(e?_.a.Expanded:_.a.ExpandedSoftDismiss)},this.onTransitionStart=e=>{"height"!==e.propertyName||this.transitionStarted||(this.transitionStarted=!0)},this.onTransitionEnd=e=>{"height"===e.propertyName&&this.transitionStarted&&(this.transitionStarted=!1)},this.controlInMenuRendererFunction=e=>{const{controlProps:t}=e;return t.map(e=>{const t=e;switch(t.type){case"AppCheckboxProps":return t.styles=t.checked?S(t.disabled):E(t.disabled),Object(s.b)(t,this.props.floatieProps.appIcons);default:throw new Error(`The control of type ${t.type} is not a valid menu item control`)}})},this.renderControl=e=>{switch(e.type){case"AppButtonProps":return o.createElement(l.a,_object_spread_props(_object_spread({},e),{icon:e.icon,styles:x(e.id),title:e.customTooltip}));case"AppComboBoxProps":return o.createElement(I.a,null,o.createElement(c.a,_object_spread_props(_object_spread({},e),{styles:R(),onMenuOpen:this.getOnMenuOpened(this.onMenuToggled),onAfterMenuDismiss:this.getOnAfterMenuDismissed(this.onMenuToggled),downChevronIcon:this.props.floatieProps.appIcons.spinButtonUpChevron,showLabel:!1,optionStyles:C,caretDownButtonStyles:v,customTooltip:e.customTooltip})));case"AppFlyoutAnchorProps":return o.createElement(u.a,_object_spread_props(_object_spread({},e),{icon:e.icon,styles:x(e.id),menuClassNames:y(),downChevronIcon:this.props.floatieProps.appIcons.spinButtonUpChevron,controlInMenuRendererFunction:this.controlInMenuRendererFunction,title:e.customTooltip}));case"AppToggleButtonProps":return o.createElement(d.b,_object_spread_props(_object_spread({},e),{icon:e.icon,toggled:e.toggled,styles:x(e.id),iconColor:e.toggled?"#37A660":"#ffffff",title:e.customTooltip}));default:throw new Error(`The control of type ${e.type} is not a valid dictation floatie control`)}},this.state=_object_spread({},e)}}var B=n(127),M=n(3065),j=n(55);const O=e=>{var t;return null===(t=e.presentModeFloatieModel)||void 0===t?void 0:t.presentModeFloatieGroupModel},L=Object(B.a)([O,j.V,j.u,j.cb],(e,t,n,o)=>{const r=[];if(e)for(const i in e){const a=e[i];if(a)switch(a.type){case"SingleRowFloatieGroupModel":r.push(Object(M.a)(i,a,t,n,o));break;default:throw new Error("The floatie group type can't be placed in the floatie")}}return r}),A=Object(B.a)([O,j.u],(e,t)=>{const n={};return e?(Object.keys(e).forEach(o=>{const r=e[o];if(!r||"SingleRowFloatieGroupModel"!==r.type)return;const i=r.controls;null==i||i.forEach(e=>{const o=Object(j.p)(t,e);n[e]=o.modelType})}),n):n});var N=n(25),W=n(27);function z(e){const t=Array.isArray(e)?e:[e];return Object(W.a)(N.q,{models:t})}function H(e){return Object(W.a)(N.Gb,{state:e})}var V=n(160);const U=Object(i.connect)((e,t)=>{const n=(e=>e.presentModeFloatieModel)(e),o=L(e),r=(e=>{var t,n;return null!==(t=null===(n=e.presentModeFloatieModel)||void 0===n?void 0:n.popOverState)&&void 0!==t?t:_.a.Collapsed})(e);return{target:n.target,isActive:n.isActive,triggerElement:n.triggerElement,shyDismissalRegions:n.shyDismissalRegions,popOverState:r,floatieProps:{groups:o,appIcons:t.appIcons,appStrings:t.appStrings,appColors:t.appColor,hidden:!n.isActive}}},e=>({onFloatieShyStateChanged:t=>{e(H({popOverState:t}))}}),void 0,{areStatesEqual:Object(V.c)("PresentModeFloatie")})(F);var G=n(52),q=n(1768),Q=n(1425),K=n(23),J=n.n(K);class Y extends o.Component{render(){return o.createElement(a.a,null,o.createElement(i.Provider,{store:r.a},o.createElement(U,{appStrings:Object(Q.a)(),appIcons:this.appIcons,appColor:this.appColors})))}constructor(e){super(e),this.appColors={shade30:"#094624",shade20:"#0C5F32",shade10:"#0F703B",primary:"#107C41",tint10:"#218D51",tint20:"#55B17E",tint30:"#A0D8B9",tint40:"#CAEAD8"},this.appIcons=_object_spread_props(_object_spread({},Object(q.a)()),{spinButtonUpChevron:J.a.UpArrowWhite})}}var Z=n(1152),$=n(15),X=n.n($),ee=n(2570);function te(e={presentModeFloatieGroupModel:{},popOverState:_.a.Collapsed},t){if(null===e)return{presentModeFloatieGroupModel:{},popOverState:_.a.Collapsed};switch(t.type){case N.q:{const n=_object_spread({},e);return t.payload.models.forEach(e=>{n.presentModeFloatieGroupModel&&(n.presentModeFloatieGroupModel[e.id]=e)}),n}case N.Gb:return _object_spread({},e,t.payload.state);default:return e}}function ne(e){return t=>{t(H(e))}}var oe=n(576),re=n(261),ie=n(2529),ae=n(78),se=n(63),le=n(93),ce=n(414),ue=n(2454),de=n(205);const pe=Object(de.strEnum)(["TogglePresentModeOverlay","ToggleHeadingsGridlines","PresentModeShowGridlines","PresentModeShowHeadings","PresentModeSelectZoomOption","PresentModeZoomIn","PresentModeZoomOut","ExitPresentMode"]),ge=Object(Z.a)(r.a),he=Object(de.strEnum)(["PresentModeGridView","PresentModeZoom","PresentModeExit"]);function me(){const e=[Object(oe.a)([Object(re.a)(pe.TogglePresentModeOverlay,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PresentationViewToolbarSpotlight),{iconSet:{default:J.a.SpotlightDynamic},toggled:!0,customTooltip:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PresentationViewToolbarSpotlightTooltip)}),Object(ie.a)(pe.PresentModeShowGridlines,{label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ShowGridlines),keytip:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ShowGridlinesKeyTip),checked:!1}),Object(ie.a)(pe.PresentModeShowHeadings,{label:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ShowHeadings),keytip:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ShowHeadingsKeyTip),checked:!0}),Object(ae.a)(pe.ToggleHeadingsGridlines,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PresentationViewToolbarShowOptions),{iconSet:{default:J.a.ViewingTogglesWhite},menuModel:Object(se.a)([Object(se.b)([pe.PresentModeShowGridlines,pe.PresentModeShowHeadings])]),customTooltip:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PresentationViewToolbarShowOptions)}),Object(le.a)(pe.PresentModeZoomIn,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PresentationViewToolbarZoomIn),{iconSet:{default:J.a.ZoomPlusWhite},customTooltip:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PresentationViewToolbarZoomIn)}),Object(le.a)(pe.PresentModeZoomOut,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PresentationViewToolbarZoomOut),{iconSet:{default:J.a.ZoomMinusWhite},customTooltip:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PresentationViewToolbarZoomOut)}),Object(ce.e)(pe.PresentModeSelectZoomOption,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.Zoom),{iconSet:{default:"",alternateIcon:X.a.ZoomCurrent100_20},selectedKey:"125",options:[Object(ce.d)("200",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ZoomTo200)),Object(ce.d)("175",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ZoomTo175)),Object(ce.d)("150",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ZoomTo150)),Object(ce.d)("125",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ZoomTo125)),Object(ce.d)("100",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ZoomTo100)),Object(ce.d)("75",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ZoomTo75)),Object(ce.d)("50",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ZoomTo50)),Object(ce.d)("25",ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ZoomTo25))],customTooltip:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.ZoomToolTip),width:60,pinToPreviousComboBox:!1,showLabel:!0},ce.a.FreeForm),Object(le.a)(pe.ExitPresentMode,ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PresentationViewToolbarExit),{iconSet:{default:J.a.CloseWhite},customTooltip:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.PresentationViewToolbarExit)})]),z([Object(ue.c)(he.PresentModeGridView,[pe.TogglePresentModeOverlay,pe.ToggleHeadingsGridlines]),Object(ue.c)(he.PresentModeZoom,[pe.PresentModeZoomOut,pe.PresentModeSelectZoomOption,pe.PresentModeZoomIn]),Object(ue.c)(he.PresentModeExit,[pe.ExitPresentMode])])];var t,n;t=ge,n=e,ee.b.register("presentModeFloatieModel",te),t(n)}function be(e,t,n){e&&t&&(ge(ne({target:e,isActive:!0,triggerElement:t,shyDismissalRegions:n,popOverState:_.a.Expanded})),function(e){e&&G.render(o.createElement(Y,{containerId:e.id}),e)}(e))}function fe(){ge(ne({isActive:!1,popOverState:_.a.Collapsed}))}function xe(e){ge(ne({popOverState:e}))}function Ee(){const e=A(r.a.getState()),t=[];return Object.keys(e).map(n=>{t.push({controlId:n,modelType:e[n]})}),t}},3096:function(e,t,n){"use strict";n.d(t,"a",(function(){return G}));var o=n(1),r=n(2611),i=n(2618),a=n(2620),s=n(2515),l=n(2619),c=n(1789),u=n(517),d=n(2514),p=n(5),g=n(2516),h=n(717),m=n(235),b=n(2565),f=n(2518),x=n(1585);const E=o.memo(o.forwardRef((e,t)=>{const n=((e,t)=>Object(x.a)(_object_spread_props(_object_spread({},e),{secondaryContent:e.description}),t))(e,t);return Object(b.a)(n),Object(f.a)(n)}));E.displayName="next/ContextMenuCompoundButton";var S=n(112),y=n(53);class C extends o.PureComponent{render(){return o.createElement(m.a,null,e=>o.createElement(g.a,_object_spread_props(_object_spread({},this.props),{dataAutomationType:"ContextMenuCompoundButton",styles:Object(h.a)(e,{root:{padding:0,minHeight:"initial",minwidth:"initial",height:"50px"},label:{fontWeight:p.l.bold,margin:"0"}}),keytipProps:void 0})))}}const v=o.forwardRef((e,t)=>{const n=(e=>{const t=o.useContext(S.a);return Object(y.a)(t,y.f.fluentV9ContextMenuIsEnabled)})(),r=void 0===e.useLegacyCompoundButton||e.useLegacyCompoundButton;return n&&!r?o.createElement(E,_object_spread_props(_object_spread({},e),{ref:t})):o.createElement(C,_object_spread_props(_object_spread({},e),{ref:t}))});var R=n(187),k=n(787),T=n(20),_=n(1790),w=n(2503),D=n(470),P=n(523),I=n(19),F=n(163),B=n(2500),M=n(1488),j=n(40),O=n(2593),L=n(136);const A=Object(L.a)({root:{width:"100%",justifyContent:"start"}}),N=Object(T.c)(e=>()=>o.createElement(R.a,{iconName:e,style:{width:20,height:20}})),W=Object(T.c)(e=>{const t=Object(D.a)(e),n=Object(F.c)()?t.defaultBackgroundColor:P.a.defaultBackgroundColor;return{root:{selectors:{[I.b]:{background:n},":active":{background:n}},padding:"0px 16px 0px 9px",width:"100%"},label:{paddingLeft:6}}});class z extends o.PureComponent{render(){return o.createElement(m.a,null,e=>o.createElement(w.a,_object_spread_props(_object_spread({},this.props),{onRenderIcon:this.renderIcon,styles:Object(h.a)(e,W(e)),keytipProps:void 0})))}constructor(){super(...arguments),this.renderIcon=()=>o.createElement(k.a,{coinSize:20,imageInitials:Object(_.a)(this.props.personaInfo.displayName,!1),onRenderInitials:""===Object(_.a)(this.props.personaInfo.displayName,!1)||this.props.personaInfo.isUnauthenticatedSender&&!Object(y.a)(this.context,y.f.customAnonymousNameIsEnabled)?N(this.props.icon):void 0,initialsColor:this.props.personaInfo.personaCoinColor})}}z.contextType=S.a;const H=e=>{const t=o.useContext(S.a),{icon:n}=e,{displayName:r,isUnauthenticatedSender:i,personaCoinColor:a}=e.personaInfo,s=A(),l=Object(_.a)(r,!1),c=a&&Object(M.a)(a)?j.a[a]:void 0,u=o.createElement(R.a,{iconName:n,style:{width:20,height:20}}),d={size:"extra-small",avatar:{initialsColor:c,size:20,initials:{style:{backgroundColor:void 0===c?a:void 0},children:""!==l&&l},icon:""===l||i&&!Object(y.a)(t,y.f.customAnonymousNameIsEnabled)?u:void 0}};return o.createElement(O.a,_object_spread_props(_object_spread({},e),{className:s.root,personaProps:d}))},V=e=>Object(B.a)()?o.createElement(H,_object_spread({},e)):o.createElement(z,_object_spread({},e));var U=n(149);function G(e,t,n,p,g,h){const m=isNaN(n)?void 0:n,b=isNaN(p)?void 0:p;switch(e.type){case"AppColorPickerProps":return o.createElement(r.a,_object_spread({positionInSet:m,setSize:b},Object(c.a)(e,t)));case"AppCompoundButtonProps":return o.createElement(v,_object_spread_props(_object_spread({positionInSet:m,setSize:b},Object(c.a)(e,t)),{lang:e.lang,enableFocusOnHover:!0,useLegacyCompoundButton:!1}));case"AppCharacterCodeGalleryProps":return o.createElement(i.a,_object_spread({positionInSet:m,setSize:b},Object(u.a)(e,t)));case"AppListGalleryProps":return o.createElement(l.a,_object_spread({positionInSet:m,setSize:b},Object(u.a)(e,t)));case"AppIconFullGalleryProps":return o.createElement(s.a,_object_spread({positionInSet:m,setSize:b},Object(u.a)(e,t)));case"AppFontStylesFullGalleryProps":return o.createElement(a.a,_object_spread({positionInSet:m,setSize:b,controlInMenuRendererFunction:g,iconName:Object(U.a)()?null==h?void 0:h.submenuLauncherRtl:null==h?void 0:h.submenuLauncher},Object(u.a)(e,t)));case"AppPersonaButtonProps":return o.createElement(V,_object_spread_props(_object_spread({positionInSet:m,setSize:b},Object(c.a)(e,t)),{lang:e.lang}));case"RibbonChangeColorsFullGalleryProps":return o.createElement(d.a,_object_spread({positionInSet:m,setSize:b},Object(u.a)(e,t)));default:throw new Error(`The control of type ${e.type} is not valid in a Floatie menu`)}}},3099:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var o=n(1),r=n(16),i=n(269),a=n(707),s=n(218),l=n(361),c=n(119),u=n(56);const d=Object(c.a)({base:{Bt984gj:"f122n59",B7ck84d:"f1ewtqcl",mc9l5x:"f22iagw",Beiy3e4:"f1063pyq",Bh6795r:"fqerorx",qhf8xq:"f10pi13n",Bahqtrf:"fk6fouc",Be2twd7:"fy9rknc",Bhrd7zp:"figsok6",Bg96gwp:"fwrc4pm",fsow6f:"f17mccla",Bcvre1j:"fyl8oag",Br0sdwz:"f16vkdww",Bn78ew0:"fhsnbul",li1rpt:"f1gw3sf2",ap17g6:"f1ly5f7u",B771hl4:"f1s3tz6t"},childless:{susq4k:"f1kyqvp9",Bicfajf:["fzynn9s","f1z0ukd1"],jwcpgy:["fekrn8e","ftdg338"],B4rk6o:"fesgyo"},start:{Bsft5z2:"f13zj6fq"},center:{Ftih45:"f1wl9k8s",Bsft5z2:"f13zj6fq"},end:{Ftih45:"f1wl9k8s"},brand:{sj55zd:"f16muhyy",Bq4z7u6:"fcbuu2a",Bk5zm6e:["f1wdw2dr","f1ttio3w"],Bqjgrrk:"f1582fpk",Bm6vgfq:["f1ttio3w","f1wdw2dr"],B0n5ga8:"f1ahrvm8",s924m2:["f1cd3wbc","f17hbk9y"],B1q35kw:"fvrapl0",Gp14am:["f17hbk9y","f1cd3wbc"]},default:{sj55zd:"fkfq4zb",Bq4z7u6:"f1vccso1",Bk5zm6e:["f1geml7w","fjml6kk"],Bqjgrrk:"f1r7kh1m",Bm6vgfq:["fjml6kk","f1geml7w"],B0n5ga8:"f16j7guv",s924m2:["fx01ahm","fj1a37q"],B1q35kw:"fl8d8yv",Gp14am:["fj1a37q","fx01ahm"]},subtle:{sj55zd:"f11d4kpn",Bq4z7u6:"f5g06un",Bk5zm6e:["f13sxdku","f1n015lb"],Bqjgrrk:"f1x6bl8t",Bm6vgfq:["f1n015lb","f13sxdku"],B0n5ga8:"fvod1wy",s924m2:["fwslg65","flk0e17"],B1q35kw:"f103fvts",Gp14am:["flk0e17","fwslg65"]},strong:{sj55zd:"f19n0e5",Bq4z7u6:"f10tv6oz",Bk5zm6e:["f16xp3sf","f1seuxxq"],Bqjgrrk:"fwrmqbx",Bm6vgfq:["f1seuxxq","f16xp3sf"],B0n5ga8:"ft83z1f",s924m2:["f1g4150c","f192dr6e"],B1q35kw:"f1qnawh6",Gp14am:["f192dr6e","f1g4150c"]}},{d:[".f122n59{align-items:center;}",".f1ewtqcl{box-sizing:border-box;}",".f22iagw{display:flex;}",".f1063pyq{flex-direction:row;}",".fqerorx{flex-grow:1;}",".f10pi13n{position:relative;}",".fk6fouc{font-family:var(--fontFamilyBase);}",".fy9rknc{font-size:var(--fontSizeBase200);}",".figsok6{font-weight:var(--fontWeightRegular);}",".fwrc4pm{line-height:var(--lineHeightBase200);}",".f17mccla{text-align:center;}",".fyl8oag::before{box-sizing:border-box;}",".f16vkdww::before{display:flex;}",".fhsnbul::before{flex-grow:1;}",".f1gw3sf2::after{box-sizing:border-box;}",".f1ly5f7u::after{display:flex;}",".f1s3tz6t::after{flex-grow:1;}",".f1kyqvp9::before{margin-bottom:0;}",".fzynn9s::before{margin-right:0;}",".f1z0ukd1::before{margin-left:0;}",".fekrn8e::after{margin-left:0;}",".ftdg338::after{margin-right:0;}",".fesgyo::after{margin-top:0;}",'.f13zj6fq::after{content:"";}','.f1wl9k8s::before{content:"";}',".f16muhyy{color:var(--colorBrandForeground1);}",".fcbuu2a::before{border-top-color:var(--colorBrandStroke1);}",".f1wdw2dr::before{border-right-color:var(--colorBrandStroke1);}",".f1ttio3w::before{border-left-color:var(--colorBrandStroke1);}",".f1582fpk::before{border-bottom-color:var(--colorBrandStroke1);}",".f1ahrvm8::after{border-top-color:var(--colorBrandStroke1);}",".f1cd3wbc::after{border-right-color:var(--colorBrandStroke1);}",".f17hbk9y::after{border-left-color:var(--colorBrandStroke1);}",".fvrapl0::after{border-bottom-color:var(--colorBrandStroke1);}",".fkfq4zb{color:var(--colorNeutralForeground2);}",".f1vccso1::before{border-top-color:var(--colorNeutralStroke2);}",".f1geml7w::before{border-right-color:var(--colorNeutralStroke2);}",".fjml6kk::before{border-left-color:var(--colorNeutralStroke2);}",".f1r7kh1m::before{border-bottom-color:var(--colorNeutralStroke2);}",".f16j7guv::after{border-top-color:var(--colorNeutralStroke2);}",".fx01ahm::after{border-right-color:var(--colorNeutralStroke2);}",".fj1a37q::after{border-left-color:var(--colorNeutralStroke2);}",".fl8d8yv::after{border-bottom-color:var(--colorNeutralStroke2);}",".f11d4kpn{color:var(--colorNeutralForeground3);}",".f5g06un::before{border-top-color:var(--colorNeutralStroke3);}",".f13sxdku::before{border-right-color:var(--colorNeutralStroke3);}",".f1n015lb::before{border-left-color:var(--colorNeutralStroke3);}",".f1x6bl8t::before{border-bottom-color:var(--colorNeutralStroke3);}",".fvod1wy::after{border-top-color:var(--colorNeutralStroke3);}",".fwslg65::after{border-right-color:var(--colorNeutralStroke3);}",".flk0e17::after{border-left-color:var(--colorNeutralStroke3);}",".f103fvts::after{border-bottom-color:var(--colorNeutralStroke3);}",".f19n0e5{color:var(--colorNeutralForeground1);}",".f10tv6oz::before{border-top-color:var(--colorNeutralStroke1);}",".f16xp3sf::before{border-right-color:var(--colorNeutralStroke1);}",".f1seuxxq::before{border-left-color:var(--colorNeutralStroke1);}",".fwrmqbx::before{border-bottom-color:var(--colorNeutralStroke1);}",".ft83z1f::after{border-top-color:var(--colorNeutralStroke1);}",".f1g4150c::after{border-right-color:var(--colorNeutralStroke1);}",".f192dr6e::after{border-left-color:var(--colorNeutralStroke1);}",".f1qnawh6::after{border-bottom-color:var(--colorNeutralStroke1);}"]}),p=Object(c.a)({base:{a9b677:"fly5x3f",Bdkvgpv:"f163fonl",B0qfbqy:"f51yk4v",pbipgd:"f13rof3u",Bm2nyyq:"f8rth92",xrcqlc:"f6czdpx",i5u598:"f1iyka9k"},inset:{uwmqm3:["fjlbh76","f11qrl6u"],z189sj:["f11qrl6u","fjlbh76"]},start:{Ftih45:"f1wl9k8s",Bicfajf:["f1ojjlep","fk1kexq"],Bxwl2t9:"f1he2m4d",jwcpgy:["f12w1bnb","f1558wlj"]},center:{Bicfajf:["f1ojjlep","fk1kexq"],jwcpgy:["f12w1bnb","f1558wlj"]},end:{Bicfajf:["f1ojjlep","fk1kexq"],Bsft5z2:"f13zj6fq",jwcpgy:["f12w1bnb","f1558wlj"],Iy66sp:"f1ayce8x"}},{d:[".fly5x3f{width:100%;}",".f163fonl::before{border-top-style:solid;}",".f51yk4v::before{border-top-width:var(--strokeWidthThin);}",".f13rof3u::before{min-width:8px;}",".f8rth92::after{border-top-style:solid;}",".f6czdpx::after{border-top-width:var(--strokeWidthThin);}",".f1iyka9k::after{min-width:8px;}",".fjlbh76{padding-left:12px;}",".f11qrl6u{padding-right:12px;}",'.f1wl9k8s::before{content:"";}',".f1ojjlep::before{margin-right:12px;}",".fk1kexq::before{margin-left:12px;}",".f1he2m4d::before{max-width:8px;}",".f12w1bnb::after{margin-left:12px;}",".f1558wlj::after{margin-right:12px;}",'.f13zj6fq::after{content:"";}',".f1ayce8x::after{max-width:8px;}"]}),g=Object(c.a)({base:{Beiy3e4:"f1vx9l62",sshi5w:"f16gbxbe",m598lv:["f1yq6w5o","f1jpmc5p"],B4f6apu:["f9sc749","f1x8pvcy"],zkzzav:"fhkwbjy",Barhvk9:["flthirb","ftkbnf5"],Ihftqj:["f13hvwk3","f1en4csx"],Bde111x:"f19onpk6"},inset:{B6of3ja:"f1xdg43u",jrapky:"f1jlhsmd"},withChildren:{sshi5w:"f1tjaq3g"},start:{Ftih45:"f1wl9k8s",susq4k:"fg2pwug",Bbdr6tz:"fkjtzyi",B4rk6o:"f8vk40g"},center:{susq4k:"fg2pwug",B4rk6o:"f8vk40g"},end:{susq4k:"fg2pwug",Bsft5z2:"f13zj6fq",B4rk6o:"f8vk40g",gn64ia:"fqg5mu5"}},{d:[".f1vx9l62{flex-direction:column;}",".f16gbxbe{min-height:20px;}",".f1yq6w5o::before{border-right-style:solid;}",".f1jpmc5p::before{border-left-style:solid;}",".f9sc749::before{border-right-width:var(--strokeWidthThin);}",".f1x8pvcy::before{border-left-width:var(--strokeWidthThin);}",".fhkwbjy::before{min-height:8px;}",".flthirb::after{border-right-style:solid;}",".ftkbnf5::after{border-left-style:solid;}",".f13hvwk3::after{border-right-width:var(--strokeWidthThin);}",".f1en4csx::after{border-left-width:var(--strokeWidthThin);}",".f19onpk6::after{min-height:8px;}",".f1xdg43u{margin-top:12px;}",".f1jlhsmd{margin-bottom:12px;}",".f1tjaq3g{min-height:84px;}",'.f1wl9k8s::before{content:"";}',".fg2pwug::before{margin-bottom:12px;}",".fkjtzyi::before{max-height:8px;}",".f8vk40g::after{margin-top:12px;}",'.f13zj6fq::after{content:"";}',".fqg5mu5::after{max-height:8px;}"]});var h=n(573);const m=o.forwardRef((e,t)=>{const n=((e,t)=>{const{alignContent:n="center",appearance:o="default",inset:r=!1,vertical:i=!1,wrapper:c}=e,u=Object(a.a)("divider-");return{alignContent:n,appearance:o,inset:r,vertical:i,components:{root:"div",wrapper:"div"},root:s.a.always(Object(l.a)("div",_object_spread_props(_object_spread({role:"separator","aria-orientation":i?"vertical":"horizontal","aria-labelledby":e.children?u:void 0},e),{ref:t})),{elementType:"div"}),wrapper:s.a.always(c,{defaultProps:{id:u,children:e.children},elementType:"div"})}})(e,t);return(e=>{const t=d(),n=p(),o=g(),{alignContent:r,appearance:i,inset:a,vertical:s}=e;e.root.className=Object(u.a)("fui-Divider",t.base,t[r],i&&t[i],!s&&n.base,!s&&a&&n.inset,!s&&n[r],s&&o.base,s&&a&&o.inset,s&&o[r],s&&void 0!==e.root.children&&o.withChildren,void 0===e.root.children&&t.childless,e.root.className),e.wrapper&&(e.wrapper.className=Object(u.a)("fui-Divider__wrapper",e.wrapper.className))})(n),Object(h.c)("useDividerStyles_unstable")(n),(e=>(Object(i.a)(e),Object(r.a)(e.root,{children:void 0!==e.root.children&&Object(r.a)(e.wrapper,{children:e.root.children})})))(n)});m.displayName="Divider"},482:function(e,t,n){"use strict";var o=n(2481);t.a=o.a},579:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var o=n(3),r=n(1),i=n(525),a=n(820),s=n(353),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.render=function(){return r.createElement(s.a,Object(o.__assign)({},this.props,{primary:!0,onRenderDescription:i.b}))},Object(o.__decorate)([Object(a.a)("PrimaryButton",["theme","styles"],!0)],t)}(r.Component)}}]);
//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/uiSlice20.min.js.map/fa4b3b97a87bfbff6cf43b00ff0574e1/uiSlice20.min.js.map