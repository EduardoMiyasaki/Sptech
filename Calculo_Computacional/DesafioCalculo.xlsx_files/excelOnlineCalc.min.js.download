/*! For license information please see excelOnlineCalc.min.js.LICENSE.txt */
var excelOnlineCalc;!function(){var e={10259:function(e,t,r){"use strict";var n,a,i;r.r(t),r.d(t,{FormulaByExampleAnnotation:function(){return l},FormulaByExampleInvocationMethod:function(){return a},FormulaByExampleResultKind:function(){return n},FormulaByExampleSignal:function(){return s},FormulaByExampleWarmUpAnnotation:function(){return c},FormulaByExampleWarmUpSignal:function(){return u},ValueType:function(){return i}}),function(e){e[e.Success=0]="Success",e[e.NoFormulas=1]="NoFormulas",e[e.Failed=2]="Failed"}(n||(n={})),function(e){e[e.Explicit=0]="Explicit",e[e.Implicit=1]="Implicit"}(a||(a={})),function(e){e[e.General=0]="General",e[e.Number=1]="Number",e[e.DateTime=2]="DateTime"}(i||(i={}));class o{static getTypeName(){return"AugLoop_Core_SchemaObject"}static getBaseTypes(){return[]}static getTypeNameFor(e){return e&&e.H_?e.H_.T_:void 0}static getBaseTypesFor(e){return e&&e.H_&&e.H_.B_?e.H_.B_:[]}static getAllTypesFor(e){const t=o.getTypeNameFor(e);return t?[t,...o.getBaseTypesFor(e)]:[]}static matchesTypesFor(e,t){if(!Array.isArray(t)||0===t.length)return!0;const r=o.getTypeNameFor(e),n=o.getBaseTypesFor(e);for(const e of t){if(e===r)return!0;if(n.indexOf(e)>=0)return!0}return!1}static assign(e,t,r){if(r)for(const e of Object.keys(r))t[e]=r[e];return t.H_=e.H_,t}constructor(e){o.assign(o,this,e)}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class s{static getTypeName(){return"AugLoop_FormulaByExample_FormulaByExampleSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.matchesTypesFor(e,[s.getTypeName()])}constructor(e){o.assign(s,this,e)}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class u{static getTypeName(){return"AugLoop_FormulaByExample_FormulaByExampleWarmUpSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.matchesTypesFor(e,[u.getTypeName()])}constructor(e){o.assign(u,this,e)}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class l{get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_FormulaByExample_FormulaByExampleAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.matchesTypesFor(e,[l.getTypeName()])}constructor(e){o.assign(l,this,e)}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class c{get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_FormulaByExample_FormulaByExampleWarmUpAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.matchesTypesFor(e,[c.getTypeName()])}constructor(e){o.assign(c,this,e)}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()}},88488:function(e,t,r){"use strict";r.d(t,{EW:function(){return h},Il:function(){return c},KJ:function(){return d},Kz:function(){return y},Mu:function(){return F},My:function(){return S},Nn:function(){return f},OD:function(){return u},Q7:function(){return l},TA:function(){return v},ay:function(){return m},qw:function(){return p},rh:function(){return g}});var n=r(88251);function a(e,t){return e?e+"."+t:t}function i(e,t,r,i,o){void 0===o&&(o=4),i&&e.push((0,n.m9)("".concat(a(t,r)),i,o))}function o(e,t,r,i){"boolean"==typeof i&&e.push((0,n.LK)("".concat(a(t,r)),i))}function s(e,t,r,i){"number"==typeof i&&e.push((0,n.Ug)("".concat(a(t,r)),i))}var u,l={getFields:function(e){var t="Activity.Result",r=[];return s(r,t,"Code",e.code),i(r,t,"Type",e.type),s(r,t,"Tag",e.tag),o(r,t,"IsExpected",e.isExpected),r.push((0,n.m9)("zC.Activity.Result","Office.System.Result")),r}},c={contractName:"Office.System.Activity",getFields:function(e){var t="Activity",r=[];return i(r,t,"CV",e.cV),s(r,t,"Duration",e.duration),s(r,t,"Count",e.count),s(r,t,"AggMode",e.aggMode),o(r,t,"Success",e.success),e.result&&r.push.apply(r,l.getFields(e.result)),r.push((0,n.m9)("zC.Activity",this.contractName)),r}},d={getFields:function(e){var t="User",r=[];return i(r,t,"PrimaryIdentityHash",e.primaryIdentityHash),i(r,t,"PrimaryIdentitySpace",e.primaryIdentitySpace),i(r,t,"TenantId",e.tenantId,1),i(r,t,"TenantGroup",e.tenantGroup,1),o(r,t,"IsAnonymous",e.isAnonymous),o(r,t,"IsSignedIn",e.isSignedIn),r}},g={getFields:function(e,t){var r=[];return i(r,e,"Name",t.name),i(r,e,"State",t.state),r}},m={getFields:function(e){var t="UserAction",r=[];return s(r,t,"Id",e.id),i(r,t,"Name",e.name),i(r,t,"CommandSurface",e.commandSurface),i(r,t,"ParentName",e.parentName),i(r,t,"TriggerMethod",e.triggerMethod),s(r,t,"TimeOffsetMs",e.timeOffsetMs),r}};!function(e){e.Web="Web",e.Desktop="Desktop",e.Universal="Universal",e.Mobile="Mobile",e.Win32="Win32",e.iOS="iOS",e.Android="Android"}(u||(u={}));var h,p={getFields:function(e){var t="App",r=[];return i(r,t,"Name",e.name,1),i(r,t,"Platform",e.platform,1),i(r,t,"Version",e.version,1),r}},f={getFields:function(e){var t="Session",r=[];return i(r,t,"Id",e.id,1),i(r,t,"EcsETag",e.ecsETag,1),r}},S={getFields:function(e){var t=[];return t.push((0,n.m9)("Pillar",e.pillar)),t.push((0,n.m9)("Veto",e.veto)),t.push((0,n.LK)("IsIntentional",e.isIntentional)),t.push((0,n.LK)("IsInternal",e.isInternal)),t.push((0,n.LK)("AlertOnPillar",e.alertOnPillar)),t.push((0,n.LK)("IsSessionEndingError",e.isSessionEndingError)),o(t,void 0,"InStaging",e.inStaging),t}};!function(e){e.Automation="Automation",e.Dogfood="Dogfood",e.Microsoft="Microsoft",e.Insiders="Insiders",e.Production="Production"}(h||(h={}));var v,F,y={getFields:function(e){var t=[];return i(t,"Release","AudienceGroup",e.audienceGroup,1),t}};!function(e){var t,r,a,s,u="Copilot";(s=e.FeatureActionType||(e.FeatureActionType={})).IsEnabled="IsEnabled",s.IsSeen="IsSeen",s.IsTried="IsTried",s.IsKept="IsKept",s.IsRejected="IsRejected",(a=e.Capability||(e.Capability={})).ContentGeneration="Content Generation",a.Commanding="Commanding",a.QAandSummaries="QA and Summaries",a.Collaboration="Collaboration",a.Suggestions="Suggestions",(r=e.EntryPoint||(e.EntryPoint={})).Chat="Chat",r.Canvas="Canvas",(t=e.Verb||(e.Verb={})).Create="Create",t.Command="Command",t.Ask="Ask",t.Summarize="Summarize",t.Share="Share",t.Analyze="Analyze",e.getFields=function(e){var t=[];return i(t,u,"FeatureActionType",e.featureActionType),o(t,u,"IsUserInitiated",e.isUserInitiated),i(t,u,"FeatureName",e.featureName),i(t,u,"SubFeatureName",e.subFeatureName),i(t,u,"Capability",e.capability),o(t,u,"IsThumbsUp",e.isThumbsUp),i(t,u,"EntryPoint",e.entryPoint),i(t,u,"Verb",e.verb),i(t,u,"InteractionId",e.interactionId),t.push((0,n.m9)("zC.".concat(u),"Office.System.Copilot")),t}}(v||(v={})),function(e){var t,r="Asha";(t=e.EventType||(e.EventType={})).Pillar="Pillar",t.Error="Error",e.getFields=function(e){var t=[];return i(t,r,"EventType",e.eventType),i(t,r,"Pillar",e.pillar),i(t,r,"Scenario",e.scenario),i(t,r,"Veto",e.veto),i(t,r,"Error",e.error),o(t,r,"InStaging",e.inStaging),o(t,r,"IsSessionEndingError",e.isSessionEndingError),o(t,r,"IsIntentional",e.isIntentional),o(t,r,"IsInternal",e.isInternal),t.push((0,n.m9)("zC.".concat(r),"Office.System.Asha")),t}}(F||(F={}))},2200:function(e,t,r){"use strict";var n;r.d(t,{CV:function(){return a},N:function(){return i}});var a=function(){function e(e){this.value=e,this.nextChild=0}return e.prototype.getNext=function(){return new e("".concat(this.value,".").concat(++this.nextChild))},e}();function i(){if(!n){for(var e=[],t=0;t<22;t++)e.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(Math.floor(64*Math.random())));n=new a(e.join(""))}return n}},88251:function(e,t,r){"use strict";function n(e,t,r){return u(e,1,t,r)}function a(e,t,r){return u(e,2,t,r)}function i(e,t,r){return u(e,3,t,r)}function o(e,t,r){return u(e,0,t,r)}function s(e,t,r){return u(e,4,t,r)}function u(e,t,r,n){return{name:e,dataType:t,value:r,classification:n||4}}r.d(t,{LK:function(){return n},Ug:function(){return a},ip:function(){return i},k:function(){return s},m9:function(){return o}})},77513:function(e,t,r){"use strict";r.d(t,{d$:function(){return i},vV:function(){return s},wC:function(){return o}});var n,a=(n=[],{fireEvent:function(e){n.forEach((function(t){return t(e)}))},addListener:function(e){e&&n.push(e)}});function i(){return a}function o(e,t,r){a.fireEvent({level:e,category:t,message:r})}function s(e,t,r){o(0,e,(function(){var e=r instanceof Error?r.message:"";return"".concat(t,": ").concat(e)}))}},16930:function(e,t,r){"use strict";r.d(t,{GV:function(){return S},di:function(){return p},EY:function(){return f}});var n=r(74643),a=r(77513),i={};function o(e,t){"Office."===e.substring(0,7)&&"."!==e[e.length-1]?i[e]?(t.ariaTenantToken&&(i[e].ariaTenantToken=t.ariaTenantToken),t.dnmToken&&(i[e].dnmToken=t.dnmToken)):i[e]=t:(0,a.wC)(0,0,(function(){return"Namespace: ".concat(e)}))}function s(e,t){for(var r=e.length;r>0;){var n=e.substr(0,r);if(i[n]){var a=i[n];return t.ariaTenantToken=a.ariaTenantToken,t.dnmToken=a.dnmToken,!0}r=e.lastIndexOf(".",r-1)}return!1}var u=9007199254740991,l=-u,c=/^Office(\.[A-Z][a-zA-Z0-9]*){2,}$/,d=/^[a-zA-Z0-9_\.]{1,95}$/;function g(e){return d.test(e)}function m(e){e&&e.forEach((function(e){if("string"!=typeof e.name||!g(e.name))throw new Error("Invalid dataField name");2===e.dataType&&function(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<l||e>u)throw new Error("Invalid integer ".concat(JSON.stringify(e)))}(e.value)}))}var h=r(88251),p=-1;function f(e){var t={eventName:e.eventName,eventFlags:e.eventFlags||{},telemetryProperties:e.telemetryProperties?(0,n.__assign)({},e.telemetryProperties):{},dataFields:e.dataFields?e.dataFields.slice():[],timestamp:e.timestamp||(new Date).getTime()};return e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t}var S=function(){function e(e,t,r){var a,i,o;this.telemetrySinks=[],this.persistentDataFields=[],this.partAFields=[],this.eventQueue=[],this.config=r||{},e&&(this.telemetrySinks=e.telemetrySinks,(a=this.persistentDataFields).push.apply(a,e.persistentDataFields),this.config=(0,n.__assign)((0,n.__assign)({},e.getConfig()),this.config),(i=this.partAFields).push.apply(i,e.partAFields)),t&&(o=this.persistentDataFields).push.apply(o,t)}return e.prototype.addEventContentType=function(e,t){e.push((0,h.Ug)("EventContent.Type",t))},e.prototype.sendTelemetryEvent=function(e){var t=f(e),r=t.telemetryProperties;r.nexusTenantToken=p;var n=r.ariaTenantToken;n||s(t.eventName,r)||n?this.sendTelemetryEventInternal(t,1):(0,a.wC)(0,0,(function(){return"No tenant token: "+e.eventName}))},e.prototype.sendNonStandardEvent=function(e,t){var r=f(e);this.sendTelemetryEventInternal(r,t)},e.prototype.sendCustomerContent=function(e){var t=f(e),r=t.telemetryProperties,n=r.customerContentVersion;return(!n||n>2)&&(r.customerContentVersion=2),r.ariaTenantToken=void 0,r.nexusTenantToken=void 0,r.dnmToken=void 0,this.addEventContentType(t.dataFields,2),this.sendTelemetryEventInternal(t,2)},e.prototype.sendDirectNumericEvent=function(e){var t=f(e),r=t.telemetryProperties;r.dnmToken||s(t.eventName,r)||r.dnmToken?(this.addEventContentType(t.dataFields,1),this.sendTelemetryEventInternal(t,3)):(0,a.wC)(0,0,(function(){return"No dnm token: "+t.eventName}))},e.prototype.sendTelemetryEventInternal=function(e,t){if(2===t||!e.telemetryProperties.customerContentVersion&&!e.telemetryProperties.customerContentType){try{if(0===this.telemetrySinks.length)return void(this.config.enableQueue&&this.eventQueue.length<1e3?this.eventQueue.push([e,t]):(0,a.wC)(1,0,(function(){return"No telemetry sinks are attached."})));this.processTelemetryEvent(e,t)}catch(e){return void(0,a.vV)(0,"SendTelemetryEvent",e)}this.telemetrySinks.forEach((function(r){try{3===t||2===t?r.sendNonStandardEvent&&r.sendNonStandardEvent(e,t):r.sendTelemetryEvent(e)}catch(e){}}))}else(0,a.wC)(0,0,(function(){return"Customer content"}))},e.prototype.processTelemetryEvent=function(e,t){var r,n,a;if(e.dataFields&&(null===(a=e.dataFields)||void 0===a||a.unshift((0,h.m9)("OTelJS.Version","4.19.5")),3!==t&&this.persistentDataFields&&(r=e.dataFields).unshift.apply(r,this.persistentDataFields)),this.partAFields.length>0){var i=e.eventContract||{name:"",dataFields:[]};(n=i.dataFields).push.apply(n,this.partAFields),e.eventContract=i}this.config.disableValidation||function(e){if(!(t=e.eventName)||t.length>98||!c.test(t))throw new Error("Invalid eventName");var t,r=e.eventContract;if(r){if(r.name&&!g(r.name))throw new Error("Invalid eventContract");m(r.dataFields)}m(e.dataFields)}(e)},e.prototype.addSink=function(e){this.telemetrySinks.push(e),this.flushQueue()},e.prototype.flushQueue=function(){var e=this.eventQueue;if(this.eventQueue=[],this.telemetrySinks.length>0)for(var t=0,r=e;t<r.length;t++){var n=r[t],a=n[0],i=n[1];this.sendTelemetryEventInternal(a,i)}},e.prototype.setTenantToken=function(e,t,r){o(e,{ariaTenantToken:t,nexusTenantToken:r})},e.prototype.setDNMToken=function(e,t){o(e,{dnmToken:t})},e.prototype.cloneEvent=function(e){return f(e)},e.prototype.getConfig=function(){return this.config},e}()},37374:function(e,t,r){"use strict";r.d(t,{M:function(){return d}});var n=r(74643),a=r(16930),i=r(88488),o=r(77513),s=function(){return 1e3*Date.now()};"object"==typeof window&&"object"==typeof window.performance&&"now"in window.performance&&(s=function(){return 1e3*Math.floor(window.performance.now())});var u=function(e){var t,r=s(),l=(0,a.EY)(e.telemetryEvent);return(0,n.__assign)((0,n.__assign)({cv:e.parentCv.getNext()},l),{createChildActivity:function(t){return u({telemetryEvent:t,sendTelemetryEvent:e.sendTelemetryEvent,parentCv:this.cv})},setResult:function(e,t,r){this.result={code:e,type:t,tag:r}},endNow:function(){var n,a,u=this;if(!t){void 0===this.success&&void 0===this.result&&(0,o.wC)(1,0,(function(){return"Activity does not have success or result set"}));var l=s();t=!0;var c={duration:l-r,count:1,aggMode:0,cV:this.cv.value,success:this.success,result:this.result},d=null!==(a=null===(n=this.eventContract)||void 0===n?void 0:n.dataFields)&&void 0!==a?a:[];return d.push.apply(d,i.Il.getFields(c)),this.eventContract={name:i.Il.contractName,dataFields:d},e.sendTelemetryEvent(this)}(0,o.wC)(0,0,(function(){return"'".concat(u.eventName,"' already ended")}))}})},l=r(88251),c=r(2200),d=function(e){function t(t,r,n){var a=e.call(this,t,r,n)||this;return a.baseCv=(0,c.N)(),a}return(0,n.__extends)(t,e),t.prototype.createActivity=function(e){return u({sendTelemetryEvent:this.sendTelemetryEvent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},t.prototype.sendActivity=function(e,t,r,n){return this.sendTelemetryEvent({eventName:e,eventContract:{name:i.Il.contractName,dataFields:i.Il.getFields(t)},dataFields:r,eventFlags:n})},t.prototype.sendError=function(e){var t=function(e){var t="Error",r=[];return r.push((0,l.m9)("".concat(t,".ErrorGroup"),e.errorGroup)),r.push((0,l.Ug)("".concat(t,".Tag"),e.tag)),void 0!==e.code&&r.push((0,l.Ug)("".concat(t,".Code"),e.code)),void 0!==e.id&&r.push((0,l.Ug)("".concat(t,".Id"),e.id)),void 0!==e.count&&r.push((0,l.Ug)("".concat(t,".Count"),e.count)),r}(e.error);return null!=e.dataFields&&t.push.apply(t,e.dataFields),this.sendTelemetryEvent({eventName:e.eventName,dataFields:t,eventFlags:e.eventFlags})},t.prototype.createCustomerContentActivity=function(e){return u({sendTelemetryEvent:this.sendCustomerContent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},t}(a.GV)},52716:function(e,t,r){"use strict";var n;r.d(t,{o:function(){return n}}),function(e){e.DataClassification={EssentialServiceMetadata:1,AccountData:2,SystemMetadata:4,OrganizationIdentifiableInformation:8,EndUserIdentifiableInformation:16,CustomerContent:32,AccessControl:64,PublicNonPersonalData:128,EndUserPseudonymousInformation:256,PublicPersonalData:512,SupportData:1024,DirectMeasurementData:2048,Everything:65535},e.DataFieldType={String:0,Boolean:1,Int64:2,Double:3,Guid:4},e.SamplingPolicy={NotSet:0,Measure:1,Diagnostics:2,CriticalBusinessImpact:191,CriticalCensus:192,CriticalExperimentation:193,CriticalUsage:194},e.PersistencePriority={NotSet:0,Normal:1,High:2},e.CostPriority={NotSet:0,Normal:1,High:2},e.DataCategories={NotSet:0,SoftwareSetup:1,ProductServiceUsage:2,ProductServicePerformance:4,DeviceConfiguration:8,InkingTypingSpeech:16},e.DiagnosticLevel={ReservedDoNotUse:0,Required:10,BasicEvent:10,Optional:100,FullEvent:100,RequiredServiceData:110,NecessaryServiceDataEvent:110,RequiredServiceDataForEssentialServices:120,AlwaysOnNecessaryServiceDataEvent:120},e.DnmInterval={Hourly:1,Daily:2},e.AllowedPartA={ReleaseAudienceGroup:1,WacRing:2,AppName:3,AppPlatform:4,AppVersion:5},e.CustomerContentType={None:0,MocaAddIn:1},e.LogLevel={Error:0,Warning:1,Info:2,Verbose:3},e.Category={Core:0,Sink:1,Transport:2},e.PrimaryIdentitySpace={UserObjectId:"UserObjectId",MSACID:"MSACID",OrgIdPuid:"OrgIdPuid",OrgIdPUID:"OrgIdPUID",OrgIdCID:"OrgIdCID",MsaPuid:"MsaPuid",MSAPUID:"MSAPUID",WopiAuth:"WopiAuth",ThirdParty:"ThirdParty",Other:"Other"},e.AudienceGroup={Automation:"Automation",Dogfood:"Dogfood",Microsoft:"Microsoft",Insiders:"Insiders",Production:"Production"}}(n||(n={}))},71191:function(e,t,r){"use strict";r.r(t),r.d(t,{Activity:function(){return F.Il},App:function(){return F.qw},Asha:function(){return F.Mu},AudienceGroup:function(){return F.EW},CV:function(){return y.CV},Contracts:function(){return d},Copilot:function(){return F.TA},EnumObjects:function(){return T.o},Funnel:function(){return F.rh},HealthQosError:function(){return F.My},Platform:function(){return F.OD},Release:function(){return F.Kz},Result:function(){return F.Q7},Session:function(){return F.Nn},SimpleTelemetryLogger:function(){return b.GV},SuppressNexus:function(){return b.di},TelemetryLogger:function(){return R.M},TraceContext:function(){return H},TraceFlags:function(){return E},TraceParent:function(){return G},TraceState:function(){return L},User:function(){return F.KJ},UserAction:function(){return F.ay},cloneEvent:function(){return b.EY},createTraceContext:function(){return $},getEffectiveEventFlags:function(){return A},logError:function(){return C.vV},logNotification:function(){return C.wC},makeBooleanDataField:function(){return c.LK},makeDoubleDataField:function(){return c.ip},makeGuidDataField:function(){return c.k},makeInt64DataField:function(){return c.Ug},makeStringDataField:function(){return c.m9},onNotification:function(){return C.d$},parseTraceContext:function(){return q},sendHealthQosError:function(){return N}});var n,a,i,o,s,u,l,c=r(88251);!function(e){e.getFields=function(e,t){var r=[];return r.push((0,c.Ug)("".concat(e,".Code"),t.code)),void 0!==t.type&&r.push((0,c.m9)("".concat(e,".Type"),t.type)),void 0!==t.tag&&r.push((0,c.Ug)("".concat(e,".Tag"),t.tag)),void 0!==t.isExpected&&r.push((0,c.LK)("".concat(e,".IsExpected"),t.isExpected)),r.push((0,c.m9)("zC.Activity.Result","Office.System.Result")),r}}(n||(n={})),function(e){e.contractName="Office.System.Activity",e.getFields=function(t){var r="Activity",a=[];return void 0!==t.cV&&a.push((0,c.m9)("".concat(r,".CV"),t.cV)),a.push((0,c.Ug)("".concat(r,".Duration"),t.duration)),a.push((0,c.Ug)("".concat(r,".Count"),t.count)),a.push((0,c.Ug)("".concat(r,".AggMode"),t.aggMode)),void 0!==t.success&&a.push((0,c.LK)("".concat(r,".Success"),t.success)),void 0!==t.result&&a.push.apply(a,n.getFields("".concat(r,".Result"),t.result)),a.push((0,c.m9)("zC.Activity",e.contractName)),a}}(a||(a={})),function(e){e.getFields=function(e,t){var r=[];return void 0!==t.id&&r.push((0,c.m9)("".concat(e,".Id"),t.id)),void 0!==t.version&&r.push((0,c.m9)("".concat(e,".Version"),t.version)),void 0!==t.sessionId&&r.push((0,c.m9)("".concat(e,".SessionId"),t.sessionId)),r}}(i||(i={})),function(e){e.getFields=function(e,t){var r=[];return void 0!==t.alias&&r.push((0,c.m9)("".concat(e,".Alias"),t.alias)),void 0!==t.primaryIdentityHash&&r.push((0,c.m9)("".concat(e,".PrimaryIdentityHash"),t.primaryIdentityHash)),void 0!==t.primaryIdentitySpace&&r.push((0,c.m9)("".concat(e,".PrimaryIdentitySpace"),t.primaryIdentitySpace)),void 0!==t.tenantId&&r.push((0,c.m9)("".concat(e,".TenantId"),t.tenantId)),void 0!==t.tenantGroup&&r.push((0,c.m9)("".concat(e,".TenantGroup"),t.tenantGroup)),void 0!==t.isAnonymous&&r.push((0,c.LK)("".concat(e,".IsAnonymous"),t.isAnonymous)),r}}(o||(o={})),function(e){e.getFields=function(e,t){var r=[];return void 0!==t.name&&r.push((0,c.m9)("".concat(e,".Name"),t.name)),void 0!==t.state&&r.push((0,c.m9)("".concat(e,".State"),t.state)),r}}(s||(s={})),function(e){e.getFields=function(e,t){var r=[];return void 0!==t.id&&r.push((0,c.Ug)("".concat(e,".Id"),t.id)),void 0!==t.name&&r.push((0,c.m9)("".concat(e,".Name"),t.name)),void 0!==t.commandSurface&&r.push((0,c.m9)("".concat(e,".CommandSurface"),t.commandSurface)),void 0!==t.parentName&&r.push((0,c.m9)("".concat(e,".ParentName"),t.parentName)),void 0!==t.triggerMethod&&r.push((0,c.m9)("".concat(e,".TriggerMethod"),t.triggerMethod)),void 0!==t.timeOffsetMs&&r.push((0,c.Ug)("".concat(e,".TimeOffsetMs"),t.timeOffsetMs)),r}}(u||(u={})),function(e){e.getFields=function(e,t){var r=[];return r.push((0,c.m9)("".concat(e,".ErrorGroup"),t.errorGroup)),r.push((0,c.Ug)("".concat(e,".Tag"),t.tag)),void 0!==t.code&&r.push((0,c.Ug)("".concat(e,".Code"),t.code)),void 0!==t.id&&r.push((0,c.Ug)("".concat(e,".Id"),t.id)),void 0!==t.count&&r.push((0,c.Ug)("".concat(e,".Count"),t.count)),r}}(l||(l={}));var d,g=a,m=n,h=l,p=s,f=i,S=u,v=o;!function(e){var t,r;t=e.Office||(e.Office={}),(r=t.System||(t.System={})).Activity=g,r.Result=m,r.Error=h,r.Funnel=p,r.Host=f,r.User=v,r.UserAction=S}(d||(d={}));var F=r(88488),y=r(2200),C=r(77513);function A(e){var t={costPriority:1,samplingPolicy:1,persistencePriority:1,dataCategories:0,diagnosticLevel:100};return e.eventFlags&&e.eventFlags.dataCategories||(0,C.wC)(0,0,(function(){return"DataCategories"})),e.eventFlags?(e.eventFlags.costPriority&&(t.costPriority=e.eventFlags.costPriority),e.eventFlags.samplingPolicy&&(t.samplingPolicy=e.eventFlags.samplingPolicy),e.eventFlags.persistencePriority&&(t.persistencePriority=e.eventFlags.persistencePriority),e.eventFlags.dataCategories&&(t.dataCategories=e.eventFlags.dataCategories),e.eventFlags.diagnosticLevel&&(t.diagnosticLevel=e.eventFlags.diagnosticLevel),t):t}var E,b=r(16930),R=r(37374),T=r(52716),k=r(74643);function N(e,t,r,n,a,i,o,s,u,l,c){n.forEach((function(n){e.sendTelemetryEvent({eventName:t.name+".Qos.Error."+r,eventFlags:{diagnosticLevel:110},dataFields:(0,k.__spreadArray)((0,k.__spreadArray)([],F.My.getFields({veto:n,pillar:a,isIntentional:i,isInternal:o,alertOnPillar:s,isSessionEndingError:u,inStaging:l}),!0),c||[],!0),telemetryProperties:{ariaTenantToken:t.token,nexusTenantToken:b.di}})}))}!function(e){e[e.None=0]="None",e[e.Sampled=1]="Sampled"}(E||(E={}));var I="[-_*/0-9a-z]",O="[a-z]".concat(I,"{0,255}"),_="[0-9a-z]".concat(I,"{0,240}"),P="[a-z]".concat(I,"{0,13}"),M="".concat(_,"@").concat(P),D=new RegExp("^(?:".concat(O,"|").concat(M,")$")),w=/^[ -+--<>-~]{0,255}[!-+--<>-~]$/,L=function(){function e(){this._listMemberMap=new Map}return e.prototype.set=function(e,t){if(!D.test(e)||!w.test(t))return!1;var r=this._listMemberMap;return r.has(e)&&r.delete(e),r.set(e,t),r.size>32&&r.delete(r.keys().next().value),!0},e.prototype.unset=function(e){this._listMemberMap.delete(e)},e.prototype.get=function(e){return this._listMemberMap.get(e)},Object.defineProperty(e.prototype,"keys",{get:function(){return Array.from(this._listMemberMap.keys()).reverse()},enumerable:!1,configurable:!0}),e.prototype.serialize=function(){var e=this;return this.keys.map((function(t){return"".concat(t).concat("=").concat(e._listMemberMap.get(t))})).join(",")},e.parse=function(t){var r=new e,n=t.split(","),a=!0;return n.reverse().forEach((function(e){var t=e.trim();if(t){var n=t.split("=");2===n.length&&r.set(n[0],n[1])||((0,C.wC)(1,0,(function(){return"Invalid trace state entry '".concat(t,"'")})),a=!1)}})),a?r:void 0},e}(),x=/^([\da-f]{2})-([\da-f]{32})-([\da-f]{16})-([\da-f]{2})(-\S+)?$/,K=function(e){return/^0+$/.test(e)},W=/^([\da-f]{16})$/,U=16,G=function(){function e(e,t,r){void 0===e&&(e=V()),void 0===t&&(t=j()),this.traceId=e,this.version="00",this._parentId=t,this._traceFlags=function(e){return void 0===e&&(e=E.None),e&E.Sampled}(r)}return Object.defineProperty(e.prototype,"parentId",{get:function(){return this._parentId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"traceFlags",{get:function(){return this._traceFlags},enumerable:!1,configurable:!0}),e.prototype.isValid=function(){return x.test(this.serialize())&&!K(this.traceId)&&!K(this._parentId)},e.prototype.isSampled=function(){return(this.traceFlags&E.Sampled)===E.Sampled},e.prototype.updateSampled=function(e,t){return t!==this._parentId&&!!this.updateParentId(t)&&(this._traceFlags=e?this._traceFlags|E.Sampled:this._traceFlags&~E.Sampled,!0)},e.prototype.updateParentId=function(e){return e?!(!W.test(e)||K(e)||(this._parentId=e,0)):(this._parentId=j(),!0)},e.prototype.serialize=function(){return"".concat(this.version,"-").concat(this.traceId,"-").concat(this._parentId,"-0").concat(this._traceFlags)},e.create=function(t,r,n){var a=new e(t,r,n);return a.isValid()?a:void 0},e.createNew=function(t){return new e(V(),j(),t)},e.parse=function(t){var r=x.exec(t);if(r&&"ff"!==r[1]&&("00"!==r[1]||!r[5]))return e.create(r[2],r[3],parseInt(r[4],U))},e}();function B(e){var t=new Uint8Array(e);window.crypto.getRandomValues(t);var r=Array.from(t).map((function(e){return(256+e).toString(U).slice(1)})).join("");return K(r)?r.slice(1)+"1":r}function V(){return B(16)}function j(){return B(8)}var H=function(){function e(){}return e.getFields=function(e){var t="Event.",r=e.parent,n=e.state,a=n?n.serialize():void 0;return(0,k.__spreadArray)([(0,c.m9)(t+"TraceId",r.traceId),(0,c.m9)(t+"TraceParentId",r.parentId),(0,c.Ug)(t+"TraceFlags",r.traceFlags)],a?[(0,c.m9)(t+"TraceState",a)]:[],!0)},e}();function q(e,t){var r,n=G.parse(e);return n&&t&&(r=L.parse(t)),r=r||new L,{parent:n||G.createNew(),state:r}}function $(e){return{parent:G.createNew(e),state:new L}}},67946:function(e,t,r){"use strict";r.r(t),r.d(t,{clearImmediate:function(){return u},setImmediate:function(){return s}});let n=1;const a=new Map;let i,o=!1,s=(e,...t)=>(a.set(n,[e,t]),i(n),n++),u=e=>{a.delete(e)};function l(e){if(o)setTimeout(l,0,e);else{const t=a.get(e);if(t){o=!0;try{t[0](...t[1])}finally{u(e),o=!1}}}}const c="undefined"==typeof self?"undefined"==typeof global?void 0:global:self;c.setImmediate?(s=c.setImmediate,u=c.clearImmediate):c.importScripts?function(){const e=new MessageChannel;e.port1.onmessage=e=>{l(e.data)},i=t=>{e.port2.postMessage(t)}}():function(){const e=`setImmediate$${Math.random()}$`;window.addEventListener("message",(t=>{"string"==typeof t.data&&t.data.startsWith(e)&&l(+t.data.slice(e.length))})),i=t=>{window.postMessage(e+t,"*")}}()},74643:function(e,t,r){"use strict";r.r(t),r.d(t,{__assign:function(){return i},__asyncDelegator:function(){return R},__asyncGenerator:function(){return b},__asyncValues:function(){return T},__await:function(){return E},__awaiter:function(){return h},__classPrivateFieldGet:function(){return _},__classPrivateFieldIn:function(){return M},__classPrivateFieldSet:function(){return P},__createBinding:function(){return f},__decorate:function(){return s},__esDecorate:function(){return l},__exportStar:function(){return S},__extends:function(){return a},__generator:function(){return p},__importDefault:function(){return O},__importStar:function(){return I},__makeTemplateObject:function(){return k},__metadata:function(){return m},__param:function(){return u},__propKey:function(){return d},__read:function(){return F},__rest:function(){return o},__runInitializers:function(){return c},__setFunctionName:function(){return g},__spread:function(){return y},__spreadArray:function(){return A},__spreadArrays:function(){return C},__values:function(){return v}});var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)};function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},i.apply(this,arguments)};function o(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r}function s(e,t,r,n){var a,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(o=(i<3?a(o):i>3?a(t,r,o):a(t,r))||o);return i>3&&o&&Object.defineProperty(t,r,o),o}function u(e,t){return function(r,n){t(r,n,e)}}function l(e,t,r,n,a,i){function o(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var s,u=n.kind,l="getter"===u?"get":"setter"===u?"set":"value",c=!t&&e?n.static?e:e.prototype:null,d=t||(c?Object.getOwnPropertyDescriptor(c,n.name):{}),g=!1,m=r.length-1;m>=0;m--){var h={};for(var p in n)h[p]="access"===p?{}:n[p];for(var p in n.access)h.access[p]=n.access[p];h.addInitializer=function(e){if(g)throw new TypeError("Cannot add initializers after decoration has completed");i.push(o(e||null))};var f=(0,r[m])("accessor"===u?{get:d.get,set:d.set}:d[l],h);if("accessor"===u){if(void 0===f)continue;if(null===f||"object"!=typeof f)throw new TypeError("Object expected");(s=o(f.get))&&(d.get=s),(s=o(f.set))&&(d.set=s),(s=o(f.init))&&a.push(s)}else(s=o(f))&&("field"===u?a.push(s):d[l]=s)}c&&Object.defineProperty(c,n.name,d),g=!0}function c(e,t,r){for(var n=arguments.length>2,a=0;a<t.length;a++)r=n?t[a].call(e,r):t[a].call(e);return n?r:void 0}function d(e){return"symbol"==typeof e?e:"".concat(e)}function g(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function m(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function h(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((n=n.apply(e,t||[])).next())}))}function p(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(o=0)),o;)try{if(r=1,n&&(a=2&s[0]?n.return:s[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,s[1])).done)return a;switch(n=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],n=0}finally{r=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}var f=Object.create?function(e,t,r,n){void 0===n&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function S(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||f(t,e,r)}function v(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function F(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,i=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)o.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return o}function y(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(F(arguments[t]));return e}function C(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),a=0;for(t=0;t<r;t++)for(var i=arguments[t],o=0,s=i.length;o<s;o++,a++)n[a]=i[o];return n}function A(e,t,r){if(r||2===arguments.length)for(var n,a=0,i=t.length;a<i;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))}function E(e){return this instanceof E?(this.v=e,this):new E(e)}function b(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,a=r.apply(e,t||[]),i=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(e){a[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||s(e,t)}))})}function s(e,t){try{(r=a[e](t)).value instanceof E?Promise.resolve(r.value.v).then(u,l):c(i[0][2],r)}catch(e){c(i[0][3],e)}var r}function u(e){s("next",e)}function l(e){s("throw",e)}function c(e,t){e(t),i.shift(),i.length&&s(i[0][0],i[0][1])}}function R(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,a){t[n]=e[n]?function(t){return(r=!r)?{value:E(e[n](t)),done:!1}:a?a(t):t}:a}}function T(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=v(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,a){!function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)}(n,a,(t=e[r](t)).done,t.value)}))}}}function k(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var N=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function I(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&f(t,e,r);return N(t,e),t}function O(e){return e&&e.__esModule?e:{default:e}}function _(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function P(e,t,r,n,a){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?a.call(e,r):a?a.value=r:t.set(e,r),r}function M(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},64924:function(e,t){"use strict";function r(e,t,r){let n=0,a=e.length;for(;n<a;){const i=Math.floor((n+a)/2);r(e[i],t)<0?n=i+1:a=i}return n}Object.defineProperty(t,"__esModule",{value:!0}),t.strict_binsearch=t.binsearch=void 0,t.binsearch=function(e,t,n=void 0){return void 0===n&&(n=(e,t)=>e===t?0:e<t?-1:1),r(e,t,n)},t.strict_binsearch=function(e,t,n=void 0){const a=r(e,t,n);return a===e.length||0!==n(e[a],t)?-1:a}},96854:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.numComparator=t.find_all_proposed_fixes=t.Colorize=t.tuple=void 0;const n=r(77601),a=r(37379),i=r(30848),o=r(47402),s=r(61902),u=r(77902),l=r(64924);function c(e,t){if("number"==typeof e)return e-t;for(let r=0;r<e.length;r+=1){const n=c(e[r],t[r]);if(0!==n)return n}return 0}function d(...e){return e}t.tuple=d;class g{static setReportingThreshold(e){g.reportingThreshold=e}static getReportingThreshold(){return g.reportingThreshold}static setFormattingDiscount(e){g.formattingDiscount=e}static getFormattingDiscount(){return g.formattingDiscount}static process_formulas(e,t,r){(0,u.watchdog)("wd0xea1170");const a=JSON.stringify(n.ExcelUtils.baseVector()),i=(e,t)=>[e[0]+t[0],e[1]+t[1],e[2]+t[2]],o=[];for(let s=0;s<e.length;s++){(0,u.watchdog)("wd0xa1597b");const l=e[s];for(let c=0;c<l.length;c++){(0,u.watchdog)("wd0x0d7fc8");const d=l[c].toString();if(d.length>0){const u=n.ExcelUtils.all_dependencies(s,c,r+s,t+c,e),l=c+t+1,m=s+r+1;if(0===u.length)"="===d[0]&&o.push([[l,m,0],g.distinguishedZeroHash]);else{const e=u.reduce(i);if(JSON.stringify(e)===a)o.push([[l,m,0],e.toString()]);else{const t=this.hash_vector(e).toString();o.push([[l,m,0],t])}}}}}return o}static color_all_data(e){const t=[];for(const r of Object.keys(e)){(0,u.watchdog)("wd0xc22046");const e=r.split(","),n=Number(e[0]),a=Number(e[1]);t.push([[n,a,0],g.distinguishedZeroHash])}return t}static process_values(e,t,r,n){const a=[];for(let i=0;i<e.length;i++){(0,u.watchdog)("wd0x503d57");const o=e[i];for(let e=0;e<o.length;e++){(0,u.watchdog)("wd0x366ad1");const s=o[e].toString();if(s.length>0&&"="!==t[i][e][0]&&Number(s).toString()===s){const t=e+r+1,o=i+n+1;a.push([[t,o,1],g.distinguishedZeroHash])}}}return a}static identify_ranges(e,t){const r={};for(const t of e)(0,u.watchdog)("wd0x770d8c"),r[t[1]]=r[t[1]]||[],r[t[1]].push(t[0]);for(const e of Object.keys(r))(0,u.watchdog)("wd0x84ae4d"),r[e].sort(t);return r}static group_ranges(e,t){const r={};let n=0,a=1;t||(n=1,a=0);for(const t of Object.keys(e)){(0,u.watchdog)("wd0xa372ae"),r[t]=[];let i=e[t].shift(),o=i;for(const s of e[t])s[n]===o[n]&&s[a]===o[a]+1||(r[t].push([i,o]),i=s),o=s;r[t].push([i,o])}return r}static identify_groups(e){const t=this.identify_ranges(e,((e,t)=>e[0]===t[0]?e[1]-t[1]:e[0]-t[0])),r=this.group_ranges(t,!0),n=o.JSONclone.clone(r);return this.merge_groups(n)}static processed_to_matrix(e,t,r,n,a){const i=new Array(e);for(let r=0;r<e;r++)i[r]=new Array(t).fill(0);for(const e of a){const[[t,a,o],s]=e,u=a-n-1,l=t-r-1;let c=Number(g.distinguishedZeroHash);1===o||(c=Number(s)),i[u][l]=c}return i}static stencilize(e){return s.Stencil.stencil_computation(e,((e,t)=>e*t),1)}static compute_stencil_probabilities(e,t,r){const n=new Array(e);for(let r=0;r<e;r++)n[r]=new Array(t).fill(0);let a=0;const i={};for(let n=0;n<e;n++)for(let e=0;e<t;e++)i[r[n][e]]=i[r[n][e]]+1||1,0!==r[n][e]&&(a+=1);for(let o=0;o<e;o++)for(let e=0;e<t;e++)n[o][e]=i[r[o][e]]/a;let o=0,s=0;for(let n=0;n<e;n++)for(let e=0;e<t;e++)r[n][e]>0&&(s+=i[r[n][e]]);for(let n=0;n<e;n++)for(let e=0;e<t;e++)i[r[n][e]]>0&&(o+=this.entropy(i[r[n][e]]/s));return Math.log2(a),n}static generate_suspicious_cells(e,t,r,n,a,i,o=.01){const s=[];let u=0,l=0;for(let c=0;c<e;c++)for(let e=0;e<t;e++){const t=e+r+1,d=c+n+1;i[c][e]>0&&(u+=a[c][e],l+=1,i[c][e]<=o&&0!==a[c][e]&&s.push([t,d,i[c][e]]))}const c=u/l;return s.sort(((e,t)=>Math.abs(t[2]-c)-Math.abs(e[2]-c))),s}static process_suspicious(e,t,r){(0,u.watchdog)("wd0x72fd38"),new i.Timer("process_suspicious");const[a,o]=n.ExcelUtils.extract_sheet_cell(e),s=n.ExcelUtils.cell_dependency(o,0,0);let l=[];t.length>this.formulasThreshold?console.warn("Too many formulas to perform formula analysis."):l=g.process_formulas(t,s[0]-1,s[1]-1);let c=[],m=[];const h=r.length,p=r[0].length;if(r.length>this.valuesThreshold)console.warn("Too many values to perform reference analysis.");else{const e=n.ExcelUtils.generate_all_references(t,s[0]-1,s[1]-1);c=g.color_all_data(e),m=g.process_values(r,t,s[0]-1,s[1]-1)}const f=g.identify_groups(c),S=g.identify_groups(l);let v=[];return r.length<1e4&&(v=g.find_suspicious_cells(h,p,s,t,l,m,1)),d(v,S,f,g.generate_proposed_fixes(S))}static entropy(e){return-e*Math.log2(e)}static entropydiff(e,t){const r=e+t;return-(this.entropy(e/r)+this.entropy(t/r))/Math.log2(r)}static fix_metric(e,t,r,n){const[i,o]=t,[s,u]=n,l=a.RectangleUtils.area([[i[0],i[1],0],[o[0],o[1],0]]),c=a.RectangleUtils.area([[s[0],s[1],0],[u[0],u[1],0]]),d=Math.min(l,c),g=Math.max(l,c),m=Math.min(r,e),h=Math.max(r,e);let p=Math.abs(h-m)/this.Multiplier;p<1&&(p=1);let f=(1+this.entropydiff(d,g))/(p*d);return f=-f,f}static count_proposed_fixes(e){let t=0;for(const r in e){const[n,i]=e[r][1],[o,s]=e[r][2];t+=a.RectangleUtils.diagonal([[n[0],n[1],0],[i[0],i[1],0]]),t+=a.RectangleUtils.diagonal([[o[0],o[1],0],[s[0],s[1],0]])}return t}static fix_proposed_fixes(e){const t={},r={};for(const n in e){if(e[n][1]>e[n][2]){const t=e[n][1];e[n][1]=e[n][2],e[n][2]=t}t[JSON.stringify(e[n][1])]=e[n],r[JSON.stringify(e[n][2])]=e[n]}const n=[],a={};for(const i in e){const o=e[i][0];if(-o<g.reportingThreshold/100)continue;const s=JSON.stringify(e[i][1]),u=JSON.stringify(e[i][2]);if(s in r||u in t){if(!a[s]&&s in r){const t=[-o*JSON.parse(r[s][0]),e[i][1],r[s][1]];n.push(t),a[s]=!0,a[u]=!0;continue}if(!a[u]&&u in t){const r=[-o*JSON.parse(t[u][0]),e[i][1],t[u][2]];n.push(r),a[u]=!0,a[s]=!0}}else n.push(e[i])}return n}static generate_proposed_fixes(e){const t=h(e);return t.sort(c),t}static merge_groups(e){for(const t of Object.keys(e)){(0,u.watchdog)("wd0x781a33");const r=e[t].slice();e[t]=this.merge_individual_groups(r)}return e}static merge_individual_groups(e){const t=new i.Timer("merge_individual_groups");let r=0;for(e=e.sort();;){(0,u.watchdog)("wd0x0a3668");let n=!1;const i={},o=[],s=e.slice();for(;s.length>0;){const e=s.shift();for(let t=0;t<s.length;t++)if((0,u.watchdog)("wd0x9cf1d5"),a.RectangleUtils.is_mergeable(e,s[t])){const r=JSON.stringify(e),u=JSON.stringify(s[t]);if(!(r in i)&&!(u in i)){o.push(a.RectangleUtils.bounding_box(e,s[t])),i[r]=!0,i[u]=!0,n=!0;break}}}for(let t=0;t<e.length;t++)(0,u.watchdog)("wd0x1bc2bb"),JSON.stringify(e[t])in i||o.push(e[t]);if(o.sort(),!n)return o;if(e=o.slice(),r++,r>2e3)return console.warn("Too many iterations; abandoning this group."),t.split("done, "+r+" iterations."),[[[-1,-1,0],[-1,-1,0]]]}}static hash_vector(e){{const t=0,r=0,n=Math.abs(e[0]-t),a=Math.abs(e[1]-r),i=e[2];return this.Multiplier*(n+a+i)}}static adjust_proposed_fixes(e,t,r,n){return e.map((e=>{const a=e[0];if(100*-a<1)return null;const i=e[1].map((e=>e.toString().padStart(10,"0"))),o=e[2].map((e=>e.toString().padStart(10,"0"))),s=i<o?e[1]:e[2],u=i<o?e[2]:e[1],[[l,c],[g,m]]=s,[[h,p],[f,S]]=u,v=l-r-1,F=c-n-1,y=f-r-1,C=S-n-1;let A=!0;const E=JSON.stringify(t[F][v]);for(let e=F;e<=C;e++)for(let r=v;r<=y;r++)if(JSON.stringify(t[e][r])!==E){A=!1;break}return d(a,s,u,A)})).filter((e=>null!==e))}static find_suspicious_cells(e,t,r,n,a,i,o){return(0,u.watchdog)("wd0x8cabd6"),[]}}function m(e,t){const[r,n]=e,[a,i]=t;return r[0]!==a[0]?r[0]-a[0]:r[1]-a[1]}function h(e){let t=[];const r={};!function(e,t){for(const r of Object.keys(e))(0,u.watchdog)("wd0xa287cd"),t[r]=e[r].sort(m).map(((e,t,r)=>[e[0].map(((e,t,r)=>Number(e))),e[1].map(((e,t,r)=>Number(e)))]))}(e,r);const n={},a={};for(const t of Object.keys(e))(0,u.watchdog)("wd0xb02b87"),n[t]=r[t].map(((e,t,r)=>{const[n,a]=e;return n})),a[t]=r[t].map(((e,t,r)=>{const[n,a]=e;return a}));const i=function(e){const t={};for(const r of Object.keys(e)){let n=1e6,a=1e6,i=-1e6,o=-1e6;for(let t=0;t<e[r].length;t++){const s=e[r][t][0][0],u=e[r][t][1][0],l=e[r][t][0][1],c=e[r][t][1][1];u>i&&(i=u),s<n&&(n=s),c>o&&(o=c),l<a&&(a=l)}t[r]=[[n,a,0],[i,o,0]]}return t}(e),o=Object.keys(e);p(o,((e,t)=>i[e][0][0]-i[t][0][0]));const s=o.map(((e,t,r)=>i[e])),l=Object.keys(e);p(l,((e,t)=>i[e][0][1]-i[t][0][1]));const c=l.map(((e,t,r)=>i[e]));for(const d of Object.keys(e))for(let e=0;e<r[d].length;e++){(0,u.watchdog)("wd0xe37031");const g=v(d,r[d][e],0,o,l,n,a,i,s,c);t=t.concat(g)}return t=t.map(((e,t,r)=>f(e[1],e[2])<0?[e[0],e[2],e[1]]:[e[0],e[1],e[2]])),t=function(e){const t={};return e.filter((e=>!(t[e]=e in t)))}(t),t}function p(e,t){const r=e.map(((e,t)=>({item:e,index:t}))).sort(((e,r)=>t(e.item,r.item)||e.index-r.index)).map((({item:e})=>e));for(let t=0;t<e.length;t+=1)e[t]=r[t];return e}function f(e,t){for(let r=0;r<3;r++){if(e[r]<t[r])return-1;if(e[r]>t[r])return 1}return 0}function S(e,t,r,n){const a=e[0],i=e[1],o=t[0],s=t[1],u=[a-1,s,0],c=[o,i-1,0],d=[o+1,i,0],g=[a,s+1,0],m=[];let h=-1;if(h=(0,l.strict_binsearch)(n,u,f),-1!==h&&r[h][1]===i){const e=[r[h],n[h]];m.push(e)}if(h=(0,l.strict_binsearch)(n,c,f),-1!==h&&r[h][0]===a){const e=[r[h],n[h]];m.push(e)}if(h=(0,l.strict_binsearch)(r,d,f),-1!==h&&n[h][1]===s){const e=[r[h],n[h]];m.push(e)}if(h=(0,l.strict_binsearch)(r,g,f),-1!==h&&n[h][0]===o){const e=[r[h],n[h]];m.push(e)}return m}function v(e,t,r,n,a,i,o,s,u,c){const[d,m]=t;let h=[];const p=(0,l.binsearch)(u,t,((e,t)=>e[0][0]-t[0][0])),f=(0,l.binsearch)(c,t,((e,t)=>e[0][1]-t[0][1]));let v,F,y;p>f?(v=n,y=p,F=0):(v=a,y=f,F=1),y>0&&(y-=1);for(let r=y;r<v.length;r++){const n=v[r];if(n===e)continue;const a=s[n];if(0===F){if(m[0]+1<a[0][0])break}else if(m[1]+1<a[0][1])break;if(m[0]+1<a[0][0]||m[1]+1<a[0][1]||a[1][0]+1<d[0]||a[1][1]+1<d[1]);else{const r=S(d,m,i[n],o[n]);r.length>0&&(h=h.concat(r.map(((r,a,i)=>[g.fix_metric(parseFloat(e),t,parseFloat(n),r),t,r]))))}}return h}t.Colorize=g,g.reportingThreshold=35,g.suspiciousCellsReportingThreshold=85,g.formattingDiscount=50,g.formulasThreshold=1e4,g.valuesThreshold=1e4,g.Multiplier=1,g.distinguishedZeroHash="12345",t.find_all_proposed_fixes=h,t.numComparator=f},46954:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.detect_errors=void 0;const n=r(77601),a=r(96854),i=r(30848),o=r(77902);function s(e,t){const[r,n]=e,[a,i]=t,o=[];for(let e=r;e<=a;e++)for(let t=n;t<=i;t++)o.push([e,t,0]);return o}t.detect_errors=function(e,t,r,u=1/0){t=t??a.Colorize.getFormattingDiscount(),r=r??a.Colorize.getReportingThreshold(),o.watchdog.arm(u);const l=e.worksheets.map((function(e){if((0,o.watchdog)("wd0x8d98cc"),0===e.formulas.length&&0===e.values.length)return{name:"",out:null};let u=e.usedRangeAddress;u=u.replace(/!(!+)/,"!");const l=new i.Timer("excelint"),[c,d,g,m]=a.Colorize.process_suspicious(u,e.formulas,e.values);(0,o.watchdog)("wd0x7919b4");const h=l.elapsedTime(),p=a.Colorize.adjust_proposed_fixes(m,e.styles,0,0),f=l.elapsedTime(),S=p.map((e=>{(0,o.watchdog)("wd0xfb8f16");const[n,i,s,u]=e;let l=-n;return u||(l*=(100-t)/100),100*l>=r?(0,a.tuple)(l,i,s,u):null})).filter((e=>null!==e)),v=(e,t)=>(t[0]-e[0]+1)*(t[1]-e[1]+1)*(t[2]-e[2]+1),F=l.elapsedTime(),y=S.map((t=>{(0,o.watchdog)("wd0x2375dd");const r=t[1][0][0]===t[2][0][0]?"vertical":"horizontal",a=[],i=[],s=[],u=[],l=[],c=[],d=[],g=[],m=[],h=t[3],p=[v(...t[1]),v(...t[2])];for(let r=0;r<2;r++){const o=t[r+1][0],h=o[1]-1,p=o[0]-1,f=e.formulas[h][p],S=n.ExcelUtils.numeric_constants(f);l.push(S),c.push(c.reduce(((e,t)=>e+t),0));const v=n.ExcelUtils.all_cell_dependencies(f,p+1,h+1,!1);d.push(v.length);const F=n.ExcelUtils.formulaToR1C1(f,p+1,h+1),y=n.ExcelUtils.column_index_to_name(p+1)+(h+1)+":",C=y+F;s.push(F),u.push(C),a.push(f),i.push(y+f),g.push((f.match(/\$/g)||[]).length),m.push(v)}const f=Math.abs(c[0]-c[1]),S=[];for(let e=0;e<m.length;e++)if(m[e].length>0){if("vertical"===r&&0===m[e][0][0]&&-1===m[e][0][1]){S.push("recurrent-formula");break}if("horizontal"===r&&-1===m[e][0][0]&&0===m[e][0][1]){S.push("recurrent-formula");break}}d[0]!==d[1]&&S.push("different-referent-count"),l[0].length!==l[1].length&&(1===Math.abs(l[0].length-l[1].length)?S.push("one-extra-constant"):S.push("number-of-constants-mismatch")),l[0].length>0&&l[1].length>0&&(d[0]+d[1]===0?S.push("both-constants"):d[0]*d[1]==0&&S.push("one-is-all-constants")),s[0]!==s[1]&&JSON.stringify(m[0].sort())!==JSON.stringify(m[1].sort())&&S.push("r1c1-mismatch"),g[0]!==g[1]&&S.push("absolute-ref-mismatch");for(let e=0;e<m.length;e++)if(m[e].length>0&&m[e][0][0]*m[e][0][1]!=0){S.push("off-axis-reference");break}return 0===S.length&&S.push("unclassified"),{bin:S,direction:r,sameFormat:h,rangeSizes:p,numbers:c,sameConstants:l[0]===l[1],numeric_difference:f,magnitude_numeric_difference:0===f?0:Math.log10(f),formulas:i,r1c1formulas:u,dependence_vectors:m}})),C=l.elapsedTime(),A=e.formulas.flat().filter((e=>e.length>0)).length,E=e.values.flat().filter((e=>e.length>0)).length,b=e.values[0].length,R=e.values.length,T=R*b,k=S.map((e=>e[0])).reduce(((e,t)=>e+t),0);let N=S.map((e=>((0,o.watchdog)("wd0xbcc23c"),e[0]>=r/100?s(e[1][0],e[1][1]).concat(s(e[2][0],e[2][1])):[])));const I=Array.from(new Set(N.flat(1).map((e=>JSON.stringify(e)))));N=I.map((e=>JSON.parse(e)));const O=l.elapsedTime(),_={suspiciousnessThreshold:r,formattingDiscount:t,proposedFixes:S,exampleFixes:y,suspiciousRanges:S.length,weightedSuspiciousRanges:k,suspiciousCells:N.length,elapsedTimeSeconds:O/1e3,proposedFixesTimeSeconds:h/1e3,adjustProposedFixesTimeSeconds:(f-h)/1e3,adjustFormatProposedFixesTimeSeconds:(F-f)/1e3,exampleFixesTimeSeconds:(C-F)/1e3,numCountingTimeSeconds:(O-C)/1e3,columns:b,rows:R,totalCells:T,numFormulaCells:A,numValueCells:E};return{name:e.sheetName,out:_}})).filter((e=>null!==e.out)),c={};for(const{name:e,out:t}of l)c[e]=t;return{workbookName:e.workbookName,worksheets:c}}},77601:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExcelUtils=void 0;const n=r(77902);class a{static column_name_to_index(e){if(1===e.length)return e[0].charCodeAt(0)-"A".charCodeAt(0)+1;let t=0;const r=e.split("");for(const e of r)t*=26,t+=e.charCodeAt(0)-"A".charCodeAt(0)+1;return t}static column_index_to_name(e){let t="";for(;e>0;)t+=String.fromCharCode((e-1)%26+65),e=Math.floor((e-1)/26);return t.split("").reverse().join("")}static cell_dependency(e,t,r){(0,n.watchdog)("wd0x1a9bd3");{const t=a.cell_both_absolute.exec(e);if(t){const e=a.column_name_to_index(t[1]);let r=Number(t[2]);return t[2][0]>=" "&&(r=Number(t[2].charCodeAt(0)-16384)),[e,r,0]}}(0,n.watchdog)("wd0xa26bda");{const t=a.cell_col_absolute.exec(e);if(t){const e=a.column_name_to_index(t[1]);let n=Number(t[2]);return t[2][0]>=" "&&(n=Number(t[2].charCodeAt(0)-16384)),[e,n-r,0]}}(0,n.watchdog)("wd0x2a23e1");{const r=a.cell_row_absolute.exec(e);if(r){const e=a.column_name_to_index(r[1]);let n=Number(r[2]);return r[2][0]>=" "&&(n=Number(r[2].charCodeAt(0)-16384)),[e-t,n,0]}}(0,n.watchdog)("wd0x3ebc91");{const n=a.cell_both_relative.exec(e);if(n){const e=a.column_name_to_index(n[1]);let i=Number(n[2]);return n[2][0]>=" "&&(i=Number(n[2].charCodeAt(0)-16384)),[e-t,i-r,0]}}throw new Error("We should never get here.")}static toR1C1(e,t,r=!1){const n=a.cell_dependency(e,0,0),i=a.cell_dependency(t,0,0);let o="R",s="C";r&&(o="ρ",s="γ");const u=[];i.forEach(((e,t,r)=>{u.push(e-n[t])}));let l="";return a.cell_both_absolute.exec(t)?l=o+i[1]+s+i[0]:a.cell_col_absolute.exec(t)?(0===u[1]?l+=o:l+=o+"["+u[1]+"]",l+=s+i[0]):a.cell_row_absolute.exec(t)?(0===u[0]?l+=s:l+=s+"["+u[0]+"]",l=o+i[1]+l):(0===u[1]?l+=o:l+=o+"["+u[1]+"]",0===u[0]?l+=s:l+=s+"["+u[0]+"]"),l}static formulaToR1C1(e,t,r){let n=e.slice();const i=a.column_index_to_name(t)+r;let o;for(;o=a.range_pair.exec(n);)o&&(o[1],o[2],n=n.replace(o[0],a.toR1C1(i,o[1],!0)+":"+a.toR1C1(i,o[2],!0)));let s=null;for(;s=a.single_dep.exec(n);)if(s){const e=s[1];n=n.replace(s[0],a.toR1C1(i,e,!0))}return n=n.replace(/ρ/g,"R"),n=n.replace(/γ/g,"C"),n}static extract_sheet_cell(e){(0,n.watchdog)("wd0x012630");const t=a.sheet_plus_cell.exec(e);return t?[t[1],t[2],t[2]]:["","",""]}static all_cell_dependencies(e,t,r,i=!0){(0,n.watchdog)("wd0x2f82fe");let o=null;const s=[];if("string"!=typeof e)return null;for(e=(e=(e=(e=(e=(e=(e=e.replace(this.formulas_with_numbers,"_")).replace(this.formulas_with_quoted_sheetnames_2,"_")).replace(this.formulas_with_quoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_2,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_structured_references,"_");o=a.range_pair.exec(e);)if((0,n.watchdog)("wd0x784918"),o){const n=o[1],i=a.cell_dependency(n,t,r),u=o[2],l=a.cell_dependency(u,t,r),c=l[0]-i[0]+1,d=l[1]-i[1]+1;for(let e=0;e<c;e++)for(let t=0;t<d;t++)s.push([e+i[0],t+i[1],0]);e=e.replace(o[0],"_")}let u=null;for(;u=a.single_dep.exec(e);)if((0,n.watchdog)("wd0x0fb232"),u){const n=u[1],i=a.cell_dependency(n,t,r);s.push(i),e=e.replace(u[0],"_")}if(i){let t=null;for(;t=a.number_dep.exec(e);)(0,n.watchdog)("wd0xd82ed1"),t&&(s.push([0,0,1]),e=e.replace(t[0],"_"))}return s}static numeric_constants(e){const t=[];if("string"!=typeof(e=e.slice()))return t;e=(e=(e=(e=(e=(e=(e=e.replace(this.formulas_with_numbers,"_")).replace(this.formulas_with_quoted_sheetnames_2,"_")).replace(this.formulas_with_quoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_2,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_structured_references,"_");let r=null;for(;r=a.range_pair.exec(e);)r&&(e=e.replace(r[0],"_"));let n=null;for(;n=a.single_dep.exec(e);)n&&(e=e.replace(n[0],"_"));let i=null;for(;i=a.number_dep.exec(e);)i&&(t.push(parseFloat(i)),e=e.replace(i[0],"_"));return t}static baseVector(){return[0,0,0]}static all_dependencies(e,t,r,i,o){(0,n.watchdog)("wd0x961028");let s=[];if(e>=o.length||t>=o[0].length||e<0||t<0)return[];const u=o[e][t];return u.length>1&&"="===u[0]&&(s=a.all_cell_dependencies(u,i,r)),s}static generate_all_references(e,t,r){(0,n.watchdog)("wd0x6a6002");const i={};for(let o=0;o<e.length;o++){const s=e[o];for(let o=0;o<s.length;o++){(0,n.watchdog)("wd0x93d412");const u=s[o];if("="===u[0]){const o=a.all_cell_dependencies(u,0,0);for(const a of o)if((0,n.watchdog)("wd0x8a466e"),0===a[0]&&0===a[1]&&0!==a[2]);else{const n=a[0]-t-1,o=a[1]-r-1;{let t=!1;if(o>=e.length||n>=e[0].length||n<0||o<0)t=!0;else{const r=e[o][n];void 0!==r&&"="!==r[0]&&(t=!0)}t&&(i[a.join(",")]=!0)}}}}}return i}}t.ExcelUtils=a,a.general_re="\\$?[A-Z][A-Z]?\\$?[\\d\\u2000-\\u6000]+",a.sheet_re="[^\\!]+",a.sheet_plus_cell=new RegExp("("+a.sheet_re+")\\!("+a.general_re+")"),a.sheet_plus_range=new RegExp("("+a.sheet_re+")\\!("+a.general_re+"):("+a.general_re+")"),a.single_dep=new RegExp("("+a.general_re+")"),a.range_pair=new RegExp("("+a.general_re+"):("+a.general_re+")","g"),a.number_dep=new RegExp("([0-9]+\\.?[0-9]*)"),a.cell_both_relative=new RegExp("[^\\$A-Z]?([A-Z][A-Z]?)([\\d\\u2000-\\u6000]+)"),a.cell_col_absolute=new RegExp("\\$([A-Z][A-Z]?)([\\d\\u2000-\\u6000]+)"),a.cell_row_absolute=new RegExp("[^\\$A-Z]?([A-Z][A-Z]?)\\$([\\d\\u2000-\\u6000]+)"),a.cell_both_absolute=new RegExp("\\$([A-Z][A-Z]?)\\$([\\d\\u2000-\\u6000]+)"),a.formulas_with_numbers=new RegExp("/ATAN2|BIN2DEC|BIN2HEX|BIN2OCT|DAYS360|DEC2BIN|DEC2HEX|DEC2OCT|HEX2BIN|HEX2DEC|HEX2OCT|IMLOG2|IMLOG10|LOG10|OCT2BIN|OCT2DEC|OCT2HEX|SUNX2MY2|SUMX2PY2|SUMXMY2|T.DIST.2T|T.INV.2T/","g"),a.formulas_with_quoted_sheetnames_1=new RegExp("'[^']*'!\\$?[A-Z][A-Z]?\\$?\\d+","g"),a.formulas_with_quoted_sheetnames_2=new RegExp("'[^']*'!\\$?[A-Z][A-Z]?\\$?\\d+:\\$?[A-Z][A-Z]?\\$?\\d+","g"),a.formulas_with_unquoted_sheetnames_1=new RegExp("[A-Za-z0-9]+!\\$?[A-Z][A-Z]?\\$?\\d+","g"),a.formulas_with_unquoted_sheetnames_2=new RegExp("[A-Za-z0-9]+!\\$?[A-Z][A-Z]?\\$?\\d+:\\$?[A-Z][A-Z]?\\$?\\d+","g"),a.formulas_with_structured_references=new RegExp("\\[([^\\]])*\\]","g"),a.originalSheetSuffix="_EL"},21625:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.detect_errors=void 0;var n=r(46954);Object.defineProperty(t,"detect_errors",{enumerable:!0,get:function(){return n.detect_errors}})},61902:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Stencil=t.InfoGain=void 0,t.InfoGain=class{static normalized_entropy(e){const t=e.reduce(((e,t)=>e+t),0);let r=0;for(let n=0;n<e.length;n++){const a=e[n]/t;0!==a&&(r-=a*Math.log2(a))}return r/Math.log2(t)}};class r{static initialize(){if(!r.initialized){if(r.stencil_right=r.stencil.filter((([e,t])=>e<=0)),r.stencil_left=r.stencil.filter((([e,t])=>e>=0)),r.stencil_top=r.stencil.filter((([e,t])=>t>=0)),r.stencil_bottom=r.stencil.filter((([e,t])=>t<=0)),r.stencil_topleft=r.stencil_top.filter((([e,t])=>e>=0)),r.stencil_topright=r.stencil_top.filter((([e,t])=>e<=0)),r.stencil_bottomleft=r.stencil_bottom.filter((([e,t])=>e>=0)),r.stencil_bottomright=r.stencil_bottom.filter((([e,t])=>e<=0)),r.reflectStencils){let e;e=r.stencil.filter((([e,t])=>e>0)).map((([e,t])=>[-e,t])),r.stencil_right=r.stencil_right.concat(e),e=r.stencil.filter((([e,t])=>e<0)).map((([e,t])=>[-e,t])),r.stencil_left=r.stencil_left.concat(e),e=r.stencil.filter((([e,t])=>t<0)).map((([e,t])=>[e,-t])),r.stencil_top=r.stencil_top.concat(e),e=r.stencil.filter((([e,t])=>t>0)).map((([e,t])=>[e,-t])),r.stencil_bottom=r.stencil_bottom.concat(e),e=r.stencil_top.filter((([e,t])=>e<0)).map((([e,t])=>[-e,t])),r.stencil_topleft=r.stencil_topleft.concat(e),e=r.stencil_left.filter((([e,t])=>t<0)).map((([e,t])=>[e,-t])),r.stencil_topleft=r.stencil_topleft.concat(e),r.stencil_topleft.splice(r.stencil_topleft.findIndex((e=>JSON.stringify(e)===JSON.stringify([1,1]))),1),e=r.stencil_top.filter((([e,t])=>e>0)).map((([e,t])=>[-e,t])),r.stencil_topright=r.stencil_topright.concat(e),e=r.stencil_right.filter((([e,t])=>t<0)).map((([e,t])=>[e,-t])),r.stencil_topright=r.stencil_topright.concat(e),r.stencil_topright.splice(r.stencil_topright.findIndex((e=>JSON.stringify(e)===JSON.stringify([-1,1]))),1),e=r.stencil_bottom.map((([e,t])=>[-e,t])).filter((([e,t])=>e>0)),r.stencil_bottomleft=r.stencil_bottomleft.concat(e),e=r.stencil_left.map((([e,t])=>[e,-t])).filter((([e,t])=>t<0)),r.stencil_bottomleft=r.stencil_bottomleft.concat(e),r.stencil_bottomleft.splice(r.stencil_bottomleft.findIndex((e=>JSON.stringify(e)===JSON.stringify([1,-1]))),1),e=r.stencil_bottom.map((([e,t])=>[-e,t])).filter((([e,t])=>e<0)),r.stencil_bottomright=r.stencil_bottomright.concat(e),e=r.stencil_right.map((([e,t])=>[e,-t])).filter((([e,t])=>t<0)),r.stencil_bottomright=r.stencil_bottomright.concat(e),r.stencil_bottomright.splice(r.stencil_bottomright.findIndex((e=>JSON.stringify(e)===JSON.stringify([-1,-1]))),1)}r.initialized=!0}}static apply_stencil(e,t,n,a,i,o){if(e.length!==r.stencil.length)throw Error("Length mismatched");let s=i;for(let r=0;r<e.length;r++){const[i,u]=e[r];s=o(s,t[n+u][a+i])}return s}static stencil_computation(e,t,n){r.initialize();const a=e.length,i=e[0].length,o=Array(a).fill(0).map((()=>Array(i).fill(0)));for(let s=1;s<i-1;s++)for(let i=1;i<a-1;i++)o[i][s]=r.apply_stencil(r.stencil,e,s,i,n,t);for(let s=1;s<i-1;s++)o[0][s]=r.apply_stencil(r.stencil_top,e,0,s,n,t),o[a-1][s]=r.apply_stencil(r.stencil_bottom,e,a-1,s,n,t);for(let s=1;s<a-1;s++)o[s][0]=r.apply_stencil(r.stencil_left,e,s,0,n,t),o[s][i-1]=r.apply_stencil(r.stencil_right,e,s,i-1,n,t);return o[0][0]=r.apply_stencil(r.stencil_topleft,e,0,0,n,t),o[0][i-1]=r.apply_stencil(r.stencil_topright,e,0,i-1,n,t),o[a-1][0]=r.apply_stencil(r.stencil_bottomleft,e,a-1,0,n,t),o[a-1][i-1]=r.apply_stencil(r.stencil_bottomright,e,a-1,i-1,n,t),o}}t.Stencil=r,r.reflectStencils=!0,r.ninePointStencil=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,0],[0,1],[1,-1],[1,0],[1,1]],r.stencil=r.ninePointStencil,r.initialized=!1},47402:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JSONclone=void 0;class r{static clone(e){if(e){if(Array.isArray(e))return e.slice();if(e.constructor===Object){const t={};for(const n of Object.keys(e))t[n]=r.clone(e[n]);return t}return e}return null}}t.JSONclone=r},37379:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RectangleUtils=void 0;class r{static is_adjacent(e,t){const[[r,n,a],[i,o,s]]=e,[[u,l,c],[d,g,m]]=t;return!(r-d>1||u-i>1||n-g>1||l-o>1)}static bounding_box(e,t){const[[r,n,a],[i,o,s]]=e,[[u,l,c],[d,g,m]]=t;return[[Math.min(r,u),Math.min(n,l),0],[Math.max(i,d),Math.max(o,g),0]]}static area(e){const[[t,r,n],[a,i,o]]=e;return(a-t+1)*(i-r+1)}static diagonal(e){const[[t,r,n],[a,i,o]]=e,s=a-t+1,u=i-r+1;return Math.sqrt(s*s+u*u)}static overlap(e,t){const[[r,n,a],[i,o,s]]=e,[[u,l,c],[d,g,m]]=t;let h=0,p=0;return h=i>d?d-r+1:i-u+1,p=o>g?g-n+1:o-l+1,h*p}static is_mergeable(e,t){return r.is_adjacent(e,t)&&r.area(e)+r.area(t)-r.overlap(e,t)===r.area(r.bounding_box(e,t))}}t.RectangleUtils=r},30848:function(e,t){"use strict";function r(){return"undefined"!=typeof process?{now:()=>{const[e,t]=process.hrtime();return(1e9*e+t)/1e6}}:"undefined"!=typeof performance?performance:Date}Object.defineProperty(t,"__esModule",{value:!0}),t.Timer=t.createPerf=void 0,t.createPerf=r,t.Timer=class{start(){this.startTimeMS=this.perf.now(),this.splitTimeMS=this.startTimeMS}split(e){const t=this.perf.now(),r=t-this.splitTimeMS;console.warn("timer: "+this.name+" @ "+e+" : = "+this.roundMe(r)+" (total = "+this.roundMe(t-this.startTimeMS)+")"),this.splitTimeMS=t}elapsedTime(){return this.perf.now()-this.startTimeMS}roundMe(e){return Math.round(100*e)/100}constructor(e){this.perf=r(),this.name=e,this.start()}}},77902:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.watchdog=void 0;const n=(0,r(30848).createPerf)();t.watchdog=function(){let e=1/0;const t=(t="")=>{if(n.now()>e)throw new Error(`Time limit exceeded with message: ${t}`)};return t.arm=t=>{e=n.now()+t},t}()},57848:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LimitedSizeHotMap=void 0;class r extends Map{set(e,t){if(!this.query(e)&&this.size>=this.maxSize){const e=this.keys().next().value;this.delete(e)}return super.set(e,t)}query(e){if(this.has(e)){const t=this.get(e);return this.delete(e),this.set(e,t),!0}return!1}constructor(e){if(super(),this.maxSize=e,e<1)throw new Error("maxSize must be greater than 0")}}t.LimitedSizeHotMap=r},25626:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.anonymizeFormulaString=t.anonymizeMagnitude=t.kindAnonymizers=t.anonymize=void 0;const n=r(97736);function a(e){return e}function i(e,r){if("string"==typeof r&&null!=o[r])return e;const n=function(e){if("object"==typeof e&&null!==e){const t=e.kind;if("string"==typeof t)return t}}(e);let a=void 0!==n?t.kindAnonymizers[n]:void 0;return void 0===a&&(a=s[function(e){const t=typeof e;if("object"===t){if(null===e)return"null";if(Array.isArray(e))return"Array"}return t}(e)]),void 0!==a?a(e,r):"<unexpected>"}t.anonymize=function(e){try{return String(JSON.stringify(i(e,void 0)))}catch(e){if(null==e||"object"!=typeof e)return`<error: ${String(JSON.stringify(e))}>`;const t=String(e.name),r=String(e.message);return r.indexOf(t)>=0?`<error ${r}>`:`<error ${t}: ${r}>`}};const o={kind:!0,type:!0,index:!0,length:!0,row:!0,col:!0,rows:!0,cols:!0},s={boolean:a,symbol:function(e){return"symbol"!=typeof e?"<unexpected>":`<symbol ${String(e)}>`},undefined:a,null:a,number:function(e){return"number"!=typeof e?"<unexpected>":isFinite(e)?"<number>":e},bigint:function(e){return"bigint"!=typeof e?"<unexpected>":"<bigint>"},string:function(e){return"string"!=typeof e?"<unexpected>":e.length>0?"<string>":e},function:function(e){if("function"!=typeof e)return"<unexpected>";const t=e.name;return"string"==typeof t&&t.length>0?`<function ${t}>`:"<function>"},object:function(e){if("object"!=typeof e)return"<unexpected>";const t={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=i(e[r],r));return t},Array:function(e){return"object"==typeof e&&Array.isArray(e)?e.map(i):"<unexpected>"}};t.kindAnonymizers=Object.create(null),t.anonymizeMagnitude=function(e){const t=Math.abs(e);return 0===t?-1e4:Math.floor((0,n.mathLog2)(t))};const u=new RegExp("[^=\\[\\]\\.\\\\\\/%@#\\-_\\+,;\\(\\):?\"&<>'!\\{\\}~\\^\\*$¢£¤¥₠₡₢₣₤₥₦₧₨₩₪₫€₭₮₯₰₱₲₳₴₵₶₷₸₹\\sꃂd]","g"),l=/[0-9]/g,c=/d/g;t.anonymizeFormulaString=function(e){return e.toLowerCase().replace(c,"w").replace(l,"d").replace(u,"w")}},53964:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.broadcastArray2D=t.broadcastArray=t.sparseArray2DTo1D=t.transposeSparseArray2D=t.transposeArray2D=t.colArray2D=t.rowArray2D=t.singletonArray2D=t.constantArray2D=t.constantArray=t.array2DToJaggedArray=t.jaggedArray=t.array2DForall2=t.array2DForall=t.NonstrictSparseArray2D=t.NonstrictArray2D=t.StrictSparseArray2D=t.StrictArray2D=void 0;const n=r(40511),a=r(17869);class i{get(e,t){return(0,n.assertIndex)("calc.common.StrictArray2D.get",e,this.rows),(0,n.assertIndex)("calc.common.StrictArray2D.get",t,this.cols),this.elements[e][t]}strict(){return this}map(e){return new s(this.rows,this.cols,((t,r)=>e(this.elements[t][r])))}constructor(e,t,r){(0,n.assertNatural)("calc.common.StrictArray2D",e),(0,n.assertNatural)("calc.common.StrictArray2D",t);const a=r.length;a<e&&(0,n.assertFalse)(`calc.common.StrictArray2D: expected elements.length >= ${e}; given ${a}`);for(let i=0;i<a;i+=1){const a=r[i].length;a<t&&(0,n.assertFalse)(`calc.common.StrictArray2D: expected elements[${i}].length >= ${e}; given ${a}`)}this.rows=e,this.cols=t,this.elements=r}}t.StrictArray2D=i;class o{get(e,t){return(0,n.assertIndex)("calc.common.StrictSparseArray2D.get",e,this.rows),(0,n.assertIndex)("calc.common.StrictSparseArray2D.get",t,this.cols),e<this.denseRows&&t<this.denseCols?this.denseElements[e][t]:this.sparseElement}getSparse(){return this.sparseElement}strict(){return this}map(e){return new u(this.rows,this.cols,this.denseRows,this.denseCols,((t,r)=>e(this.denseElements[t][r])),(()=>e(this.sparseElement)))}constructor(e,t,r,a,i,o){(0,n.assertNatural)("calc.common.StrictSparseArray2D",e),(0,n.assertNatural)("calc.common.StrictSparseArray2D",t),(0,n.assertIndex)("calc.common.StrictSparseArray2D",r,e+1),(0,n.assertIndex)("calc.common.StrictSparseArray2D",a,t+1);const s=i.length;s<r&&(0,n.assertFalse)(`calc.common.StrictSparseArray2D: expected elements.length >= ${r}; given ${s}`);for(let e=0;e<s;e+=1){const t=i[e].length;t<a&&(0,n.assertFalse)(`calc.common.StrictSparseArray2D: expected elements[${e}].length >= ${a}; given ${t}`)}this.rows=e,this.cols=t,this.denseRows=r,this.denseCols=a,this.denseElements=i,this.sparseElement=o}}t.StrictSparseArray2D=o;class s{get(e,t){return(0,n.assertIndex)("calc.common.NonstrictArray2D.get",e,this.rows),(0,n.assertIndex)("calc.common.NonstrictArray2D.get",t,this.cols),this.func(e,t)}strict(){const e=l(this.rows,this.cols,this.func);return new i(this.rows,this.cols,e)}map(e){return new s(this.rows,this.cols,((t,r)=>e(this.func(t,r))))}constructor(e,t,r){(0,n.assertNatural)("calc.common.NonstrictArray2D",e),(0,n.assertNatural)("calc.common.NonstrictArray2D",t),this.rows=e,this.cols=t,this.func=r}}t.NonstrictArray2D=s;class u{get(e,t){return(0,n.assertIndex)("calc.common.NonstrictSparseArray2D.get",e,this.rows),(0,n.assertIndex)("calc.common.NonstrictSparseArray2D.get",t,this.cols),e<this.denseRows&&t<this.denseCols?this.denseFunc(e,t):this.sparseFunc()}getSparse(){return this.sparseFunc()}strict(){const e=l(this.denseRows,this.denseCols,this.denseFunc),t=this.sparseFunc();return new o(this.rows,this.cols,this.denseRows,this.denseCols,e,t)}map(e){return new u(this.rows,this.cols,this.denseRows,this.denseCols,((t,r)=>e(this.denseFunc(t,r))),(()=>e(this.sparseFunc())))}constructor(e,t,r,a,i,o){(0,n.assertNatural)("calc.common.NonstrictSparseArray2D",e),(0,n.assertNatural)("calc.common.NonstrictSparseArray2D",t),(0,n.assertIndex)("calc.common.NonstrictSparseArray2D",r,e+1),(0,n.assertIndex)("calc.common.NonstrictSparseArray2D",a,t+1),this.rows=e,this.cols=t,this.denseRows=r,this.denseCols=a,this.denseFunc=i,this.sparseFunc=o}}function l(e,t,r){const n=[];for(let a=0;a<e;a+=1){const e=[];for(let n=0;n<t;n+=1)e[n]=r(a,n);n[a]=e}return n}function c(e,t,r){const n=[],a=[];for(let e=0;e<t;e+=1)a[e]=r;for(let t=0;t<e;t+=1)n[t]=a;return n}function d(e,t,r){return new s(e,t,((e,t)=>r))}t.NonstrictSparseArray2D=u,t.array2DForall=function(e,t){for(let r=0;r<t.rows;r+=1)for(let n=0;n<t.cols;n+=1)if(!e(t.get(r,n)))return!1;return!0},t.array2DForall2=function(e,t,r){const n=(0,a.fastMin)(t.rows,r.rows),i=(0,a.fastMin)(t.cols,r.cols);for(let a=0;a<n;a+=1)for(let n=0;n<i;n+=1)if(!e(t.get(a,n),r.get(a,n)))return!1;return!0},t.jaggedArray=l,t.array2DToJaggedArray=function(e){return l(e.rows,e.cols,e.get.bind(e))},t.constantArray=c,t.constantArray2D=d,t.singletonArray2D=function(e){return d(1,1,e)},t.rowArray2D=function(e){return new s(1,e.length,((t,r)=>e[r]))},t.colArray2D=function(e){return new s(e.length,1,((t,r)=>e[t]))},t.transposeArray2D=function(e){return new s(e.cols,e.rows,((t,r)=>e.get(r,t)))},t.transposeSparseArray2D=function(e){return new u(e.cols,e.rows,e.denseCols,e.denseRows,((t,r)=>e.get(r,t)),(()=>e.getSparse()))},t.sparseArray2DTo1D=function(e,t){const r=e.getSparse.bind(e);return(0,n.assertTrue)("calc.common.sparseArray2DTo1D",t?0===e.cols||e.rows>0:0===e.rows||e.cols>0),t?{length:e.cols,denseLength:e.denseCols,get:t=>e.get(0,t),getSparse:r}:{length:e.rows,denseLength:e.denseRows,get:t=>e.get(t,0),getSparse:r}},t.broadcastArray=function(e,t,r,n,a,i){if(e===r&&t===n)return a;if(1===e&&1===t)return c(r,n,void 0===a[0]?i:a[0][0]);const o=[];let s;s=1===e?(e,r)=>r<t?a[0][r]:i:1===t?(t,r)=>t<e?a[t][0]:i:(r,n)=>r<e&&n<t?a[r][n]:i;for(let e=0;e<r;e+=1){o.push([]);for(let t=0;t<n;t+=1)o[e][t]=s(e,t)}return o},t.broadcastArray2D=function(e,t,r,n){return r.rows===e&&r.cols===t?r:1===r.rows&&1===r.cols?d(e,t,r.get(0,0)):1===r.rows?new s(e,t,((e,t)=>t<r.cols?r.get(0,t):n)):1===r.cols?new s(e,t,((e,t)=>e<r.rows?r.get(e,0):n)):new s(e,t,((e,t)=>e<r.rows&&t<r.cols?r.get(e,t):n))}},40511:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertPositiveLength=t.assertIndex=t.assertPositiveInteger=t.assertNatural=t.assertInteger=t.assertTrue=t.assertFalse=t.assertNever=t.ulsLogger=void 0;const n=r(82438),a=r(6134),i=r(25626);function o(e,t){return function(r,n,a,i){if(e(r,n,a,i),!a)throw new Error(`${t} ${r} ${n} ${i}`)}}function s(e){return{shipAssertTag:o(e.shipAssertTag.bind(e),"shipAssertTag"),assertTag:o(e.assertTag.bind(e),"assertTag"),traceTag:e.traceTag.bind(e),debugTraceTag:e.debugTraceTag.bind(e),dnmTraceTag:e.dnmTraceTag.bind(e)}}function u(e){return(...t)=>{try{return e(...t)}catch(e){}}}class l{createBufferingCallback(e){return(...t)=>{this.callBuffer.length<this.callBufferCapacity&&this.callBuffer.push({method:e,args:t})}}invokeBufferedCalls(){if(0===this.callBuffer.length)return;const e=this.callBuffer;this.callBuffer=[];const r=`calc.common.DefaultLogger.invokeBufferedCalls: ${e.length} calls before initLogger`;t.ulsLogger.ULS.traceTag(579736781,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,r);for(const r of e)t.ulsLogger.noThrowLogger[r.method](...r.args)}constructor(){this.callBufferCapacity=100,this.callBuffer=[],this.shipAssertTag=this.createBufferingCallback("shipAssertTag"),this.assertTag=this.createBufferingCallback("assertTag"),this.traceTag=this.createBufferingCallback("traceTag"),this.dnmTraceTag=this.createBufferingCallback("dnmTraceTag"),this.debugTraceTag=this.createBufferingCallback("debugTraceTag")}}function c(e){return t.ulsLogger.ULS.assertTag(595980873,n.LogCategory.msoulscat_ES_EWAJS,!1,e)}t.ulsLogger=new class{setLogger(e){const t=this.logger;this.logger=e,this.ULS=s(e),this.noThrowLogger=function(e){return{shipAssertTag:u(e.shipAssertTag.bind(e)),assertTag:u(e.assertTag.bind(e)),traceTag:u(e.traceTag.bind(e)),debugTraceTag:u(e.debugTraceTag.bind(e)),dnmTraceTag:u(e.dnmTraceTag.bind(e))}}(e),t instanceof l&&t.invokeBufferedCalls()}constructor(){this.logger=new l,this.ULS=s(this.logger),this.noThrowLogger=this.logger}},t.assertNever=function(e,r){const a=`${e}: code should be unreachable because a value has type 'never'; given ${(0,i.anonymize)(r)}`;return t.ulsLogger.ULS.assertTag(595980872,n.LogCategory.msoulscat_ES_EWAJS,!1,a)},t.assertFalse=c,t.assertTrue=function(e,t){t||c(`${e}: expected condition to be true`)},t.assertInteger=function(e,t){(0,a.isInteger)(t)||c(`${e}: expected integer; given ${(0,i.anonymize)(t)}`)},t.assertNatural=function(e,t){(!(0,a.isInteger)(t)||t<0)&&c(`${e}: expected natural number; given ${(0,i.anonymize)(t)}`)},t.assertPositiveInteger=function(e,t){(!(0,a.isInteger)(t)||t<=0)&&c(`${e}: expected positive integer; given ${(0,i.anonymize)(t)}`)},t.assertIndex=function(e,t,r){(!(0,a.isInteger)(t)||t<0||t>=r)&&c(`${e}: expected natural number less than ${(0,i.anonymize)(r)}; given ${(0,i.anonymize)(t)}`)},t.assertPositiveLength=function(e,t,r){(!(0,a.isInteger)(t)||t<=0||t>r)&&c(`${e}: expected positive integer at most ${(0,i.anonymize)(r)}; given ${(0,i.anonymize)(t)}`)}},79152:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},39322:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.asyncLoop=t.asyncLoopFactory=t.delayPromiseImpl=void 0;const n=r(17869),a=r(39033),i=r(13434);function o(e){return t=>new Promise((r=>e.setTimeout(r,t,void 0)))}function s(e){return(t,r)=>{const i=r?.timeThreshold??10,o=r?.costThreshold??1,s=r?.macrotaskDelay??0,u={iterations:0,microtaskContinues:0,macrotaskContinues:0,macrotaskTotalDelay:0},[l,[c,d]]=(0,a.newPromise)();let g=!0,m=e(s),h=(0,n.now)();return function r(){if(!g||!function(){try{let e=0;for(;e<o;){u.iterations+=1;const r=t();if(void 0===r)return!1;e+=r}return!0}catch(e){return d(e),!1}}())return c();const a=(0,n.now)();a-h<i?(Promise.resolve().then(r),u.microtaskContinues+=1):(m.then((()=>{m=e(s),h=(0,n.now)(),u.macrotaskTotalDelay+=h-a,r()})),u.macrotaskContinues+=1)}(),{promise:l,stop:function(){g=!1},stats:u}}}t.delayPromiseImpl=o,t.asyncLoopFactory=s,t.asyncLoop=s(o(i.defaultSetTimeoutInterface))},18860:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.capitalize=void 0,t.capitalize=function(e){return e.charAt(0).toUpperCase()+e.slice(1)}},20881:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.codePointCapitalD=t.codePointCapitalC=t.codePointCapitalB=t.codePointCapitalA=t.codePointTilde=t.codePointRightCurlyBracket=t.codePointPipe=t.codePointLeftCurlyBracket=t.codePointBacktick=t.codePointUnderscore=t.codePointCircumflexAccent=t.codePointRightSquareBracket=t.codePointBackslash=t.codePointLeftSquareBracket=t.codePointAtSign=t.codePointQuestionMark=t.codePointGreaterThanSign=t.codePointEqualsSign=t.codePointLessThanSign=t.codePointSemicolon=t.codePointColon=t.codePointDigitNine=t.codePointDigitEight=t.codePointDigitSeven=t.codePointDigitSix=t.codePointDigitFive=t.codePointDigitFour=t.codePointDigitThree=t.codePointDigitTwo=t.codePointDigitOne=t.codePointDigitZero=t.codePointSlash=t.codePointFullStop=t.codePointMinusSign=t.codePointComma=t.codePointPlusSign=t.codePointAsterisk=t.codePointRightParen=t.codePointLeftParen=t.codePointSingleQuote=t.codePointAmpersand=t.codePointPercentSign=t.codePointDollarSign=t.codePointHash=t.codePointDoubleQuote=t.codePointExclamationMark=t.codePointSpace=t.codePointCR=t.codePointLF=t.codePointTab=void 0,t.codePointThaiDigitNine=t.codePointThaiDigitZero=t.codePointSmallZ=t.codePointSmallY=t.codePointSmallX=t.codePointSmallW=t.codePointSmallV=t.codePointSmallU=t.codePointSmallT=t.codePointSmallS=t.codePointSmallR=t.codePointSmallQ=t.codePointSmallP=t.codePointSmallO=t.codePointSmallN=t.codePointSmallM=t.codePointSmallL=t.codePointSmallK=t.codePointSmallJ=t.codePointSmallI=t.codePointSmallH=t.codePointSmallG=t.codePointSmallF=t.codePointSmallE=t.codePointSmallD=t.codePointSmallC=t.codePointSmallB=t.codePointSmallA=t.codePointCapitalZ=t.codePointCapitalY=t.codePointCapitalX=t.codePointCapitalW=t.codePointCapitalV=t.codePointCapitalU=t.codePointCapitalT=t.codePointCapitalS=t.codePointCapitalR=t.codePointCapitalQ=t.codePointCapitalP=t.codePointCapitalO=t.codePointCapitalN=t.codePointCapitalM=t.codePointCapitalL=t.codePointCapitalK=t.codePointCapitalJ=t.codePointCapitalI=t.codePointCapitalH=t.codePointCapitalG=t.codePointCapitalF=t.codePointCapitalE=void 0,t.codePointInvertedQuestionMark=t.codePointInvertedExclamationMark=t.codePointRightSingleQuotationMark=t.codePointLeftSingleQuotationMark=t.codePointEuroSign=t.codePointFullwidthLatinSmallZ=t.codePointFullwidthLatinSmallA=t.codePointFullwidthLatinCapitalZ=t.codePointFullwidthLatinCapitalA=t.codePointFullwidthDigitNine=t.codePointFullwidthDigitZero=void 0,t.codePointTab=9,t.codePointLF=10,t.codePointCR=13,t.codePointSpace=32,t.codePointExclamationMark=33,t.codePointDoubleQuote=34,t.codePointHash=35,t.codePointDollarSign=36,t.codePointPercentSign=37,t.codePointAmpersand=38,t.codePointSingleQuote=39,t.codePointLeftParen=40,t.codePointRightParen=41,t.codePointAsterisk=42,t.codePointPlusSign=43,t.codePointComma=44,t.codePointMinusSign=45,t.codePointFullStop=46,t.codePointSlash=47,t.codePointDigitZero=48,t.codePointDigitOne=49,t.codePointDigitTwo=50,t.codePointDigitThree=51,t.codePointDigitFour=52,t.codePointDigitFive=53,t.codePointDigitSix=54,t.codePointDigitSeven=55,t.codePointDigitEight=56,t.codePointDigitNine=57,t.codePointColon=58,t.codePointSemicolon=59,t.codePointLessThanSign=60,t.codePointEqualsSign=61,t.codePointGreaterThanSign=62,t.codePointQuestionMark=63,t.codePointAtSign=64,t.codePointLeftSquareBracket=91,t.codePointBackslash=92,t.codePointRightSquareBracket=93,t.codePointCircumflexAccent=94,t.codePointUnderscore=95,t.codePointBacktick=96,t.codePointLeftCurlyBracket=123,t.codePointPipe=124,t.codePointRightCurlyBracket=125,t.codePointTilde=126,t.codePointCapitalA=65,t.codePointCapitalB=66,t.codePointCapitalC=67,t.codePointCapitalD=68,t.codePointCapitalE=69,t.codePointCapitalF=70,t.codePointCapitalG=71,t.codePointCapitalH=72,t.codePointCapitalI=73,t.codePointCapitalJ=74,t.codePointCapitalK=75,t.codePointCapitalL=76,t.codePointCapitalM=77,t.codePointCapitalN=78,t.codePointCapitalO=79,t.codePointCapitalP=80,t.codePointCapitalQ=81,t.codePointCapitalR=82,t.codePointCapitalS=83,t.codePointCapitalT=84,t.codePointCapitalU=85,t.codePointCapitalV=86,t.codePointCapitalW=87,t.codePointCapitalX=88,t.codePointCapitalY=89,t.codePointCapitalZ=90,t.codePointSmallA=97,t.codePointSmallB=98,t.codePointSmallC=99,t.codePointSmallD=100,t.codePointSmallE=101,t.codePointSmallF=102,t.codePointSmallG=103,t.codePointSmallH=104,t.codePointSmallI=105,t.codePointSmallJ=106,t.codePointSmallK=107,t.codePointSmallL=108,t.codePointSmallM=109,t.codePointSmallN=110,t.codePointSmallO=111,t.codePointSmallP=112,t.codePointSmallQ=113,t.codePointSmallR=114,t.codePointSmallS=115,t.codePointSmallT=116,t.codePointSmallU=117,t.codePointSmallV=118,t.codePointSmallW=119,t.codePointSmallX=120,t.codePointSmallY=121,t.codePointSmallZ=122,t.codePointThaiDigitZero=3664,t.codePointThaiDigitNine=3673,t.codePointFullwidthDigitZero=65296,t.codePointFullwidthDigitNine=65305,t.codePointFullwidthLatinCapitalA=65313,t.codePointFullwidthLatinCapitalZ=65338,t.codePointFullwidthLatinSmallA=65345,t.codePointFullwidthLatinSmallZ=65370,t.codePointEuroSign=8364,t.codePointLeftSingleQuotationMark=8216,t.codePointRightSingleQuotationMark=8217,t.codePointInvertedExclamationMark=161,t.codePointInvertedQuestionMark=191},2694:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.combinations=void 0,t.combinations=function e(...t){if(0===t.length)return[[]];const[r,...n]=t,a=e(...n),i=[];for(const e of r)for(const t of a)i.push([e,...t]);return i}},38440:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initCalcThread=t.initCalcInThread=t.initCalc=t.getCalcAbsUrlOrThrow=t.getCalcAbsUrl=t.isCalcInit=t.maxRetriesForLoadingScript=t.initCalcCalled=void 0;const n=r(74643),a=r(82438),i=n.__importStar(r(11093)),o=r(40511),s=r(14523),u=r(64494),l=r(6134),c=r(39033),d=r(8515);t.initCalcCalled=new c.ResolvablePromise,t.maxRetriesForLoadingScript=9;const g=/^(https)|(http)|(file):\/\//;let m,h=!1;function p(){if(null==m)throw new Error("initCalc was not passed calcAbsUrl");return m}function f(e,r,n,c){if(h){const e="calc.config.initCalc: Calc is already initialized";return void o.ulsLogger.ULS.traceTag(595910878,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,e)}if(o.ulsLogger.setLogger(e),(0,s.initStopwatch)(e),(0,u.initFeatureConfiguration)(r),null!=n&&!g.test(n)){const e=`calc.config.initCalc: calcAbsUrl is not absolute: ${n}`;o.ulsLogger.ULS.traceTag(595910879,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,e)}i.setConfig(c??{importScriptsMaxRetries:t.maxRetriesForLoadingScript,onWorkerError(e){const t={error:(0,l.messageFromError)(e),innerError:e.info.error?(0,l.messageFromError)(e.info.error):void 0},r=`calc.onWorkerError: ${JSON.stringify(t)}`;o.ulsLogger.ULS.traceTag(593335298,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,r)},onCreateWorker(e){const t=`calc.onCreateWorker: ${JSON.stringify(e)}`;o.ulsLogger.ULS.traceTag(593335299,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,t)}}),m=n,h=!0;const p=`calc.config.initCalc: package version ${d.packageVersion} (production) initialized`;o.ulsLogger.ULS.traceTag(594642132,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,p),t.initCalcCalled.resolve(void 0)}t.isCalcInit=function(){return h},t.getCalcAbsUrl=function(){return m},t.getCalcAbsUrlOrThrow=p,t.initCalc=function(e,t,r){f(e,t,r,void 0)},t.initCalcInThread=async function(e,t,r,n){f(function(e){const t=e=>`[${(new Date).toISOString()}] ${e}`;return{shipAssertTag(r,n,a,i){e.shipAssertTag(r,n,a,t(i))},assertTag(r,n,a,i){e.assertTag(r,n,a,t(i))},traceTag(r,n,a,i){e.traceTag(r,n,a,t(i))},debugTraceTag(r,n,a,i){e.debugTraceTag(r,n,a,t(i))},dnmTraceTag(r,n,a,i){e.dnmTraceTag(r,n,a,t(i))}}}((await i.Endpoint.createOutside(e)).post),(e=>!0===t[e]),r,n)},t.initCalcThread=async function(e){const t=p(),r=new MessageChannel,n={port:r.port1,options:{id:"WorkerThreadLogger"}},a={port:r.port2,options:{id:"WorkerThreadLogger"}};try{const[r]=await Promise.all([i.Endpoint.createInside(n,(()=>o.ulsLogger.noThrowLogger)),e.call.initCalcThreadInside.transfer([a.port],a,(0,u.getFeatures)(),t)]);return r}catch(e){throw n.port.close(),e}}},17869:function(e,t){"use strict";function r(){const e=Object.create(null);return e.___=void 0,delete e.___,e}function n(e){return Object.keys(e).map((e=>Number(e))).filter((e=>!isNaN(e)))}function a(e,t){for(const r of t)e.push(r);return e}function i(e){return null!=e}Object.defineProperty(t,"__esModule",{value:!0}),t.mapFromArrayOfPairs=t.singleton=t.now=t.typedInstanceCreator=t.makeStringCompareCI=t.fastAbs=t.fastMax=t.fastMin=t.pair=t.filterOutNones=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.strEnumArray=t.numEnumMap=t.numEnumArray=t.cloneStringMap=t.makeStringMap=t.identity=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.makeNewtypeIso=void 0,t.makeNewtypeIso=function(e,t){return{wrap:e,unwrap:t}},t.staticAssertExtends=function(){},t.staticAssertSame=function(){},t.staticAssertIs=function(){return e=>e},t.staticAssertIsOptional=e=>e,t.identity=function(e){return e},t.makeStringMap=r,t.cloneStringMap=function(e){const t=r();for(const r in e)t[r]=e[r];return t},t.numEnumArray=n,t.numEnumMap=function(e,t){const r={};for(const a of n(e))r[a]=t(a);return r},t.strEnumArray=function(e){return Object.keys(e).map((e=>e)).map((t=>e[t])).sort()},t.safePush=a,t.safeConcat=function(e,t){const r=[];a(r,e);for(const e of t)a(r,e);return r},t.isDefined=i,t.isNone=function(e){return null==e},t.filterOutNones=function(e){return e.filter(i)},t.pair=function(e,t){return[e,t]},t.fastMin=function(e,t){return e<t?e:t},t.fastMax=function(e,t){return e<t?t:e},t.fastAbs=function(e){return e<0?-e:e},t.makeStringCompareCI=function(e){const t={sensitivity:"accent"};try{const r=new Intl.Collator(function(e){const t=[e],r=e.indexOf("-");return r>0&&t.push(e.substring(0,r)),"en"!==t[t.length-1]&&t.push("en"),t}(e),t);return r.compare.bind(r)}catch(e){return function(e,t){return e===t?0:e.toLocaleUpperCase().localeCompare(t.toLocaleUpperCase())}}},t.typedInstanceCreator=function(){return e=>e},t.now="undefined"!=typeof self&&null!=self.performance&&null!=self.performance.now?()=>self.performance.now():"undefined"!=typeof process&&null!=process.hrtime?()=>{const[e,t]=process.hrtime();return 1e3*e+t/1e6}:()=>Date.now(),t.singleton=function(e){class t{static instance(){return void 0===t.value&&(t.value=e()),t.value}instance(){return t.instance()}}return t.value=void 0,t},t.mapFromArrayOfPairs=function(e){return e.reduce(((e,[t,r])=>(e[t]=r,e)),{})}},50499:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.enumerateKeysInOrder=t.enumerateInOrder=t.RootPointer=t.ArrayMapTree=t.floorToPowerOf2=void 0;const n=r(92840);function a(e){if(0===e)return 0;let t=e;return t=(t|t>>>1)>>>0,t=(t|t>>>2)>>>0,t=(t|t>>>4)>>>0,t=(t|t>>>8)>>>0,t=(t|t>>>16)>>>0,t+=1,t/2}t.floorToPowerOf2=a;class i{static create(e){return new i(e,[],[])}setValue(e,t){return this.setValues([[e,t]])}remove(e){return void 0===this.getKeyIndex(e)?this:this.filter((t=>t!==e))}getOrSetValue(e,t){const r=this.getKeyIndex(e);if(void 0===r){const r=t();return[this.setValue(e,r),r]}return[this,this.values[r]]}filter(e){const t=[];for(let r=0;r<this.keys.length;r+=1){const n=this.keys[r],a=this.values[r];e(n,a)&&t.push([n,a])}return t.length===this.getCount()?this:this.ofSequence(t)}getCount(){return this.keys.length}getValue(e){const t=this.getKeyIndex(e);if(void 0!==t)return this.values[t]}getEntry(e){const t=this.getKeyIndex(e);if(void 0!==t)return(0,n.entry)(this.keys[t],this.values[t])}contains(e){return void 0!==this.getKeyIndex(e)}forEach(e){for(let t=0;t<this.keys.length;t+=1)if(!e(this.keys[t],this.values[t]))return!1;return!0}setValues(e){const t=this.keys.map(((e,t)=>[e,this.values[t],t])),r=t.length;e.forEach((([e,n],a)=>t.push([e,n,a+r]))),t.sort((([e,,t],[r,,n])=>{const a=this.keyCompare(e,r);return 0!==a?a:t-n}));const n=[];let a;for(let e=0;e<t.length;e+=1){const[r,i]=t[e];void 0===a||0!==this.keyCompare(r,a)?(n.push([r,i]),a=r):n[n.length-1]=[r,i]}return this.ofSequence(n)}getKeyIndex(e){let r=t.RootPointer;for(;r>=0&&r<this.keys.length;){const t=this.keyCompare(e,this.keys[r]);if(0===t)return r;t<0?r=l(r):t>0&&(r=c(r))}}ofSequence(e){const r=e.slice();r.sort((([e],[t])=>this.keyCompare(e,t)));const n=new Array(r.length),a=new Array(r.length),o=function(e){const r=new Array(e);return u(t.RootPointer,r,0,e),r}(r.length);for(let e=0;e<r.length;e+=1){const[t,i]=r[o[e]];n[e]=t,a[e]=i}return new i(this.keyCompare,n,a)}constructor(e,t,r){this.keyCompare=e,this.keys=t,this.values=r}}function o(e,t){const r=[];return s(e,t,r),r}function s(e,t,r){t<0||t>=e.keys.length||(s(e,l(t),r),r.push([e.keys[t],e.values[t]]),s(e,c(t),r))}function u(e,t,r,n){if(e>=t.length)return;const i=function(e){const t=a(e);return t/2-1<=e-t?t-1:e-t/2}(n);t[e]=r+i,u(l(e),t,r,i),u(c(e),t,r+i+1,n-i-1)}function l(e){return 2*e+1}function c(e){return 2*e+2}t.ArrayMapTree=i,t.RootPointer=0,t.enumerateInOrder=o,t.enumerateKeysInOrder=function(e,t){return o(e,t).map((([e])=>e))}},47497:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BinaryHeap=void 0,t.BinaryHeap=class{insert(e){this.items.push(e);let t=this.getCount()-1;for(;t>0;){const r=t-1>>>1,n=this.items[r];if(!(this.cmp(n,e)>0))break;this.items[t]=n,t=r}this.items[t]=e}peek(){return this.items[0]}removeMin(){const e=this.peek(),t=this.items.pop(),r=this.getCount()-1;if(r<0||void 0===t)return e;let n=0;for(this.items[0]=t;n<r;){let e=n;const a=1+(n<<1),i=2+(n<<1);if(a<=r&&this.cmp(this.items[a],t)<0&&(e=a),i<=r&&this.cmp(this.items[i],e===a?this.items[e]:t)<0&&(e=i),n===e)break;this.items[n]=this.items[e],n=e}return this.items[n]=t,e}getCount(){return this.items.length}clear(){this.items.length=0}forEach(e){for(const t of this.items)if(!e(t))return}constructor(e){this.items=[],this.cmp=e}}},58245:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forEachKeyUntyped=t.forEachKey=t.getNodeCount=t.complement=t.symmetricDiff=t.lazy=t.empty=t.dense=t.compareUntyped=t.combineCmp=t.compare=t.exceptUntyped=t.except=t.meetsUntyped=t.meets=t.intersectUntyped=t.intersect=t.unionUntyped=t.union=t.fromUntyped=t.createFromKey=t.cacheKeySplitting=t.SetKind=void 0;const n=r(74643).__assign;var a;function i(e,t,r=10){return n=>{if(void 0!==n.split)return n.split;const a=e(n),i=n===t?0:n.depth;return void 0!==i&&i<r&&(n.split=a,a[0][0].depth=i+1,a[1][0].depth=i+1),a}}function o(e,r){return r===t.empty?t.empty:r===t.dense?t.dense:{setOperations:e,root:r}}function s(e,r){return r===t.empty?e:r===t.dense||e===t.empty?r:e===t.dense?e:o(e.setOperations,u(e.setOperations,e.setOperations.top,e.root,r.root))}function u(e,r,n,a){if(a===t.empty)return n;if(a===t.dense)return a;if(n===t.empty)return a;if(n===t.dense)return n;if(n.isExact&&a.isExact){const i=function(e,r,n,a){const{key:i}=n,{key:o}=a,s=e.compare(i,o);if(void 0!==s)return s<0?a:n;const u=e.union(i,o);if(void 0!==u){const n=e.compare(u,r);return void 0!==n&&0===n?t.dense:v(e,r,u,!0)}}(e,r,n,a);if(void 0!==i)return i}const i=F(e,r,n),o=F(e,r,a),[[s],[l]]=e.split(r);return p(e,s,l,u(e,s,i.left,o.left),u(e,l,i.right,o.right))}function l(e,r,n,a){if(n===t.empty)return n;if(a===t.empty)return a;if(n===t.dense)return a;if(a===t.dense)return n;if(n.isExact&&a.isExact){const i=function(e,r,n,a){const{key:i}=n,{key:o}=a;if(!e.meets(i,o))return t.empty;const s=e.compare(i,o);if(void 0!==s)return s<0?n:a;const u=e.intersect(i,o);return void 0!==u?v(e,r,u,!0):void 0}(e,r,n,a);if(void 0!==i)return i}const i=F(e,r,n),o=F(e,r,a),[[s],[u]]=e.split(r);return p(e,s,u,l(e,s,i.left,o.left),l(e,u,i.right,o.right))}function c(e,r,n,a){if(n===t.empty||a===t.empty)return!1;if(n===t.dense||a===t.dense)return!0;if(n.isExact&&a.isExact)return e.meets(n.key,a.key);const i=F(e,r,n),o=F(e,r,a),[[s],[u]]=e.split(r);return c(e,s,i.left,o.left)||c(e,u,i.right,o.right)}function d(e,r){return e===t.empty||r===t.empty?e:r===t.dense?t.empty:e===t.dense?o(r.setOperations,g(r.setOperations,r.setOperations.top,e,r.root)):o(e.setOperations,g(e.setOperations,e.setOperations.top,e.root,r.root))}function g(e,r,n,a){if(n===t.empty)return n;if(a===t.empty)return n;if(a===t.dense)return t.empty;if(n===t.dense){const n=F(e,r,a),[[i],[o]]=e.split(r);return p(e,i,o,g(e,i,t.dense,n.left),g(e,o,t.dense,n.right))}if(n.isExact&&a.isExact){const t=function(e,t,r,n){const{key:a}=r,{key:i}=n;if(!e.meets(a,i))return r;const o=e.except(a,i);return void 0!==o?v(e,t,o,!0):void 0}(e,r,n,a);if(void 0!==t)return t}const i=F(e,r,n),o=F(e,r,a),[[s],[u]]=e.split(r);return p(e,s,u,g(e,s,i.left,o.left),g(e,u,i.right,o.right))}function m(e,t){if(void 0!==e&&void 0!==t)return 0===e?t:0===t||e===t?e:void 0}function h(e,r,n,a){if(n===a)return 0;if(n===t.empty)return-1;if(a===t.empty)return 1;if(n===t.dense)return a===t.dense?0:1;if(a===t.dense)return-1;if(n.isExact&&a.isExact)return function(e,t,r){return e.compare(t.key,r.key)}(e,n,a);const i=F(e,r,n),o=F(e,r,a),[[s],[u]]=e.split(r),l=h(e,s,i.left,o.left);if(void 0===l)return;const c=h(e,u,i.right,o.right);return void 0!==c?m(l,c):void 0}function p(e,r,n,a,i){return a===t.empty?i===t.empty?t.empty:i===t.dense?f(a,i,void 0,!1,e.infimum(n,n),e.supremum(n,n)):f(a,i,void 0,!1,i.infimum,i.supremum):i===t.empty?a===t.dense?f(a,i,void 0,!1,e.infimum(r,r),e.supremum(r,r)):f(a,i,void 0,!1,a.infimum,a.supremum):a===t.dense?i===t.dense?t.dense:f(a,i,void 0,!1,e.combineInfima(e.infimum(r,r),i.infimum),e.combineSuprema(e.supremum(r,r),i.supremum)):i===t.dense?f(a,i,void 0,!1,e.combineInfima(a.infimum,e.infimum(n,n)),e.combineSuprema(a.supremum,e.supremum(n,n))):f(a,i,void 0,!1,e.combineInfima(a.infimum,i.infimum),e.combineSuprema(a.supremum,i.supremum))}function f(e,t,r,n,a,i){return{key:r,left:e,right:t,isExact:n,infimum:a,supremum:i}}function S(e,r,n){if(!e.meets(r,n))return t.empty;const a=e.compare(r,n);if(void 0!==a)return a<=0?t.dense:v(e,r,n,!0);const i=e.intersect(r,n);return void 0!==i?v(e,r,i,!0):v(e,r,n,!1)}function v(e,t,r,n){return f(void 0,void 0,r,!!n,e.infimum(r,t),e.supremum(r,t))}function F(e,r,a){if(void 0!==a.left)return a;const[[i],[o]]=e.split(r),s=p(e,i,o,S(e,i,a.key),S(e,o,a.key));if(s===t.empty||s===t.dense)throw new Error("incorrect set operations implementation");const u=s;return n(a,{left:u.left,right:u.right})}function y(e){return void 0===e||e===t.empty||e===t.dense?0:y(e.left)+y(e.right)+1}function C(e,r,n){return function r(a,i){if(i===t.empty)return!0;if(i===t.dense)return n(a);if(i.isExact)return n(i.key);const o=F(e,a,i),[[s],[u]]=e.split(a);return r(s,o.left)&&r(u,o.right)}(e.top,r)}!function(e){e[e.Dense=0]="Dense",e[e.Empty=1]="Empty"}(a||(t.SetKind=a={})),t.cacheKeySplitting=i,t.createFromKey=function(e){const t={...e,split:i(e.split,e.top)};return e=>o(t,S(t,t.top,e))},t.fromUntyped=o,t.union=s,t.unionUntyped=u,t.intersect=function(e,r){return e===t.empty?e:r===t.empty||e===t.dense?r:r===t.dense?e:o(e.setOperations,l(e.setOperations,e.setOperations.top,e.root,r.root))},t.intersectUntyped=l,t.meets=function(e,r){return e!==t.empty&&r!==t.empty&&(e===t.dense||r===t.dense||c(e.setOperations,e.setOperations.top,e.root,r.root))},t.meetsUntyped=c,t.except=d,t.exceptUntyped=g,t.compare=function(e,r){return e===r?0:e===t.empty?-1:r===t.empty?1:e===t.dense?r===t.dense?0:1:r===t.dense?-1:h(e.setOperations,e.setOperations.top,e.root,r.root)},t.combineCmp=m,t.compareUntyped=h,t.dense=a.Dense,t.empty=a.Empty,t.lazy=S,t.symmetricDiff=function(e,t){return s(d(e,t),d(t,e))},t.complement=function(e){return d(t.dense,e)},t.getNodeCount=function(e){return e===t.empty||e===t.dense?0:y(e.root)},t.forEachKey=function(e,r){return e===t.empty||C(e.setOperations,e.root,r)},t.forEachKeyUntyped=C},65604:function(e,t){"use strict";function r(e,t){return e&t-1}Object.defineProperty(t,"__esModule",{value:!0}),t.Deque=void 0,t.Deque=class{getCount(){return this.count}maybeResize(){const e=this.values.length;if(this.count>=e){this.values.length=e<<1;for(let t=0;t<this.front;t+=1)this.values[e+t]=this.values[t],this.values[t]=void 0;return}const t=e>>4;if(t>=1&&this.count<t){for(let n=0;n<this.count;n+=1)this.values[r(this.front+n,t)]=this.values[r(this.front+n,e)];this.values.length=t,this.front=r(this.front,t)}}pushBack(e){this.maybeResize(),this.values[r(this.front+this.count,this.values.length)]=e,this.count+=1}pushFront(e){this.maybeResize();const t=r(this.front-1,this.values.length);this.values[t]=e,this.front=t,this.count+=1}peekBack(){return this.values[r(this.front+this.count-1,this.values.length)]}peekFront(){return this.values[this.front]}peekPos(e){if(!(e<0||e>=this.count))return this.values[r(this.front+e,this.values.length)]}popBack(){const e=r(this.front+this.count-1,this.values.length),t=this.values[e];return void 0!==t&&(this.values[e]=void 0,this.count-=1),t}popFront(){const e=this.values[this.front];return void 0!==e&&(this.values[this.front]=void 0,this.front=r(this.front+1,this.values.length),this.count-=1),e}forEach(e){const t=this.values.length;for(let n=0;n<this.count;n+=1)if(!e(this.values[r(this.front+n,t)]))return!1;return!0}constructor(){this.front=0,this.count=0,this.values=[void 0]}}},82978:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeNumberDict=t.makeStringDict=t.makeDictionary=void 0;const n=r(92840),a=r(17869);function i(e){function t(e,t){return Object.prototype.hasOwnProperty.call(e,t)}return{entries:(0,a.makeStringMap)(),keyToString:e,getCount(){return Object.keys(this.entries).length},getValue(e){const r=this.keyToString(e),n=t(this.entries,r)?this.entries[r]:void 0;return(0,a.isDefined)(n)?n.value:void 0},getEntry(e){const t=this.getValue(e);return void 0===t?void 0:(0,n.entry)(e,t)},setValue(e,r){const i=this.keyToString(e),o=t(this.entries,i)?this.entries[i]:void 0;(0,a.isDefined)(o)?o.value=r:this.entries[i]=(0,n.entry)(e,r)},contains(e){const r=this.keyToString(e),n=t(this.entries,r)?this.entries[r]:void 0;return(0,a.isDefined)(n)},remove(e){const r=this.keyToString(e);return!!t(this.entries,r)&&(delete this.entries[r],!0)},getOrSetValue(e,r){const i=this.keyToString(e),o=t(this.entries,i)?this.entries[i]:void 0;if((0,a.isDefined)(o))return o.value;const s=r();return delete this.entries[i],this.entries[i]=(0,n.entry)(e,s),s},forEach(e){for(const r in this.entries){const n=t(this.entries,r)?this.entries[r]:void 0;if((0,a.isDefined)(n)&&!e(n.key,n.value))return!1}return!0},filter(e){const t=[];this.forEach(((r,n)=>(e(r,n)||t.push(r),!0)));for(const e of t)this.remove(e)}}}t.makeDictionary=i,t.makeStringDict=function(){return i(a.identity)},t.makeNumberDict=function(){return i((e=>String(e)))}},97024:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeHashSet=void 0;const n=r(17869),a=r(37093);t.makeHashSet=function(e,t){return{map:{},keyToHash:e,keyEquals:t,nelements:0,add(e){const t=this.keyToHash(e);if((0,n.isNone)(this.map[t]))this.map[t]=[e],this.nelements+=1;else{const r=this.map[t];for(let t=0;t<r.length;t+=1)if(this.keyEquals(e,r[t]))return;(0,a.logCollisionKey)(e),r.push(e),this.nelements+=1}},contains(e){const t=this.keyToHash(e),r=this.map[t];if((0,n.isNone)(r))return!1;for(let t=0;t<r.length;t+=1)if(this.keyEquals(e,r[t]))return!0;return(0,a.logCollisionKey)(e),!1},forEach(e){Object.keys(this.map).forEach((t=>{this.map[Number(t)].forEach((t=>{e(t)}))}))},size(){return this.nelements},remove(e){const t=this.keyToHash(e),r=this.map[t];if((0,n.isNone)(r))return!1;const i=[];let o=!1;return r.forEach((t=>{this.keyEquals(e,t)?(this.nelements-=1,o=!0):i.push(t)})),this.map[t]=i,o||(0,a.logCollisionKey)(e),o}}}},7980:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeHashTable=void 0;const n=r(92840),a=r(37093),i=r(17869);t.makeHashTable=function(e,t){return{map:{},nentries:0,keyToHash:e,keyEquals:t,getCount(){return this.nentries},getValue(e){const t=this.getEntry(e);return void 0===t?void 0:t.value},getEntry(e){const t=this.keyToHash(e),r=this.map[t];if(!(0,i.isNone)(r)){for(let t=0;t<r.length;t+=1){const n=r[t];if(this.keyEquals(e,n.key))return n}(0,a.logCollisionKey)(e)}},contains(e){return void 0!==this.getValue(e)},setValue(e,t){const r=this.keyToHash(e),i=this.map[r];if(null==i)this.map[r]=[(0,n.entry)(e,t)],this.nentries+=1;else{for(let r=0;r<i.length;r+=1){const n=i[r];if(this.keyEquals(n.key,e))return void(n.value=t)}i.push((0,n.entry)(e,t)),this.nentries+=1,(0,a.logCollisionKey)(e)}},remove(e){const t=this.keyToHash(e),r=this.map[t];if((0,i.isNone)(r))return!1;const n=[];let o=!1;for(let t=0;t<r.length;t+=1){const a=r[t];this.keyEquals(e,a.key)?(this.nentries-=1,o=!0):n.push(a)}return this.map[t]=n,o||(0,a.logCollisionKey)(e),o},getOrSetValue(e,t){const r=this.keyToHash(e),o=this.map[r];if((0,i.isNone)(o)){const a=t();return this.map[r]=[(0,n.entry)(e,a)],this.nentries+=1,a}for(let t=0;t<o.length;t+=1){const r=o[t];if(this.keyEquals(e,r.key))return r.value}const s=t();return o.push((0,n.entry)(e,s)),this.nentries+=1,(0,a.logCollisionKey)(e),s},forEach(e){return Object.keys(this.map).every((t=>this.map[Number(t)].every((t=>e(t.key,t.value)))))},filter(e){const t=[];this.forEach(((r,n)=>(e(r,n)||t.push(r),!0)));for(const e of t)this.remove(e)}}}},50086:function(e,t){"use strict";function r(e,t,r,n,a){let i=t,o=t+r-1;for(;i<=o;){const t=i+(o-i>>>1),r=a(e[t],n);if(0===r)return t;r<0?i=t+1:o=t-1}return~i}Object.defineProperty(t,"__esModule",{value:!0}),t.binarySearch=t.exponentialBuckets=t.linearBuckets=t.Histogram=void 0,t.Histogram=class{addSample(e){let t=this.findBucket(e);t<0&&(t=~t),this.sampleCounts[t]+=1}reset(){const e={buckets:this.buckets,sampleCounts:this.sampleCounts};return this.sampleCounts=this.createSampleCounts(),e}constructor(e){this.buckets=e,this.createSampleCounts=()=>new Array(this.buckets.length+1).fill(0),this.sampleCounts=this.createSampleCounts(),this.findBucket=(()=>{const e=(e,t)=>e-t,t=this.buckets.length;return n=>r(this.buckets,0,t,n,e)})()}},t.linearBuckets=function(e,t,r){const n=(t-e)/(r-1),a=[];for(let t=e,i=0;i<r;t+=n,i+=1)a.push(t);return a},t.exponentialBuckets=function(e,t,r){const n=Math.log(e),a=(Math.log(t)-n)/(r-1),i=[];for(let e=0,t=0;t<r;e+=a,t+=1)i.push(Math.exp(n+e));return i},t.binarySearch=r},90931:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ivlCompare=t.ivlExcept=t.ivlMeetsOrTouches=t.ivlMeets=t.ivlDistance=t.ivlMeet=t.ivlJoin=void 0;const n=r(17869);t.ivlJoin=function(e,t){const[r,a]=e,[i,o]=t;return[(0,n.fastMin)(r,i),(0,n.fastMax)(a,o)]},t.ivlMeet=function(e,t){const[r,a]=e,[i,o]=t;return[(0,n.fastMax)(r,i),(0,n.fastMin)(a,o)]},t.ivlDistance=function(e,t){const[r,a]=e,[i,o]=t;return.5*(0,n.fastAbs)(r+a-(i+o))},t.ivlMeets=function(e,t){const[r,a]=e,[i,o]=t;return(0,n.fastMax)(r,i)<(0,n.fastMin)(a,o)},t.ivlMeetsOrTouches=function(e,t){const[r,a]=e,[i,o]=t;return(0,n.fastMax)(r,i)<=(0,n.fastMin)(a,o)},t.ivlExcept=function(e,t){const[r,n]=e,[a,i]=t;return r<a&&i>=n?[r,a]:r>=a&&i<n?[i,n]:void 0},t.ivlCompare=function(e,t){const[r,n]=e,[a,i]=t;return r===a&&n===i?0:r>=a&&n<=i?-1:r<=a&&n>=i?1:void 0}},80343:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PriorityQueue=void 0;const n=r(47497);t.PriorityQueue=class{peek(){const e=this.heap.peek();if(void 0!==e)return e[0]}enqueue(e){this.max+=1,this.heap.insert([e,this.max])}push(e){this.min-=1,this.heap.insert([e,this.min])}pop(){const e=this.heap.removeMin();return void 0===e?(this.min=0,void(this.max=0)):e[0]}getCount(){return this.heap.getCount()}clear(){this.heap.clear()}constructor(e){this.min=0,this.max=0,this.heap=new n.BinaryHeap((([t,r],[n,a])=>{const i=e(t,n);return 0!==i?i:r-a}))}}},76631:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.productSetSerializer=t.ProductSetSerializer=t.getSubspaceCount=t.forEachProduct=t.getSubspaces=t.symmetricDiffProduct=t.complementProduct=t.meetsProduct=t.compareProduct=t.exceptProduct=t.intersectProduct=t.unionProduct=t.project=t.createFromProduct=void 0;const n=r(58245),a=([e],[t])=>{return(r=String(e))<(n=String(t))?-1:r>n?1:0;var r,n},i={},o=e=>{const t=[];for(const r of Object.keys(e)){const n=r;t.push([n,e[n].id])}const r=function(e){let t="";for(const r of e)t+=String(r[0]),t+="\0",t+=String(r[1]),t+="\0";return t}(t.sort(a));let n=i[r];return void 0===n&&(n={box:{},probabilities:{},depth:1},i[r]=n),n};function s(e){return Object.getOwnPropertyNames(e).length>0}function u(e){return s(e)?{isSubspace:!0,bounds:e}:n.dense}function l(e){return e.isSubspace?1:e.subspaceCount}const c=(e,t,r)=>({isSubspace:!1,left:e,right:t,bounds:r,subspaceCount:l(e)+l(t)});function d(e,t){if(t===n.dense)return t;if(t.isSubspace){let r=!1;for(const n of Object.keys(t.bounds))if(Object.prototype.hasOwnProperty.call(e,n)){r=!0;break}if(!r)return n.dense}return{productOperations:e,root:t}}function g(e){return void 0===e?n.dense:e}const m={unzip(e){const t={},r={};for(const a of Object.keys(e)){const i=a;if(Object.prototype.hasOwnProperty.call(e,i)){const a=e[i];if(a===n.empty)return n.empty;if(a===n.dense)continue;t[i]=a.setOperations,r[i]=a.root}}return d(t,u(r))},combineProduct(e,t,r,a){const i={};for(const o of Object.keys(e)){const s=o;if(Object.prototype.hasOwnProperty.call(e,s)){const o=a(e[s],e[s].top,g(t[s]),g(r[s]));if(o===n.empty)return n.empty;if(o===n.dense)continue;i[s]=o}}return i},restrict(e,...t){const r={};for(const n of t)if(Object.prototype.hasOwnProperty.call(e,n)){const t=e[n];r[n]=t}return r},fromUntypedProduct(e,t,r){const a={};for(const i of r){const r=t[i];a[i]=(0,n.fromUntyped)(e[i],void 0!==r?r:n.dense)}return a},denseProduct(e){const t={};for(const r of e)t[r]=n.dense;return t}};function h(e,t,r){const a=m.combineProduct(e,t,r,n.unionUntyped);if(a===n.empty)throw new Error("broken invariant: the union of two non-empty products cannot be empty");return a}function p(e,t,r){let a=0;for(const i of Object.keys(e)){const o=i;if(Object.prototype.hasOwnProperty.call(e,o)){const i=g(t[o]),s=g(r[o]),u=e[o];if(a=(0,n.combineCmp)(a,(0,n.compareUntyped)(u,u.top,i,s)),void 0===a)return}}return a}t.createFromProduct=m.unzip.bind(m);const f=(()=>{const e={};return(t,r,a)=>{if(r===e.left&&a===e.right)return e.res;e.left=r,e.right=a;const i=p(t,r.bounds,a.bounds);if(void 0!==i)return e.res=i<=0?a:r;let o;const s=Object.keys(t);for(const i of s)if(Object.prototype.hasOwnProperty.call(t,i)&&0!==(0,n.compareUntyped)(t[i],t[i].top,g(r.bounds[i]),g(a.bounds[i]))){if(void 0!==o)return e.res=void 0;o=i}if(void 0!==o){const i=(0,n.unionUntyped)(t[o],t[o].top,g(r.bounds[o]),g(a.bounds[o]));if(i===n.empty)return e.res=n.empty;if(i===n.dense){const{[o]:t,...n}=r.bounds;return e.res=u(n)}const s={...r.bounds,[o]:i};return e.res=u(s)}return e.res=void 0}})();function S(e,t,r){if(r===n.empty)return t;if(r===n.dense)return r;if(t===n.empty)return r;if(t===n.dense)return t;if(!t.isSubspace||!r.isSubspace)return c(t,r,h(e,t.bounds,r.bounds));const a=f(e,t,r);return void 0!==a?a:c(t,r,h(e,t.bounds,r.bounds))}function v(e,t,r,...a){if(t===n.empty||t===n.dense)return t;if(t.isSubspace)return u(m.restrict(t.bounds,...a));const[i,o]=y(e,r),[s,l]=A(e,t,i,o);return S(e,v(e,s,i,...a),v(e,l,o,...a))}function F(e,...t){if(e===n.dense||e===n.empty)return e;const r=m.restrict(e.productOperations,...t);if(!s(r))return n.dense;const a=v(r,e.root,o(r),...t);return a===n.empty?a:d(r,a)}function y(e,t){if(void 0!==t.children)return t.children;const{box:r,probabilities:a}=t;let i,o,s=0;const u=Object.keys(e);for(const t of u)if(Object.prototype.hasOwnProperty.call(e,t)){const u=a[t],l=e[t];if(void 0===u){i=t,o=l.top;break}if(u>s){const e=g(r[t]);if(e===n.empty)throw new Error("the key split can never return empty");let a=l.top;if(e!==n.dense){if(!e.isExact)throw new Error("the key can always be represented exactly");a=e.key}if(!l.canSplit(a))continue;i=t,s=u,o=a}}if(void 0===i||void 0===o)throw new Error("there has to be at least one dimension");const l=e[i],[[c,d],[m,h]]=l.split(o),p=[{box:{...r,[i]:(0,n.lazy)(l,l.top,c)},probabilities:{...a,[i]:d},depth:t.depth+1},{box:{...r,[i]:(0,n.lazy)(l,l.top,m)},probabilities:{...a,[i]:h},depth:t.depth+1}];return t.depth<10&&(t.children=p),p}function C(e,t,r,a){if(t===n.empty)return[n.empty,n.empty];if(t===n.dense)return[u(r),u(a)];const i=p(e,t.bounds,r);if(void 0!==i&&i<=0)return[t,n.empty];const o=m.combineProduct(e,t.bounds,r,n.intersectUntyped);if(o===n.empty)return[n.empty,t];const s=m.combineProduct(e,t.bounds,a,n.intersectUntyped);if(t.isSubspace)return[u(o),s===n.empty?n.empty:u(s)];const[l,c]=C(e,t.left,r,a),[d,g]=C(e,t.right,r,a);return[S(e,l,d),S(e,c,g)]}t.project=F;const A=(e,t,{box:r},{box:n})=>C(e,t,r,n);function E(e,t,r,a,i){const[o,s]=y(e,a),[u,l]=A(e,t,o,s),[c,d]=A(e,r,o,s),g=i(e,u,c,o);return g===n.dense?n.dense:S(e,g,i(e,l,d,s))}function b(e,t,r,a){if(r===n.empty)return t;if(t===n.empty)return r;if(t===n.dense)return t;if(r===n.dense)return r;if(t.isSubspace&&r.isSubspace){const n=f(e,t,r);if(void 0!==n)return n}return E(e,t,r,a,b)}function R(e,t){if(t===n.empty)return e;if(t===n.dense)return t;if(e===n.empty)return t;if(e===n.dense)return e;const r={...e.productOperations,...t.productOperations},a=b(r,e.root,t.root,o(r));return a===n.empty?a:d(r,a)}function T(e,t,r,a){if(t===n.empty||r===n.empty)return n.empty;if(t===n.dense)return r;if(r===n.dense)return t;if(t.isSubspace&&r.isSubspace){const a=m.combineProduct(e,t.bounds,r.bounds,n.intersectUntyped);return a===n.empty?n.empty:u(a)}return E(e,t,r,a,T)}function k(e,t,r,a){if(t===n.empty)return t;if(r===n.dense)return n.empty;if(r===n.empty)return t;if(t===n.dense)return E(e,t,r,a,k);if(t.isSubspace&&r.isSubspace){const a=function(e,t,r){const a=p(e,t.bounds,r.bounds);if(0===a||-1===a)return n.empty;let i;const o=Object.keys(e);for(const a of o)if(Object.prototype.hasOwnProperty.call(e,a)){const o=(0,n.compareUntyped)(e[a],e[a].top,g(t.bounds[a]),g(r.bounds[a]));if(void 0===o||o>0){if(void 0!==i)return;i=a}}if(void 0!==i){const a=(0,n.exceptUntyped)(e[i],e[i].top,g(t.bounds[i]),g(r.bounds[i]));if(a===n.empty)return n.empty;if(a===n.dense){const{[i]:e,...r}=t.bounds;return u(r)}return u({...t.bounds,[i]:a})}}(e,t,r);if(void 0!==a)return a}return E(e,t,r,a,k)}function N(e,t){if(e===n.empty)return e;if(t===n.empty)return e;if(t===n.dense)return n.empty;if(e===n.dense){const e=k(t.productOperations,n.dense,t.root,o(t.productOperations));return e===n.empty?e:d(t.productOperations,e)}const r={...e.productOperations,...t.productOperations},a=k(r,e.root,t.root,o(r));return a===n.empty?a:d(r,a)}function I(e,t,r,a){if(t===r)return 0;if(t===n.empty)return-1;if(r===n.empty)return 1;if(t===n.dense)return r===n.dense?0:1;if(r===n.dense)return-1;if(t.isSubspace&&r.isSubspace)return p(e,t.bounds,r.bounds);const[i,o]=y(e,a),[s,u]=A(e,t,i,o),[l,c]=A(e,r,i,o),d=I(e,s,l,i);return void 0!==d?(0,n.combineCmp)(d,I(e,u,c,o)):void 0}function O(e,t,r,a){if(t===n.empty||r===n.empty)return!1;if(t===n.dense||r===n.dense)return!0;if(!function(e,t,r){for(const a of Object.keys(e)){const i=a;if(Object.prototype.hasOwnProperty.call(e,i)){const a=g(t[i]),o=g(r[i]),s=e[i];if(!(0,n.meetsUntyped)(s,s.top,a,o))return!1}}return!0}(e,t.bounds,r.bounds))return!1;if(t.isSubspace&&r.isSubspace)return!0;const[i,o]=y(e,a),[s,u]=A(e,t,i,o),[l,c]=A(e,r,i,o);return O(e,s,l,i)||O(e,u,c,o)}t.unionProduct=R,t.intersectProduct=function(e,t){if(e===n.empty)return e;if(t===n.empty)return t;if(e===n.dense)return t;if(t===n.dense)return e;const r={...e.productOperations,...t.productOperations},a=T(r,e.root,t.root,o(r));return a===n.empty?a:d(r,a)},t.exceptProduct=N,t.compareProduct=function(e,t){if(e===t)return 0;if(e===n.empty)return-1;if(t===n.empty)return 1;if(e===n.dense)return t===n.dense?0:1;if(t===n.dense)return-1;const r={...e.productOperations,...t.productOperations};return I(r,e.root,t.root,o(r))},t.meetsProduct=function(e,t){if(e===n.empty||t===n.empty)return!1;if(e===n.dense||t===n.dense)return!0;const r={...e.productOperations,...t.productOperations};return O(r,e.root,t.root,o(r))},t.complementProduct=e=>N(n.dense,e),t.symmetricDiffProduct=(e,t)=>R(N(e,t),N(t,e)),t.getSubspaces=function(e){if(e===n.empty||e===n.dense)return[];const t=[];return function e(r){r.isSubspace?t.push(r.bounds):(e(r.left),e(r.right))}(e.root),t},t.forEachProduct=function(e,t,...r){const a=F(e,...r);if(a===n.empty)return!0;if(a===n.dense)return t(m.denseProduct(r));const{productOperations:i,root:o}=a;return function e(n){return n.isSubspace?t(m.fromUntypedProduct(i,n.bounds,r)):e(n.left)&&e(n.right)}(o)},t.getSubspaceCount=function(e){return e===n.empty||e===n.dense?0:l(e.root)};class _{putBack(e){this.cursor-=1,this.buffer[this.cursor]=e}pick(){return this.buffer[this.cursor]}get length(){return this.buffer.length-this.cursor}get empty(){return 0===this.length}pop(){const e=this.pick();return this.cursor+=1,e}constructor(e=[]){this.buffer=e,this.cursor=0}}class P{constructor(){this.size=0,this.clear=()=>{},this.get=()=>{},this.set=()=>this}}function M(e,t){return function(r,n,...a){const i=t.get(r);void 0===i?(e(r,n,...a),t.set(r,t.size)):n.push("__cached__",i)}}function D(e,t){return function(r,...n){if("__cached__"===r.pick()){r.pop();const e=r.pop();return t[e]}const a=e(r,...n);return t.push(a),a}}class w{getDims(e){return Object.keys(e)}serialize(e){this.cached.clear();const t=[];t.push(e.length);for(const r of e)this.serializeProductSetCached(r,t);return JSON.stringify(t)}deserialize(e){this.cache.length=0;const t=new _(JSON.parse(e)),r=t.pop(),n=[];for(let e=0;e<r;e+=1){const e=this.deserializeProductSetCached(t);n.push(e)}return n}static normalizeKey(e){if(Array.isArray(e))return[...e];if("object"==typeof e){const t={...e};return delete t.depth,delete t.split,t}return e}constructor(e){this.globalProductOperations=e,this.cached="undefined"!=typeof Map?new Map:new P,this.cache=[],this.serializers={},this.serializeProductSet=(e,t)=>{if(e===n.empty||e===n.dense)return void t.push(e);const r=e,a=this.getDims(r.productOperations);t.push(a),this.serializeUntypedSparseProductCached(r.root,t,a)},this.deserializeProductSet=e=>{const t=e.pop();if(t===n.empty||t===n.dense)return t;e.putBack(t);const r={},a=e.pop();for(const e of a){const t=this.globalProductOperations[e];r[e]=t}return{productOperations:r,root:this.deserializeUntypedSparseProductCached(e,a)}},this.serializeUntypedSparse=(e,t,r)=>{t.push(e?.isExact),t.push(this.serializers[r].serializeBound(e?.infimum)),t.push(this.serializers[r].serializeBound(e?.supremum));const a=w.normalizeKey(e?.key);t.push(this.serializers[r].serializeKey(a));for(const a of[e?.left,e?.right])null==a||a===n.empty||a===n.dense?t.push(a):(t.push("us"),this.serializeUntypedSparseCached(a,t,r))},this.deserializeUntypedSparse=(e,t)=>{const r=e.pop(),n=this.serializers[t].deserializeBound(e.pop()),a=this.serializers[t].deserializeBound(e.pop()),i=this.serializers[t].deserializeKey(e.pop()),[o,s]=["left","right"].map((r=>{const n=e.pop();return"us"===n?this.deserializeUntypedSparseCached(e,t):n}));return{infimum:n,supremum:a,isExact:r,key:i,left:o,right:s}},this.serializeUntypedSparseProduct=(e,t,r)=>{t.push(e.isSubspace);for(const n of r){const r=e.bounds[n];this.serializeUntypedSparseCached(r,t,n)}e.isSubspace||(this.serializeUntypedSparseProductCached(e.left,t,r),this.serializeUntypedSparseProductCached(e.right,t,r),t.push(e.subspaceCount))},this.deserializeUntypedSparseProduct=(e,t)=>{const r=e.pop(),n={};for(const r of t){const t=this.deserializeUntypedSparseCached(e,r);n[r]=t}return r?{isSubspace:r,bounds:n}:{isSubspace:r,bounds:n,left:this.deserializeUntypedSparseProductCached(e,t),right:this.deserializeUntypedSparseProductCached(e,t),subspaceCount:e.pop()}},this.serializeUntypedSparseCached=M(this.serializeUntypedSparse,this.cached),this.deserializeUntypedSparseCached=D(this.deserializeUntypedSparse,this.cache),this.serializeProductSetCached=M(this.serializeProductSet,this.cached),this.deserializeProductSetCached=D(this.deserializeProductSet,this.cache),this.serializeUntypedSparseProductCached=M(this.serializeUntypedSparseProduct,this.cached),this.deserializeUntypedSparseProductCached=D(this.deserializeUntypedSparseProduct,this.cache);for(const t in e){const r={serializeKey:e[t].serializeKey??(e=>JSON.stringify(e)),deserializeKey:e[t].deserializeKey??(e=>JSON.parse(e)),serializeBound:e[t].serializeBound??(e=>JSON.stringify(e)),deserializeBound:e[t].deserializeBound??(e=>JSON.parse(e))};this.serializers[t]=r}}}t.ProductSetSerializer=w,t.productSetSerializer=function(e){return new w(e)}},29138:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RTree=t.RTKind=t.copyExcept=void 0;const n=r(17869),a=r(92840);function i(e,t,r){if(void 0!==r){const n=e.slice();return n[t]=r,n}const n=e.slice(0,-1);return t<e.length-1&&(n[t]=e[e.length-1]),n}var o,s;function u(e,t,r){return{kind:e,key:t,value:r}}function l(e,t){return u(o.Ptr,e,t)}function c(e,t){return u(o.Leaf,e,t)}function d(e,t){return u(o.Branch,e,t)}t.copyExcept=i,function(e){e[e.Ptr=1]="Ptr",e[e.Leaf=2]="Leaf",e[e.Branch=3]="Branch"}(o||(t.RTKind=o={})),function(e){e[e.NotFound=1]="NotFound",e[e.Removed=2]="Removed",e[e.Delete=3]="Delete"}(s||(s={}));class g{static create(e,t,r,n,a=2){const i=a>1?Math.ceil(a):1;return new g({keyJoin:e,keyMeets:t,keyCompare:r,keyDistance:n,minChildren:i,maxChildren:2*i,keyGe:function(e,t){const n=r(e,t);return void 0!==n&&n>=0},keyLe:function(e,t){const n=r(e,t);return void 0!==n&&n<=0}},void 0,0)}getCount(){return this.count}get bounds(){return this.root?.key}getValue(e){if(void 0!==this.root)return function t(r,n){const a=r.keyCompare(n.key,e);if(n.kind===o.Ptr)return 0===a?n.value:void 0;if(!(void 0===a||a<0))for(const e of n.value){const n=t(r,e);if(void 0!==n)return n}}(this.lattice,this.root)}getEntry(e){const t=this.getValue(e);return void 0===t?void 0:(0,a.entry)(e,t)}setValue(e,t,r=(e=>!0)){const n=S(this.lattice,this.root,e,r,t);return void 0!==n?n===this.root?this:new g(this.lattice,n,this.count):new g(this.lattice,f(this.lattice,this.root,l(e,t)),this.count+1)}filter(e){let t=new g(this.lattice,void 0,0);return this.forEach(((r,n)=>(e(r,n)&&(t=t.setValue(r,n)),!0))),t}contains(e,t=(e=>!0)){return void 0!==S(this.lattice,this.root,e,t)}getOrSetValue(e,t){const r=this.getValue(e);if(void 0===r){const r=t();return[this.setValue(e,r),r]}return[this,r]}forEach(e){return m(this.root,e)}forEachGe(e,t){return m(this.root,t,(t=>this.lattice.keyGe(t,e)),(t=>this.lattice.keyGe(t,e)))}forEachLe(e,t){return m(this.root,t,(t=>this.lattice.keyMeets(t,e)),(t=>this.lattice.keyLe(t,e)))}forEachMeets(e,t){return m(this.root,t,(t=>this.lattice.keyMeets(t,e)),(t=>this.lattice.keyMeets(t,e)))}remove(e){if(null==this.root)return this;const t=[],r=this.lattice,a=(u,l)=>{const g=r.keyCompare(u.key,e);if(void 0===g||g<0)return(0,n.pair)(u,s.NotFound);if(u.kind===o.Leaf){const a=u.value;for(let o=0;o<a.length;o+=1)if(0===r.keyCompare(a[o].key,e)){const e=i(a,o);if(e.length<l){const r=c(u.key,e);return t.push(r),(0,n.pair)(r,s.Delete)}return(0,n.pair)(c(h(r,e),e),s.Removed)}}else{const e=u.value;for(let o=0;o<e.length;o+=1){const[c,g]=a(e[o],r.minChildren);if(g===s.Delete){const a=i(e,o);if(a.length>=l)return(0,n.pair)(d(h(r,a),a),s.Removed);const c=d(u.key,a);return t.push(c),(0,n.pair)(c,s.Delete)}if(g===s.Removed)return(0,n.pair)(d(u.key,i(e,o,c)),s.Removed)}}return(0,n.pair)(u,s.NotFound)},u=this.root.kind===o.Leaf?1:2,[p,S]=a(this.root,u);if(p===this.root)return this;let v=S===s.Delete?void 0:p;for(let e=0;e<t.length;e+=1)m(t[e],((e,t)=>(v=f(this.lattice,v,l(e,t)),!0)));return new g(this.lattice,v,this.count-1)}constructor(e,t,r){this.lattice=e,this.root=t,this.count=r}}function m(e,t,r,n){const a=void 0!==r?r:()=>!0,i=void 0!==n?n:()=>!0;if(null==e)return!0;const s=e=>{if(!a(e.key))return!0;if(e.kind===o.Leaf){const r=e.value;for(let e=0;e<r.length;e+=1){const n=r[e];if(i(n.key)&&!t(n.key,n.value))return!1}}else{const t=e.value;for(let e=0;e<t.length;e+=1)if(!s(t[e]))return!1}return!0};return s(e)}function h(e,t){let r=t[0].key;for(let n=1;n<t.length;n+=1)r=e.keyJoin(r,t[n].key);return r}function p(e,t,r){const[a,i]=function(e,t){const[r,a]=function(e,t){let r=0,a=1,i=e.keyDistance(t[0].key,t[1].key);for(let n=2;n<t.length;n+=1)for(let o=0;o<n;o+=1){const s=e.keyDistance(t[o].key,t[n].key);s>i&&(r=o,a=n,i=s)}return(0,n.pair)(r,a)}(e,t),i=t[r].key,o=t[a].key,s=[];for(let r=0;r<t.length;r+=1){const n=t[r];s.push([n,e.keyDistance(i,n.key)-e.keyDistance(o,n.key)])}s.sort(((e,t)=>e[1]-t[1]));let u=e.minChildren;for(;u<t.length-e.minChildren&&s[u][1]<0;u+=1);const l=[],c=[];for(let e=0;e<u;e+=1)l.push(s[e][0]);for(let e=u;e<t.length;e+=1)c.push(s[e][0]);return(0,n.pair)(l,c)}(e,r);return(0,n.pair)(u(t,h(e,a),a),u(t,h(e,i),i))}function f(e,t,r){if(null==t)return c(r.key,[r]);const[a,i]=function t(a){if(a.kind===o.Leaf){const t=[...a.value,r];if(t.length>e.maxChildren){const[r,i]=p(e,a.kind,t);return(0,n.pair)(c(r.key,r.value),i)}return(0,n.pair)(c(e.keyJoin(a.key,r.key),t),void 0)}const i=a.value.slice(),s=function(e,t,r){let n=0,a=e.keyDistance(t[0].key,r),i=t[0].value.length;for(let o=1;o<t.length;o+=1){const s=t[o],u=e.keyDistance(s.key,r);(u<a||u===a&&s.value.length<i)&&(n=o,a=u,i=s.value.length)}return n}(e,i,r.key),[u,l]=t(i[s]);if(i[s]=u,null!=l&&(i.push(l),i.length>e.maxChildren)){const[t,r]=p(e,a.kind,i);return(0,n.pair)(d(t.key,t.value),r)}return(0,n.pair)(d(e.keyJoin(a.key,r.key),i),void 0)}(t);return null!=i?d(e.keyJoin(a.key,i.key),[a,i]):a}function S(e,t,r,n,a){if(void 0!==t)return function t(n){if(n.kind!==o.Leaf)for(let a=0;a<n.value.length;a+=1){const o=n.value[a];if(e.keyMeets(o.key,r)){const e=t(o);if(void 0!==e)return d(n.key,i(n.value,a,e))}}else for(let e=0;e<n.value.length;e+=1){const t=s(n.value[e]);if(void 0!==t)return c(n.key,i(n.value,e,t))}}(t);function s(t){if(0===e.keyCompare(t.key,r))return void 0!==a&&t.value!==a&&n(t.value)?l(t.key,a):t}}t.RTree=g},94878:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RedBlackMapTree=void 0;const n=r(24210);class a{static create(e){return new a(n.emptyUntyped,0,e)}getCount(){return this.count}getValue(e){const t=(0,n.findUntyped)(this,e,this.root);return t?.value}getEntry(e){return(0,n.findUntyped)(this,e,this.root)}contains(e){return void 0!==this.getValue(e)}forEach(e){return(0,n.forEachUntyped)(e,this.root)}setValue(e,t){return new a((0,n.insertUntyped)(this,e,t,this.root),this.contains(e)?this.count:this.count+1,this.keyCompare)}remove(e){return this.contains(e)?new a((0,n.removeUntyped)(this,e,this.root),this.count-1,this.keyCompare):this}getOrSetValue(e,t){const r=this.getValue(e);if(void 0!==r)return[this,r];const i=t();return[new a((0,n.insertUntyped)(this,e,i,this.root),this.count+1,this.keyCompare),i]}filter(e){let t=n.emptyUntyped,r=0;return this.forEach(((a,i)=>(e(a,i)&&(t=(0,n.insertUntyped)(this,a,i,t),r+=1),!1))),new a(t,r,this.keyCompare)}constructor(e,t,r){this.root=e,this.count=t,this.keyCompare=r}}t.RedBlackMapTree=a},24210:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.remove=t.removeUntyped=t.insert=t.insertUntyped=t.forEach=t.forEachUntyped=t.find=t.findUntyped=t.empty=t.emptyUntyped=t.isLeaf=t.fromUntyped=t.Color=void 0;const n=r(40511);var a,i;!function(e){e[e.Red=0]="Red",e[e.Black=1]="Black"}(a||(t.Color=a={})),function(e){e[e.DoubleBlack=2]="DoubleBlack"}(i||(i={}));const o=a.Red,s=a.Black,u=i.DoubleBlack,l={c:s,l:void 0,r:void 0},c={c:u,l:void 0,r:void 0};function d(e,t){return{ops:e,root:t}}function g(e){return void 0===e.l}function m(e){return e.c===o}function h(e){return e.c===s&&void 0!==e.l}function p(e){return e.c===s&&void 0===e.l}function f(e,t,r,n,a){return{c:e,l:t,key:r,value:n,r:a}}function S(e,{l:t,key:r,value:n,r:a}){return f(e,t,r,n,a)}function v(e){return g(e)?l:S(s,e)}function F(e,t,r){if(g(r))return;const n=e.keyCompare(t,r.key);return n<0?F(e,t,r.l):n>0?F(e,t,r.r):r}function y(e,t){return!!g(t)||!!y(e,t.l)&&!!e(t.key,t.value)&&y(e,t.r)}function C(e,t,r,n,a){if(e===s){if(m(t)&&m(t.l))return f(o,S(s,t.l),t.key,t.value,f(s,t.r,r,n,a));if(m(a)&&m(a.r))return f(o,f(s,t,r,n,a.l),a.key,a.value,S(s,a.r));if(m(t)&&m(t.r))return f(o,f(s,t.l,t.key,t.value,t.r.l),t.r.key,t.r.value,f(s,t.r.r,r,n,a));if(m(a)&&m(a.l))return f(o,f(s,t,r,n,a.l.l),a.l.key,a.l.value,f(s,a.l.r,a.key,a.value,a.r))}if(e===u){if(m(a)&&m(a.l))return f(s,f(s,t,r,n,a.l.l),a.l.key,a.l.value,f(s,a.l.r,a.key,a.value,a.r));if(m(t)&&m(t.r))return f(s,f(s,t.l,t.key,t.value,t.r.l),t.r.key,t.r.value,f(s,t.r.r,r,n,a))}return f(e,t,r,n,a)}function A(e,t,r,a,i){return e===o&&t.c===u&&h(i)?C(s,f(o,v(t),r,a,i.l),i.key,i.value,i.r):e===o&&h(t)&&i.c===u?C(s,t.l,t.key,t.value,f(o,t.r,r,a,v(i))):e===s&&t.c===u&&h(i)?C(u,f(o,v(t),r,a,i.l),i.key,i.value,i.r):e===s&&h(t)&&i.c===u?C(u,t.l,t.key,t.value,f(o,t.r,r,a,v(i))):e===s&&t.c===u&&m(i)&&h(i.l)?f(s,C(s,f(o,v(t),r,a,i.l.l),i.l.key,i.l.value,i.l.r),i.key,i.value,i.r):e===s&&m(t)&&h(t.r)&&i.c===u?f(s,t.l,t.key,t.value,C(s,t.r.l,t.r.key,t.r.value,f(o,t.r.r,r,a,v(i)))):((0,n.assertTrue)("calc.common.rbTree.rotate: expected R|B",t.c!==u&&i.c!==u),f(e,t,r,a,i))}function E(e,t,r,n){if(g(n))return f(o,l,t,r,l);const a=e.keyCompare(t,n.key);return a<0?C(n.c,E(e,t,r,n.l),n.key,n.value,n.r):a>0?C(n.c,n.l,n.key,n.value,E(e,t,r,n.r)):f(n.c,n.l,t,r,n.r)}function b(e,t,r,n){return function(e){return!m(e)||e.l.c!==o&&e.r.c!==o?e:S(s,e)}(E(e,t,r,n))}function R(e,t,r){if(g(r))return r;if(r.c===o&&p(r.l)&&p(r.r))return 0===e.keyCompare(t,r.key)?l:r;if(r.c===s&&p(r.l)&&p(r.r))return 0===e.keyCompare(t,r.key)?c:r;if(r.c===s&&m(r.l)&&p(r.l.l)&&p(r.l.r)&&p(r.r)){const n=e.keyCompare(t,r.key);return n<0?f(s,R(e,t,r.l),r.key,r.value,l):n>0?r:f(s,l,r.l.key,r.l.value,l)}const a=e.keyCompare(t,r.key);if(a<0)return A(r.c,R(e,t,r.l),r.key,r.value,r.r);if(a>0)return A(r.c,r.l,r.key,r.value,R(e,t,r.r));(0,n.assertTrue)("calc.common.rbTree.rem: expected node",!g(r.r));const[i,u,d]=T(r.r);return A(r.c,r.l,i,u,d)}function T(e){if(e.c===o&&p(e.l)&&p(e.r))return[e.key,e.value,l];if(e.c===s&&p(e.l)&&p(e.r))return[e.key,e.value,c];if(e.c===s&&p(e.l)&&m(e.r))return[e.key,e.value,S(s,e.r)];(0,n.assertTrue)("calc.common.rbTree.remMin: expected node",!g(e.l));const[t,r,a]=T(e.l);return[t,r,A(e.c,a,e.key,e.value,e.r)]}function k(e,t,r){const a=R(e,t,function(e){return h(e)&&e.l.c===s&&e.r.c===s?S(o,e):e}(r));return(0,n.assertTrue)("calc.common.rbTree.remove: expected R|B",a.c===o||a.c===s),a}t.fromUntyped=d,t.isLeaf=g,t.emptyUntyped=l,t.empty=function(e){return d(e,t.emptyUntyped)},t.findUntyped=F,t.find=function(e,t){return F(t.ops,e,t.root)},t.forEachUntyped=y,t.forEach=function(e,t){return y(e,t.root)},t.insertUntyped=b,t.insert=function(e,t,r){return d(r.ops,b(r.ops,e,t,r.root))},t.removeUntyped=k,t.remove=function(e,t){return d(t.ops,k(t.ops,e,t.root))}},51942:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RingBuffer=void 0,t.RingBuffer=class{count(){return this.counter}isEmpty(){return 0===this.counter}enqueue(e){this.list[this.writeIndex]=e,0!==this.counter&&this.writeIndex===this.readIndex?this.readIndex=(this.readIndex+1)%this.capacity:this.counter++,this.writeIndex=(this.writeIndex+1)%this.capacity}dequeue(){if(this.isEmpty())return;const e=this.list[this.readIndex];return this.list[this.readIndex]=void 0,this.readIndex=(this.readIndex+1)%this.capacity,this.counter--,e}executeOnEveryElement(e){for(let t=0;t<this.counter;t++){const r=(this.readIndex+t)%this.capacity,n=this.list[r];if(void 0!==n&&!e(n))return!1}return!0}constructor(e=1/0){this.list=e<1/0?new Array(e):new Array,this.counter=0,this.capacity=e,this.readIndex=0,this.writeIndex=0}}},84612:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.boundedParetoSetOperations=t.boundedParetoSplitter=t.boundedPareto=void 0;const n=r(17869),a=r(90931);function i(e,t,r){const n=t**e,a=1-(t/r)**e,i=r**e,o=i*n,s=i-n,u=-1/e;return{cdf:1===e?e=>(1-n/e)/a:t=>(1-n*t**-e)/a,invCdf:1===e?e=>1/((i-e*s)/o):e=>((i-e*s)/o)**u}}function o(e,t,r){const a=i(e,t,r);return{canSplit:([e,t])=>t-e>1,split([e,t]){const r=a.cdf(t),i=a.cdf(e+1),o=a.invCdf((r+i)/2),s=(0,n.fastMin)((0,n.fastMax)(Math.round(o),e+1),t-1);return[[[e,s],a.cdf(s)-a.cdf(e+1)],[[s,t],a.cdf(t)-a.cdf(s)]]}}}t.boundedPareto=i,t.boundedParetoSplitter=o,t.boundedParetoSetOperations=function(e,t,r,i,s){const u=o(e,t,r);return{id:s,split:e=>u.split(e),canSplit:e=>u.canSplit(e),meets:a.ivlMeets,intersect:a.ivlMeet,union:(e,t)=>(0,a.ivlMeetsOrTouches)(e,t)?(0,a.ivlJoin)(e,t):void 0,except:a.ivlExcept,compare:a.ivlCompare,top:i,infimum:([e])=>e,supremum:([,e])=>e,combineInfima:(e,t)=>(0,n.fastMin)(e,t),combineSuprema:(e,t)=>(0,n.fastMax)(e,t)}}},92840:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.entry=t.makeEmptyTable=void 0;const r={getCount:()=>0,getValue:()=>{},getEntry:()=>{},contains:()=>!1,forEach:()=>!0};t.makeEmptyTable=function(){return r},t.entry=function(e,t){return{key:e,value:t}}},37093:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logCollisionKey=void 0;const n=r(82438),a=r(40511);let i={},o=0;t.logCollisionKey=function(e){!function(e){const t=i[e];i[e]=(void 0===t?0:t)+1,o+=1,o%100==0&&(a.ulsLogger.ULS.traceTag(595858520,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,`calc.common.hashUtils.logCollision: ${JSON.stringify(i)}.`),i={})}(function(e){return"object"==typeof e?null===e?"null":`Object {${Object.keys(e)}}`:typeof e}(e))}},64494:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isTypedChangeGateEnabled=t.setFeatureGateDictionaryGetter=t.overrideTypedFeatureGates=t.getTypedFeatureGate=t.getFeatures=t.isFeatureEnabled=t.initFeatureConfiguration=t.FeatureName=void 0;const n=r(40511),a=r(82438),i=r(66761);var o;!function(e){e.FeatureCheckingEnabled="FeatureCheckingEnabled",e.CalcPreventSpillingHack="CalcPreventSpillingHack",e.CalcLegacyImplicitIntersection="CalcLegacyImplicitIntersection",e.CalcRecordFunctions="CalcRecordFunctions",e.CalcNestedRecordFunction="CalcNestedRecordFunction",e.CalcLetRecFunction="CalcLetRecFunction",e.CalcLambdaBasicFunctions="CalcLambdaBasicFunctions",e.CalcLambdaDefaultParameters="CalcLambdaDefaultParameters",e.CalcLambdaCellValues="CalcLambdaCellValues",e.CalcLambdaArrayLifting="CalcLambdaArrayLifting"}(o||(t.FeatureName=o={}));let s=e=>{const t=`calc.common.isFeatureEnabledCallback: called with ${e} before initCalc`;return n.ulsLogger.ULS.traceTag(526989323,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,t),!1};const u={};function l(e){return void 0===u[e]&&(u[e]=s(e)),u[e]}t.initFeatureConfiguration=function(e){"function"==typeof e&&(s=e)},t.isFeatureEnabled=l,t.getFeatures=function(){const e={};for(const t in o){const r=o[t];null!=r&&(e[r]=l(r))}return e},t.getTypedFeatureGate=(0,i.makeGetTypedFeatureGate)({Number_Of_Times_Test_Was_Executed:1,"Microsoft.Office.Excel.TestBooleanFeatureGate":!1,"Microsoft.Office.Excel.TestStringFeatureGate":"","Microsoft.Office.Excel.TestNumericFeatureGate":0,"Microsoft.Office.Excel.ProseFormulaRepairExperimentLogBuggyIsEnabled":!1,"Microsoft.Office.Excel.ProseFormulaRepairExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSDemoFeatureGateString":"DummyStringValue","Microsoft.Office.Excel.CalcTSDemoFeatureGateInt":42,"Microsoft.Office.Excel.CalcTSDemoFeatureGateBoolean":!1,"Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSUnitExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSExceLintExperimentIsEnabled":!1,"Microsoft.Office.Excel.SmartFormulaBarUseDevScheduler":!1,"Microsoft.Office.Excel.x10DoNotThrowOnDoublePluginRegistration":!0,"Microsoft.Office.Excel.AutocompleteRangeSuggestionPlugin":!1,"Microsoft.Office.Excel.x10AutocompleteWrapperPluginIsEnabled":!1,"Microsoft.Office.Excel.x10AutocompleteBinaryModelExperimentPlugin":!1,TESTING_ONLY_RECALC_SERVICE_IMPORTSCRIPTS_FAIL:!1,TESTING_ONLY_SCHEDULER_IMPORTSCRIPTS_FAIL:!1,TESTING_ONLY_TEST_PLUGIN_IMPORTSCRIPTS_FAIL:!1,"Microsoft.Office.Excel.FormulaCollection":!1,"Microsoft.Office.Excel.x10ParserPerformanceMeasurements":!1,"Microsoft.Office.Excel.ArgumentAssistanceOnMainThread":!1,"Microsoft.Office.Excel.AutoCompleteOnMainThread":!1,"Microsoft.Office.Excel.UnitlessTimeAndDate":!1,"Microsoft.Office.Excel.UnitExpIgnoreDivMul":!1,"Microsoft.Office.Excel.x10PythonAutocompletionEnabled":!1,"Microsoft.Office.Excel.MockWorkerThreadPlugin":!1,"Microsoft.Office.Excel.EnableFullSessionLogging":!0,"Microsoft.Office.Excel.ChatGPTPluginEnabled":!1,"Microsoft.Office.Excel.FormulaRepairSuggestionsLimit":1,"Microsoft.Office.Excel.ProseExcelRepairEngineV9":!1,"Microsoft.Office.Excel.FormulaByExamplePluginSuggestionShowing":!1,"Microsoft.Office.Excel.SetCellPrefetchPluginEnabled":!1,"Microsoft.Office.Excel.FileOptimization":!1,"Microsoft.Office.Excel.PluginResponseWindowDebugTimeExtension":0,"Microsoft.Office.Excel.FormulaByExampleConditionals":!1,"Microsoft.Office.Excel.FormulaByExampleReferenceRowFormula":!1,"Microsoft.Office.Excel.GotoCtrlClick":!1,"Microsoft.Office.Excel.CalcEtaLambda":!1,"Microsoft.Office.Excel.EtaReducedLambdas":!1,"Microsoft.Office.Excel.DesktopX10VPEnabled":!1,"Microsoft.Office.Excel.InCellControlsAutodetection":!1,"Microsoft.Office.Excel.ValuePreviewDisableCrossWorkbookRefs":!1,"Microsoft.Office.Excel.FormulaAuthoringWithNameManager":!1,"Microsoft.Office.Excel.XLONameManager":!1,"Microsoft.Office.Excel.DesktopX10FBEEnabled":!1});var c=r(66761);Object.defineProperty(t,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return c.overrideTypedFeatureGates}}),Object.defineProperty(t,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return c.setFeatureGateDictionaryGetter}}),t.isTypedChangeGateEnabled=(0,i.makeTypedIsChangeGateEnabled)(["OfficeVSO:XXX_TestChangeGate","OfficeVSO:6476056_OnlySendNestedDotNotationPath","OfficeVSO:7396249_getTableHeadersFromServer","OfficeVSO:7903424_Microsoft.Office.Excel.ProvideX10FeaturesFromSchedulerFeatures","OfficeVSO:7920319_fixArgumentAssistanceHandlingWhitespaces","Microsoft.Office.Excel.X10IntelligentPythonWP5","OfficeVSO:8557722_x10GetNumOfComputationsFromFrame","OfficeVSO:8579351_x10ProcessNotificationsAfterShouldRunPlugin","OfficeVSO:8575821_x10MapGetRichValueFieldListContext","OfficeVSO:8620448_x10SchedulerThrowsFailures","OfficeVSO:8786821_x10SendLoggerMessagesToMainThread","OfficeVSO:8846142_x10SendTelemetryWithUTel","Microsoft.Office.Excel.UseObjectInsteadOfMapForFunctionShortDescriptions","OfficeVSO:9113474_x10_RegistryDeleteDuplicates","OfficeVSO:9127295_x10_awaitEventAsyncChanges","Microsoft.Office.Excel.ES6CodepointIterator","OfficeVSO:9150789_CancelSuppressedRequests","OfficeVSO:9215233_AutocompleteCompleteWebpack5"])},67507:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findIsomorphicSubtrees=void 0,t.findIsomorphicSubtrees=function(e,t,r=(()=>""),n=(()=>1)){const a=[e],i=new Set(a);for(let e=0;e<a.length;e+=1)for(const r of t(a[e]))i.has(r)||(i.add(r),a.push(r));i.clear(),a.reverse();const o=new Map,s=[],u=new Map,l=[];a.forEach(((e,a)=>{const i=t(e).map((e=>o.get(e)));if(i.some((e=>void 0===e)))throw new Error("Circular references in the tree");const c=i.map((e=>s[e])),d=function(e){let t=u.get(e);return void 0!==t||(t=u.size,u.set(e,t)),t}(c.join("/")+"/"+r(e));if(s.push(d),void 0===l[d]){const t=c.map((e=>l[e])),r=t.map((e=>e.size)).reduce(((e,t)=>e+t),n(e)),a=t.map((e=>e.depth)).reduce(((e,t)=>Math.max(e,t)),0)+1;l[d]={subtrees:[e],size:r,depth:a}}else l[d].subtrees.push(e);o.set(e,a)}));for(const e of l)e.subtrees.reverse();const c=new Array(a.length);for(const e of l)c[c.length-o.get(e.subtrees[0])-1]=e;return c.filter((e=>void 0!==e))}},72260:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fnv1a=void 0,t.fnv1a=function(e){let t=2166136261;const r=e.length;for(let n=0;n<r;n+=1)t^=e.charCodeAt(n),t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24);return t>>>0}},8515:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.packageVersion=void 0,t.packageVersion="8.6.9"},91092:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LimitedSizeHotMap=t.revocableSingleton=t.testUtils=t.pledge=t.machine=t.testConfig=t.arrayLogger=t.wrapIntoAsyncModule=t.unicode=t.result=t.mixin=t.promise=t.stopwatch=t.resolvablePromise=t.config=t.codePoint=t.setTimeoutInterfaceModule=t.asyncLoopModule=t.async=t.arrayUtils=t.table=t.split=t.rTree=t.ringBuffer=t.rbTree=t.rbMapTree=t.productSet=t.priorityQueue=t.interval=t.histogram=t.hashTable=t.hashSet=t.dictionary=t.deque=t.bspSet=t.binaryHeap=t.arrayMapTree=t.testUtil=t.core=t.featureConfiguration=t.assertions=t.util=t.anonymizer=t.combinations=t.findIsomorphicSubtrees=t.JSF32=t.fnv1a=t.PackageName=void 0;const n=r(74643);t.PackageName="excel-online-calc-common";var a=r(72260);Object.defineProperty(t,"fnv1a",{enumerable:!0,get:function(){return a.fnv1a}});var i=r(82490);Object.defineProperty(t,"JSF32",{enumerable:!0,get:function(){return i.JSF32}});var o=r(67507);Object.defineProperty(t,"findIsomorphicSubtrees",{enumerable:!0,get:function(){return o.findIsomorphicSubtrees}});var s=r(2694);Object.defineProperty(t,"combinations",{enumerable:!0,get:function(){return s.combinations}}),n.__exportStar(r(18860),t);const u=n.__importStar(r(25626));t.anonymizer=u;const l=n.__importStar(r(6134));t.util=l;const c=n.__importStar(r(40511));t.assertions=c;const d=n.__importStar(r(64494));t.featureConfiguration=d;const g=n.__importStar(r(17869));t.core=g;const m=n.__importStar(r(33238));t.testUtil=m;const h=n.__importStar(r(50499));t.arrayMapTree=h;const p=n.__importStar(r(47497));t.binaryHeap=p;const f=n.__importStar(r(58245));t.bspSet=f;const S=n.__importStar(r(65604));t.deque=S;const v=n.__importStar(r(82978));t.dictionary=v;const F=n.__importStar(r(97024));t.hashSet=F;const y=n.__importStar(r(7980));t.hashTable=y;const C=n.__importStar(r(50086));t.histogram=C;const A=n.__importStar(r(90931));t.interval=A;const E=n.__importStar(r(80343));t.priorityQueue=E;const b=n.__importStar(r(76631));t.productSet=b;const R=n.__importStar(r(94878));t.rbMapTree=R;const T=n.__importStar(r(24210));t.rbTree=T;const k=n.__importStar(r(51942));t.ringBuffer=k;const N=n.__importStar(r(29138));t.rTree=N;const I=n.__importStar(r(84612));t.split=I;const O=n.__importStar(r(92840));t.table=O,t.arrayUtils=n.__importStar(r(53964)),t.async=n.__importStar(r(79152)),t.asyncLoopModule=n.__importStar(r(39322)),t.setTimeoutInterfaceModule=n.__importStar(r(13434)),t.codePoint=n.__importStar(r(20881)),t.config=n.__importStar(r(38440)),t.resolvablePromise=n.__importStar(r(39033)),t.stopwatch=n.__importStar(r(14523)),t.promise=n.__importStar(r(39033));var _=r(25401);Object.defineProperty(t,"mixin",{enumerable:!0,get:function(){return _.mixin}}),t.result=n.__importStar(r(16207)),t.unicode=n.__importStar(r(27043)),t.wrapIntoAsyncModule=n.__importStar(r(55066)),t.arrayLogger=n.__importStar(r(66888)),t.testConfig=n.__importStar(r(38171)),t.machine=n.__importStar(r(85790)),t.pledge=n.__importStar(r(94882)),t.testUtils=n.__importStar(r(70778)),t.revocableSingleton=n.__importStar(r(68901));var P=r(57848);Object.defineProperty(t,"LimitedSizeHotMap",{enumerable:!0,get:function(){return P.LimitedSizeHotMap}})},82490:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JSF32=void 0;const r=(e,t)=>(e<<t|e>>>32-t)>>>0;t.JSF32=class{next(){return this.nextU32()*(1/4294967296)}nextU32(){const e=this.x[0]-r(this.x[1],27)>>>0;return this.x[0]=(this.x[1]^r(this.x[2],17))>>>0,this.x[1]=this.x[2]+this.x[3]>>>0,this.x[2]=this.x[3]+e>>>0,this.x[3]=e+this.x[0]>>>0}constructor(e){this.x=new Uint32Array([4058668781,e,e,e]);for(let e=0;e<20;e+=1)this.nextU32()}}},97736:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mathLog2=void 0,t.mathLog2=Math.log2??(e=>Math.log(e)*Math.LOG2E)},25401:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mixin=void 0,t.mixin=function(e,t,r){return class extends e{constructor(...e){super(...e);const n=t(this);for(const e of r)Object.defineProperty(this,e,{value:n[e].bind(n),enumerable:!1,configurable:!1})}}}},39033:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MaybeThenable=t.collapseThenable=t.bindMaybeThenable=t.isThenable=t.promiseLoop=t.newPromise=t.promiseFinally=t.ResolvablePromiseWithTimeout=t.ResolvablePromiseWithSyncValue=t.ResolvablePromiseWithLimitedSubscribers=t.ResolvablePromise=void 0;const n=r(40511),a=r(17869);class i{then(e,t){return this.promise.then(e,t)}toPromise(){return this.promise}resolve(e){return this._resolve(e),s(e)?this.promise.then():void 0}reject(e){return this._reject(e),s(e)?this.promise.then():void 0}constructor(){this.promise=new Promise(((e,t)=>{this._resolve=e,this._reject=t}))}}t.ResolvablePromise=i;class o extends i{static makeAssertMessage(e){return`ResolvablePromiseWithBoundedSubscribers should not pass a limited amount of ${e} active subscribers when not settled`}settle(){this.isSettled=!0}then(e,t){return(0,n.assertTrue)(o.makeAssertMessage(this.limit),this.isSettled||this.currentSubscribers++<this.limit),super.then(e,t)}constructor(e){super(),this.limit=e,this.currentSubscribers=0,this.isSettled=!1,super.then(this.settle.bind(this),this.settle.bind(this))}}function s(e){return(0,a.isDefined)(e)&&"function"==typeof e.then}t.ResolvablePromiseWithLimitedSubscribers=o,t.ResolvablePromiseWithSyncValue=class extends i{getCurrentValue(){return this.value}resolve(e){return s(e)||this.isUninitialized&&(this.value=e,this.isUninitialized=!1),super.resolve(e)}constructor(){super(),this.value=void 0,this.isUninitialized=!0,this.then((e=>this.value=e))}},t.ResolvablePromiseWithTimeout=class extends i{constructor(e,t){super(),t.setTimeout((()=>{const e=new Error("Promise timeout");e.name="TimeoutError",this.reject(e)}),e)}},t.promiseFinally=function(e,t){return e.then((e=>(t(),e)),(e=>(t(),Promise.reject(e))))},t.newPromise=function(){let e;return[new Promise(((t,r)=>e=[t,r])),e]},t.promiseLoop=function(e,t){let r;return new Promise(((n,a)=>{Promise.resolve(t).then((function t(i){if(void 0!==i){r=i;try{Promise.resolve(e(r)).then(t,a)}catch(e){a(e)}}else n(r)}),a)}))},t.isThenable=s,t.bindMaybeThenable=function(e,t,r){return s(e)?e.then(t,r):t(e)},t.collapseThenable=function(e){return e},t.MaybeThenable={all:function(e){const t=new Array(e.length),r=new i;let n=0;return e.forEach(((a,i)=>{s(a)?a.then((a=>{t[i]=a,++n===e.length&&r.resolve(t)}),(e=>{r.reject(e)})):t[i]=a})),r},any:function(e){const t=new i;return e.forEach(((e,r)=>{if(!s(e))return t.resolve({result:e,resolvedIndex:r});e.then((e=>{t.resolve({result:e,resolvedIndex:r})}),(e=>{t.reject(e)}))})),t}}},16207:function(e,t){"use strict";var r,n;function a(e){return{kind:r.Success,value:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.javaScriptError=t.ReasonKind=t.isSuccess=t.failure=t.successUndefined=t.success=t.ResultKind=void 0,function(e){e.Success="Success",e.Failure="Failure",e.Paused="Paused",e.Breaked="Breaked"}(r||(t.ResultKind=r={})),t.success=a,t.successUndefined=a(void 0),t.failure=function(e){return{kind:r.Failure,reason:e}},t.isSuccess=function(e){return e.kind===r.Success},function(e){e.JavaScriptError="JavaScriptError"}(n||(t.ReasonKind=n={})),t.javaScriptError=function(e){return{kind:n.JavaScriptError,error:e}}},85790:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VoidMachine=t.AllMachine=t.MachineRuntime=t.MachineCycle=t.nextOnSuccessReceiver=t.callMachineTransition=t.breakTransition=t.nextTransition=t.TransitionKind=void 0;const n=r(16207);var a;function i(e,t,r){return{kind:e,machine:t,receiver:r}}function o(e,t){return i(a.CallMachine,e,t)}!function(e){e[e.Next=1]="Next",e[e.CallMachine=2]="CallMachine",e[e.Break=3]="Break"}(a||(t.TransitionKind=a={})),t.nextTransition=i(a.Next,void 0,void 0),t.breakTransition=i(a.Break,void 0,void 0),t.callMachineTransition=o;const s={receiveResult:e=>(0,n.isSuccess)(e)?t.nextTransition:e};t.nextOnSuccessReceiver=function(){return s};class u extends Error{constructor(e,t){super("Cycle detected: tried to call an already-running Machine"),this.machine=e,this.stackDepth=t}}t.MachineCycle=u;class l{static resetStats(){l.maxStackDepth=0,l.numPauses=0,l.numCycles=0}pushFrame(e){const t=this.stack.length,r=e.machine;if(!0===r.runStatus)throw l.numCycles+=1,new u(r,t);!1===r.runStatus&&(r.runStatus=!0),this.stack.push(e),l.maxStackDepth<t+1&&(l.maxStackDepth=t+1)}advanceTopFrame(){const e=this.stack[this.stack.length-1].machine;return"boolean"!=typeof e.runStatus?e.runStatus:e.next()}step(){this.numSteps+=1;const e=this.transition;try{switch(e.kind){case a.Next:return this.transition=this.advanceTopFrame(),t.nextTransition;case a.CallMachine:return this.pushFrame(e),this.transition=this.advanceTopFrame(),t.nextTransition;case a.Break:return this.transition=t.nextTransition,e;default:const r=this.stack.pop();return r?(r.machine.runStatus=e,this.transition=r.receiver.receiveResult(e),t.nextTransition):e}}catch(e){return this.transition=(0,n.failure)((0,n.javaScriptError)(e)),t.nextTransition}}run(e=(()=>!1)){if(this.result)return this.result;try{for(;;){const t=this.step();if(t.kind===a.Break)return t;if(t.kind!==a.Next)return this.result=t;if(e())return l.numPauses+=1,t}}catch(e){return this.result=(0,n.failure)((0,n.javaScriptError)(e))}}runToResult(){for(;;){const e=this.run();if(e.kind!==a.Break)return e}}constructor(e){this.numSteps=0,this.stack=[];try{this.pushFrame(o(e,{receiveResult:e=>e})),this.transition=t.nextTransition}catch(e){this.transition=(0,n.failure)((0,n.javaScriptError)(e))}}}t.MachineRuntime=l,l.maxStackDepth=0,l.numPauses=0,l.numCycles=0,t.AllMachine=class{next(){return this.values.length<this.machines.length?o(this.machines[this.values.length],this):(0,n.success)(this.values)}receiveResult(e){return(0,n.isSuccess)(e)?(this.values.push(e.value),this.next()):e}constructor(e){this.machines=e,this.runStatus=!1,this.values=[]}},t.VoidMachine=class{next(){return o(this.machine,this)}receiveResult(e){return(0,n.isSuccess)(e)?n.successUndefined:e}constructor(e){this.machine=e,this.runStatus=!1}}},94882:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pledge=void 0;const n=r(85790),a=r(16207);class i{setState(e,t,r){return this.onFulfilled=t,this.onRejected=r,this.transition=e,e}next(){return this.transition instanceof i?this.transition=(0,n.callMachineTransition)(this.transition,this):this.transition}receiveResult(e){let t;try{if((0,a.isSuccess)(e)){if(!this.onFulfilled)return this.setState(e,void 0,void 0);t=this.onFulfilled(e.value)}else{if(!this.onRejected)return this.setState(e,void 0,void 0);t=this.onRejected(e.reason)}}catch(e){return this.setState((0,a.failure)((0,a.javaScriptError)(e)),void 0,void 0)}return t instanceof i?(this.setState(t.transition,t.onFulfilled,t.onRejected),t.setState(this,void 0,void 0),this.next()):this.setState((0,a.success)(t),void 0,void 0)}bind(e){return new i(this,e,void 0)}catch(e){return new i(this,void 0,e)}finally(e){return new i(this,(t=>(e(),t)),(t=>(e(),i.reject(t))))}static all(e){return i.fromMachine(new n.AllMachine(e.map(i.resolve)))}settle(){return new n.MachineRuntime(this).runToResult()}static settleOrThrow(e){const t=e.settle();if((0,a.isSuccess)(t))return t.value;throw t.reason.error}constructor(e,t,r){this.transition=e,this.onFulfilled=t,this.onRejected=r,this.runStatus=!(e instanceof i||e.kind===n.TransitionKind.CallMachine)&&e}}t.Pledge=i,i.resolve=e=>e instanceof i?e:new i((0,a.success)(e),void 0,void 0),i.reject=e=>new i((0,a.failure)(e),void 0,void 0),i.undefinedPledge=i.resolve(void 0),i.fromMachine=e=>{if(e instanceof i)return e;const t=new i(i.undefinedPledge,void 0,void 0);return t.transition=(0,n.callMachineTransition)(e,t),t},i.try=e=>i.undefinedPledge.bind(e),i.RepeatMachine=class{next(){const e=this.onLoop(this.accum);return e instanceof i?(0,n.callMachineTransition)(e,this):this.receiveSuccess(e)}receiveResult(e){return(0,a.isSuccess)(e)?this.receiveSuccess(e.value):e}receiveSuccess(e){return void 0===e?(0,a.success)(this.accum):(this.accum=e,n.nextTransition)}constructor(e,t){this.onLoop=e,this.accum=t,this.runStatus=!1}},i.repeat=(e,t)=>i.resolve(t).bind((t=>i.fromMachine(new i.RepeatMachine(e,t))))},70778:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.throwAfterSteps=t.pauseAfterSteps=void 0,t.pauseAfterSteps=function(e){const t=Math.max(1,Math.floor(e));let r=0;return function(){return r+=1,r>=t}},t.throwAfterSteps=function(e){const t=Math.max(1,Math.floor(e));let r=0;return function(){if(r+=1,r<t)return!1;throw t}}},13434:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultSetTimeoutInterface=t.clearTimerUnified=t.setImmediateUnified=void 0;const n=r(40511),a=r(67946);function i(e,...t){return{kind:"Immediate",timer:(0,a.setImmediate)(e,...t)}}function o(e){switch(e.kind){case"Immediate":(0,a.clearImmediate)(e.timer);break;case"Timeout":clearTimeout(e.timer);break;case"Mocking":e.delayedCallback.isValid=!1;break;default:(0,n.assertNever)("unknown timer.kind",e)}}t.setImmediateUnified=i,t.clearTimerUnified=o,t.defaultSetTimeoutInterface={setImmediate:i,setTimeout:function(e,t,...r){return{kind:"Timeout",timer:setTimeout(e,t,...r)}},clearImmediate:o,clearTimeout:o}},14523:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initStopwatch=t.ulsStopwatchFactory=void 0;const n=r(82438),a={ULS:new n.NulLogger};t.ulsStopwatchFactory=(0,n.initStopwatchFactory)((e=>a.ULS.traceTag(595948114,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,e))),t.initStopwatch=function(e){a.ULS=e}},66888:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createArrayLogger=void 0,t.createArrayLogger=function(e=!1,t=(()=>!0),r){const n=new Set,a=new Set;return{log:[],addTriggerListener(e){n.add(e)},waitForMessage(e,t){return new Promise((r=>{const n=setTimeout((()=>{console.warn(`ArrayLogger.waitForMessage: timed out waiting for message; timeout = ${t}`),r(!1)}),t);this.addTriggerListener((t=>{const a=e(t);return a&&(clearTimeout(n),r(!0)),a}))}))},waitForReceivedButDelayedMessages(){const e=[];return a.forEach((t=>e.push(t))),Promise.all(e).then((()=>{}))},addLogMessage(i){if(!t(i))return;const o=new Promise((t=>{var a;a=()=>{this.log.push(i),e&&console.log((new Date).toISOString(),...i),n.forEach((e=>{e(i)&&n.delete(e)})),t()},void 0===r?a():setTimeout((()=>a()),r)})).then((()=>{a.delete(o)}));a.add(o)},shipAssertTag(...e){this.addLogMessage(["shipAssertTag",e]);const{2:t,3:r}=e;if(!t)throw new TypeError(`shipAssertTag: ${r}`)},assertTag(...e){this.addLogMessage(["assertTag",e]);const{2:t,3:r}=e;if(!t)throw new TypeError(`assertTag: ${r}`)},traceTag(...e){this.addLogMessage(["traceTag",e])},dnmTraceTag(...e){this.addLogMessage(["dnmTraceTag",e])},debugTraceTag(...e){this.addLogMessage(["debugTraceTag",e])}}}},38171:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.featureEnabledDummyCallback=t.AssertLogger=t.ConsoleLogger=void 0;const n=r(64494);t.ConsoleLogger=class{shipAssertTag(e,t,r,n){if(console.assert(r,`shipAssertTag2 ${e} ${t} ${n}`),!r)throw new Error(`shipAssertTag2 ${e} ${t} ${n}`)}assertTag(e,t,r,n){if(console.assert(r,`assertTag2 ${e} ${t} ${n}`),!r)throw new Error(`assertTag2 ${e} ${t} ${n}`)}traceTag(e,t,r,n){console.log("traceTag2",e,n,t,r)}dnmTraceTag(e,t,r,n){console.log("dnmTraceTag2",e,n,t,r)}debugTraceTag(e,t,r,n){console.log("debugTraceTag2",e,n,t,r)}},t.AssertLogger=class{shipAssertTag(e,t,r,n){if(!r)throw new Error(`shipAssertTag2 ${e} ${t} ${n}`)}assertTag(e,t,r,n){if(!r)throw new Error(`assertTag2 ${e} ${t} ${n}`)}constructor(){this.traceTag=()=>{},this.debugTraceTag=()=>{},this.dnmTraceTag=()=>{}}},t.featureEnabledDummyCallback=function(e){switch(e){case n.FeatureName.FeatureCheckingEnabled:case n.FeatureName.CalcRecordFunctions:case n.FeatureName.CalcNestedRecordFunction:case n.FeatureName.CalcLetRecFunction:case n.FeatureName.CalcLambdaBasicFunctions:case n.FeatureName.CalcLambdaDefaultParameters:case n.FeatureName.CalcLambdaCellValues:case n.FeatureName.CalcLambdaArrayLifting:return!0;default:return e.startsWith("OfficeVSO:")}}},68901:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RevocableSingleton=void 0;class r{revoke(){this.isRevoked=!0}constructor(e,t){this.target=e,this.isRevoked=!1;const r=e=>{if(this.isRevoked)throw new TypeError(`${String(e)}: ${t}`)};this.proxy="undefined"==typeof Proxy?e:new Proxy(e,{get:(e,t,n)=>(r(t),Reflect.get(e,t,n)),set:(e,t,n,a)=>(r(t),Reflect.set(e,t,n,a))})}}t.RevocableSingleton=class{getInstance(){return this.instance?.proxy}setInstance(e){return this.instance?.revoke(),void 0===e?this.instance=void 0:(this.instance=new r(e,this.message),this.instance.proxy)}revokeInstance(){if(this.instance)return this.instance.revoke(),this.instance=new r(this.instance.target,this.message),this.instance.proxy}constructor(e){this.message=e}}},33238:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomElement=t.randomShuffled=t.randomIndex=t.randomFloat=void 0;const n=r(40511),a=r(82490),i=function(e){const t=null!={NODE_ENV:"production"}.BXL_RUN?.4531024141007942:Math.random()*Date.now();return new a.JSF32(t)}();function o(e){return(0,n.assertTrue)("calc.common.randomIndex",e>0),Math.min(e-1,Math.floor(i.next()*e))}t.randomFloat=function(){return i.next()},t.randomIndex=o,t.randomShuffled=function(e){return e.map((e=>[i.next(),e])).sort(((e,t)=>e[0]<t[0]?-1:e[0]===t[0]?0:1)).map((e=>e[1]))},t.randomElement=function(e){return e[o(e.length)]}},27043:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeIsInClass=t.forEachClassInterval=t.codePointIterator=t.codePointIteratorNew=t.numCodeUnits=t.stringCodePointAt=t.countCodePoints=t.scanCodePointsBack=t.scanCodePoints=t.stringFromCodePoint=t.surrogatePairToCodePoint=t.isAnySurrogate=t.isLowSurrogate=t.isHighSurrogate=void 0;const n=r(17869),a=r(64494),i=55296,o=56320,s=65533;function u(e){return(64512&e)===i}function l(e){return(64512&e)===o}function c(e){return 55296==(63488&e)}function d(e,t){if(u(e)&&l(t))return 65536+((1023&e)<<10|1023&t)}function g(e,t){const r=e.charCodeAt(t);return c(r)?t+1>=e.length?s:d(r,e.charCodeAt(t+1))??s:r}function m(e){return e>=65536?2:1}function*h(e,t=0){let r=t;for(;r<e.length;){const t=g(e,r);yield t,r+=m(t)}}function p(e,t){if(1==(1&e.length))throw new Error("Invalid class length");for(let r=0;r<e.length;r+=2)t(e[r],e[r+1])}t.isHighSurrogate=u,t.isLowSurrogate=l,t.isAnySurrogate=c,t.surrogatePairToCodePoint=d,t.stringFromCodePoint=function(e){if(e<=65535)return String.fromCharCode(e);const t=e-65536;return String.fromCharCode(t>>10|i,1023&t|o)},t.scanCodePoints=function(e,t,r){let n=t;for(let t=0;t<r;t+=1){if(n>=e.length)return;u(e.charCodeAt(n))&&n+1<e.length&&l(e.charCodeAt(n+1))?n+=2:n+=1}return n},t.scanCodePointsBack=function(e,t,r){let n=t;for(let t=0;t<r;t+=1){if(n-1<0)return;l(e.charCodeAt(n-1))&&n-2>=0&&u(e.charCodeAt(n-2))?n-=2:n-=1}return n},t.countCodePoints=function(e,t,r){let n=0;for(let a=t;a<r;n+=1)u(e.charCodeAt(a))&&a+1<r&&l(e.charCodeAt(a+1))?a+=2:a+=1;return n},t.stringCodePointAt=g,t.numCodeUnits=m,t.codePointIteratorNew=h,t.codePointIterator=function(e,t=0){if((0,a.isTypedChangeGateEnabled)("Microsoft.Office.Excel.ES6CodepointIterator"))return h(e,t);const r=[];let n=t;for(;n<e.length;){const t=g(e,n);r.push(t),n+=m(t)}return r},t.forEachClassInterval=p;t.makeIsInClass=function(e){const t=function(e){const t=[];for(let e=0;e<512;++e)t.push([]);return p(e,((e,r)=>{const a=r-1>>7;for(let i=e>>7;i<=a;++i){const a=i<<7,o=i+1<<7;t[i].push((0,n.fastMax)(e,a),(0,n.fastMin)(r,o))}})),t}(e);return e=>{if(e<0||e>65535)return!1;const r=t[e>>>7];for(let t=0;t<r.length;t+=2){const n=r[t],a=r[t+1];if(e>=n&&e<a)return!0}return!1}}},6134:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.values=t.prependErrorMessage=t.messageFromError=t.partialArray=t.arrayFill=t.repeat=t.stringEndsWith=t.stringStartsWith=t.isInteger=t.mathLog2=void 0;const n=r(25626);var a=r(97736);function i(e){try{return e()}catch{return!1}}Object.defineProperty(t,"mathLog2",{enumerable:!0,get:function(){return a.mathLog2}}),t.isInteger="function"==typeof Number.isInteger&&i((()=>Number.isInteger(1)&&!Number.isInteger(1.1)))?e=>Number.isInteger(e):e=>"number"==typeof e&&isFinite(e)&&Math.floor(e)===e,t.stringStartsWith="function"==typeof"".startsWith&&i((()=>"ab".startsWith("a")&&!"ab".startsWith("b")&&"abc".startsWith("b",1)&&!"abc".startsWith("a",1)))?(e,t,r=0)=>e.startsWith(t,r):(e,t,r=0)=>r+t.length<=e.length&&e.substring(r,r+t.length)===t,t.stringEndsWith="function"==typeof"".endsWith&&i((()=>"ab".endsWith("b")&&!"ab".endsWith("a")))?(e,t)=>e.endsWith(t):(e,t)=>t.length<=e.length&&e.substring(e.length-t.length,e.length)===t,t.repeat="function"==typeof"".repeat&&i((()=>"aaa"==="a".repeat(3)))?(e,t)=>e.repeat(t):(e,t)=>Array(t+1).join(e),t.arrayFill=function(e,t){for(let r=0;r<e.length;r+=1)e[r]=t;return e},t.partialArray=function(e){const t=[];return Object.keys(e).map(Number).forEach((r=>t[r]=e[r])),t},t.messageFromError=function(e){if(null==e||"object"!=typeof e)return(0,n.anonymize)(e);const t=e,r=String(t.name),a=String(t.message);if(null!=t.stack){const e=String(t.stack);return e.indexOf(a)>=0&&e.indexOf(r)>=0?e:`${r}: ${a}\n${e}`}return a.indexOf(r)>=0?a:`${r}: ${a}`},t.prependErrorMessage=function(e,t){if(null==e||"object"!=typeof e)return e;const r=e;return r.message=`${t} ${String(r.message)}`,r},t.values=function(e){const t=[];for(const r in e)Object.hasOwnProperty.call(e,r)&&t.push(e[r]);return t}},55066:function(e,t){"use strict";function r(){return e=>function(e){const t=class{constructor(e){this.obj=e}};for(const r of e)t.prototype[r]=function(...e){const t=this.obj[r](...e);return Promise.resolve(t)};return t}(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.wrapIntoAsync=t.wrapIntoAsyncClass=void 0,t.wrapIntoAsyncClass=r,t.wrapIntoAsync=function(e,t){return new(r()(t))(e)}},12471:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},9330:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(74643);n.__exportStar(r(12471),t),n.__exportStar(r(18571),t),n.__exportStar(r(4324),t)},18571:function(e,t){"use strict";var r,n;Object.defineProperty(t,"__esModule",{value:!0}),t.DateOrder=t.CurrencyFormat=void 0,function(e){e.Paren="Paren",e.Lead="Lead",e.Intern="Intern",e.Trail="Trail"}(r||(t.CurrencyFormat=r={})),function(e){e.MDY="MDY",e.DMY="DMY",e.YMD="YMD",e.MYD="MYD",e.DYM="DYM",e.YDM="YDM"}(n||(t.DateOrder=n={}))},4324:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},71314:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.adjustFormulaOrigin=void 0;const n=r(66562),a=r(50667),i=r(10041),o=r(63346),s=r(94574),u=r(39470),l=r(72858),c=r(96089),d=r(51394),g=r(97791);function m(e,t,r,n){if(r.kind===a.PosKind.Abs)return r;const i=(0,s.wrapPosition)(e,r.index,n)-t;return i===r.index?r:(0,a.pos)(a.PosKind.Rel,i)}function h(e,t,r,i){const s=m(t.row,r.row,i.row,n.sheetRows),u=m(t.col,r.col,i.col,n.sheetCols),l=(0,o.canonicaliseBrackets)(e,s)||(0,o.canonicaliseBrackets)(e,u);return(0,a.cellRefSingle)(s,u,l,i.label)}function p(e,t,r,i){switch(i.kind){case a.CellRefKind.Error:case a.CellRefKind.Bad:return i;case a.CellRefKind.Single:return h(e,t,r,i);case a.CellRefKind.Range:{const n=h(e,t,r,i.ref1),o=h(e,t,r,i.ref2);return n===i.ref1&&o===i.ref2?i:(0,a.cellRefRange)(n,o,i.label)}case a.CellRefKind.Row:{const s=m(t.row,r.row,i.row1,n.sheetRows),u=m(t.row,r.row,i.row2,n.sheetRows),l=(0,o.canonicaliseBrackets)(e,s)||(0,o.canonicaliseBrackets)(e,u);return(0,a.cellRefRow)(s,u,l,i.label)}case a.CellRefKind.Col:{const s=m(t.col,r.col,i.col1,n.sheetCols),u=m(t.col,r.col,i.col2,n.sheetCols),l=(0,o.canonicaliseBrackets)(e,s)||(0,o.canonicaliseBrackets)(e,u);return(0,a.cellRefCol)(s,u,l,i.label)}}}const f=(0,i.createFailureErrorClass)("TransformRefsError");class S extends g.IdentityVisitor{nameNode(e,t,r){const n=(0,a.nameNode)(e,t,r),{headResolved:i,fieldsResolved:o}=this.resolver.resolveDottedName(this.locals,n,this.annotations),s=(0,a.flattenNameParts)(e).parts;if((0,d.canDenoteCellRef)(this.locals,t,s)){const[e,n,...d]=s;if(i.kind===c.ResolvedKind.ResolvedCellRef){(0,l.assertTrue)("calc.analyze.adjustFormulaOrigin: all flattened field parts resolved",s.length===1+o.length);const u=this.fn(e.ref);if(u.kind===a.CellRefKind.Single||u.kind===a.CellRefKind.Row||u.kind===a.CellRefKind.Col){const i=(e,t)=>(0,a.fieldRefNamePart)(e,t.rhs,t.canDenoteNamedObject,t.label,t.qualifiedLabel);return(0,a.nameNode)(d.reduce(i,i((0,a.cellRefNamePart)(u,e.asWhole,e.label,e.qualifiedLabel),n)),t,r)}const c=(e,{rhs:t,qualifiedLabel:r})=>(0,a.fieldRefNode)(e,t,r);return d.reduce(c,c((0,a.cellRefNode)(u,i.node.qualifier,i.node.label),n))}if(i.resolution.kind!==u.ResultKind.Success&&i.resolution.reason.kind!==c.ResolveReasonKind.NoOriginSheet&&i.resolution.reason.kind!==c.ResolveReasonKind.InvalidQualifier)throw new f(i.resolution.reason)}return n}cellRefNode(e,t,r){return(0,a.cellRefNode)(this.fn(e),t,r)}constructor(e,t,r,n){super(),this.fn=e,this.locals=r,this.annotations=n,this.resolver=(0,d.createResolver)(t)}}t.adjustFormulaOrigin=function(e,t,r,n){const a=t.originGridCell.value;if((0,i.isGridCellEqual)(a,r))return(0,u.success)(n);try{const i=(0,g.reduceBottomUp)(new S(p.bind(void 0,e.config.refStyle,a,r),e,t,n.annotations),n);return(0,u.success)({...n,node:i})}catch(e){if(e instanceof f)return(0,u.failure)(e.reason);throw e}}},92247:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildAnnotations=void 0;const n=r(72858),a=r(19383),i=r(49207),o=r(89208),s=r(50667),u=r(10041),l=r(97791);class c extends l.PledgeReducer{appNode(e,t,r,n){return i.Pledge.try((()=>(e.kind===s.NodeKind.Name&&(this.annotations[e.label]=s.appHeadNameAnnotation),super.appNode(e,t,r,n))))}letNode(e,t,r,a){const s=e.id===o.WorksheetFuncId.LETREC||e.id!==o.WorksheetFuncId.LET&&(0,n.assertFalse)("calc.lang.buildAnnotations"),u=this.bindNames(t),c=u[t.length];return this.lazyVisitAppHeadNode(e).bind((e=>s?i.Pledge.all(t.map((({binder:e})=>i.Pledge.try((()=>(0,l.visitFormulaNode)(c,e.arg)))))):i.Pledge.all(t.map((({binder:e},t)=>{const r=u[t];return i.Pledge.try((()=>(0,l.visitFormulaNode)(r,e.arg)))}))))).bind((e=>void 0===r?void 0:(0,l.visitFormulaNode)(c,r.arg))).bind((e=>i.Pledge.all(a.map((e=>i.Pledge.try((()=>(0,l.visitFormulaNode)(this,e.arg)))))))).bind((e=>{}))}lambdaNode(e,t,r,n){const a=this.bindNames(t),o=a[t.length];return this.lazyVisitAppHeadNode(e).bind((e=>i.Pledge.all(t.map((({name:e},t)=>{if(void 0===e.arg.def)return i.Pledge.resolve(void 0);const r=a[t],n=e.arg.def;return i.Pledge.try((()=>(0,l.visitFormulaNode)(r,n.rhs)))}))))).bind((e=>void 0===r?void 0:(0,l.visitFormulaNode)(o,r.arg))).bind((e=>i.Pledge.all(n.map((e=>i.Pledge.try((()=>(0,l.visitFormulaNode)(this,e.arg)))))))).bind((e=>{}))}bindNames(e){const t=[this];return e.reduce(((e,{name:r})=>{if(void 0===r.arg.wholeName)return t.push(new c(this.localeInfo,this.annotations,e)),e;const n=(0,u.getBoundName)(this.localeInfo,r.arg.wholeName),a=e.setValue(n,r.arg);return t.push(new c(this.localeInfo,this.annotations,a)),this.annotations[r.arg.label]=(0,s.localNameDeclAnnotation)(n,r.arg.wholeName),a}),this.names),t}nameNode(e,t,r){return i.Pledge.try((()=>{if(void 0===t){const t=(0,s.headNamePart)(e),r=this.names.getEntry((0,u.getBoundName)(this.localeInfo,t.asWhole));void 0===r||(r.value.kind===s.NodeKind.ContextName?this.annotations[t.label]=(0,s.localNameUseAnnotation)(r.key,r.value.whole,r.value.label):(this.annotations[t.label]=(0,s.localNameUseAnnotation)(r.key,r.value.wholeName,r.value.label),this.annotations[r.value.label].uses.push({label:t.label})))}return super.nameNode(e,t,r)}))}constructor(e,t,r){super(l.voidVisitor),this.localeInfo=e,this.annotations=t,this.names=r}}t.buildAnnotations=function(e,t,r,n){const i=[];return(0,l.reduceTopDown_Pledge)(new c(e,i,(r??[]).reduce(((t,r)=>{const n=(0,u.getBoundName)(e,r.whole);return t.setValue(n,r)}),a.RedBlackMapTree.create(e.stringCompareCI))),t),i[t.label]=(0,s.formulaRootAnnotation)(r,n),i}},63346:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatName=t.formatGridRange=t.quoteQualifier=t.formatQualifier=t.shouldQuoteQualifier=t.canonicaliseRangePos=t.formatRangePos=t.canonicaliseCellPos=t.formatCellPos=t.canonicaliseColRange=t.canonicaliseRowRange=t.formatColRange=t.formatRowRange=t.canonicaliseCol=t.canonicaliseRow=t.formatCol=t.formatRow=t.resolvePosition=t.canonicaliseBrackets=t.columnName=void 0;const n=r(74643),a=r(66562),i=r(50667),o=r(94574),s=r(72858),u=n.__importStar(r(34166)),l=r(43492),c=r(73567),d=(0,i.pos)(i.PosKind.Abs,0),g=(0,i.pos)(i.PosKind.Abs,a.sheetRows-1),{codePointCapitalA:m,codePointFullStop:h}=u;function p(e){let t=e+1,r="";for(;t>0;){const e=(t-1)%26;r=String.fromCharCode(m+e)+r,t=Math.floor((t-e)/26)}return r}function f(e,t,r,n){if(t.kind===i.PosKind.Abs)return t.index;if(n)return(0,o.wrapPosition)(e,t.index,r);const a=e+t.index;return 0<=a&&a<r?a:void 0}function S(e,t,r,n,a,o){const s=f(r,n,a,o);if(void 0===s)return;if(n.kind===i.PosKind.Abs)return t+(s+1).toFixed();const u=s-r;return 0===u?t:t+e.rcLeftBracket+u.toFixed()+e.rcRightBracket}function v(e,t,r,n,o){return t===i.RefStyle.A1?function(e,t,r){const n=f(e,t,a.sheetRows,r);if(void 0===n)return;const o=(n+1).toFixed();return t.kind===i.PosKind.Abs?"$"+o:o}(r,n,o):S(e,e.rowLetter,r,n,a.sheetRows,o)}function F(e,t,r,n,o){return t===i.RefStyle.A1?function(e,t,r){const n=f(e,t,a.sheetCols,r);if(void 0===n)return;const o=p(n);return t.kind===i.PosKind.Abs?"$"+o:o}(r,n,o):S(e,e.columnLetter,r,n,a.sheetCols,o)}function y(e,t,r,n){if(r.kind===i.PosKind.Abs)return r;const a=f(t,r,e,n);if(void 0===a)return;const o=a-t;return o===r.index?r:(0,i.pos)(i.PosKind.Rel,o)}function C(e,t,r,n,a){const i=f(e,t,n,a),o=f(e,r,n,a);if(void 0!==i&&void 0!==o)return i<=o?[t,r,i,o]:[r,t,o,i]}function A(e,t,r,n,a,o,s,u,l){const c=C(o,s,u,r,l);if(void 0===c)return;const[d,g,m,h]=c;if(void 0!==t&&0===m&&h===r-1&&s.kind===u.kind)return t(n,a,l);const p=e(n,a,o,d,l);if(void 0===p)return;if(a===i.RefStyle.R1C1&&d.kind===g.kind&&d.index===g.index)return p;const f=e(n,a,o,g,l);return void 0!==f?p+":"+f:void 0}function E(e,t,r,n,a,i){const o=C(r,n,a,t,i);if(void 0===o)return;const[s,u,l,c]=o;if(void 0!==e&&0===l&&c===t-1&&n.kind===a.kind)return e;const d=y(t,r,s,i),g=y(t,r,u,i);return void 0!==d&&void 0!==g?[!1,d,g]:void 0}function b(e,t,r,n,a,o){const s=v(e,t,r.row,n,o),u=F(e,t,r.col,a,o);if(void 0!==s&&void 0!==u)return t===i.RefStyle.A1?u+s:s+u}function R(e,r,n,i,o,s,u,l){const c=C(n.row,i,s,a.sheetRows,l),d=C(n.col,o,u,a.sheetCols,l);if(void 0===c||void 0===d)return;const[g,m,h,p]=c,[f,S,v,F]=d;if(0===v&&F===a.sheetCols-1&&o.kind===u.kind)return(0,t.formatRowRange)(e,r,n.row,g,m,l);if(0===h&&p===a.sheetRows-1&&i.kind===s.kind)return(0,t.formatColRange)(e,r,n.col,f,S,l);const y=b(e,r,n,g,f,l),A=b(e,r,n,m,S,l);return void 0!==y&&void 0!==A?y+":"+A:void 0}function T(e,t){return t===h||e.isIdentContinue(t)}t.columnName=p,t.canonicaliseBrackets=function(e,t){return e===i.RefStyle.R1C1&&t.kind===i.PosKind.Rel&&0!==t.index},t.resolvePosition=f,t.formatRow=v,t.formatCol=F,t.canonicaliseRow=y.bind(void 0,a.sheetRows),t.canonicaliseCol=y.bind(void 0,a.sheetCols),t.formatRowRange=A.bind(void 0,v,void 0,a.sheetRows),t.formatColRange=A.bind(void 0,F,((e,r,n)=>(0,t.formatRowRange)(e,r,0,d,g,n)),a.sheetCols),t.canonicaliseRowRange=E.bind(void 0,void 0,a.sheetRows),t.canonicaliseColRange=E.bind(void 0,[!0,d,g],a.sheetCols),t.formatCellPos=b,t.canonicaliseCellPos=function(e,r,n,a){const i=(0,t.canonicaliseRow)(e.row,r,a),o=(0,t.canonicaliseCol)(e.col,n,a);if(void 0!==i&&void 0!==o)return{row:i,col:o}},t.formatRangePos=R,t.canonicaliseRangePos=function(e,r,n,i,o,s){const u=C(e.row,r,i,a.sheetRows,s),l=C(e.col,n,o,a.sheetCols,s);if(void 0===u||void 0===l)return;const[c,d,g,m]=u,[h,p,f,S]=l,v=(0,t.canonicaliseRow)(e.row,c,s),F=(0,t.canonicaliseCol)(e.col,h,s),y=(0,t.canonicaliseRow)(e.row,d,s),A=(0,t.canonicaliseCol)(e.col,p,s);return void 0!==v&&void 0!==F&&void 0!==y&&void 0!==A?0===f&&S===a.sheetCols-1&&n.kind===o.kind?{row1:v,row2:y,col1:void 0,col2:void 0}:0===g&&m===a.sheetRows-1&&r.kind===i.kind?{col1:F,col2:A,row1:void 0,row2:void 0}:{row1:v,col1:F,row2:y,col2:A}:void 0};const k=/'/g;function N(e,t){if(0===t.length)return!1;let r=0;const n=(0,l.stringCodePointAt)(t,r);if(!e.isIdentStart(n))return!1;r+=(0,l.numCodeUnits)(n);for(const n of(0,l.codePointIterator)(t,r))if(!T(e,n))return!1;return!0}const I=(0,a.gridCell)(0,0);function O(e,t,r){if(0===e.stringCompareCI(r,e.trueName))return!0;if(0===e.stringCompareCI(r,e.falseName))return!0;const n=(0,o.parseCellRef)(e,t,I,r,0);if(void 0!==n)if(n.refStyle===i.RefStyle.A1){const{i:t}=n;if(t>=r.length&&void 0===e.getWorksheetFuncId(r.substring(0,t)))return!0}else if(!(0,o.isR1C1IdentStart)(n.row,n.col))return!0;return!N(e,r)&&!function(e,t){let r=0;if(!(0,c.stringStartsWith)(t,e.leftBracket,r))return!1;if(r+=e.leftBracket.length,r===t.length)return!1;const n=(0,l.stringCodePointAt)(t,r);if(!T(e,n))return!1;for(r+=(0,l.numCodeUnits)(n);;){if((0,c.stringStartsWith)(t,e.rightBracket,r)){r+=e.rightBracket.length;break}if(r===t.length)return!1;const n=(0,l.stringCodePointAt)(t,r);if(!T(e,n))return!1;r+=(0,l.numCodeUnits)(n)}const a=t.indexOf(":",r);return a<0?N(e,t.substring(r)):N(e,t.substring(r,a))&&N(e,t.substring(a+1))}(e,r)&&!function(e,t){const r=e.leftBracket.length,n=e.rightBracket.length;return!(t.length<r+n)&&t.substring(0,r)===e.leftBracket&&t.substring(t.length-n)===e.rightBracket&&N(e,t.substring(r,t.length-n))}(e,r)}function _(e,t,r){return O(e,t,r)?P(r):r}function P(e){return`'${e.replace(k,"''")}'`}t.shouldQuoteQualifier=O,t.formatQualifier=_,t.quoteQualifier=P,t.formatGridRange=function(e,t,r=i.RefStyle.A1,n,o){const u=1===t.cols&&1===t.rows?b(e,r,(0,a.gridCell)(0,0),(0,i.pos)(i.PosKind.Rel,t.row),(0,i.pos)(i.PosKind.Rel,t.col),!1):R(e,r,(0,a.gridCell)(0,0),(0,i.pos)(i.PosKind.Rel,t.row),(0,i.pos)(i.PosKind.Rel,t.col),(0,i.pos)(i.PosKind.Rel,t.row+t.rows-1),(0,i.pos)(i.PosKind.Rel,t.col+t.cols-1),!1);if((0,s.assertTrue)("calc.lang.formatGridRange",void 0!==u),void 0===n&&void 0===o)return u;if(void 0===n||void 0===o)return _(e,r,n??o)+"!"+u;const l=n+":"+o;return(O(e,r,n)||O(e,r,o)?P(l):l)+"!"+u},t.formatName=function(e,t,r=i.RefStyle.A1,n){return void 0===n?t:_(e,r,n)+"!"+t}},94574:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapPosition=t.parseQualifier=t.parseGridRangeA1=t.parseGridCellA1=t.parseCellRef=t.isR1C1IdentStart=t.SpecialPos=void 0;const n=r(74643),a=r(66562),i=r(80168),o=r(50667),s=r(24783),u=n.__importStar(r(34166)),l=r(73567),c=r(43492),d=a.sheetRows,g=d.toString(10).length,m=a.sheetCols,h=m.toString(26).length,p=m.toString(10).length,{codePointCapitalA:f,codePointCapitalZ:S,codePointSmallA:v,codePointSmallZ:F,codePointPlusSign:y,codePointMinusSign:C,codePointColon:A}=u;function E(e){return e>=v&&e<=F||e>=f&&e<=S}function b(e){return 1+(e>=v?e-v:e-f)}function R(e,t,r,n){return function(a,i,s,u,d){const[g,m]=function(e,t){return(0,l.stringStartsWith)(e,"$",t)?[o.PosKind.Abs,t+1]:[o.PosKind.Rel,t]}(s,u),[h,p]=e(a,r,s,m);if(p>m){if(h<1||h>t)return g===o.PosKind.Abs||(!0===n?"object"==typeof d&&d.kind===o.PosKind.Abs||d===w.A1BadDollar:(0,l.stringStartsWith)(s,"$",p))?[w.A1BadDollar,!0,p]:void 0;const e=g===o.PosKind.Rel?h-i:h;return[(0,o.pos)(g,e-1),g===o.PosKind.Abs,p]}return g!==o.PosKind.Abs||!0!==n&&p!==s.length&&a.isNumeral((0,c.stringCodePointAt)(s,p))?[void 0,!1,u]:[w.A1BadDollar,!0,p]}}function T(e,t,r){return x(e,t,r)-e}function k(e,t,r,n){return function(a,i,u,c){const d=t?e?"R":a.rowLetter:e?"C":a.columnLetter;if(c>=u.length||0!==a.stringCompareCI(d,u[c]))return[void 0,!1,c];let g=c+d.length;const[m,h]=(0,s.parseUint)(a,n,u,g);if(h>g&&m>=1&&m<=r)return[(0,o.pos)(o.PosKind.Abs,m-1),!1,h];if((0,l.stringStartsWith)(u,a.rcLeftBracket,g)){if(g+=a.rcLeftBracket.length,(0,l.stringStartsWith)(u,a.rcRightBracket,g))return[(0,o.pos)(o.PosKind.Rel,T(i,0,r)),!0,g+a.rcRightBracket.length];let e=1;const t=u.charCodeAt(g);t===y?g+=1:t===C&&(e=-1,g+=1);const[c,d]=(0,s.parseUint)(a,n,u,g);if(d>g&&c<r&&(0,l.stringStartsWith)(u,a.rcRightBracket,d))return[(0,o.pos)(o.PosKind.Rel,T(i,c*e,r)),!0,d+a.rcRightBracket.length]}return[w.RCNoNum,!1,c+d.length]}}function N(e,t,r,n,a,i,o){const s=n(e,t,i,o,void 0);if(null==s)return[void 0,void 0,o];const[u,l,c]=s;if(c>o){const t=a(e,r,i,c,u);if(null==t)return l?[u,void 0,c]:[void 0,void 0,o];const[n,,s]=t;return s>c?[u,n,s]:[u,void 0,c]}const d=a(e,r,i,o,u);if(null==d)return[void 0,void 0,o];const[g,,m]=d;return m>o?[void 0,g,m]:[void 0,void 0,o]}const I=R(s.parseUint,d,g,!0),O=R(((e,t,r,n)=>function(e,t,r){let n=0,a=r;const o=(0,i.fastMin)(t.length,r+e);for(;a<o;a+=1){const e=t.charCodeAt(a);if(!E(e))break;n=26*n+b(e)}return a===o&&a<t.length&&E(t.charCodeAt(a))?[0,r]:[n,a]}(t,r,n)),m,h,!1),_=k(!1,!0,d,g),P=k(!1,!1,m,p),M=k(!0,!0,d,g),D=k(!0,!1,m,p);var w;function L(e,t){return"object"!=typeof e&&"object"!=typeof t}function x(e,t,r){return e+t&r-1}!function(e){e[e.RCNoNum=0]="RCNoNum",e[e.A1BadDollar=1]="A1BadDollar"}(w||(t.SpecialPos=w={})),t.isR1C1IdentStart=L,t.parseCellRef=function(e,t,r,n,a){const i=function(e,t,r,n,a){const{col:i,row:s}=r,[u,l,d]=N(e,i,s,O,I,n,a),g="object"==typeof l&&l.kind===o.PosKind.Abs||l===w.A1BadDollar||"object"==typeof u&&u.kind===o.PosKind.Abs||u===w.A1BadDollar;if(null!=l&&null!=u||g||(null!=l||null!=u)&&(a-1>=0&&n.charCodeAt(a-1)===A||d<n.length&&n.charCodeAt(d)===A)){if(d<n.length&&e.isIdentContinue((0,c.stringCodePointAt)(n,d)))return;if(t!==o.RefStyle.A1&&!g)return;return{refStyle:o.RefStyle.A1,row:l,col:u,i:d}}}(e,t,r,n,a);return void 0!==i?i:function(e,t,r,n,a){const{col:i,row:s}=r;let u=!1,[l,d,g]=N(e,s,i,_,P,n,a);if(null!=l||null!=d||"R"===e.rowLetter&&"C"===e.columnLetter||(u=!0,[l,d,g]=N(e,s,i,M,D,n,a)),(null!=l||null!=d)&&(g>=n.length||!L(l,d)||!e.isIdentContinue((0,c.stringCodePointAt)(n,g))))return{refStyle:o.RefStyle.R1C1,row:l,col:d,i:g,enLocale:u}}(e,0,r,n,a)},t.parseGridCellA1=function(e,t){const[r,n,i]=N(e,0,0,O,I,t,0);return"object"==typeof r&&"object"==typeof n&&i===t.length?(0,a.gridCell)(n.index,r.index):void 0},t.parseGridRangeA1=function(e,t){const[r,n,o]=N(e,0,0,O,I,t,0);if("object"!=typeof r||"object"!=typeof n)return;if(o===t.length)return(0,a.gridCell)(n.index,r.index);if(t.charCodeAt(o)!==A)return;const[s,u,l]=N(e,0,0,O,I,t,o+1);if("object"!=typeof s||"object"!=typeof u)return;if(l!==t.length)return;const c=(0,i.fastMin)(n.index,u.index),d=(0,i.fastMin)(r.index,s.index);return(0,a.gridRange)(c,d,(0,i.fastMax)(n.index,u.index)+1-c,(0,i.fastMax)(r.index,s.index)+1-d)},t.parseQualifier=function(e){const t=e.lastIndexOf("!");if(t<0||0===t||t===e.length-1)return;const r=e.substring(0,t),n=e.substring(t+1);if(r.indexOf("'")<0)return{qualifier:r,unqualified:n};if(!(0,l.stringStartsWith)(r,"'")||!(0,l.stringEndsWith)(r,"'"))return;const a=[];for(let e=1;e<r.length-1;++e){const t=r.charAt(e);if("'"===t){if(e+1>=r.length-1||"'"!==r.charAt(e+1))return;a.push(t),++e}else a.push(t)}return{qualifier:a.join(""),unqualified:n}},t.wrapPosition=x},21007:function(e,t,r){"use strict";const n=r(91092);e.exports=n.anonymizer},72858:function(e,t,r){"use strict";const n=r(91092);e.exports=n.assertions},34166:function(e,t,r){"use strict";const n=r(91092);e.exports=n.codePoint},80168:function(e,t,r){"use strict";const n=r(91092);e.exports=n.core},48452:function(e,t,r){"use strict";const n=r(91092);e.exports=n.arrayMapTree},76132:function(e,t,r){"use strict";const n=r(91092);e.exports=n.interval},19383:function(e,t,r){"use strict";const n=r(91092);e.exports=n.rbMapTree},83833:function(e,t,r){"use strict";const n=r(91092);e.exports=n.table},36423:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.overrideTypedFeatureGates=t.isTypedChangeGateEnabled=t.getTypedFeatureGate=t.getFeatures=t.isFeatureEnabled=t.initFeatureConfiguration=t.FeatureName=void 0;const n=r(91092);t.FeatureName=n.featureConfiguration.FeatureName,t.initFeatureConfiguration=n.featureConfiguration.initFeatureConfiguration,t.isFeatureEnabled=n.featureConfiguration.isFeatureEnabled,t.getFeatures=n.featureConfiguration.getFeatures,t.getTypedFeatureGate=n.featureConfiguration.getTypedFeatureGate,t.isTypedChangeGateEnabled=n.featureConfiguration.isTypedChangeGateEnabled;var a=r(66761);Object.defineProperty(t,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return a.overrideTypedFeatureGates}}),Object.defineProperty(t,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return a.setFeatureGateDictionaryGetter}})},39470:function(e,t,r){"use strict";const n=r(91092);e.exports=n.result},49207:function(e,t,r){"use strict";const n=r(91092);e.exports=n.pledge},43492:function(e,t,r){"use strict";const n=r(91092);e.exports=n.unicode},73567:function(e,t,r){"use strict";const n=r(91092);e.exports=n.util},81187:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getEnglishLocaleInfo=t.createIsThousandsPositionCallback=t.createWorksheetFuncNameCallbacks=t.getEnglishWorksheetFuncIdToName=t.operatorIdToName=t.englishOperatorIdToName=t.englishErrorTypeToName=t.englishWorksheetFuncIdToName=t.englishSysTimeFormat=t.englishSysDateFormat=t.englishPictureDbnum=t.englishPictureColor=t.englishPictureSingle=t.englishPictureSpecial=t.englishSpecialRefNames=t.englishErrorNames=t.isIdentContinue=t.isIdentStart=t.getNumberShape=t.getOrdinal=t.isNumeral=t.LCID=t.Country=t.localeInfo=t.calcConfig=t.ulsLogger=t.NulLogger=t.TraceLevel=t.LogCategory=t.PictureSingle=t.PictureSpecial=t.PictureDbnum=t.PictureColor=void 0;const n=r(82438);Object.defineProperty(t,"LogCategory",{enumerable:!0,get:function(){return n.LogCategory}}),Object.defineProperty(t,"TraceLevel",{enumerable:!0,get:function(){return n.TraceLevel}}),Object.defineProperty(t,"NulLogger",{enumerable:!0,get:function(){return n.NulLogger}});const a=r(80168),i=r(72858);Object.defineProperty(t,"ulsLogger",{enumerable:!0,get:function(){return i.ulsLogger}});const o=r(93383),s=r(73567),u=r(24386),l=r(48452),c=r(91176),d=r(50667),g=r(16782),m=r(52292),h=r(21174),p=r(93336);function f(e,t,r,n,a,i,o,s,u,l,c,d,g,m,h,p,f,S,v,F,y,C,A,E,b,R,T,k,N,I,O,_,P,M,D,w,L,x,K,W,U,G,B,V,j,H,q,$,z,Q,Y,J,X,Z,ee,te,re,ne,ae,ie,oe,se,ue,le,ce,de,ge,me,he){return{getWorksheetFuncId:e,getWorksheetFuncName:t,isNumeral:r,getOrdinal:n,getNumberShape:a,isThousandsPosition:i,isIdentStart:o,isIdentContinue:s,stringCompareCI:u,errorNames:l,specialRefNames:c,trueName:d,falseName:g,rowLetter:m,columnLetter:h,leftBrace:p,rightBrace:f,leftBracket:S,rightBracket:v,rcLeftBracket:F,rcRightBracket:y,decimalSeparator:C,listSeparator:A,columnSeparator:E,rowSeparator:b,thousandsSeparator:R,statementSeparator:T,lcid:k,cultureTag:N,country:I,isThai:O,isEastAsia:_,isKorea:P,isJapan:M,isChinaT:D,isChinaS:w,isComplexScript:L,numberDecimals:x,isExpSepBySpace:K,fractionSeparator:W,isPercentSepBySpace:U,currencyFormat:G,isCurrencySymbolLead:B,isCurrencySepBySpace:V,currencySymbol:j,currencyDecimals:H,dateOrder:q,dateSeparator:$,dateAltSeparator:z,year4Digits:Q,month2Digits:Y,day2Digits:J,longDateFormat:X,timeSeparator:Z,timeAltSeparator:ee,hour2Digits:te,clock24Hour:re,isAMPMSepBySpace:ne,ampmSymbols:ae,dayNameShort:ie,dayNameLong:oe,monthNameShort:se,monthNameLong:ue,pictureSpecial:le,pictureSingle:ce,pictureColor:de,pictureDbnum:ge,sysDateFormat:me,sysTimeFormat:he}}var S,v;function F(e){const t=0|e;if(t<128)return t>=48&&t<58;const r=15&t;switch(2147483632&t){case 1632:case 1776:case 3664:case 3792:case 3872:case 4160:case 6112:case 6160:return r<=9;case 2400:case 2528:case 2656:case 2784:case 2912:case 3040:case 3168:case 3296:case 3424:return r>=6&&r<=15;case 4960:return r>=9;case 4976:return r<=1;default:return!1}}function y(e){const t=0|e;if(t<128)return(t<48||t>=58)&&(0,i.assertFalse)("calc.config.getOrdinal"),15&t;const r=15&t;let n;switch(2147483632&t){case 1632:case 1776:case 3664:case 3792:case 3872:case 4160:case 6112:case 6160:n=r;break;case 2400:case 2528:case 2656:case 2784:case 2912:case 3040:case 3168:case 3296:case 3424:n=r-6;break;case 4960:n=r-8;break;case 4976:n=r+8;break;default:return(0,i.assertFalse)("calc.config.getOrdinal")}return(n<0||n>9||4968===t)&&(0,i.assertFalse)("calc.config.getOrdinal"),n}function C(e){const t=0|e;if(t<128)return(t<48||t>=58)&&(0,i.assertFalse)("calc.config.getNumberShape"),g.NumberShape.ASCII;switch(F(t)||(0,i.assertFalse)("calc.config.getNumberShape"),2147483632&t){case 1632:return g.NumberShape.ArabicIndic;case 1776:return g.NumberShape.ExtendedArabicIndic;case 2400:return g.NumberShape.Devanagari;case 2528:return g.NumberShape.Bengali;case 2656:return g.NumberShape.Gurmukhi;case 2784:return g.NumberShape.Gujarati;case 2912:return g.NumberShape.Oriya;case 3040:return g.NumberShape.Tamil;case 3168:return g.NumberShape.Telugu;case 3296:return g.NumberShape.Kannada;case 3424:return g.NumberShape.Malayalam;case 3664:return g.NumberShape.Thai;case 3792:return g.NumberShape.Lao;case 3872:return g.NumberShape.Tibetan;case 4160:return g.NumberShape.Myanmar;case 4960:case 4976:return g.NumberShape.Ethiopic;case 6112:return g.NumberShape.Khmer;case 6160:return g.NumberShape.Mongolian;default:return(0,i.assertFalse)("calc.config.getNumberShape")}}Object.defineProperty(t,"PictureColor",{enumerable:!0,get:function(){return p.PictureColor}}),Object.defineProperty(t,"PictureDbnum",{enumerable:!0,get:function(){return p.PictureDbnum}}),Object.defineProperty(t,"PictureSingle",{enumerable:!0,get:function(){return p.PictureSingle}}),Object.defineProperty(t,"PictureSpecial",{enumerable:!0,get:function(){return p.PictureSpecial}}),t.calcConfig=function(e,t=d.RefStyle.A1,r=h.xlMathpack,n=!1,a=!0,i=m.tzUTC,o=m.xlDatepack){return{localeInfo:e,refStyle:t,mathpack:r,date1904:n,dateCompatibility:a,timezone:i,datepack:o}},t.localeInfo=f,function(e){e[e.USA=1]="USA",e[e.UK=44]="UK",e[e.AUS=61]="AUS",e[e.NZ=64]="NZ",e[e.UNK=1]="UNK",e[e.CAN=2]="CAN",e[e.DUT=31]="DUT",e[e.FRN=33]="FRN",e[e.SPA=34]="SPA",e[e.ITN=39]="ITN",e[e.SWE=46]="SWE",e[e.GER=49]="GER",e[e.JPN=81]="JPN",e[e.MEX=52]="MEX",e[e.BRA=55]="BRA",e[e.LAM=3]="LAM",e[e.BEL=32]="BEL",e[e.SWZ=41]="SWZ",e[e.SWG=41]="SWG",e[e.SWF=41]="SWF",e[e.AUT=43]="AUT",e[e.DAN=45]="DAN",e[e.NOR=47]="NOR",e[e.POR=351]="POR",e[e.FIN=358]="FIN",e[e.ICE=354]="ICE",e[e.GRK=30]="GRK",e[e.TUR=90]="TUR",e[e.CZE=420]="CZE",e[e.HUN=36]="HUN",e[e.POL=48]="POL",e[e.RUS=7]="RUS",e[e.HEB=972]="HEB",e[e.ARB=966]="ARB",e[e.PER=981]="PER",e[e.ARB_Algeria=213]="ARB_Algeria",e[e.ARB_Bahrain=966]="ARB_Bahrain",e[e.ARB_Djibouti=253]="ARB_Djibouti",e[e.ARB_Egypt=20]="ARB_Egypt",e[e.ARB_Iraq=964]="ARB_Iraq",e[e.ARB_Jordan=962]="ARB_Jordan",e[e.ARB_Kuwait=965]="ARB_Kuwait",e[e.ARB_Lebanon=961]="ARB_Lebanon",e[e.ARB_Libya=218]="ARB_Libya",e[e.ARB_Mauritania=222]="ARB_Mauritania",e[e.ARB_Morocco=216]="ARB_Morocco",e[e.ARB_Oman=968]="ARB_Oman",e[e.ARB_Qatar=974]="ARB_Qatar",e[e.ARB_SaudiArabia=966]="ARB_SaudiArabia",e[e.ARB_Somalia=1]="ARB_Somalia",e[e.ARB_Sudan=249]="ARB_Sudan",e[e.ARB_Syria=963]="ARB_Syria",e[e.ARB_Tunisia=216]="ARB_Tunisia",e[e.ARB_UAE=971]="ARB_UAE",e[e.ARB_Yemen=969]="ARB_Yemen",e[e.KOR=82]="KOR",e[e.TW=886]="TW",e[e.PRC=86]="PRC",e[e.THA=66]="THA",e[e.VIET=84]="VIET"}(S||(t.Country=S={})),function(e){e[e.None=0]="None",e[e.USA=1033]="USA",e[e.Greek=1032]="Greek",e[e.Hungarian=1038]="Hungarian",e[e.Turkish=1055]="Turkish",e[e.Thailand=1054]="Thailand",e[e.Vietnam=1066]="Vietnam",e[e.Arabic=1025]="Arabic",e[e.Hebrew=1037]="Hebrew",e[e.Tamil=1097]="Tamil",e[e.Syriac=1114]="Syriac",e[e.Iraq=2049]="Iraq",e[e.Algerian=5121]="Algerian",e[e.Basque=1069]="Basque",e[e.PortBrazil=1046]="PortBrazil",e[e.Croatian=1050]="Croatian",e[e.Czech=1029]="Czech",e[e.Danish=1030]="Danish",e[e.Dutch=1043]="Dutch",e[e.Australian=3081]="Australian",e[e.CanadianEnglish=4105]="CanadianEnglish",e[e.British=2057]="British",e[e.Finnish=1035]="Finnish",e[e.French=1036]="French",e[e.FrenchCanadian=3084]="FrenchCanadian",e[e.Italian=1040]="Italian",e[e.NorskBokmal=1044]="NorskBokmal",e[e.NorskNynorsk=2068]="NorskNynorsk",e[e.Polish=1045]="Polish",e[e.PortIberian=2070]="PortIberian",e[e.Romanian=1048]="Romanian",e[e.Russian=1049]="Russian",e[e.Ukrainian=1058]="Ukrainian",e[e.Belarusian=1059]="Belarusian",e[e.SerbianCyrillic=3098]="SerbianCyrillic",e[e.SerbianLatin=2074]="SerbianLatin",e[e.Slovak=1051]="Slovak",e[e.Slovenian=1060]="Slovenian",e[e.SpanishModern=3082]="SpanishModern",e[e.Swedish=1053]="Swedish",e[e.HongKong=3076]="HongKong",e[e.ChinaT=1028]="ChinaT",e[e.Korea=1042]="Korea",e[e.Japan=1041]="Japan",e[e.China=2052]="China",e[e.ChinaStroke=133124]="ChinaStroke",e[e.Devihi=1125]="Devihi",e[e.Hindi=1081]="Hindi",e[e.German=1031]="German",e[e.Swiss=4108]="Swiss",e[e.Indonesia=1057]="Indonesia",e[e.EnglishIndonesia=14345]="EnglishIndonesia",e[e.EnglishIndia=16393]="EnglishIndia",e[e.Singapore=4100]="Singapore",e[e.EnglishSingapore=18441]="EnglishSingapore",e[e.Serbia=9242]="Serbia",e[e.Mexico=2058]="Mexico",e[e.Ireland=6153]="Ireland",e[e.EnglishZimbabwe=12297]="EnglishZimbabwe",e[e.Belgium=2067]="Belgium",e[e.SystemTime=62464]="SystemTime",e[e.SystemLongDate=63488]="SystemLongDate",e[e.EuroTrailing=1]="EuroTrailing",e[e.EuroLeading=2]="EuroLeading",e[e.LANG=1023]="LANG",e[e.COUNTRY=64512]="COUNTRY",e[e.OPTIONS=16711680]="OPTIONS"}(v||(t.LCID=v={})),t.isNumeral=F,t.getOrdinal=y,t.getNumberShape=C;const A=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,2,0,0,2,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,0,0,0,0]);function E(e){const t=0|e;return t>=0&&t<128?A[t]>=2:(0,u.isIdentStart)(t)}function b(e){const t=0|e;return t>=0&&t<128?A[t]>=1:(0,u.isIdentContinue)(t)}let R;t.isIdentStart=E,t.isIdentContinue=b,t.englishErrorNames=(0,s.partialArray)({[c.ErrorType.NULL]:"#NULL!",[c.ErrorType.DIV0]:"#DIV/0!",[c.ErrorType.VALUE]:"#VALUE!",[c.ErrorType.REF]:"#REF!",[c.ErrorType.NAME]:"#NAME?",[c.ErrorType.NUM]:"#NUM!",[c.ErrorType.NA]:"#N/A",[c.ErrorType.GETTING_DATA]:"#GETTING_DATA",[c.ErrorType.SPILL]:"#SPILL!",[c.ErrorType.CONNECT]:"#CONNECT!",[c.ErrorType.BLOCKED]:"#BLOCKED!",[c.ErrorType.UNKNOWN]:"#UNKNOWN!",[c.ErrorType.FIELD]:"#FIELD!",[c.ErrorType.CALC]:"#CALC!",[c.ErrorType.BUSY]:"#BUSY!",[c.ErrorType.EXTERNAL]:"#EXTERNAL!"}),t.englishSpecialRefNames=(0,s.partialArray)({[d.SpecialRefId.All]:"#All",[d.SpecialRefId.Data]:"#Data",[d.SpecialRefId.Headers]:"#Headers",[d.SpecialRefId.Totals]:"#Totals",[d.SpecialRefId.ThisRow]:"#This Row"}),t.englishPictureSpecial=(0,s.partialArray)({[p.PictureSpecial.AP1]:"AM/PM",[p.PictureSpecial.AP2]:"A/P",[p.PictureSpecial.AP3]:"上午/下午",[p.PictureSpecial.General]:"General",[p.PictureSpecial.Currency]:"$"}),t.englishPictureSingle=(0,s.partialArray)({[p.PictureSingle.Sep]:";",[p.PictureSingle.Hash]:"#",[p.PictureSingle.Zero]:"0",[p.PictureSingle.Decimal]:".",[p.PictureSingle.Percent]:"%",[p.PictureSingle.Comma]:",",[p.PictureSingle.Colon]:":",[p.PictureSingle.DateSep]:"/",[p.PictureSingle.Slash]:"/",[p.PictureSingle.Space]:" ",[p.PictureSingle.Minus]:"-",[p.PictureSingle.Plus]:"+",[p.PictureSingle.OpenParen]:"(",[p.PictureSingle.CloseParen]:")",[p.PictureSingle.Backslash]:"\\",[p.PictureSingle.Star]:"*",[p.PictureSingle.Year]:"y",[p.PictureSingle.Month]:"m",[p.PictureSingle.Day]:"d",[p.PictureSingle.Hour]:"h",[p.PictureSingle.Minute]:"m",[p.PictureSingle.Second]:"s",[p.PictureSingle.E]:"E",[p.PictureSingle.APDelim]:"/",[p.PictureSingle.Quote]:'"',[p.PictureSingle.ColorStart]:"[",[p.PictureSingle.ColorEnd]:"]",[p.PictureSingle.Text]:"@",[p.PictureSingle.Question]:"?",[p.PictureSingle.Underscore]:"_",[p.PictureSingle.Reign]:"r",[p.PictureSingle.LocDay]:"a",[p.PictureSingle.Era]:"g",[p.PictureSingle.EraYear]:"e",[p.PictureSingle.BidiDate]:"B",[p.PictureSingle.BidiNum]:"N",[p.PictureSingle.DayTh]:"ว",[p.PictureSingle.MonthTh]:"ด",[p.PictureSingle.YearTh]:"ป",[p.PictureSingle.EngYearTh]:"b",[p.PictureSingle.ThYear]:"ค",[p.PictureSingle.HourTh]:"ช",[p.PictureSingle.MinuteTh]:"น",[p.PictureSingle.SecondTh]:"ท",[p.PictureSingle.ZeroTh]:"๐"}),t.englishPictureColor=(0,s.partialArray)({[p.PictureColor.Black]:"Black",[p.PictureColor.White]:"White",[p.PictureColor.Red]:"Red",[p.PictureColor.Green]:"Green",[p.PictureColor.Blue]:"Blue",[p.PictureColor.Yellow]:"Yellow",[p.PictureColor.Magenta]:"Magenta",[p.PictureColor.Cyan]:"Cyan",[p.PictureColor.Color]:"Color"}),t.englishPictureDbnum=(0,s.partialArray)({[p.PictureDbnum.DBNUM1]:"DBNum1",[p.PictureDbnum.DBNUM2]:"DBNum2",[p.PictureDbnum.DBNUM3]:"DBNum3",[p.PictureDbnum.DBNUM4]:"DBNum4"}),t.englishSysDateFormat="dddd, mmmm dd, yyyy",t.englishSysTimeFormat="h:mm:ss AM/PM",t.englishWorksheetFuncIdToName=function(e){const t=k()[e];return void 0===t?`wsf:${e}`:t},t.englishErrorTypeToName=function(e){const r=t.englishErrorNames[e];return void 0===r?`error.type:${e}`:r},t.englishOperatorIdToName=function(e){if(e===o.OperatorId.Isect)return" ";if(e===o.OperatorId.Union)return",";const t=o.operatorStrings[e];return void 0===t?`op:${e}`:t},t.operatorIdToName=function(e,t,r){return t===o.OperatorId.Isect?r:t===o.OperatorId.Union?e.listSeparator:o.operatorStrings[t]};const T=/_/g;function k(){if(null==R){R=[];for(const e of(0,a.numEnumArray)(o.WorksheetFuncId)){const t=(0,o.getWorksheetFuncEnglishName)(e)??o.WorksheetFuncId[e].replace(T,".");R[e]=t}}return R}function N(e,t){const r=function(e,t){const r=[];return t.forEach(((e,t)=>{null!=e&&r.push([e,t])})),l.ArrayMapTree.create(e).setValues(r)}(e,t);return{getWorksheetFuncId:e=>r.getValue(e),getWorksheetFuncName(e){const r=t[e];return null==r?(0,i.assertFalse)(`calc.config.getWorksheetFuncName: unknown function ID ${e}`):r}}}let I;t.getEnglishWorksheetFuncIdToName=k,t.createWorksheetFuncNameCallbacks=N,t.createIsThousandsPositionCallback=function(e){if(0===e.length||0===e[0])return()=>!1;if(2===e.length&&0===e[1]){const t=e[0];return e=>e>0&&e%t==0}const t=0===e[e.length-1]&&e.length>=2;return r=>{if(r<=0)return!1;let n=r;for(let t=0;t<e.length&&(n-=e[t],!(n<=0));t+=1);return n>0&&t?n%e[e.length-2]==0:0===n}},t.getEnglishLocaleInfo=function(){return null==I&&(I=function(){const e=k(),r=(0,a.makeStringCompareCI)("en-US"),{getWorksheetFuncId:n,getWorksheetFuncName:i}=N(r,e);return f(n,i,F,y,C,(e=>e>0&&e%3==0),E,b,r,t.englishErrorNames,t.englishSpecialRefNames,"TRUE","FALSE","R","C","{","}","[","]","[","]",".",",",",",";",",",";",v.USA,{primary:"en-US",userDefault:"en-US",instLang:"en-US",userCurrent:"en-US"},S.USA,!1,!1,!1,!1,!1,!1,!1,2,!1," ",!1,g.CurrencyFormat.Paren,!0,!1,"$",2,g.DateOrder.MDY,"/","-",!0,!1,!1,!0,":",void 0,!1,!1,!0,["AM","PM"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"],t.englishPictureSpecial,t.englishPictureSingle,t.englishPictureColor,t.englishPictureDbnum,t.englishSysDateFormat,t.englishSysTimeFormat)}()),I}},52292:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xlDatepack=t.TimeGranularity=t.TimeDivision=t.dateTime=t.Rounding=t.tzUTC=t.tzData=void 0;const n=r(60145),a=r(91176),i=r(80168);var o;t.tzData=(0,i.typedInstanceCreator)()(((e,t,r,n,a)=>({bias:e,standardDate:t,standardBias:r,daylightDate:n,daylightBias:a}))),t.tzUTC=(0,t.tzData)(0,void 0,0,void 0,0),t.Rounding=n.dtr.Rounding,t.dateTime=n.dtr.dtr,t.TimeDivision=n.dtr.TimeDivision,function(e){e[e.Year=0]="Year",e[e.Day=1]="Day",e[e.Instant=2]="Instant"}(o||(t.TimeGranularity=o={})),t.xlDatepack={fromNum:function(e,t,r){return n.dtr.fromNum(e.mathpack.toNumber(t),r,e.date1904,e.dateCompatibility)},toNum:function(e,t){const r=n.dtr.toNum(t,e.date1904,e.dateCompatibility);return"number"==typeof r?e.mathpack.fromNumber(r):a.numErrorOper},toNumWithDuration:function(e,t,r,i){const o=n.dtr.toNumWithDuration(t,e.date1904,e.dateCompatibility,r,i);return"number"==typeof o?e.mathpack.fromNumber(o):a.numErrorOper},daysPerMonth:n.dtr.daysPerMonth,toDays:function(e,t){return n.dtr.toDays(t,e.date1904,e.dateCompatibility)},toTime:function(e,t,r,a){return n.dtr.toTime(e.mathpack.toNumber(t),r,a)},utcToLocal:function(e,t,r){return n.dtr.utcToLocal(t,r,e.date1904,e.dateCompatibility)}}},50667:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wsfNode=t.operatorNode=t.lambdaNode=t.lambdaParam=t.paramNode=t.paramDefault=t.paramName=t.flattenLambdaArgs=t.letNode=t.letVar=t.varNode=t.indexedArg=t.flattenLetArgs=t.appNode=t.arrayNode=t.literalNode=t.formulaRootAnnotation=t.localNameDeclAnnotation=t.localNameUseAnnotation=t.formulaSpan=t.multiLineComment=t.singleLineComment=t.formula=t.cellRefBad=t.cellRefCol=t.cellRefRow=t.cellRefRange=t.cellRefSingle=t.cellRefError=t.pos=t.badQualifier=t.sheetRangeQualifier=t.identQualifier=t.sheetQualifier=t.documentQualifier=t.relativeQualifier=t.errorQualifier=t.BadType=t.StructRefKind=t.SpecialRefId=t.NamePartKind=t.NodeKind=t.appHeadNameAnnotation=t.AnnotationKind=t.CommentKind=t.PosKind=t.CellRefKind=t.QualifierKind=t.SyntaxFeature=t.RefStyle=void 0,t.getDepthUpperBound=t.badSequenceNode=t.badCharsNode=t.missingNode=t.identNode=t.structRef=t.badRef=t.missingRef=t.thisRowOpRef=t.commaOpRef=t.rangeOpRef=t.columnRef=t.specialRef=t.structRefNode=t.fieldRef=t.fieldRefNode=t.cellRefNode=t.contextNameNode=t.headNamePart=t.flattenNameParts=t.fieldRefNamePart=t.cellRefNamePart=t.identNamePart=t.nameNode=t.parenNode=void 0;const n=r(72858),a=r(80168),i=r(80168);var o,s,u,l,c,d,g,m,h,p,f,S;function v(e){return void 0!==e.kind}!function(e){e[e.R1C1=1]="R1C1",e[e.A1=2]="A1"}(o||(t.RefStyle=o={})),function(e){e.Comments="Comments",e.Statements="Statements"}(s||(t.SyntaxFeature=s={})),function(e){e.Error="ErrorQualifier",e.Relative="RelativeQualifier",e.Document="DocumentQualifier",e.Sheet="SheetQualifier",e.Ident="IdentQualifier",e.SheetRange="SheetRangeQualifier",e.Bad="BadQualifier"}(u||(t.QualifierKind=u={})),function(e){e.Error="CellRefError",e.Single="CellRefSingle",e.Range="CellRefRange",e.Row="CellRefRow",e.Col="CellRefCol",e.Bad="CellRefBad"}(l||(t.CellRefKind=l={})),function(e){e.Abs="Abs",e.Rel="Rel"}(c||(t.PosKind=c={})),function(e){e.SingleLine="SingleLineComment",e.MultiLine="MultiLineComment"}(d||(t.CommentKind=d={})),function(e){e.LocalNameUse="LocalNameUse",e.LocalNameDecl="LocalNameDecl",e.AppHeadName="AppHeadName",e.FormulaRoot="FormulaRoot"}(g||(t.AnnotationKind=g={})),t.appHeadNameAnnotation={kind:g.AppHeadName},function(e){e.Literal="Literal",e.Array="Array",e.App="App",e.Let="Let",e.Lambda="Lambda",e.Paren="Paren",e.Name="Name",e.CellRef="CellRef",e.FieldRef="FieldRef",e.StructRef="StructRef",e.Missing="Missing",e.BadChars="BadChars",e.BadSequence="BadSequence",e.Operator="Operator",e.WSF="WSF",e.Var="Var",e.Param="Param",e.ContextName="ContextName",e.Ident="Ident",e.ParamName="ParamName",e.ParamDef="ParamDef",e.FieldRefRHS="FieldRefRHS",e.StructRefRHS="StructRefRHS"}(m||(t.NodeKind=m={})),function(e){e.IdentNamePart="IdentNamePart",e.CellRefNamePart="CellRefNamePart",e.FieldRefNamePart="FieldRefNamePart"}(h||(t.NamePartKind=h={})),function(e){e[e.All=1]="All",e[e.Data=2]="Data",e[e.Headers=3]="Headers",e[e.Totals=4]="Totals",e[e.ThisRow=5]="ThisRow"}(p||(t.SpecialRefId=p={})),function(e){e.SpecialRef="SpecialStructRef",e.ColumnRef="ColumnStructRef",e.RangeOpRef="RangeOpStructRef",e.CommaOpRef="CommaOpStructRef",e.ThisRowOpRef="ThisRowOpStructRef",e.MissingRef="MissingStructRef",e.BadRef="BadStructRef"}(f||(t.StructRefKind=f={})),function(e){e.Unexpected="Unexpected",e.Qualifier="Qualifier",e.NumberLiteral="NumberLiteral",e.StringLiteral="StringLiteral",e.ErrorLiteral="ErrorLiteral",e.FieldName="FieldName",e.ParamName="ParamName",e.StructRef="StructRef",e.FieldRef="FieldRef"}(S||(t.BadType=S={})),t.errorQualifier=function(e=0){return{kind:u.Error,isQuoted:!1,isClosed:!0,isTerminated:!0,label:e}},t.relativeQualifier=function(e=0){return{kind:u.Relative,isQuoted:!1,isClosed:!0,isTerminated:!0,label:e}},t.documentQualifier=function(e,t,r=!1,n=0){return{kind:u.Document,isQuoted:r,isClosed:!0,isTerminated:!0,label:n,document:e,path:t}},t.sheetQualifier=function(e,t,r=!1,n=0){return{kind:u.Sheet,isQuoted:r,isClosed:!0,isTerminated:!0,label:n,sheet:e,document:t}},t.identQualifier=function(e,t=!1,r=0){return{kind:u.Ident,isQuoted:t,isClosed:!0,isTerminated:!0,label:r,name:e}},t.sheetRangeQualifier=function(e,t,r,n=!1,a=0){return{kind:u.SheetRange,isQuoted:n,isClosed:!0,isTerminated:!0,label:a,sheet1:e,sheet2:t,document:r}},t.badQualifier=function(e,t=!1,r=!0,n=!0,a=0){return{kind:u.Bad,isQuoted:t,isClosed:r,isTerminated:n,label:a,chars:e}},t.pos=function(e,t){return{kind:e,index:t}},t.cellRefError=function(e=0){return{kind:l.Error,label:e,isBracketed:!1}},t.cellRefSingle=function(e,t,r=!1,n=0){return{kind:l.Single,label:n,row:e,col:t,isBracketed:r}},t.cellRefRange=function(e,t,r=0){const n=e.isBracketed||t.isBracketed;return{kind:l.Range,label:r,ref1:e,ref2:t,isBracketed:n}},t.cellRefRow=function(e,t,r=!1,n=0){return{kind:l.Row,label:n,row1:e,row2:t,isBracketed:r}},t.cellRefCol=function(e,t,r=!1,n=0){return{kind:l.Col,label:n,col1:e,col2:t,isBracketed:r}},t.cellRefBad=function(e,t=!1,r=0){return{kind:l.Bad,label:r,chars:e,isBracketed:t}},t.formula=function(e,t,r,n){return{node:e,spans:t,annotations:r,depthUpperBound:n??k(e)}},t.singleLineComment=function(e,t=0){return{kind:d.SingleLine,label:t,chars:e,isClosed:!0}},t.multiLineComment=function(e,t=!0,r=0){return{kind:d.MultiLine,label:r,chars:e,isClosed:t}},t.formulaSpan=function(e,t,r,a,i,o){return(0,n.assertNatural)("calc.lang.formulaSpan",e),(0,n.assertInteger)("calc.lang.formulaSpan",t),t<e&&(0,n.assertFalse)(`calc.lang.formulaSpan: expected end >= ${e}; given ${t}`),{start:e,end:t,pre:r,post:a,preComments:i,postComments:o}},t.localNameUseAnnotation=function(e,t,r){return{kind:g.LocalNameUse,name:e,whole:t,label:r}},t.localNameDeclAnnotation=function(e,t,r=[]){return{kind:g.LocalNameDecl,name:e,whole:t,uses:r}},t.formulaRootAnnotation=function(e,t){return{kind:g.FormulaRoot,contextNames:e,syntaxFeatures:t}},t.literalNode=function(e,t=!0,r=0){return{kind:m.Literal,label:r,oper:e,isClosed:t}},t.arrayNode=function(e,t=!0,r=0){return{kind:m.Array,label:r,nodes:e,isClosed:t}},t.appNode=function(e,t,r=!0,n=0){return{kind:m.App,label:n,head:e,args:t,isClosed:r}};const F=e=>{const t=[];for(const{arg:r,index:a}of e)(0,n.assertIndex)("calc.lang.flattenNumberedArgs: idx",a,e.length),(0,n.assertTrue)("calc.lang.flattenNumberedArgs: repetition",void 0===t[a]),t[a]=r;return t};function y(e,t,r){return F((0,i.safeConcat)([...void 0===t?[]:[t],...r],e.map((({name:e,binder:t})=>[e,t]))))}function C(e,t){return(0,n.assertNatural)("calc.lang.indexedArg: index",t),{arg:e,index:t}}function A(e,t){return{name:e,binder:t}}function E(e,t,r=[]){return F([...e.map((e=>e.name)),...void 0===t?[]:[t],...r])}function b(e){return{name:e}}t.flattenLetArgs=y,t.indexedArg=C,t.varNode=function(e,t=0){return{kind:m.Var,label:t,name:e,wholeName:e.whole}},t.letVar=A,t.letNode=function(e,t,r,n=[],a=!0,i=0){const o=t.map(((e,t)=>{return r=e,Array.isArray(r)?A(C(e[0],2*t),C(e[1],2*t+1)):e;var r})).sort(((e,t)=>e.name.index-t.name.index)),s=void 0!==r&&v(r)?C(r,2*o.length):r,u=y(o,s,n);return{kind:m.Let,label:i,head:e,args:u,isClosed:a,vars:o,body:s,badArgs:n}},t.flattenLambdaArgs=E,t.paramName=function(e,t,r=!0,n=0){return{kind:m.ParamName,label:n,name:e,isBracketed:t,isClosed:r}},t.paramDefault=function(e,t=0){return{kind:m.ParamDef,label:t,rhs:e}},t.paramNode=function(e,t,r=0){return{kind:m.Param,label:r,name:e,wholeName:e.name.kind===m.Ident?e.name.whole:void 0,def:t,isOptional:e.isBracketed||void 0!==t}},t.lambdaParam=b,t.lambdaNode=function(e,t,r,n=[],a=!0,i=0){const o=t.map(((e,t)=>v(e)?b(C(e,t)):e)).sort(((e,t)=>e.name.index-t.name.index)),s=void 0!==r&&v(r)?C(r,o.length):r,u=E(o,s,n);return{kind:m.Lambda,label:i,head:e,args:u,isClosed:a,params:o,body:s,badArgs:n}},t.operatorNode=function(e,t=0){return{kind:m.Operator,label:t,id:e}},t.wsfNode=function(e,t,r=0){return{kind:m.WSF,label:r,id:e,whole:t}},t.parenNode=function(e,t=!0,r=0){return{kind:m.Paren,label:r,node:e,isClosed:t}},t.nameNode=function(e,t,r=0){return{kind:m.Name,label:r,whole:e.asWhole,parts:e,qualifier:t}},t.identNamePart=function(e,t=!0,r=0,n=0){return{kind:h.IdentNamePart,label:r,qualifiedLabel:n,asWhole:e,canDenoteNamedObject:t}},t.cellRefNamePart=function(e,t,r=0,n=0){return{kind:h.CellRefNamePart,label:r,qualifiedLabel:n,asWhole:t,canDenoteNamedObject:!1,ref:e}},t.fieldRefNamePart=function(e,t,r=!0,a=0,i=0){return(0,n.assertTrue)("calc.lang.fieldRefNamePart",t.isClosed&&!t.isBracketed),{kind:h.FieldRefNamePart,label:a,qualifiedLabel:i,asWhole:e.asWhole+"."+(t.field.kind===m.Ident?t.field.whole:t.field.chars),canDenoteNamedObject:r,lhs:e,rhs:t}},t.flattenNameParts=function(e){const t=[e];let r=t[0];for(;r.kind===h.FieldRefNamePart;)t.push(r.lhs),r=r.lhs;return t.reverse(),{kind:r.kind,parts:t}},t.headNamePart=function(e){let t=e;for(;t.kind===h.FieldRefNamePart;)t=t.lhs;return t},t.contextNameNode=function(e,t=0){return{kind:m.ContextName,label:t,whole:e}},t.cellRefNode=function(e,t,r=0){return{kind:m.CellRef,label:r,ref:e,qualifier:t}},t.fieldRefNode=function(e,t,r=0){return{kind:m.FieldRef,label:r,lhs:e,rhs:t}},t.fieldRef=function(e,t=!1,r=!0,n=!1,a=0){return{kind:m.FieldRefRHS,label:a,field:e,isBracketed:t,isClosed:r,shouldBeBracketed:n}},t.structRefNode=function(e,t,r=0){return{kind:m.StructRef,label:r,lhs:e,rhs:t}},t.specialRef=function(e,t=!1,r=!0,n=0){return{kind:f.SpecialRef,label:n,id:e,isBracketed:t,isClosed:r}},t.columnRef=function(e,t=!1,r=!0,n=0){return{kind:f.ColumnRef,label:n,name:e,isBracketed:t,isClosed:r}},t.rangeOpRef=function(e,t,r=0){return{kind:f.RangeOpRef,label:r,lhs:e,rhs:t}},t.commaOpRef=function(e,t=0){const r={[p.All]:!1,[p.Data]:!1,[p.Headers]:!1,[p.Totals]:!1,[p.ThisRow]:!1},n=[];for(const t of e)switch(t.kind){case f.SpecialRef:r[t.id]=!0;break;case f.ColumnRef:case f.RangeOpRef:n.push(t)}return{kind:f.CommaOpRef,label:t,refs:e,specialRefs:r,columnRefs:n}},t.thisRowOpRef=function(e,t=0){return{kind:f.ThisRowOpRef,label:t,ref:e}},t.missingRef=function(e=0){return{kind:f.MissingRef,label:e}},t.badRef=function(e,t=!1,r=!0,n=0){return{kind:f.BadRef,chars:e,isBracketed:t,isClosed:r,label:n}},t.structRef=function(e,t=!0,r=0){return{kind:m.StructRefRHS,label:r,isClosed:t,innerRef:e}},t.identNode=function(e,t=0){return{kind:m.Ident,label:t,whole:e}},t.missingNode=function(e="",t=0){return{kind:m.Missing,label:t,chars:e}},t.badCharsNode=function(e,t,r=0){return{kind:m.BadChars,label:r,type:e,chars:t}},t.badSequenceNode=function(e,t,r=0){return{kind:m.BadSequence,label:r,type:e,contents:t}};const R=50;function T(e,t){if(t>R)return 1/0;switch(e.kind){case m.Array:{let r=0;for(const n of e.nodes)for(const e of n)r=(0,a.fastMax)(r,T(e,t+1));return r+1}case m.Param:return void 0===e.def?1:T(e.def.rhs,t+1)+1;case m.Let:case m.Lambda:case m.App:{let r=T(e.head,t+1);for(const n of e.args)r=(0,a.fastMax)(r,T(n,t+1));return r+1}case m.Paren:return T(e.node,t+1)+1;case m.FieldRef:return T(e.lhs,t+1)+1;case m.Var:case m.Name:case m.CellRef:case m.StructRef:case m.Literal:case m.Operator:case m.WSF:case m.Missing:case m.BadChars:return 1;case m.BadSequence:{let r=0;for(const n of e.contents)r=(0,a.fastMax)(r,T(n,t+1));return r+1}default:return(0,n.assertNever)("calc.lang.getDepthUpperBound",e)}}function k(e){return T(e,0)}t.getDepthUpperBound=k},24386:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isIdentContinue=t.isIdentStart=void 0;var n=r(91092).unicode.makeIsInClass;t.isIdentStart=n([65,91,92,93,95,96,97,123,161,162,164,165,167,169,170,171,173,174,175,187,188,697,699,706,711,712,713,716,717,718,720,722,728,732,733,734,736,741,750,751,880,884,886,888,890,894,902,903,904,907,908,909,910,930,931,1014,1015,1154,1162,1316,1329,1367,1369,1370,1377,1416,1488,1515,1520,1523,1569,1611,1646,1648,1649,1748,1749,1750,1765,1767,1774,1776,1786,1789,1791,1792,1808,1809,1810,1840,1869,1958,1969,1970,1994,2027,2036,2038,2042,2043,2308,2362,2365,2366,2384,2385,2392,2402,2417,2419,2427,2432,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2493,2494,2510,2511,2524,2526,2527,2530,2544,2546,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2649,2653,2654,2655,2674,2677,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2749,2750,2768,2769,2784,2786,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2877,2878,2908,2910,2911,2914,2929,2930,2947,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3024,3025,3077,3085,3086,3089,3090,3113,3114,3124,3125,3130,3133,3134,3160,3162,3168,3170,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3261,3262,3294,3295,3296,3298,3333,3341,3342,3345,3346,3369,3370,3386,3389,3390,3424,3426,3450,3456,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3585,3643,3648,3663,3713,3715,3716,3717,3719,3721,3722,3723,3725,3726,3732,3736,3737,3744,3745,3748,3749,3750,3751,3752,3754,3756,3757,3761,3762,3764,3773,3774,3776,3781,3782,3783,3804,3806,3840,3841,3904,3912,3913,3949,3976,3980,4096,4139,4159,4160,4176,4182,4186,4190,4193,4194,4197,4199,4206,4209,4213,4226,4238,4239,4256,4294,4304,4347,4348,4349,4352,4442,4447,4515,4520,4602,4608,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4992,5008,5024,5109,5121,5741,5743,5751,5761,5787,5792,5867,5870,5873,5888,5901,5902,5906,5920,5938,5952,5970,5984,5997,5998,6001,6016,6068,6103,6104,6108,6109,6176,6264,6272,6313,6314,6315,6400,6429,6480,6510,6512,6517,6528,6570,6593,6600,6656,6679,6917,6964,6981,6988,7043,7073,7086,7088,7168,7204,7245,7248,7258,7294,7424,7616,7680,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8125,8126,8127,8130,8133,8134,8141,8144,8148,8150,8156,8160,8173,8178,8181,8182,8189,8208,8209,8211,8215,8216,8218,8220,8222,8224,8226,8229,8232,8240,8241,8242,8244,8245,8246,8251,8252,8305,8306,8308,8309,8319,8320,8321,8325,8336,8341,8450,8452,8453,8454,8455,8456,8457,8468,8469,8471,8473,8478,8481,8483,8484,8485,8486,8487,8488,8489,8490,8494,8495,8506,8508,8512,8517,8522,8526,8527,8531,8533,8539,8543,8544,8585,8592,8602,8658,8659,8660,8661,8704,8705,8706,8708,8711,8713,8715,8716,8719,8720,8721,8722,8725,8726,8730,8731,8733,8737,8739,8740,8741,8742,8743,8749,8750,8751,8756,8760,8764,8766,8776,8777,8780,8781,8786,8787,8800,8802,8804,8808,8810,8812,8814,8816,8834,8836,8838,8840,8853,8854,8857,8858,8869,8870,8895,8896,8978,8979,9312,9398,9424,9450,9472,9548,9552,9589,9601,9616,9618,9622,9632,9634,9635,9642,9650,9652,9654,9656,9660,9662,9664,9666,9670,9673,9675,9676,9678,9682,9698,9702,9711,9712,9733,9735,9737,9738,9742,9744,9756,9757,9758,9759,9792,9793,9794,9795,9824,9826,9827,9830,9831,9835,9836,9838,9839,9840,11264,11311,11312,11359,11360,11376,11377,11390,11392,11493,11520,11558,11568,11622,11631,11632,11648,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,12288,12292,12293,12312,12317,12320,12321,12330,12337,12342,12344,12349,12353,12439,12443,12448,12449,12544,12549,12590,12593,12687,12704,12728,12784,12829,12832,12842,12849,12851,12857,12858,12896,12924,12927,12928,12963,12969,13059,13060,13069,13070,13076,13077,13080,13081,13090,13092,13094,13096,13099,13100,13110,13111,13115,13116,13129,13131,13133,13134,13137,13138,13143,13144,13179,13183,13184,13189,13192,13259,13261,13268,13269,13271,13272,13273,13275,13278,13312,19894,19968,40900,40960,42125,42240,42509,42512,42528,42538,42540,42560,42592,42594,42607,42624,42648,42786,42888,42891,42893,43003,43010,43011,43014,43015,43019,43020,43043,43072,43124,43138,43188,43274,43302,43312,43335,43520,43561,43584,43587,43588,43596,44032,55204,57344,63561,63744,64046,64048,64107,64112,64218,64256,64263,64275,64280,64285,64286,64287,64297,64298,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64434,64467,64830,64848,64912,64914,64968,65008,65020,65072,65074,65075,65093,65097,65107,65108,65112,65113,65127,65128,65132,65136,65141,65142,65277,65281,65375,65377,65471,65474,65480,65482,65488,65490,65496,65498,65501,65504,65511]),t.isIdentContinue=n([48,58,63,64,65,91,92,93,95,96,97,123,161,162,164,165,167,169,170,171,173,174,175,187,188,888,890,894,900,903,904,907,908,909,910,930,931,1316,1329,1367,1369,1370,1377,1416,1425,1470,1471,1472,1473,1475,1476,1478,1479,1480,1488,1515,1520,1523,1536,1540,1542,1545,1547,1548,1550,1563,1567,1568,1569,1631,1632,1642,1646,1748,1749,1792,1807,1867,1869,1970,1984,2039,2042,2043,2305,2362,2364,2382,2384,2389,2392,2404,2406,2416,2417,2419,2427,2432,2433,2436,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2492,2501,2503,2505,2507,2511,2519,2520,2524,2526,2527,2532,2534,2555,2561,2564,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2620,2621,2622,2627,2631,2633,2635,2638,2641,2642,2649,2653,2654,2655,2662,2678,2689,2692,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2748,2758,2759,2762,2763,2766,2768,2769,2784,2788,2790,2800,2801,2802,2817,2820,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2876,2885,2887,2889,2891,2894,2902,2904,2908,2910,2911,2916,2918,2930,2946,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3006,3011,3014,3017,3018,3022,3024,3025,3031,3032,3046,3067,3073,3076,3077,3085,3086,3089,3090,3113,3114,3124,3125,3130,3133,3141,3142,3145,3146,3150,3157,3159,3160,3162,3168,3172,3174,3184,3192,3200,3202,3204,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3260,3269,3270,3273,3274,3278,3285,3287,3294,3295,3296,3300,3302,3312,3313,3315,3330,3332,3333,3341,3342,3345,3346,3369,3370,3386,3389,3397,3398,3401,3402,3406,3415,3416,3424,3428,3430,3446,3449,3456,3458,3460,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3530,3531,3535,3541,3542,3543,3544,3552,3570,3572,3585,3643,3647,3663,3664,3674,3713,3715,3716,3717,3719,3721,3722,3723,3725,3726,3732,3736,3737,3744,3745,3748,3749,3750,3751,3752,3754,3756,3757,3770,3771,3774,3776,3781,3782,3783,3784,3790,3792,3802,3804,3806,3840,3844,3859,3898,3902,3912,3913,3949,3953,3973,3974,3980,3984,3992,3993,4029,4030,4045,4046,4048,4096,4170,4176,4250,4254,4294,4304,4347,4348,4349,4352,4442,4447,4515,4520,4602,4608,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4959,4961,4969,4989,4992,5018,5024,5109,5121,5741,5743,5751,5760,5787,5792,5867,5870,5873,5888,5901,5902,5909,5920,5941,5952,5972,5984,5997,5998,6001,6002,6004,6016,6100,6103,6104,6107,6110,6112,6122,6128,6138,6155,6159,6160,6170,6176,6264,6272,6315,6400,6429,6432,6444,6448,6460,6464,6465,6470,6510,6512,6517,6528,6570,6576,6602,6608,6618,6624,6684,6912,6988,6992,7002,7009,7037,7040,7083,7086,7098,7168,7224,7232,7242,7245,7294,7424,7655,7678,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8133,8134,8148,8150,8156,8157,8176,8178,8181,8182,8191,8192,8209,8211,8215,8216,8218,8220,8222,8224,8226,8229,8241,8242,8244,8245,8246,8251,8252,8260,8261,8274,8275,8287,8293,8298,8306,8308,8317,8319,8333,8336,8341,8352,8374,8400,8433,8448,8528,8531,8585,8592,9001,9003,9192,9216,9255,9280,9291,9312,9886,9888,9917,9920,9924,9985,9989,9990,9994,9996,10024,10025,10060,10061,10062,10063,10067,10070,10071,10072,10079,10081,10088,10102,10133,10136,10160,10161,10175,10176,10181,10183,10187,10188,10189,10192,10214,10224,10627,10649,10712,10716,10748,10750,11085,11088,11093,11264,11311,11312,11359,11360,11376,11377,11390,11392,11499,11517,11518,11520,11558,11568,11622,11631,11632,11648,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,11744,11776,11823,11824,11904,11930,11931,12020,12032,12246,12272,12284,12288,12312,12317,12336,12337,12349,12350,12352,12353,12439,12441,12448,12449,12544,12549,12590,12593,12687,12688,12728,12736,12772,12784,12831,12832,12868,12880,13055,13056,19894,19904,40900,40960,42125,42128,42183,42240,42509,42512,42540,42560,42592,42594,42611,42620,42622,42623,42648,42752,42893,43003,43052,43072,43124,43136,43205,43216,43226,43264,43311,43312,43348,43520,43575,43584,43598,43600,43610,44032,55204,57344,64046,64048,64107,64112,64218,64256,64263,64275,64280,64285,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64434,64467,64830,64848,64912,64914,64968,65008,65022,65024,65040,65056,65063,65072,65074,65075,65093,65097,65107,65108,65112,65113,65127,65128,65132,65136,65141,65142,65277,65279,65280,65281,65375,65377,65471,65474,65480,65482,65488,65490,65496,65498,65501,65504,65511,65512,65519,65529,65534])},89208:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.worksheetFuncTypes=t.worksheetFuncEnglishNames=t.WorksheetFuncId=void 0;const n=r(61824);var a;!function(e){e[e.COUNT=0]="COUNT",e[e.IF=1]="IF",e[e.ISNA=2]="ISNA",e[e.ISERROR=3]="ISERROR",e[e.SUM=4]="SUM",e[e.AVERAGE=5]="AVERAGE",e[e.MIN=6]="MIN",e[e.MAX=7]="MAX",e[e.ROW=8]="ROW",e[e.COLUMN=9]="COLUMN",e[e.NA=10]="NA",e[e.NPV=11]="NPV",e[e.STDEV=12]="STDEV",e[e.DOLLAR=13]="DOLLAR",e[e.FIXED=14]="FIXED",e[e.SIN=15]="SIN",e[e.COS=16]="COS",e[e.TAN=17]="TAN",e[e.ATAN=18]="ATAN",e[e.PI=19]="PI",e[e.SQRT=20]="SQRT",e[e.EXP=21]="EXP",e[e.LN=22]="LN",e[e.LOG10=23]="LOG10",e[e.ABS=24]="ABS",e[e.INT=25]="INT",e[e.SIGN=26]="SIGN",e[e.ROUND=27]="ROUND",e[e.LOOKUP=28]="LOOKUP",e[e.INDEX=29]="INDEX",e[e.REPT=30]="REPT",e[e.MID=31]="MID",e[e.LEN=32]="LEN",e[e.VALUE=33]="VALUE",e[e.TRUE=34]="TRUE",e[e.FALSE=35]="FALSE",e[e.AND=36]="AND",e[e.OR=37]="OR",e[e.NOT=38]="NOT",e[e.MOD=39]="MOD",e[e.DCOUNT=40]="DCOUNT",e[e.DSUM=41]="DSUM",e[e.DAVERAGE=42]="DAVERAGE",e[e.DMIN=43]="DMIN",e[e.DMAX=44]="DMAX",e[e.DSTDEV=45]="DSTDEV",e[e.VAR=46]="VAR",e[e.DVAR=47]="DVAR",e[e.TEXT=48]="TEXT",e[e.LINEST=49]="LINEST",e[e.TREND=50]="TREND",e[e.LOGEST=51]="LOGEST",e[e.GROWTH=52]="GROWTH",e[e.GOTO=53]="GOTO",e[e.HALT=54]="HALT",e[e.RETURN=55]="RETURN",e[e.PV=56]="PV",e[e.FV=57]="FV",e[e.NPER=58]="NPER",e[e.PMT=59]="PMT",e[e.RATE=60]="RATE",e[e.MIRR=61]="MIRR",e[e.IRR=62]="IRR",e[e.RAND=63]="RAND",e[e.MATCH=64]="MATCH",e[e.DATE=65]="DATE",e[e.TIME=66]="TIME",e[e.DAY=67]="DAY",e[e.MONTH=68]="MONTH",e[e.YEAR=69]="YEAR",e[e.WEEKDAY=70]="WEEKDAY",e[e.HOUR=71]="HOUR",e[e.MINUTE=72]="MINUTE",e[e.SECOND=73]="SECOND",e[e.NOW=74]="NOW",e[e.AREAS=75]="AREAS",e[e.ROWS=76]="ROWS",e[e.COLUMNS=77]="COLUMNS",e[e.OFFSET=78]="OFFSET",e[e.ABSREF=79]="ABSREF",e[e.RELREF=80]="RELREF",e[e.ARGUMENT=81]="ARGUMENT",e[e.SEARCH=82]="SEARCH",e[e.TRANSPOSE=83]="TRANSPOSE",e[e.ERROR=84]="ERROR",e[e.STEP=85]="STEP",e[e.TYPE=86]="TYPE",e[e.ECHO=87]="ECHO",e[e.SET_NAME=88]="SET_NAME",e[e.CALLER=89]="CALLER",e[e.DEREF=90]="DEREF",e[e.WINDOWS=91]="WINDOWS",e[e.SERIES=92]="SERIES",e[e.DOCUMENTS=93]="DOCUMENTS",e[e.ACTIVE_CELL=94]="ACTIVE_CELL",e[e.SELECTION=95]="SELECTION",e[e.RESULT=96]="RESULT",e[e.ATAN2=97]="ATAN2",e[e.ASIN=98]="ASIN",e[e.ACOS=99]="ACOS",e[e.CHOOSE=100]="CHOOSE",e[e.HLOOKUP=101]="HLOOKUP",e[e.VLOOKUP=102]="VLOOKUP",e[e.LINKS=103]="LINKS",e[e.INPUT=104]="INPUT",e[e.ISREF=105]="ISREF",e[e.GET_FORMULA=106]="GET_FORMULA",e[e.GET_NAME=107]="GET_NAME",e[e.SET_VALUE=108]="SET_VALUE",e[e.LOG=109]="LOG",e[e.EXEC=110]="EXEC",e[e.CHAR=111]="CHAR",e[e.LOWER=112]="LOWER",e[e.UPPER=113]="UPPER",e[e.PROPER=114]="PROPER",e[e.LEFT=115]="LEFT",e[e.RIGHT=116]="RIGHT",e[e.EXACT=117]="EXACT",e[e.TRIM=118]="TRIM",e[e.REPLACE=119]="REPLACE",e[e.SUBSTITUTE=120]="SUBSTITUTE",e[e.CODE=121]="CODE",e[e.NAMES=122]="NAMES",e[e.DIRECTORY=123]="DIRECTORY",e[e.FIND=124]="FIND",e[e.CELL=125]="CELL",e[e.ISERR=126]="ISERR",e[e.ISTEXT=127]="ISTEXT",e[e.ISNUMBER=128]="ISNUMBER",e[e.ISBLANK=129]="ISBLANK",e[e.T=130]="T",e[e.N=131]="N",e[e.FOPEN=132]="FOPEN",e[e.FCLOSE=133]="FCLOSE",e[e.FSIZE=134]="FSIZE",e[e.FREADLN=135]="FREADLN",e[e.FREAD=136]="FREAD",e[e.FWRITELN=137]="FWRITELN",e[e.FWRITE=138]="FWRITE",e[e.FPOS=139]="FPOS",e[e.DATEVALUE=140]="DATEVALUE",e[e.TIMEVALUE=141]="TIMEVALUE",e[e.SLN=142]="SLN",e[e.SYD=143]="SYD",e[e.DDB=144]="DDB",e[e.GET_DEF=145]="GET_DEF",e[e.REFTEXT=146]="REFTEXT",e[e.TEXTREF=147]="TEXTREF",e[e.INDIRECT=148]="INDIRECT",e[e.REGISTER=149]="REGISTER",e[e.CALL=150]="CALL",e[e.ADD_BAR=151]="ADD_BAR",e[e.ADD_MENU=152]="ADD_MENU",e[e.ADD_COMMAND=153]="ADD_COMMAND",e[e.ENABLE_COMMAND=154]="ENABLE_COMMAND",e[e.CHECK_COMMAND=155]="CHECK_COMMAND",e[e.RENAME_COMMAND=156]="RENAME_COMMAND",e[e.SHOW_BAR=157]="SHOW_BAR",e[e.DELETE_MENU=158]="DELETE_MENU",e[e.DELETE_COMMAND=159]="DELETE_COMMAND",e[e.GET_CHART_ITEM=160]="GET_CHART_ITEM",e[e.DIALOG_BOX=161]="DIALOG_BOX",e[e.CLEAN=162]="CLEAN",e[e.MDETERM=163]="MDETERM",e[e.MINVERSE=164]="MINVERSE",e[e.MMULT=165]="MMULT",e[e.FILES=166]="FILES",e[e.IPMT=167]="IPMT",e[e.PPMT=168]="PPMT",e[e.COUNTA=169]="COUNTA",e[e.CANCEL_KEY=170]="CANCEL_KEY",e[e.FOR=171]="FOR",e[e.WHILE=172]="WHILE",e[e.BREAK=173]="BREAK",e[e.NEXT=174]="NEXT",e[e.INITIATE=175]="INITIATE",e[e.REQUEST=176]="REQUEST",e[e.POKE=177]="POKE",e[e.EXECUTE=178]="EXECUTE",e[e.TERMINATE=179]="TERMINATE",e[e.RESTART=180]="RESTART",e[e.HELP=181]="HELP",e[e.GET_BAR=182]="GET_BAR",e[e.PRODUCT=183]="PRODUCT",e[e.FACT=184]="FACT",e[e.GET_CELL=185]="GET_CELL",e[e.GET_WORKSPACE=186]="GET_WORKSPACE",e[e.GET_WINDOW=187]="GET_WINDOW",e[e.GET_DOCUMENT=188]="GET_DOCUMENT",e[e.DPRODUCT=189]="DPRODUCT",e[e.ISNONTEXT=190]="ISNONTEXT",e[e.GET_NOTE=191]="GET_NOTE",e[e.NOTE=192]="NOTE",e[e.STDEVP=193]="STDEVP",e[e.VARP=194]="VARP",e[e.DSTDEVP=195]="DSTDEVP",e[e.DVARP=196]="DVARP",e[e.TRUNC=197]="TRUNC",e[e.ISLOGICAL=198]="ISLOGICAL",e[e.DCOUNTA=199]="DCOUNTA",e[e.DELETE_BAR=200]="DELETE_BAR",e[e.UNREGISTER=201]="UNREGISTER",e[e.USDOLLAR=204]="USDOLLAR",e[e.FINDB=205]="FINDB",e[e.SEARCHB=206]="SEARCHB",e[e.REPLACEB=207]="REPLACEB",e[e.LEFTB=208]="LEFTB",e[e.RIGHTB=209]="RIGHTB",e[e.MIDB=210]="MIDB",e[e.LENB=211]="LENB",e[e.ROUNDUP=212]="ROUNDUP",e[e.ROUNDDOWN=213]="ROUNDDOWN",e[e.ASC=214]="ASC",e[e.DBCS=215]="DBCS",e[e.RANK=216]="RANK",e[e.ADDRESS=219]="ADDRESS",e[e.DAYS360=220]="DAYS360",e[e.TODAY=221]="TODAY",e[e.VDB=222]="VDB",e[e.ELSE=223]="ELSE",e[e.ELSE_IF=224]="ELSE_IF",e[e.END_IF=225]="END_IF",e[e.FOR_CELL=226]="FOR_CELL",e[e.MEDIAN=227]="MEDIAN",e[e.SUMPRODUCT=228]="SUMPRODUCT",e[e.SINH=229]="SINH",e[e.COSH=230]="COSH",e[e.TANH=231]="TANH",e[e.ASINH=232]="ASINH",e[e.ACOSH=233]="ACOSH",e[e.ATANH=234]="ATANH",e[e.DGET=235]="DGET",e[e.CREATE_OBJECT=236]="CREATE_OBJECT",e[e.VOLATILE=237]="VOLATILE",e[e.LAST_ERROR=238]="LAST_ERROR",e[e.CUSTOM_UNDO=239]="CUSTOM_UNDO",e[e.CUSTOM_REPEAT=240]="CUSTOM_REPEAT",e[e.FORMULA_CONVERT=241]="FORMULA_CONVERT",e[e.GET_LINK_INFO=242]="GET_LINK_INFO",e[e.TEXT_BOX=243]="TEXT_BOX",e[e.INFO=244]="INFO",e[e.GROUP=245]="GROUP",e[e.GET_OBJECT=246]="GET_OBJECT",e[e.DB=247]="DB",e[e.PAUSE=248]="PAUSE",e[e.RESUME=251]="RESUME",e[e.FREQUENCY=252]="FREQUENCY",e[e.ADD_TOOLBAR=253]="ADD_TOOLBAR",e[e.DELETE_TOOLBAR=254]="DELETE_TOOLBAR",e[e._UDF=255]="_UDF",e[e.RESET_TOOLBAR=256]="RESET_TOOLBAR",e[e.EVALUATE=257]="EVALUATE",e[e.GET_TOOLBAR=258]="GET_TOOLBAR",e[e.GET_TOOL=259]="GET_TOOL",e[e.SPELLING_CHECK=260]="SPELLING_CHECK",e[e.ERROR_TYPE=261]="ERROR_TYPE",e[e.APP_TITLE=262]="APP_TITLE",e[e.WINDOW_TITLE=263]="WINDOW_TITLE",e[e.SAVE_TOOLBAR=264]="SAVE_TOOLBAR",e[e.ENABLE_TOOL=265]="ENABLE_TOOL",e[e.PRESS_TOOL=266]="PRESS_TOOL",e[e.REGISTER_ID=267]="REGISTER_ID",e[e.GET_PROJECT=268]="GET_PROJECT",e[e.AVEDEV=269]="AVEDEV",e[e.BETADIST=270]="BETADIST",e[e.GAMMALN=271]="GAMMALN",e[e.BETAINV=272]="BETAINV",e[e.BINOMDIST=273]="BINOMDIST",e[e.CHIDIST=274]="CHIDIST",e[e.CHIINV=275]="CHIINV",e[e.COMBIN=276]="COMBIN",e[e.CONFIDENCE=277]="CONFIDENCE",e[e.CRITBINOM=278]="CRITBINOM",e[e.EVEN=279]="EVEN",e[e.EXPONDIST=280]="EXPONDIST",e[e.FDIST=281]="FDIST",e[e.FINV=282]="FINV",e[e.FISHER=283]="FISHER",e[e.FISHERINV=284]="FISHERINV",e[e.FLOOR=285]="FLOOR",e[e.GAMMADIST=286]="GAMMADIST",e[e.GAMMAINV=287]="GAMMAINV",e[e.CEILING=288]="CEILING",e[e.HYPGEOMDIST=289]="HYPGEOMDIST",e[e.LOGNORMDIST=290]="LOGNORMDIST",e[e.LOGINV=291]="LOGINV",e[e.NEGBINOMDIST=292]="NEGBINOMDIST",e[e.NORMDIST=293]="NORMDIST",e[e.NORMSDIST=294]="NORMSDIST",e[e.NORMINV=295]="NORMINV",e[e.NORMSINV=296]="NORMSINV",e[e.STANDARDIZE=297]="STANDARDIZE",e[e.ODD=298]="ODD",e[e.PERMUT=299]="PERMUT",e[e.POISSON=300]="POISSON",e[e.TDIST=301]="TDIST",e[e.WEIBULL=302]="WEIBULL",e[e.SUMXMY2=303]="SUMXMY2",e[e.SUMX2MY2=304]="SUMX2MY2",e[e.SUMX2PY2=305]="SUMX2PY2",e[e.CHITEST=306]="CHITEST",e[e.CORREL=307]="CORREL",e[e.COVAR=308]="COVAR",e[e.FORECAST=309]="FORECAST",e[e.FTEST=310]="FTEST",e[e.INTERCEPT=311]="INTERCEPT",e[e.PEARSON=312]="PEARSON",e[e.RSQ=313]="RSQ",e[e.STEYX=314]="STEYX",e[e.SLOPE=315]="SLOPE",e[e.TTEST=316]="TTEST",e[e.PROB=317]="PROB",e[e.DEVSQ=318]="DEVSQ",e[e.GEOMEAN=319]="GEOMEAN",e[e.HARMEAN=320]="HARMEAN",e[e.SUMSQ=321]="SUMSQ",e[e.KURT=322]="KURT",e[e.SKEW=323]="SKEW",e[e.ZTEST=324]="ZTEST",e[e.LARGE=325]="LARGE",e[e.SMALL=326]="SMALL",e[e.QUARTILE=327]="QUARTILE",e[e.PERCENTILE=328]="PERCENTILE",e[e.PERCENTRANK=329]="PERCENTRANK",e[e.MODE=330]="MODE",e[e.TRIMMEAN=331]="TRIMMEAN",e[e.TINV=332]="TINV",e[e.MOVIE_COMMAND=334]="MOVIE_COMMAND",e[e.GET_MOVIE=335]="GET_MOVIE",e[e.CONCATENATE=336]="CONCATENATE",e[e.POWER=337]="POWER",e[e.SPREADBASE_DATA_FIELD=338]="SPREADBASE_DATA_FIELD",e[e.GET_VIEW=339]="GET_VIEW",e[e.GET_FIELD=340]="GET_FIELD",e[e.GET_ITEM=341]="GET_ITEM",e[e.RADIANS=342]="RADIANS",e[e.DEGREES=343]="DEGREES",e[e.SUBTOTAL=344]="SUBTOTAL",e[e.SUMIF=345]="SUMIF",e[e.COUNTIF=346]="COUNTIF",e[e.COUNTBLANK=347]="COUNTBLANK",e[e.SCENARIO_GET=348]="SCENARIO_GET",e[e.OPTIONS_LISTS=349]="OPTIONS_LISTS",e[e.ISPMT=350]="ISPMT",e[e.DATEDIF=351]="DATEDIF",e[e.DATESTRING=352]="DATESTRING",e[e.NUMBERSTRING=353]="NUMBERSTRING",e[e.ROMAN=354]="ROMAN",e[e.OPENDIALOG=355]="OPENDIALOG",e[e.SAVEDIALOG=356]="SAVEDIALOG",e[e.VIEW_GET=357]="VIEW_GET",e[e.GETPIVOTDATA=358]="GETPIVOTDATA",e[e.HYPERLINK=359]="HYPERLINK",e[e.FURIGANA=360]="FURIGANA",e[e.AVERAGEA=361]="AVERAGEA",e[e.MAXA=362]="MAXA",e[e.MINA=363]="MINA",e[e.STDEVPA=364]="STDEVPA",e[e.VARPA=365]="VARPA",e[e.STDEVA=366]="STDEVA",e[e.VARA=367]="VARA",e[e.BAHTTEXT=368]="BAHTTEXT",e[e.THAIDOW=369]="THAIDOW",e[e.THAIDIGIT=370]="THAIDIGIT",e[e.THAIMOY=371]="THAIMOY",e[e.THAINUMSOUND=372]="THAINUMSOUND",e[e.THAINUMSTRING=373]="THAINUMSTRING",e[e.THAISTRINGLENGTH=374]="THAISTRINGLENGTH",e[e.ISTHAIDIGIT=375]="ISTHAIDIGIT",e[e.ROUNDBAHTDOWN=376]="ROUNDBAHTDOWN",e[e.ROUNDBAHTUP=377]="ROUNDBAHTUP",e[e.THAIYEAR=378]="THAIYEAR",e[e.RTD=379]="RTD",e[e.CUBEVALUE=380]="CUBEVALUE",e[e.CUBEMEMBER=381]="CUBEMEMBER",e[e.CUBEMEMBERPROPERTY=382]="CUBEMEMBERPROPERTY",e[e.CUBERANKEDMEMBER=383]="CUBERANKEDMEMBER",e[e.HEX2BIN=384]="HEX2BIN",e[e.HEX2DEC=385]="HEX2DEC",e[e.HEX2OCT=386]="HEX2OCT",e[e.DEC2BIN=387]="DEC2BIN",e[e.DEC2HEX=388]="DEC2HEX",e[e.DEC2OCT=389]="DEC2OCT",e[e.OCT2BIN=390]="OCT2BIN",e[e.OCT2HEX=391]="OCT2HEX",e[e.OCT2DEC=392]="OCT2DEC",e[e.BIN2DEC=393]="BIN2DEC",e[e.BIN2OCT=394]="BIN2OCT",e[e.BIN2HEX=395]="BIN2HEX",e[e.IMSUB=396]="IMSUB",e[e.IMDIV=397]="IMDIV",e[e.IMPOWER=398]="IMPOWER",e[e.IMABS=399]="IMABS",e[e.IMSQRT=400]="IMSQRT",e[e.IMLN=401]="IMLN",e[e.IMLOG2=402]="IMLOG2",e[e.IMLOG10=403]="IMLOG10",e[e.IMSIN=404]="IMSIN",e[e.IMCOS=405]="IMCOS",e[e.IMEXP=406]="IMEXP",e[e.IMARGUMENT=407]="IMARGUMENT",e[e.IMCONJUGATE=408]="IMCONJUGATE",e[e.IMAGINARY=409]="IMAGINARY",e[e.IMREAL=410]="IMREAL",e[e.COMPLEX=411]="COMPLEX",e[e.IMSUM=412]="IMSUM",e[e.IMPRODUCT=413]="IMPRODUCT",e[e.SERIESSUM=414]="SERIESSUM",e[e.FACTDOUBLE=415]="FACTDOUBLE",e[e.SQRTPI=416]="SQRTPI",e[e.QUOTIENT=417]="QUOTIENT",e[e.DELTA=418]="DELTA",e[e.GESTEP=419]="GESTEP",e[e.ISEVEN=420]="ISEVEN",e[e.ISODD=421]="ISODD",e[e.MROUND=422]="MROUND",e[e.ERF=423]="ERF",e[e.ERFC=424]="ERFC",e[e.BESSELJ=425]="BESSELJ",e[e.BESSELK=426]="BESSELK",e[e.BESSELY=427]="BESSELY",e[e.BESSELI=428]="BESSELI",e[e.XIRR=429]="XIRR",e[e.XNPV=430]="XNPV",e[e.PRICEMAT=431]="PRICEMAT",e[e.YIELDMAT=432]="YIELDMAT",e[e.INTRATE=433]="INTRATE",e[e.RECEIVED=434]="RECEIVED",e[e.DISC=435]="DISC",e[e.PRICEDISC=436]="PRICEDISC",e[e.YIELDDISC=437]="YIELDDISC",e[e.TBILLEQ=438]="TBILLEQ",e[e.TBILLPRICE=439]="TBILLPRICE",e[e.TBILLYIELD=440]="TBILLYIELD",e[e.PRICE=441]="PRICE",e[e.YIELD=442]="YIELD",e[e.DOLLARDE=443]="DOLLARDE",e[e.DOLLARFR=444]="DOLLARFR",e[e.NOMINAL=445]="NOMINAL",e[e.EFFECT=446]="EFFECT",e[e.CUMPRINC=447]="CUMPRINC",e[e.CUMIPMT=448]="CUMIPMT",e[e.EDATE=449]="EDATE",e[e.EOMONTH=450]="EOMONTH",e[e.YEARFRAC=451]="YEARFRAC",e[e.COUPDAYBS=452]="COUPDAYBS",e[e.COUPDAYS=453]="COUPDAYS",e[e.COUPDAYSNC=454]="COUPDAYSNC",e[e.COUPNCD=455]="COUPNCD",e[e.COUPNUM=456]="COUPNUM",e[e.COUPPCD=457]="COUPPCD",e[e.DURATION=458]="DURATION",e[e.MDURATION=459]="MDURATION",e[e.ODDLPRICE=460]="ODDLPRICE",e[e.ODDLYIELD=461]="ODDLYIELD",e[e.ODDFPRICE=462]="ODDFPRICE",e[e.ODDFYIELD=463]="ODDFYIELD",e[e.RANDBETWEEN=464]="RANDBETWEEN",e[e.WEEKNUM=465]="WEEKNUM",e[e.AMORDEGRC=466]="AMORDEGRC",e[e.AMORLINC=467]="AMORLINC",e[e.CONVERT=468]="CONVERT",e[e.ACCRINT=469]="ACCRINT",e[e.ACCRINTM=470]="ACCRINTM",e[e.WORKDAY=471]="WORKDAY",e[e.NETWORKDAYS=472]="NETWORKDAYS",e[e.GCD=473]="GCD",e[e.MULTINOMIAL=474]="MULTINOMIAL",e[e.LCM=475]="LCM",e[e.FVSCHEDULE=476]="FVSCHEDULE",e[e.CUBEKPIMEMBER=477]="CUBEKPIMEMBER",e[e.CUBESET=478]="CUBESET",e[e.CUBESETCOUNT=479]="CUBESETCOUNT",e[e.IFERROR=480]="IFERROR",e[e.COUNTIFS=481]="COUNTIFS",e[e.SUMIFS=482]="SUMIFS",e[e.AVERAGEIF=483]="AVERAGEIF",e[e.AVERAGEIFS=484]="AVERAGEIFS",e[e.AGGREGATE=485]="AGGREGATE",e[e.BINOM_DIST=486]="BINOM_DIST",e[e.BINOM_INV=487]="BINOM_INV",e[e.CONFIDENCE_NORM=488]="CONFIDENCE_NORM",e[e.CONFIDENCE_T=489]="CONFIDENCE_T",e[e.CHISQ_TEST=490]="CHISQ_TEST",e[e.F_TEST=491]="F_TEST",e[e.COVARIANCE_P=492]="COVARIANCE_P",e[e.COVARIANCE_S=493]="COVARIANCE_S",e[e.EXPON_DIST=494]="EXPON_DIST",e[e.GAMMA_DIST=495]="GAMMA_DIST",e[e.GAMMA_INV=496]="GAMMA_INV",e[e.MODE_MULT=497]="MODE_MULT",e[e.MODE_SNGL=498]="MODE_SNGL",e[e.NORM_DIST=499]="NORM_DIST",e[e.NORM_INV=500]="NORM_INV",e[e.PERCENTILE_EXC=501]="PERCENTILE_EXC",e[e.PERCENTILE_INC=502]="PERCENTILE_INC",e[e.PERCENTRANK_EXC=503]="PERCENTRANK_EXC",e[e.PERCENTRANK_INC=504]="PERCENTRANK_INC",e[e.POISSON_DIST=505]="POISSON_DIST",e[e.QUARTILE_EXC=506]="QUARTILE_EXC",e[e.QUARTILE_INC=507]="QUARTILE_INC",e[e.RANK_AVG=508]="RANK_AVG",e[e.RANK_EQ=509]="RANK_EQ",e[e.STDEV_S=510]="STDEV_S",e[e.STDEV_P=511]="STDEV_P",e[e.T_DIST=512]="T_DIST",e[e.T_DIST_2T=513]="T_DIST_2T",e[e.T_DIST_RT=514]="T_DIST_RT",e[e.T_INV=515]="T_INV",e[e.T_INV_2T=516]="T_INV_2T",e[e.VAR_S=517]="VAR_S",e[e.VAR_P=518]="VAR_P",e[e.WEIBULL_DIST=519]="WEIBULL_DIST",e[e.NETWORKDAYS_INTL=520]="NETWORKDAYS_INTL",e[e.WORKDAY_INTL=521]="WORKDAY_INTL",e[e.ECMA_CEILING=522]="ECMA_CEILING",e[e.ISO_CEILING=523]="ISO_CEILING",e[e.BETA_DIST=525]="BETA_DIST",e[e.BETA_INV=526]="BETA_INV",e[e.CHISQ_DIST=527]="CHISQ_DIST",e[e.CHISQ_DIST_RT=528]="CHISQ_DIST_RT",e[e.CHISQ_INV=529]="CHISQ_INV",e[e.CHISQ_INV_RT=530]="CHISQ_INV_RT",e[e.F_DIST=531]="F_DIST",e[e.F_DIST_RT=532]="F_DIST_RT",e[e.F_INV=533]="F_INV",e[e.F_INV_RT=534]="F_INV_RT",e[e.HYPGEOM_DIST=535]="HYPGEOM_DIST",e[e.LOGNORM_DIST=536]="LOGNORM_DIST",e[e.LOGNORM_INV=537]="LOGNORM_INV",e[e.NEGBINOM_DIST=538]="NEGBINOM_DIST",e[e.NORM_S_DIST=539]="NORM_S_DIST",e[e.NORM_S_INV=540]="NORM_S_INV",e[e.T_TEST=541]="T_TEST",e[e.Z_TEST=542]="Z_TEST",e[e.ERF_PRECISE=543]="ERF_PRECISE",e[e.ERFC_PRECISE=544]="ERFC_PRECISE",e[e.GAMMALN_PRECISE=545]="GAMMALN_PRECISE",e[e.CEILING_PRECISE=546]="CEILING_PRECISE",e[e.FLOOR_PRECISE=547]="FLOOR_PRECISE",e[e.ACOT=548]="ACOT",e[e.ACOTH=549]="ACOTH",e[e.COT=550]="COT",e[e.COTH=551]="COTH",e[e.CSC=552]="CSC",e[e.CSCH=553]="CSCH",e[e.SEC=554]="SEC",e[e.SECH=555]="SECH",e[e.IMTAN=556]="IMTAN",e[e.IMCOT=557]="IMCOT",e[e.IMCSC=558]="IMCSC",e[e.IMCSCH=559]="IMCSCH",e[e.IMSEC=560]="IMSEC",e[e.IMSECH=561]="IMSECH",e[e.BITAND=562]="BITAND",e[e.BITOR=563]="BITOR",e[e.BITXOR=564]="BITXOR",e[e.BITLSHIFT=565]="BITLSHIFT",e[e.BITRSHIFT=566]="BITRSHIFT",e[e.PERMUTATIONA=567]="PERMUTATIONA",e[e.COMBINA=568]="COMBINA",e[e.XOR=569]="XOR",e[e.PDURATION=570]="PDURATION",e[e.BASE=571]="BASE",e[e.DECIMAL=572]="DECIMAL",e[e.DAYS=573]="DAYS",e[e.BINOM_DIST_RANGE=574]="BINOM_DIST_RANGE",e[e.GAMMA=575]="GAMMA",e[e.SKEW_P=576]="SKEW_P",e[e.GAUSS=577]="GAUSS",e[e.PHI=578]="PHI",e[e.RRI=579]="RRI",e[e.UNICHAR=580]="UNICHAR",e[e.UNICODE=581]="UNICODE",e[e.MUNIT=582]="MUNIT",e[e.ARABIC=583]="ARABIC",e[e.ISOWEEKNUM=584]="ISOWEEKNUM",e[e.NUMBERVALUE=585]="NUMBERVALUE",e[e.SHEET=586]="SHEET",e[e.SHEETS=587]="SHEETS",e[e.FORMULATEXT=588]="FORMULATEXT",e[e.ISFORMULA=589]="ISFORMULA",e[e.IFNA=590]="IFNA",e[e.CEILING_MATH=591]="CEILING_MATH",e[e.FLOOR_MATH=592]="FLOOR_MATH",e[e.IMSINH=593]="IMSINH",e[e.IMCOSH=594]="IMCOSH",e[e.FILTERXML=595]="FILTERXML",e[e.WEBSERVICE=596]="WEBSERVICE",e[e.ENCODEURL=597]="ENCODEURL",e[e.FORECAST_ETS=598]="FORECAST_ETS",e[e.FORECAST_ETS_CONFINT=599]="FORECAST_ETS_CONFINT",e[e.FORECAST_ETS_SEASONALITY=600]="FORECAST_ETS_SEASONALITY",e[e.FORECAST_LINEAR=601]="FORECAST_LINEAR",e[e.FORECAST_ETS_STAT=602]="FORECAST_ETS_STAT",e[e.MAXIFS=603]="MAXIFS",e[e.MINIFS=604]="MINIFS",e[e.TEXTJOIN=605]="TEXTJOIN",e[e.CONCAT=606]="CONCAT",e[e.IFS=607]="IFS",e[e.SWITCH=608]="SWITCH",e[e.SINGLE=609]="SINGLE",e[e.AVERAGE_WEIGHTED=610]="AVERAGE_WEIGHTED",e[e.ANCHORARRAY=611]="ANCHORARRAY",e[e._FV=612]="_FV",e[e.FIELDVALUE=613]="FIELDVALUE",e[e.FILTER=614]="FILTER",e[e.SORT=615]="SORT",e[e.UNIQUE=616]="UNIQUE",e[e.RICHSEARCH=617]="RICHSEARCH",e[e.LARGEPROPERTY=618]="LARGEPROPERTY",e[e.SMALLPROPERTY=619]="SMALLPROPERTY",e[e.AVERAGEPROPERTY=620]="AVERAGEPROPERTY",e[e.FINDN=621]="FINDN",e[e.TEXTSLICE=622]="TEXTSLICE",e[e.TEXTBEFORE=623]="TEXTBEFORE",e[e.TEXTAFTER=624]="TEXTAFTER",e[e.TEXTSPLIT=625]="TEXTSPLIT",e[e._SORT=626]="_SORT",e[e._ONEDARRAY=627]="_ONEDARRAY",e[e.XMATCH=628]="XMATCH",e[e.XLOOKUP=629]="XLOOKUP",e[e.SORTBY=630]="SORTBY",e[e.RANDARRAY=631]="RANDARRAY",e[e.SEQUENCE=632]="SEQUENCE",e[e.STOCKHISTORY=633]="STOCKHISTORY",e[e.WRAPROWS=634]="WRAPROWS",e[e.VSTACK=635]="VSTACK",e[e.HSTACK=636]="HSTACK",e[e.CHOOSEROWS=637]="CHOOSEROWS",e[e.CHOOSECOLS=638]="CHOOSECOLS",e[e.LET=639]="LET",e[e.LAMBDA=640]="LAMBDA",e[e.MAKEARRAY=641]="MAKEARRAY",e[e.APPLY=642]="APPLY",e[e.ISLAMBDA=643]="ISLAMBDA",e[e.ARITY=644]="ARITY",e[e.RECURSE=645]="RECURSE",e[e.PERCENTOF=646]="PERCENTOF",e[e.VALUETOTEXT=647]="VALUETOTEXT",e[e.ARRAYTOTEXT=648]="ARRAYTOTEXT",e[e.FORMATTEDNUMBER=649]="FORMATTEDNUMBER",e[e.TOCOL=650]="TOCOL",e[e.TOROW=651]="TOROW",e[e.WRAPCOLS=652]="WRAPCOLS",e[e.MAP=653]="MAP",e[e.REDUCE=654]="REDUCE",e[e.SCAN=655]="SCAN",e[e.BYROW=656]="BYROW",e[e.BYCOL=657]="BYCOL",e[e.ISOMITTED=658]="ISOMITTED",e[e.EXPAND=659]="EXPAND",e[e.TAKE=660]="TAKE",e[e.DROP=661]="DROP",e[e.PY=662]="PY",e[e.IMAGE=664]="IMAGE",e[e.UNIT=665]="UNIT",e[e.GROUPBY=666]="GROUPBY",e[e.PIVOTBY=667]="PIVOTBY",e[e.PQSOURCE=668]="PQSOURCE",e[e.PYTHON_STR=669]="PYTHON_STR",e[e.PYTHON_TYPE=670]="PYTHON_TYPE",e[e.PYTHON_TYPENAME=671]="PYTHON_TYPENAME",e[e._FF=672]="_FF",e[e.FIELDFUNCTION=673]="FIELDFUNCTION",e[e.TRANSLATE=674]="TRANSLATE",e[e.DETECTLANGUAGE=675]="DETECTLANGUAGE",e[e.REGEXTEST=676]="REGEXTEST",e[e.REGEXREPLACE=677]="REGEXREPLACE",e[e.REGEXEXTRACT=678]="REGEXEXTRACT",e[e.TRIMRANGE=679]="TRIMRANGE",e[e.IMPORTCSV=680]="IMPORTCSV",e[e.IMPORTTEXT=681]="IMPORTTEXT",e[e._TRO_TRAILING=682]="_TRO_TRAILING",e[e._TRO_LEADING=683]="_TRO_LEADING",e[e._TRO_ALL=684]="_TRO_ALL",e[e.TESTFUNCTIONBEGIN=685]="TESTFUNCTIONBEGIN",e[e.GRF=686]="GRF",e[e.RICHERROR=687]="RICHERROR",e[e.COUNTER=688]="COUNTER",e[e.BROKENRECORD=689]="BROKENRECORD",e[e.STREAM=690]="STREAM",e[e.GETRICHERRORS=691]="GETRICHERRORS",e[e.DBGSTAT=692]="DBGSTAT",e[e.RICHNUMBER=693]="RICHNUMBER",e[e.RICHERNUMBER=694]="RICHERNUMBER",e[e.DBGWRITE=695]="DBGWRITE",e[e.TEST=696]="TEST",e[e.AAC=697]="AAC",e[e.AWC=698]="AWC",e[e.PARSEDEXPRESSION=699]="PARSEDEXPRESSION",e[e.AGE_CONTACTTEST=700]="AGE_CONTACTTEST",e[e.FIRSTNAME_CONTACTTEST=701]="FIRSTNAME_CONTACTTEST",e[e.FULLNAME_CONTACTTEST=702]="FULLNAME_CONTACTTEST",e[e.LASTNAME_CONTACTTEST=703]="LASTNAME_CONTACTTEST",e[e.TRANSLATENAME_CONTACTTEST=704]="TRANSLATENAME_CONTACTTEST",e[e.ARRAYVALUE=705]="ARRAYVALUE",e[e.RECORD=706]="RECORD",e[e.DISPLAYSTRING_GENERALTEST=707]="DISPLAYSTRING_GENERALTEST",e[e.LAMBDADOC=708]="LAMBDADOC",e[e.REFIDENTITY=709]="REFIDENTITY",e[e.PQEVALUATE=710]="PQEVALUATE",e[e.REFTYPE=711]="REFTYPE",e[e.LETREC=750]="LETREC",e[e.NESTEDRECORD=751]="NESTEDRECORD"}(a||(t.WorksheetFuncId=a={})),t.worksheetFuncEnglishNames=[[255,"255"],[268,"GET.WORKBOOK"],[349,"OPTIONS.LISTS.GET"],[355,"OPEN.DIALOG"],[356,"SAVE.DIALOG"],[360,"PHONETIC"],[369,"THAIDAYOFWEEK"],[371,"THAIMONTHOFYEAR"],[612,"_FV"],[626,"_SORT"],[627,"_ONEDARRAY"],[669,"PYTHON_STR"],[670,"PYTHON_TYPE"],[671,"PYTHON_TYPENAME"],[672,"_FF"],[682,"_TRO_TRAILING"],[683,"_TRO_LEADING"],[684,"_TRO_ALL"],[700,"AGE_CONTACTTEST"],[701,"FIRSTNAME_CONTACTTEST"],[702,"FULLNAME_CONTACTTEST"],[703,"LASTNAME_CONTACTTEST"],[704,"TRANSLATENAME_CONTACTTEST"],[707,"DISPLAYSTRING_GENERALTEST"]].reduce(((e,t)=>(e[t[0]]=t[1],e)),[]);const i=[];t.worksheetFuncTypes=[[1,255,i,[57],i,1,0,32],[1,3,[36,831,831],i,i,823,0,64],[1,1,[271],i,i,4,0,64],[1,1,[271],i,i,4,0,64],[1,255,i,[305],i,1,0,32],[1,255,i,[49],i,1,0,32],[1,255,i,[49],i,1,0,32],[1,255,i,[49],i,1,0,32],[0,1,[16],i,i,33,0,0],[0,1,[16],i,i,33,0,0],[0,0,i,i,i,3,0,32],[2,255,[1],[49],i,1,0,32],[1,255,i,[49],i,1,0,32],[1,2,[1,1],i,i,2,0,64],[1,3,[1,65,4],i,i,2,0,64],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[0,0,i,i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,3,[263,48,48],i,i,263,0,0],[2,4,[48,1,1,1],i,i,311,0,0],[2,2,[2,1],i,i,2,0,64],[3,3,[2,1,1],i,i,2,0,64],[1,1,[2],i,i,1,0,64],[1,1,[7],i,i,1,0,64],[0,0,i,i,i,4,0,32],[0,0,i,i,i,4,0,32],[1,255,i,[52],i,4,0,32],[1,255,i,[52],i,4,0,32],[1,1,[4],i,i,4,0,32],[2,2,[1,1],i,i,1,0,0],[3,3,[16,83,18],i,i,1,0,0],[3,3,[16,19,18],i,i,1,0,0],[3,3,[16,19,18],i,i,1,0,0],[3,3,[16,19,18],i,i,1,0,0],[3,3,[16,19,18],i,i,1,0,0],[3,3,[16,19,18],i,i,1,0,0],[1,255,i,[49],i,1,0,32],[3,3,[16,19,18],i,i,1,0,0],[2,2,[263,2],i,i,2,0,64],[1,4,[48,112,84,84],i,i,32,0,0],[1,4,[48,112,112,84],i,i,32,0,0],[1,4,[48,112,84,84],i,i,32,0,0],[1,4,[48,112,112,84],i,i,32,0,0],[1,1,[16],i,i,512,0,2],[0,1,[4],i,i,512,0,2],[0,1,[575],i,i,512,0,2],[3,5,[1,1,1,1,1],i,i,1,0,0],[3,5,[1,1,1,1,1],i,i,1,0,0],[3,5,[1,1,1,1,1],i,i,1,0,0],[3,5,[1,1,1,1,1],i,i,1,0,0],[3,6,[1,1,1,1,1,1],i,i,1,0,0],[3,3,[48,1,1],i,i,1,0,32],[1,2,[48,1],i,i,1,0,0],[0,0,i,i,i,1,16383,0],[2,3,[263,305,17],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,2,[1,1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[0,0,i,i,i,1,16383,0],[1,1,[16],i,i,1,0,0],[1,1,[48],i,i,1,0,0],[1,1,[48],i,i,1,0,0],[3,5,[16,65,65,65,65],i,i,16,16383,0],[2,2,[2,16],i,i,16,0,2],[2,2,[16,16],i,i,2,0,2],[0,3,[66,81,16],i,i,4,0,2],[2,3,[2,2,1],i,i,1,0,64],[1,1,[39],i,i,32,0,0],[0,2,[1,24],i,i,4,0,2],[0,0,i,i,i,4,0,2],[1,1,[303],i,i,1,0,0],[0,1,[4],i,i,4,0,2],[1,2,[2,63],i,i,4,0,2],[0,0,i,i,i,50,0,2],[1,1,[16],i,i,47,0,2],[0,2,[65,66],i,i,32,0,2],[4,5,[87,117,117,1,117],i,i,4,0,4],[0,2,[1,66],i,i,32,0,2],[0,0,i,i,i,16,0,2],[0,0,i,i,i,16,0,2],[0,1,[1],i,i,4,0,2],[2,2,[1,1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[2,255,[33],[831],i,823,0,0],[3,4,[263,49,49,4],i,i,295,0,0],[3,4,[263,49,49,4],i,i,295,0,0],[0,2,[66,65],i,i,32,0,2],[1,7,[2,65,66,67,65,65,2],i,i,575,0,2],[1,1,[63],i,i,4,0,64],[1,1,[18],i,i,2,0,2],[1,2,[2,4],i,i,6,0,2],[2,2,[16,47],i,i,4,0,2],[1,2,[1,1],i,i,1,0,0],[1,4,[2,1,4,4],i,i,7,0,2],[1,1,[1],i,i,2,0,64],[1,1,[2],i,i,2,0,64],[1,1,[2],i,i,2,0,64],[1,1,[2],i,i,2,0,64],[1,2,[2,9],i,i,2,0,64],[1,2,[2,9],i,i,2,0,64],[2,2,[258,258],i,i,4,0,64],[1,1,[2],i,i,2,0,64],[4,4,[2,1,1,2],i,i,2,0,64],[3,4,[2,2,2,2],i,i,2,0,64],[1,1,[2],i,i,1,0,0],[0,3,[66,65,66],i,i,32,0,2],[0,1,[2],i,i,2,0,2],[2,3,[2,2,1],i,i,1,0,64],[1,2,[2,16],i,i,303,16383,0],[1,1,[271],i,i,4,0,64],[1,1,[399],i,i,4,0,64],[1,1,[399],i,i,4,0,64],[1,1,[399],i,i,4,0,64],[1,1,[23],i,i,2,0,0],[1,1,[23],i,i,1,0,0],[1,2,[2,1],i,i,1,0,2],[1,1,[1],i,i,1,0,2],[1,1,[1],i,i,1,0,2],[1,1,[1],i,i,2,0,2],[2,2,[1,1],i,i,2,0,2],[2,2,[1,2],i,i,1,0,2],[2,2,[1,2],i,i,1,0,2],[1,2,[1,1],i,i,1,0,2],[1,1,[3],i,i,1,0,64],[1,1,[3],i,i,1,0,64],[3,3,[1,1,1],i,i,1,0,0],[4,4,[1,1,1,1],i,i,1,0,0],[4,5,[1,1,1,1,1],i,i,1,0,0],[1,3,[2,66,65],i,i,2,0,2],[1,2,[16,4],i,i,2,0,2],[1,2,[2,4],i,i,16,0,2],[1,2,[2,4],i,i,16,16383,0],[1,255,[2,3,66,66,66,65,67,66,67],[66],i,3,0,2],[1,255,[3],[127],i,575,0,2],[0,1,[3],i,i,1,0,2],[2,4,[3,115,83,3],i,i,1,0,2],[3,5,[3,83,115,83,3],i,i,1,0,2],[4,5,[3,3,3,4,3],i,i,4,0,2],[4,5,[3,3,3,4,3],i,i,4,0,2],[4,5,[3,3,3,3,3],i,i,4,0,2],[0,1,[3],i,i,4,0,2],[2,3,[3,3,3],i,i,4,0,2],[3,4,[3,3,3,3],i,i,4,0,2],[1,3,[1,67,66],i,i,1,0,2],[1,1,[52],i,i,36,0,2],[1,1,[2],i,i,2,0,64],[1,1,[32],i,i,1,0,0],[1,1,[32],i,i,32,0,0],[2,2,[32,32],i,i,32,0,0],[0,2,[2,2],i,i,32,0,2],[4,6,[1,1,1,1,1,1],i,i,1,0,0],[4,6,[1,1,1,1,1,1],i,i,1,0,0],[1,255,i,[121],i,1,0,32],[0,2,[1,16],i,i,4,0,2],[3,4,[2,1,1,1],i,i,512,0,2],[1,1,[4],i,i,512,0,2],[0,0,i,i,i,512,0,2],[0,0,i,i,i,512,0,2],[2,2,[2,2],i,i,1,0,2],[2,2,[1,2],i,i,32,0,2],[3,3,[1,18,18],i,i,4,0,2],[2,2,[1,2],i,i,4,0,2],[1,1,[1],i,i,4,0,2],[0,1,[1],i,i,512,0,2],[0,1,[2],i,i,4,0,2],[0,4,[3,3,3,3],i,i,3,0,2],[1,255,i,[113],i,1,0,32],[1,1,[1],i,i,1,0,0],[1,2,[1,16],i,i,47,0,2],[1,1,[1],i,i,47,0,2],[1,2,[1,2],i,i,47,0,2],[1,2,[1,2],i,i,63,0,2],[3,3,[16,19,18],i,i,1,0,0],[1,1,[143],i,i,4,0,64],[0,3,[82,65,65],i,i,2,0,2],[0,4,[66,82,17,17],i,i,1,0,2],[1,255,i,[49],i,1,0,32],[1,255,i,[49],i,1,0,32],[3,3,[16,19,18],i,i,1,0,0],[3,3,[16,19,18],i,i,1,0,0],[1,2,[1,1],i,i,1,0,0],[1,1,[143],i,i,4,0,64],[3,3,[16,83,18],i,i,1,0,0],[1,1,[3],i,i,4,0,2],[1,1,[3],i,i,4,0,2],void 0,void 0,[1,2,[1,1],i,i,2,0,192],[2,3,[2,2,1],i,i,1,0,192],[2,3,[2,2,1],i,i,1,0,192],[4,4,[2,1,1,2],i,i,2,0,192],[1,2,[2,9],i,i,2,0,192],[1,2,[2,9],i,i,2,0,192],[3,3,[2,1,1],i,i,2,0,192],[1,1,[2],i,i,1,0,192],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[1,1,[2],i,i,2,0,192],[1,1,[2],i,i,2,0,192],[2,3,[1,16,4],i,i,1,0,32],void 0,void 0,[2,5,[1,65,65,68,66],i,i,2,0,0],[2,3,[1,1,4],i,i,1,0,0],[0,0,i,i,i,1,16383,0],[5,7,[1,1,1,1,1,1,4],i,i,1,0,0],[0,0,i,i,i,512,0,2],[1,1,[12],i,i,512,0,2],[0,0,i,i,i,512,0,2],[1,3,[2,82,84],i,i,512,0,2],[1,255,i,[49],i,1,0,32],[1,255,i,[32],i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[3,3,[16,19,18],i,i,263,0,0],[2,11,[1,18,17,17,18,17,17,115,84,21,17],i,i,2,0,2],[0,1,[4],i,i,4,0,2],[0,0,i,i,i,16,0,2],[0,2,[2,2],i,i,4,0,2],[0,3,[2,2,2],i,i,4,0,2],[2,5,[2,23,23,23,23],i,i,2,0,66],[2,4,[2,1,1,2],i,i,1,0,2],[1,4,[2,66,65,65],i,i,1,0,2],[1,1,[2],i,i,3,16383,0],[0,0,i,i,i,2,0,2],[1,5,[1,2,1,1,1],i,i,47,0,2],[4,5,[1,1,1,1,1],i,i,1,0,0],[0,1,[4],i,i,512,0,2],void 0,void 0,[0,1,[1],i,i,512,0,2],[2,2,[48,48],i,i,32,0,32],[0,2,[66,96],i,i,2,0,2],[1,1,[2],i,i,4,0,2],[1,255,[17],[127],i,575,0,192],[1,1,[3],i,i,4,0,2],[1,1,[2],i,i,63,0,2],[1,2,[1,3],i,i,47,0,2],[1,3,[1,3,1],i,i,47,0,2],[1,3,[2,66,4],i,i,4,0,2],[1,1,[15],i,i,1,0,0],[0,1,[2],i,i,4,0,2],[0,1,[2],i,i,4,0,2],[0,2,[99,66],i,i,4,0,2],[3,3,[3,1,4],i,i,4,0,2],[3,3,[3,1,4],i,i,4,0,2],[2,3,[2,3,66],i,i,1,0,2],[1,2,[1,2],i,i,35,0,2],[1,255,i,[49],i,1,0,32],[3,5,[1,1,1,65,65],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[3,5,[1,1,1,65,65],i,i,1,0,0],[4,4,[1,1,1,4],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[3,3,[1,1,4],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[4,4,[1,1,1,4],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[4,4,[1,1,1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[4,4,[1,1,1,4],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[3,3,[1,1,4],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[4,4,[1,1,1,4],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[3,3,[1,32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[4,4,[32,32,1,1],i,i,1,0,0],[3,4,[32,32,1,65],i,i,1,0,0],[1,255,i,[49],i,1,0,32],[1,255,i,[49],i,1,0,32],[1,255,i,[49],i,1,0,32],[1,255,i,[49],i,1,0,32],[1,255,i,[49],i,1,0,32],[1,255,i,[49],i,1,0,32],[2,3,[49,1,1],i,i,1,0,32],[2,2,[49,1],i,i,1,0,32],[2,2,[49,1],i,i,1,0,32],[2,2,[49,1],i,i,1,0,32],[2,2,[49,1],i,i,1,0,32],[2,3,[49,1,65],i,i,1,0,32],[1,255,i,[32],i,1,0,32],[2,2,[49,1],i,i,1,0,32],[2,2,[1,1],i,i,1,0,0],void 0,[3,4,[2,1,1,1],i,i,1,0,130],[2,3,[2,1,1],i,i,1,0,130],[1,255,i,[2],i,2,0,64],[2,2,[1,1],i,i,1,0,0],[2,9,[66,2,66,65,65,65,66,66,66],i,i,2,0,2],[1,2,[1,2],i,i,35,0,2],[1,3,[1,66,2],i,i,35,0,2],[1,4,[1,66,66,2],i,i,7,0,2],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[2,255,[1],[16],i,1,0,0],[2,3,[16,15,16],i,i,1,0,64],[2,2,[16,15],i,i,1,0,64],[1,1,[16],i,i,1,0,0],[1,2,[1,2],i,i,19,0,2],[1,1,[33],i,i,33,0,2],[4,4,[1,1,1,1],i,i,1,0,0],[3,3,[1,1,2],i,i,1,0,128],[1,1,[1],i,i,2,0,192],[2,2,[1,1],i,i,2,0,192],[1,2,[1,5],i,i,2,0,0],[0,4,[66,66,66,65],i,i,6,0,2],[0,5,[66,66,66,66,65],i,i,6,0,2],[1,2,[1,2],i,i,19,0,2],[2,255,[18,18],[2,79],i,15,0,0],[1,2,[2,39],i,i,39,0,0],[1,1,[16],i,i,2,0,128],[1,255,i,[49],i,1,0,32],[1,255,i,[49],i,1,0,32],[1,255,i,[49],i,1,0,32],[1,255,i,[49],i,1,0,32],[1,255,i,[49],i,1,0,32],[1,255,i,[49],i,1,0,32],[1,255,i,[49],i,1,0,32],[1,1,[1],i,i,2,0,64],[1,1,[1],i,i,2,0,192],[1,1,[3],i,i,2,0,192],[1,1,[1],i,i,2,0,192],[1,1,[1],i,i,2,0,192],[1,1,[1],i,i,2,0,192],[1,1,[2],i,i,1,0,192],[1,1,[2],i,i,4,0,192],[1,1,[1],i,i,1,0,192],[1,1,[1],i,i,1,0,192],[1,1,[1],i,i,1,0,192],[3,255,[2,2],[2],i,2,0,0],[1,255,[2],[50],i,15,0,0],[2,3,[2,50,2],i,i,10,0,0],[3,3,[2,2,2],i,i,15,0,0],[3,4,[2,2,1,2],i,i,10,0,0],[1,2,[95,95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[2,3,[95,95,95],i,i,9,0,0],[1,255,i,[127],i,9,0,0],[1,255,i,[127],i,9,0,0],[4,4,[95,95,95,127],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,3,[127,127,95],i,i,9,0,0],[3,3,[95,127,127],i,i,9,0,0],[5,6,[95,95,95,95,95,95],i,i,9,0,0],[5,6,[95,95,95,95,95,95],i,i,9,0,0],[4,5,[95,95,95,95,95],i,i,9,0,0],[4,5,[95,95,95,95,95],i,i,9,0,0],[4,5,[95,95,95,95,95],i,i,9,0,0],[4,5,[95,95,95,95,95],i,i,9,0,0],[4,5,[95,95,95,95,95],i,i,9,0,0],[3,3,[95,95,95],i,i,9,0,0],[3,3,[95,95,95],i,i,9,0,0],[3,3,[95,95,95],i,i,9,0,0],[6,7,[95,95,95,95,95,95,95],i,i,9,0,0],[6,7,[95,95,95,95,95,95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[6,6,[95,95,95,95,95,95],i,i,9,0,0],[6,6,[95,95,95,95,95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,3,[95,95,95],i,i,9,0,0],[3,4,[95,95,95,95],i,i,9,0,0],[3,4,[95,95,95,95],i,i,9,0,0],[3,4,[95,95,95,95],i,i,9,0,0],[3,4,[95,95,95,95],i,i,9,0,0],[3,4,[95,95,95,95],i,i,9,0,0],[3,4,[95,95,95,95],i,i,9,0,0],[5,6,[95,95,95,95,95,95],i,i,9,0,0],[5,6,[95,95,95,95,95,95],i,i,9,0,0],[7,8,[95,95,95,95,95,95,95,95],i,i,9,0,0],[7,8,[95,95,95,95,95,95,95,95],i,i,9,0,0],[8,9,[95,95,95,95,95,95,95,95,95],i,i,9,0,0],[8,9,[95,95,95,95,95,95,95,95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,16383,0],[1,2,[95,95],i,i,9,0,0],[6,7,[95,95,95,95,95,95,95],i,i,9,0,128],[6,7,[95,95,95,95,95,95,95],i,i,9,0,0],[3,3,[95,95,95],i,i,9,0,0],[6,8,[95,95,95,95,95,95,95,95],i,i,9,0,0],[4,5,[95,95,95,95,95],i,i,9,0,0],[2,3,[95,95,127],i,i,9,0,0],[2,3,[95,95,127],i,i,9,0,0],[1,255,i,[127],i,9,0,0],[1,255,i,[127],i,9,0,0],[1,255,i,[127],i,9,0,0],[2,2,[95,127],i,i,9,0,0],[3,4,[2,2,1,2],i,i,10,0,0],[2,5,[2,50,2,1,2],i,i,10,0,64],[1,1,[2],i,i,9,0,0],[2,2,[47,575],i,i,303,0,0],[2,255,i,[16,15],i,1,0,64],[3,255,[16],[16,15],i,1,0,64],[2,3,[16,15,16],i,i,1,0,64],[3,255,[16],[16,15],i,1,0,64],[3,254,[1,1,48,17],[16],i,1,0,0],[4,4,[1,1,1,4],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[3,3,[1,1,4],i,i,1,0,0],[4,4,[1,1,1,4],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[1,254,i,[32],i,32,0,32],[1,254,i,[32],i,1,0,32],[4,4,[1,1,1,4],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[2,2,[49,1],i,i,1,0,32],[2,2,[49,1],i,i,1,0,32],[2,3,[49,1,65],i,i,1,0,32],[2,3,[49,1,65],i,i,1,0,32],[3,3,[1,1,4],i,i,1,0,0],[2,2,[49,1],i,i,1,0,32],[2,2,[49,1],i,i,1,0,32],[2,3,[1,16,4],i,i,1,0,32],[2,3,[1,16,4],i,i,1,0,32],[1,254,i,[49],i,1,0,32],[1,254,i,[49],i,1,0,32],[3,3,[1,1,4],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[1,254,i,[49],i,1,0,32],[1,254,i,[49],i,1,0,32],[4,4,[1,1,1,4],i,i,1,0,0],[2,4,[95,95,75,127],i,i,9,0,0],[2,4,[95,95,75,127],i,i,9,0,0],[2,2,[1,1],i,i,1,0,128],[1,2,[1,65],i,i,1,0,128],void 0,[4,6,[1,1,1,4,65,65],i,i,1,0,0],[3,5,[1,1,1,65,65],i,i,1,0,0],[3,3,[1,1,4],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[4,4,[1,1,1,4],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[5,5,[1,1,1,1,4],i,i,1,0,0],[4,4,[1,1,1,4],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[4,4,[1,1,1,4],i,i,1,0,0],[2,2,[1,4],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[4,4,[32,32,1,1],i,i,1,0,0],[2,3,[49,1,1],i,i,1,0,32],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[1],i,i,1,0,0],[1,2,[1,65],i,i,1,0,128],[1,2,[1,65],i,i,1,0,128],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[1,254,i,[52],i,4,0,32],[3,3,[1,1,1],i,i,1,0,0],[2,3,[1,1,65],i,i,2,0,0],[2,2,[2,1],i,i,1,0,0],[2,2,[3,3],i,i,1,0,64],[3,4,[1,1,1,65],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,254,i,[49],i,1,0,32],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[1,1,[1],i,i,2,0,0],[1,1,[2],i,i,1,0,0],[1,1,[1],i,i,32,0,0],[1,1,[2],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,3,[2,66,66],i,i,1,0,0],[0,1,[50],i,i,1,16383,32],[0,1,[48],i,i,1,16383,32],[1,1,[16],i,i,2,16383,0],[1,1,[16],i,i,4,0,0],[2,2,[47,575],i,i,303,0,0],[1,3,[1,65,65],i,i,1,0,0],[1,3,[1,65,65],i,i,1,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[2,2,[2,2],i,i,47,0,64],[1,1,[2],i,i,10,0,64],[1,1,[2],i,i,10,0,64],[3,6,[1,48,48,65,65,65],i,i,1,0,0],[3,7,[1,48,48,65,65,65,65],i,i,1,0,0],[2,4,[48,48,65,65],i,i,1,0,0],[3,3,[1,32,32],i,i,1,0,0],[3,6,[48,48,1,65,65,65],i,i,1,0,0],[3,254,[16],[16,15],i,1,0,64],[3,254,[16],[16,15],i,1,0,64],[3,254,[114,68],[114],i,2,0,96],[1,254,i,[114],i,2,0,96],[2,254,i,[44,575],i,831,0,64],[3,254,[47],[575,575],[575],831,0,64],[1,1,[1527],i,i,1503,0,233],[2,254,i,[113,113],i,1,0,33],[1,1,[16],i,i,48,0,41],[2,3,[271,2,4],i,i,303,0,105],[2,2,[271,2],i,i,303,0,97],[2,3,[48,48,111],i,i,303,0,65],[1,4,[160,96,96,4],i,i,32,0,65],[1,3,[160,4,4],i,i,32,0,65],[2,2,[2,256],i,i,1,0,80],[3,3,[2,49,1],i,i,1,0,48],[3,3,[2,49,1],i,i,1,0,48],[2,254,[2],[49],i,1,0,48],[2,7,[34,2,65,65,65,74,68],i,i,1,0,65],[1,3,[2,65,65],i,i,2,0,65],[2,6,[2,34,65,65,65,74],i,i,2,0,65],[2,6,[2,34,65,65,65,74],i,i,2,0,65],[2,6,[2,98,98,68,65,495],i,i,32,0,65],[1,4,[32,96,96,4],i,i,32,0,81],[2,2,[4,16],i,i,32,0,49],[2,4,[391,48,65,65],i,i,1,0,65],[3,6,[391,48,48,511,65,65],i,i,319,0,65],[2,254,[160],[160,65],i,32,0,65],[0,5,[65,65,65,65,68],i,i,32,16383,1],[1,4,[65,65,65,65],i,i,32,0,1],[2,254,[258,1,65,65,65],[65],i,32,0,97],[2,3,[32,1,463],i,i,32,0,65],[1,254,i,[48],i,32,0,33],[1,254,i,[48],i,32,0,33],[2,254,[48],[33],i,32,0,1],[2,254,[48],[33],i,32,0,1],[3,254,i,[319,319],[319],319,0,1],[1,254,i,[319],i,319,0,1],[3,3,[65,65,319],i,i,32,0,1],[1,254,i,[319],i,319,0,1],[1,1,[271],i,i,4,0,1],[1,1,[271],i,i,9,0,1],[0,0,i,i,i,319,0,1],[2,2,[49,49],i,i,9,0,1],[1,2,[399,1],i,i,2,0,65],[1,2,[32,1],i,i,2,0,65],[2,2,[15,2],i,i,256,0,97],[1,3,[48,65,68],i,i,32,0,97],[1,3,[48,65,68],i,i,32,0,97],[2,3,[32,1,463],i,i,32,0,65],[2,254,[48],[319],i,32,0,65],[3,3,[511,48,271],i,i,319,0,65],[3,3,[511,48,271],i,i,32,0,65],[1,2,[48,271],i,i,32,0,65],[1,2,[48,271],i,i,32,0,65],[1,1,[1535],i,i,4,0,65],[2,4,[32,65,65,495],i,i,32,0,65],[2,3,[48,65,65],i,i,48,0,65],[2,3,[48,65,65],i,i,48,0,65],[2,254,[1,1],[447],i,303,0,97],void 0,[1,5,[2,66,65,65,65],i,i,264,0,65],[2,2,[15,2],i,i,271,0,97],[3,8,[112,96,96,65,65,96,96,65],i,i,32,0,65],[4,11,[112,112,96,96,65,65,96,65,96,96,65],i,i,32,0,65],[1,1,[2],i,i,264,0,9],[1,1,[256],i,i,2,0,97],[1,1,[256],i,i,2,0,97],[1,1,[256],i,i,2,0,97],[3,254,[256,2,4],[47],i,303,0,105],[2,254,[256,2],[47],i,303,0,97],[1,3,[2,2,2],i,i,2,0,97],[1,1,[2],i,i,2,0,97],[2,3,[2,2,1],i,i,4,0,65],[3,5,[2,2,2,1,1],i,i,2,0,65],[2,4,[2,2,1,1],i,i,34,0,65],[1,3,[48,65,65],i,i,16,0,65],[1,3,[2,1,2],i,i,32,0,65],[1,5,[2,35,1,2,1],i,i,32,0,65],[1,1,[16],i,i,16,0,73],[1,1,[16],i,i,16,0,73],[1,1,[16],i,i,16,0,73],[0,0,i,i,i,1,0,1],[1,2,[287,2],i,i,288,0,97],[1,2,[1,1],i,i,10,0,97],[0,0,i,i,i,1,0,1],[3,254,[47],[2,47],i,47,0,97],[0,1,[1],i,i,1,0,1],[0,1,[1],i,i,32,0,1],[1,2,[2,1],i,i,47,0,1],[1,1,[1],i,i,264,0,97],[1,1,[1],i,i,264,0,97],[2,2,[2,47],i,i,47,0,1],[1,254,[2],[1151],i,1087,0,96],[1,254,[1],[1151],i,1087,0,0],[1,254,[1],[1151],i,1087,0,0],[1,1,[16],i,i,32,0,1],[1,1,[256],i,i,2,0,97],[1,1,[256],i,i,2,0,97],[1,1,[256],i,i,2,0,97],[1,1,[256],i,i,2,0,97],[2,2,[256,2],i,i,2,0,97],[1,1,[32],i,i,256,0,97],[3,254,[15],[2,47],i,303,0,97],[1,1,[256],i,i,2,0,97],[4,254,[256,66,66,66],[66,96],i,319,0,1],[1,1,[48],i,i,16,0,97],[2,2,[2,2],i,i,34,0,65],[1,1,[16],i,i,2,0,97],void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,[3,254,i,[319,319],[319],319,0,1],[3,254,[15],[2,303],i,303,0,97]].map((e=>void 0===e?void 0:(0,n.functionType)(...e)))},84817:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.styleServiceTypes=t.testUtil=t.printServiceTypes=t.printService=t.mathpackIEEE=t.relabel=t.visitor=t.mathpack=t.signature=t.literalParse=t.resolveServiceTypes=t.resolveService=t.util=t.numfmt=t.formulaModule=t.datepack=t.mathpackXL=t.config=t.cellParse=t.cellFormat=t.annotations=t.adjust=t.worksheetFuncTypesModule=t.location=t.value=t.types=t.PackageName=void 0;const n=r(74643);t.PackageName="excel-online-calc-lang",t.types=n.__importStar(r(61824)),t.value=n.__importStar(r(91176)),t.location=n.__importStar(r(66562)),t.worksheetFuncTypesModule=n.__importStar(r(89208)),t.adjust=n.__importStar(r(71314)),t.annotations=n.__importStar(r(92247)),t.cellFormat=n.__importStar(r(63346)),t.cellParse=n.__importStar(r(94574)),t.config=n.__importStar(r(81187)),t.mathpackXL=n.__importStar(r(21174)),t.datepack=n.__importStar(r(52292)),t.formulaModule=n.__importStar(r(50667)),t.numfmt=n.__importStar(r(16782)),t.util=n.__importStar(r(10041)),t.resolveService=n.__importStar(r(51394)),t.resolveServiceTypes=n.__importStar(r(96089)),t.literalParse=n.__importStar(r(24783)),t.signature=n.__importStar(r(93383)),t.mathpack=n.__importStar(r(47794)),t.visitor=n.__importStar(r(97791)),t.relabel=n.__importStar(r(54108)),t.mathpackIEEE=n.__importStar(r(74802)),t.printService=n.__importStar(r(67027)),t.printServiceTypes=n.__importStar(r(5886)),t.testUtil=n.__importStar(r(62241)),t.styleServiceTypes=n.__importStar(r(3351))},24783:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseSignedLiteral=t.parseNumberLiteral=t.parseUint=t.isLineBreak=t.isSpace=void 0;const n=r(74643),a=r(80168),i=r(72858),o=r(73567),s=r(43492),u=r(16782),l=n.__importStar(r(34166)),c=r(10041),{codePointSpace:d,codePointLF:g,codePointMinusSign:m,codePointPlusSign:h,codePointSlash:p}=l;function f(e){return e===d||e===g}function S(e,t,r,n){(0,i.assertIndex)("calc.parse.parseUint",t,16);let o=0,u=n,l=r.length;for(;u<l;){const n=(0,s.stringCodePointAt)(r,u);if(!e.isNumeral(n))break;const i=e.getOrdinal(n);0===o&&0!==i&&(l=(0,a.fastMin)(l,u+t)),o=10*o+i,u+=(0,s.numCodeUnits)(n)}return u===l&&u<r.length&&e.isNumeral((0,s.stringCodePointAt)(r,u))?[0,n]:[o,u]}function v(e,t,r,n){let a=n;const[o,s]=S(e,5,r,a);if(s===a)return!1;if(o>32767)return!1;if(a=s,!(a<r.length&&r.charCodeAt(a)===p))return!1;a+=1;const[u,l]=S(e,5,r,a);if(l===a)return!1;if(u>32767)return!1;if(a=l,0===u)return[!1,0,a];const d=t.div(t.fromNumber(o),t.fromNumber(u));return(0,i.assertTrue)("calc.lang.tryTokenizeFrac",(0,c.isNumberOper)(d)),[d,u,a]}function F(e,t,r,n,l,d,g){let p,F,y,C=n,A=0,E="",b=!1,R=!1,T=0,k=0,N=u.NumberShape.ASCII;if(!((0,o.stringStartsWith)(r,e.decimalSeparator,n)||n<r.length&&e.isNumeral((0,s.stringCodePointAt)(r,n))))return;const I=()=>{if((d||l&&r.indexOf("%",C)>=0)&&(A-=2,void 0!==p)){const e=t.div(p,t.fromNumber(100));(0,i.assertTrue)("calc.lang.parseNumberLiteral",(0,c.isNumberOper)(e)),p=e,y=u.KnownFormat.Pct}if((0,a.fastAbs)(A)>=309)return{value:void 0,i:C,consumedThousands:b,consumedDecimal:R,numDigDec:T,numShape:N,format:y};let n=t.parse(e,!0,A,E);if(void 0!==p){const e=t.add(n,p);(0,i.assertTrue)("calc.lang.parseNumberLiteral",(0,c.isNumberOper)(e)),n=e}return{value:n,i:C,consumedThousands:b,consumedDecimal:R,numDigDec:T,numShape:N,format:y}};for(;C<r.length;){const t=(0,s.stringCodePointAt)(r,C);if(!e.isNumeral(t))break;if(0!==e.getOrdinal(t))break;(F=e.getNumberShape(t))!==u.NumberShape.ASCII&&(N=F),C+=(0,s.numCodeUnits)(t)}if(g){const n=v(e,t,r,C);if(!1!==n){const[e,t,r]=n;return C=r,!1===e?{value:void 0,i:C,consumedThousands:b,consumedDecimal:R,numDigDec:T,numShape:N,format:y}:(y=t>=10?u.KnownFormat.FractBond:u.KnownFormat.Fract,p=e,I())}}let O=C;for(;C<r.length;){const t=(0,s.stringCodePointAt)(r,C);if(e.isNumeral(t))A+=1,(F=e.getNumberShape(t))!==u.NumberShape.ASCII&&(N=F),C+=(0,s.numCodeUnits)(t);else{if(!(l&&A>0&&(0,o.stringStartsWith)(r,e.thousandsSeparator,C)))break;b=!0,C+=e.thousandsSeparator.length}}if(E+=r.substring(O,C),b){const t=function(e,t,r){let n=r,a="";for(let r=0;r<t.length;){const i=(0,s.stringCodePointAt)(t,r);if(e.isNumeral(i)){const e=(0,s.numCodeUnits)(i);a+=t.substring(r,r+e),r+=e,n-=1}else{if(0===n||!e.isThousandsPosition(n))return;r+=e.thousandsSeparator.length}}return a}(e,E,A);if(void 0===t)return;E=t}if(n<C&&C<r.length&&f(r.charCodeAt(C))){const n=v(e,t,r,C+1);if(!1!==n){const[e,t,r]=n;return C=r,!1===e?{value:void 0,i:C,consumedThousands:b,consumedDecimal:R,numDigDec:T,numShape:N,format:y}:(y=t>=10?u.KnownFormat.FractBond:u.KnownFormat.Fract,p=e,I())}}let _=!1;if((0,o.stringStartsWith)(r,e.decimalSeparator,C)&&(_=C===n,R=!0,C+=e.decimalSeparator.length),0===A)for(;C<r.length;){const t=(0,s.stringCodePointAt)(r,C);if(!e.isNumeral(t))break;if(0!==e.getOrdinal(t))break;A-=1,(F=e.getNumberShape(t))!==u.NumberShape.ASCII&&(N=F),k+=1,C+=(0,s.numCodeUnits)(t)}for(O=C;C<r.length;){const t=(0,s.stringCodePointAt)(r,C);if(!e.isNumeral(t))break;(F=e.getNumberShape(t))!==u.NumberShape.ASCII&&(N=F),T+=1,C+=(0,s.numCodeUnits)(t)}if(E+=r.substring(O,C),T>0&&(T+=k),_&&C<=n+e.decimalSeparator.length)return;const P=function(e,t,r){let n=r;if(n<t.length&&0===e.stringCompareCI("E",t.substring(n,n+1)))n+=1;else{if(!(0,o.stringStartsWith)(t,"**",n))return[0,r];n+=2}let a=!1;if(n<t.length){const e=(0,s.stringCodePointAt)(t,n);((a=e===m)||e===h)&&(n+=(0,s.numCodeUnits)(e))}if(n>=t.length||!e.isNumeral((0,s.stringCodePointAt)(t,n)))return!1;const[i,u]=S(e,10,t,n);return u!==n&&!(i>2147483647)&&[a?-i:i,u]}(e,r,C);if(!1!==P){const[e,t]=P;A+=e,t!==C&&(y=u.KnownFormat.Exp),C=t}return!1===P?{value:void 0,i:C,consumedThousands:b,consumedDecimal:R,numDigDec:T,numShape:N,format:y}:I()}t.isSpace=f,t.isLineBreak=function(e){return e===g},t.parseUint=S,t.parseNumberLiteral=F,t.parseSignedLiteral=function(e,t,r,n,a){let i=n,o=!1;if(i<r.length){const e=r.charCodeAt(i);if((e===h||e===m)&&(o=e===m,i+=1,a))for(;i<r.length&&f(r.charCodeAt(i));)i+=1}const s=F(e,t,r,i,!1,!1,!1);return void 0===s?.value?[t.zero,n]:(i=s.i,[o?t.neg(s.value):s.value,i])}},66562:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSheetGridCell=t.isSheetGridRange=t.isGridCell=t.isSheetIndex=t.userDefinedFuncLoc=t.nameLoc=t.nameScope=t.documentScope=t.originCell=t.sheetGridCell=t.sheetGridRange=t.sheetGridCube=t.gridCell=t.gridRange=t.unsafeGridRange=t.sheetRangeIndexes=t.allSheetsRange=t.sheetIndex=t.sheetRange=t.structRefColumnLoc=t.documentLoc=t.sheetCols=t.sheetRows=t.lexicalSourceUDF=t.lexicalSourceWSF=t.lexicalSourceName=t.lexicalSourceGrid=t.lexicalSourceRange=t.lexicalSourceCell=t.NameSource=t.LexicalKind=void 0;const n=r(91092);var a,i,o=n.assertions.assertIndex,s=n.assertions.assertPositiveLength,u=n.assertions.assertFalse;function l(e){return{kind:a.Cell,range:e}}function c(e){return{kind:a.Range,range:e}}function d(e,t,r){return{document:e,index:t,index2:r}}function g(e,t){return d(e,t,t)}function m(e,t,r,n){return{row:e,col:t,rows:r,cols:n}}function h(e,t){return{sheet:e,range:t}}function p(e){return{document:e,index:void 0}}function f(e){return e.index===e.index2}function S(e){return 1===e.rows&&1===e.cols}function v(e){return S(e.range)}!function(e){e[e.Cell=1]="Cell",e[e.Range=2]="Range",e[e.NameManager=3]="NameManager",e[e.CondFormatting=4]="CondFormatting",e[e.DataValidation=5]="DataValidation",e[e.Indirect=6]="Indirect",e[e.WSF=7]="WSF",e[e.UDF=8]="UDF",e[e.Other=9]="Other"}(a||(t.LexicalKind=a={})),function(e){e.AppHead="AppHead",e.Plain="Plain",e.StructRef="StructRef",e.Indirect="Indirect"}(i||(t.NameSource=i={})),t.lexicalSourceCell=l,t.lexicalSourceRange=c,t.lexicalSourceGrid=function(e,t){switch(e){case a.Cell:return v(t)?l(t):u("calc.lang.lexicalSourceGrid: expected cell");case a.Range:return c(t)}},t.lexicalSourceName=function(e){return{kind:a.NameManager,name:e}},t.lexicalSourceWSF=function(e){return{kind:a.WSF,id:e}},t.lexicalSourceUDF=function(e){return{kind:a.UDF,udf:e}},t.sheetRows=1<<20,t.sheetCols=16384,t.documentLoc=function(e,t){return{path:e,name:t}},t.structRefColumnLoc=function(e,t,r,n){return{name:e,range:t,hasHeadersRow:r,hasTotalsRow:n}},t.sheetRange=d,t.sheetIndex=g,t.allSheetsRange=function(e){return{document:e,index:void 0,index2:void 0}},t.sheetRangeIndexes=function(e,t){return{sheets:e,position:t}},t.unsafeGridRange=m,t.gridRange=function(e,r,n,a){return o("calc.lang.gridRange",e,t.sheetRows),o("calc.lang.gridRange",r,t.sheetCols),s("calc.lang.gridRange",n,t.sheetRows-e),s("calc.lang.gridRange",a,t.sheetCols-r),m(e,r,n,a)},t.gridCell=function(e,r){return o("calc.lang.gridCell",e,t.sheetRows),o("calc.lang.gridCell",r,t.sheetCols),m(e,r,1,1)},t.sheetGridCube=h,t.sheetGridRange=h,t.sheetGridCell=h,t.originCell=h,t.documentScope=p,t.nameScope=function(e,t){return void 0===t?p(e):g(e,t)},t.nameLoc=function(e,t){return{scope:e,name:t}},t.userDefinedFuncLoc=function(e,t){return{document:e,id:t}},t.isSheetIndex=f,t.isGridCell=S,t.isSheetGridRange=function(e){return f(e.sheet)},t.isSheetGridCell=v},47794:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatScientificLeft=t.numberComponents=void 0;const n=r(80168);t.numberComponents=(0,n.typedInstanceCreator)()(((e,t,r)=>({sign:e,mantissa:t,exponent:r}))),t.formatScientificLeft=function(e,t){if(t<=1)return t;const r=e%t;return 0===r?t:r<0?r+t:r}},74802:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ieeeMathpack=void 0;const n=r(74643),a=r(91176),i=r(80168),o=r(47794),s=n.__importStar(r(34166)),u=r(73567),l=r(72858),c=r(61824),d=r(43492),{codePointDigitZero:g}=s;function m(e){return{kind:c.OperKind.Number,_valueIEEE:e}}const h=m(0),p=m(1),f=m(Math.PI);function S(e){return isFinite(e)?m(e):a.numErrorOper}function v(e,t){const{_valueIEEE:r}=e,{_valueIEEE:n}=t;return r<n?-1:r>n?1:0}function F(e,t){const r=void 0===t?e.toExponential():e.toExponential(t),n=r.indexOf("e"),a=!(0,u.stringStartsWith)(r,"-"),i=r.substring(a?0:1,n).replace(".",""),o=parseInt(r.substring(n+1),10)+1;return function(e){for(let t=0;t<e.length;t+=1)if(e.charCodeAt(t)!==g)return!1;return!0}(i)?{sign:a,mantissa:"",exponent:0}:{sign:a,mantissa:i,exponent:o}}const y=["0","1","2","3","4","5","6","7","8","9"];function C(e){const{_valueIEEE:t}=e;return m(t<0?Math.ceil(t):Math.floor(t))}function A(e){const{_valueIEEE:t}=e;return m(Math.floor(t))}function E(e){return e.substring(0,1)+"."+e.substring(1)}t.ieeeMathpack={zero:h,one:p,pi:f,add:(e,t)=>S(e._valueIEEE+t._valueIEEE),sub:(e,t)=>S(e._valueIEEE-t._valueIEEE),mul:(e,t)=>S(e._valueIEEE*t._valueIEEE),div:function(e,t){const{_valueIEEE:r}=e,{_valueIEEE:n}=t;return 0===n?a.div0ErrorOper:S(r/n)},power:function(e,t){const{_valueIEEE:r}=e,{_valueIEEE:n}=t,i=r**n;return isFinite(i)?m(i):isNaN(i)?a.div0ErrorOper:a.numErrorOper},percent:e=>m(e._valueIEEE/100),neg:e=>m(-e._valueIEEE),compare:v,formatGeneral:function({decimalSeparator:e},t,r){const{_valueIEEE:n}=t;let a=String(n).replace("e","E");return"."!==e&&(a=a.replace(".",e)),a},formatFixed:function(e,t,r){const{_valueIEEE:n}=e;let{sign:a,mantissa:i,exponent:s}=F(n),u=r+(s+t);if(0===u){const e=parseFloat("5e"+String(s-1));if(Math.abs(n)>=e)return(0,o.numberComponents)(a,"1",s+t+1)}if(u<1)return(0,o.numberComponents)(!0,"",0);u<=21&&(({sign:a,mantissa:i,exponent:s}=F(n,u-1)),u=r+(s+t));const l=i.substring(0,u);return(0,o.numberComponents)(a,l,0===l.length?0:s+t)},formatScientific:function(e,t,r){const{_valueIEEE:n}=e;let{sign:a,mantissa:i,exponent:s}=F(n),u=(0,o.formatScientificLeft)(s,t),c=u+r;if((0,l.assertTrue)("calc.lang.ieeeFormatScientific",c>0),0===c){const e=parseFloat("5e"+String(s-1));if(Math.abs(n)>=e)return(0,o.numberComponents)(a,"",s+1)}if(c<1)return(0,o.numberComponents)(!0,"",0);c<=21&&(({sign:a,mantissa:i,exponent:s}=F(n,c-1)),u=(0,o.formatScientificLeft)(s,t),c=u+r);const d=i.substring(0,c);return(0,o.numberComponents)(a,d,0===d.length?0:s)},parse:function(e,t,r,n){return m(Number((t?"":"-")+"0."+function({getOrdinal:e},t){let r="";for(const n of(0,d.codePointIterator)(t))r+=y[e(n)];return r}(e,n)+"E"+String(r)))},trunc:C,ceil:function(e){const{_valueIEEE:t}=e;return m(Math.ceil(t))},floor:A,abs:e=>m(Math.abs(e._valueIEEE)),cond:e=>v(e,h),cond2:v,fromNumber:m,toNumber:e=>e._valueIEEE,sqrt:e=>S(Math.sqrt(e._valueIEEE)),exp:e=>S(Math.exp(e._valueIEEE)),ln:e=>S(Math.log(e._valueIEEE)),log:e=>S(Math.log(e._valueIEEE)/Math.LN10),sin:e=>m(Math.sin(e._valueIEEE)),cos:e=>m(Math.cos(e._valueIEEE)),tan:e=>m(Math.tan(e._valueIEEE)),asin:e=>S(Math.asin(e._valueIEEE)),acos:e=>S(Math.acos(e._valueIEEE)),atan:e=>S(Math.atan(e._valueIEEE)),atan2:(e,t)=>m(Math.atan2(t._valueIEEE,e._valueIEEE)),mod:(e,t)=>m(e._valueIEEE%t._valueIEEE),round:function(e,t){const{_valueIEEE:r}=e;if(0===r)return h;const{exponent:n}=F(r),a=C(t)._valueIEEE+n;if(0===a){const e=parseFloat("5e"+String(n-1));if(Math.abs(r)>=e)return S((r<0?-1:1)*parseFloat("10e"+String(n-1)))}return a<1?h:a>21?e:S(parseFloat(r.toExponential(a-1)))},roundUp:function(e,t){const{_valueIEEE:r}=e;if(0===r)return h;const{sign:n,mantissa:a,exponent:i}=F(r),o=C(t)._valueIEEE+i;return o<1?S(parseFloat((n?"":"-")+"10e"+String(i-1-o))):o>21?e:S(parseFloat((n?"":"-")+function(e,t){if(e.length<=t)return E(e);const r=e.substring(0,t);let n=0;for(let e=r.length-1;e>=0&&r.charCodeAt(e)-g==9;e-=1)n+=1;return n===r.length?"10":E(r.substring(0,r.length-n-1)+String.fromCharCode(r.charCodeAt(r.length-n-1)+1))}(a,o)+"e"+String(i-1)))},roundDown:function(e,t){const{_valueIEEE:r}=e;if(0===r)return h;const{sign:n,mantissa:a,exponent:i}=F(r),o=C(t)._valueIEEE+i;if(o<1)return h;if(o>21)return e;const s=a.substring(0,o);return S(parseFloat((n?"":"-")+E(s)+"e"+String(i-1)))},tenTo:function(e){return(0,l.assertInteger)("calc.lang.ieeeTenTo",e),S(Math.pow(10,e))},checkAlmostCancellation:(e,t)=>t,fix:function(e){const{_valueIEEE:t}=e,r=Math.abs(t);return r>=4294967296?4294967295:Math.floor(r)},lfix:function(e){const t=C(e)._valueIEEE;return t<-2147483648||t>2147483647?-2147483648:t},sfix:function(e){const t=A(e)._valueIEEE;return t<-2147483648?-2147483648:t>2147483647?2147483647:t},viewRound:i.identity}},21174:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xlMathpack=void 0;const n=r(60145),a=r(91176),i=r(72858),o=r(61824),s=r(80168);function u(e){return{kind:o.OperKind.Number,_valueXL:e}}const l=u(n.mathpack.zero()),c=u(n.mathpack.one()),d=u(n.mathpack.pi());function g(e){return 0!=(e.num&n.mathpack.MathErrorNum.DivBy0)?a.div0ErrorOper:a.numErrorOper}function m(e){return t=>(0,i.assertFalse)(`calc.lang.${e}: error ${JSON.stringify(t)}`)}function h(e,t,r){return n=>{const a=e(n._valueXL);return"number"==typeof a?t(a):r(a)}}function p(e,t,r){return(n,a)=>{const i=e(n._valueXL,a._valueXL);return"number"==typeof i?t(i):r(i)}}const f=p(((e,t)=>n.mathpack.equal(t,2)?n.mathpack.mul(e,e):n.mathpack.power(e,t)),u,g),S=h((e=>n.mathpack.div(e,100)),u,m("xlPercent")),v=h(n.mathpack.ceil,u,m("xlCeil")),F=h(n.mathpack.floor,u,m("xlFloor")),y=h(n.mathpack.cond,s.identity,m(`xlCond, isSupported = ${(0,n.isSupported)()}`)),C=p(n.mathpack.cond2,s.identity,m("xlCond2")),A=h(n.mathpack.sfix,s.identity,m("xlSfix")),E=h(n.mathpack.viewRound,u,m("xlViewRound"));t.xlMathpack={zero:l,one:c,pi:d,add:p(n.mathpack.add,u,g),sub:p(n.mathpack.sub,u,g),mul:p(n.mathpack.mul,u,g),div:p(n.mathpack.div,u,g),power:f,percent:S,neg:function(e){return 0!==y(e)?u(n.mathpack.neg(e._valueXL)):e},compare:(e,t)=>n.mathpack.compare(e._valueXL,t._valueXL),formatGeneral:function(e,t,r){const{_valueXL:a}=t,o=n.mathpack.formatGeneral(e,a,r);return"string"!=typeof o?(0,i.assertFalse)(`calc.lang.xlFormatGeneral: error ${JSON.stringify(o)}`):o},formatFixed:function(e,t,r){const{_valueXL:a}=e,o=n.mathpack.formatFixed(a,t,r);return"object"!=typeof o?(0,i.assertFalse)(`calc.lang.xlFormatFixed: error ${JSON.stringify(o)}`):o},formatScientific:function(e,t,r){const{_valueXL:a}=e,o=n.mathpack.formatScientific(a,t,r);return"object"!=typeof o?(0,i.assertFalse)(`calc.lang.xlFormatScientific: error ${JSON.stringify(o)}`):o},parse:function(e,t,r,a){const o=n.mathpack.pack(e,t,r,a);return"number"!=typeof o?(0,i.assertFalse)(`calc.lang.xlParse: error ${JSON.stringify(o)}`):u(o)},trunc:e=>u(n.mathpack.trunc(e._valueXL)),ceil:v,floor:F,abs:e=>u(n.mathpack.abs(e._valueXL)),cond:y,cond2:C,fromNumber:function(e){return(0,i.assertTrue)("calc.lang.xlFromNumber",isFinite(e)),u(e)},toNumber:function(e){const{_valueXL:t}=e;return(0,i.assertTrue)("calc.lang.xlToNumber",isFinite(t)),t},sqrt:h(n.mathpack.sqrt,u,g),exp:h(n.mathpack.exp,u,g),ln:h(n.mathpack.ln,u,g),log:h(n.mathpack.log,u,g),sin:h(n.mathpack.sin,u,g),cos:h(n.mathpack.cos,u,g),tan:h(n.mathpack.tan,u,g),asin:h(n.mathpack.asin,u,g),acos:h(n.mathpack.acos,u,g),atan:h(n.mathpack.atan,u,g),atan2:p(n.mathpack.atan2,u,g),mod:p(n.mathpack.mod,u,g),round:p(n.mathpack.round,u,g),roundUp:p(n.mathpack.roundUp,u,g),roundDown:p(n.mathpack.roundDown,u,g),tenTo:function(e){(0,i.assertInteger)("calc.lang.xlTenTo",e);const t=n.mathpack.tenTo(e);return"number"==typeof t?u(t):g(t)},checkAlmostCancellation:function(e,t){const{_valueXL:r}=e,{_valueXL:a}=t;return n.mathpack.exp32(r)-n.mathpack.exp32(a)>=52428800?l:t},fix:e=>n.mathpack.fix(e._valueXL),lfix:e=>n.mathpack.lfix(e._valueXL),sfix:A,viewRound:E}},16782:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KnownFormat=t.Calendar=t.NumberShape=t.DateOrder=t.CurrencyFormat=void 0;const n=r(9330);var a,i,o;t.CurrencyFormat=n.CurrencyFormat,t.DateOrder=n.DateOrder,function(e){e.ASCII="ASCII",e.ArabicIndic="ArabicIndic",e.ExtendedArabicIndic="ExtendedArabicIndic",e.Devanagari="Devanagari",e.Bengali="Bengali",e.Gurmukhi="Gurmukhi",e.Gujarati="Gujarati",e.Oriya="Oriya",e.Tamil="Tamil",e.Telugu="Telugu",e.Kannada="Kannada",e.Malayalam="Malayalam",e.Thai="Thai",e.Lao="Lao",e.Tibetan="Tibetan",e.Myanmar="Myanmar",e.Ethiopic="Ethiopic",e.Khmer="Khmer",e.Mongolian="Mongolian",e.ChineseTrad1="ChineseTrad1",e.ChineseTrad2="ChineseTrad2",e.ChineseTrad3="ChineseTrad3",e.ChineseSimp1="ChineseSimp1",e.ChineseSimp2="ChineseSimp2",e.ChineseSimp3="ChineseSimp3",e.Japanese1="Japanese1",e.Japanese2="Japanese2",e.Japanese3="Japanese3",e.Korean1="Korean1",e.Korean2="Korean2",e.Korean3="Korean3",e.Korean4="Korean4"}(a||(t.NumberShape=a={})),function(e){e.Gregorian="Gregorian",e.GregorianUS="GregorianUS",e.Japan="Japan",e.Taiwan="Taiwan",e.Korea="Korea",e.Hijri="Hijri",e.Thai="Thai",e.Hebrew="Hebrew",e.GregorianMEFrench="GregorianMEFrench",e.GregorianArabic="GregorianArabic",e.GregorianXlitEnglish="GregorianXlitEnglish",e.GregorianXlitFrench="GregorianXlitFrench",e.Persian="Persian",e.UmAlQura="UmAlQura"}(i||(t.Calendar=i={})),function(e){e[e.General=0]="General",e[e.NoComFixed0=-1]="NoComFixed0",e[e.NoComFixed=-2]="NoComFixed",e[e.Fixed0=-3]="Fixed0",e[e.Fixed=-4]="Fixed",e[e.Currency=-9]="Currency",e[e.CoCurrency=-10]="CoCurrency",e[e.CurrencyDec=-11]="CurrencyDec",e[e.CoCurrencyDec=-12]="CoCurrencyDec",e[e.Pct0=-13]="Pct0",e[e.Pct=-14]="Pct",e[e.Exp=-15]="Exp",e[e.Fract=-17]="Fract",e[e.FractBond=-18]="FractBond",e[e.MMDDYY=-19]="MMDDYY",e[e.DDMMMYY=-20]="DDMMMYY",e[e.DDMMM=-21]="DDMMM",e[e.MMMYY=-22]="MMMYY",e[e.HHMMAP=-23]="HHMMAP",e[e.HHMMSSAP=-24]="HHMMSSAP",e[e.HHMM=-25]="HHMM",e[e.HHMMSS=-26]="HHMMSS",e[e.MDYHMS=-27]="MDYHMS",e[e.Currency2=-5]="Currency2",e[e.CoCurrency2=-6]="CoCurrency2",e[e.CurrencyDec2=-7]="CurrencyDec2",e[e.CoCurrencyDec2=-8]="CoCurrencyDec2",e[e.Acct=-33]="Acct",e[e.AcctCur=-32]="AcctCur",e[e.AcctDec=-35]="AcctDec",e[e.AcctDecCur=-34]="AcctDecCur",e[e.MMSS=-28]="MMSS",e[e.AbsHMMSS=-31]="AbsHMMSS",e[e.SS0=-29]="SS0",e[e.Eng=-16]="Eng",e[e.Text=-30]="Text",e[e.USCoCurrency=-1037]="USCoCurrency",e[e.USCoCurrencyDec=-1039]="USCoCurrencyDec",e[e.NoComFixed0_Tha=-2036]="NoComFixed0_Tha",e[e.NoComFixed_Tha=-2037]="NoComFixed_Tha",e[e.Fixed0_Tha=-2038]="Fixed0_Tha",e[e.Fixed_Tha=-2039]="Fixed_Tha",e[e.CoCurrency_Tha=-2041]="CoCurrency_Tha",e[e.CoCurrencyDec_Tha=-2043]="CoCurrencyDec_Tha",e[e.Pct0_Tha=-2044]="Pct0_Tha",e[e.Pct_Tha=-2045]="Pct_Tha",e[e.MMDDYY_Tha=-2048]="MMDDYY_Tha",e[e.DDMMMYY_Tha=-2049]="DDMMMYY_Tha",e[e.DDMMM_Tha=-2050]="DDMMM_Tha",e[e.MMMYY_Tha=-2051]="MMMYY_Tha",e[e.HHMM_Tha=-2052]="HHMM_Tha",e[e.HHMMSS_Tha=-2053]="HHMMSS_Tha",e[e.MDYHMS_Tha=-2054]="MDYHMS_Tha",e[e.AbsHMMSS_Tha=-2055]="AbsHMMSS_Tha",e[e.MMSS_Tha=-2056]="MMSS_Tha",e[e.SS0_Tha=-2057]="SS0_Tha",e[e.DMBB_Tha=-2058]="DMBB_Tha"}(o||(t.KnownFormat=o={}))},67027:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPrinter=t.anonymizeFormula=void 0;const n=r(50667),a=r(91176),i=r(93383),o=r(72858),s=r(10041),u=r(66562),l=r(81187),c=r(21007),d=r(63346),g=r(73567),m=r(96089),h=r(51394),p=r(39470),f=r(97791),S=r(61824),v=r(83833),F=r(5886),y=r(43492),C=/'/g,A=/"/g,E=(0,u.sheetGridCell)((0,u.sheetIndex)((0,u.documentLoc)(void 0,"Book1"),0),(0,u.gridCell)(0,0));function b(e){if(!(0,p.isSuccess)(e)&&e.reason.kind!==m.ResolveReasonKind.NoOriginSheet&&e.reason.kind!==m.ResolveReasonKind.InvalidQualifier&&e.reason.kind!==m.ResolveReasonKind.InvalidCellRef&&e.reason.kind!==m.ResolveReasonKind.InvalidStructRef&&e.reason.kind!==m.ResolveReasonKind.EmptyIntersection)throw new K(e.reason)}var R;function T(e){const t=[],r=[];for(const n of e)n.length>0&&(0,y.numCodeUnits)((0,y.stringCodePointAt)(n,0))===n.length?t[(0,y.stringCodePointAt)(n,0)]=!0:r.push(n);return(e,n)=>{const a=(0,y.stringCodePointAt)(e,n);if(!0===t[a])return!0;for(const t of r)if((0,g.stringStartsWith)(e,t,n))return!0;return!1}}function k(e,t){let r="";for(let n=0;n<e.length;){t(e,n)&&(r+="'");const a=(0,y.stringCodePointAt)(e,n);r+=(0,y.stringFromCodePoint)(a),n+=(0,y.numCodeUnits)(a)}return r}!function(e){e[e.Original=0]="Original",e[e.Bracketed=1]="Bracketed",e[e.Unbracketed=2]="Unbracketed"}(R||(R={}));class N{constructor(e){this.str=e,this.append=O,this.length=e.length}}class I{constructor(e,t){this.lhs=e,this.rhs=t,this.append=O,this.length=e.length+t.length}}function O(e){return new I(this,"string"==typeof e?new N(e):e)}function _(e,t){return 0===e.length?new N(""):e.reduce(((e,r)=>e.append(t).append(r)))}const P={pre:"",preComments:void 0},M={pre:" ",preComments:void 0},D={post:"",postComments:void 0},w={literalNode:(e,t,r)=>r,arrayNode:(e,t,r)=>r,appNode:(e,t,r,n)=>n,letNode:(e,t,r,n,a,i)=>i,lambdaNode:(e,t,r,n,a,i)=>i,parenNode:(e,t,r)=>r,nameNode:(e,t,r)=>r,cellRefNode:(e,t,r)=>r,fieldRefNode:(e,t,r)=>r,structRefNode:(e,t,r)=>r,missingNode:(e,t)=>t,badSequenceNode:(e,t,r)=>r,badCharsNode:(e,t,r)=>r,operatorNode:(e,t)=>t,wsfNode:(e,t,r)=>r},L={...(0,f.constVisitor)(void 0),operatorNode:e=>e};class x{print(){const e=new f.ComposeVisitor(new f.ZipVisitor({str:this,label:w,op:L}),(e=>(this.record(e.label,e.str),e))),t=(0,f.reduceBottomUp)(e,this.root),r=new N("=").append(this.recordPrePost(t.label,this.pre(t.label,P),t.str,this.postIfComments(t.label)));return this.printRope(r)}pre(e,t){return this.anonymize?t:this.spans[e]??t}post(e,t){return this.anonymize?t:this.spans[e]??t}preIfComments(e){if(this.anonymize)return P;const t=this.spans[e];return null!=t?.preComments&&t.preComments.length>0?t:P}postIfComments(e){if(this.anonymize)return D;const t=this.spans[e];return null!=t?.postComments&&t.postComments.length>0?t:D}printRef(e,t){let r=new N("");switch(e.kind){case n.StructRefKind.SpecialRef:{(t===R.Original&&e.isBracketed||t===R.Bracketed)&&(r=r.append(this.localeInfo.leftBracket));const n=this.localeInfo.specialRefNames[e.id];if(null==n)throw new K((0,s.internal)("No locale data for specialRefName"));r=r.append(n),(t===R.Original&&e.isBracketed&&e.isClosed||t===R.Bracketed)&&(r=r.append(this.localeInfo.rightBracket));break}case n.StructRefKind.ColumnRef:{const n=0===e.name.length||(0,g.stringStartsWith)(e.name," ")||(0,g.stringEndsWith)(e.name," ");(t===R.Original&&e.isBracketed||t===R.Bracketed||t===R.Unbracketed&&n)&&(r=r.append(this.localeInfo.leftBracket));const a=k(e.name,this.isStructRefEscapable);r=r.append(this.anon(a)),(t===R.Original&&e.isBracketed&&e.isClosed||t===R.Bracketed||t===R.Unbracketed&&n)&&(r=r.append(this.localeInfo.rightBracket));break}case n.StructRefKind.RangeOpRef:r=r.append(this.printRef(e.lhs,t===R.Original?t:R.Bracketed)).append(":").append(this.printRef(e.rhs,t===R.Original?t:R.Bracketed));break;case n.StructRefKind.MissingRef:break;case n.StructRefKind.BadRef:e.isBracketed&&(r=r.append(this.localeInfo.leftBracket)),r=r.append(this.anon(e.chars)),e.isBracketed&&e.isClosed&&(r=r.append(this.localeInfo.rightBracket))}return this.record(e.label,r)}printThisRowOpRef(e,t){let r=new N("@");return e&&(r=e.kind===n.StructRefKind.ColumnRef?r.append(this.printRef(e,e.isClosed?function(e,t){for(let r=0;r<e.length;){if(t(e,r))return!0;r+=(0,y.numCodeUnits)((0,y.stringCodePointAt)(e,r))}return!1}(e.name,this.isStructRefBracketedThisRef)?R.Bracketed:R.Unbracketed:R.Original)):r.append(this.printRef(e,(0,s.isRangeOpClosed)(e)&&(0,s.isRangeOpNoMissing)(e)?R.Bracketed:R.Original))),this.record(t,r)}printApplication(e,t,r,n){const a=t.map(((e,t,r)=>this.recordPrePost(e.label,this.pre(e.label,0===t||0===e.str.length?P:M),e.str,t===r.length-1?this.post(e.label,D):this.postIfComments(e.label))));return e.str.append("(").append(_(a,this.localeInfo.listSeparator)).append(r?")":"")}printCellRef({ref:e,qualifier:t}){return(void 0!==t?this.recordPrePost(t.label,P,(0,f.visitQualifier)(this,t).str,this.postIfComments(t.label)):new N("")).append((0,f.visitCellRef)(this,e).str)}printName({qualifier:e,parts:t},r){const a=void 0!==e?this.recordPrePost(e.label,P,(0,f.visitQualifier)(this,e).str,this.postIfComments(e.label)):new N("");let i=new N("");for(const e of(0,n.flattenNameParts)(t).parts){let t;if(e.kind===n.NamePartKind.FieldRefNamePart){const r=e.rhs.field;t=this.record(e.rhs.label,new N(".").append(this.record(r.label,this.anon(r.kind===n.NodeKind.Ident?r.whole:r.chars))))}else t=e.kind===n.NamePartKind.CellRefNamePart&&r===m.ResolvedKind.ResolvedCellRef?this.printCellRef((0,n.cellRefNode)(e.ref,void 0,e.label)):new N(this.anon(e.asWhole));i=this.record(e.label,i.append(t)),this.recordQualified(e.qualifiedLabel,a,i)}return a.append(i)}printUnrecordedDocQual(e){if(void 0===e)return e;const{path:t,document:r}=e;return this.anon((t??"")+this.localeInfo.leftBracket+r+this.localeInfo.rightBracket)}printParamNameIdent(e){return e.kind===n.NodeKind.Ident?this.record(e.label,this.anon((0,s.getBoundName)(this.localeInfo,e.whole))):this.recordPrePost(e.label,this.pre(e.label,P),this.anon(e.chars),this.post(e.label,D))}printParamName(e){return this.record(e.label,new N(e.isBracketed?this.localeInfo.leftBracket:"").append(this.printParamNameIdent(e.name)).append(e.isBracketed&&e.isClosed?this.localeInfo.rightBracket:""))}record(e,t){const r="string"==typeof t?new N(t):t;return this.labelToRope[e]={ropeStart:r,ropeEnd:r,startOffset:0,endOffset:0,pre:"",post:"",preComments:void 0,postComments:void 0},r}recordQualified(e,t,r){this.labelToRope[e]={ropeStart:t,ropeEnd:r,startOffset:0,endOffset:0,pre:"",post:"",preComments:void 0,postComments:void 0}}recordPrePost(e,{pre:t,preComments:r},n,{post:a,postComments:i}){const o="string"==typeof n?new N(n):n,s=new N(t),u=new N(a);return this.labelToRope[e]={ropeStart:o,ropeEnd:o,startOffset:0,endOffset:0,pre:t,post:a,preComments:r,postComments:i},r&&this.recordComments(r,s,this.spans[e].start-t.length),i&&this.recordComments(i,u,this.spans[e].end),s.append(o).append(u)}recordComments(e,t,r){for(const n of e){const e=this.spans[n.label];if(null==e)return;this.labelToRope[n.label]={ropeStart:t,ropeEnd:t,startOffset:e.start-r,endOffset:e.end-r-t.length,pre:"",post:"",preComments:void 0,postComments:void 0}}}printRope(e){const{str:t,ropeToSpan:r}=function(e){const t=new Map,r=[];let n=0;const a=[e];for(;a.length>0;){const e=a.pop();t.set(e,{start:n,end:n+e.length}),e instanceof I?a.push(e.rhs,e.lhs):(r.push(e.str),n+=e.str.length)}return{str:r.join(""),ropeToSpan:t}}(e),a=[];for(const e of Object.keys(this.labelToRope).map(Number)){const{ropeStart:t,ropeEnd:i,startOffset:o,endOffset:s,pre:u,post:l,preComments:c,postComments:d}=this.labelToRope[e],{start:g}=r.get(t),{end:m}=r.get(i);a[e]=(0,n.formulaSpan)(g+o,m+s,u,l,c,d)}return{formula:t,spans:a}}literalNode(e,t,r){switch(e.kind){case S.OperKind.String:return new N('"'+this.anon(e.value).replace(A,'""')+'"');case S.OperKind.Boolean:return new N(e.value?this.localeInfo.trueName:this.localeInfo.falseName);case S.OperKind.Number:const t=21;return new N(this.anon(this.mathpack.formatGeneral(this.localeInfo,e,t)));case S.OperKind.Missing:return new N("");case S.OperKind.Error:const r=this.localeInfo.errorNames[e.type];if(null==r)throw new K((0,s.internal)(`No locale data for error type ${e.type}`));return new N(r);default:return(0,o.assertNever)("calc.lang.printFormula",e)}}missingNode(e,t){return new N(this.anon(e))}arrayNode(e,t,r){return new N(this.localeInfo.leftBrace).append(_(e.map((e=>_(e.map((e=>this.recordPrePost(e.label,this.preIfComments(e.label),e.str,this.postIfComments(e.label)))),this.localeInfo.columnSeparator))),this.localeInfo.rowSeparator)).append(t?this.localeInfo.rightBrace:"")}appNode(e,t,r,n){if(void 0!==e.op){if(1===t.length){const r=t[0];switch(e.op){case i.OperatorId.Percent:return r.str.append(this.recordPrePost(e.label,this.pre(e.label,P),e.str,D));case i.OperatorId.Pound:return r.str.append(this.recordPrePost(e.label,this.preIfComments(e.label),e.str,D));default:return this.recordPrePost(e.label,P,e.str,this.post(e.label,D)).append(r.str)}}if(2===t.length){const[r,n]=t;let a=" ",o=" ";switch(e.op){case i.OperatorId.Range:a=o="";break;case i.OperatorId.Isect:o="";break;case i.OperatorId.Union:a=""}return r.str.append(this.recordPrePost(e.label,this.pre(e.label,{pre:a}),e.str,this.post(e.label,{post:o}))).append(n.str)}return(0,o.assertFalse)("calc.lang.printFormula: invalid number of operator args")}return this.printApplication(e,t,r,n)}letNode(e,t,r,a,i,o){const u=t.map((({name:e,binder:t})=>(0,n.letVar)((0,n.indexedArg)({str:this.record(e.arg.label,this.record(e.arg.name.label,this.anon((0,s.getBoundName)(this.localeInfo,e.arg.wholeName)))),label:e.arg.label,op:void 0},e.index),t)));return this.printApplication(e,(0,n.flattenLetArgs)(u,r,a),i,o)}lambdaNode(e,t,r,a,i,o){const s=t.map((({name:e})=>{const t=this.printParamName(e.arg.name),r=void 0===e.arg.def?new N(""):this.recordPrePost(e.arg.def.label,this.pre(e.arg.def.label,M),new N(":=").append(this.recordPrePost(e.arg.def.rhs.label,this.pre(e.arg.def.rhs.label,0===e.arg.def.rhs.str.length?P:M),e.arg.def.rhs.str,D)),D);return(0,n.lambdaParam)((0,n.indexedArg)({str:t.append(r),label:e.arg.label,op:void 0},e.index))}));return this.printApplication(e,(0,n.flattenLambdaArgs)(s,r,a),i,o)}parenNode(e,t,r){return new N("(").append(this.recordPrePost(e.label,this.pre(e.label,P),e.str,this.post(e.label,D))).append(t?")":"")}nameNode(e,t,r){const{headResolved:a,node:i}=this.resolver.resolveDottedName(this.locals,(0,n.nameNode)(e,t,r),this.annotations);return b(a.resolution),this.printName(i,a.kind)}cellRefNode(e,t,r){const{node:a,resolution:i}=this.resolver.resolveCellRef(this.locals,(0,n.cellRefNode)(e,t,r));return b(i),this.printCellRef(a)}fieldRefNode(e,t,r){const a=t.shouldBeBracketed,i=t.isBracketed||a?this.localeInfo.leftBracket:"",o=t.isBracketed&&t.isClosed||a?this.localeInfo.rightBracket:"",s=this.record(t.field.label,this.anon(t.field.kind===n.NodeKind.Ident?k(t.field.whole,this.isFieldRefEscapable):t.field.chars)),u=t.field.kind!==n.NodeKind.Ident?this.pre(t.label,P):this.preIfComments(t.label);return e.str.append(this.recordPrePost(t.label,u,new N("."+i).append(s).append(o),this.post(t.label,D)))}structRefNode(e,t,r){const{node:a,table:i,resolution:o}=this.resolver.resolveStructRef(this.locals,(0,n.structRefNode)(e,t,r));b(o);const u=a.rhs.innerRef;let l=void 0===a.lhs?void 0:this.record(a.lhs.label,this.printName(a.lhs,m.ResolvedKind.ResolvedName));if(void 0!==l||void 0===i||!a.rhs.isClosed||u?.kind===n.StructRefKind.ColumnRef||u?.kind===n.StructRefKind.ThisRowOpRef&&u.ref?.kind===n.StructRefKind.ColumnRef||(l=new N(i.name)),void 0===u&&a.rhs.isClosed&&void 0!==l)return l;let c=new N(this.localeInfo.leftBracket);switch(u?.kind){case n.StructRefKind.ColumnRef:case n.StructRefKind.SpecialRef:if(u.kind===n.StructRefKind.SpecialRef&&u.id===n.SpecialRefId.ThisRow&&u.isClosed){c=c.append(this.printThisRowOpRef(void 0,u.label));break}c=c.append(this.printRef(u,u.isClosed?R.Unbracketed:R.Original));break;case n.StructRefKind.RangeOpRef:{const e=(0,s.isRangeOpClosed)(u)&&(0,s.isRangeOpNoMissing)(u)?R.Bracketed:R.Original;c=c.append(this.printRef(u,e));break}case n.StructRefKind.CommaOpRef:{const e=(0,s.isCommaOpRefWellFormed)(u)&&(0,s.isCommaOpClosed)(u)&&(0,s.isCommaOpNoBadOrMissing)(u);if(e&&u.specialRefs[n.SpecialRefId.ThisRow]){c=c.append(this.printThisRowOpRef(0===u.columnRefs.length?void 0:u.columnRefs[0],u.label));break}const t=e?(0,s.normalizeCommaOpRef)(u):u.refs,r=e?1===t.length?R.Unbracketed:R.Bracketed:R.Original;c=c.append(this.record(u.label,_(t.map((e=>this.printRef(e,r))),this.localeInfo.listSeparator)));break}case n.StructRefKind.ThisRowOpRef:c=c.append(this.printThisRowOpRef(u.ref,u.label));break;case n.StructRefKind.BadRef:c=c.append(this.printRef(u,R.Original))}return a.rhs.isClosed&&(c=c.append(this.localeInfo.rightBracket)),(l??new N("")).append(this.record(a.rhs.label,c))}badSequenceNode(e,t,r){return _(t.map((e=>this.recordPrePost(e.label,this.pre(e.label,P),e.str,this.post(e.label,D)))),"")}badCharsNode(e,t,r){return new N(this.anon(t))}operatorNode(e,t){const r=(0,l.operatorIdToName)(this.localeInfo,e,"");if(void 0===r)throw new K((0,s.internal)("Invalid operator"));return new N(r)}wsfNode(e,t,r){return new N(this.localeInfo.getWorksheetFuncName(e))}cellRefError(e){const t=this.localeInfo.errorNames[a.ErrorType.REF];if(null==t)throw new K((0,s.internal)("No locale data for #REF"));return{str:this.record(e,t),label:e}}cellRefSingle(e,t,r,n){const a=(0,d.formatCellPos)(this.localeInfo,this.refStyle,this.locals.originGridCell.value,e,t,this.locals.wrapCellReferences);return void 0!==a?{str:this.record(n,this.anon(a)),label:n}:this.cellRefError(n)}cellRefRange(e,t,r){const n=(0,d.formatRangePos)(this.localeInfo,this.refStyle,this.locals.originGridCell.value,e.row,e.col,t.row,t.col,this.locals.wrapCellReferences);return void 0!==n?{str:this.record(r,this.anon(n)),label:r}:this.cellRefError(r)}cellRefRow(e,t,r,n){const a=(0,d.formatRowRange)(this.localeInfo,this.refStyle,this.locals.originGridCell.value.row,e,t,this.locals.wrapCellReferences);return void 0!==a?{str:this.record(n,this.anon(a)),label:n}:this.cellRefError(n)}cellRefCol(e,t,r,n){const a=(0,d.formatColRange)(this.localeInfo,this.refStyle,this.locals.originGridCell.value.col,e,t,this.locals.wrapCellReferences);return void 0!==a?{str:this.record(n,this.anon(a)),label:n}:this.cellRefError(n)}cellRefBad(e,t,r){return{str:this.record(r,this.anon(e)),label:r}}errorQualifier(e){const t=this.localeInfo.errorNames[a.ErrorType.REF];if(null==t)throw new K((0,s.internal)("No locale data for #REF"));return{str:this.record(e,t),label:e}}relativeQualifier(e){return{str:this.record(e,"!"),label:e}}documentQualifier(e,t,r,a){return{str:this.record(a,(0,d.quoteQualifier)(this.printUnrecordedDocQual((0,n.documentQualifier)(e,t)))+"!"),label:a}}sheetQualifier(e,t,r,n){let a=this.printUnrecordedDocQual(t),i=this.anon(e);const o=(0,d.shouldQuoteQualifier)(this.localeInfo,this.refStyle,(a??"")+i);return o&&(a=a?.replace(C,"''"),i=i.replace(C,"''")),{str:this.record(n,new N(o?"'":"").append(void 0===a?new N(""):this.record(t.label,a)).append(i).append(o?"'":"").append("!")),label:n}}identQualifier(e,t,r){return{str:this.record(r,(0,d.formatQualifier)(this.localeInfo,this.refStyle,this.anon(e))+"!"),label:r}}sheetRangeQualifier(e,t,r,n,a){let i=this.printUnrecordedDocQual(r),o=this.anon(e),s=this.anon(t);const u=(0,d.shouldQuoteQualifier)(this.localeInfo,this.refStyle,(i??"")+o)||(0,d.shouldQuoteQualifier)(this.localeInfo,this.refStyle,s);return u&&(i=i?.replace(C,"''"),o=o.replace(C,"''"),s=s.replace(C,"''")),{str:this.record(a,new N(u?"'":"").append(void 0===i?new N(""):this.record(r.label,i)).append(o).append(":").append(s).append(u?"'":"").append("!")),label:a}}badQualifier(e,t,r,n,a){return{str:this.record(a,this.anon(e)),label:a}}constructor(e,t,r,n){this.root=r,this.anonymize=n,this.labelToRope=[],this.anon=e=>this.anonymize?(0,c.anonymizeFormulaString)(e):e,this.locals=t,this.localeInfo=t.config?.localeInfo??e.config.localeInfo,this.mathpack=e.config.mathpack,this.refStyle=t.config?.refStyle??e.config.refStyle,this.resolver=(0,h.createResolver)(e),this.spans=r.spans,this.annotations=r.annotations;const a=["'",this.localeInfo.leftBracket,this.localeInfo.rightBracket,"#","@"],i=[...a,"\t","\n","\r"," ","!",'"',"$","%","&","(",")","*","+",this.localeInfo.listSeparator,"-",".","/",":",";","<","=",">","?","\\","^","_","`","{","}","~"];this.isStructRefEscapable=T(a),this.isStructRefBracketedThisRef=T(i),this.isFieldRefEscapable=T(["'",this.localeInfo.leftBracket,this.localeInfo.rightBracket])}}const K=(0,s.createFailureErrorClass)("PrintFormulaError"),W=(0,s.createFailureErrorClass)("PrintRangeError");function U(e,t,r,n=!1){try{return(0,p.success)(new x(e,t,r,n).print())}catch(e){return e instanceof K?(0,p.failure)(e.reason):(0,p.failure)((0,p.javaScriptError)(e))}}function G(e,t){return void 0===e?(0,n.pos)(n.PosKind.Abs,t):(0,n.pos)(n.PosKind.Rel,t-e)}function B(e,t,r){return(0,n.cellRefSingle)(G(e,r.row),G(t,r.col))}function V(e){return(0,p.isSuccess)(e)?((0,o.assertTrue)("calc.lang.printRangeStructRef: NameLoc can't be no-table",null!=e.value),(0,p.success)(e.value)):e.reason.kind===m.ResolveReasonKind.InvalidStructRef?(0,o.assertFalse)("calc.lang.printRangeStructRef: NameLoc can't be InvalidStructRef"):(0,p.failure)(e.reason)}function j(e,t,r,a=(0,v.makeEmptyTable)()){try{const i=t.originSheet.value;if(!(0,s.isDocumentLocEqual)(i.document,r.sheet.document))throw new W((0,s.notImplemented)(["printRange cross-document"]));return(0,p.success)(function(e,t,r,a){const i=t.originSheet.value,o=e.getNamedRanges(r);if(!(0,p.isSuccess)(o))throw new W(o.reason);if(0===o.value.length)return;const l=e=>void 0!==e.index&&(void 0===i.index||!(0,s.isSheetIndexEqual)(e,i)),c=o.value.filter((({scope:e})=>void 0===e.index?(0,s.isDocumentLocEqual)(e.document,r.sheet.document):(0,s.isSheetIndexEqual)(e,r.sheet))).filter((({scope:t,name:r})=>{if(void 0!==t.index||void 0===i.index)return!0;const n=i,a=e.getNameLoc(n,r,u.NameSource.Plain);if(!(0,p.isSuccess)(a))throw new W(a.reason);return null==a.value})).filter((({scope:e,name:t})=>l(e)||!a.contains(t)));if(0===c.length)return;const d=1===c.length?c[0]:[...c].sort(((t,r)=>e.config.localeInfo.stringCompareCI(t.name,r.name)))[0];let g;if(l(d.scope)){const t=e.getSheetName(d.scope.document,d.scope.index);if(!(0,p.isSuccess)(t))throw new W(t.reason);g=(0,n.sheetQualifier)(t.value)}return(0,n.nameNode)((0,n.identNamePart)(d.name),g)}(e,t,r,a)??function(e,t,{sheet:r,range:a}){const i=e.getContainingTable((0,u.sheetGridCell)(r,(0,s.gridRangeAnchor)(a)));if(!(0,p.isSuccess)(i))throw new W(i.reason);if(null==i.value)return;const o=i.value,l=V(e.getStructRefSpecialRef(o,n.SpecialRefId.All));if(!(0,p.isSuccess)(l))throw new W(l.reason);const c=l.value.range,d=l.value.sheet,g=(0,s.gridRangeCompare)(c,a);if(void 0===g||g<0)return;const m=V(e.getStructRefSpecialRef(o,n.SpecialRefId.Data));if(!(0,p.isSuccess)(m))throw new W(m.reason);const h=m.value.range,f=t.originGridCell.value,S=t.originSheet.value,v=void 0!==S.index&&(0,s.isSheetIndexEqual)(S,d)&&(0,s.gridRangeIsects)(c,f)?void 0:(0,n.nameNode)((0,n.identNamePart)(o.name)),F=v??(0,n.nameNode)((0,n.identNamePart)(o.name)),y=h.cols>1&&a.col===h.col&&a.cols===h.cols,C=()=>{const t=V(e.getStructRefColumn(o,a.col));if(!(0,p.isSuccess)(t))throw new W(t.reason);if(1===a.cols)return(0,n.columnRef)(t.value.name);const r=V(e.getStructRefColumn(o,a.col+a.cols-1));if(!(0,p.isSuccess)(r))throw new W(r.reason);return(0,n.rangeOpRef)((0,n.columnRef)(t.value.name),(0,n.columnRef)(r.value.name))};if(a.row===c.row&&a.rows===c.rows)return(0,n.structRefNode)(F,(0,n.structRef)(y?(0,n.specialRef)(n.SpecialRefId.All):(0,n.commaOpRef)([(0,n.specialRef)(n.SpecialRefId.All,!0),C()])));if(1===a.rows&&a.row===f.row&&a.row>=h.row&&a.row<h.row+h.rows)return(0,n.structRefNode)(1===a.cols?v:F,(0,n.structRef)((0,n.thisRowOpRef)(y?void 0:C())));if(a.row===h.row&&a.rows===h.rows)return y?(0,n.structRefNode)(F,(0,n.structRef)(void 0)):(0,n.structRefNode)(1===a.cols?v:F,(0,n.structRef)(C()));const A=a.row===c.row&&a.row+a.rows===h.row,E=a.row===h.row+h.rows&&a.row+a.rows===c.row+c.rows;if(A||E){const e=(0,n.specialRef)(A?n.SpecialRefId.Headers:n.SpecialRefId.Totals,!y);return(0,n.structRefNode)(F,(0,n.structRef)(y?e:(0,n.commaOpRef)([e,C()])))}const b=a.row===c.row&&c.row<h.row&&a.row+a.rows===h.row+h.rows,R=a.row===h.row&&c.row+c.rows>h.row+h.rows&&a.row+a.rows===c.row+c.rows;if(b||R){const e=(0,n.specialRef)(b?n.SpecialRefId.Headers:n.SpecialRefId.Data,!0),t=(0,n.specialRef)(b?n.SpecialRefId.Data:n.SpecialRefId.Totals,!0);return(0,n.structRefNode)(F,(0,n.structRef)(y?(0,n.commaOpRef)([e,t]):(0,n.commaOpRef)([e,t,C()])))}}(e,t,r)??function(e,t,r){const a=t.originSheet.value,i=function(e,t,r){if(0===r.col&&r.cols===u.sheetCols)return function(e,t,r){return(0,n.cellRefRow)(G(e,t),G(e,t+r-1))}(e,r.row,r.rows);if(0===r.row&&r.rows===u.sheetRows)return function(e,t,r){return(0,n.cellRefCol)(G(e,t),G(e,t+r-1))}(t,r.col,r.cols);const a=B(e,t,(0,s.gridRangeAnchor)(r));if((0,s.isGridCell)(r))return a;const i=B(e,t,(0,u.gridCell)(r.row+r.rows-1,r.col+r.cols-1));return(0,n.cellRefRange)(a,i)}(t.printRowsAsAbsoluteReferences?void 0:t.originGridCell.value.row,t.printColsAsAbsoluteReferences?void 0:t.originGridCell.value.col,r.range);let o;if(void 0===a.index||!(0,s.isSheetIndexEqual)(a,r.sheet)){const t=e.getSheetName(r.sheet.document,r.sheet.index);if(!(0,p.isSuccess)(t))throw new W(t.reason);o=(0,n.sheetQualifier)(t.value)}return(0,n.cellRefNode)(i,o)}(e,t,r))}catch(e){return e instanceof W?(0,p.failure)(e.reason):(0,p.failure)((0,p.javaScriptError)(e))}}t.anonymizeFormula=function(e,t,r){try{const a=r.kind===u.LexicalKind.Cell||r.kind===u.LexicalKind.Range?(0,F.printLocalsGrid)(r,(0,s.sheetGridRangeAnchor)(r.range)):r.kind===u.LexicalKind.NameManager?(0,F.printLocalsName)(r,E):(0,o.assertNever)("calc.lang.anonymizeFormula",r),i=U((0,F.createSimplePrintGlobals)((0,l.calcConfig)((0,l.getEnglishLocaleInfo)(),n.RefStyle.A1,e.mathpack)),a,t,!0);if(i.kind===p.ResultKind.Success)return i.value.formula;if(i.reason.kind===p.ReasonKind.JavaScriptError)throw i.reason.error}catch(e){const t="calc.lang.anonymizeFormula: Format failed: "+(0,g.messageFromError)(e);o.ulsLogger.ULS.traceTag(507381981,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Warning,t)}return(0,c.anonymize)(t)};const H={getNamedRanges:()=>(0,o.assertFalse)("calc.lang.prettyPrinter: default getNamedRanges")};t.createPrinter=function(e){const t=function(e){return{config:e.config,getDocumentLoc:e.getDocumentLoc.bind(e),getSheetIndex:e.getSheetIndex.bind(e),getSheetName:e.getSheetName.bind(e),getNameLoc:e.getNameLoc.bind(e),getUserDefinedFuncLoc:e.getUserDefinedFuncLoc.bind(e),getSheetRangeIndexes:e.getSheetRangeIndexes.bind(e),getContainingTable:e.getContainingTable.bind(e),getStructRefColumn:e.getStructRefColumn.bind(e),getStructRefSpecialRef:e.getStructRefSpecialRef?.bind(e),getNamedRanges:e.getNamedRanges?.bind(e)??H.getNamedRanges}}(e);return{printFormula:(t,r)=>{const n=U(e,t,r);return(0,p.isSuccess)(n)?(0,p.success)(n.value.formula):n},printFormulaEx:(t,r)=>U(e,t,r),printRange:(e,r,n)=>j(t,e,r,n)}}},5886:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.printLocalsName=t.printLocalsGrid=t.createSimplePrintGlobals=void 0;const n=r(66562),a=r(39470),i=r(10041);class o{getDocumentLoc(e,t){return(0,a.success)((0,n.documentLoc)(e,t))}getSheetIndex(e,t){return(0,a.success)(t)}getSheetName(e,t){return(0,a.success)(t)}getNameLoc(e,t){return(0,a.success)(t.indexOf(".")>=0?void 0:(0,n.nameLoc)(e,t))}getUserDefinedFuncLoc(e,t){return(0,a.success)([])}getSheetRangeIndexes(e){if(void 0===e.index)return(0,a.failure)((0,i.notImplemented)(["simplePrintGlobals.getSheetRangeIndexes"]));const t=[e.index];return e.index2!==e.index&&t.push(e.index2),(0,a.success)((0,n.sheetRangeIndexes)(t,0))}getContainingTable(e){return a.successUndefined}getStructRefColumn(e,t){return a.successUndefined}getStructRefSpecialRef(e,t){return a.successUndefined}getNamedRanges(e){return(0,a.success)([])}constructor(e){this.config=e}}t.createSimplePrintGlobals=function(e){return new o(e)},t.printLocalsGrid=function(e,t,r){return{config:r??void 0,lexicalSource:e,originGridCell:(0,a.success)(t.range),originSheet:(0,a.success)(t.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1,printRowsAsAbsoluteReferences:!1,printColsAsAbsoluteReferences:!1}},t.printLocalsName=function(e,t,r){return{config:r??void 0,lexicalSource:e,originGridCell:(0,a.success)(t.range),originSheet:(0,a.success)(t.sheet),allowUnqualifiedCell:!1,wrapCellReferences:!0,printRowsAsAbsoluteReferences:!0,printColsAsAbsoluteReferences:!0}}},54108:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.relabelFormula=void 0;const n=r(50667),a=r(97791);t.relabelFormula=function(e,t=function(){let e=1;return()=>e++}()){const{spans:r,annotations:i,depthUpperBound:o}=e,s=[],u=[],l=[],c=[];function d(e){const n=t(),a=r[e];null!=a&&(s[n]=a);const o=i[e];return null!=o&&(u[n]=o),l[e]=n,c[n]=e,n}function g(e){return{...e,label:d(e.label)}}function m(e){if(e.kind===n.CellRefKind.Range){const t=e;return(0,n.cellRefRange)(m(t.ref1),m(t.ref2),d(e.label))}return{...e,label:d(e.label)}}function h(e){return null!=e?(0,n.documentQualifier)(e.document,e.path,e.isQuoted,d(e.label)):void 0}function p(e){return(0,n.fieldRef)(function(e){switch(e.kind){case n.NodeKind.Ident:return v(e);case n.NodeKind.Missing:return(0,n.missingNode)(e.chars,d(e.label));case n.NodeKind.BadChars:return(0,n.badCharsNode)(e.type,e.chars,d(e.label))}}(e.field),e.isBracketed,e.isClosed,e.shouldBeBracketed,d(e.label))}function f(e){switch(e?.kind){case void 0:return;case n.StructRefKind.SpecialRef:return(0,n.specialRef)(e.id,e.isBracketed,e.isClosed,d(e.label));case n.StructRefKind.ColumnRef:return(0,n.columnRef)(e.name,e.isBracketed,e.isClosed,d(e.label));case n.StructRefKind.RangeOpRef:return(0,n.rangeOpRef)(f(e.lhs),f(e.rhs),d(e.label));case n.StructRefKind.CommaOpRef:return(0,n.commaOpRef)(e.refs.map(f),d(e.label));case n.StructRefKind.ThisRowOpRef:return(0,n.thisRowOpRef)(void 0!==e.ref?f(e.ref):void 0,d(e.label));case n.StructRefKind.MissingRef:return(0,n.missingRef)(d(e.label));case n.StructRefKind.BadRef:return(0,n.badRef)(e.chars,e.isBracketed,e.isClosed,d(e.label))}}function S(e,t,r){return(0,n.nameNode)(function(e){const t=(0,n.flattenNameParts)(e),r=(e,{rhs:t,canDenoteNamedObject:r,label:a,qualifiedLabel:i})=>(0,n.fieldRefNamePart)(e,p(t),r,d(a),d(i));if(t.kind===n.NamePartKind.IdentNamePart){const[e,...a]=t.parts,i=(0,n.identNamePart)(e.asWhole,e.canDenoteNamedObject,d(e.label),d(e.qualifiedLabel));return a.reduce(r,i)}const[a,i,...o]=t.parts,s=(0,n.cellRefNamePart)(m(a.ref),a.asWhole,d(a.label),d(a.qualifiedLabel));return o.reduce(r,r(s,i))}(e),function(e){if(null!=e)return e.kind===n.QualifierKind.Sheet||e.kind===n.QualifierKind.SheetRange?{...e,document:h(e.document),label:d(e.label)}:{...e,label:d(e.label)}}(t),d(r))}function v({whole:e,label:t}){return(0,n.identNode)(e,d(t))}const F={literalNode:(e,t,r)=>(0,n.literalNode)(e,t,d(r)),arrayNode:(e,t,r)=>(0,n.arrayNode)(e,t,d(r)),appNode:(e,t,r,a)=>(0,n.appNode)(e,t,r,d(a)),letNode:(e,t,r,a,i,o)=>(0,n.letNode)(e,t.map((({name:e,binder:t})=>(0,n.letVar)((0,n.indexedArg)(function({name:e,label:t}){return(0,n.varNode)(v(e),d(t))}(e.arg),e.index),t))),r,a,i,d(o)),lambdaNode:(e,t,r,a,i,o)=>(0,n.lambdaNode)(e,t.map((({name:e})=>(0,n.lambdaParam)((0,n.indexedArg)(function(e){const t=(0,n.paramName)(function(e){switch(e.kind){case n.NodeKind.Ident:return v(e);case n.NodeKind.Missing:return(0,n.missingNode)(e.chars,d(e.label));case n.NodeKind.BadChars:return(0,n.badCharsNode)(e.type,e.chars,d(e.label))}}(e.name.name),e.name.isBracketed,e.name.isClosed,d(e.name.label)),r=void 0===e.def?void 0:(0,n.paramDefault)(e.def.rhs,d(e.def.label));return(0,n.paramNode)(t,r,d(e.label))}(e.arg),e.index)))),r,a,i,d(o)),parenNode:(e,t,r)=>(0,n.parenNode)(e,t,d(r)),nameNode:(e,t,r)=>S(e,t,r),cellRefNode:(e,t,r)=>(0,n.cellRefNode)(m(e),function(e){if(null!=e)return e.kind===n.QualifierKind.Sheet||e.kind===n.QualifierKind.SheetRange?{...e,document:h(e.document),label:d(e.label)}:{...e,label:d(e.label)}}(t),d(r)),fieldRefNode:(e,t,r)=>(0,n.fieldRefNode)(e,p(t),d(r)),structRefNode(e,t,r){return(0,n.structRefNode)(void 0===e?void 0:function({parts:e,qualifier:t,label:r}){return S(e,t,r)}(e),(a=t,(0,n.structRef)(f(a.innerRef),a.isClosed,d(a.label))),d(r));var a},missingNode:(e,t)=>(0,n.missingNode)(e,d(t)),badSequenceNode:(e,t,r)=>(0,n.badSequenceNode)(e,t,d(r)),badCharsNode:(e,t,r)=>(0,n.badCharsNode)(e,t,d(r)),operatorNode:(e,t)=>(0,n.operatorNode)(e,d(t)),wsfNode:(e,t,r)=>(0,n.wsfNode)(e,t,d(r))},y=(0,n.formula)((0,a.reduceBottomUp)(F,e),s,u,o);for(const e of Object.keys(u)){const t=Number(e),r=u[t];switch(r?.kind){case n.AnnotationKind.LocalNameUse:u[t]=(0,n.localNameUseAnnotation)(r.name,r.whole,l[r.label]);break;case n.AnnotationKind.LocalNameDecl:u[t]=(0,n.localNameDeclAnnotation)(r.name,r.whole,r.uses.map((({label:e})=>({label:l[e]}))))}}for(const e of Object.keys(s).map(Number)){const t=s[e],r=t?.preComments,n=t?.postComments;(r||n)&&(s[e]={...t,preComments:r?r.map(g):void 0,postComments:n?n.map(g):void 0})}return{formula:y,oldToNewLabel:l,newToOldLabel:c}}},51394:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createResolver=t.resolveGridRef=t.canDenoteCellRef=t.canDenoteUserDefinedFunc=t.canDenoteLocalName=void 0;const n=r(80168),a=r(80168),i=r(72858),o=r(63346),s=r(50667),u=r(10041),l=r(10041),c=r(66562),d=r(66562),g=r(39470),m=r(96089),h=r(96089),p=r(36423);function f(e){return(0,g.isSuccess)(e)&&(0,a.isNone)(e.value)?g.successUndefined:e}function S(e){return!(0,g.isSuccess)(e)||void 0===e.value}const v=e=>e.rhs.field.kind===s.NodeKind.Ident,F=e=>e.rhs.field.whole,y=(e,t)=>(0,s.fieldRefNamePart)(e,t.rhs,t.canDenoteNamedObject,t.label,t.qualifiedLabel);function C(e,t){const[r,...n]=t;return r.kind===s.NamePartKind.IdentNamePart&&null==e&&n.every(v)}function A(e,t,r){return r.canDenoteNamedObject&&e&&(void 0===t||t.kind===s.QualifierKind.Document||t.kind===s.QualifierKind.Ident)}function E(e,t,r){const[n,...a]=r;return n.kind===s.NamePartKind.CellRefNamePart&&(null==t&&e.allowUnqualifiedCell||null!=t&&t.kind!==s.QualifierKind.Document)&&a.every(v)}function b(e,t,r,n,a){return r.kind===s.PosKind.Abs?(0,g.success)(r.index):(0,g.isSuccess)(e)?(0,g.success)((0,o.resolvePosition)(t(e.value),r,n,a)):e}t.canDenoteLocalName=C,t.canDenoteUserDefinedFunc=A,t.canDenoteCellRef=E;const R=({row:e})=>e,T=({col:e})=>e;function k(e,t,r){const n=b(e,R,t.row,d.sheetRows,r),a=b(e,T,t.col,d.sheetCols,r);return(0,g.isSuccess)(n)?(0,g.isSuccess)(a)?void 0===n.value||void 0===a.value?g.successUndefined:(0,g.success)((0,d.gridCell)(n.value,a.value)):a:n}function N(e,t){if(t.kind===s.CellRefKind.Error)return g.successUndefined;const r=e.originGridCell,n=e.wrapCellReferences;switch(t.kind){case s.CellRefKind.Single:return k(r,t,n);case s.CellRefKind.Range:{const e=k(r,t.ref1,n),a=k(r,t.ref2,n);return(0,g.isSuccess)(e)?(0,g.isSuccess)(a)?void 0===e.value||void 0===a.value?g.successUndefined:(0,g.success)((0,l.gridCellRange)(e.value,a.value)):a:e}case s.CellRefKind.Row:{const e=b(r,R,t.row1,d.sheetRows,n),a=b(r,R,t.row2,d.sheetRows,n);return(0,g.isSuccess)(e)?(0,g.isSuccess)(a)?void 0===e.value||void 0===a.value?g.successUndefined:(0,g.success)((0,l.gridCellRange)((0,d.gridCell)(e.value,0),(0,d.gridCell)(a.value,d.sheetCols-1))):a:e}case s.CellRefKind.Col:{const e=b(r,T,t.col1,d.sheetCols,n),a=b(r,T,t.col2,d.sheetCols,n);return(0,g.isSuccess)(e)?(0,g.isSuccess)(a)?void 0===e.value||void 0===a.value?g.successUndefined:(0,g.success)((0,l.gridCellRange)((0,d.gridCell)(0,e.value),(0,d.gridCell)(d.sheetRows-1,a.value))):a:e}case s.CellRefKind.Bad:return(0,g.failure)((0,h.invalidCellRef)(h.InvalidCellRefReason.BadCellRef));default:return(0,i.assertNever)("calc.lang.Resolver.resolveGridRef",t)}}t.resolveGridRef=N,t.createResolver=function(e){function t(t,r){if(void 0===r){const e=t.originSheet;return(0,g.isSuccess)(e)?[r,(0,g.success)(e.value.document)]:[r,e]}const n=e.getDocumentLoc(r.path,r.document);if(!(0,g.isSuccess)(n))return[r,n];if((0,a.isNone)(n.value))return[r,(0,g.failure)((0,h.invalidQualifier)(h.InvalidQualifierReason.UndefinedDocument))];const i=null==r.path?void 0:n.value.path,o=n.value.name;return[(0,s.documentQualifier)(o,i,r.isQuoted,r.label),(0,g.success)(n.value)]}function r(t,r){if(S(r))return[t,r];const n=f(e.getSheetIndex(r.value,t));if(!(0,g.isSuccess)(n))return[t,n];if((0,a.isNone)(n.value))return[t,(0,g.failure)((0,h.invalidQualifier)(h.InvalidQualifierReason.UndefinedSheetName))];const i=e.getSheetName(r.value,n.value);return(0,g.isSuccess)(i)?[i.value,(0,g.success)((0,d.sheetIndex)(r.value,n.value))]:[t,i]}function o(e,n){const[a,i]=t(e,n.document),[o,u]=r(n.sheet,i);return[(0,s.sheetQualifier)(o,a,n.isQuoted,n.label),u]}function v(n,a){const{qualifier:u,ref:c}=a,m=N(n,c);let p,f,v;if(void 0===u||u.kind===s.QualifierKind.Relative){p=u;const e=n.originSheet;if((0,g.isSuccess)(e)){const t=e.value;f=void 0===t.index?(0,g.failure)((0,h.noOriginSheet)(t)):(0,g.success)(t)}else f=e}else[p,f]=function(n,a){switch(a.kind){case s.QualifierKind.Error:return[a,g.successUndefined];case s.QualifierKind.Sheet:return o(n,a);case s.QualifierKind.SheetRange:return function(n,a){const[i,o]=t(n,a.document),[u,c]=r(a.sheet1,o),[m,h]=r(a.sheet2,o);let p,f=u,v=m;if(S(o))p=o;else if(S(c))p=c;else if(S(h))p=h;else{if((0,l.isSheetIndexEqual)(c.value,h.value))return[(0,s.sheetQualifier)(f,i,a.isQuoted,a.label),(0,g.success)((0,d.sheetIndex)(o.value,c.value.index))];{const t=e.getSheetRangeIndexes(c.value),r=e.getSheetRangeIndexes(h.value);(0,g.isSuccess)(t)?(0,g.isSuccess)(r)?r.value.position<t.value.position&&(f=m,v=u):p=r:p=t,p=(0,g.success)((0,d.sheetRange)(o.value,c.value.index,h.value.index))}}return[(0,s.sheetRangeQualifier)(f,v,i,a.isQuoted,a.label),p]}(n,a);case s.QualifierKind.Document:return[a,(0,g.failure)((0,h.invalidQualifier)(h.InvalidQualifierReason.SheetRangeName))];case s.QualifierKind.Bad:return[a,(0,g.failure)((0,h.invalidQualifier)(h.InvalidQualifierReason.BadQualifier))];default:return(0,i.assertNever)("calc.lang.Resolver.resolveCellRefQualifier",a)}}(n,u);return v=S(m)?m:S(f)?f:(0,g.success)((0,d.sheetGridCube)(f.value,m.value)),(0,h.resolvedCellRef)((0,s.cellRefNode)(c,p,a.label),v)}function b(r,n,a){const{qualifier:u,parts:l}=n;let m,p,v;const F=[];if(void 0===u||u.kind===s.QualifierKind.Relative){const e=r.originSheet;if(!(0,g.isSuccess)(e))return(0,h.resolvedName)(n,e,n.qualifier?.kind,F);const t=e.value;if(a!==d.NameSource.StructRef&&void 0===t.index)return(0,h.resolvedName)(n,(0,g.failure)((0,h.noOriginSheet)(t)),n.qualifier?.kind,F);m=u,v=u?.kind,p=(0,g.success)(t)}else[m,v,p]=function(e,r){switch(r.kind){case s.QualifierKind.Document:{const[n,a]=t(e,r);return[n,n.kind,S(a)?a:(0,g.success)((0,d.documentScope)(a.value))]}case s.QualifierKind.Sheet:{const[t,n]=o(e,r);return[t,t.kind,n]}case s.QualifierKind.SheetRange:return[r,r.kind,(0,g.failure)((0,h.invalidQualifier)(h.InvalidQualifierReason.SheetRangeName))];case s.QualifierKind.Ident:{const n=(0,s.sheetQualifier)(r.name,void 0,r.isQuoted,r.label),[a,i]=o(e,n);if(!(0,g.isSuccess)(i)&&i.reason.kind!==h.ResolveReasonKind.InvalidQualifier)return[r,r.kind,i];if((0,g.isSuccess)(i)&&void 0!==i.value)return[(0,s.identQualifier)(a.sheet,a.isQuoted,a.label),a.kind,i];const u=(0,s.documentQualifier)(r.name,void 0,r.isQuoted,r.label),[l,c]=t(e,u);return S(c)?[r,r.kind,c]:[(0,s.identQualifier)(l.document,l.isQuoted,l.label),l.kind,(0,g.success)((0,d.documentScope)(c.value))]}case s.QualifierKind.Bad:return[r,r.kind,(0,g.failure)((0,h.invalidQualifier)(h.InvalidQualifierReason.BadQualifier))];default:return(0,i.assertNever)("calc.lang.Resolver.resolveNameQualifier",r)}}(r,u);a===d.NameSource.StructRef&&(0,g.isSuccess)(p)&&void 0!==p.value.index&&(p=(0,g.success)((0,d.documentScope)(p.value.document)));let y,C=l;return S(p)?y=p:(F.push((0,c.nameLoc)(p.value,l.asWhole)),y=f(e.getNameLoc(p.value,l.asWhole,a)),(0,g.isSuccess)(y)&&void 0===y.value&&void 0!==p.value.index&&(p=(0,g.success)((0,d.documentScope)(p.value.document)),F.push((0,c.nameLoc)(p.value,l.asWhole)),y=f(e.getNameLoc(p.value,l.asWhole,a))),S(y)||(C=(0,s.identNamePart)(y.value.name,l.canDenoteNamedObject,l.label,l.qualifiedLabel))),(0,h.resolvedName)((0,s.nameNode)(C,m,n.label),y,v,F)}function R(t,r,n=!1){const i=e.getStructRefColumn(t,r.name);if(!(0,g.isSuccess)(i))return{kind:s.StructRefKind.ColumnRef,innerRef:r,resolution:i};const o=i.value;if((0,a.isNone)(o))return{kind:s.StructRefKind.ColumnRef,innerRef:r,resolution:(0,g.failure)((0,h.invalidStructRef)(h.InvalidStructRefReason.UndefinedColumnName))};let u=o.range.range;return n&&(u=(0,d.gridRange)(u.row-(o.hasHeadersRow?1:0),u.col,u.rows+(o.hasHeadersRow?1:0)+(o.hasTotalsRow?1:0),u.cols)),{kind:s.StructRefKind.ColumnRef,innerRef:(0,s.columnRef)(o.name,r.isBracketed,r.isClosed,r.label),resolution:(0,g.success)((0,d.sheetGridRange)(o.range.sheet,u))}}function T(t,r,n){if(n===s.SpecialRefId.ThisRow){if(!(0,g.isSuccess)(t.originGridCell))return t.originGridCell;const e=T(t,r,s.SpecialRefId.Data);if(S(e))return e;const n=e.value.range,a=t.originGridCell.value.row;return a<n.row||a>=n.row+n.rows?(0,g.failure)(h.emptyIntersection):(0,g.success)((0,d.sheetGridRange)(e.value.sheet,(0,d.gridRange)(a,n.col,1,n.cols)))}return f(e.getStructRefSpecialRef(r,n))}function k(e,t,r){switch(t.kind){case s.StructRefKind.ColumnRef:return R(e,t,r);case s.StructRefKind.MissingRef:return{kind:s.StructRefKind.MissingRef,innerRef:t,resolution:g.successUndefined}}}function I(e,t,r=!1){const{innerRef:n,resolution:a}=k(e,t.lhs,r),{innerRef:i,resolution:o}=k(e,t.rhs,r),u=(0,s.rangeOpRef)(n,i,t.label);if(!(0,g.isSuccess)(a)&&a.reason.kind!==h.ResolveReasonKind.InvalidStructRef)return{kind:s.StructRefKind.RangeOpRef,innerRef:u,resolution:a};if(!(0,g.isSuccess)(o)&&o.reason.kind!==h.ResolveReasonKind.InvalidStructRef)return{kind:s.StructRefKind.RangeOpRef,innerRef:u,resolution:o};if(!(0,g.isSuccess)(a))return{kind:s.StructRefKind.RangeOpRef,innerRef:u,resolution:a};if(!(0,g.isSuccess)(o))return{kind:s.StructRefKind.RangeOpRef,innerRef:u,resolution:o};let c,m;if(void 0!==a.value)c=a.value.sheet,m=(0,l.gridRangeJoinOpt)(a.value.range,o.value?.range);else{if(void 0===o.value)return{kind:s.StructRefKind.RangeOpRef,innerRef:u,resolution:(0,g.failure)((0,h.invalidStructRef)(h.InvalidStructRefReason.InvalidOp))};c=o.value.sheet,m=o.value.range}return{kind:s.StructRefKind.RangeOpRef,innerRef:u,resolution:(0,g.success)((0,d.sheetGridRange)(c,m))}}function O(r,n){const{qualifier:a,parts:o}=n,l=r.config?.localeInfo??e.config.localeInfo;let d,m,p,f;if(void 0===a){const e=r.originSheet;if(!(0,g.isSuccess)(e))return(0,h.resolvedUserDefinedFunc)(n,e,[],o.asWhole);d=a,m=(0,g.success)(e.value.document)}else[d,m]=function(e,r){switch(r.kind){case s.QualifierKind.Document:return t(e,r);case s.QualifierKind.Ident:{const n=(0,s.documentQualifier)(r.name,void 0,r.isQuoted,r.label),[a,i]=t(e,n);return[(0,s.identQualifier)(a.document,a.isQuoted,a.label),i]}default:return(0,i.assertNever)("calc.lang.Resolver.resolveUserDefinedFuncQualifier",r)}}(r,a);let v=o.asWhole;if(S(m))f=m,p=[];else{v=(0,u.getUserDefinedFuncName)(l,o.asWhole);const t=e.getUserDefinedFuncLoc(m.value,v);p=[(0,c.userDefinedFuncLoc)(m.value,v)],f=(0,g.isSuccess)(t)?0!==t.value.length?t:g.successUndefined:t}return(0,h.resolvedUserDefinedFunc)((0,s.nameNode)((0,s.identNamePart)(v,o.canDenoteNamedObject,o.label,o.qualifiedLabel),d,n.label),f,p,v)}return{resolveGridRef:N,resolveCellRef:v,resolveName:b,resolveStructRef:function(t,r){const{lhs:n,rhs:i}=r;let o,u,c=n;if(void 0!==n){const{node:e,resolution:i,precedents:s}=b(t,n,d.NameSource.StructRef),l=i;if(!(0,g.isSuccess)(l))return(0,h.resolvedStructRef)(r,void 0,l,s);if((0,a.isNone)(l.value))return(0,h.resolvedStructRef)(r,void 0,(0,g.failure)((0,h.invalidStructRef)(h.InvalidStructRefReason.UndefinedTableName)),s);c=e,o=l.value,u=s}else{const{originGridCell:n,originSheet:i}=t;if(!(0,g.isSuccess)(n))return(0,h.resolvedStructRef)(r,void 0,n,[]);if(!(0,g.isSuccess)(i))return(0,h.resolvedStructRef)(r,void 0,i,[]);if(void 0===i.value.index)return(0,h.resolvedStructRef)(r,void 0,(0,g.failure)((0,h.invalidStructRef)(h.InvalidStructRefReason.InvalidOriginSheet)),[]);const s=e.getContainingTable((0,d.sheetGridCell)(i.value,n.value));if(!(0,g.isSuccess)(s))return(0,h.resolvedStructRef)(r,void 0,s,[]);if((0,a.isNone)(s.value))return(0,h.resolvedStructRef)(r,void 0,(0,g.failure)((0,h.invalidStructRef)(h.InvalidStructRefReason.MissingTableName)),[]);o=s.value,u=[o]}const{structRef:m,resolution:p}=function(e,t,r){switch(r.innerRef?.kind){case s.StructRefKind.ColumnRef:{const{innerRef:e,resolution:n}=R(t,r.innerRef);return{structRef:(0,s.structRef)(e,r.isClosed,r.label),resolution:n}}case s.StructRefKind.RangeOpRef:{const{innerRef:e,resolution:n}=I(t,r.innerRef);return{structRef:(0,s.structRef)(e,r.isClosed,r.label),resolution:n}}case void 0:return{structRef:r,resolution:T(e,t,s.SpecialRefId.Data)};case s.StructRefKind.SpecialRef:return{structRef:r,resolution:T(e,t,r.innerRef.id)};case s.StructRefKind.CommaOpRef:{const{commaOpRef:n,resolution:a}=function(e,t,r){const n=r.refs.map((r=>function(e,t,r){switch(r.kind){case s.StructRefKind.ColumnRef:return R(t,r,!0);case s.StructRefKind.SpecialRef:return{kind:s.StructRefKind.SpecialRef,innerRef:r,resolution:T(e,t,r.id)};case s.StructRefKind.RangeOpRef:return I(t,r,!0);case s.StructRefKind.MissingRef:return{kind:s.StructRefKind.MissingRef,innerRef:r,resolution:g.successUndefined};case s.StructRefKind.BadRef:return{kind:s.StructRefKind.BadRef,innerRef:r,resolution:(0,g.failure)((0,h.invalidStructRef)(h.InvalidStructRefReason.InvalidOp))}}}(e,t,r))),a=(0,s.commaOpRef)(n.map((e=>e.innerRef)),r.label);for(const{resolution:e}of n)if(!(0,g.isSuccess)(e)&&e.reason.kind!==h.ResolveReasonKind.InvalidStructRef)return{commaOpRef:a,resolution:e};const i=[];for(const e of n){if(!(0,g.isSuccess)(e.resolution)||e.kind===s.StructRefKind.BadRef)return{commaOpRef:a,resolution:e.resolution};i.push((e.kind===s.StructRefKind.SpecialRef||(e.kind,s.StructRefKind.MissingRef),{kind:e.kind,resolution:e.resolution}))}if(!(0,l.isCommaOpRefWellFormed)(r))return{commaOpRef:a,resolution:(0,g.failure)((0,h.invalidStructRef)(h.InvalidStructRefReason.InvalidOp))};let o,u;for(const e of i)e.kind===s.StructRefKind.SpecialRef&&(o=(0,l.gridRangeJoinOpt)(o,e.resolution.value?.range),void 0===u&&(u=e.resolution.value?.sheet));if(void 0===o||void 0===u)return{commaOpRef:a,resolution:g.successUndefined};for(const e of i)if(e.kind!==s.StructRefKind.SpecialRef&&e.kind!==s.StructRefKind.MissingRef&&(o=(0,l.gridRangeIsect)(o,e.resolution.value.range),void 0===o))return{commaOpRef:a,resolution:(0,g.failure)((0,h.invalidStructRef)(h.InvalidStructRefReason.InvalidOp))};return{commaOpRef:a,resolution:(0,g.success)((0,d.sheetGridRange)(u,o))}}(e,t,r.innerRef);return{structRef:(0,s.structRef)(n,r.isClosed,r.label),resolution:a}}case s.StructRefKind.ThisRowOpRef:{const n=T(e,t,s.SpecialRefId.ThisRow);if(S(n)||void 0===r.innerRef.ref)return{structRef:r,resolution:n};const{innerRef:a,resolution:i}=r.innerRef.ref.kind===s.StructRefKind.ColumnRef?R(t,r.innerRef.ref):I(t,r.innerRef.ref),o=(0,s.thisRowOpRef)(a,a.label);if(S(i))return{structRef:(0,s.structRef)(o,r.isClosed,r.label),resolution:i};const u=(0,l.gridRangeIsect)(n.value.range,i.value.range);return u?{structRef:(0,s.structRef)(o,r.isClosed,r.label),resolution:(0,g.success)((0,d.sheetGridRange)(n.value.sheet,u))}:{structRef:r,resolution:(0,g.failure)((0,h.invalidStructRef)(h.InvalidStructRefReason.InvalidOp))}}case s.StructRefKind.BadRef:return{structRef:r,resolution:(0,g.failure)((0,h.invalidStructRef)(h.InvalidStructRefReason.InvalidOp))}}}(t,o,i);return(0,h.resolvedStructRef)(p.kind===g.ResultKind.Failure&&p.reason.kind!==h.ResolveReasonKind.EmptyIntersection?r:(0,s.structRefNode)(c,m,r.label),o,p,u)},resolveUserDefinedFunc:O,resolveDottedName:function(t,r,a){const o=r.parts,l=r.qualifier,c={names:new Array,udfs:new Array},f=a[r.label],S=f?.kind===s.AnnotationKind.AppHeadName,R=(0,s.flattenNameParts)(o).parts,T=(0,s.nameNode)((0,s.identNamePart)(o.asWhole,o.canDenoteNamedObject,o.label,o.qualifiedLabel),l,r.label);if(C(l,R)){const[e,...t]=R,n=function(e,t){const r=t[e.label],n=r?.kind===s.AnnotationKind.LocalNameUse?r:void 0;return(0,h.resolvedLocalName)((0,s.nameNode)((0,s.identNamePart)(n?.name??e.asWhole,e.canDenoteNamedObject,e.label,e.qualifiedLabel),void 0,e.qualifiedLabel),(0,g.success)(n))}(e,a);if(void 0!==n.resolution.value)return(0,h.resolvedDottedName)((0,s.nameNode)(t.reduce(y,n.node.parts),l,r.label),n,t.map(F),c)}let k;const N=()=>{if(!k)return!1;const e=k.headResolved.resolution;return e.kind!==g.ResultKind.Success&&e.reason.kind!==h.ResolveReasonKind.InvalidQualifier||e.kind===g.ResultKind.Success&&void 0!==e.value};if(o.canDenoteNamedObject){const e=b(t,T,S?d.NameSource.AppHead:d.NameSource.Plain);if((0,n.safePush)(c.names,e.precedents),k=(0,h.resolvedDottedName)(e.node,e,[],c),N())return k}if(A(S,l,o)){const e=O(t,T);if((0,n.safePush)(c.udfs,e.precedents),k=(0,h.resolvedDottedName)(e.node,e,[],c),N())return k}if(E(t,l,R)){const[e,...n]=R,a=null!=l&&l.kind===s.QualifierKind.Ident?(0,s.sheetQualifier)(l.name,void 0,l.isQuoted,l.label):l,u=v(t,(0,s.cellRefNode)(e.ref,a,e.qualifiedLabel)),d=u.node.qualifier;return(0,i.assertTrue)("calc.lang.Resolver.resolveDottedName: resolveCellRef doesn't generate ErrorQualifier",d?.kind!==s.QualifierKind.Error),(0,i.assertTrue)("calc.lang.Resolver.resolveDottedName: resolveCellRef doesn't touch ref",u.node.ref===e.ref),k=(0,h.resolvedDottedName)((0,s.nameNode)(o,d,r.label),u,n.map(F),c),k}if((0,u.isUnqualifiedNameNode)(r)&&(0,p.getTypedFeatureGate)("Microsoft.Office.Excel.CalcEtaLambda")&&(0,p.getTypedFeatureGate)("Microsoft.Office.Excel.EtaReducedLambdas")){const n=function(t,r){const n=t.config?.localeInfo??e.config.localeInfo,a=(0,u.getEtaFuncId)(n,r.whole),i=r.parts;return(0,m.resolvedWorksheetFunc)((0,s.nameNode)((0,s.identNamePart)(void 0!==a?n.getWorksheetFuncName(a):i.asWhole,i.canDenoteNamedObject,i.label,i.qualifiedLabel),void 0,i.qualifiedLabel),(0,g.success)(a))}(t,r);if(void 0!==n.resolution.value)return(0,h.resolvedDottedName)(n.node,n,[],c)}return void 0!==k?k:(0,h.resolvedDottedName)(r,(0,h.resolvedNever)(T),[],c)}}}},96089:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolvedDottedName=t.resolvedNever=t.resolvedStructRef=t.resolvedLocalName=t.resolvedWorksheetFunc=t.resolvedUserDefinedFunc=t.resolvedCellRef=t.resolvedName=t.ResolvedKind=t.emptyIntersection=t.invalidStructRef=t.InvalidStructRefReason=t.invalidCellRef=t.InvalidCellRefReason=t.invalidQualifier=t.InvalidQualifierReason=t.noOriginSheet=t.ResolveReasonKind=t.resolveLocalsGrid=void 0;const n=r(39470),a=r(80168);var i,o,s,u,l;t.resolveLocalsGrid=function(e){return{originGridCell:(0,n.success)(e.range),originSheet:(0,n.success)(e.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1}},function(e){e.NoOriginSheet="NoOriginSheet",e.InvalidQualifier="InvalidQualifier",e.InvalidCellRef="InvalidCellRef",e.InvalidStructRef="InvalidStructRef",e.EmptyIntersection="EmptyIntersection"}(i||(t.ResolveReasonKind=i={})),t.noOriginSheet=function(e){return{kind:i.NoOriginSheet,origin:e}},function(e){e.UndefinedDocument="UndefinedDocument",e.UndefinedSheetName="UndefinedSheetName",e.SheetRangeName="SheetRangeName",e.DocumentCellRef="DocumentCellRef",e.BadQualifier="BadQualifier"}(o||(t.InvalidQualifierReason=o={})),t.invalidQualifier=function(e){return{kind:i.InvalidQualifier,reason:e}},function(e){e.BadCellRef="BadCellRef"}(s||(t.InvalidCellRefReason=s={})),t.invalidCellRef=function(e){return{kind:i.InvalidCellRef,reason:e}},function(e){e.UndefinedColumnName="UndefinedColumnName",e.UndefinedTableName="UndefinedTableName",e.InvalidOriginSheet="InvalidOriginSheet",e.InvalidOp="InvalidOp",e.MissingTableName="MissingTableName",e.NamedObjectNotTable="NamedObjectNotTable"}(u||(t.InvalidStructRefReason=u={})),t.invalidStructRef=function(e){return{kind:i.InvalidStructRef,reason:e}},t.emptyIntersection={kind:i.EmptyIntersection},function(e){e.ResolvedName="ResolvedName",e.ResolvedCellRef="ResolvedCellRef",e.ResolvedUserDefinedFunc="ResolvedUserDefinedFunc",e.ResolvedWorksheetFunc="ResolvedWorksheetFunc",e.ResolvedLocalName="ResolvedLocalName",e.ResolvedStructRef="ResolvedStructRef",e.ResolvedNever="ResolvedNever",e.ResolvedDottedName="ResolvedDottedName"}(l||(t.ResolvedKind=l={})),t.resolvedName=(0,a.typedInstanceCreator)()(((e,t,r,n)=>({kind:l.ResolvedName,node:e,resolution:t,qualifierResolution:r,precedents:n}))),t.resolvedCellRef=(0,a.typedInstanceCreator)()(((e,t)=>({kind:l.ResolvedCellRef,node:e,resolution:t}))),t.resolvedUserDefinedFunc=(0,a.typedInstanceCreator)()(((e,t,r,n)=>({kind:l.ResolvedUserDefinedFunc,node:e,resolution:t,precedents:r,name:n}))),t.resolvedWorksheetFunc=(0,a.typedInstanceCreator)()(((e,t)=>({kind:l.ResolvedWorksheetFunc,node:e,resolution:t}))),t.resolvedLocalName=(0,a.typedInstanceCreator)()(((e,t)=>({kind:l.ResolvedLocalName,node:e,resolution:t}))),t.resolvedStructRef=(0,a.typedInstanceCreator)()(((e,t,r,n)=>({kind:l.ResolvedStructRef,node:e,table:t,resolution:r,precedents:n}))),t.resolvedNever=(0,a.typedInstanceCreator)()((e=>({kind:l.ResolvedNever,node:e,resolution:n.successUndefined}))),t.resolvedDottedName=(0,a.typedInstanceCreator)()(((e,t,r,n)=>({kind:l.ResolvedDottedName,node:e,headResolved:t,fieldsResolved:r,precedents:n})))},93383:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isVolatileFunc=t.getWorksheetFuncEnglishName=t.getWorksheetFuncType=t.getOperatorType=t.operatorStrings=t.OperatorId=t.higherOrderFunctionType=t.unknownFunctionType=t.WorksheetFuncId=void 0;const n=r(61824),a=r(89208);Object.defineProperty(t,"WorksheetFuncId",{enumerable:!0,get:function(){return a.WorksheetFuncId}});const i=r(36423);var o;t.unknownFunctionType=(0,n.functionType)(0,254,[],[n.SignatureType.All],[],n.SignatureType.All,n.SpecialPrecs.All,n.FunctionFlags.AllowLStrs),t.higherOrderFunctionType=function(){const e=n.OperKind.Number|n.OperKind.String|n.OperKind.Boolean|n.OperKind.Rich|n.OperKind.Error|n.OperKind.Blank|((0,i.isFeatureEnabled)(i.FeatureName.CalcLambdaCellValues)?0:n.OperKind.Range)|((0,i.isFeatureEnabled)(i.FeatureName.CalcLambdaArrayLifting)?0:n.OperKind.Array),t=n.OperKind.Number|n.OperKind.String|n.OperKind.Boolean|n.OperKind.Rich|n.OperKind.Error|n.OperKind.Blank|n.OperKind.Missing|n.OperKind.Array|n.OperKind.Range;return(0,n.functionType)(1,255,[e],[t],[],n.SignatureType.All,n.SpecialPrecs.None,n.FunctionFlags.Allow3dRef|n.FunctionFlags.AllowLStrs)},function(e){e[e.Add=1]="Add",e[e.Sub=2]="Sub",e[e.Mul=3]="Mul",e[e.Div=4]="Div",e[e.Pow=5]="Pow",e[e.Percent=6]="Percent",e[e.Neg=7]="Neg",e[e.Pos=8]="Pos",e[e.Concat=9]="Concat",e[e.Eq=10]="Eq",e[e.Ne=11]="Ne",e[e.Lt=12]="Lt",e[e.Le=13]="Le",e[e.Gt=14]="Gt",e[e.Ge=15]="Ge",e[e.Range=16]="Range",e[e.Isect=17]="Isect",e[e.Union=18]="Union",e[e.And=19]="And",e[e.Or=20]="Or",e[e.Xor=21]="Xor",e[e.Min=22]="Min",e[e.Max=23]="Max",e[e.At=24]="At",e[e.Pound=25]="Pound"}(o||(t.OperatorId=o={})),t.operatorStrings=[void 0,"+","-","*","/","^","%","-","+","&","=","<>","<","<=",">",">=",":",void 0,void 0,"&&","||","^^",void 0,void 0,"@","#"];const s=n.OperKind.Number|n.OperKind.String|n.OperKind.Boolean|n.OperKind.Blank,u=n.OperKind.Number|n.OperKind.String|n.OperKind.Boolean|n.OperKind.Blank,l=(0,n.functionType)(2,2,[n.OperKind.Number,n.OperKind.Number],[],[],n.OperKind.Number,n.SpecialPrecs.None,n.FunctionFlags.None),c=(0,n.functionType)(1,1,[n.OperKind.Number],[],[],n.OperKind.Number,n.SpecialPrecs.None,n.FunctionFlags.None),d=(0,n.functionType)(1,1,[s],[],[],s,n.SpecialPrecs.None,n.FunctionFlags.AllowLStrs),g=(0,n.functionType)(2,2,[n.OperKind.String,n.OperKind.String],[],[],n.OperKind.String,n.SpecialPrecs.None,n.FunctionFlags.AllowLStrs),m=(0,n.functionType)(2,2,[u,u],[],[],n.OperKind.Boolean,n.SpecialPrecs.None,n.FunctionFlags.AllowLStrs),h=(0,n.functionType)(2,2,[n.OperKind.Range,n.OperKind.Range],[],[],n.OperKind.Range,n.SpecialPrecs.AllCells,n.FunctionFlags.None),p=(0,n.functionType)(2,2,[n.OperKind.Range,n.OperKind.Range],[],[],n.OperKind.Range,n.SpecialPrecs.None,n.FunctionFlags.None),f=(0,n.functionType)(2,2,[n.OperKind.Boolean,n.OperKind.Boolean],[],[],n.OperKind.Boolean,n.SpecialPrecs.None,n.FunctionFlags.None),S=[];function v(e){const r=a.worksheetFuncTypes[e];return null!=r?r:t.unknownFunctionType}function F(e,t){const r=a.worksheetFuncTypes[e];null!=r&&(r.staticPrecs=t)}S[o.Add]=l,S[o.Sub]=l,S[o.Mul]=l,S[o.Div]=l,S[o.Pow]=l,S[o.Percent]=c,S[o.Neg]=c,S[o.At]=a.worksheetFuncTypes[a.WorksheetFuncId.SINGLE],S[o.Pound]=a.worksheetFuncTypes[a.WorksheetFuncId.ANCHORARRAY],S[o.Pos]=d,S[o.Concat]=g,S[o.Eq]=m,S[o.Ne]=m,S[o.Lt]=m,S[o.Le]=m,S[o.Gt]=m,S[o.Ge]=m,S[o.Range]=h,S[o.Isect]=p,S[o.Union]=p,S[o.And]=f,S[o.Or]=f,S[o.Xor]=f,S[o.Min]=l,S[o.Max]=l,t.getOperatorType=function(e){const r=S[e];return null!=r?r:t.unknownFunctionType},t.getWorksheetFuncType=v,t.getWorksheetFuncEnglishName=function(e){return a.worksheetFuncEnglishNames[e]},t.isVolatileFunc=function(e){return 0!=(v(e).staticPrecs&(n.SpecialPrecs.Time|n.SpecialPrecs.Calc))},F(a.WorksheetFuncId.ROW,n.SpecialPrecs.OwnRow),F(a.WorksheetFuncId.COLUMN,n.SpecialPrecs.OwnCol),F(a.WorksheetFuncId.SHEET,n.SpecialPrecs.OwnDocSheets),F(a.WorksheetFuncId.SHEETS,n.SpecialPrecs.OwnDocSheets),F(a.WorksheetFuncId.OFFSET,n.SpecialPrecs.AllCells),F(a.WorksheetFuncId.INDIRECT,n.SpecialPrecs.AllCells),F(a.WorksheetFuncId.SUMIF,n.SpecialPrecs.AllCells),F(a.WorksheetFuncId.AVERAGEIF,n.SpecialPrecs.AllCells),F(a.WorksheetFuncId.LOOKUP,n.SpecialPrecs.AllCells),F(a.WorksheetFuncId.ADDRESS,n.SpecialPrecs.RefStyle),F(a.WorksheetFuncId.FORMULATEXT,n.SpecialPrecs.RefStyle),F(a.WorksheetFuncId.NOW,n.SpecialPrecs.Time),F(a.WorksheetFuncId.TODAY,n.SpecialPrecs.Time),F(a.WorksheetFuncId.RAND,n.SpecialPrecs.Calc),F(a.WorksheetFuncId.RANDBETWEEN,n.SpecialPrecs.Calc),F(a.WorksheetFuncId.RANDARRAY,n.SpecialPrecs.Calc),F(a.WorksheetFuncId.SUBTOTAL,n.SpecialPrecs.CellProps),F(a.WorksheetFuncId.CELL,n.SpecialPrecs.CellProps|n.SpecialPrecs.AllCells),F(a.WorksheetFuncId.INFO,n.SpecialPrecs.None)},3351:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VerticalAlignment=t.HorizontalAlignment=t.BorderLineType=t.PatternType=t.FillKind=t.FontVerticalAlignment=t.FontUnderline=void 0;const n=r(80168);var a,i,o,s,u,l,c;!function(e){e.None="None",e.Single="Single",e.Double="Double",e.SingleAccounting="SingleAccounting",e.DoubleAccounting="DoubleAccounting"}(a||(t.FontUnderline=a={})),(0,n.staticAssertSame)(),function(e){e.None="None",e.Subscript="Subscript",e.Superscript="Superscript"}(i||(t.FontVerticalAlignment=i={})),(0,n.staticAssertSame)(),function(e){e.Pattern="Pattern",e.Gradient="Gradient"}(o||(t.FillKind=o={})),function(e){e.None="None",e.Solid="Solid",e.MediumGray="MediumGray",e.DarkGray="DarkGray",e.LightGray="LightGray",e.DarkHorizontal="DarkHorizontal",e.DarkVertical="DarkVertical",e.DarkDown="DarkDown",e.DarkUp="DarkUp",e.DarkGrid="DarkGrid",e.DarkTrellis="DarkTrellis",e.LightHorizontal="LightHorizontal",e.LightVertical="LightVertical",e.LightDown="LightDown",e.LightUp="LightUp",e.LightGrid="LightGrid",e.LightTrellis="LightTrellis",e.Gray125="Gray125",e.Gray0625="Gray0625"}(s||(t.PatternType=s={})),function(e){e.None="None",e.Thin="Thin",e.Medium="Medium",e.Dashed="Dashed",e.Dotted="Dotted",e.Thick="Thick",e.Double="Double",e.Hair="Hair",e.MediumDashed="MediumDashed",e.DashDot="DashDot",e.MediumDashDot="MediumDashDot",e.DashDotDot="DashDotDot",e.MediumDashDotDot="MediumDashDotDot",e.SlantDashDot="SlantDashDot"}(u||(t.BorderLineType=u={})),(0,n.staticAssertSame)(),function(e){e.Automatic="Automatic",e.Left="Left",e.Center="Center",e.Right="Right",e.Fill="Fill",e.Justify="Justify",e.CenterAcrossSelection="CenterAcrossSelection",e.Distributed="Distributed",e.JustifyDistributed="JustifyDistributed"}(l||(t.HorizontalAlignment=l={})),(0,n.staticAssertSame)(),function(e){e.Top="Top",e.Center="Center",e.Bottom="Bottom",e.Justify="Justify",e.Distributed="Distributed"}(c||(t.VerticalAlignment=c={})),(0,n.staticAssertSame)()},62241:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fieldRef=t.fieldRefNamePart=t.nameNode=t.lambdaNode=t.letNode=t.poundNode=t.atNode=t.maxNode=t.minNode=t.xorNode=t.orNode=t.andNode=t.unionNode=t.isectNode=t.rangeNode=t.geNode=t.gtNode=t.leNode=t.ltNode=t.neNode=t.eqNode=t.concatNode=t.posNode=t.negNode=t.percentNode=t.powNode=t.divNode=t.mulNode=t.subNode=t.addNode=t.badBracketNode=t.badQualNode=t.badCellRefNode=t.badParamNameNode=t.badFieldNameNode=t.badErrorLiteralNode=t.badStringLiteralNode=t.badNumberLiteralNode=t.badUnexpCharsNode=t.badFieldRefNode=t.badStructRefNode=t.badUnexpSeqNode=t.absPos=t.relPos=t.isNameLocEqual=t.createSingleRange=t.sheet1=t.sheet1Name=t.document1=void 0;const n=r(66562),a=r(10041),i=r(50667),o=r(93383);function s(e,t=0){return(0,i.badSequenceNode)(i.BadType.Unexpected,e,t)}function u(e,t=0){return(0,i.badCharsNode)(i.BadType.Unexpected,e,t)}function l(e){return function(t=0){return(0,i.operatorNode)(e,t)}}function c(e,t,r,n,a){return(0,i.fieldRef)("string"==typeof e?(0,i.identNode)(e):e,t,r,n,a)}t.document1=(0,n.documentLoc)(void 0,"Book1"),t.sheet1Name="Sheet1",t.sheet1=(0,n.sheetIndex)(t.document1,0),t.createSingleRange=function(e,r){const a=(0,n.gridCell)(e,r);return(0,n.sheetGridCell)(t.sheet1,a)},t.isNameLocEqual=function(e,t,r){return(0,a.isNameScopeEqual)(t.scope,r.scope)&&0===e.stringCompareCI(t.name,r.name)},t.relPos=function(e){return(0,i.pos)(i.PosKind.Rel,e)},t.absPos=function(e){return(0,i.pos)(i.PosKind.Abs,e)},t.badUnexpSeqNode=s,t.badStructRefNode=function(e,t=0){return(0,i.badSequenceNode)(i.BadType.StructRef,e,t)},t.badFieldRefNode=function(e,t=0){return(0,i.badSequenceNode)(i.BadType.FieldRef,e,t)},t.badUnexpCharsNode=u,t.badNumberLiteralNode=function(e,t=0){return(0,i.badCharsNode)(i.BadType.NumberLiteral,e,t)},t.badStringLiteralNode=function(e,t=0){return(0,i.badCharsNode)(i.BadType.StringLiteral,e,t)},t.badErrorLiteralNode=function(e,t=0){return(0,i.badCharsNode)(i.BadType.ErrorLiteral,e,t)},t.badFieldNameNode=function(e,t=0){return(0,i.badCharsNode)(i.BadType.FieldName,e,t)},t.badParamNameNode=function(e,t=0){return(0,i.badCharsNode)(i.BadType.ParamName,e,t)},t.badCellRefNode=function(e,t=e.indexOf("[")>=0,r=0,n=0){return(0,i.cellRefNode)((0,i.cellRefBad)(e,t,r),void 0,n)},t.badQualNode=function(e,t=0){return(0,i.badCharsNode)(i.BadType.Qualifier,e,t)},t.badBracketNode=function(e,t=!0){const r=[u("["),e];return t&&r.push(u("]")),s(r)},t.addNode=l(o.OperatorId.Add),t.subNode=l(o.OperatorId.Sub),t.mulNode=l(o.OperatorId.Mul),t.divNode=l(o.OperatorId.Div),t.powNode=l(o.OperatorId.Pow),t.percentNode=l(o.OperatorId.Percent),t.negNode=l(o.OperatorId.Neg),t.posNode=l(o.OperatorId.Pos),t.concatNode=l(o.OperatorId.Concat),t.eqNode=l(o.OperatorId.Eq),t.neNode=l(o.OperatorId.Ne),t.ltNode=l(o.OperatorId.Lt),t.leNode=l(o.OperatorId.Le),t.gtNode=l(o.OperatorId.Gt),t.geNode=l(o.OperatorId.Ge),t.rangeNode=l(o.OperatorId.Range),t.isectNode=l(o.OperatorId.Isect),t.unionNode=l(o.OperatorId.Union),t.andNode=l(o.OperatorId.And),t.orNode=l(o.OperatorId.Or),t.xorNode=l(o.OperatorId.Xor),t.minNode=l(o.OperatorId.Min),t.maxNode=l(o.OperatorId.Max),t.atNode=l(o.OperatorId.At),t.poundNode=l(o.OperatorId.Pound),t.letNode=function(e,t,r,n=[],a,o){const s=t.map((e=>{return t=e,Array.isArray(t)?[e[0].kind===i.NodeKind.Ident?(0,i.varNode)(e[0]):e[0],e[1]]:e;var t}));return(0,i.letNode)(e,s,r,n,a,o)},t.lambdaNode=function(e,t,r,n=[],a,o){const s=t.map((e=>void 0===e.kind||e.kind===i.NodeKind.Param?e:(0,i.paramNode)((0,i.paramName)(e,!1),void 0)));return(0,i.lambdaNode)(e,s,r,n,a,o)},t.nameNode=function(e,t,r){const n="string"==typeof e?(0,i.identNamePart)(e,!0):e;return(0,i.nameNode)(n,t,r)},t.fieldRefNamePart=function(e,t,r,n,a){const o="string"==typeof t?c(t,!1,!0,!1):t;return(0,i.fieldRefNamePart)(e,o,r,n,a)},t.fieldRef=c},61824:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionType=t.FunctionFlags=t.SpecialPrecs=t.SignatureType=t.OperKind=void 0;const n=r(91092);var a,i,o,s,u=n.assertions.assertNatural,l=n.assertions.assertFalse,c=n.assertions.assertIndex;!function(e){e[e.Number=1]="Number",e[e.String=2]="String",e[e.Boolean=4]="Boolean",e[e.Error=8]="Error",e[e.Range=16]="Range",e[e.Array=32]="Array",e[e.Missing=64]="Missing",e[e.Blank=128]="Blank",e[e.Rich=256]="Rich"}(a||(t.OperKind=a={})),function(e){e[e.None=0]="None",e[e.Goto=512]="Goto",e[e.Ref3D=1024]="Ref3D",e[e.All=2047]="All"}(i||(t.SignatureType=i={})),function(e){e[e.None=0]="None",e[e.OwnDoc=1]="OwnDoc",e[e.OwnSheet=2]="OwnSheet",e[e.OwnRow=4]="OwnRow",e[e.OwnCol=8]="OwnCol",e[e.OwnRowCopy=16]="OwnRowCopy",e[e.OwnColCopy=32]="OwnColCopy",e[e.OwnDocSheets=64]="OwnDocSheets",e[e.CellProps=128]="CellProps",e[e.AllCells=256]="AllCells",e[e.AllNames=512]="AllNames",e[e.Time=1024]="Time",e[e.Calc=2048]="Calc",e[e.InFilterMode=4096]="InFilterMode",e[e.RefStyle=8192]="RefStyle",e[e.All=16383]="All"}(o||(t.SpecialPrecs=o={})),function(e){e[e.None=0]="None",e[e.Dark=1]="Dark",e[e.Macro=2]="Macro",e[e.Chart=4]="Chart",e[e.OnlyParsedDuringLoad=8]="OnlyParsedDuringLoad",e[e.Internal=16]="Internal",e[e.Allow3dRef=32]="Allow3dRef",e[e.AllowLStrs=64]="AllowLStrs",e[e.HiddenFromUI=128]="HiddenFromUI"}(s||(t.FunctionFlags=s={})),t.functionType=function(e,t,r,n,a,i,o,s){if(u("calc.lang.functionType",t),c("calc.lang.functionType",e,t+1),0===n.length?0!==a.length:a.length>=n.length){const e=JSON.stringify(a);l(`calc.lang.functionType: expected tailTypes.length < restTypes.length; given ${e}`)}if(0===n.length&&r.length+a.length<t){const e=JSON.stringify(r);l(`calc.lang.functionType: expected headTypes.length + tailTypes.length >= ${t}; given ${e}`)}return{minArgs:e,maxArgs:t,headTypes:r,restTypes:n,tailTypes:a,returnType:i,staticPrecs:o,flags:s}}},10041:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isReadOperEqual=t.isWriteOper=t.isPrimitiveOper=t.isRichOper=t.isBlankOper=t.isMissingOper=t.isArrayOper=t.isRangeOper=t.isErrorOper=t.isBooleanOper=t.isStringOper=t.isNumberOper=t.shouldFieldRefBeBracketed=t.isValidArgsLength=t.getArgType=t.isBooleanLiteralNode=t.isNumberLiteralNode=t.isMissingLiteralNode=t.isMissingNode=t.isUnqualifiedNameNode=t.isWSFNode=t.isOperatorNode=t.getArguments=t.gridCellRange=t.sheetGridRangeAnchor=t.gridRangeAnchor=t.isSheetGridRangeEqual=t.isSheetGridCellEqual=t.isGridRangeEqual=t.isGridCellEqual=t.isNameScopeEqual=t.sheetRangeToSheetIndex=t.isSheetIndexEqual=t.isDocumentLocEqual=t.gridRangeSize=t.gridRangeExcept=t.gridRangeCompare=t.gridCellImplicitIsect=t.gridRangeIsects=t.gridRangeIsect=t.gridRangesJoin=t.gridRangeJoinOpt=t.gridRangeJoin=t.forEachTileInRange=t.forEachCellInRange=t.isWellFormed=t.isSheetGridRange=t.isSheetIndex=t.isSheetGridCell=t.isGridCell=void 0,t.applyComparison=t.normalizeCommaOpRef=t.isRangeOpNoMissing=t.isRangeOpClosed=t.isCommaOpNoBadOrMissing=t.isCommaOpClosed=t.isCommaOpRefWellFormed=t.getBoundName=t.getEtaFuncId=t.getUserDefinedFuncName=t.getWorksheetFuncId=t.createFailureErrorClass=t.internal=t.unavailable=t.notImplemented=t.ReasonKind=t.LangReasonKind=void 0;const n=r(72858),a=r(66562);Object.defineProperty(t,"isGridCell",{enumerable:!0,get:function(){return a.isGridCell}}),Object.defineProperty(t,"isSheetGridCell",{enumerable:!0,get:function(){return a.isSheetGridCell}});const i=r(50667),o=r(61824),s=r(39470),u=r(80168),l=r(76132),c=r(93383);var d=r(66562);function g(e,t){const{row:r,col:n,rows:i,cols:o}=e,{row:s,col:l,rows:c,cols:d}=t,g=(0,u.fastMin)(r,s),m=(0,u.fastMin)(n,l),h=(0,u.fastMax)(r+i,s+c)-g,p=(0,u.fastMax)(n+o,l+d)-m;return(0,a.unsafeGridRange)(g,m,h,p)}function m(e,t){return e===t||e.name===t.name&&e.path===t.path}function h(e,t){return m(e.document,t.document)&&e.index===t.index}function p(e,t){return e.row===t.row&&e.col===t.col}function f(e,t){return e.row===t.row&&e.col===t.col&&e.rows===t.rows&&e.cols===t.cols}function S(e){return(0,a.isGridCell)(e)?e:(0,a.unsafeGridRange)(e.row,e.col,1,1)}Object.defineProperty(t,"isSheetIndex",{enumerable:!0,get:function(){return d.isSheetIndex}}),Object.defineProperty(t,"isSheetGridRange",{enumerable:!0,get:function(){return d.isSheetGridRange}}),t.isWellFormed=function(e){return e.isWellFormed},t.forEachCellInRange=function(e,t){if((0,a.isGridCell)(e))return t(e,0,0);const{row:r,rows:n,col:i,cols:o}=e;for(let e=0;e<n;e+=1)for(let n=0;n<o;n+=1)if(!t((0,a.gridCell)(r+e,i+n),e,n))return!1;return!0},t.forEachTileInRange=function(e,t,r){const{row:i,rows:o,col:s,cols:l}=e;(0,n.assertPositiveInteger)("calc.lang.forEachTileInRange",t),(0,n.assertIndex)("calc.lang.forEachTileInRange",i,a.sheetRows),(0,n.assertIndex)("calc.lang.forEachTileInRange",s,a.sheetCols),(0,n.assertPositiveLength)("calc.lang.forEachTileInRange",o,a.sheetRows-i),(0,n.assertPositiveLength)("calc.lang.forEachTileInRange",l,a.sheetCols-s);for(let e=i;e<i+o;e+=t)for(let n=s;n<s+l;n+=t)if(!r((0,a.unsafeGridRange)(e,n,(0,u.fastMin)(t,o+i-e),(0,u.fastMin)(t,l+s-n))))return!1;return!0},t.gridRangeJoin=g,t.gridRangeJoinOpt=function(e,t){return e?t?g(e,t):e:t},t.gridRangesJoin=function(e){return 0===e.length&&(0,n.assertFalse)("calc.runtime.gridRangesJoin: expected nonempty range array"),e.reduce(g)},t.gridRangeIsect=function(e,t){const{row:r,col:n,rows:i,cols:o}=e,{row:s,col:l,rows:c,cols:d}=t,g=(0,u.fastMax)(r,s),m=(0,u.fastMax)(n,l),h=(0,u.fastMin)(r+i,s+c)-g,p=(0,u.fastMin)(n+o,l+d)-m;if(!(h<=0||p<=0))return(0,a.unsafeGridRange)(g,m,h,p)},t.gridRangeIsects=function(e,t){const{row:r,col:n,rows:a,cols:i}=e,{row:o,col:s,rows:l,cols:c}=t;return(0,u.fastMax)(r,o)<(0,u.fastMin)(r+a,o+l)&&(0,u.fastMax)(n,s)<(0,u.fastMin)(n+i,s+c)},t.gridCellImplicitIsect=function(e,t){const{row:r,col:n}=e,{row:i,col:o,rows:s,cols:u}=t,l=i<=r&&r<i+s,c=o<=n&&n<o+u;return l&&c?(0,a.gridCell)(r,n):l&&1===u?(0,a.gridCell)(r,o):c&&1===s?(0,a.gridCell)(i,n):1===u&&1===s?(0,a.gridCell)(i,o):void 0},t.gridRangeCompare=function(e,t){const{row:r,col:n,rows:a,cols:i}=e,{row:o,col:s,rows:u,cols:l}=t,c=r+a,d=o+u,g=n+i,m=s+l;return r===o&&c===d&&n===s&&g===m?0:r<=o&&c>=d&&n<=s&&g>=m?1:r>=o&&c<=d&&n>=s&&g<=m?-1:void 0},t.gridRangeExcept=function(e,t){const r=[e.row,e.row+e.rows],n=[e.col,e.col+e.cols],i=[t.row,t.row+t.rows],o=[t.col,t.col+t.cols],s=(0,l.ivlCompare)(r,i),u=(0,l.ivlCompare)(n,o);if(void 0!==s&&s<=0){const t=(0,l.ivlExcept)(n,o);if(void 0!==t)return(0,a.gridRange)(e.row,t[0],e.rows,t[1]-t[0])}if(void 0!==u&&u<=0){const t=(0,l.ivlExcept)(r,i);if(void 0!==t)return(0,a.gridRange)(t[0],e.col,t[1]-t[0],e.cols)}},t.gridRangeSize=function(e){return e.rows*e.cols},t.isDocumentLocEqual=m,t.isSheetIndexEqual=h,t.sheetRangeToSheetIndex=function(e){if(e.index===e.index2)return{...e,__isRange:!1}},t.isNameScopeEqual=function(e,t){return m(e.document,t.document)&&e.index===t.index},t.isGridCellEqual=p,t.isGridRangeEqual=f,t.isSheetGridCellEqual=function(e,t){return h(e.sheet,t.sheet)&&p(e.range,t.range)},t.isSheetGridRangeEqual=function(e,t){return h(e.sheet,t.sheet)&&f(e.range,t.range)},t.gridRangeAnchor=S,t.sheetGridRangeAnchor=function(e){return(0,a.isSheetGridCell)(e)?e:(0,a.sheetGridCell)(e.sheet,S(e.range))},t.gridCellRange=function(e,t){const{row:r,col:n}=e,{row:i,col:o}=t;return(0,a.unsafeGridRange)((0,u.fastMin)(r,i),(0,u.fastMin)(n,o),Math.abs(i-r)+1,Math.abs(o-n)+1)};const v=[];function F(e){return e.kind===i.NodeKind.Literal&&E(e.oper)}function y(e){return e.kind===i.NodeKind.Literal&&A(e.oper)}function C(e){return e.kind===o.OperKind.Number}function A(e){return e.kind===o.OperKind.Boolean}function E(e){return e.kind===o.OperKind.Missing}t.getArguments=function(e){return 0===function(e){return 1===e.length&&F(e[0])?0:e.length}(e)?v:e},t.isOperatorNode=function(e){return e.kind===i.NodeKind.Operator},t.isWSFNode=function(e){return e.kind===i.NodeKind.WSF},t.isUnqualifiedNameNode=function(e){return e.kind===i.NodeKind.Name&&void 0===e.qualifier},t.isMissingNode=function(e){return e.kind===i.NodeKind.Missing},t.isMissingLiteralNode=F,t.isNumberLiteralNode=function(e){return e.kind===i.NodeKind.Literal&&C(e.oper)},t.isBooleanLiteralNode=y,t.getArgType=function({maxArgs:e,headTypes:t,restTypes:r,tailTypes:a},i,s){if((0,n.assertPositiveInteger)("calc.runtime.getArgType: n",s),(0,n.assertIndex)("calc.runtime.getArgType: i",i,s),i>=e)return o.SignatureType.None;if(i<t.length)return t[i];if(0===r.length)return o.SignatureType.None;if(i<t.length+r.length)return r[i-t.length];const u=(s-t.length)%r.length;return u>a.length?o.SignatureType.None:i>=s-u?a[i-(s-u)]:r[(i-t.length)%r.length]},t.isValidArgsLength=function({minArgs:e,maxArgs:t,headTypes:r,restTypes:n,tailTypes:a},i){return!(i<e||i>t)&&(i<=r.length+n.length||0!==n.length&&(i-r.length)%n.length<=a.length)},t.shouldFieldRefBeBracketed=function(e,t,r){if(0===r.length)return!1;if(t.field.kind!==i.NodeKind.Ident)return!1;let n=e;for(;n.kind===i.NodeKind.App&&n.head.kind===i.NodeKind.Operator;){const e=n.head.id;if(e!==c.OperatorId.Range&&e!==c.OperatorId.Isect||2!==n.args.length)break;n=n.args[1]}return y(n)||n.kind===i.NodeKind.Name||n.kind===i.NodeKind.CellRef},t.isNumberOper=C,t.isStringOper=function(e){return e.kind===o.OperKind.String},t.isBooleanOper=A,t.isErrorOper=function(e){return e.kind===o.OperKind.Error},t.isRangeOper=function(e){return e.kind===o.OperKind.Range},t.isArrayOper=function(e){return e.kind===o.OperKind.Array},t.isMissingOper=E,t.isBlankOper=function(e){return e.kind===o.OperKind.Blank},t.isRichOper=function(e){return e.kind===o.OperKind.Rich};const b=o.OperKind.Number|o.OperKind.String|o.OperKind.Boolean;t.isPrimitiveOper=function(e){return 0!=(e.kind&b)};const R=b|o.OperKind.Error|o.OperKind.Array|o.OperKind.Rich;var T;t.isWriteOper=function(e){return 0!=(e.kind&R)},t.isReadOperEqual=function e(t,r,a,i){if(a.kind!==r.kind)return!1;switch(a.kind){case o.OperKind.Boolean:case o.OperKind.String:return a.value===r.value;case o.OperKind.Number:return 0===t.cond2(a,r);case o.OperKind.Error:return a.type===r.type;case o.OperKind.Rich:return i;case o.OperKind.Array:const s=r;if(a.cols!==s.cols||a.rows!==s.rows)return!1;for(let r=0;r<a.rows;r+=1){const n=a.opers[r],o=s.opers[r];for(let r=0;r<a.cols;r+=1)if(!e(t,o[r],n[r],i))return!1}return!0;case o.OperKind.Blank:return!0;default:return(0,n.assertNever)("calc.lang.readOperEq",a)}},function(e){e.NotImplemented="NotImplemented",e.Unavailable="Unavailable",e.Internal="Internal"}(T||(t.LangReasonKind=T={})),t.ReasonKind={...s.ReasonKind,...T},t.notImplemented=function(e){return{kind:t.ReasonKind.NotImplemented,features:e}},t.unavailable=function(e,...r){return 0===e.length&&(0,n.assertFalse)("calc.lang.unavailable: expected nonempty array"),{kind:t.ReasonKind.Unavailable,objects:e}},t.internal=function(e){return{kind:t.ReasonKind.Internal,message:e}},t.createFailureErrorClass=function(e){const t=function(t){this.reason=t,this.name=e,this.stack=e,this.message=t.kind};return(t.prototype=Object.create(Error.prototype)).constructor=t,t};t.getWorksheetFuncId=function(e,t){let r=t;return r.length>6&&0===e.stringCompareCI(r.substring(0,6),"_xlfn.")&&(r=r.substring(6),r.length>6&&0===e.stringCompareCI(r.substring(0,6),"_xlws.")&&(r=r.substring(6))),e.getWorksheetFuncId(r)};t.getUserDefinedFuncName=function(e,t){let r=t;return r.length>7&&0===e.stringCompareCI(r.substring(0,7),"_xludf.")&&(r=r.substring(7)),r};t.getEtaFuncId=function(e,t){let r=t;return r.length>7&&0===e.stringCompareCI(r.substring(0,7),"_xleta.")&&(r=r.substring(7)),e.getWorksheetFuncId(r)};function k(e){return e.kind!==i.StructRefKind.SpecialRef&&e.kind!==i.StructRefKind.BadRef||e.isBracketed}function N(e){return e.kind===i.StructRefKind.MissingRef||e.kind===i.StructRefKind.BadRef}function I(e){switch(e.kind){case i.StructRefKind.SpecialRef:case i.StructRefKind.ColumnRef:return e.isClosed;case i.StructRefKind.RangeOpRef:return I(e.lhs)&&I(e.rhs);case i.StructRefKind.MissingRef:return!0;case i.StructRefKind.BadRef:return e.isClosed}}t.getBoundName=function(e,t){let r=t;return r.length>6&&0===e.stringCompareCI(r.substring(0,6),"_xlpm.")&&(r=r.substring(6)),r},t.isCommaOpRefWellFormed=function(e){return e.columnRefs.length<=1&&e.refs.every(k)&&function({specialRefs:e}){const t=Object.keys(e).reduce(((t,r)=>t+(e[Number(r)]?1:0)),0);return 1===t||2===t&&e[i.SpecialRefId.Data]&&(e[i.SpecialRefId.Headers]||e[i.SpecialRefId.Totals])}(e)},t.isCommaOpClosed=function(e){return e.refs.every(I)},t.isCommaOpNoBadOrMissing=function(e){return!e.refs.some(N)},t.isRangeOpClosed=function(e){return I(e.lhs)&&I(e.rhs)},t.isRangeOpNoMissing=function(e){return!N(e.lhs)&&!N(e.rhs)};const O={[i.SpecialRefId.All]:1,[i.SpecialRefId.Headers]:2,[i.SpecialRefId.Data]:3,[i.SpecialRefId.Totals]:4,[i.SpecialRefId.ThisRow]:5},_=e=>e.kind===i.StructRefKind.MissingRef?7:e.kind!==i.StructRefKind.SpecialRef?6:O[e.id];function P(e,t){return _(e)-_(t)}t.normalizeCommaOpRef=function(e){const t={},r=[];for(const n of e.refs)n.kind!==i.StructRefKind.SpecialRef?r.push(n):void 0===t[n.id]&&(t[n.id]=!0,r.push(n));return r.sort(P),r},t.applyComparison=function(e,t){switch(e){case c.OperatorId.Eq:return 0===t;case c.OperatorId.Ne:return 0!==t;case c.OperatorId.Lt:return t<0;case c.OperatorId.Gt:return t>0;case c.OperatorId.Le:return t<=0;case c.OperatorId.Ge:return t>=0}}},91176:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.falseOper=t.trueOper=t.blankOper=t.missingOper=t.range3DOper=t.rangeSeqOper=t.arrayOper=t.externalErrorOper=t.busyErrorOper=t.calcErrorOper=t.fieldErrorOper=t.unknownErrorOper=t.blockedErrorOper=t.connectErrorOper=t.spillErrorOper=t.gettingDataErrorOper=t.naErrorOper=t.numErrorOper=t.nameErrorOper=t.refErrorOper=t.valueErrorOper=t.div0ErrorOper=t.nullErrorOper=t.errorOper=t.stringOper=t.booleanOper=t.precedents=t.ErrorType=t.cellStringLimit=t.PrecsBound=void 0;const n=r(91092);var a=n.assertions.assertNatural,i=n.assertions.assertPositiveInteger,o=n.assertions.assertFalse,s=n.util.partialArray;const u=r(61824);var l,c;function d(e){return{kind:u.OperKind.Error,type:e}}!function(e){e[e.Lower=-1]="Lower",e[e.Exact=0]="Exact",e[e.Upper=1]="Upper"}(l||(t.PrecsBound=l={})),t.cellStringLimit=32767,function(e){e[e.NULL=1]="NULL",e[e.DIV0=2]="DIV0",e[e.VALUE=3]="VALUE",e[e.REF=4]="REF",e[e.NAME=5]="NAME",e[e.NUM=6]="NUM",e[e.NA=7]="NA",e[e.GETTING_DATA=8]="GETTING_DATA",e[e.SPILL=9]="SPILL",e[e.CONNECT=10]="CONNECT",e[e.BLOCKED=11]="BLOCKED",e[e.UNKNOWN=12]="UNKNOWN",e[e.FIELD=13]="FIELD",e[e.CALC=14]="CALC",e[e.BUSY=16]="BUSY",e[e.EXTERNAL=19]="EXTERNAL",e[e.TIMEOUT=20]="TIMEOUT"}(c||(t.ErrorType=c={})),t.precedents=function(e,t,r,n,a){return{cells:e,names:t,udfs:r,special:n,bound:a}},t.booleanOper=function(e){return e?t.trueOper:t.falseOper},t.stringOper=function(e){return{kind:u.OperKind.String,value:e}},t.errorOper=function(e){const t=g[e];return void 0!==t?t:d(e)},t.nullErrorOper=d(c.NULL),t.div0ErrorOper=d(c.DIV0),t.valueErrorOper=d(c.VALUE),t.refErrorOper=d(c.REF),t.nameErrorOper=d(c.NAME),t.numErrorOper=d(c.NUM),t.naErrorOper=d(c.NA),t.gettingDataErrorOper=d(c.GETTING_DATA),t.spillErrorOper=d(c.SPILL),t.connectErrorOper=d(c.CONNECT),t.blockedErrorOper=d(c.BLOCKED),t.unknownErrorOper=d(c.UNKNOWN),t.fieldErrorOper=d(c.FIELD),t.calcErrorOper=d(c.CALC),t.busyErrorOper=d(c.BUSY),t.externalErrorOper=d(c.EXTERNAL);const g=s({[c.NULL]:t.nullErrorOper,[c.DIV0]:t.div0ErrorOper,[c.VALUE]:t.valueErrorOper,[c.REF]:t.refErrorOper,[c.NAME]:t.nameErrorOper,[c.NUM]:t.numErrorOper,[c.NA]:t.naErrorOper,[c.GETTING_DATA]:t.gettingDataErrorOper,[c.SPILL]:t.spillErrorOper,[c.CONNECT]:t.connectErrorOper,[c.BLOCKED]:t.blockedErrorOper,[c.UNKNOWN]:t.unknownErrorOper,[c.FIELD]:t.fieldErrorOper,[c.CALC]:t.calcErrorOper,[c.BUSY]:t.busyErrorOper,[c.EXTERNAL]:t.externalErrorOper});t.arrayOper=function(e,t,r){return a("calc.lang.arrayOper",e),a("calc.lang.arrayOper",t),r.length!==e?o("calc.lang.arrayOper: Inconsistent row number"):{kind:u.OperKind.Array,rows:e,cols:t,opers:r}},t.rangeSeqOper=function(e,t){return i("calc.lang.rangeSeqOper",t.length),{kind:u.OperKind.Range,sheets:e,ranges:t}},t.range3DOper=function(e,t){return{kind:u.OperKind.Range,sheets:e,ranges:[t]}},t.missingOper={kind:u.OperKind.Missing},t.blankOper={kind:u.OperKind.Blank},t.trueOper={kind:u.OperKind.Boolean,value:!0},t.falseOper={kind:u.OperKind.Boolean,value:!1}},97791:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reducePledge=t.reduceTopDown_Pledge=t.reduceBottomUp=t.reduceBottomUp_MaxDepth=t.reduceBottomUp_Pledge=t.PledgeReducer=t.reduceBottomUp_CPS=t.reduceBottomUp_Recursive=t.zipVisitor=t.ZipVisitor=t.depthVisitor=t.composeVisitor=t.ComposeVisitor=t.binaryVisitor=t.BinaryVisitor=t.DelegatingVisitor=t.voidVisitor=t.constVisitor=t.ConstVisitor=t.identityVisitor=t.IdentityVisitor=t.bindVisitor=t.visitCellRef=t.visitQualifier=t.visitAppHeadNode=t.visitWSFNode=t.visitOperatorNode=t.visitFormulaNode=void 0;const n=r(72858),a=r(80168),i=r(49207),o=r(50667),s=r(50667);function u(e,t){switch(t.kind){case s.NodeKind.Literal:{const{oper:r,isClosed:n,label:a}=t;return e.literalNode(r,n,a)}case s.NodeKind.Array:{const{nodes:r,isClosed:n,label:a}=t;return e.arrayNode(r,n,a)}case s.NodeKind.App:{const{head:r,args:n,isClosed:a,label:i}=t;return e.appNode(r,n,a,i)}case s.NodeKind.Let:{const{head:r,vars:n,body:a,badArgs:i,isClosed:o,label:s}=t;return e.letNode(r,n,a,i,o,s)}case s.NodeKind.Lambda:{const{head:r,params:n,body:a,badArgs:i,isClosed:o,label:s}=t;return e.lambdaNode(r,n,a,i,o,s)}case s.NodeKind.Paren:{const{node:r,isClosed:n,label:a}=t;return e.parenNode(r,n,a)}case s.NodeKind.Name:{const{parts:r,qualifier:n,label:a}=t;return e.nameNode(r,n,a)}case s.NodeKind.CellRef:{const{ref:r,qualifier:n,label:a}=t;return e.cellRefNode(r,n,a)}case s.NodeKind.FieldRef:{const{lhs:r,rhs:n,label:a}=t;return e.fieldRefNode(r,n,a)}case s.NodeKind.StructRef:{const{lhs:r,rhs:n,label:a}=t;return e.structRefNode(r,n,a)}case s.NodeKind.Missing:{const{chars:r,label:n}=t;return e.missingNode(r,n)}case s.NodeKind.BadChars:{const{type:r,chars:n,label:a}=t;return e.badCharsNode(r,n,a)}case s.NodeKind.BadSequence:{const{type:r,contents:n,label:a}=t;return e.badSequenceNode(r,n,a)}default:return(0,n.assertNever)("calc.lang.visitFormulaNode",t)}}function l(e,t){const{id:r,label:n}=t;return e.operatorNode(r,n)}function c(e,t){const{id:r,whole:n,label:a}=t;return e.wsfNode(r,n,a)}function d(e,t){switch(t.kind){case s.NodeKind.Operator:return l(e,t);case s.NodeKind.WSF:return c(e,t);default:return u(e,t)}}function g(e){return{literalNode:e.literalNode.bind(e),arrayNode:e.arrayNode.bind(e),appNode:e.appNode.bind(e),letNode:e.letNode.bind(e),lambdaNode:e.lambdaNode.bind(e),parenNode:e.parenNode.bind(e),nameNode:e.nameNode.bind(e),cellRefNode:e.cellRefNode.bind(e),fieldRefNode:e.fieldRefNode.bind(e),structRefNode:e.structRefNode.bind(e),missingNode:e.missingNode.bind(e),badSequenceNode:e.badSequenceNode.bind(e),badCharsNode:e.badCharsNode.bind(e),operatorNode:e.operatorNode.bind(e),wsfNode:e.wsfNode.bind(e)}}t.visitFormulaNode=u,t.visitOperatorNode=l,t.visitWSFNode=c,t.visitAppHeadNode=d,t.visitQualifier=function(e,t){switch(t.kind){case s.QualifierKind.Error:{const{label:r}=t;return e.errorQualifier(r)}case s.QualifierKind.Relative:{const{label:r}=t;return e.relativeQualifier(r)}case s.QualifierKind.Document:{const{document:r,path:n,isQuoted:a,label:i}=t;return e.documentQualifier(r,n,a,i)}case s.QualifierKind.Sheet:{const{sheet:r,document:n,isQuoted:a,label:i}=t;return e.sheetQualifier(r,n,a,i)}case s.QualifierKind.Ident:{const{name:r,isQuoted:n,label:a}=t;return e.identQualifier(r,n,a)}case s.QualifierKind.SheetRange:{const{sheet1:r,sheet2:n,document:a,isQuoted:i,label:o}=t;return e.sheetRangeQualifier(r,n,a,i,o)}case s.QualifierKind.Bad:{const{chars:r,isQuoted:n,isClosed:a,isTerminated:i,label:o}=t;return e.badQualifier(r,n,a,i,o)}default:return(0,n.assertNever)("calc.lang.visitQualifier",t)}},t.visitCellRef=function(e,t){switch(t.kind){case s.CellRefKind.Error:{const{label:r}=t;return e.cellRefError(r)}case s.CellRefKind.Single:{const{row:r,col:n,isBracketed:a,label:i}=t;return e.cellRefSingle(r,n,a,i)}case s.CellRefKind.Range:{const{ref1:r,ref2:n,label:a}=t;return e.cellRefRange(r,n,a)}case s.CellRefKind.Row:{const{row1:r,row2:n,isBracketed:a,label:i}=t;return e.cellRefRow(r,n,a,i)}case s.CellRefKind.Col:{const{col1:r,col2:n,isBracketed:a,label:i}=t;return e.cellRefCol(r,n,a,i)}case s.CellRefKind.Bad:{const{chars:r,isBracketed:n,label:a}=t;return e.cellRefBad(r,n,a)}default:return(0,n.assertNever)("calc.lang.visitCellRef",t)}},t.bindVisitor=g;class m{literalNode(e,t,r){return(0,s.literalNode)(e,t,r)}arrayNode(e,t,r){return(0,s.arrayNode)(e,t,r)}appNode(e,t,r,n){return(0,s.appNode)(e,t,r,n)}letNode(e,t,r,n,a,i){return(0,s.letNode)(e,t,r,n,a,i)}lambdaNode(e,t,r,n,a,i){return(0,s.lambdaNode)(e,t,r,n,a,i)}parenNode(e,t,r){return(0,s.parenNode)(e,t,r)}nameNode(e,t,r){return(0,s.nameNode)(e,t,r)}cellRefNode(e,t,r){return(0,s.cellRefNode)(e,t,r)}fieldRefNode(e,t,r){return(0,s.fieldRefNode)(e,t,r)}structRefNode(e,t,r){return(0,s.structRefNode)(e,t,r)}missingNode(e,t){return(0,s.missingNode)(e,t)}badSequenceNode(e,t,r){return(0,o.badSequenceNode)(e,t,r)}badCharsNode(e,t,r){return(0,o.badCharsNode)(e,t,r)}operatorNode(e,t){return(0,s.operatorNode)(e,t)}wsfNode(e,t,r){return(0,s.wsfNode)(e,t,r)}}t.IdentityVisitor=m,t.identityVisitor=g(new m);class h{literalNode(e,t,r){return this.value}arrayNode(e,t,r){return this.value}appNode(e,t,r,n){return this.value}letNode(e,t,r,n,a,i){return this.value}lambdaNode(e,t,r,n,a,i){return this.value}parenNode(e,t,r){return this.value}nameNode(e,t,r){return this.value}cellRefNode(e,t,r){return this.value}fieldRefNode(e,t,r){return this.value}structRefNode(e,t,r){return this.value}missingNode(e,t){return this.value}badSequenceNode(e,t,r){return this.value}badCharsNode(e,t,r){return this.value}operatorNode(e,t){return this.value}wsfNode(e,t,r){return this.value}constructor(e){this.value=e}}function p(e){return g(new h(e))}t.ConstVisitor=h,t.constVisitor=p,t.voidVisitor=p(void 0);class f{literalNode(e,t,r){return this.visitor.literalNode(e,t,r)}arrayNode(e,t,r){return this.visitor.arrayNode(e,t,r)}appNode(e,t,r,n){return this.visitor.appNode(e,t,r,n)}letNode(e,t,r,n,a,i){return this.visitor.letNode(e,t,r,n,a,i)}lambdaNode(e,t,r,n,a,i){return this.visitor.lambdaNode(e,t,r,n,a,i)}parenNode(e,t,r){return this.visitor.parenNode(e,t,r)}nameNode(e,t,r){return this.visitor.nameNode(e,t,r)}cellRefNode(e,t,r){return this.visitor.cellRefNode(e,t,r)}fieldRefNode(e,t,r){return this.visitor.fieldRefNode(e,t,r)}structRefNode(e,t,r){return this.visitor.structRefNode(e,t,r)}missingNode(e,t){return this.visitor.missingNode(e,t)}badSequenceNode(e,t,r){return this.visitor.badSequenceNode(e,t,r)}badCharsNode(e,t,r){return this.visitor.badCharsNode(e,t,r)}operatorNode(e,t){return this.visitor.operatorNode(e,t)}wsfNode(e,t,r){return this.visitor.wsfNode(e,t,r)}constructor(e){this.visitor=e}}t.DelegatingVisitor=f;class S extends f{arrayNode(e,t,r){return(0,n.assertTrue)("calc.lang.binaryVisitor: non-empty array",e.length>0&&e[0].length>0),e.map((e=>e.reduce(this.reducer))).reduce(this.reducer)}appNode(e,t,r,n){return t.reduce(this.reducer,e)}letNode(e,t,r,n,a,i){return[...t.map((({binder:e})=>e.arg)),...void 0===r?[]:[r.arg],...n.map((e=>e.arg))].reduce(this.reducer,e)}lambdaNode(e,t,r,n,i,o){return[...t.map((({name:e})=>e.arg.def?.rhs)).filter(a.isDefined),...void 0===r?[]:[r.arg],...n.map((e=>e.arg))].reduce(this.reducer,e)}parenNode(e,t,r){return e}fieldRefNode(e,t,r){return e}badSequenceNode(e,t,r){return(0,n.assertTrue)("calc.lang.binaryVisitor: non-empty bad-sequence",t.length>0),t.reduce(this.reducer)}constructor(e,t){super(e),this.reducer=(e,r)=>t(e,r)}}function v(e,t){return g(new S(e,t))}t.BinaryVisitor=S,t.binaryVisitor=v;class F{literalNode(e,t,r){return this.b(this.a.literalNode(e,t,r))}arrayNode(e,t,r){return this.b(this.a.arrayNode(e,t,r))}appNode(e,t,r,n){return this.b(this.a.appNode(e,t,r,n))}letNode(e,t,r,n,a,i){return this.b(this.a.letNode(e,t,r,n,a,i))}lambdaNode(e,t,r,n,a,i){return this.b(this.a.lambdaNode(e,t,r,n,a,i))}parenNode(e,t,r){return this.b(this.a.parenNode(e,t,r))}nameNode(e,t,r){return this.b(this.a.nameNode(e,t,r))}cellRefNode(e,t,r){return this.b(this.a.cellRefNode(e,t,r))}fieldRefNode(e,t,r){return this.b(this.a.fieldRefNode(e,t,r))}structRefNode(e,t,r){return this.b(this.a.structRefNode(e,t,r))}missingNode(e,t){return this.b(this.a.missingNode(e,t))}badSequenceNode(e,t,r){return this.b(this.a.badSequenceNode(e,t,r))}badCharsNode(e,t,r){return this.b(this.a.badCharsNode(e,t,r))}operatorNode(e,t){return this.b(this.a.operatorNode(e,t))}wsfNode(e,t,r){return this.b(this.a.wsfNode(e,t,r))}constructor(e,t){this.a=e,this.b=t}}function y(e,t){return g(new F(e,t))}t.ComposeVisitor=F,t.composeVisitor=y,t.depthVisitor=y(v(p(0),a.fastMax),(e=>e+1));class C{literalNode(e,t,r){const n={};for(const a of this.keys)n[a]=this.visitors[a].literalNode(e,t,r);return n}arrayNode(e,t,r){const n={};for(const a of this.keys)n[a]=this.visitors[a].arrayNode(e,t,r);return n}appNode(e,t,r,n){const a={};for(const i of this.keys)a[i]=this.visitors[i].appNode(e,t,r,n);return a}letNode(e,t,r,n,a,i){const o={};for(const s of this.keys)o[s]=this.visitors[s].letNode(e,t,r,n,a,i);return o}lambdaNode(e,t,r,n,a,i){const o={};for(const s of this.keys)o[s]=this.visitors[s].lambdaNode(e,t,r,n,a,i);return o}parenNode(e,t,r){const n={};for(const a of this.keys)n[a]=this.visitors[a].parenNode(e,t,r);return n}nameNode(e,t,r){const n={};for(const a of this.keys)n[a]=this.visitors[a].nameNode(e,t,r);return n}cellRefNode(e,t,r){const n={};for(const a of this.keys)n[a]=this.visitors[a].cellRefNode(e,t,r);return n}fieldRefNode(e,t,r){const n={};for(const a of this.keys)n[a]=this.visitors[a].fieldRefNode(e,t,r);return n}structRefNode(e,t,r){const n={};for(const a of this.keys)n[a]=this.visitors[a].structRefNode(e,t,r);return n}missingNode(e,t){const r={};for(const n of this.keys)r[n]=this.visitors[n].missingNode(e,t);return r}badSequenceNode(e,t,r){const n={};for(const a of this.keys)n[a]=this.visitors[a].badSequenceNode(e,t,r);return n}badCharsNode(e,t,r){const n={};for(const a of this.keys)n[a]=this.visitors[a].badCharsNode(e,t,r);return n}operatorNode(e,t){const r={};for(const n of this.keys)r[n]=this.visitors[n].operatorNode(e,t);return r}wsfNode(e,t,r){const n={};for(const a of this.keys)n[a]=this.visitors[a].wsfNode(e,t,r);return n}constructor(e){this.visitors=e,this.keys=Object.keys(e)}}function A(e,t){const r=t=>{switch(t.kind){case s.NodeKind.Literal:{const{oper:r,isClosed:n,label:a}=t;return e.literalNode(r,n,a)}case s.NodeKind.Array:{const{nodes:n,isClosed:a,label:i}=t;return e.arrayNode(n.map((e=>e.map(r))),a,i)}case s.NodeKind.App:{const{head:n,args:a,isClosed:i,label:o}=t;return e.appNode((t=>{switch(t.kind){case s.NodeKind.Operator:return l(e,t);case s.NodeKind.WSF:return c(e,t);default:return r(t)}})(n),a.map(r),i,o)}case s.NodeKind.Let:{const{head:n,vars:a,body:i,badArgs:o,isClosed:u,label:l}=t;return e.letNode(c(e,n),a.map((({name:e,binder:t})=>(0,s.letVar)(e,(0,s.indexedArg)(r(t.arg),t.index)))),void 0===i?void 0:(0,s.indexedArg)(r(i.arg),i.index),o.map((e=>(0,s.indexedArg)(r(e.arg),e.index))),u,l)}case s.NodeKind.Lambda:{const{head:n,params:a,body:i,badArgs:o,isClosed:u,label:l}=t;return e.lambdaNode(c(e,n),a.map((({name:e})=>void 0===e.arg.def?(0,s.lambdaParam)(e):(0,s.lambdaParam)((0,s.indexedArg)((0,s.paramNode)(e.arg.name,(0,s.paramDefault)(r(e.arg.def.rhs),e.arg.def.label),e.arg.label),e.index)))),void 0===i?void 0:(0,s.indexedArg)(r(i.arg),i.index),o.map((e=>(0,s.indexedArg)(r(e.arg),e.index))),u,l)}case s.NodeKind.Paren:{const{node:n,isClosed:a,label:i}=t;return e.parenNode(r(n),a,i)}case s.NodeKind.Name:{const{parts:r,qualifier:n,label:a}=t;return e.nameNode(r,n,a)}case s.NodeKind.CellRef:{const{ref:r,qualifier:n,label:a}=t;return e.cellRefNode(r,n,a)}case s.NodeKind.FieldRef:{const{lhs:n,rhs:a,label:i}=t;return e.fieldRefNode(r(n),a,i)}case s.NodeKind.StructRef:{const{lhs:r,rhs:n,label:a}=t;return e.structRefNode(r,n,a)}case s.NodeKind.Missing:{const{chars:r,label:n}=t;return e.missingNode(r,n)}case s.NodeKind.BadChars:{const{type:r,chars:n,label:a}=t;return e.badCharsNode(r,n,a)}case s.NodeKind.BadSequence:{const{type:n,contents:a,label:i}=t;return e.badSequenceNode(n,a.map(r),i)}default:return(0,n.assertNever)("calc.lang.reduceBottomUp_Recursive",t)}};return r(t)}function E(e,t,r,n){const a=[],i=e=>(a.push(e),o),o=()=>a.length<t.length?r(e,t[a.length],i):n(a);return o}function b(e,t,r){return E(e,t,O,r)}function R(e,t,r,n){return()=>void 0!==t?r(e,t,n):n(void 0)}function T(e,t,r){const{id:n,whole:a,label:i}=t;return()=>r(e.wsfNode(n,a,i))}function k(e,{name:t,binder:r},n){return O(e,r.arg,(e=>n((0,s.letVar)(t,(0,s.indexedArg)(e,r.index)))))}function N(e,{name:t},r){const n=t.arg;return void 0===n.def?()=>r((0,s.lambdaParam)(t)):O(e,n.def.rhs,(e=>r((0,s.lambdaParam)((0,s.indexedArg)((0,s.paramNode)(n.name,(0,s.paramDefault)(e,n.def.label),n.label),t.index)))))}function I(e,{arg:t,index:r},n){return O(e,t,(e=>n((0,s.indexedArg)(e,r))))}function O(e,t,r){switch(t.kind){case s.NodeKind.Literal:{const{oper:n,isClosed:a,label:i}=t;return()=>r(e.literalNode(n,a,i))}case s.NodeKind.Array:{const{nodes:n,isClosed:a,label:i}=t;return E(e,n,b,(t=>r(e.arrayNode(t,a,i))))}case s.NodeKind.App:{const{head:n,args:a,isClosed:i,label:o}=t;return()=>function(e,t,r){switch(t.kind){case s.NodeKind.Operator:{const{id:n,label:a}=t;return()=>r(e.operatorNode(n,a))}case s.NodeKind.WSF:return T(e,t,r);default:return O(e,t,r)}}(e,n,(t=>b(e,a,(n=>r(e.appNode(t,n,i,o))))))}case s.NodeKind.Let:{const{head:n,vars:a,body:i,badArgs:o,isClosed:s,label:u}=t;return()=>T(e,n,(t=>E(e,a,k,(n=>R(e,i,I,(a=>E(e,o,I,(i=>r(e.letNode(t,n,a,i,s,u))))))))))}case s.NodeKind.Lambda:{const{head:n,params:a,body:i,badArgs:o,isClosed:s,label:u}=t;return()=>T(e,n,(t=>()=>E(e,a,N,(n=>R(e,i,I,(a=>E(e,o,I,(i=>r(e.lambdaNode(t,n,a,i,s,u))))))))))}case s.NodeKind.Paren:{const{node:n,isClosed:a,label:i}=t;return()=>O(e,n,(t=>()=>r(e.parenNode(t,a,i))))}case s.NodeKind.Name:{const{parts:n,qualifier:a,label:i}=t;return()=>r(e.nameNode(n,a,i))}case s.NodeKind.CellRef:{const{ref:n,qualifier:a,label:i}=t;return()=>r(e.cellRefNode(n,a,i))}case s.NodeKind.FieldRef:{const{lhs:n,rhs:a,label:i}=t;return()=>O(e,n,(t=>()=>r(e.fieldRefNode(t,a,i))))}case s.NodeKind.StructRef:{const{lhs:n,rhs:a,label:i}=t;return()=>r(e.structRefNode(n,a,i))}case s.NodeKind.Missing:{const{chars:n,label:a}=t;return()=>r(e.missingNode(n,a))}case s.NodeKind.BadChars:{const{type:n,chars:a,label:i}=t;return()=>r(e.badCharsNode(n,a,i))}case s.NodeKind.BadSequence:{const{type:n,contents:a,label:i}=t;return b(e,a,(t=>r(e.badSequenceNode(n,t,i))))}default:return(0,n.assertNever)("calc.lang.reduceBottomUp_CPS",t)}}function _(e,t){let r;return function(e){let t=e;for(;null!=t;)t=t()}(O(e,t,(e=>{r=e}))),r}t.ZipVisitor=C,t.zipVisitor=function(e){return g(new C(e))},t.reduceBottomUp_Recursive=A,t.reduceBottomUp_CPS=_;class P{literalNode(e,t,r){return i.Pledge.try((()=>this.visitor.literalNode(e,t,r)))}arrayNode(e,t,r){return i.Pledge.all(e.map((e=>i.Pledge.all(e.map(this.lazyVisitFormulaNode))))).bind((e=>this.visitor.arrayNode(e,t,r)))}appNode(e,t,r,n){return this.lazyVisitAppHeadNode(e).bind((e=>i.Pledge.all(t.map(this.lazyVisitFormulaNode)).bind((t=>this.visitor.appNode(e,t,r,n)))))}letNode(e,t,r,n,a,o){return this.lazyVisitWSFNode(e).bind((e=>i.Pledge.all(t.map(this.lazyVisitVar)).bind((t=>(void 0===r?i.Pledge.resolve(void 0):this.lazyVisitIndexedArg(r)).bind((r=>i.Pledge.all(n.map(this.lazyVisitIndexedArg)).bind((n=>this.visitor.letNode(e,t,r,n,a,o)))))))))}lambdaNode(e,t,r,n,a,o){return this.lazyVisitWSFNode(e).bind((e=>i.Pledge.all(t.map(this.lazyVisitParam)).bind((t=>(void 0===r?i.Pledge.resolve(void 0):this.lazyVisitIndexedArg(r)).bind((r=>i.Pledge.all(n.map(this.lazyVisitIndexedArg)).bind((n=>this.visitor.lambdaNode(e,t,r,n,a,o)))))))))}parenNode(e,t,r){return this.lazyVisitFormulaNode(e).bind((e=>this.visitor.parenNode(e,t,r)))}nameNode(e,t,r){return i.Pledge.try((()=>this.visitor.nameNode(e,t,r)))}cellRefNode(e,t,r){return i.Pledge.try((()=>this.visitor.cellRefNode(e,t,r)))}fieldRefNode(e,t,r){return this.lazyVisitFormulaNode(e).bind((e=>this.visitor.fieldRefNode(e,t,r)))}structRefNode(e,t,r){return i.Pledge.try((()=>this.visitor.structRefNode(e,t,r)))}missingNode(e,t){return i.Pledge.try((()=>this.visitor.missingNode(e,t)))}badSequenceNode(e,t,r){return i.Pledge.all(t.map(this.lazyVisitFormulaNode)).bind((t=>this.visitor.badSequenceNode(e,t,r)))}badCharsNode(e,t,r){return i.Pledge.try((()=>this.visitor.badCharsNode(e,t,r)))}operatorNode(e,t){return i.Pledge.try((()=>this.visitor.operatorNode(e,t)))}wsfNode(e,t,r){return i.Pledge.try((()=>this.visitor.wsfNode(e,t,r)))}constructor(e){this.visitor=e,this.visitFormulaNode=e=>u(this,e),this.lazyVisitFormulaNode=e=>i.Pledge.resolve(e).bind(this.visitFormulaNode),this.visitAppHeadNode=e=>d(this,e),this.lazyVisitAppHeadNode=e=>i.Pledge.resolve(e).bind(this.visitAppHeadNode),this.visitWSFNode=e=>c(this,e),this.lazyVisitWSFNode=e=>i.Pledge.resolve(e).bind(this.visitWSFNode),this.lazyVisitVar=({name:e,binder:t})=>this.lazyVisitFormulaNode(t.arg).bind((r=>(0,s.letVar)(e,(0,s.indexedArg)(r,t.index)))),this.lazyVisitParam=({name:e})=>{const t=e.arg;return void 0===t.def?i.Pledge.resolve((0,s.lambdaParam)(e)):this.lazyVisitFormulaNode(t.def.rhs).bind((r=>(0,s.lambdaParam)((0,s.indexedArg)((0,s.paramNode)(t.name,(0,s.paramDefault)(r,t.def.label),t.label),e.index))))},this.lazyVisitIndexedArg=({arg:e,index:t})=>this.lazyVisitFormulaNode(e).bind((e=>(0,s.indexedArg)(e,t)))}}t.PledgeReducer=P,t.reduceBottomUp_Pledge=function(e,t){return D(new P(e),t)};function M(e,t,r){return r<=50?A(e,t):_(e,t)}function D(e,t){return i.Pledge.settleOrThrow(i.Pledge.resolve(u(e,t)))}t.reduceBottomUp_MaxDepth=M,t.reduceBottomUp=function(e,t){return M(e,t.node,t.depthUpperBound)},t.reduceTopDown_Pledge=D,t.reducePledge=function(e,t){return D(e,t.node)}},12384:function(e,t,r){"use strict";const n=r(91092);e.exports=n.anonymizer},25969:function(e,t,r){"use strict";const n=r(91092);e.exports=n.assertions},27511:function(e,t,r){"use strict";const n=r(91092);e.exports=n.codePoint},14587:function(e,t,r){"use strict";const n=r(91092);e.exports=n.core},1585:function(e,t,r){"use strict";const n=r(91092);e.exports=n.result},19684:function(e,t,r){"use strict";const n=r(91092);e.exports=n.pledge},27509:function(e,t,r){"use strict";const n=r(91092);e.exports=n.unicode},60888:function(e,t,r){"use strict";const n=r(91092);e.exports=n.util},65556:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldInstallFormat=t.parseEdit=void 0;const n=r(60888),a=r(73414),i=r(31828),o=r(78894),s=r(78781),u=r(1585);function l(e){const t=(0,n.stringStartsWith)(e,"'"),r=t?e.substring(1):e;return r.length>a.cellStringLimit?(0,u.failure)((0,i.notValueString)("cell text too long")):(0,u.success)((0,i.stringEdit)((0,a.stringOper)(r),t))}function c(e,t,r){return(0,s.parseDateInternal)((0,s.initParseDateGlobals)(e),t,r,i.GetTimeKind.ValueCell)}function d(e,t,r){const{localeInfo:n,mathpack:a}=e.config,s=n.isEastAsia&&r.valueType===i.FormatValueType.Percentage&&!0;let u=!1;switch(r.valueType){case i.FormatValueType.Number:case i.FormatValueType.Currency:case i.FormatValueType.Percentage:case i.FormatValueType.Fraction:case i.FormatValueType.Scientific:case i.FormatValueType.Accounting:u=!0}return(0,o.parseConstInternal)(n,a,t,s,!0,u)}t.parseEdit=function(e,t,r){try{if(r.valueType===i.FormatValueType.Text)return l(t);if(""===t)return(0,u.success)((0,i.otherEdit)(a.blankOper));if(t.length>1&&(0,n.stringStartsWith)(t,"="))return(0,u.success)((0,i.formulaEdit)(t));if(!(0,n.stringStartsWith)(t,"'")){const n=function(e,t,r){const n=function(e,t){if(0===e.stringCompareCI(t,e.trueName))return a.trueOper;if(0===e.stringCompareCI(t,e.falseName))return a.falseOper;for(let r=1;r<e.errorNames.length;r+=1){const n=e.errorNames[r];if(null!=n&&0===e.stringCompareCI(n,t))return(0,a.errorOper)(r)}}(e.config.localeInfo,t);if(void 0!==n)return(0,u.success)((0,i.otherEdit)(n));const o=r.valueType===i.FormatValueType.Date||r.valueType===i.FormatValueType.Time?[c,d]:[d,c];for(const n of o){const a=n(e,t,r);if(!(0,u.isSuccess)(a))return a;if(void 0!==a.value){const{value:e,format:t}=a.value;return(0,u.success)((0,i.numberEdit)(e,t))}}return(0,u.success)(void 0)}(e,t,r);if(!(0,u.isSuccess)(n))return n;if(void 0!==n.value)return(0,u.success)(n.value)}return t.length>1&&function(e){const t=e.charAt(0);return"="===t||"+"===t||"-"===t||"@"===t}(t)?(0,u.success)((0,i.formulaEdit)(t)):l(t)}catch(e){return(0,u.failure)((0,u.javaScriptError)(e))}},t.shouldInstallFormat=function(e,t){return e!==t&&t.source===i.NumberFormatSource.Builtin&&(t.valueType===i.FormatValueType.General||function(e,t){return e?.valueType!==i.FormatValueType.Number&&t.valueType!==i.FormatValueType.Number&&e?.valueType!==t.valueType}(e,t))}},12914:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.evalFormat=t.evalFormatImpl=void 0;const n=r(25969),a=r(27007),i=r(55929),o=r(31828),s=r(91615),u=r(45432),l=r(75433),c=r(70454),d=r(14587),g=r(34284),m=r(1585),h=r(37081),p=r(19684),f=(0,d.typedInstanceCreator)()(((e,t,r,n)=>({strong:e,format:t,valueType:r,decimals:n}))),S={},v=(0,a.createFailureErrorClass)("InferenceError"),F={getDocumentLoc:()=>(0,n.assertFalse)("calc.numfmt.evalFormula: default getDocumentLoc"),getSheetIndex:()=>(0,n.assertFalse)("calc.numfmt.evalFormula: default getSheetIndex"),getSheetName:()=>(0,n.assertFalse)("calc.numfmt.evalFormula: default getSheetName"),getNameLoc:()=>(0,n.assertFalse)("calc.numfmt.evalFormula: default getNameLoc"),getUserDefinedFuncLoc:()=>(0,n.assertFalse)("calc.numfmt.evalFormula: default getUserDefinedFuncLoc"),getSheetRangeIndexes:()=>(0,n.assertFalse)("calc.numfmt.evalFormula: default getSheetRangeIndexes"),getCellFormat:()=>(0,n.assertFalse)("calc.numfmt.evalFormula: default getCellFormat"),getKnownFormat:()=>(0,n.assertFalse)("calc.numfmt.evalFormula: default getKnownFormat"),getIformat:()=>(0,n.assertFalse)("calc.numfmt.evalFormula: default getIformat"),getFormatString:()=>(0,n.assertFalse)("calc.numfmt.evalFormula: default getFormatString"),getContainingTable:()=>(0,n.assertFalse)("calc.numfmt.evalFormula: default getContainingTable"),getStructRefColumn:()=>(0,n.assertFalse)("calc.numfmt.evalFormula: default getStructRefColumn"),getStructRefSpecialRef:()=>(0,n.assertFalse)("calc.numfmt.evalFormula: default getStructRefSpecialRef")};function y(e,t){const r=function(e){return{config:e.config,getDocumentLoc:e.getDocumentLoc?.bind(e)??F.getDocumentLoc,getSheetIndex:e.getSheetIndex?.bind(e)??F.getSheetIndex,getSheetName:e.getSheetName?.bind(e)??F.getSheetName,getNameLoc:e.getNameLoc?.bind(e)??F.getNameLoc,getUserDefinedFuncLoc:e.getUserDefinedFuncLoc?.bind(e)??F.getUserDefinedFuncLoc,getSheetRangeIndexes:e.getSheetRangeIndexes?.bind(e)??F.getSheetRangeIndexes,getCellFormat:e.getCellFormat?.bind(e)??F.getCellFormat,getKnownFormat:e.getKnownFormat?.bind(e)??F.getKnownFormat,getIformat:e.getIformat?.bind(e)??F.getIformat,getFormatString:e.getFormatString?.bind(e)??F.getFormatString,getContainingTable:e.getContainingTable?.bind(e)??F.getContainingTable,getStructRefColumn:e.getStructRefColumn?.bind(e)??F.getStructRefColumn,getStructRefSpecialRef:e.getStructRefSpecialRef?.bind(e)??F.getStructRefSpecialRef}}(e);return{globals:r,locals:t,config:e.config,localeInfo:t.config?.localeInfo??e.config.localeInfo,mathpack:e.config.mathpack,get document(){const e=t.originSheet;if(!(0,m.isSuccess)(e))throw new v(e);return e.value.document},get defaultFormat(){const e=k(this,g.KnownFormat.General);return f(!1,e,e.valueType,e.decimals)},get unitlessFormat(){const e=k(this,g.KnownFormat.General);return f(!0,e,e.valueType,e.decimals)},resolver:(0,u.createResolver)(r),multOrDivTainted:!1}}const C={[o.FormatValueType.General]:0,[o.FormatValueType.Number]:1,[o.FormatValueType.Currency]:2,[o.FormatValueType.Accounting]:2,[o.FormatValueType.Percentage]:3,[o.FormatValueType.Date]:4,[o.FormatValueType.Time]:5,[o.FormatValueType.Fraction]:6,[o.FormatValueType.Scientific]:7,[o.FormatValueType.Text]:8,[o.FormatValueType.Custom]:9};var A;!function(e){e[e.Propagate=-2147483648]="Propagate",e[e.Ignore=-2147483647]="Ignore"}(A||(A={}));const E={[l.WorksheetFuncId.INT]:A.Propagate,[l.WorksheetFuncId.MOD]:A.Propagate,[l.WorksheetFuncId.ROUND]:A.Propagate,[l.WorksheetFuncId.SUM]:A.Propagate,[l.WorksheetFuncId.TRUNC]:A.Propagate,[l.WorksheetFuncId.AVERAGE]:A.Propagate,[l.WorksheetFuncId.MAX]:A.Propagate,[l.WorksheetFuncId.MEDIAN]:A.Propagate,[l.WorksheetFuncId.MIN]:A.Propagate,[l.WorksheetFuncId.ROUNDUP]:A.Propagate,[l.WorksheetFuncId.ROUNDDOWN]:A.Propagate,[l.WorksheetFuncId.NPV]:g.KnownFormat.CoCurrencyDec,[l.WorksheetFuncId.PV]:g.KnownFormat.CoCurrencyDec,[l.WorksheetFuncId.FV]:g.KnownFormat.CoCurrencyDec,[l.WorksheetFuncId.PMT]:g.KnownFormat.CoCurrencyDec,[l.WorksheetFuncId.RATE]:g.KnownFormat.Pct0,[l.WorksheetFuncId.MIRR]:g.KnownFormat.Pct0,[l.WorksheetFuncId.IRR]:g.KnownFormat.Pct0,[l.WorksheetFuncId.DATE]:g.KnownFormat.MMDDYY,[l.WorksheetFuncId.TIME]:g.KnownFormat.HHMMAP,[l.WorksheetFuncId.NOW]:g.KnownFormat.MDYHMS,[l.WorksheetFuncId.SLN]:g.KnownFormat.CoCurrencyDec,[l.WorksheetFuncId.SYD]:g.KnownFormat.CoCurrencyDec,[l.WorksheetFuncId.DDB]:g.KnownFormat.CoCurrencyDec,[l.WorksheetFuncId.IPMT]:g.KnownFormat.CoCurrencyDec,[l.WorksheetFuncId.PPMT]:g.KnownFormat.CoCurrencyDec,[l.WorksheetFuncId.TODAY]:g.KnownFormat.MMDDYY,[l.WorksheetFuncId.VDB]:g.KnownFormat.CoCurrencyDec,[l.WorksheetFuncId.DB]:g.KnownFormat.CoCurrencyDec},b=[[o.FormatValueType.General,o.FormatValueType.Number,o.FormatValueType.Currency,o.FormatValueType.Percentage,o.FormatValueType.Date,o.FormatValueType.Time,o.FormatValueType.Fraction,o.FormatValueType.Scientific,o.FormatValueType.Text,o.FormatValueType.Custom],[o.FormatValueType.General,o.FormatValueType.Number,o.FormatValueType.Currency,o.FormatValueType.Percentage,o.FormatValueType.Date,o.FormatValueType.Time,o.FormatValueType.Number,o.FormatValueType.Scientific,o.FormatValueType.Text,o.FormatValueType.Custom],[o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.Currency,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.Currency,o.FormatValueType.Currency,o.FormatValueType.Text,o.FormatValueType.Custom],[o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.Percentage,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.Percentage,o.FormatValueType.Percentage,o.FormatValueType.Text,o.FormatValueType.Custom],[o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.Date,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.Text,o.FormatValueType.Custom],[o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.Time,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.Text,o.FormatValueType.Custom],[o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.Fraction,o.FormatValueType.Scientific,o.FormatValueType.Text,o.FormatValueType.Custom],[o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.Scientific,o.FormatValueType.Text,o.FormatValueType.Custom],[o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.Text,o.FormatValueType.Custom],[o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.Custom]],R=[[o.FormatValueType.General,o.FormatValueType.Number,o.FormatValueType.Currency,o.FormatValueType.General,o.FormatValueType.Date,o.FormatValueType.Time,o.FormatValueType.Fraction,o.FormatValueType.Scientific,o.FormatValueType.Text,o.FormatValueType.Custom],[o.FormatValueType.General,o.FormatValueType.Number,o.FormatValueType.Currency,o.FormatValueType.Number,o.FormatValueType.Date,o.FormatValueType.Time,o.FormatValueType.Fraction,o.FormatValueType.Scientific,o.FormatValueType.Text,o.FormatValueType.Custom],[o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.Currency,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.Currency,o.FormatValueType.Currency,o.FormatValueType.Text,o.FormatValueType.Custom],[o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.Percentage,o.FormatValueType.Date,o.FormatValueType.Time,o.FormatValueType.Percentage,o.FormatValueType.Scientific,o.FormatValueType.Text,o.FormatValueType.Custom],[o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.Date,o.FormatValueType.Date,o.FormatValueType.Text,o.FormatValueType.Custom],[o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.Time,o.FormatValueType.Time,o.FormatValueType.Text,o.FormatValueType.Custom],[o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.Fraction,o.FormatValueType.Scientific,o.FormatValueType.Text,o.FormatValueType.Custom],[o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.Scientific,o.FormatValueType.Text,o.FormatValueType.Custom],[o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.Text,o.FormatValueType.Custom],[o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.General,o.FormatValueType.Custom]];function T(e,t){if("number"!=typeof t)return t;const r=e.globals.getIformat(e.document,t);if(!(0,m.isSuccess)(r))throw new v(r.reason);return r.value}function k(e,t){const r=e.globals.getKnownFormat(e.document,t);if(!(0,m.isSuccess)(r))throw new v(r.reason);return r.value}function N(e,t){if("number"==typeof t)return t;const r=e.globals.getFormatString(e.document,t.formatString);if(!(0,m.isSuccess)(r))throw new v(r.reason);return void 0!==r.value?r.value:t}function I(e,t,r){(0,n.assertTrue)("calc.numfmt.evalFormula: well-formed bin op",2===t.length);const[a,i]=t;return r(e,a,i)}function O(e,t,[r],[n]){const a=C[r.valueType],i=C[n.valueType],o=a<=i?t[a][i]:t[i][a],s=C[o],u=n.decimals>r.decimals?n.decimals:r.decimals;switch(s){case a:return f(!0,r.format,r.valueType,u);case i:return f(!0,n.format,n.valueType,u);default:return e.unitlessFormat}}function _(e,t,r){return O(e,R,t,r)}function P(e,t,r){const[n]=t,[a]=r;if(n.format===a.format&&n.valueType===a.valueType&&n.valueType===o.FormatValueType.Time)return f(!0,n.format,n.valueType,n.decimals);if(n.valueType===o.FormatValueType.Date&&a.valueType===o.FormatValueType.Time||n.valueType===o.FormatValueType.Time&&a.valueType===o.FormatValueType.Date){const t=k(e,g.KnownFormat.MDYHMS),{valueType:r,decimals:n}=t;return f(!0,t,r,n)}return O(e,b,t,r)}const M=e=>e.unitlessFormat;function D(e,[t],[r]){return t.format===r.format?f(!0,t.format,t.valueType,t.decimals):e.unitlessFormat}function w(e){return C[e]===C[o.FormatValueType.General]}class L{literalNode(e){switch(e.kind){case c.OperKind.String:case c.OperKind.Boolean:case c.OperKind.Error:case c.OperKind.Missing:return p.Pledge.resolve(this.context.defaultFormat);case c.OperKind.Number:const t=21,r=this.context.mathpack.formatGeneral(this.context.localeInfo,this.context.mathpack.abs(e),t),a=r.indexOf(this.context.localeInfo.decimalSeparator),i=a>=0?r.length-a-1:0,o=k(this.context,g.KnownFormat.General);return p.Pledge.resolve(f(!1,o,o.valueType,i));default:return(0,n.assertNever)("calc.numfmt.evalFormat: unexpected literal oper",e)}}arrayNode(e){return p.Pledge.resolve(this.context.defaultFormat)}appNode(e,t){if((0,a.isOperatorNode)(e))return p.Pledge.all(t.map((e=>this.lazyVisitFormulaNode(e).bind((t=>[t,e]))))).bind((t=>function(e,t,r){switch(t){case l.OperatorId.Mul:case l.OperatorId.Div:return e.multOrDivTainted=!0,I(e,r,_);case l.OperatorId.Pow:return I(e,r,_);case l.OperatorId.Add:case l.OperatorId.Sub:return I(e,r,P);case l.OperatorId.Percent:{(0,n.assertTrue)("calc.numfmt.evalFormat: well-formed unary op",1===r.length);const[t,i]=r[0];if(!(0,a.isNumberLiteralNode)(i))return e.defaultFormat;const{strong:o,decimals:s}=t,u=k(e,g.KnownFormat.Pct);return f(o,u,u.valueType,s)}case l.OperatorId.Pound:case l.OperatorId.At:return e.defaultFormat;case l.OperatorId.Neg:case l.OperatorId.Pos:{(0,n.assertTrue)("calc.numfmt.evalFormat: well-formed unary op",1===r.length);const[e]=r[0];return e}case l.OperatorId.Lt:case l.OperatorId.Le:case l.OperatorId.Eq:case l.OperatorId.Ge:case l.OperatorId.Gt:case l.OperatorId.Ne:return I(e,r,M);case l.OperatorId.Isect:case l.OperatorId.Union:case l.OperatorId.Range:case l.OperatorId.Concat:return I(e,r,D);case l.OperatorId.And:case l.OperatorId.Or:case l.OperatorId.Xor:case l.OperatorId.Min:case l.OperatorId.Max:throw new v((0,a.notImplemented)(["evalFormat for Yellow ops"]));default:return(0,n.assertNever)("calc.numfmt.evalFormat: unexpected operator id",t)}}(this.context,e.id,t)));if((0,a.isWSFNode)(e)){const r=e.id,i=E[r]??A.Ignore,o=(0,l.getWorksheetFuncType)(r),s=(0,a.getArguments)(t);if((0,n.assertTrue)("calc.numfmt.evalFormula: well-formed WSF args",(0,a.isValidArgsLength)(o,s.length)),i===A.Ignore)return p.Pledge.resolve(this.context.defaultFormat);if(i===A.Propagate)return 0===s.length?p.Pledge.resolve(this.context.defaultFormat):p.Pledge.all(t.map(this.lazyVisitFormulaNode)).bind((e=>{const t=e[0];let r=t.format,n=t.valueType,a=t.decimals;const i=!w(n);if(!t.strong&&i)return this.context.unitlessFormat;let o=i;for(let t=1;t<e.length;t+=1){const i=e[t],s=!w(i.valueType);if(!i.strong&&s)return this.context.unitlessFormat;o||(r=i.format,n=i.valueType,a=i.decimals,o=s)}return f(!0,r,n,a)}));const u=k(this.context,i),{valueType:c,decimals:d}=u;return p.Pledge.resolve(f(!0,u,c,d))}return this.lazyVisitFormulaNode(e)}letNode(e,t,r,n){return p.Pledge.resolve(this.context.defaultFormat)}lambdaNode(e,t,r,n){return p.Pledge.resolve(this.context.defaultFormat)}parenNode(e){return this.lazyVisitFormulaNode(e)}nameNode(e,t){return p.Pledge.resolve(this.context.defaultFormat)}cellRefNode(e,t){const{resolution:r}=this.context.resolver.resolveCellRef(this.context.locals,(0,i.cellRefNode)(e,t));if(!(0,m.isSuccess)(r))throw(0,n.assertTrue)("calc.numfmt.evalFormat: NoOriginSheet",r.reason.kind!==s.ResolveReasonKind.NoOriginSheet),new v(r.reason);const o=r.value;if(void 0===o)throw S;return(0,a.isSheetGridRange)(o)?p.Pledge.resolve(K(this.context,o)):p.Pledge.resolve(this.context.unitlessFormat)}fieldRefNode(e,t){return this.lazyVisitFormulaNode(e).bind((e=>this.context.defaultFormat))}structRefNode(e,t){const r=(0,i.structRefNode)(e,t),{resolution:a}=this.context.resolver.resolveStructRef(this.context.locals,r);if(!(0,m.isSuccess)(a)){if((0,n.assertTrue)("calc.numfmt.evalFormat: NoOriginSheet",a.reason.kind!==s.ResolveReasonKind.NoOriginSheet),a.reason.kind===s.ResolveReasonKind.EmptyIntersection)throw S;throw new v(a.reason)}const o=a.value;if(void 0===o)throw S;return p.Pledge.resolve(K(this.context,o))}missingNode(e){return(0,n.assertFalse)("calc.numfmt.evalFormat: unexpected missing node")}badSequenceNode(e,t){return(0,n.assertFalse)("calc.numfmt.evalFormat: unexpected bad node")}badCharsNode(e,t){return(0,n.assertFalse)("calc.numfmt.evalFormat: unexpected bad node")}operatorNode(e,t){return p.Pledge.resolve((0,i.operatorNode)(e,t))}wsfNode(e,t,r){return p.Pledge.resolve((0,i.wsfNode)(e,t,r))}constructor(e){this.context=e,this.visitFormulaNode=e=>(0,h.visitFormulaNode)(this,e),this.lazyVisitFormulaNode=e=>p.Pledge.resolve(e).bind(this.visitFormulaNode)}}function x(e,t){return(0,h.reducePledge)(new L(e),t)}function K(e,t){const r=(0,a.sheetGridRangeAnchor)(t),n=e.globals.getCellFormat(r);if(!(0,m.isSuccess)(n))throw new v(n.reason);const i=n.value,s=T(e,i);if(!(0,a.isDocumentLocEqual)(r.sheet.document,e.document)&&("number"!=typeof i||s.source!==o.NumberFormatSource.Builtin))return e.defaultFormat;const{valueType:u,decimals:l}=s;return f(!0,i,u,l)}t.evalFormatImpl=function(e,t,r){try{const n=y(e,t),a=x(n,r);return(0,m.success)({...a,format:N(n,a.format),mulOrDivTainted:n.multOrDivTainted})}catch(e){return e instanceof v?(0,m.failure)(e.reason):e===S?m.successUndefined:(0,m.failure)((0,m.javaScriptError)(e))}},t.evalFormat=function(e,t,r){try{const n=y(e,t),a=x(n,r);return(0,m.success)(function(e,{strong:t,format:r,valueType:n,decimals:a}){if(n!==o.FormatValueType.Number||!e.multOrDivTainted){if(a>0&&t&&(n===o.FormatValueType.Number||n===o.FormatValueType.Currency||n===o.FormatValueType.Accounting||n===o.FormatValueType.Percentage)){const t=T(e,r);a!==t.decimals&&(r=t.synthesizeDecimals(a))}if(n!==o.FormatValueType.General&&t)return N(e,r)}}(n,a))}catch(e){return e instanceof v?(0,m.failure)(e.reason):e===S?m.successUndefined:(0,m.failure)((0,m.javaScriptError)(e))}}},74556:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createNumberFormatter=void 0;const n=r(31828),a=r(41990),i=r(65556),o=r(99188),s=r(12914),u=r(555),l=r(44945);t.createNumberFormatter=function(e){return{createFormat:(t,r)=>(0,a.createFormat)(e,t,"boolean"!=typeof r?r:r?n.NumberFormatSource.Builtin:n.NumberFormatSource.CustomString),applyFormat:(t,r,n)=>(0,a.applyFormat)(e,t,r,n),changeFormatDecimals:a.changeFormatDecimals,renderValue:(t,r)=>(0,o.renderValue)(e.config.mathpack,t,r),renderHashesValue:(e,t)=>(0,o.renderHashesValue)(e,t),renderFormulaBar(t,r,n,a){return(0,u.renderFormulaBar)(this,e,t,r,n,a)},parseGeneral:(t,r,n,a)=>(0,l.parseGeneral)(e,t,r,n,a),parseDate:(t,r)=>(0,l.parseDate)(e,t,r),parseEdit:(t,r)=>(0,i.parseEdit)(e,t,r),evalFormat:(t,r)=>(0,s.evalFormat)(e,t,r)}}},555:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderFormulaBar=void 0;const n=r(31828),a=r(27007),i=r(44442),o=r(25969),s=r(16700),u=r(34284),l=r(70454),c=r(1585);t.renderFormulaBar=function(e,t,r,d,g,m){try{const{localeInfo:h}=t.config;switch(d.kind){case l.OperKind.Number:return function(e,t,r,l,d){if(d.isDate||d.isTime){const g=function(e,t,r,l,d){const{mathpack:g,localeInfo:m}=t.config;if(g.cond(l)<0)return(0,c.success)(void 0);let h="";const p=0!==g.fix(l)||d.isDate;let f=l;if(p){const u=g.trunc(l),d=(0,s.getFormatString)(e,t,r,(0,i.buildMMDDYYFormat)(m,!0),n.NumberFormatSource.CustomString);if(!(0,c.isSuccess)(d))return d;const p=(0,s.renderFormat)(e,d.value,u);if(!(0,c.isSuccess)(p))return p;if("string"!=typeof p.value)return(0,c.success)(void 0);h+=p.value;const S=g.sub(l,u);(0,o.assertTrue)("calc.numfmt.renderFormulaBar: sub error",!(0,a.isErrorOper)(S)),f=S}if(g.cond(f)>0||d.isTime){p&&(h+="  ");const n=t.getKnownFormat(r,m.clock24Hour?u.KnownFormat.HHMMSS:u.KnownFormat.HHMMSSAP);if(!(0,c.isSuccess)(n))return n;const a=(0,s.renderFormat)(e,n.value,f);if(!(0,c.isSuccess)(a))return a;if("string"!=typeof a.value)return(0,c.success)(void 0);h+=a.value}return(0,c.success)(h)}(e,(0,s.initUtilGlobals)(t),r,l,d);if(!(0,c.isSuccess)(g))return g;if(void 0!==g.value)return g.value,g}const{mathpack:g,localeInfo:m}=t.config;if(d.isPercent){const e=g.mul(l,g.fromNumber(100));return(0,a.isErrorOper)(e)?(0,c.failure)((0,a.notImplemented)(["renderFormulaBar % overflow"])):(0,c.success)(g.formatGeneral(m,e,21)+"%")}return(0,c.success)(g.formatGeneral(m,l,21))}(e,t,r,d,g);case l.OperKind.String:return(0,c.success)(m?"'"+d.value:d.value);case l.OperKind.Boolean:return(0,c.success)(d.value?h.trueName:h.falseName);case l.OperKind.Error:const p=h.errorNames[d.type];return null==p?(0,c.failure)((0,a.internal)(`No locale data for error type ${d.type}`)):(0,c.success)(p);case l.OperKind.Array:return(0,c.failure)((0,a.notImplemented)(["Array renderFormulaBar"]));case l.OperKind.Rich:return(0,c.failure)((0,a.notImplemented)(["Rich renderFormulaBar"]));case l.OperKind.Blank:return(0,c.success)("");default:return(0,o.assertNever)("calc.numfmt.renderFormulaBar: never value",d)}}catch(e){return(0,c.failure)((0,c.javaScriptError)(e))}}},41990:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.changeFormatDecimals=t.applyFormat=t.createFormat=t.NumberFormatImpl=t.pictureCalendar=t.pictureNumberShape=void 0;const n=r(74643),a=r(74837),i=r(25969),o=r(27007),s=r(31828),u=r(27509),l=r(73414),c=r(75433),d=r(77409),g=r(60888),m=r(1824),h=r(14587),p=r(27007),f=r(17585),S=n.__importStar(r(27511)),v=r(34284),F=r(18642),y=r(99188),C=r(70454),A=r(1585),E=r(12384),b=r(83542),{codePointMinusSign:R,codePointPlusSign:T,codePointDigitZero:k,codePointHash:N,codePointFullStop:I,codePointDigitOne:O,codePointDigitTwo:_,codePointLeftParen:P,codePointRightParen:M,codePointSmallT:D,codePointBackslash:w}=S;var L;!function(e){e[e.WantPic=0]="WantPic",e[e.WantClose=1]="WantClose",e[e.Done=2]="Done"}(L||(L={}));const x={decimalSeparator:"NOTUSED"};function K(e,t,r,n){const{mantissa:a,exponent:o}=e.formatFixed(t,0,0);return(0,i.assertTrue)("calc.numfmt.dtrInteger: mantissa len <= exponent",a.length<=o),(0,i.assertTrue)("calc.numfmt.dtrInteger: mantissa || !exponent",0!==a.length||0===o),(0,f.convertDigitsShape)(o<r?(0,g.repeat)("0",r-o):"",n)+(0,f.convertNumberShape)(x,a+(0,g.repeat)("0",o-a.length),n)}function W(e,t,r,n,a){const{mantissa:o,exponent:s}=e.formatFixed(t,0,0);(0,i.assertTrue)("calc.numfmt.dtrFracSeconds: mantissa len <= exponent",o.length<=s),(0,i.assertTrue)("calc.numfmt.dtrFracSeconds: mantissa || !exponent",0!==o.length||0===s);const u=((s<r?(0,g.repeat)("0",r-s):"")+o+(0,g.repeat)("0",s-o.length)).substring(0,n);return(0,f.convertDigitsShape)(u,a)}function U(e,t){const{mantissa:r,exponent:n}=e.formatFixed(t,0,0);return(0,i.assertTrue)("calc.numfmt.formatInt: mantissa len <= exponent",r.length<=n),(0,i.assertTrue)("calc.numfmt.formatInt: mantissa || !exponent",0!==r.length||0===n),""===r?"0":r.length<n?r+(0,g.repeat)("0",n-r.length):r}function G(e){const t=[];for(let r=0;r<e.length;r+=1){const n=e[r];switch(n.kind){case s.FormattedUnitKind.Blank:case s.FormattedUnitKind.String:{let a=n.str;for(;r+1<e.length;){const t=e[r+1];if(t.kind!==n.kind)break;a+=t.str,r+=1}t.push({kind:n.kind,str:a});break}case s.FormattedUnitKind.Flexible:case s.FormattedUnitKind.General:t.push(n)}}return t}const B=e=>e.kind===s.FormattedUnitKind.Flexible,V={1:v.NumberShape.ChineseTrad1,2:v.NumberShape.ChineseTrad2,3:v.NumberShape.ChineseTrad3},j={1:v.NumberShape.ChineseSimp1,2:v.NumberShape.ChineseSimp2,3:v.NumberShape.ChineseSimp3},H={1:v.NumberShape.Japanese1,2:v.NumberShape.Japanese2,3:v.NumberShape.Japanese3},q={1:v.NumberShape.Korean1,2:v.NumberShape.Korean2,3:v.NumberShape.Korean3,4:v.NumberShape.Korean4};function $(e){return e+1}var z;!function(e){e[e.Ne=0]="Ne",e[e.Le=1]="Le",e[e.Ge=2]="Ge",e[e.Eq=3]="Eq",e[e.Lt=4]="Lt",e[e.Gt=5]="Gt"}(z||(z={}));const Q=(0,g.partialArray)({[z.Ne]:"<>",[z.Le]:"<=",[z.Ge]:">=",[z.Eq]:"=",[z.Lt]:"<",[z.Gt]:">"}),Y={[z.Ne]:c.OperatorId.Ne,[z.Le]:c.OperatorId.Le,[z.Ge]:c.OperatorId.Ge,[z.Eq]:c.OperatorId.Eq,[z.Lt]:c.OperatorId.Lt,[z.Gt]:c.OperatorId.Gt},J={[c.OperatorId.Ne]:z.Ne,[c.OperatorId.Le]:z.Le,[c.OperatorId.Ge]:z.Ge,[c.OperatorId.Eq]:z.Eq,[c.OperatorId.Lt]:z.Lt,[c.OperatorId.Gt]:z.Gt};var X;function Z(e,t,r,n){for(let a=0;a<t.length;a+=1){const i=t[a];if(null==i)continue;if(n+i.length>r.length)continue;const o=r.substring(n,n+i.length);if(0===e.stringCompareCI(i,o))return Number(a)}}function ee(e,t,r,n){for(let e=0;e<t.length;e+=1){const a=t[e];if(null!=a&&(0,g.stringStartsWith)(r,a,n))return Number(e)}return Z(e,t,r,n)}function te(e,t){return e[t]??""}function re(e,t,r,n){const a=r.substring(n,n+(0,u.numCodeUnits)((0,u.stringCodePointAt)(r,n)));for(let r=0;r<t.length;r+=1){const n=t[r];if(null==n)continue;if(0===n.length)continue;const i=n.substring(0,(0,u.numCodeUnits)((0,u.stringCodePointAt)(n,0)));if(0===e.stringCompareCI(a,i))return!0}return!1}function ne(e,t){let r=t.indexOf(te(e.pictureSingle,a.PictureSingle.APDelim));return r<0&&(r=t.length>>1),[t.substring(0,r),t.substring(r+1)]}!function(e){e[e.AMPM=100]="AMPM",e[e.AMPMFE=101]="AMPMFE",e[e.General=102]="General",e[e.Currency=103]="Currency",e[e.Color=200]="Color",e[e.Dbnum=201]="Dbnum",e[e.Cond=202]="Cond",e[e.CurrCode=203]="CurrCode",e[e.Char=300]="Char",e[e.StrLit=301]="StrLit",e[e.Numeral=302]="Numeral",e[e.PrefixDigTh=303]="PrefixDigTh",e[e.LatinDate=304]="LatinDate",e[e.BidiDate=305]="BidiDate",e[e.Exp=306]="Exp"}(X||(X={}));const ae=/^[0-9A-F]{1,8}$/i,ie=/^(?:([a-z]{2,}(?:-[A-Z0-9](?:[A-Z0-9]+|(?=,)|$)(?:_[A-Z0-9]+)?)*)(?:-x-([a-z]+))?|x-([a-z0-9]+))?(?:,([0-9A-F]{1,4}))?$/i;t.pictureNumberShape=(0,g.partialArray)({1:v.NumberShape.ASCII,2:v.NumberShape.ArabicIndic,3:v.NumberShape.ExtendedArabicIndic,4:v.NumberShape.Devanagari,5:v.NumberShape.Bengali,6:v.NumberShape.Gurmukhi,7:v.NumberShape.Gujarati,8:v.NumberShape.Oriya,9:v.NumberShape.Tamil,10:v.NumberShape.Telugu,11:v.NumberShape.Kannada,12:v.NumberShape.Malayalam,13:v.NumberShape.Thai,14:v.NumberShape.Lao,15:v.NumberShape.Tibetan,16:v.NumberShape.Myanmar,17:v.NumberShape.Ethiopic,18:v.NumberShape.Khmer,19:v.NumberShape.Mongolian,27:v.NumberShape.Japanese1,28:v.NumberShape.Japanese2,29:v.NumberShape.Japanese3,30:v.NumberShape.ChineseSimp1,31:v.NumberShape.ChineseSimp2,32:v.NumberShape.ChineseSimp3,33:v.NumberShape.ChineseTrad1,34:v.NumberShape.ChineseTrad2,35:v.NumberShape.ChineseTrad3,36:v.NumberShape.Korean1,37:v.NumberShape.Korean2,38:v.NumberShape.Korean3,39:v.NumberShape.Korean4}),t.pictureCalendar=(0,g.partialArray)({1:v.Calendar.Gregorian,2:v.Calendar.GregorianUS,3:v.Calendar.Japan,4:v.Calendar.Taiwan,5:v.Calendar.Korea,6:v.Calendar.Hijri,7:v.Calendar.Thai,8:v.Calendar.Hebrew,9:v.Calendar.GregorianMEFrench,10:v.Calendar.GregorianArabic,11:v.Calendar.GregorianXlitEnglish,12:v.Calendar.GregorianXlitFrench,22:v.Calendar.Persian,23:v.Calendar.UmAlQura});const oe=Object.keys(s.CultureTag).reduce(((e,t)=>{const r=s.CultureTag[t];return e[String(r)]=r,e}),Object.create(null));function se(e){return e.toString(16).toUpperCase()}function ue(e){return Number("0x"+e)}const le={culture:"en-US",tag:void 0},ce={culture:"fr-FR",tag:void 0},de={culture:"ar-IQ",tag:void 0},ge={culture:"ar-SA",tag:void 0},me={culture:"ar-DZ",tag:void 0},he={culture:"th-TH",tag:void 0},pe={[a.PictureSingle.Hour]:F.TimeDivision.Hour,[a.PictureSingle.HourTh]:F.TimeDivision.Hour,[a.PictureSingle.Minute]:F.TimeDivision.Minute,[a.PictureSingle.MinuteTh]:F.TimeDivision.Minute,[a.PictureSingle.Second]:F.TimeDivision.Second,[a.PictureSingle.SecondTh]:F.TimeDivision.Second};function fe(e){return e.kind===Se.Char?e.formattedStr:void 0}var Se;!function(e){e[e.Char=400]="Char",e[e.Fraction=401]="Fraction",e[e.Exp=402]="Exp",e[e.Num=403]="Num",e[e.FracSeconds=404]="FracSeconds",e[e.DateSep=405]="DateSep",e[e.TimeSep=406]="TimeSep",e[e.SysFormat=407]="SysFormat"}(Se||(Se={}));const ve={kind:X.General};function Fe(e){return 1===e.length&&e[0].kind===X.General}var ye,Ce,Ae;!function(e){e[e.Num=0]="Num",e[e.Date=1]="Date",e[e.Fraction=2]="Fraction",e[e.Percent=3]="Percent",e[e.Exp=4]="Exp",e[e.Text=5]="Text",e[e.General=6]="General",e[e.Other=7]="Other"}(ye||(ye={})),function(e){e[e.Pos=0]="Pos",e[e.Neg=1]="Neg",e[e.Zero=2]="Zero",e[e.Text=3]="Text"}(Ce||(Ce={})),function(e){e[e.Unknown=0]="Unknown",e[e.Either=1]="Either",e[e.Number=2]="Number",e[e.Text=3]="Text"}(Ae||(Ae={}));const Ee={code:[ve],color:void 0,dbnum:void 0,dtrRounding:F.Rounding.RoundSec};function be(e){return void 0===e.color&&void 0===e.dbnum&&Fe(e.code)}const Re={},Te=(0,o.createFailureErrorClass)("ApplyHashesError"),ke=(0,o.createFailureErrorClass)("ApplyError"),Ne=(0,o.createFailureErrorClass)("InitError");class Ie{get isPercent(){return this.hasPercent}get isDate(){return this.hasDate}get isTime(){return this.hasTime}get isTextOnly(){return!this.posBeforeText}get isInputDependent(){return this.isInputDependentFormat()}get culture(){return this.thisCurrCode}get currencySymbol(){return this.thisCurrencySymbol}apply(e,t,r,n){try{return(0,A.success)(this.applyImpl(e,t,r,n))}catch(e){return e instanceof ke?(0,A.failure)(e.reason):(0,A.failure)((0,A.javaScriptError)((0,g.prependErrorMessage)(e,`(while applying format ${this.logFormatString})`)))}}isInputDependentFormat(){for(const e of this.parts)for(const t of e.code)switch(t.kind){case X.General:case X.AMPM:case X.AMPMFE:case a.PictureSingle.Hash:case a.PictureSingle.Zero:case a.PictureSingle.Text:case a.PictureSingle.Year:case a.PictureSingle.YearTh:case a.PictureSingle.EngYearTh:case a.PictureSingle.ThYear:case a.PictureSingle.Month:case a.PictureSingle.MonthTh:case a.PictureSingle.Day:case a.PictureSingle.DayTh:case a.PictureSingle.LocDay:case a.PictureSingle.Hour:case a.PictureSingle.HourTh:case a.PictureSingle.Minute:case a.PictureSingle.MinuteTh:case a.PictureSingle.Second:case a.PictureSingle.SecondTh:case a.PictureSingle.Era:case a.PictureSingle.EraYear:case Se.Fraction:case Se.Exp:case Se.Num:case Se.SysFormat:case Se.FracSeconds:case a.PictureSingle.Question:return!0;case Se.DateSep:case Se.TimeSep:case Se.Char:case X.LatinDate:case a.PictureSingle.Decimal:case a.PictureSingle.Percent:case X.BidiDate:case X.Currency:case X.CurrCode:case X.StrLit:case X.Numeral:case X.PrefixDigTh:case X.Exp:case a.PictureSingle.Slash:case a.PictureSingle.Star:case a.PictureSingle.Underscore:}return!1}applyImpl(e,t,r,n){const{mathpack:u,localeInfo:l}=this.config;if(this.valueType===s.FormatValueType.General){const a=void 0;if((0,o.isStringOper)(e))return(0,s.formattedValue)([(0,s.formattedUnitString)(e.value)],a,t,r);if(!n&&0===u.cond(e))return(0,s.formattedValue)([],a,t,r);const i=(0,s.formattedUnitGeneral)(u.toNumber(e),l.decimalSeparator,!0,v.NumberShape.ASCII,v.NumberShape.ASCII,!0);return(0,s.formattedValue)([i],a,t,r)}let c=!1;for(;;){let l;try{let i,m=!1;const h=[];if((0,o.isStringOper)(e))i=Ce.Text;else{const t=u.cond(e);void 0!==this.condPos||void 0!==this.condNeg?({partKind:i,forceNeg:m}=this.getPart(e)):i=t<0?Ce.Neg:t>0?Ce.Pos:Ce.Zero,t<0&&(this.onlyOneNumberPart||m)&&h.push((0,s.formattedUnitString)("-"))}l=this.parts[i];const{color:p,dbnum:f,code:S,dtrRounding:v}=l;if(!n&&i===Ce.Zero&&l===this.parts[Ce.Pos]&&!c)return(0,s.formattedValue)([],p,t,r);const F=this.getNumShape(f);this.applyPart({dtrRounding:v,dbnum:f,forceNeg:m,units:h,numShape:F,bidiDate:void 0},S,e,void 0);const y=r|(i!==Ce.Text||be(l)||(g=void 0,void 0===(d=l).color&&void 0===d.dbnum&&1===(g=d.code).length&&g[0].kind===a.PictureSingle.Text)?s.Clip.None:s.Clip.MaxChars),C=h.some(B)?s.Alignment.Left:t;return(0,s.formattedValue)(G(h),p,C,y)}catch(t){if(t===Re){(0,i.assertTrue)("calc.numfmt.NumberFormatImpl: applyImpl restart",!(0,o.isStringOper)(e)&&0!==u.cond(e)),e=u.zero,c=!0;continue}if(t instanceof Te)return(0,s.hashesValue)(t.reason,l?.color);throw t}}var d,g}applyPart(e,t,r,n){const{mathpack:l,datepack:c,localeInfo:d}=this.config,p=this.applyCurrCode?.calendar??v.Calendar.Gregorian;let S;const F=()=>{if(void 0!==S)return S;(0,i.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart getDtr value",!(0,o.isStringOper)(r));const{date1904:t,dateCompatibility:n}=this.config;if(!n&&l.cond(r)<0)throw new Te(s.dateOverflow);if(n&&l.cond(r)<0){if(t)throw new ke((0,o.notImplemented)(["negative date 1904"]));throw new Te(s.dateOverflow)}const a=c.fromNum(this.config,l.abs(r),e.dtrRounding);if(!1===a)throw new Te(s.dateOverflow);switch(p){case v.Calendar.Gregorian:case v.Calendar.GregorianUS:case v.Calendar.GregorianMEFrench:case v.Calendar.GregorianArabic:case v.Calendar.GregorianXlitEnglish:case v.Calendar.GregorianXlitFrench:break;case v.Calendar.Thai:a.yr+=543;break;default:throw new ke((0,o.notImplemented)(["calendar: "+p]))}return(0,i.assertTrue)("calc.numfmt.NumberFormatImpl: components within range",a.yr>=0&&a.mon>=1&&a.mon<=12&&a.dom>=0&&a.dom<=31&&a.hour>=0&&a.hour<=23&&a.min>=0&&a.min<=59&&a.sec>=0&&a.sec<=59&&a.fracSec>=0&&a.wdy>=1&&a.wdy<=7),S=a},C=()=>{if(void 0!==S)throw new ke((0,o.notImplemented)(["use of value after date component"]));return r};let A=!1,E=e.numShape;const b=e.units;for(let S=0;S<t.length;S+=1){const R=t[S];switch(R.kind){case X.General:{A=!0;const t=C();if((0,o.isStringOper)(t))b.push((0,s.formattedUnitString)(t.value));else{const r=l.abs(t);if(l.cond(t)<0&&"0"===l.formatGeneral(d,r,1))throw new ke((0,o.notImplemented)(["potential LRestart in interval (-0.5,0)"]));const n=(0,s.formattedUnitGeneral)(l.toNumber(r),d.decimalSeparator,!1,E,this.getNumShape(void 0),this.valueType===s.FormatValueType.General);if(void 0!==e.dbnum){const e=(0,y.renderGeneral)(l,n,255);(0,i.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart General renderRes",!1!==e),b.push((0,s.formattedUnitString)(e));break}b.push(n)}break}case a.PictureSingle.Text:{const e=C();(0,i.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Text value",(0,o.isStringOper)(e)),b.push((0,s.formattedUnitString)(e.value));break}case X.Exp:case a.PictureSingle.Slash:case Se.Char:b.push((0,s.formattedUnitString)(R.formattedStr));break;case a.PictureSingle.Star:b.push((0,s.formattedUnitFlexible)(R.escaped));break;case a.PictureSingle.Underscore:b.push((0,s.formattedUnitBlank)(R.escaped));break;case X.StrLit:b.push((0,s.formattedUnitString)(R.escaped));break;case a.PictureSingle.Percent:case X.Numeral:b.push((0,s.formattedUnitString)(R.formattedStr));break;case X.Currency:b.push((0,s.formattedUnitString)(d.currencySymbol));break;case X.CurrCode:{const{currencySymbol:e,currCode:t}=R;(0,i.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart system tag",!(0,s.isSystemCultureTag)(t?.tag)),void 0!==e&&b.push((0,s.formattedUnitString)(e));break}case Se.DateSep:b.push((0,s.formattedUnitString)(d.dateSeparator));break;case Se.TimeSep:R.printAsTimeSep?b.push((0,s.formattedUnitString)(d.timeSeparator)):b.push((0,s.formattedUnitString)(R.formattedStr));break;case Se.Num:{const t=C();(0,i.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Num value",!(0,o.isStringOper)(t)),(0,i.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Num numState",void 0===n);const{numDigLeft:r,numDigDec:a,numPercent:s,numThousands:u}=R,c=2*s-3*u,{mantissa:d,exponent:g}=l.formatFixed(t,c,a);if((0,i.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Num mantissa || !exponent",0!==d.length||0===g),(0,i.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Num mantissa len",d.length<=g+a),l.cond(t)<0&&(this.onlyOneNumberPart||e.forceNeg)&&0===d.length)throw Re;this.applyPart(e,R.codeBefore,l.zero,void 0),this.applyPart(e,R.code,l.zero,{comma:R.comma,fractionDenom:!1,decimal:!1,digits:d,digitsExp:g,numDigLeft:r});break}case Se.Exp:{const t=C();(0,i.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Exp value",!(0,o.isStringOper)(t)),(0,i.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Exp numState",void 0===n);const{numMantDigLeft:r,numMantDigDec:a}=R,u=0===r&&0===a,{mantissa:c,exponent:d}=l.formatScientific(t,r,a);(0,i.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Exp mantissa || !exponent",0!==c.length||0===d||u);const g=(0,m.formatScientificLeft)(d,r);(0,i.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Exp mantissa len",c.length<=g+a),this.applyPart(e,R.codeMant,l.zero,{comma:R.commaMant,fractionDenom:!1,decimal:!1,digits:c,digitsExp:g,numDigLeft:R.numMantDigLeft}),this.applyPart(e,R.codeBetween,l.zero,void 0);const h=""!==c||u?d-g:0;h<0?b.push((0,s.formattedUnitString)("-")):R.isNeg||b.push((0,s.formattedUnitString)("+"));const p=U(l,l.fromNumber(h));this.applyPart(e,R.codeExp,l.zero,{comma:R.commaMant,fractionDenom:!1,decimal:!1,digits:p,digitsExp:p.length,numDigLeft:R.numExpDigLeft});break}case Se.Fraction:{const t=C();(0,i.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Fraction value",!(0,o.isStringOper)(t)),(0,i.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Fraction numState",void 0===n);const{numPercent:r,numThousands:u,numIntDigLeft:c,numNumerDig:d,numDenomDig:g,commaInt:m,denomValue:h}=R,p=2*r-3*u,f=l.tenTo(p),S=(0,o.isErrorOper)(f)?f:l.mul(l.abs(t),f);if((0,o.isErrorOper)(S))throw new ke((0,o.notImplemented)(["overflow on fraction exp adjust"]));const v=e=>{for(let t=e;t<b.length;t+=1){const e=b[t];e.kind===s.FormattedUnitKind.String&&(b[t]=(0,s.formattedUnitBlank)(e.str))}};let F,y,A,E=R.anyZeroNumer;if(void 0!==R.codeInt){let t=l.trunc(S);const r=l.sub(S,t);if((0,i.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart fracPart sub",(0,o.isNumberOper)(r)),({numer:F,denom:y}=this.formFraction(r,h,g)),(0,i.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart numer <= denom",l.cond2(F,y)<=0),0===l.cond2(F,y)){F=l.zero;const e=l.add(t,l.one);(0,i.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart bumped error",(0,o.isNumberOper)(e)),t=e}0!==l.cond(F)&&(E=!0);const n=U(l,t),s={comma:m,fractionDenom:!1,decimal:!1,digits:n,digitsExp:n.length,numDigLeft:c},u=b.length;this.applyPart(e,R.codeInt,l.zero,s),A=b.length,(0,i.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Fraction lastDigInt",void 0!==R.lastDigInt),0===l.cond(t)&&E&&R.lastDigInt!==a.PictureSingle.Zero?(R.lastDigInt!==a.PictureSingle.Question&&(b.length=u),this.applyPart(e,R.codeBetween1,l.zero,void 0),v(u),R.firstDigNumer!==a.PictureSingle.Question&&(b.length=u)):this.applyPart(e,R.codeBetween1,l.zero,void 0)}else{if(({numer:F,denom:y}=this.formFraction(S,h,g)),l.cond(t)<0&&(this.onlyOneNumberPart||e.forceNeg)&&0===l.cond(F))throw Re;E=!0,A=b.length}const T=U(l,F),k={comma:!1,fractionDenom:!1,decimal:!1,digits:T,digitsExp:T.length,numDigLeft:d};this.applyPart(e,R.codeNumer,l.zero,k),this.applyPart(e,R.codeBetween2,l.zero,void 0);const N=U(l,y),I={comma:!1,fractionDenom:!0,decimal:k.decimal,digits:N,digitsExp:N.length,numDigLeft:g};this.applyPart(e,R.codeDenom,l.zero,I),E||(R.anyQuestionNumer||R.firstDigDenom===a.PictureSingle.Question?v(A):b.length=A);break}case a.PictureSingle.Decimal:(0,i.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Decimal numState",void 0!==n),n.digitsExp>0&&(n.numDigLeft=n.digitsExp,this.dumpDigLeft(e,n,n.digitsExp)),n.decimal=!0,b.push((0,s.formattedUnitString)(d.decimalSeparator));break;case a.PictureSingle.Hash:case a.PictureSingle.Zero:case a.PictureSingle.Question:{(0,i.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart H/Z/Q numState",void 0!==n);let r=R.count;if(n.decimal||n.fractionDenom&&R.kind===a.PictureSingle.Question){if(n.fractionDenom&&S!==t.length-1)throw new ke((0,o.notImplemented)(["left-align bug in denominator"]));if(n.digitsExp<0){const e=(0,h.fastMin)(r,-n.digitsExp),t=(0,f.convertDigitsShape)((0,g.repeat)("0",e),E);b.push((0,s.formattedUnitString)(t)),n.digitsExp+=e,r-=e}{const e=(0,h.fastMin)(r,n.digits.length),t=(0,f.convertDigitsShape)(n.digits.substring(0,e),E);b.push((0,s.formattedUnitString)(t)),n.digits=n.digits.substring(e),r-=e}if(R.kind!==a.PictureSingle.Hash&&r>0){const e=(0,f.convertDigitsShape)((0,g.repeat)("0",r),E);b.push(R.kind===a.PictureSingle.Question?(0,s.formattedUnitBlank)(e):(0,s.formattedUnitString)(e))}break}if(n.numDigLeft>n.digitsExp){const e=(0,h.fastMin)(r,n.numDigLeft-n.digitsExp);if(R.kind!==a.PictureSingle.Hash){let t=(0,f.convertDigitsShape)((0,g.repeat)("0",e),E);n.comma&&(t=(0,f.insertCommas)(d,t,n.numDigLeft-e)),b.push(R.kind===a.PictureSingle.Question?(0,s.formattedUnitBlank)(t):(0,s.formattedUnitString)(t))}r-=e,n.numDigLeft-=e}else r+=n.digitsExp-n.numDigLeft,n.numDigLeft=n.digitsExp;this.dumpDigLeft(e,n,r);break}case X.PrefixDigTh:d.isThai&&(E=e.numShape=v.NumberShape.Thai);break;case X.LatinDate:this.hasTokenCurrCode||(e.bidiDate=s.BidiDate.English);break;case X.BidiDate:throw new ke((0,o.notImplemented)(["TokenKind.BidiDate"]));case a.PictureSingle.HourTh:case a.PictureSingle.MinuteTh:case a.PictureSingle.SecondTh:case a.PictureSingle.Hour:case a.PictureSingle.Minute:case a.PictureSingle.Second:{const t=R.kind===a.PictureSingle.HourTh||R.kind===a.PictureSingle.MinuteTh||R.kind===a.PictureSingle.SecondTh,r=t&&!this.hasTokenCurrCode?v.NumberShape.Thai:E;if(R.isAbs){const n=C();if((0,i.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart H/M/S value",!(0,o.isStringOper)(n)),t&&this.hasTokenCurrCode)throw new ke((0,o.notImplemented)(["fcAbsHourTh && fIntlNum bug"]));const a=c.toTime(this.config,l.abs(n),pe[R.kind],e.dtrRounding);if(!1===a)throw new ke((0,o.notImplemented)(["absolute time overflow"]));b.push((0,s.formattedUnitString)(K(l,l.fromNumber(a),R.count,r)))}else{const e=F();let t;if(R.kind===a.PictureSingle.Minute||R.kind===a.PictureSingle.MinuteTh)t=e.min;else if(R.kind===a.PictureSingle.Second||R.kind===a.PictureSingle.SecondTh)t=e.sec;else if(t=e.hour,R.isAMPM){if(R.kind===a.PictureSingle.HourTh)throw new ke((0,o.notImplemented)(["fc12HourTh/fc12Hour2Th forgotten"]));t>12&&(t-=12),0===t&&(t=12)}b.push((0,s.formattedUnitString)(K(l,l.fromNumber(t),R.count,r)))}break}case X.AMPM:case X.AMPMFE:{let e;if(e=!!(0,o.isStringOper)(r)||F().hour<12,(!this.hasTokenCurrCode||R.kind===X.AMPMFE)&&(R.kind===X.AMPMFE||d.isEastAsia||R.pictureKind===a.PictureSpecial.AP2)){const t=ne(d,R.tokenStr);b.push((0,s.formattedUnitString)(t[e?0:1]));break}const t=this.getBundledLocaleInfo("localised AM/PM string",v.Calendar.Gregorian,this.applyCurrCode);b.push((0,s.formattedUnitString)(t.ampmSymbols[e?0:1]));break}case Se.FracSeconds:{const e=F();(0,i.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart FracSeconds rounding",e.rounding>=R.rounding);const t=W(l,l.fromNumber(e.fracSec),e.rounding,R.rounding,E);b.push((0,s.formattedUnitString)(d.decimalSeparator+t));break}case a.PictureSingle.Era:throw new ke((0,o.notImplemented)(["PictureSingle.Era"]));case a.PictureSingle.EraYear:throw new ke((0,o.notImplemented)(["PictureSingle.EraYear"]));case a.PictureSingle.YearTh:case a.PictureSingle.EngYearTh:case a.PictureSingle.ThYear:case a.PictureSingle.Year:{const e=R.kind!==a.PictureSingle.YearTh&&R.kind!==a.PictureSingle.ThYear||this.hasTokenCurrCode?E:v.NumberShape.Thai,t=(R.kind===a.PictureSingle.YearTh||R.kind===a.PictureSingle.EngYearTh)&&!this.hasTokenCurrCode,r=F().yr+(t?543:0),n=R.count>2?r:r%100;b.push((0,s.formattedUnitString)(K(l,l.fromNumber(n),R.count,e)));break}case a.PictureSingle.Month:case a.PictureSingle.MonthTh:{const t=F().mon;switch(R.count){case 1:case 2:{const e=R.kind!==a.PictureSingle.MonthTh||this.hasTokenCurrCode?E:v.NumberShape.Thai;b.push((0,s.formattedUnitString)(K(l,l.fromNumber(t),R.count,e)));break}case 3:case 4:case 5:{let r;if(r=e.bidiDate===s.BidiDate.English?(0,a.getEnglishLocaleInfo)():this.getBundledLocaleInfo("localised month string",p,R.kind!==a.PictureSingle.MonthTh||this.hasTokenCurrCode?this.applyCurrCode:he),3===R.count)b.push((0,s.formattedUnitString)(r.monthNameShort[t-1]));else if(4===R.count||e.bidiDate===s.BidiDate.English)b.push((0,s.formattedUnitString)(r.monthNameLong[t-1]));else{const e=r.monthNameLong[t-1];b.push((0,s.formattedUnitString)(e.substring(0,(0,u.numCodeUnits)((0,u.stringCodePointAt)(e,0)))))}break}}break}case a.PictureSingle.Day:case a.PictureSingle.DayTh:case a.PictureSingle.LocDay:{const t=R.kind===a.PictureSingle.DayTh;if(R.count<3){const e=t&&!this.hasTokenCurrCode?v.NumberShape.Thai:E,r=F().dom;b.push((0,s.formattedUnitString)(K(l,l.fromNumber(r),R.count,e)))}else{const r=F().wdy;let n;if(n=e.bidiDate===s.BidiDate.English||!this.hasTokenCurrCode&&d.isEastAsia&&R.kind===a.PictureSingle.Day?(0,a.getEnglishLocaleInfo)():this.getBundledLocaleInfo("localised day string",p,t&&!this.hasTokenCurrCode?he:this.applyCurrCode),t&&this.hasTokenCurrCode&&3===R.count)throw new ke((0,o.notImplemented)(["fcDay3Th && fIntlNum bug"]));const i=3===R.count?n.dayNameShort[r-1]:n.dayNameLong[r-1];b.push((0,s.formattedUnitString)(i))}break}case Se.SysFormat:(0,i.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart SysFormat numState",void 0===n),this.applyPart(e,R.codeSysFormat,r,n);break;default:return(0,i.assertNever)("calc.numfmt.NumberFormatImpl: applyPart code",R)}}A&&C()}dumpDigLeft(e,t,r){const{localeInfo:n}=this.config,{units:a,numShape:i}=e;let o=r;{const e=(0,h.fastMin)(o,t.digits.length);let r=(0,f.convertDigitsShape)(t.digits.substring(0,e),i);t.comma&&(r=(0,f.insertCommas)(n,r,t.numDigLeft-e)),a.push((0,s.formattedUnitString)(r)),t.digits=t.digits.substring(e),o-=e,t.digitsExp-=e,t.numDigLeft-=e}if(o>0){let e=(0,f.convertDigitsShape)((0,g.repeat)("0",o),i);t.comma&&(e=(0,f.insertCommas)(n,e,t.numDigLeft-o)),a.push((0,s.formattedUnitString)(e)),t.digitsExp-=o,t.numDigLeft-=o}}getPart(e){const{mathpack:t}=this.config;for(let r=Ce.Pos;r<Ce.Zero;r+=1){const n=r;let a;if(r===Ce.Pos){if(a=this.condPos,void 0===a&&t.cond(e)>0)return{partKind:n,forceNeg:!1}}else{if(this.parts[n]===this.parts[Ce.Pos])throw new Te(s.noFormatPart);if(0===this.parts[Ce.Pos].code.length)throw new ke((0,o.notImplemented)(['emulation of ";[COND]foo" bug']));if(a=this.condNeg,void 0===a){if(this.parts[Ce.Zero]===this.parts[Ce.Pos])return(0,i.assertTrue)("calc.numfmt.NumberFormatImpl: getPart condPos",void 0!==this.condPos),{partKind:n,forceNeg:t.cond(this.condPos.operand)>0||this.condPos.operator===c.OperatorId.Eq};if(t.cond(e)<0)return{partKind:n,forceNeg:!1}}}if(void 0===a)continue;const{operator:u,operand:l}=a,d=t.sub(e,l);if((0,o.isErrorOper)(d))throw new ke((0,o.notImplemented)(["overflow in condition check"]));if((0,p.applyComparison)(u,t.cond2(e,l)))switch(u){case c.OperatorId.Eq:return{partKind:n,forceNeg:!1};case c.OperatorId.Ne:case c.OperatorId.Gt:case c.OperatorId.Ge:return{partKind:n,forceNeg:!0};case c.OperatorId.Lt:return{partKind:n,forceNeg:t.cond(l)>0};case c.OperatorId.Le:return{partKind:n,forceNeg:t.cond(l)>=0}}}const r=Ce.Zero;if(this.parts[r]===this.parts[Ce.Pos])throw new Te(s.noFormatPart);return{partKind:r,forceNeg:!0}}getNumShape(e){const t=this.applyCurrCode;let r=t?.numberShape;if(void 0!==r)return r;if(void 0===e)return v.NumberShape.ASCII;const n=this.getBundledLocaleInfo("localised DBNUM culture",v.Calendar.Gregorian,t);return n.isEastAsia&&(n.isKorea?r=q[e]:n.isJapan?r=H[e]:n.isChinaT?r=V[e]:n.isChinaS&&(r=j[e])),r??v.NumberShape.ASCII}formFraction(e,t,r){const{mathpack:n}=this.config;if(void 0!==t){const r=n.fromNumber(137438953472);if((0,o.isErrorOper)(n.sub(e,r)))throw new ke((0,o.notImplemented)(["overflow in fraction threshold check"]));if(n.cond2(e,r)<0){const t=n.mul(e,n.fromNumber(1.0000000000000002));(0,i.assertTrue)("calc.numfmt.NumberFormatImpl: formFraction nudged error",(0,o.isNumberOper)(t)),e=t}const a=t,u=n.toNumber(a)<<1,l=n.mul(e,n.fromNumber(u));if(!(0,o.isNumberOper)(l))throw new ke((0,o.notImplemented)(["overflow in fraction denom mul"]));const c=n.lfix(l);if(c<0||c>=65535)throw new Te(s.fractionOverflow);return{numer:n.fromNumber(c+1>>1),denom:a}}let a;switch(r){case 1:a=10;break;case 2:a=100;break;case 3:a=1e3;break;case 4:a=1e4;break;case 5:a=1e5;break;case 6:a=1e6;break;default:a=1e7}let u=n.fix(e);if(u>=2147483647)throw new Te(s.fractionOverflow);let l=e,c=1,d=1,g=0,m=0;for(;;){const e=c*u;m+=e;const t=g*u;if(d+=t,e>2147483647||t>2147483647||d>=a){1===g&&2===u&&0===n.cond2(l,n.trunc(l))&&(c+=1);break}[c,m]=[m,c],[g,d]=[d,g];const r=n.sub(l,n.trunc(l));if((0,i.assertTrue)("calc.numfmt.NumberFormatImpl: formFraction frac sub",(0,o.isNumberOper)(r)),0===n.cond(r))break;const s=n.div(n.one,r);if((0,o.isErrorOper)(s))throw new ke((0,o.notImplemented)(["overflow in fraction inversion"]));if(l=s,(u=n.fix(l))>2147483647)break}return 0===g&&(g=c=1),{numer:n.fromNumber(c),denom:n.fromNumber(g)}}synthesizeDecimals(e){const t=(0,h.fastMax)(0,(0,h.fastMin)(e,127)),r=[];for(let e=Ce.Pos;e<=Ce.Text;e+=1){const n=this.parts[e];if((e===Ce.Neg||e===Ce.Zero)&&n===this.parts[Ce.Pos]){r.push(r[Ce.Pos]);continue}if(e===Ce.Text){r.push(n===this.parts[Ce.Pos]?r[Ce.Pos]:n);continue}const{code:a,color:i,dbnum:o,dtrRounding:s}=n,u={code:a.map((r=>{if(r.kind===Se.Num){const{numDigLeft:n,numPercent:a,numThousands:i,comma:o,codeBefore:s}=r;return{kind:Se.Num,numDigLeft:n,numDigDec:t,numPercent:a,numThousands:i,comma:o,code:this.adjustDecimals(e,r.numDigDec,r.code,t),codeBefore:s}}if(r.kind===Se.Exp){const{isNeg:n,numMantDigLeft:a,numExpDigLeft:i,commaMant:o,codeBetween:s,codeExp:u}=r;return{kind:Se.Exp,isNeg:n,numMantDigLeft:a,numMantDigDec:t,numExpDigLeft:i,commaMant:o,codeMant:this.adjustDecimals(e,r.numMantDigDec,r.codeMant,t),codeBetween:s,codeExp:u}}return r})),color:i,dbnum:o,dtrRounding:s};r.push(u)}try{const e=new Ie(this.config,{old:this,logFormatString:`synthesizeDecimals(dec=${t} on ${this.logFormatString})`,synth:r});if(e.formatString.length>255)throw new Ne(this.notFormatString("format string too long: max length"));return e}catch(e){if(e instanceof Ne)return this;throw e}}adjustDecimals(e,t,r,n){if(n===t)return r;let o,s,u,l=!1;for(let e=0;e<r.length;e+=1){const t=r[e];switch(t.kind){case a.PictureSingle.Decimal:void 0===u&&(u=e);break;case a.PictureSingle.Hash:case a.PictureSingle.Question:case a.PictureSingle.Zero:void 0!==u?s=e:(o=e,t.kind===a.PictureSingle.Question&&(l=!0))}}const c=e=>e===a.PictureSingle.Percent||e===X.Currency||e===X.CurrCode||e===a.PictureSingle.Star;if(0===n){if(void 0===u)return r;let e=0,t=0;void 0===o?void 0!==s&&(e=u+1,t=s+1):(e=u,t=(s??u)+1);const n=r.slice(0,e);for(let a=e;a<t;a+=1)c(r[a].kind)&&n.push(r[a]);return(0,h.safePush)(n,r.slice(t)),n}if(t>n){let e;(0,i.assertTrue)("calc.numfmt.NumberFormatImpl: adjustDecimals dec",void 0!==u),function(e){e[e.AfterDigs=0]="AfterDigs",e[e.Dropping=1]="Dropping",e[e.Keeping=2]="Keeping"}(e||(e={}));let o=e.AfterDigs;const s=[];let l=t-n;for(let t=r.length-1;t>=0;t-=1){t<=u&&(o=e.Keeping);const n=r[t];if(o===e.AfterDigs&&(n.kind!==a.PictureSingle.Hash&&n.kind!==a.PictureSingle.Question&&n.kind!==a.PictureSingle.Zero||(o=e.Dropping)),o===e.Keeping||o===e.AfterDigs||c(n.kind))s.push(n);else if(n.kind===a.PictureSingle.Hash||n.kind===a.PictureSingle.Question||n.kind===a.PictureSingle.Zero){const t=(0,h.fastMin)(l,n.count);t<n.count&&s.push({kind:n.kind,count:n.count-t}),l-=t,0===l&&(o=e.Keeping)}}return s.reverse(),s}if(e===Ce.Zero&&l&&void 0===s)return r;const d=n-t;if(void 0!==s){const e=r.slice(),t=e[s];return e[s]={kind:t.kind,count:t.count+d},e}const g=r.slice(),m=u??o??g.length-1,p=[];return void 0===u&&p.push({kind:a.PictureSingle.Decimal}),p.push({kind:a.PictureSingle.Zero,count:d}),g.splice(m+1,0,...p),g}parseString(e){if(this.source!==s.NumberFormatSource.CustomBytecode&&e.length>255)throw new Ne(this.notFormatString("format string too long: max length"));let t=!1,r=!1,n=0,a=!1;for(let c=Ce.Pos;c<=Ce.Text&&!a;c+=1){const d=this.tokenize(e.substring(n)),{cond:g,currencySymbol:m,hasTokenCurrCode:h}=d,p=this.convertTokToSun(d),{currCode:f,hasPercent:S,hasDate:v,hasTime:F}=p,y=this.classifySunPartKind(p,c===Ce.Text?Ae.Text:Ae.Unknown),{part:C,applyCurrCode:A}=this.convertSunToCode(p);if(n+=d.consumed,a=d.eos,S&&(this.hasPercent=!0),v&&(this.hasDate=!0),F&&(this.hasTime=!0),h){if(!(c===Ce.Pos||this.hasTokenCurrCode&&(u=this.thisCurrCode,l=f,u===l||void 0!==u&&void 0!==l&&(0,s.isFormatCultureEqual)(u,l))))throw new Ne((0,o.notImplemented)(["inconsistent CurrCode in number parts"]));this.hasTokenCurrCode||(this.hasTokenCurrCode=!0,this.thisCurrCode=f)}if(void 0!==A&&void 0===this.applyCurrCode&&(this.applyCurrCode=A),void 0!==m&&void 0===this.thisCurrencySymbol&&(this.thisCurrencySymbol=m),this.source===s.NumberFormatSource.System&&((0,i.assertTrue)("calc.numfmt.NumberFormatImpl.parseString: system ipart",c===Ce.Pos),!a||y===Ae.Text))throw new Ne(this.notFormatString("system format with more than one part"));if((y===Ae.Text||c===Ce.Pos&&y===Ae.Either)&&(t=!0,this.parts[Ce.Text]=C,y===Ae.Text)){if(void 0!==g)throw new Ne(this.notFormatString("condition in text part"));if(void 0!==f)throw new Ne((0,o.notImplemented)(["CurrCode in text part"]));break}if(r=!0,this.parts[c]=C,this.onlyOneNumberPart=c===Ce.Pos,c===Ce.Pos)this.parts[Ce.Neg]=C,this.parts[Ce.Zero]=C,this.condPos=g;else if(c===Ce.Neg)this.condNeg=g;else if(void 0!==g)throw new Ne(this.notFormatString("condition in zero part"))}var u,l;if(!a)throw new Ne(this.notFormatString("too many parts"));r||(this.parts[Ce.Pos]=Ee,this.parts[Ce.Neg]=Ee,this.parts[Ce.Zero]=Ee,this.posBeforeText=!1),t||(this.parts[Ce.Text]=Ee),r&&!t&&this.onlyOneNumberPart&&void 0!==this.condPos&&!Fe(this.parts[Ce.Pos].code)&&(this.parts[Ce.Neg]=Ee,this.onlyOneNumberPart=!1),(0,i.assertTrue)("calc.numfmt.NumberFormatImpl.parseString: every part set",this.parts.every((e=>void 0!==e))),this.checkBytecode()}tokenize(e){const{localeInfo:t}=this.config,r={color:void 0,dbnum:void 0,dbnumForbidden:!1,cond:void 0,hasTokenCurrCode:!1,currCode:void 0,currencySymbol:void 0,tokens:[],consumed:0,eos:!0};let n,i,u;for(;r.consumed<e.length&&r.eos;){const t=this.readToken(r,e,r.consumed),s=n;switch(n=t,r.consumed+=t.tokenStr.length,t.kind){case a.PictureSingle.Sep:r.eos=!1;continue;case X.Color:if(void 0!==r.color)throw new Ne(this.notFormatString("more than one color"));if(0!==r.tokens.length)throw new Ne((0,o.notImplemented)(["colour in middle of format"]));r.color=t.color;continue;case X.Dbnum:if(void 0!==r.dbnum)throw new Ne(this.notFormatString("more than one DBNUM"));if(r.dbnumForbidden)throw new Ne(this.notFormatString("DBNUM after token which forbids it (% or E)"));if(0!==r.tokens.length)throw new Ne((0,o.notImplemented)(["DBNUM in middle of format"]));r.dbnum=t.dbnum;continue;case X.Cond:if(void 0!==r.cond)throw new Ne(this.notFormatString("more than one condition"));if(0!==r.tokens.length)throw new Ne((0,o.notImplemented)(["condition in middle of format"]));r.cond=t.cond;continue;case X.CurrCode:if(void 0!==i)throw new Ne(this.notFormatString("more than one currency code in section"));i=t;break;case X.Currency:u=t;break;case X.AMPM:case X.AMPMFE:case a.PictureSingle.Colon:case a.PictureSingle.DateSep:case X.LatinDate:case X.BidiDate:case a.PictureSingle.Year:case a.PictureSingle.Month:case a.PictureSingle.Day:case a.PictureSingle.Hour:case a.PictureSingle.Minute:case a.PictureSingle.Second:case a.PictureSingle.Reign:case a.PictureSingle.LocDay:case a.PictureSingle.Era:case a.PictureSingle.EraYear:case a.PictureSingle.EngYearTh:case a.PictureSingle.DayTh:case a.PictureSingle.MonthTh:case a.PictureSingle.YearTh:case a.PictureSingle.ThYear:case a.PictureSingle.HourTh:case a.PictureSingle.MinuteTh:case a.PictureSingle.SecondTh:if(s?.kind===t.kind){s.count+=t.count;continue}}r.tokens.push(t)}return void 0!==i?(r.hasTokenCurrCode=!0,r.currCode=i.currCode,r.currencySymbol=i.currencySymbol):void 0!==u&&void 0===r.currencySymbol&&(r.currencySymbol=s.FormatCurrency.LocaleInfo),4!==r.dbnum||t.isKorea||void 0===r.currCode&&!t.isThai||(r.dbnum=void 0),r}readToken(e,t,r){const{mathpack:n,localeInfo:s}=this.config,l=Z(s,s.pictureSpecial,t,r);if(void 0!==l){let e=l;const n=te(s.pictureSpecial,e);s.isJapan&&e===a.PictureSpecial.GeneralOldMAC&&(e=a.PictureSpecial.General);const i=t.substring(r,r+n.length);switch(e){case a.PictureSpecial.AP1:case a.PictureSpecial.AP2:return{kind:X.AMPM,tokenStr:i,count:1,pictureKind:e};case a.PictureSpecial.AP3:return{kind:X.AMPMFE,tokenStr:i,count:1};case a.PictureSpecial.General:return{kind:X.General,tokenStr:i};case a.PictureSpecial.Currency:return{kind:X.Currency,tokenStr:i}}}const c=(0,u.stringCodePointAt)(t,r),m=(0,u.numCodeUnits)(c),h=t.substring(r,r+m),p=ee(s,s.pictureSingle,t,r);if(void 0!==p){let l=p;if((s.isJapan||s.isChinaT)&&(l===a.PictureSingle.E||l===a.PictureSingle.EraYear)){let e,n;l=!(r+m+1<t.length)||(e=t.charCodeAt(r+m))!==R&&e!==T||(n=t.charCodeAt(r+m+1))!==k&&n!==N&&n!==I?a.PictureSingle.EraYear:a.PictureSingle.E}if(l===a.PictureSingle.BidiDate||l===a.PictureSingle.EngYearTh){let e;if(r+m<t.length&&((e=t.charCodeAt(r+m))===O||e===_))return{kind:e===O?X.LatinDate:X.BidiDate,tokenStr:t.substring(r,r+m+1),count:1};l=a.PictureSingle.EngYearTh}if(l===a.PictureSingle.BidiNum)throw new Ne(this.notFormatString("bidi num not allowed"));switch(l){case a.PictureSingle.Star:case a.PictureSingle.Underscore:{if(r+m>=t.length)throw new Ne(this.notFormatString("unterminated "+h));const e=(0,u.stringCodePointAt)(t,r+m),n=(0,u.numCodeUnits)(e),a=(0,u.stringFromCodePoint)(e);return{kind:l,tokenStr:t.substring(r,r+m+n),escaped:a}}case a.PictureSingle.Backslash:return this.readToken_Backslash(t,r,m);case a.PictureSingle.Quote:{const e=t.indexOf(h,r+m);if(e<0)throw new Ne(this.notFormatString("unterminated quoted string"));const n=t.substring(r+m,e),i=t.substring(r,e+m),o=Z(s,s.pictureSpecial,n,0);return void 0!==o&&o===a.PictureSpecial.Currency&&te(s.pictureSpecial,o).length===n.length?{kind:X.Currency,tokenStr:i}:{kind:X.StrLit,tokenStr:i,escaped:n}}case a.PictureSingle.E:{if(s.isEastAsia){if(void 0!==e.dbnum)throw new Ne(this.notFormatString("invalid DBNUM with exp"));if(e.dbnumForbidden)throw new Ne((0,o.notImplemented)(["multiple DBNUM-forbidden tokens (% or E)"]));e.dbnumForbidden=!0}if(r+m>=t.length)throw new Ne(this.notFormatString("unterminated exp"));const n=t.charCodeAt(r+m);if(n!==T&&n!==R)throw new Ne(this.notFormatString("exp not followed by sign"));const a=t.substring(r,r+m+1);return{kind:X.Exp,tokenStr:a,eStr:h,isNeg:n===R}}case a.PictureSingle.Hash:case a.PictureSingle.Year:case a.PictureSingle.Month:case a.PictureSingle.Day:case a.PictureSingle.Hour:case a.PictureSingle.Minute:case a.PictureSingle.Second:case a.PictureSingle.YearTh:case a.PictureSingle.MonthTh:case a.PictureSingle.DayTh:case a.PictureSingle.HourTh:case a.PictureSingle.MinuteTh:case a.PictureSingle.SecondTh:case a.PictureSingle.EngYearTh:case a.PictureSingle.ThYear:case a.PictureSingle.Question:case a.PictureSingle.Comma:case a.PictureSingle.Reign:case a.PictureSingle.LocDay:case a.PictureSingle.Era:case a.PictureSingle.EraYear:{if(l===a.PictureSingle.Reign&&!s.isJapan&&!s.isChinaT)break;let e=m,n=1;for(;(0,g.stringStartsWith)(t,h,r+e)&&void 0===Z(s,s.pictureSpecial,t,r+e);)e+=m,n+=1;if(l===a.PictureSingle.LocDay&&n<3)break;return{kind:l,tokenStr:t.substring(r,r+e),count:n}}case a.PictureSingle.Sep:case a.PictureSingle.Text:case a.PictureSingle.Decimal:case a.PictureSingle.Slash:case a.PictureSingle.Minus:case a.PictureSingle.Plus:return{kind:l,tokenStr:h};case a.PictureSingle.Space:return{kind:X.Char,tokenStr:h,escaped:h};case a.PictureSingle.Colon:return{kind:l,tokenStr:h,count:1};case a.PictureSingle.Percent:if(s.isEastAsia){if(void 0!==e.dbnum)throw new Ne(this.notFormatString("invalid DBNUM with pct"));if(e.dbnumForbidden)throw new Ne((0,o.notImplemented)(["multiple DBNUM-forbidden tokens (% or E)"]));e.dbnumForbidden=!0}return{kind:a.PictureSingle.Percent,tokenStr:h};case a.PictureSingle.DateSep:return h===te(s.pictureSingle,a.PictureSingle.Slash)?{kind:a.PictureSingle.Slash,tokenStr:h}:h===te(s.pictureSingle,a.PictureSingle.Minus)?{kind:a.PictureSingle.Minus,tokenStr:h}:{kind:a.PictureSingle.DateSep,tokenStr:h,count:1};case a.PictureSingle.ColorStart:{const e=te(s.pictureSingle,a.PictureSingle.ColorEnd),i=t.indexOf(e,r+m);if(i<0)throw new Ne(this.notFormatString("unterminated ["));const u=t.substring(r+m,i),c=t.substring(r,i+e.length),p=Z(s,Q,u,0);if(void 0!==p){let e=te(Q,p).length;for(;e<u.length&&(0,d.isSpace)(u.charCodeAt(e));)e+=1;const t=(0,d.parseSignedLiteral)(s,n,u,e,!1);if(t[1]===e)throw new Ne((0,o.notImplemented)(["invalid number in condition"]));if(t[1]!==u.length)throw new Ne((0,o.notImplemented)(["trailing junk after condition"]));return{kind:X.Cond,tokenStr:c,cond:{operator:Y[p],operand:t[0]}}}const S=Z(s,s.pictureColor,u,0);if(void 0!==S){const e=te(s.pictureColor,S);if(S!==a.PictureColor.Color){if(e.length!==u.length)throw new Ne((0,o.notImplemented)(["trailing junk after named color"]));return{kind:X.Color,tokenStr:c,color:(f=S,a.PictureColor[f])}}if(S===a.PictureColor.Color){let t=e.length;for(;t<u.length&&(0,d.isSpace)(u.charCodeAt(t));)t+=1;const[r,n]=(0,d.parseUint)(s,4,u,t);if(n===t)throw new Ne(this.notFormatString("missing number for numbered color"));if(n!==u.length)throw new Ne((0,o.notImplemented)(["trailing junk after numbered color"]));if(r<1||r>56)throw new Ne(this.notFormatString("out-of-range numbered color"));return{kind:X.Color,tokenStr:c,color:r+8}}}const v=Z(s,s.pictureDbnum,u,0);if(void 0!==v){if(te(s.pictureDbnum,v).length!==u.length)throw new Ne((0,o.notImplemented)(["trailing junk after DBNUM"]));return{kind:X.Dbnum,tokenStr:c,dbnum:$(v)}}return(0,g.stringStartsWith)(u,"$")?{kind:X.CurrCode,tokenStr:c,...this.parseCurrCode(u.substring(1))}:{kind:l,tokenStr:h}}case a.PictureSingle.ColorEnd:return{kind:l,tokenStr:h};case a.PictureSingle.OpenParen:case a.PictureSingle.CloseParen:return{kind:l,tokenStr:h,escaped:h};case a.PictureSingle.Extra:case a.PictureSingle.APDelim:case a.PictureSingle.Nen1:case a.PictureSingle.Gatsu1:case a.PictureSingle.Nichi1:case a.PictureSingle.Nen2:case a.PictureSingle.Gatsu2:case a.PictureSingle.Nichi2:case a.PictureSingle.Zero:case a.PictureSingle.ZeroTh:break;default:return(0,i.assertNever)("calc.numfmt.NumberFormatImpl: readToken single picKind",l)}}var f;if(s.isNumeral(c)){if(s.getNumberShape(c)!==v.NumberShape.ASCII)throw new Ne((0,o.notImplemented)(["non-ASCII digits"]));const e=s.getOrdinal(c);if(0===e){let e=m,n=1;for(;(0,g.stringStartsWith)(t,h,r+e);)e+=m,n+=1;const i=t.substring(r,r+e);return{kind:a.PictureSingle.Zero,tokenStr:i,count:n}}return{kind:X.Numeral,tokenStr:h,ordinal:e}}switch(c){case P:return{kind:a.PictureSingle.OpenParen,tokenStr:h,escaped:h};case M:return{kind:a.PictureSingle.CloseParen,tokenStr:h,escaped:h};case w:return this.readToken_Backslash(t,r,m);case D:if(s.isThai)return{kind:X.PrefixDigTh,tokenStr:h}}return{kind:X.Char,tokenStr:h,escaped:h}}readToken_Backslash(e,t,r){if(t+r>=e.length)throw new Ne(this.notFormatString("unterminated backslash"));const n=(0,u.stringCodePointAt)(e,t+r),i=(0,u.numCodeUnits)(n),o=(0,u.stringFromCodePoint)(n),s=e.substring(t,t+r+i);return n===P||n===M?{kind:n===P?a.PictureSingle.OpenParen:a.PictureSingle.CloseParen,tokenStr:s,escaped:o}:{kind:X.Char,tokenStr:s,escaped:o}}convertTokToSun({color:e,dbnum:t,cond:r,currCode:n,tokens:s}){const{localeInfo:u}=this.config,l={suns:[],dtrRounding:F.Rounding.RoundSec,color:e,dbnum:t,currCode:n,hasPercent:!1,hasDate:!1,hasTime:!1,get isEmpty(){return 0===this.suns.length&&void 0===r&&void 0===e&&void 0===t&&void 0===n}},c=0===u.stringCompareCI(te(u.pictureSingle,a.PictureSingle.Month),te(u.pictureSingle,a.PictureSingle.Minute));let d,g,m,p,f,S=!1,v=0,y=0,C=!1,A=!1,E=!1,b=!1,R=0;const T=(e,t)=>{const r=pe[e];if(t){if(A)throw new Ne(this.notFormatString("more than one absolute time"));if(void 0!==d&&r>=d)throw new Ne(this.notFormatString("absolute time must be largest division"));A=!0}else if(A&&r<=d)throw new Ne((0,o.notImplemented)(["larger time division after absolute time"]));(void 0===d||r<d)&&(d=r)};function k(e,t,r){const n=d;if(T(e,t),e===a.PictureSingle.Hour||e===a.PictureSingle.HourTh)E=!0,p=r,f=void 0;else if(e===a.PictureSingle.Second||e===a.PictureSingle.SecondTh)if(void 0===f||A)void 0===n&&(E=!0);else{const e=f.code[0];(0,i.assertTrue)("calc.numfmt.NumberFormatImpl: onTime ambigCode",e.kind===a.PictureSingle.Month);const t=a.PictureSingle.Minute,r=e.count;(0,i.assertTrue)("calc.numfmt.NumberFormatImpl: onTime ambigCount",1===r||2===r);const n=!1;T(t,n),v-=1,y+=1,f.code=[{kind:t,count:r,isAbs:n}],f=void 0}else E=!1}function N(e){const t=te(u.pictureSingle,e.kind);return{kind:Se.TimeSep,printAsTimeSep:v>0||y>0,formattedStr:t}}function I(e){const t=te(u.pictureSingle,e.kind);return t===te(u.pictureSingle,a.PictureSingle.DateSep)?{kind:Se.DateSep}:t===te(u.pictureSingle,a.PictureSingle.Colon)?N(e):{kind:Se.Char,formattedStr:t}}for(let e=0;e<s.length;e+=1){const t=s[e];switch(t.kind){case X.AMPM:case X.AMPMFE:case a.PictureSingle.Colon:case a.PictureSingle.DateSep:case a.PictureSingle.Year:case a.PictureSingle.Month:case a.PictureSingle.Day:case a.PictureSingle.Hour:case a.PictureSingle.Minute:case a.PictureSingle.Second:case a.PictureSingle.Reign:case a.PictureSingle.LocDay:case a.PictureSingle.Era:case a.PictureSingle.EraYear:case a.PictureSingle.EngYearTh:case X.LatinDate:case X.BidiDate:case a.PictureSingle.DayTh:case a.PictureSingle.MonthTh:case a.PictureSingle.YearTh:case a.PictureSingle.ThYear:case a.PictureSingle.HourTh:case a.PictureSingle.MinuteTh:case a.PictureSingle.SecondTh:{const r={kind:ye.Date,code:[]};switch(l.suns.push(r),C=!0,t.kind){case X.LatinDate:case X.BidiDate:if(0!==e&&(1!==e||s[0].kind!==X.CurrCode))throw new Ne(this.notFormatString("bidi date must be first"));r.code.push(t);break;case a.PictureSingle.DateSep:r.code.push({kind:Se.DateSep});break;case a.PictureSingle.Colon:r.code.push(N(t));break;case a.PictureSingle.Reign:v+=1,u.isJapan&&t.count>=2&&r.code.push({kind:a.PictureSingle.Era,count:3}),r.code.push({kind:a.PictureSingle.EraYear,count:u.isChinaT?1:2});break;case a.PictureSingle.Era:v+=1,r.code.push({kind:a.PictureSingle.Era,count:(0,h.fastMin)(3,t.count)});break;case a.PictureSingle.EraYear:v+=1,r.code.push({kind:a.PictureSingle.EraYear,count:(0,h.fastMin)(2,t.count)});break;case a.PictureSingle.Year:case a.PictureSingle.YearTh:case a.PictureSingle.EngYearTh:case a.PictureSingle.ThYear:f=void 0,v+=1,r.code.push({kind:t.kind,count:t.count<=2?2:4});break;case a.PictureSingle.Month:if(c&&t.count<=2){if(E){const e=a.PictureSingle.Minute,n=!1;k(e,n,r),y+=1,r.code.push({kind:e,count:t.count,isAbs:n}),E=!1;break}f=r}else f=void 0;v+=1,r.code.push({kind:t.kind,count:(0,h.fastMin)(5,t.count)});break;case a.PictureSingle.MonthTh:v+=1,r.code.push({kind:t.kind,count:(0,h.fastMin)(4,t.count)});break;case a.PictureSingle.Day:case a.PictureSingle.DayTh:f=void 0,v+=1,r.code.push({kind:t.kind,count:(0,h.fastMin)(4,t.count)});break;case a.PictureSingle.LocDay:f=void 0,v+=1,r.code.push({kind:a.PictureSingle.LocDay,count:3===t.count?3:4});break;case a.PictureSingle.Hour:case a.PictureSingle.HourTh:case a.PictureSingle.Minute:case a.PictureSingle.MinuteTh:case a.PictureSingle.Second:case a.PictureSingle.SecondTh:{const e=!1;k(t.kind,e,r),y+=1;const n=(0,h.fastMin)(2,t.count);t.kind===a.PictureSingle.Hour||t.kind===a.PictureSingle.HourTh?r.code.push({kind:t.kind,count:n,isAbs:e,isAMPM:!1}):r.code.push({kind:t.kind,count:n,isAbs:e});break}case X.AMPM:case X.AMPMFE:if(A)throw new Ne(this.notFormatString("AM/PM after absolute time"));if(t.count>1)throw new Ne((0,o.notImplemented)(["multiple AM/PM symbols"]));void 0!==p&&(p.code[0].isAMPM=!0,p=void 0),b=!0,r.code.push(t);break;default:return(0,i.assertNever)("calc.numfmt.NumberFormatImpl: convertTokToSun tok as date",t)}break}case a.PictureSingle.Decimal:case X.Numeral:case a.PictureSingle.Hash:case a.PictureSingle.Zero:case a.PictureSingle.Question:case a.PictureSingle.Comma:{if(C){if(t.kind!==a.PictureSingle.Decimal&&t.kind!==a.PictureSingle.Comma)throw new Ne(this.notFormatString("number picture in date/time format"));const r={kind:ye.Date,code:[]};l.suns.push(r);const n=s[e+1];if(t.kind===a.PictureSingle.Decimal&&n?.kind===a.PictureSingle.Zero){const t=n.count;if(t>3)throw new Ne(this.notFormatString("invalid number of fractional seconds"));e+=1,k(a.PictureSingle.Second,!1,r),y+=1,r.code.push({kind:Se.FracSeconds,rounding:t}),l.dtrRounding=(0,h.fastMax)(l.dtrRounding,t)}else r.code.push(I(t));break}if(t.kind===a.PictureSingle.Comma){const e=te(u.pictureSingle,t.kind),r={kind:ye.Other,code:[{kind:Se.Char,formattedStr:e}]};l.suns.push(r);break}const r=e=>e===X.Numeral||e===a.PictureSingle.Hash||e===a.PictureSingle.Zero||e===a.PictureSingle.Question,n={kind:ye.Num,code:[],numDigLeft:0,numDigDec:0,numPercent:0,numThousands:0,comma:!1,decimal:!1,numVal:!1,nonZero:!1,get digitTokens(){return this.anyHash||this.anyQuestion},get reallyNum(){return this.anyHash||this.anyQuestion||this.anyZero},lastDig:void 0,firstDig:void 0,anyHash:!1,anyQuestion:!1,anyZero:!1};let i;for(l.suns.push(n),void 0===g&&(g=n),m=n,e-=1;e+1<s.length;e+=1){const t=s[e+1];let o=!0;switch(t.kind){case a.PictureSingle.Decimal:S=n.decimal=!0,n.code.push(t),i=void 0;break;case X.Numeral:n.code.push({kind:t.kind,formattedStr:t.tokenStr,ordinal:t.ordinal}),n.numVal=n.nonZero=!0,i=void 0;break;case a.PictureSingle.Hash:case a.PictureSingle.Zero:case a.PictureSingle.Question:if(n.decimal?n.numDigDec+=t.count:n.numDigLeft+=t.count,void 0===n.firstDig&&(n.firstDig=t.kind),n.lastDig=t.kind,t.kind===a.PictureSingle.Hash?n.anyHash=!0:t.kind===a.PictureSingle.Question?n.anyQuestion=!0:(n.anyZero=!0,n.numVal=!0),void 0!==i&&i.kind===t.kind)i.count+=t.count;else{const e={kind:t.kind,count:t.count};n.code.push(e),i=e}break;case a.PictureSingle.Comma:const l=s[e+2]?.kind;if(r(l))S||(n.comma=!0);else{let e=t.count;const r=te(u.pictureSingle,a.PictureSingle.Space);r===te(u.pictureSingle,a.PictureSingle.Comma)&&(!u.isCurrencySymbolLead&&u.isCurrencySepBySpace&&l===X.Currency||u.isPercentSepBySpace&&l===a.PictureSingle.Percent)&&(n.code.push({kind:Se.Char,formattedStr:r}),e-=1),e>0&&(n.numThousands+=e)}break;default:o=!1}if(!o)break}break}case a.PictureSingle.Percent:{R+=1;const e={kind:ye.Percent,code:[{kind:a.PictureSingle.Percent,formattedStr:t.tokenStr}]};l.suns.push(e),l.hasPercent=!0;break}case X.Exp:{const e={kind:ye.Exp,code:[{kind:X.Exp,formattedStr:t.eStr,isNeg:t.isNeg}],isNeg:t.isNeg};l.suns.push(e);break}case X.General:{const e={kind:ye.General,code:[t]};l.suns.push(e);break}case a.PictureSingle.Text:{const e={kind:ye.Text,code:[t]};l.suns.push(e);break}case a.PictureSingle.Slash:{if(C){const e={kind:ye.Date,code:[I(t)]};l.suns.push(e);break}const e={kind:ye.Fraction,code:[{kind:a.PictureSingle.Slash,formattedStr:t.tokenStr}]};l.suns.push(e);break}case a.PictureSingle.Star:case X.PrefixDigTh:case a.PictureSingle.Underscore:case X.Currency:case X.CurrCode:case X.StrLit:{const e={kind:ye.Other,code:[t]};l.suns.push(e);break}case a.PictureSingle.ColorEnd:case a.PictureSingle.Plus:{const e={kind:ye.Other,code:[{kind:Se.Char,formattedStr:t.tokenStr}]};l.suns.push(e);break}case a.PictureSingle.OpenParen:case a.PictureSingle.CloseParen:case X.Char:{const e={kind:ye.Other,code:[{kind:Se.Char,formattedStr:t.escaped}]};l.suns.push(e);break}case a.PictureSingle.Minus:{if(C){const e={kind:ye.Date,code:[I(t)]};l.suns.push(e);break}const e=te(u.pictureSingle,t.kind),r={kind:ye.Other,code:[{kind:Se.Char,formattedStr:e}]};l.suns.push(r);break}case a.PictureSingle.ColorStart:{let t=L.WantPic;const r={kind:ye.Date,code:[]};for(;e+1<s.length&&t!==L.Done;e+=1){const n=s[e+1];switch(n.kind){case a.PictureSingle.ColorEnd:if(t!==L.WantClose)throw new Ne(this.notFormatString("unexpected closing ]"));t=L.Done;continue;case a.PictureSingle.Hour:case a.PictureSingle.HourTh:case a.PictureSingle.Month:case a.PictureSingle.Minute:case a.PictureSingle.Second:{if(n.kind===a.PictureSingle.Month&&!c)break;const e=n.kind===a.PictureSingle.Month?a.PictureSingle.Minute:n.kind,i=!0;k(e,i,r),y+=1;const o=(0,h.fastMin)(2,n.count);e===a.PictureSingle.Hour||e===a.PictureSingle.HourTh?r.code.push({kind:e,count:o,isAbs:i,isAMPM:!1}):r.code.push({kind:e,count:o,isAbs:i}),C=!0,t=L.WantClose;continue}case X.Char:if(n.tokenStr===te(u.pictureSingle,a.PictureSingle.Space))continue}throw new Ne(this.notFormatString("unexpected token after ["))}if(t!==L.Done)throw new Ne((0,o.notImplemented)(["semicolon inside [ ]"]));l.suns.push(r);break}default:return(0,i.assertNever)("calc.numfmt.NumberFormatImpl: convertTokToSun tok",t)}if(l.suns.length>=2){const e=l.suns[l.suns.length-2],t=l.suns[l.suns.length-1];if(e.kind===ye.Other&&t.kind===ye.Other){const r=e.code;(0,h.safePush)(r,t.code),l.suns.pop()}}}if(void 0!==g&&(g.numThousands=m.numThousands,g.numPercent=R),b&&void 0!==p&&(p.code[0].isAMPM=!0),A)for(const e of l.suns)if(e.kind===ye.Date)for(const t of e.code)switch(t.kind){case a.PictureSingle.Hour:case a.PictureSingle.HourTh:case a.PictureSingle.Minute:case a.PictureSingle.MinuteTh:case a.PictureSingle.Second:case a.PictureSingle.SecondTh:t.isAbs=pe[t.kind]===d}if(l.suns.length>32)throw new Ne(this.notFormatString("format string too long: SUNs limit"));return l.hasDate=v>0,l.hasTime=y>0,l}classifySunPartKind({suns:e,isEmpty:t,hasDate:r,hasTime:n},a){let o=a===Ae.Number,s=a===Ae.Text,u=!o&&!s;for(const t of e){switch(t.kind){case ye.Num:case ye.Fraction:case ye.Percent:case ye.Exp:o=!0;break;case ye.Text:s=!0;break;case ye.General:continue;case ye.Other:case ye.Date:break;default:return(0,i.assertNever)("calc.numfmt.NumberFormatImpl: classifySunPartKind sun",t)}u=!1}if((o?1:0)+(r||n?1:0)+(s?1:0)>1)throw new Ne(this.notFormatString("cannot mix number/date/text"));return o||r||n?Ae.Number:s?Ae.Text:u&&!t?Ae.Either:a}convertSunToCode({suns:e,isEmpty:t,dtrRounding:r,color:n,dbnum:a,currCode:o}){const{localeInfo:u}=this.config,l=[];function c(t){for(let r=t-1;r>=0;r-=1){const t=e[r];if(t.kind===ye.Num)return[r,t]}}function d(t){for(let r=t+1;r<e.length;r+=1){const t=e[r];if(t.kind===ye.Num)return[r,t]}}let g,m=!1,p=0;for(let t=0;t<e.length;t+=1){const r=e[t];switch(r.kind){case ye.Text:if(g===ye.Text)break;if(void 0!==g)throw new Ne(this.notFormatString("@ after other control"));g=ye.Text;break;case ye.General:if(void 0!==g)throw new Ne(this.notFormatString("General after other control"));if(m)throw new Ne(this.notFormatString("General after number"));g=ye.General;break;case ye.Num:if(m=!0,g===ye.General)throw new Ne(this.notFormatString("number after General"));break;case ye.Fraction:if(void 0!==g)throw new Ne(this.notFormatString("/ after other control"));if(u.isEastAsia&&void 0!==a)throw new Ne(this.notFormatString("/ not allowed with DBNUM"));g=ye.Fraction;const n=c(t);if(void 0===n)throw new Ne(this.notFormatString("no number before /"));const[o,s,f]=this.mergeNumSuns(e,p,n[0]),S=d(t);if(void 0===S)throw new Ne(this.notFormatString("no number after /"));const v=e.slice(n[0]+1,S[0]),F=void 0!==d(S[0]);(0,h.safePush)(l,this.flattenSuns(o)),(0,h.safePush)(l,this.buildFractCode(s,f,n[1],v,S[1],F)),p=S[0]+1;break;case ye.Exp:if(void 0!==g)throw new Ne(this.notFormatString("E after other control"));g=ye.Exp;const[y,C,A]=this.mergeNumSuns(e,p,t);if(void 0===C)throw new Ne(this.notFormatString("no number before E"));const[E,b,R]=this.mergeNumSuns(e,t+1,e.length);if(void 0===b)throw new Ne(this.notFormatString("no number after E"));(0,h.safePush)(l,this.flattenSuns(y)),(0,h.safePush)(l,this.buildExpCode(r.isNeg,C,[...A,e[t],...E],b)),(0,h.safePush)(l,this.flattenSuns(R)),p=e.length;break;case ye.Percent:case ye.Other:case ye.Date:break;default:return(0,i.assertNever)("calc.numfmt.NumberFormatImpl: convertSunToCode sun",r)}}if(void 0===g){const[t,r,n]=this.mergeNumSuns(e,p,e.length);void 0!==r?(0,h.safePush)(l,this.buildNumberCode(t,r)):(0,h.safePush)(l,this.flattenSuns(t)),(0,h.safePush)(l,this.flattenSuns(n)),p=e.length}(0,h.safePush)(l,this.flattenSuns(e.slice(p))),0!==e.length||t||l.push(ve);const f=o?.tag;if((0,s.isSystemCultureTag)(f)){const e=f===s.CultureTag.SysDate?u.sysDateFormat:u.sysTimeFormat,t=new Ie(this.config,{old:void 0,formatString:e,source:s.NumberFormatSource.System}),r=t.parts[Ce.Pos];return{part:{code:[{kind:Se.SysFormat,codeSysFormat:r.code,codeThisFormat:l}],color:r.color,dbnum:r.dbnum,dtrRounding:r.dtrRounding},applyCurrCode:t.thisCurrCode}}return{part:{code:l,color:n,dbnum:a,dtrRounding:r},applyCurrCode:o}}flattenSuns(e){return(0,h.safeConcat)([],e.map((e=>e.code)))}buildExpCode(e,t,r,n){if(n.comma)throw new Ne(this.notFormatString("comma following E"));const a=t.numDigDec;if(a>127)throw new Ne(this.notFormatString("too many decimal digits"));const{code:i,comma:o,numDigLeft:s}=this.bumpDigitsForComma(t);return[{kind:Se.Exp,isNeg:e,numMantDigLeft:s,numMantDigDec:a,numExpDigLeft:n.numDigLeft,commaMant:o,codeMant:i,codeBetween:this.flattenSuns(r),codeExp:this.flattenSuns([n])}]}buildNumberCode(e,t){const{numDigDec:r}=t;if(r>127)throw new Ne(this.notFormatString("too many decimal digits"));const{code:n,comma:a,numDigLeft:i}=this.bumpDigitsForComma(t);return[{kind:Se.Num,numDigLeft:i,numDigDec:r,numPercent:t.numPercent,numThousands:t.numThousands,comma:a,codeBefore:this.flattenSuns(e),code:n}]}buildFractCode(e,t,r,n,s,u){const{mathpack:l}=this.config;if(r.comma)throw new Ne(this.notFormatString("comma in numerator"));if(r.decimal)throw new Ne((0,o.notImplemented)(["decimals in numerator"]));if(s.comma)throw new Ne(this.notFormatString("comma in denominator"));if(s.decimal)throw new Ne(this.notFormatString("decimals in denominator"));if(0!==r.numDigDec)throw new Ne(this.notFormatString("decimals in numerator"));if((c=s).numVal&&c.nonZero&&c.digitTokens)throw new Ne(this.notFormatString("literal and placeholder digits mixed in denominator"));var c;if(u)throw new Ne((0,o.notImplemented)(["fraction number formats with trailing numbers"]));let d,g=!1,m=0;if(void 0!==e){if(!e.reallyNum)throw new Ne((0,o.notImplemented)(["fixed numerals in fraction integer part"]));if(e.decimal)throw new Ne((0,o.notImplemented)(["decimal in fraction integer part"]));if(0!==e.numDigDec)throw new Ne(this.notFormatString("decimals in fraction integer part"));if(e.numVal&&e.nonZero)throw new Ne((0,o.notImplemented)(["numerals in fraction integer part"]));({code:d,comma:g,numDigLeft:m}=this.bumpDigitsForComma(e))}const h=e?.numPercent??r.numPercent,p=e?.numThousands??r.numThousands;if(p>0)throw new Ne((0,o.notImplemented)(["fraction number formats with thousands"]));let f,{code:S,numDigLeft:v,firstDig:F}=s;if(s.numVal&&s.nonZero){if(u)throw new Ne((0,o.notImplemented)(["fraction number formats with specified denominator and trailing numbers"]));if(s.code.length>5)throw new Ne((0,o.notImplemented)(["too many digits in denominator"]));let e=0;for(let t=0;t<s.code.length;t+=1){const r=s.code[t];switch(r.kind){case X.Numeral:e=10*e+r.ordinal;break;case a.PictureSingle.Zero:if(0===t)throw new Ne((0,o.notImplemented)(["leading zero in denominator"]));e*=10;break;default:return(0,i.assertFalse)("calc.numfmt.NumberFormatImpl: buildFractCode denomCode")}}if(e>32767)throw new Ne((0,o.notImplemented)(["overflow in denominator not emulated"]));S=[{kind:a.PictureSingle.Hash,count:1}],v=1,F=void 0,f=l.fromNumber(e)}return[{kind:Se.Fraction,numIntDigLeft:m,numPercent:h,numThousands:p,numNumerDig:r.numDigLeft,numDenomDig:v,commaInt:g,codeInt:d,codeBetween1:this.flattenSuns(t),codeNumer:r.code,codeBetween2:this.flattenSuns(n),codeDenom:S,denomValue:f,lastDigInt:void 0!==e?e.lastDig:void 0,firstDigNumer:r.firstDig,firstDigDenom:F,anyZeroNumer:r.anyZero,anyQuestionNumer:r.anyQuestion}]}mergeNumSuns(e,t,r){const n=[],a=[];let i;for(let o=t;o<e.length&&o<r;o+=1){const t=e[o];void 0!==i?t.kind===ye.Num?(i.decimal?i.numDigDec+=t.numDigLeft+t.numDigDec:(i.numDigLeft+=t.numDigLeft,i.numDigDec+=t.numDigDec),i.comma=i.comma||t.comma,i.decimal=i.decimal||t.decimal,i.numVal=i.numVal||t.numVal,i.nonZero=i.nonZero||t.nonZero,void 0!==t.lastDig&&(i.lastDig=t.lastDig),void 0===i.firstDig&&(i.firstDig=t.firstDig),i.anyHash=i.anyHash||t.anyHash,i.anyQuestion=i.anyQuestion||t.anyQuestion,i.anyZero=i.anyZero||t.anyZero,(0,h.safePush)(i.code,this.flattenSuns(a)),a.length=0,(0,h.safePush)(i.code,t.code)):a.push(t):t.kind===ye.Num?i=t:n.push(t)}return[n,i,a]}bumpDigitsForComma(e){if(!e.comma)return e;if(this.anyLegalCommaPosition(e))return e;const t=e.numDigLeft%3,r=(0===t?0===e.numDigLeft?3:e.numDigLeft:e.numDigLeft+3-t)+1;for(let t=0;t<e.code.length;t+=1){const n=e.code[t];switch(n.kind){case a.PictureSingle.Hash:{const a=e.code.slice();return a[t]={...n,count:n.count+(r-e.numDigLeft)},{code:a,comma:!0,numDigLeft:r}}case a.PictureSingle.Zero:case a.PictureSingle.Question:case a.PictureSingle.Decimal:{const n=e.code.slice();return n.splice(t,0,{kind:a.PictureSingle.Hash,count:r-e.numDigLeft}),{code:n,comma:!0,numDigLeft:r}}}}throw new Ne((0,o.notImplemented)(["comma with pure number literal"]))}anyLegalCommaPosition(e){if(e.numDigLeft<4)return!1;const t=e=>{const t=e?.kind;return t===a.PictureSingle.Hash||t===a.PictureSingle.Zero||t===a.PictureSingle.Question};let r=e.numDigLeft;for(let n=0;n<e.code.length;n+=1){const i=e.code[n];if(i.kind===a.PictureSingle.Decimal)return!1;if(t(i))for(let a=0;a<i.count;a+=1)if(r-=1,r>0&&r%3==0&&(a+1<i.count||t(e.code[n+1])))return!0}return!1}parseCurrCode(e){const{localeInfo:t}=this.config;let r,n,a;{const n=e.indexOf("-");if(0!==e.length&&0!==n){if(r=n<0?e:e.substring(0,n),r.length>61)throw new Ne(this.notFormatString("currencySymbol too long"));for(const e of(0,u.codePointIterator)(r))if(t.isNumeral(e)&&t.getNumberShape(e)!==v.NumberShape.ASCII)throw new Ne((0,o.notImplemented)(["non-ASCII digits in currencySymbol"]))}n>=0&&(a=e.substring(n+1))}if(void 0!==a&&(n=this.parseFormatCulture(a),void 0===n))throw new Ne((0,o.notImplemented)(["unhandled CurrCode: "+(0,E.anonymizeFormulaString)(e)]));if((0,s.isSystemCultureTag)(n?.tag)){if(void 0!==r)throw new Ne(this.notFormatString("currencySymbol with sysdate/systime"));if(this.source===s.NumberFormatSource.System)throw new Ne(this.notFormatString("system format referenced circularly within system format"))}return{currencySymbol:r,currCode:n}}parseFormatCulture(e){const r={culture:"",numberShape:void 0,nationalNumberInput:!1,calendar:void 0,localCalendarInput:!1,tag:void 0},n=n=>{const a=(32512&n)>>8;if(0!==a&&(r.numberShape=t.pictureNumberShape[a],void 0===r.numberShape))throw new Ne((0,o.notImplemented)([`unknown number shape ${a} in culture: ${(0,E.anonymizeFormulaString)(e)}`]));r.nationalNumberInput=0!=(32768&n);const i=127&n;if(0!==i&&(r.calendar=t.pictureCalendar[i],void 0===r.calendar))throw new Ne((0,o.notImplemented)([`unknown calendar ${i} in culture: ${(0,E.anonymizeFormulaString)(e)}`]));r.localCalendarInput=0!=(128&n)},i=e.match(ie);if(null!=i){r.culture=i[1]??"";const t=i[2]??i[3];if(null!=t){if(r.tag=oe[t.toLowerCase()],void 0===r.tag)throw new Ne((0,o.notImplemented)(["unknown CurrCode tag: "+(0,E.anonymizeFormulaString)(e)]));switch(r.tag){case s.CultureTag.SysDate:case s.CultureTag.SysTime:case s.CultureTag.Euro1:case s.CultureTag.Euro2:case s.CultureTag.Bitcoin1:case s.CultureTag.Bitcoin2:if(""!==r.culture)throw new Ne(this.notFormatString(`CultureTag ${String(r.tag)} cannot have culture`));break;case s.CultureTag.GenLower:case s.CultureTag.GenUpper:case s.CultureTag.NomLower:case s.CultureTag.Gannen:if(""===r.culture)throw new Ne(this.notFormatString(`CultureTag ${String(r.tag)} must have culture`))}}const a=i[4];return null!=a&&n(ue(a)),r}if(ae.test(e)){const t=ue(e);let i=65535&t;switch(i){case a.LCID.SystemLongDate:r.tag=s.CultureTag.SysDate;break;case a.LCID.SystemTime:r.tag=s.CultureTag.SysTime;break;case a.LCID.EuroTrailing:r.tag=s.CultureTag.Euro1;break;case a.LCID.EuroLeading:r.tag=s.CultureTag.Euro2;break;default:64512==(64512&i)&&(r.tag=s.CultureTag.GenLower),63488==(64512&i)&&(r.tag=s.CultureTag.GenUpper),62464==(64512&i)&&(r.tag=s.CultureTag.NomLower),void 0!==r.tag&&(i&=-63489),r.culture=(0,b.convertKnownLCID)(i)}return n(t>>16),r}}determineValueType(){const{localeInfo:e}=this.config,t={accountFill:!1,fvt:void 0};for(const e of this.parts){t.accountFill=!1;const r=this.determineValueTypeCodes(t,e.code);if(void 0!==r)return r;if(t.accountFill&&(t.fvt===s.FormatValueType.Number||t.fvt===s.FormatValueType.Currency))return s.FormatValueType.Accounting;if(void 0!==t.fvt)return t.fvt}return void 0!==t.fvt?t.fvt:this.formatString===te(e.pictureSpecial,a.PictureSpecial.General)?s.FormatValueType.General:s.FormatValueType.Custom}determineValueTypeCodes(e,t){const{localeInfo:r}=this.config;for(let n=0;n<t.length;n+=1){const o=t[n];switch(o.kind){case X.General:break;case a.PictureSingle.Text:return s.FormatValueType.Text;case a.PictureSingle.Star:e.accountFill=!0;break;case Se.Char:case X.Exp:case a.PictureSingle.Slash:case X.StrLit:case a.PictureSingle.Percent:case a.PictureSingle.Underscore:case X.Numeral:case Se.DateSep:case Se.TimeSep:break;case X.Currency:e.fvt=s.FormatValueType.Currency;break;case X.CurrCode:void 0!==o.currencySymbol&&(e.fvt=s.FormatValueType.Currency);break;case Se.Num:{e.fvt=1===o.numPercent&&0===o.numThousands?s.FormatValueType.Percentage:s.FormatValueType.Number;const t=o.codeBefore;let n,a=0;if(r.isEastAsia){if(a<t.length&&"("===fe(t[a])&&(a+=1),a<t.length&&"US$"===fe(t[a]))return s.FormatValueType.Currency;if(r.isChinaT){if(a<t.length&&"NT$"===fe(t[a]))return s.FormatValueType.Currency}else if(a<t.length&&"$"===fe(t[a]))return s.FormatValueType.Currency}if(void 0!==(n=this.determineValueTypeCodes(e,o.codeBefore.slice(a))))return n;if(void 0!==(n=this.determineValueTypeCodes(e,o.code)))return n;break}case Se.Exp:{let t;if(e.fvt=s.FormatValueType.Scientific,void 0!==(t=this.determineValueTypeCodes(e,o.codeMant)))return t;if(void 0!==(t=this.determineValueTypeCodes(e,o.codeBetween)))return t;if(void 0!==(t=this.determineValueTypeCodes(e,o.codeExp)))return t;break}case Se.Fraction:{let t;if(e.fvt=s.FormatValueType.Fraction,void 0!==o.codeInt&&void 0!==(t=this.determineValueTypeCodes(e,o.codeInt)))return t;if(void 0!==(t=this.determineValueTypeCodes(e,o.codeBetween1)))return t;if(void 0!==(t=this.determineValueTypeCodes(e,o.codeNumer)))return t;if(void 0!==(t=this.determineValueTypeCodes(e,o.codeBetween2)))return t;if(void 0!==(t=this.determineValueTypeCodes(e,o.codeDenom)))return t;break}case a.PictureSingle.Decimal:case a.PictureSingle.Hash:case a.PictureSingle.Zero:case a.PictureSingle.Question:case X.PrefixDigTh:case X.LatinDate:case X.BidiDate:break;case a.PictureSingle.HourTh:case a.PictureSingle.MinuteTh:case a.PictureSingle.SecondTh:case a.PictureSingle.Hour:case a.PictureSingle.Minute:case a.PictureSingle.Second:case Se.FracSeconds:return s.FormatValueType.Time;case X.AMPM:case X.AMPMFE:break;case a.PictureSingle.Era:case a.PictureSingle.EraYear:case a.PictureSingle.YearTh:case a.PictureSingle.EngYearTh:case a.PictureSingle.ThYear:case a.PictureSingle.MonthTh:case a.PictureSingle.DayTh:case a.PictureSingle.Year:case a.PictureSingle.Month:case a.PictureSingle.Day:case a.PictureSingle.LocDay:return s.FormatValueType.Date;case Se.SysFormat:return this.determineValueTypeCodes(e,o.codeThisFormat);default:return(0,i.assertNever)("calc.numfmt.NumberFormatImpl: determineValueTypeCodes code",o)}}}determineDecimals(){const e=this.parts[Ce.Pos];for(const t of e.code)switch(t.kind){case Se.Num:return t.numDigDec;case Se.Exp:return t.numMantDigDec}return 0}determineBidiDate(){const e=te(this.config.localeInfo.pictureSingle,a.PictureSingle.BidiDate);return(0,g.stringStartsWith)(this.formatString,e+"1")?s.BidiDate.English:(0,g.stringStartsWith)(this.formatString,e+"2")?s.BidiDate.Lunar:void 0}printFormatString(){const{localeInfo:e}=this.config,[t,r,n,i]=this.parts,o=!(be(i)||i===t),s=this.posBeforeText||!o;let u="";return s&&(u+=this.printPart(t,this.condPos),r!==t&&(u+=te(e.pictureSingle,a.PictureSingle.Sep),u+=this.printPart(r,this.condNeg),n!==t&&(u+=te(e.pictureSingle,a.PictureSingle.Sep),u+=this.printPart(n,void 0)))),o&&(s&&(u+=te(e.pictureSingle,a.PictureSingle.Sep)),u+=this.printPart(i,void 0)),u}printPart(e,t){const{mathpack:r,localeInfo:n}=this.config;let i="";var o;if(void 0!==e.color&&(i+=te(n.pictureSingle,a.PictureSingle.ColorStart)+("number"==typeof e.color?te(n.pictureColor,a.PictureColor.Color)+String(e.color-8):te(n.pictureColor,(o=e.color,a.PictureColor[o])))+te(n.pictureSingle,a.PictureSingle.ColorEnd)),void 0!==t){const e=21;i+=te(n.pictureSingle,a.PictureSingle.ColorStart)+te(Q,J[t.operator])+r.formatGeneral(n,t.operand,e)+te(n.pictureSingle,a.PictureSingle.ColorEnd)}return void 0!==e.dbnum&&(i+=te(n.pictureSingle,a.PictureSingle.ColorStart)+te(n.pictureDbnum,e.dbnum-1)+te(n.pictureSingle,a.PictureSingle.ColorEnd)),i+=this.printCodes({seenDig:!1,wasPrevDig:!1},e.code,void 0),i}printCodes(e,r,n){const{mathpack:o,localeInfo:l}=this.config;let c,d="";if(void 0!==n&&n.numThousands>0){for(let e=0;e<r.length;e+=1){const t=r[e].kind;t!==a.PictureSingle.Zero&&t!==a.PictureSingle.Hash&&t!==a.PictureSingle.Question&&t!==a.PictureSingle.Decimal&&t!==X.Numeral||(c=e)}(0,i.assertTrue)("calc.numfmt.NumberFormatImpl: printCodes thousandsAfter",void 0!==c)}for(let m=0;m<r.length;m+=1){const h=r[m],p=e.wasPrevDig;switch(e.wasPrevDig=!1,h.kind){case X.General:d+=te(l.pictureSpecial,a.PictureSpecial.General);break;case a.PictureSingle.Decimal:void 0!==n&&(n.decimal=!0),e.wasPrevDig=!0,d+=te(l.pictureSingle,a.PictureSingle.Decimal);break;case a.PictureSingle.Hash:case a.PictureSingle.Zero:case a.PictureSingle.Question:{e.seenDig=!0,e.wasPrevDig=!0;const t=h.kind===a.PictureSingle.Zero?"0":te(l.pictureSingle,h.kind),i=(0,g.repeat)(t,h.count);if(void 0===n||n.decimal){d+=i;break}if(n.comma){const e=n.numDigLeft-h.count;d+=(0,f.insertCommas)({isThousandsPosition:t=>{return t>0&&t%3==0&&(t>e||(n=r[m+1]?.kind,n===a.PictureSingle.Hash||n===a.PictureSingle.Zero||n===a.PictureSingle.Question));var n},thousandsSeparator:te(l.pictureSingle,a.PictureSingle.Comma)},i,e)}else d+=i;n.numDigLeft-=h.count;break}case X.Numeral:e.wasPrevDig=!0,d+=h.formattedStr;break;case Se.Exp:d+=this.printCodes(e,h.codeMant,{comma:h.commaMant,numThousands:0,decimal:!1,numDigLeft:h.numMantDigLeft})+this.printCodes(e,h.codeBetween,void 0)+this.printCodes(e,h.codeExp,{comma:!1,numThousands:0,decimal:!1,numDigLeft:h.numExpDigLeft});break;case Se.Num:d+=this.printCodes(e,h.codeBefore,void 0)+this.printCodes(e,h.code,{comma:h.comma,numThousands:h.numThousands,decimal:!1,numDigLeft:h.numDigLeft});break;case Se.Fraction:{const t=void 0===h.codeInt?"":this.printCodes(e,h.codeInt,{comma:h.commaInt,numThousands:0,decimal:!1,numDigLeft:h.numIntDigLeft}),r=this.printCodes(e,h.codeBetween1,void 0),n=this.printCodes(e,h.codeNumer,{comma:!1,numThousands:0,decimal:!1,numDigLeft:h.numNumerDig}),a=this.printCodes(e,h.codeBetween2,void 0),i=this.printCodes(e,h.codeDenom,{comma:!1,numThousands:h.numThousands,decimal:!1,numDigLeft:h.numDenomDig});d+=t+r+n+a+(void 0!==h.denomValue?U(o,h.denomValue):i);break}case Se.Char:{const t=te(l.pictureSingle,a.PictureSingle.Backslash),n=ee(l,l.pictureSingle,h.formattedStr,0),i=re(l,l.pictureSpecial,h.formattedStr,0);if(void 0!==n&&n!==a.PictureSingle.Extra&&n!==a.PictureSingle.Zero)switch(n){case a.PictureSingle.Comma:const n=r[m+1];if(p){const e=te(l.pictureSingle,a.PictureSingle.Space);if(h.formattedStr!==e||void 0===n||(l.isCurrencySymbolLead||!l.isCurrencySepBySpace||n.kind!==X.Currency)&&(!l.isPercentSepBySpace||n.kind!==a.PictureSingle.Percent)){d+=t;break}}if(n?.kind===Se.Char&&n?.formattedStr===h.formattedStr){d+=t;break}break;case a.PictureSingle.Decimal:d+=t;break;case a.PictureSingle.Slash:e.seenDig&&(d+=t);break;case a.PictureSingle.Space:case a.PictureSingle.Minus:case a.PictureSingle.Plus:case a.PictureSingle.OpenParen:case a.PictureSingle.CloseParen:break;case a.PictureSingle.DateSep:te(l.pictureSingle,a.PictureSingle.DateSep)!==te(l.pictureSingle,a.PictureSingle.Minus)&&(d+=t);break;default:d+=t}else(i||l.isNumeral((0,u.stringCodePointAt)(h.formattedStr,0)))&&(d+=t);d+=h.formattedStr;break}case X.Exp:d+=h.formattedStr+(h.isNeg?"-":"+");break;case X.StrLit:{const e=te(l.pictureSingle,a.PictureSingle.Quote);(0,i.assertTrue)("calc.numfmt.NumberFormatImpl: printCodes StrLit",h.escaped.indexOf(e)<0),d+=e+h.escaped+e;break}case a.PictureSingle.Slash:d+=te(l.pictureSingle,a.PictureSingle.Slash);break;case a.PictureSingle.Percent:d+=te(l.pictureSingle,a.PictureSingle.Percent);break;case a.PictureSingle.Star:d+=te(l.pictureSingle,a.PictureSingle.Star)+h.escaped;break;case a.PictureSingle.Underscore:d+=te(l.pictureSingle,a.PictureSingle.Underscore)+h.escaped;break;case X.PrefixDigTh:d+="t";break;case X.Currency:d+=te(l.pictureSpecial,a.PictureSpecial.Currency);break;case X.CurrCode:if(d+=te(l.pictureSingle,a.PictureSingle.ColorStart),d+="$",void 0!==h.currencySymbol&&(d+=h.currencySymbol),void 0!==h.currCode){const{culture:e,numberShape:r,nationalNumberInput:n,calendar:a,localCalendarInput:o,tag:u}=h.currCode;d+="-";let l=0;switch(void 0!==r&&(l|=t.pictureNumberShape.indexOf(r)<<8),n&&(l|=32768),void 0!==a&&(l|=t.pictureCalendar.indexOf(a)),o&&(l|=128),typeof e){case"number":{let t=e;switch(u){case void 0:break;case s.CultureTag.GenLower:t|=64512;break;case s.CultureTag.GenUpper:t|=63488;break;case s.CultureTag.NomLower:t|=62464;break;default:(0,i.assertFalse)("calc.numfmt.NumberFormatImpl: printCodes lcid2")}let r=se(l<<16|t);/^[a-f]{1,7}$/i.test(r)&&(r="0"+r),d+=r;break}case"string":d+=e,void 0!==u&&(""!==e&&(d+="-"),d+="x-",d+=String(u)),0!==l&&(d+=",",d+=se(l))}}d+=te(l.pictureSingle,a.PictureSingle.ColorEnd);break;case a.PictureSingle.Text:d+=te(l.pictureSingle,a.PictureSingle.Text);break;case X.LatinDate:d+=te(l.pictureSingle,a.PictureSingle.BidiDate)+"1";break;case X.BidiDate:d+=te(l.pictureSingle,a.PictureSingle.BidiDate)+"2";break;case Se.FracSeconds:d+=te(l.pictureSingle,a.PictureSingle.Decimal)+(0,g.repeat)("0",h.rounding);break;case Se.DateSep:d+=te(l.pictureSingle,a.PictureSingle.DateSep);break;case Se.TimeSep:d+=te(l.pictureSingle,a.PictureSingle.Colon);break;case a.PictureSingle.Era:case a.PictureSingle.EraYear:case a.PictureSingle.Year:case a.PictureSingle.YearTh:case a.PictureSingle.EngYearTh:case a.PictureSingle.ThYear:case a.PictureSingle.Month:case a.PictureSingle.MonthTh:case a.PictureSingle.Day:case a.PictureSingle.DayTh:case a.PictureSingle.LocDay:d+=(0,g.repeat)(te(l.pictureSingle,h.kind),h.count);break;case a.PictureSingle.Hour:case a.PictureSingle.HourTh:case a.PictureSingle.Minute:case a.PictureSingle.MinuteTh:case a.PictureSingle.Second:case a.PictureSingle.SecondTh:if(h.isAbs){d+=te(l.pictureSingle,a.PictureSingle.ColorStart)+(0,g.repeat)(te(l.pictureSingle,h.kind),h.count)+te(l.pictureSingle,a.PictureSingle.ColorEnd);break}d+=(0,g.repeat)(te(l.pictureSingle,h.kind),h.count);break;case X.AMPM:case X.AMPMFE:h.kind===X.AMPMFE||l.isEastAsia||h.pictureKind===a.PictureSpecial.AP2?d+=h.tokenStr:d+=te(l.pictureSpecial,h.pictureKind);break;case Se.SysFormat:d+=this.printCodes(e,h.codeThisFormat,void 0);break;default:return(0,i.assertNever)("calc.numfmt.NumberFormatImpl: printCodes code",h)}m===c&&(d+=(0,g.repeat)(te(l.pictureSingle,a.PictureSingle.Comma),n.numThousands))}return d}countBytecodeBuffer(e){const{mathpack:t,localeInfo:r}=this.config;let n=0;for(let o=0;o<e.length;o+=1){const s=e[o];let u=1;switch(s.kind){case a.PictureSingle.Percent:case X.Numeral:case Se.Char:case a.PictureSingle.Star:case a.PictureSingle.Underscore:u+=2;break;case X.StrLit:u+=1+2*s.escaped.length;break;case Se.FracSeconds:case a.PictureSingle.Hash:case a.PictureSingle.Zero:case a.PictureSingle.Question:case X.Exp:u+=1;break;case a.PictureSingle.Hour:case a.PictureSingle.HourTh:case a.PictureSingle.Minute:case a.PictureSingle.MinuteTh:case a.PictureSingle.Second:case a.PictureSingle.SecondTh:s.isAbs&&(u+=1);break;case Se.Fraction:u+=5,void 0!==s.codeInt&&(u+=this.countBytecodeBuffer(s.codeInt)),u+=this.countBytecodeBuffer(s.codeBetween1),u+=this.countBytecodeBuffer(s.codeNumer),u+=this.countBytecodeBuffer(s.codeBetween2),u+=this.countBytecodeBuffer(s.codeDenom),void 0!==s.denomValue&&(u-=2,u+=2+2*U(t,s.denomValue).length),s.commaInt&&(u+=1);break;case Se.Exp:u+=3,u+=this.countBytecodeBuffer(s.codeMant),u+=this.countBytecodeBuffer(s.codeBetween),u+=this.countBytecodeBuffer(s.codeExp),s.commaMant&&(u+=1);break;case Se.Num:u+=3,u+=this.countBytecodeBuffer(s.codeBefore),u+=this.countBytecodeBuffer(s.code),s.comma&&(u+=1);break;case Se.SysFormat:u=0,u+=this.countBytecodeBuffer(s.codeThisFormat);break;case X.CurrCode:u+=2*((s.currencySymbol?.length??0)+1),u+=8;break;case X.AMPM:{const e=r.isEastAsia||s.pictureKind===a.PictureSpecial.AP2?ne(r,s.tokenStr):r.ampmSymbols;u+=2+2*(e[0].length+e[1].length)}break;case X.AMPMFE:case X.General:case a.PictureSingle.Decimal:case a.PictureSingle.Slash:case X.PrefixDigTh:case X.Currency:case a.PictureSingle.Text:case X.LatinDate:case X.BidiDate:case Se.DateSep:case Se.TimeSep:case a.PictureSingle.Era:case a.PictureSingle.EraYear:case a.PictureSingle.Year:case a.PictureSingle.YearTh:case a.PictureSingle.EngYearTh:case a.PictureSingle.ThYear:case a.PictureSingle.Month:case a.PictureSingle.MonthTh:case a.PictureSingle.Day:case a.PictureSingle.DayTh:case a.PictureSingle.LocDay:break;default:return(0,i.assertNever)("calc.numfmt.NumberFormatImpl: printCodes code",s)}n+=u}return n}countBytecodePart({code:e,color:t,dbnum:r,dtrRounding:n}){let a=0;return void 0!==t&&(a+=2),void 0!==r&&(a+=2),0!==n&&(a+=2),a+=this.countBytecodeBuffer(e),a}countBytecode(){let e=0;for(let t=Ce.Pos;t<=Ce.Text;t+=1){(t===Ce.Pos&&void 0!==this.condPos||t===Ce.Neg&&void 0!==this.condNeg)&&(e+=10);const r=this.parts[t];let n=!1;for(let e=Ce.Pos;e<t;e+=1)if(this.parts[e]===r){n=!0;break}n||(e+=this.countBytecodePart(r))}return e}checkBytecode(){if(this.countBytecode()>255)throw new Ne(this.notFormatString("format string too long: bytecode limit"));if(this.countBytecode()>247)throw new Ne((0,o.notImplemented)(["format string too long: close to bytecode limit"]))}getBundledLocaleInfo(e,t,r){let n=r;switch(t){case v.Calendar.GregorianUS:n=le;break;case v.Calendar.GregorianMEFrench:n=ce;break;case v.Calendar.GregorianArabic:n=de;break;case v.Calendar.GregorianXlitEnglish:n=ge;break;case v.Calendar.GregorianXlitFrench:n=me;break;case v.Calendar.UmAlQura:case v.Calendar.Hijri:break;case v.Calendar.Thai:n=he}if(void 0!==n?.culture&&""!==n.culture){const t=(0,b.getBundledLocaleInfo)(n);if(void 0===t)throw new ke(this.notImplementedCulture(e,n.culture));return t}return this.config.localeInfo}notFormatString(e){return(0,s.notFormatString)(`${e} (source=${String(this.source)}): ${this.logFormatString}`)}notImplementedCulture(e,t){const r="number"==typeof t?`lcid:${se(t)}`:`lang:${t}`;return(0,o.notImplemented)([`${e}: culture = ${r}`])}constructor(e,t){this.config=e,this.hasPercent=!1,this.hasDate=!1,this.hasTime=!1,this.posBeforeText=!0,this.onlyOneNumberPart=!0,this.parts=[void 0,void 0,void 0,void 0],this.hasTokenCurrCode=!1,void 0===t.old?(this.logFormatString=(0,E.anonymizeFormulaString)(t.formatString),this.source=t.source,this.parseString(t.formatString)):(this.hasPercent=t.old.hasPercent,this.hasDate=t.old.hasDate,this.hasTime=t.old.hasTime,this.posBeforeText=t.old.posBeforeText,this.onlyOneNumberPart=t.old.onlyOneNumberPart,this.parts=t.synth,this.hasTokenCurrCode=t.old.hasTokenCurrCode,this.thisCurrCode=t.old.thisCurrCode,this.thisCurrencySymbol=t.old.thisCurrencySymbol,this.applyCurrCode=t.old.applyCurrCode,this.condPos=t.old.condPos,this.condNeg=t.old.condNeg,this.logFormatString=t.logFormatString,this.source=s.NumberFormatSource.CustomString,this.checkBytecode()),this.formatString=this.printFormatString(),this.valueType=this.determineValueType(),this.decimals=this.determineDecimals(),this.bidiDate=this.determineBidiDate()}}t.NumberFormatImpl=Ie,t.createFormat=function(e,t,r){try{return(0,A.success)(new Ie(e.config,{old:void 0,formatString:t,source:r}))}catch(e){return e instanceof Ne?(0,A.failure)(e.reason):(0,A.failure)((0,A.javaScriptError)(e))}},t.applyFormat=function(e,t,r,n){try{let a,i,c;const{localeInfo:d}=e.config;switch(r.kind){case C.OperKind.String:a=function(e){if(0===e.length)return!1;const t=(0,u.stringCodePointAt)(e,0);return t>=1424&&t<=1535||8207===t||t>=64285&&t<=64335||t>=1536&&t<=1791||t>=1872&&t<=1919||t>=2208&&t<=2303||t>=64336&&t<=65023||t>=65136&&t<=65279}(r.value)?s.Alignment.Right:s.Alignment.Left,i=s.Clip.None,c=r;break;case C.OperKind.Number:a=t.isTextOnly?s.Alignment.Left:s.Alignment.Right,i=s.Clip.All,c=r;break;case C.OperKind.Boolean:a=s.Alignment.Center,i=s.Clip.All,c=(0,l.stringOper)(r.value?d.trueName:d.falseName);break;case C.OperKind.Blank:return(0,A.success)((0,s.formattedValue)([],void 0,s.Alignment.Left,s.Clip.All));case C.OperKind.Error:const e=d.errorNames[r.type];return null==e?(0,A.failure)((0,o.internal)(`No locale data for error type ${r.type}`)):(0,A.success)((0,s.formattedValue)([(0,s.formattedUnitString)(e)],void 0,s.Alignment.Center,s.Clip.All));case C.OperKind.Array:return(0,A.failure)((0,o.notImplemented)(["Array applyFormat"]));case C.OperKind.Rich:return(0,A.failure)((0,o.notImplemented)(["Rich applyFormat"]))}return t.apply(c,a,i,n)}catch(e){return(0,A.failure)((0,A.javaScriptError)(e))}},t.changeFormatDecimals=function(e,t){try{switch(e.valueType){case s.FormatValueType.General:return(0,A.failure)((0,o.notImplemented)(["changeDecimals General"]));case s.FormatValueType.Number:case s.FormatValueType.Currency:case s.FormatValueType.Accounting:case s.FormatValueType.Percentage:case s.FormatValueType.Scientific:if(0===e.decimals&&t<0)return A.successUndefined;const r=(0,h.fastMax)(0,e.decimals+t),n=e.synthesizeDecimals(r);return n.formatString===e.formatString?A.successUndefined:(0,A.success)(n);default:return A.successUndefined}}catch(e){return(0,A.failure)((0,A.javaScriptError)(e))}}},64562:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.util=t.unicode=t.testData=t.serviceTypes=t.ribbonFormat=t.render=t.parsedate=t.parseconst=t.parse=t.localeData=t.knownFormat=t.impl=t.formulaBar=t.formatService=t.eval=t.edit=t.PackageName=void 0;const n=r(74643);t.PackageName="excel-online-calc-numfmt",t.edit=n.__importStar(r(65556)),t.eval=n.__importStar(r(12914)),t.formatService=n.__importStar(r(74556)),t.formulaBar=n.__importStar(r(555)),t.impl=n.__importStar(r(41990)),t.knownFormat=n.__importStar(r(44442)),t.localeData=n.__importStar(r(83542)),t.parse=n.__importStar(r(44945)),t.parseconst=n.__importStar(r(78894)),t.parsedate=n.__importStar(r(78781)),t.render=n.__importStar(r(99188)),t.ribbonFormat=n.__importStar(r(29787)),t.serviceTypes=n.__importStar(r(31828)),t.testData=n.__importStar(r(84980)),t.unicode=n.__importStar(r(17585)),t.util=n.__importStar(r(16700))},44442:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.englishXLSXKnownFormat=t.isKnownFormatDefined=t.getKnownFormat=t.buildNumShapeDateTimeFormat=t.buildNumShapeConstFormat=t.buildMMDDYYFormat=t.buildSingle=t.buildCurrencyFormat=t.buildFractionFormat=t.buildQuoted=t.buildScientificFormat=t.buildPercentFormat=t.buildNumberFormat=t.getColor=t.getSingle=t.getSpecial=void 0;const n=r(34284),a=r(34284),i=r(74837),o=r(74837),s=r(17585),u=r(25969),l=r(60888),c=r(41990),d=r(14587);function g(e,t){const r=e.pictureSpecial[t]??i.englishPictureSpecial[t];return(0,u.assertTrue)("calc.numfmt.knownFormat: getSpecial",void 0!==r),r}function m(e,t){const r=e.pictureSingle[t]??i.englishPictureSingle[t];return(0,u.assertTrue)("calc.numfmt.knownFormat: getSingle",void 0!==r),r}function h(e,t){const r=e.pictureColor[t]??i.englishPictureColor[t];return(0,u.assertTrue)("calc.numfmt.knownFormat: getColor",void 0!==r),r}function p(e,t,r,n){let a="";if(r>1){const n=(0,l.repeat)(m(e,i.PictureSingle.Hash),r-1);a+=t?(0,s.insertCommas)({isThousandsPosition:e=>e>0&&e%3==0,thousandsSeparator:m(e,i.PictureSingle.Comma)},n,1):n}return a+="0",n>0&&(a+=m(e,i.PictureSingle.Decimal),a+=(0,l.repeat)("0",n)),a}function f(e,t){let r="";return r+="0",t>0&&(r+=m(e,i.PictureSingle.Decimal),r+=(0,l.repeat)("0",t)),e.isPercentSepBySpace&&(r+=m(e,i.PictureSingle.Space)),r+=m(e,i.PictureSingle.Percent),r}function S(e,t,r,n){let a="";return a+=p(e,!1,t,r),e.isExpSepBySpace&&(a+=m(e,i.PictureSingle.Space)),a+=m(e,i.PictureSingle.E),a+="+",a+=(0,l.repeat)("0",n),a}function v(e,t){const r=m(e,i.PictureSingle.Quote);return r+t+r}function F(e,t){let r="";r+=m(e,i.PictureSingle.Hash);const n=e.fractionSeparator;return n===m(e,i.PictureSingle.Comma)?r+=v(e,n):r+=" "===n?m(e,i.PictureSingle.Space):v(e,n),r+=(0,l.repeat)(m(e,i.PictureSingle.Question),t),r+=m(e,i.PictureSingle.Slash),r+=(0,l.repeat)(m(e,i.PictureSingle.Question),t),r}var y,C;function A(e,t){let r="";return r+=v(e,"-"),t>0&&(r+=(0,l.repeat)(m(e,i.PictureSingle.Question),t)),r}function E(e,t,r,n,o,s,u=!1){const{isCurrencySymbolLead:l,currencyFormat:c,isCurrencySepBySpace:d}=e,f=u?y.Pos:o?y.Text:y.Neg,S=p(e,!0,4,r);let v="";for(let u=y.Pos;u<=f;u+=1){u!==y.Pos&&(v+=m(e,i.PictureSingle.Sep)),u===y.Neg&&t&&(v+=m(e,i.PictureSingle.ColorStart)+h(e,i.PictureColor.Red)+m(e,i.PictureSingle.ColorEnd));const p=()=>u===y.Zero?A(e,r):u===y.Text?m(e,i.PictureSingle.Text):S,f=()=>u!==y.Text?b(e,i.PictureSingle.Star,i.PictureSingle.Space):"",F=()=>{let t="";if(l)switch(c){case a.CurrencyFormat.Paren:t+=b(e,i.PictureSingle.Underscore,i.PictureSingle.OpenParen);break;case a.CurrencyFormat.Trail:t+=b(e,i.PictureSingle.Underscore,i.PictureSingle.Minus);break;case a.CurrencyFormat.Intern:t+=b(e,i.PictureSingle.Underscore,i.PictureSingle.Space)}else{switch(c){case a.CurrencyFormat.Trail:t+=b(e,i.PictureSingle.Underscore,i.PictureSingle.Minus);break;case a.CurrencyFormat.Paren:case a.CurrencyFormat.Intern:t+=b(e,i.PictureSingle.Underscore,i.PictureSingle.Space)}c!==a.CurrencyFormat.Lead&&(t+=f())}return t},C=()=>{if(l)switch(c){case a.CurrencyFormat.Lead:return b(e,i.PictureSingle.Underscore,i.PictureSingle.Minus);case a.CurrencyFormat.Intern:return b(e,i.PictureSingle.Underscore,i.PictureSingle.Space)}else switch(c){case a.CurrencyFormat.Lead:return b(e,i.PictureSingle.Underscore,i.PictureSingle.Minus);case a.CurrencyFormat.Paren:case a.CurrencyFormat.Intern:return b(e,i.PictureSingle.Underscore,i.PictureSingle.Space)}return""},E=()=>u===y.Neg?m(e,i.PictureSingle.OpenParen):"",R=()=>u!==y.Text||l?u===y.Neg?m(e,i.PictureSingle.CloseParen):b(e,i.PictureSingle.Underscore,i.PictureSingle.CloseParen):"",T=()=>{let t="";if(u!==y.Neg)switch(c){case a.CurrencyFormat.Intern:l||u===y.Text||(t+=b(e,i.PictureSingle.Underscore,i.PictureSingle.Minus));break;case a.CurrencyFormat.Lead:case a.CurrencyFormat.Trail:if(c===a.CurrencyFormat.Lead&&!o)break;t+=b(e,i.PictureSingle.Underscore,i.PictureSingle.Minus)}else t+=m(e,i.PictureSingle.Minus);return o&&!l&&c===a.CurrencyFormat.Lead&&(t+=f()),t},k=()=>{let t="";return n&&!l&&d&&(t+=m(e,i.PictureSingle.Space)),n&&(t+=s??g(e,i.PictureSpecial.Currency)),l&&d&&(t+=m(e,i.PictureSingle.Space)),t},N=()=>{let e="";return u!==y.Text&&(l?(n&&(e+=k()),o&&(e+=f())):e+=k()),e};if(o&&(v+=F()),l)switch(c){case a.CurrencyFormat.Paren:o||(v+=E()),v+=N(),o&&(v+=E()),v+=p(),v+=R();break;case a.CurrencyFormat.Lead:v+=T(),v+=N(),v+=p();break;case a.CurrencyFormat.Intern:v+=N(),v+=T(),v+=p();break;case a.CurrencyFormat.Trail:v+=N(),v+=p(),v+=T()}else switch(c){case a.CurrencyFormat.Paren:v+=E(),v+=p(),o&&(v+=R()),v+=N(),o||(v+=R());break;case a.CurrencyFormat.Lead:v+=T(),v+=p(),v+=N();break;case a.CurrencyFormat.Intern:v+=p(),v+=T(),v+=N();break;case a.CurrencyFormat.Trail:v+=p(),v+=N(),v+=T()}o&&(v+=C())}return v}function b(e,...t){return t.map((t=>"string"==typeof t?t:m(e,t))).join("")}t.getSpecial=g,t.getSingle=m,t.getColor=h,t.buildNumberFormat=p,t.buildPercentFormat=f,t.buildScientificFormat=S,t.buildQuoted=v,t.buildFractionFormat=F,function(e){e[e.Pos=0]="Pos",e[e.Neg=1]="Neg",e[e.Zero=2]="Zero",e[e.Text=3]="Text"}(y||(y={})),t.buildCurrencyFormat=E,t.buildSingle=b,function(e){e[e.Day=0]="Day",e[e.Month=1]="Month",e[e.Year=2]="Year"}(C||(C={}));const R={[a.DateOrder.MDY]:[C.Month,C.Day,C.Year],[a.DateOrder.DMY]:[C.Day,C.Month,C.Year],[a.DateOrder.YMD]:[C.Year,C.Month,C.Day],[a.DateOrder.MYD]:[C.Month,C.Year,C.Day],[a.DateOrder.DYM]:[C.Day,C.Year,C.Month],[a.DateOrder.YDM]:[C.Year,C.Day,C.Month]};function T(e,t){return b(e,(t?e.hour2Digits&&!e.clock24Hour:e.hour2Digits)?i.PictureSingle.Hour:"",i.PictureSingle.Hour,i.PictureSingle.Colon,i.PictureSingle.Minute,i.PictureSingle.Minute)}function k(e,t){return T(e,t)+b(e,i.PictureSingle.Colon,i.PictureSingle.Second,i.PictureSingle.Second)}function N(e){let t="";return e.isAMPMSepBySpace&&(t+=m(e,i.PictureSingle.Space)),t+=g(e,i.PictureSpecial.AP1),t}function I(e,t,r,n,a=e.year4Digits){const{month2Digits:o,day2Digits:s}=e,u=[(0,l.repeat)(t,s?2:1),(0,l.repeat)(r,o?2:1),(0,l.repeat)(n,a?4:2)],c=R[e.dateOrder];let d="";for(let t=0;t<3;t+=1)d+=u[c[t]],t<2&&(d+=m(e,i.PictureSingle.DateSep));return d}function O(e,t){const r=m(e,i.PictureSingle.Year),n=m(e,i.PictureSingle.Month);return I(e,m(e,i.PictureSingle.Day),n,r,t)}function _(e,t,r,n=i.PictureSingle.Day,a=i.PictureSingle.Month,o=i.PictureSingle.Year){const{day2Digits:s}=e,u=e.country===i.Country.GER,l="/"===e.dateSeparator&&" "!==e.dateAltSeparator;let c="";return t&&(c+=b(e,s?n:"",n),l?c+=e.dateAltSeparator:(c+=m(e,i.PictureSingle.DateSep),u&&(c+=m(e,i.PictureSingle.Space)))),c+=b(e,a,a,a),r&&(c+=l?e.dateAltSeparator:m(e,u?i.PictureSingle.Space:i.PictureSingle.DateSep),c+=b(e,o,o)),c}function P(e){return b(e,e.hour2Digits?i.PictureSingle.HourTh:"",i.PictureSingle.HourTh,i.PictureSingle.Colon,i.PictureSingle.MinuteTh,i.PictureSingle.MinuteTh)}function M(e){return I(e,m(e,i.PictureSingle.DayTh),m(e,i.PictureSingle.MonthTh),m(e,i.PictureSingle.YearTh))}function D(e,t,r){return _(e,t,r,i.PictureSingle.DayTh,i.PictureSingle.MonthTh,i.PictureSingle.YearTh)}function w(e,t){switch(t){case a.KnownFormat.General:return g(e,i.PictureSpecial.General);case a.KnownFormat.NoComFixed0:return p(e,!1,1,0);case a.KnownFormat.NoComFixed:return p(e,!1,1,2);case a.KnownFormat.Fixed0:return p(e,!0,4,0);case a.KnownFormat.Fixed:return p(e,!0,4,2);case a.KnownFormat.Currency:return E(e,!1,0,!0,!1);case a.KnownFormat.CoCurrency:return E(e,!0,0,!0,!1);case a.KnownFormat.CurrencyDec:return E(e,!1,2,!0,!1);case a.KnownFormat.CoCurrencyDec:return E(e,!0,2,!0,!1);case a.KnownFormat.Pct0:return f(e,0);case a.KnownFormat.Pct:return f(e,2);case a.KnownFormat.Exp:return S(e,1,2,2);case a.KnownFormat.Fract:return F(e,1);case a.KnownFormat.FractBond:return F(e,2);case a.KnownFormat.MMDDYY:return O(e);case a.KnownFormat.DDMMMYY:return _(e,!0,!0);case a.KnownFormat.DDMMM:return _(e,!0,!1);case a.KnownFormat.MMMYY:return _(e,!1,!0);case a.KnownFormat.HHMMAP:return T(e,!0)+N(e);case a.KnownFormat.HHMMSSAP:return k(e,!0)+N(e);case a.KnownFormat.HHMM:return T(e,!1);case a.KnownFormat.HHMMSS:return k(e,!1);case a.KnownFormat.MDYHMS:return b(e,O(e),i.PictureSingle.Space,T(e,!1));case a.KnownFormat.USCoCurrency:case a.KnownFormat.USCoCurrencyDec:return E({...e,isCurrencySymbolLead:!0,isCurrencySepBySpace:!1,currencyFormat:a.CurrencyFormat.Paren},!0,t===a.KnownFormat.USCoCurrencyDec?2:0,!0,!1,e.isChinaT?v(e,"US$"):"$");case a.KnownFormat.Currency2:return E(e,!1,0,!1,!1);case a.KnownFormat.CoCurrency2:return E(e,!0,0,!1,!1);case a.KnownFormat.CurrencyDec2:return E(e,!1,2,!1,!1);case a.KnownFormat.CoCurrencyDec2:return E(e,!0,2,!1,!1);case a.KnownFormat.Acct:return E(e,!1,0,!1,!0);case a.KnownFormat.AcctDec:return E(e,!1,2,!1,!0);case a.KnownFormat.AcctCur:return E(e,!1,0,!0,!0);case a.KnownFormat.AcctDecCur:return E(e,!1,2,!0,!0);case a.KnownFormat.MMSS:return b(e,i.PictureSingle.Minute,i.PictureSingle.Minute,i.PictureSingle.Colon,i.PictureSingle.Second,i.PictureSingle.Second);case a.KnownFormat.AbsHMMSS:return b(e,i.PictureSingle.ColorStart,i.PictureSingle.Hour,i.PictureSingle.ColorEnd,i.PictureSingle.Colon,i.PictureSingle.Minute,i.PictureSingle.Minute,i.PictureSingle.Colon,i.PictureSingle.Second,i.PictureSingle.Second);case a.KnownFormat.SS0:return b(e,i.PictureSingle.Minute,i.PictureSingle.Minute,i.PictureSingle.Colon,i.PictureSingle.Second,i.PictureSingle.Second,i.PictureSingle.Decimal,"0");case a.KnownFormat.Eng:return S(e,3,1,1);case a.KnownFormat.Text:return m(e,i.PictureSingle.Text);case a.KnownFormat.NoComFixed0_Tha:return"t"+p(e,!1,1,0);case a.KnownFormat.NoComFixed_Tha:return"t"+p(e,!1,1,2);case a.KnownFormat.Fixed0_Tha:return"t"+p(e,!0,4,0);case a.KnownFormat.Fixed_Tha:return"t"+p(e,!0,4,2);case a.KnownFormat.CoCurrency_Tha:case a.KnownFormat.CoCurrencyDec_Tha:return E({...e,isCurrencySymbolLead:!0,isCurrencySepBySpace:!1,currencyFormat:a.CurrencyFormat.Paren},!0,t===a.KnownFormat.CoCurrencyDec_Tha?2:0,!0,!1,"t"+g(e,i.PictureSpecial.Currency));case a.KnownFormat.Pct0_Tha:return"t"+f(e,0);case a.KnownFormat.Pct_Tha:return"t"+f(e,2);case a.KnownFormat.MMDDYY_Tha:return M(e);case a.KnownFormat.DDMMMYY_Tha:return D(e,!0,!0);case a.KnownFormat.DDMMM_Tha:return D(e,!0,!1);case a.KnownFormat.MMMYY_Tha:return D(e,!1,!0);case a.KnownFormat.HHMM_Tha:return P(e);case a.KnownFormat.HHMMSS_Tha:return function(e){return P(e)+b(e,i.PictureSingle.Colon,i.PictureSingle.SecondTh,i.PictureSingle.SecondTh)}(e);case a.KnownFormat.MDYHMS_Tha:return b(e,M(e),i.PictureSingle.Space,P(e));case a.KnownFormat.AbsHMMSS_Tha:return b(e,i.PictureSingle.ColorStart,i.PictureSingle.HourTh,i.PictureSingle.ColorEnd,i.PictureSingle.Colon,i.PictureSingle.MinuteTh,i.PictureSingle.MinuteTh,i.PictureSingle.Colon,i.PictureSingle.SecondTh,i.PictureSingle.SecondTh);case a.KnownFormat.MMSS_Tha:return b(e,i.PictureSingle.MinuteTh,i.PictureSingle.MinuteTh,i.PictureSingle.Colon,i.PictureSingle.SecondTh,i.PictureSingle.SecondTh);case a.KnownFormat.SS0_Tha:return b(e,i.PictureSingle.MinuteTh,i.PictureSingle.MinuteTh,i.PictureSingle.Colon,i.PictureSingle.SecondTh,i.PictureSingle.SecondTh,i.PictureSingle.Decimal,"0");case a.KnownFormat.DMBB_Tha:return I(e,m(e,i.PictureSingle.Day),m(e,i.PictureSingle.Month),m(e,i.PictureSingle.EngYearTh),!1);default:return(0,u.assertNever)("calc.numfmt.getKnownFormat",t)}}t.buildMMDDYYFormat=O,t.buildNumShapeConstFormat=function(e,t,r,s,g,h,S,v){const F=c.pictureNumberShape.indexOf(r)<<24|function(e){switch(e){case n.NumberShape.ArabicIndic:case n.NumberShape.ExtendedArabicIndic:return o.LCID.Arabic;case n.NumberShape.Devanagari:return o.LCID.Hindi;case n.NumberShape.Bengali:return 1093;case n.NumberShape.Gurmukhi:return 1094;case n.NumberShape.Gujarati:return 1095;case n.NumberShape.Oriya:return 1096;case n.NumberShape.Tamil:return o.LCID.Tamil;case n.NumberShape.Telugu:return 1098;case n.NumberShape.Kannada:return 1099;case n.NumberShape.Malayalam:return 1100;case n.NumberShape.Thai:return o.LCID.Thailand;case n.NumberShape.Lao:return 1108;case n.NumberShape.Tibetan:return 1105;case n.NumberShape.Myanmar:return 1109;case n.NumberShape.Ethiopic:return 1118;case n.NumberShape.Khmer:return 1107;case n.NumberShape.Mongolian:return 1104;case n.NumberShape.ASCII:case n.NumberShape.ChineseTrad1:case n.NumberShape.ChineseTrad2:case n.NumberShape.ChineseTrad3:case n.NumberShape.ChineseSimp1:case n.NumberShape.ChineseSimp2:case n.NumberShape.ChineseSimp3:case n.NumberShape.Japanese1:case n.NumberShape.Japanese2:case n.NumberShape.Japanese3:case n.NumberShape.Korean1:case n.NumberShape.Korean2:case n.NumberShape.Korean3:case n.NumberShape.Korean4:return 0;default:return(0,u.assertNever)("calc.numfmt.lcidFromNumShape",e)}}(r);let y=S;if((s||g)&&(y=2),y=(0,d.fastMin)(y,14),s){const t=b(e,i.PictureSingle.ColorStart,"$"+e.currencySymbol+"-"+F.toString(16).toUpperCase(),i.PictureSingle.ColorEnd);return E({...e,isCurrencySymbolLead:!0,isCurrencySepBySpace:!1,currencyFormat:a.CurrencyFormat.Paren},!0,2,!0,!1,t).replace(t,(()=>t+m(e,i.PictureSingle.Space)))}const C=b(e,i.PictureSingle.ColorStart,"$-"+F.toString(16).toUpperCase(),i.PictureSingle.ColorEnd);if(g)return C+f({...e,isPercentSepBySpace:!1},2);if(h)return C+p(e,!0,4,y);const A=t.formatGeneral(e,v,11),R=A.indexOf("E");if(R>=0){const t=A.substring(0,R),r=t.indexOf(e.decimalSeparator)>=0,n=t.replace(e.decimalSeparator,"").length,a=A.substring(R+2).length;return C+b(e,"0",y>0&&!r?"":i.PictureSingle.Decimal,(0,l.repeat)(m(e,i.PictureSingle.Hash),n-1),i.PictureSingle.E,y>0?"-":"+",(0,l.repeat)("0",a))}return C+b(e,"0",y>0?i.PictureSingle.Decimal:"",(0,l.repeat)(m(e,i.PictureSingle.Hash),y))},t.buildNumShapeDateTimeFormat=function(e,t,r){return b(e,i.PictureSingle.ColorStart,"$-"+(c.pictureNumberShape.indexOf(t)<<24).toString(16).toUpperCase(),i.PictureSingle.ColorEnd)+w(e,r)},t.getKnownFormat=w,t.isKnownFormatDefined=function(e,t){return e<=a.KnownFormat.General&&e>=a.KnownFormat.AcctDec||(e<=-1e3&&e>=-1099?t.isEastAsia:e<=-1100&&e>=-1199?t.isJapan:e<=-1200&&e>=-1299?t.isKorea:e<=-1300&&e>=-1399?t.isChinaT:e<=-1400&&e>=-1499?t.isChinaS:e<=-2e3&&e>=-2099?t.isThai:(0,u.assertFalse)("calc.numfmt.isKnownFormatDefined"))},t.englishXLSXKnownFormat={0:a.KnownFormat.General,1:a.KnownFormat.NoComFixed0,2:a.KnownFormat.NoComFixed,3:a.KnownFormat.Fixed0,4:a.KnownFormat.Fixed,5:a.KnownFormat.Currency,6:a.KnownFormat.CoCurrency,7:a.KnownFormat.CurrencyDec,8:a.KnownFormat.CoCurrencyDec,9:a.KnownFormat.Pct0,10:a.KnownFormat.Pct,11:a.KnownFormat.Exp,12:a.KnownFormat.Fract,13:a.KnownFormat.FractBond,14:a.KnownFormat.MMDDYY,15:a.KnownFormat.DDMMMYY,16:a.KnownFormat.DDMMM,17:a.KnownFormat.MMMYY,18:a.KnownFormat.HHMMAP,19:a.KnownFormat.HHMMSSAP,20:a.KnownFormat.HHMM,21:a.KnownFormat.HHMMSS,22:a.KnownFormat.MDYHMS,37:a.KnownFormat.Currency2,38:a.KnownFormat.CoCurrency2,39:a.KnownFormat.CurrencyDec2,40:a.KnownFormat.CoCurrencyDec2,41:a.KnownFormat.Acct,42:a.KnownFormat.AcctCur,43:a.KnownFormat.AcctDec,44:a.KnownFormat.AcctDecCur,45:a.KnownFormat.MMSS,46:a.KnownFormat.AbsHMMSS,47:a.KnownFormat.SS0,48:a.KnownFormat.Eng,49:a.KnownFormat.Text}},74837:function(e,t,r){"use strict";const n=r(84817);e.exports=n.config},18642:function(e,t,r){"use strict";const n=r(84817);e.exports=n.datepack},55929:function(e,t,r){"use strict";const n=r(84817);e.exports=n.formulaModule},77409:function(e,t,r){"use strict";const n=r(84817);e.exports=n.literalParse},1824:function(e,t,r){"use strict";const n=r(84817);e.exports=n.mathpack},34284:function(e,t,r){"use strict";const n=r(84817);e.exports=n.numfmt},45432:function(e,t,r){"use strict";const n=r(84817);e.exports=n.resolveService},91615:function(e,t,r){"use strict";const n=r(84817);e.exports=n.resolveServiceTypes},75433:function(e,t,r){"use strict";const n=r(84817);e.exports=n.signature},70454:function(e,t,r){"use strict";const n=r(84817);e.exports=n.types},27007:function(e,t,r){"use strict";const n=r(84817);e.exports=n.util},73414:function(e,t,r){"use strict";const n=r(84817);e.exports=n.value},37081:function(e,t,r){"use strict";const n=r(84817);e.exports=n.visitor},83542:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertKnownLCID=t.getBundledLocaleInfo=void 0;const n=r(74837),a=r(25969),i={ar:[["يناير","فبراير","مارس","أبريل","مايو","يونيو","يوليو","أغسطس","سبتمبر","أكتوبر","نوفمبر","ديسمبر"],["يناير","فبراير","مارس","أبريل","مايو","يونيو","يوليو","أغسطس","سبتمبر","أكتوبر","نوفمبر","ديسمبر"],["الأحد","الإثنين","الثلاثاء","الأربعاء","الخميس","الجمعة","السبت"],["الأحد","الإثنين","الثلاثاء","الأربعاء","الخميس","الجمعة","السبت"],["ص","م"],"z"],en:[["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["AM","PM"],"z"],es:[["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","set","oct.","nov.","dic."],["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],["do.","lu.","ma.","mi.","ju.","vi.","sá."],["domingo","lunes","martes","miércoles","jueves","viernes","sábado"],["a. m.","p. m."],"z"],fr:[["janv.","févr.","mars","avr.","mai","juin","juil.","août","sept.","oct.","nov.","déc."],["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],"en","z"],zh:[["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],["週日","週一","週二","週三","週四","週五","週六"],["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],["上午","下午"],"s"],de:[["Jan","Feb","Mrz","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],["So","Mo","Di","Mi","Do","Fr","Sa"],["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],"en","z"],hr:[["sij","vlj","ožu","tra","svi","lip","srp","kol","ruj","lis","stu","pro"],["siječanj","veljača","ožujak","travanj","svibanj","lipanj","srpanj","kolovoz","rujan","listopad","studeni","prosinac"],["ned","pon","uto","sri","čet","pet","sub"],["nedjelja","ponedjeljak","utorak","srijeda","četvrtak","petak","subota"],"en","z"],nl:[["jan","feb","mrt","apr","mei","jun","jul","aug","sep","okt","nov","dec"],["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],["zo","ma","di","wo","do","vr","za"],["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"],"en","z"],sv:[["jan","feb","mar","apr","maj","jun","jul","aug","sep","okt","nov","dec"],["januari","februari","mars","april","maj","juni","juli","augusti","september","oktober","november","december"],["sön","mån","tis","ons","tor","fre","lör"],["söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag"],"en","z"],it:[["gen","feb","mar","apr","mag","giu","lug","ago","set","ott","nov","dic"],["gennaio","febbraio","marzo","aprile","maggio","giugno","luglio","agosto","settembre","ottobre","novembre","dicembre"],["dom","lun","mar","mer","gio","ven","sab"],["domenica","lunedì","martedì","mercoledì","giovedì","venerdì","sabato"],"en","z"],ro:[["ian.","feb.","mar.","apr.","mai","iun.","iul.","aug.","sept.","oct.","nov.","dec."],["ianuarie","februarie","martie","aprilie","mai","iunie","iulie","august","septembrie","octombrie","noiembrie","decembrie"],["dum.","lun.","mar.","mie.","joi","vin.","sâm."],["duminică","luni","marți","miercuri","joi","vineri","sâmbătă"],["a.m.","p.m."],"z"],ru:[["янв","фев","мар","апр","май","июн","июл","авг","сен","окт","ноя","дек"],["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],["воскресенье","понедельник","вторник","среда","четверг","пятница","суббота"],"en","z"],sr:[["jan","feb","mar","apr","maj","jun","jul","avg","sep","okt","nov","dec"],["januar","februar","mart","april","maj","jun","jul","avgust","septembar","oktobar","novembar","decembar"],["ned","pon","uto","sre","čet","pet","sub"],["nedelja","ponedeljak","utorak","sreda","četvrtak","petak","subota"],["pre podne","po podne"],"z"],uk:[["Січ","Лют","Бер","Кві","Тра","Чер","Лип","Сер","Вер","Жов","Лис","Гру"],["січень","лютий","березень","квітень","травень","червень","липень","серпень","вересень","жовтень","листопад","грудень"],["Нд","Пн","Вт","Ср","Чт","Пт","Сб"],["неділя","понеділок","вівторок","середа","четвер","п'ятниця","субота"],"en","z"],bg:[["яну","фев","мар","апр","май","юни","юли","авг","сеп","окт","ное","дек"],["януари","февруари","март","април","май","юни","юли","август","септември","октомври","ноември","декември"],["нед","пон","вт","ср","четв","пет","съб"],["неделя","понеделник","вторник","сряда","четвъртък","петък","събота"],"en","z"],cs:[["I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII"],["leden","únor","březen","duben","květen","červen","červenec","srpen","září","říjen","listopad","prosinec"],["ne","po","út","st","čt","pá","so"],["neděle","pondělí","úterý","středa","čtvrtek","pátek","sobota"],["dop.","odp."],"z"],da:["sv",["januar","februar","marts","april","maj","juni","juli","august","september","oktober","november","december"],["sø","ma","ti","on","to","fr","lø"],["søndag","mandag","tirsdag","onsdag","torsdag","fredag","lørdag"],"sv","z"],el:[["Ιαν","Φεβ","Μαρ","Απρ","Μαϊ","Ιουν","Ιουλ","Αυγ","Σεπ","Οκτ","Νοε","Δεκ"],["Ιανουάριος","Φεβρουάριος","Μάρτιος","Απρίλιος","Μάιος","Ιούνιος","Ιούλιος","Αύγουστος","Σεπτέμβριος","Οκτώβριος","Νοέμβριος","Δεκέμβριος"],["Κυρ","Δευ","Τρι","Τετ","Πεμ","Παρ","Σαβ"],["Κυριακή","Δευτέρα","Τρίτη","Τετάρτη","Πέμπτη","Παρασκευή","Σάββατο"],["πμ","μμ"],"z"],et:[["jaan","veebr","märts","apr","mai","juuni","juuli","aug","sept","okt","nov","dets"],["jaanuar","veebruar","märts","aprill","mai","juuni","juuli","august","september","oktoober","november","detsember"],["P","E","T","K","N","R","L"],["pühapäev","esmaspäev","teisipäev","kolmapäev","neljapäev","reede","laupäev"],"en","z"],fi:[["tammi","helmi","maalis","huhti","touko","kesä","heinä","elo","syys","loka","marras","joulu"],["tammikuu","helmikuu","maaliskuu","huhtikuu","toukokuu","kesäkuu","heinäkuu","elokuu","syyskuu","lokakuu","marraskuu","joulukuu"],["su","ma","ti","ke","to","pe","la"],["sunnuntai","maanantai","tiistai","keskiviikko","torstai","perjantai","lauantai"],["ap.","ip."],"z"],he:[["ינו","פבר","מרץ","אפר","מאי","יונ","יול","אוג","ספט","אוק","נוב","דצמ"],["ינואר","פברואר","מרץ","אפריל","מאי","יוני","יולי","אוגוסט","ספטמבר","אוקטובר","נובמבר","דצמבר"],["יום א","יום ב","יום ג","יום ד","יום ה","יום ו","שבת"],["יום ראשון","יום שני","יום שלישי","יום רביעי","יום חמישי","יום שישי","שבת"],"en","z"],hu:[["jan.","febr.","márc.","ápr.","máj.","jún.","júl.","aug.","szept.","okt.","nov.","dec."],["január","február","március","április","május","június","július","augusztus","szeptember","október","november","december"],["V","H","K","Sze","Cs","P","Szo"],["vasárnap","hétfő","kedd","szerda","csütörtök","péntek","szombat"],["de.","du."],"z"],id:[["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agu","Sep","Okt","Nov","Des"],["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],["Mgg","Sen","Sel","Rab","Kam","Jum","Sab"],["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"],"en","z"],ja:[["1","2","3","4","5","6","7","8","9","10","11","12"],["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],["日","月","火","水","木","金","土"],["日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日"],["午前","午後"],"j"],ko:["ja",["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],["일","월","화","수","목","금","토"],["일요일","월요일","화요일","수요일","목요일","금요일","토요일"],["오전","오후"],"k"],lt:[["saus.","vas.","kov.","bal.","geg.","birž.","liep.","rugp.","rugs.","spal.","lapkr.","gruod."],["sausis","vasaris","kovas","balandis","gegužė","birželis","liepa","rugpjūtis","rugsėjis","spalis","lapkritis","gruodis"],["sk","pr","an","tr","kt","pn","št"],["sekmadienis","pirmadienis","antradienis","trečiadienis","ketvirtadienis","penktadienis","šeštadienis"],["priešpiet","popiet"],"z"],lv:[["janv.","febr.","marts","apr.","maijs","jūn.","jūl.","aug.","sept.","okt.","nov.","dec."],["janvāris","februāris","marts","aprīlis","maijs","jūnijs","jūlijs","augusts","septembris","oktobris","novembris","decembris"],["svētd.","pirmd.","otrd.","trešd.","ceturtd.","piektd.","sestd."],["svētdiena","pirmdiena","otrdiena","trešdiena","ceturtdiena","piektdiena","sestdiena"],["priekšp.","pēcp."],"z"],nb:[["jan","feb","mar","apr","mai","jun","jul","aug","sep","okt","nov","des"],["januar","februar","mars","april","mai","juni","juli","august","september","oktober","november","desember"],["søn","man","tir","ons","tor","fre","lør"],"da","ro","z"],pl:[["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","paź","lis","gru"],["styczeń","luty","marzec","kwiecień","maj","czerwiec","lipiec","sierpień","wrzesień","październik","listopad","grudzień"],["niedz.","pon.","wt.","śr.","czw.","pt.","sob."],["niedziela","poniedziałek","wtorek","środa","czwartek","piątek","sobota"],"en","z"],pt:[["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],["janeiro","fevereiro","março","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"],["dom","seg","ter","qua","qui","sex","sáb"],["domingo","segunda-feira","terça-feira","quarta-feira","quinta-feira","sexta-feira","sábado"],"en","z"],sk:["ja",["január","február","marec","apríl","máj","jún","júl","august","september","október","november","december"],["ne","po","ut","st","št","pi","so"],["nedeľa","pondelok","utorok","streda","štvrtok","piatok","sobota"],"en","z"],sl:[["jan.","feb.","mar.","apr.","maj","jun.","jul.","avg.","sep.","okt.","nov.","dec."],["januar","februar","marec","april","maj","junij","julij","avgust","september","oktober","november","december"],["ned.","pon.","tor.","sre.","čet.","pet.","sob."],["nedelja","ponedeljek","torek","sreda","četrtek","petek","sobota"],["dop.","pop."],"z"],th:[["ม.ค.","ก.พ.","มี.ค.","เม.ย.","พ.ค.","มิ.ย.","ก.ค.","ส.ค.","ก.ย.","ต.ค.","พ.ย.","ธ.ค."],["มกราคม","กุมภาพันธ์","มีนาคม","เมษายน","พฤษภาคม","มิถุนายน","กรกฎาคม","สิงหาคม","กันยายน","ตุลาคม","พฤศจิกายน","ธันวาคม"],["อา.","จ.","อ.","พ.","พฤ.","ศ.","ส."],["อาทิตย์","จันทร์","อังคาร","พุธ","พฤหัสบดี","ศุกร์","เสาร์"],"en","z"],tr:[["Oca","Şub","Mar","Nis","May","Haz","Tem","Ağu","Eyl","Eki","Kas","Ara"],["Ocak","Şubat","Mart","Nisan","Mayıs","Haziran","Temmuz","Ağustos","Eylül","Ekim","Kasım","Aralık"],["Paz","Pzt","Sal","Çar","Per","Cum","Cmt"],["Pazar","Pazartesi","Salı","Çarşamba","Perşembe","Cuma","Cumartesi"],["ÖÖ","ÖS"],"z"],vi:[["Thg1","Thg2","Thg3","Thg4","Thg5","Thg6","Thg7","Thg8","Thg9","Thg10","Thg11","Thg12"],["Tháng Giêng","Tháng Hai","Tháng Ba","Tháng Tư","Tháng Năm","Tháng Sáu","Tháng Bảy","Tháng Tám","Tháng Chín","Tháng Mười","Tháng Mười Một","Tháng Mười Hai"],["CN","T2","T3","T4","T5","T6","T7"],["Chủ Nhật","Thứ Hai","Thứ Ba","Thứ Tư","Thứ Năm","Thứ Sáu","Thứ Bảy"],["SA","CH"],"z"],ta:[["ஜனவரி","பிப்ரவரி","மார்ச்","ஏப்ரல்","மே","ஜூன்","ஜூலை","ஆகஸ்ட்","செப்டம்பர்","அக்டோபர்","நவம்பர்","டிசம்பர்"],["ஜனவரி","பிப்ரவரி","மார்ச்","ஏப்ரல்","மே","ஜூன்","ஜூலை","ஆகஸ்ட்","செப்டம்பர்","அக்டோபர்","நவம்பர்","டிசம்பர்"],["ஞாயிறு","திங்கள்","செவ்வாய்","புதன்","வியாழன்","வெள்ளி","சனி"],["ஞாயிற்றுக்கிழமை","திங்கள்கிழமை","செவ்வாய்க்கிழமை","புதன்கிழமை","வியாழக்கிழமை","வெள்ளிக்கிழமை","சனிக்கிழமை"],["காலை","மாலை"],"z"],syr:[["܏ܟܢ ܏ܒ","ܫܒܛ","ܐܕܪ","ܢܝܣܢ","ܐܝܪ","ܚܙܝܪܢ","ܬܡܘܙ","ܐܒ","ܐܝܠܘܠ","܏ܬܫ ܏ܐ","܏ܬܫ ܏ܒ","܏ܟܢ ܏ܐ"],["ܟܢܘܢ ܐܚܪܝ","ܫܒܛ","ܐܕܪ","ܢܝܣܢ","ܐܝܪ","ܚܙܝܪܢ","ܬܡܘܙ","ܐܒ","ܐܝܠܘܠ","ܬܫܪܝ ܩܕܝܡ","ܬܫܪܝ ܐܚܪܝ","ܟܢܘܢ ܩܕܝܡ"],["܏ܐ ܏ܒܫ","܏ܒ ܏ܒܫ","܏ܓ ܏ܒܫ","܏ܕ ܏ܒܫ","܏ܗ ܏ܒܫ","܏ܥܪܘܒ","܏ܫܒ"],["ܚܕ ܒܫܒܐ","ܬܪܝܢ ܒܫܒܐ","ܬܠܬܐ ܒܫܒܐ","ܐܪܒܥܐ ܒܫܒܐ","ܚܡܫܐ ܒܫܒܐ","ܥܪܘܒܬܐ","ܫܒܬܐ"],["ܩ.ܛ","ܒ.ܛ"],"z"],eu:[["urt.","ots.","mar.","api.","mai.","eka.","uzt.","abu.","ira.","urr.","aza.","abe."],["urtarrila","otsaila","martxoa","apirila","maiatza","ekaina","uztaila","abuztua","iraila","urria","azaroa","abendua"],["ig.","al.","ar.","az.","og.","or.","lr."],["igandea","astelehena","asteartea","asteazkena","osteguna","ostirala","larunbata"],"en","z"],be:[["студз","лют","сак","крас","май","чэрв","ліп","жн","вер","кастр","ліст","снеж"],["студзень","люты","сакавік","красавік","май","чэрвень","ліпень","жнівень","верасень","кастрычнік","лістапад","снежань"],["нд","пн","аўт","ср","чц","пт","сб"],["нядзеля","панядзелак","аўторак","серада","чацвер","пятніца","субота"],"en","z"],dv:[["ޖަނަވަރީ","ފެބްރުއަރީ","މާރޗް","އޭޕްރިލް","މެއި","ޖޫން","ޖުލައި","އޮގަސްޓް","ސެޕްޓެމްބަރ","އޮކްޓޯބަރ","ނޮވެމްބަރ","ޑިސެމްބަރ"],["ޖަނަވަރީ","ފެބްރުއަރީ","މާރޗް","އޭޕްރިލް","މެއި","ޖޫން","ޖުލައި","އޮގަސްޓް","ސެޕްޓެމްބަރ","އޮކްޓޯބަރ","ނޮވެމްބަރ","ޑިސެމްބަރ"],["އާދީއްތަ","ހޯމަ","އަންގާރަ","ބުދަ","ބުރާސްފަތި","ހުކުރު","ހޮނިހިރު"],["އާދީއްތަ","ހޯމަ","އަންގާރަ","ބުދަ","ބުރާސްފަތި","ހުކުރު","ހޮނިހިރު"],["މކ","މފ"],"z"],hi:[["जनवरी","फरवरी","मार्च","अप्रैल","मई","जून","जुलाई","अगस्त","सितम्बर","अक्तूबर","नवम्बर","दिसम्बर"],["जनवरी","फरवरी","मार्च","अप्रैल","मई","जून","जुलाई","अगस्त","सितम्बर","अक्तूबर","नवम्बर","दिसम्बर"],["रवि.","सोम.","मंगल.","बुध.","गुरु.","शुक्र.","शनि."],["रविवार","सोमवार","मंगलवार","बुधवार","गुरुवार","शुक्रवार","शनिवार"],["पूर्वाह्न","अपराह्न"],"z"],fil:[["Ene","Peb","Mar","Abr","May","Hun","Hul","Ago","Set","Okt","Nob","Dis"],["Enero","Pebrero","Marso","Abril","Mayo","Hunyo","Hulyo","Agosto","Setyembre","Oktubre","Nobyembre","Disyembre"],["Lin","Lun","Mar","Miy","Huw","Biy","Sab"],["Linggo","Lunes","Martes","Miyerkules","Huwebes","Biyernes","Sabado"],"en","z"],ms:[["Jan","Feb","Mac","Apr","Mei","Jun","Jul","Ogo","Sep","Okt","Nov","Dis"],["Januari","Februari","Mac","April","Mei","Jun","Julai","Ogos","September","Oktober","November","Disember"],["Ahd","Isn","Sel","Rab","Kha","Jum","Sab"],["Ahad","Isnin","Selasa","Rabu","Khamis","Jumaat","Sabtu"],["PG","PTG"],"z"],"ar-SA":"ar","ar-IQ":[["كانون الثاني","شباط","آذار","نيسان","أيار","حزيران","تموز","آب","أيلول","تشرين الأول","تشرين الثاني","كانون الأول"],["كانون الثاني","شباط","آذار","نيسان","أيار","حزيران","تموز","آب","أيلول","تشرين الأول","تشرين الثاني","كانون الأول"],"ar","ar","ar","z"],"ar-DZ":"ar","ar-EG":"ar","en-US":"en","en-AU":"en","en-BZ":"en","en-CA":"en","en-029":"en","en-HK":"en","en-IN":"en","en-ID":"en","en-IE":"en","en-JM":"en","en-MY":"en","en-NZ":"en","en-PH":"en","en-SG":"en","en-ZA":"en","en-TT":"en","en-GB":"en","en-ZW":"en","en-AS":"en","en-KE":"en","en-KW":"en","en-NL":"en","en-CH":"en","en-001":"en","en-VU":"en","en-MX":"en","en-IO":"en","en-IL":"en","en-PK":"en","en-NG":"en","en-UK":"en","es-ES":[["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","sep.","oct.","nov.","dic."],"es","es","es","en","z"],"es-AR":["es-ES","es",["dom.","lun.","mar.","mié.","jue.","vie.","sáb."],"es",["a. m.","p. m."],"z"],"es-BO":["es-ES","es","es-AR","es","es-AR","z"],"es-CL":[["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","sept.","oct.","nov.","dic."],"es","es-AR","es","es-AR","z"],"es-CO":["es-ES","es","es-AR","es","es-AR","z"],"es-CR":["es-ES","es","es-AR","es","es-AR","z"],"es-DO":["es-ES","es","es-AR","es","es-AR","z"],"es-EC":["es-ES","es","es-AR","es","es-AR","z"],"es-SV":["es-ES","es","es-AR","es","es-AR","z"],"es-GT":["es-ES","es","es-AR","es","es-AR","z"],"es-HN":["es-ES","es","es-AR","es","es-AR","z"],"es-419":["es-ES","es","es-AR","es","ro","z"],"es-MX":["es-ES","es","es-AR","es","es","z"],"es-NI":["es-ES","es","es-AR","es","es-AR","z"],"es-PA":["es-ES","es","es-AR","es","es-AR","z"],"es-PY":["es-CL","es","es-AR","es","es-CL","z"],"es-PE":[["Ene.","Feb.","Mar.","Abr.","May.","Jun.","Jul.","Ago.","Set.","Oct.","Nov.","Dic."],["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Setiembre","Octubre","Noviembre","Diciembre"],"es-AR","es","es-AR","z"],"es-PR":["es-ES","es","es-AR","es","es-AR","z"],"es-ES_tradnl":["es-ES","es","es","es","es-ES","z"],"es-US":[["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],"es",["dom","lun","mar","mié","jue","vie","sáb"],"es","en","z"],"es-UY":["es","es-PE","es-AR","es","es-AR","z"],"es-VE":["es-CL","es","es-AR","es","es-CL","z"],"es-CU":["es-ES","es","es-AR","es","ro","z"],"fr-FR":"fr","fr-BE":"fr","fr-CM":["fr","fr","fr","fr",["mat.","soir"],"z"],"fr-CA":"fr","fr-029":"fr","fr-CD":"fr","fr-CI":"fr","fr-HT":"fr","fr-LU":"fr","fr-ML":"fr","fr-MC":"fr","fr-MA":[["jan.","fév.","mar.","avr.","mai","jui.","juil.","août","sept.","oct.","nov.","déc."],"fr","fr","fr","en","z"],"fr-RE":"fr","fr-SN":"fr","fr-CH":"fr","zh-CN":["zh","zh",["周日","周一","周二","周三","周四","周五","周六"],"zh","zh","s"],"zh-SG":[["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],"zh","zh-CN","zh","zh","s"],"zh-HK":["zh-SG","zh","zh","zh","zh-SG","t"],"zh-MO":["zh-SG","zh","zh","zh","zh-SG","t"],"zh-TW":["zh-SG","zh","zh","zh","zh-SG","t"],"de-DE":"de","de-AT":[["Jän","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],["Jänner","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],["So.","Mo.","Di.","Mi.","Do.","Fr.","Sa."],"de","en","z"],"de-LI":[["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],"de","de-AT","de","en","z"],"de-LU":["de-LI","de","de-AT","de","de-LI","z"],"de-CH":["de-LI","de","de-AT","de","de-LI","z"],"hr-HR":"hr","hr-BA":[["sij","velj","ožu","tra","svi","lip","srp","kol","ruj","lis","stu","pro"],"hr","hr","hr","en","z"],"nl-NL":"nl","nl-BE":"nl","sv-SE":"sv","sv-FI":[["jan.","feb.","mars","apr.","maj","juni","juli","aug.","sep.","okt.","nov.","dec."],"sv","sv","sv",["fm","em"],"z"],"it-IT":"it","it-CH":"it","ro-RO":"ro","ro-MD":["ro","ro",["Du","Lu","Mar","Mie","Jo","Vi","Sâ"],"ro","ro","z"],"ru-RU":"ru","ru-MD-x-genlower":[["янв.","февр.","март","апр.","май","июнь","июль","авг.","сент.","окт.","нояб.","дек."],["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],"ru","ru","en","z"],"sr-Latn-RS":"sr","sr-Latn-BA":[["jan","feb","mart","apr","maj","jun","jul","avg","sept","okt","nov","dec"],"sr","hr","hr",["prije podne","po podne"],"z"],"sr-Latn-CS":[["jan.","feb.","mart","apr.","maj","jun","jul","avg.","sept.","okt.","nov.","dec."],"sr",["ned.","pon.","uto.","sre.","čet.","pet.","sub."],"sr","en","z"],"uk-UA-x-genlower":["uk",["січня","лютого","березня","квітня","травня","червня","липня","серпня","вересня","жовтня","листопада","грудня"],"uk","uk","uk","z"],"uk-UA":"uk","bg-BG":"bg","cs-CZ":"cs","da-DK":["sv","da","da","da","sv","z"],"el-GR":"el","et-EE":"et","fi-FI":"fi","he-IL":"he","hu-HU":"hu","id-ID":"id","ja-JP":"ja","ko-KR":["ja","ko","ko","ko","ko","k"],"lt-LT":"lt","lv-LV":"lv","nb-NO":["nb","nb","nb","da","nb","z"],"pl-PL":"pl","pt-BR":"pt","pt-PT":"pt","sk-SK":["ja","sk","sk","sk","en","z"],"sl-SI":"sl","th-TH":"th","tr-TR":"tr","vi-VN":"vi","ta-IN":"ta","syr-SY":"syr","eu-ES":"eu","be-BY-x-genlower":["be",["студзеня","лютага","сакавіка","красавіка","мая","чэрвеня","ліпеня","жніўня","верасня","кастрычніка","лістапада","снежня"],"be","be","be","z"],"be-BY":"be","dv-MV":"dv","hi-IN":"hi","fil-PH":"fil","ms-MY":"ms"};let o;t.getBundledLocaleInfo=function({culture:e,tag:t}){if("number"==typeof e)return;let r=e;return void 0!==t&&(""!==e&&(r+="-"),r+="x-"+String(t)),void 0===o&&(o=function(){const e={},t=["monthNameShort","monthNameLong","dayNameShort","dayNameLong","ampmSymbols"];for(const r of Object.keys(i)){const n=i[r];if("string"==typeof n){const t=e[n];(0,a.assertTrue)("calc.numfmt.buildBundledLocaleData: ref prior culture",void 0!==t),e[r]=t;continue}const[o,s,u,l,c]=n.slice(0,5).map(((r,n)=>{if("string"==typeof r){const i=e[r];return(0,a.assertTrue)("calc.numfmt.buildBundledLocaleData: ref prior culture 2",void 0!==i),i[t[n]]}return r})),d=n[5],g="k"===d,m="j"===d,h="t"===d,p="s"===d,f=g||m||h||p;e[r]={monthNameShort:o,monthNameLong:s,dayNameShort:u,dayNameLong:l,ampmSymbols:c,isEastAsia:f,isKorea:g,isJapan:m,isChinaT:h,isChinaS:p}}return e}()),o[r]};const s={[n.LCID.USA]:"en-US",[n.LCID.Greek]:"el-GR",[n.LCID.Hungarian]:"hu-HU",[n.LCID.Turkish]:"tr-TR",[n.LCID.Thailand]:"th-TH",[n.LCID.Vietnam]:"vi-VN",[n.LCID.Arabic]:"ar-SA",[n.LCID.Hebrew]:"he-IL",[n.LCID.Tamil]:"ta-IN",[n.LCID.Syriac]:"syr-SY",[n.LCID.Iraq]:"ar-IQ",[n.LCID.Algerian]:"ar-DZ",[n.LCID.Basque]:"eu-ES",[n.LCID.PortBrazil]:"pt-BR",[n.LCID.Croatian]:"hr-HR",[n.LCID.Czech]:"cs-CZ",[n.LCID.Danish]:"da-DK",[n.LCID.Dutch]:"nl-NL",[n.LCID.Australian]:"en-AU",[n.LCID.CanadianEnglish]:"en-CA",[n.LCID.British]:"en-GB",[n.LCID.Finnish]:"fi-FI",[n.LCID.French]:"fr-FR",[n.LCID.FrenchCanadian]:"fr-CA",[n.LCID.Italian]:"it-IT",[n.LCID.NorskBokmal]:"nb-NO",[n.LCID.NorskNynorsk]:"nn-NO",[n.LCID.Polish]:"pl-PL",[n.LCID.PortIberian]:"pt-PT",[n.LCID.Romanian]:"ro-RO",[n.LCID.Russian]:"ru-RU",[n.LCID.Ukrainian]:"uk-UA",[n.LCID.Belarusian]:"be-BY",[n.LCID.SerbianCyrillic]:"sr-Cyrl-CS",[n.LCID.SerbianLatin]:"sr-Latn-CS",[n.LCID.Slovak]:"sk-SK",[n.LCID.Slovenian]:"sl-SI",[n.LCID.SpanishModern]:"es-ES",[n.LCID.Swedish]:"sv-SE",[n.LCID.HongKong]:"zh-HK",[n.LCID.ChinaT]:"zh-TW",[n.LCID.Korea]:"ko-KR",[n.LCID.Japan]:"ja-JP",[n.LCID.China]:"zh-CN",[n.LCID.Devihi]:"dv-MV",[n.LCID.Hindi]:"hi-IN",[n.LCID.German]:"de-DE",[n.LCID.Swiss]:"fr-CH",[n.LCID.Indonesia]:"id-ID",[n.LCID.EnglishIndonesia]:"en-ID",[n.LCID.EnglishIndia]:"en-IN",[n.LCID.Singapore]:"zh-SG",[n.LCID.EnglishSingapore]:"en-SG",[n.LCID.Serbia]:"sr-RS",[n.LCID.Mexico]:"es-MX",[n.LCID.Ireland]:"en-IE",[n.LCID.EnglishZimbabwe]:"en-ZW",[n.LCID.Belgium]:"nl-BE"};t.convertKnownLCID=function(e){return"string"==typeof e?e:s[e]??e}},44945:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseDate=t.parseGeneral=void 0;const n=r(78894),a=r(78781),i=r(1585);t.parseGeneral=function(e,t,r,o,s){try{const{localeInfo:u,mathpack:l}=e.config,c=(0,n.parseConstInternal)(u,l,t,r,o,!1);return(0,i.isSuccess)(c)?void 0!==c.value?c:(0,a.parseDateInternal)((0,a.initParseDateGlobals)(e),t,void 0,s):c}catch(e){return(0,i.failure)((0,i.javaScriptError)(e))}},t.parseDate=function(e,t,r){try{return(0,a.parseDateInternal)((0,a.initParseDateGlobals)(e),t,void 0,r)}catch(e){return(0,i.failure)((0,i.javaScriptError)(e))}}},78894:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseConstInternal=void 0;const n=r(74643),a=r(77409),i=r(34284),o=r(44442),s=n.__importStar(r(27511)),u=r(1585),{codePointDollarSign:l,codePointBackslash:c,codePointPercentSign:d,codePointSpace:g,codePointLeftParen:m,codePointMinusSign:h,codePointPlusSign:p,codePointRightParen:f}=s;var S,v;function F(e,t,r,n){if(" "===t||""===t)return;const a="$"===t;if(e.isEastAsia){if(n<r.length&&r.charCodeAt(n)===l&&!a)return{currency:S.DollarUS,i:n+1};if(n+2<r.length&&0===e.stringCompareCI(r.substring(n,n+3),"US$"))return{currency:e.isChinaT?S.DollarUS:S.DollarExtra,i:n+3};if(("¥"===t&&e.isJapan||"₩"===t&&e.isKorea)&&n<r.length&&r.charCodeAt(n)===c)return{currency:S.Default,i:n+1};if(e.isChinaT&&n+2<r.length&&0===e.stringCompareCI(r.substring(n,n+3),"NT$"))return{currency:S.DollarExtra,i:n+3}}return n+t.length<=r.length&&0===e.stringCompareCI(r.substring(n,n+t.length),t)?{currency:S.Default,i:n+t.length}:void 0}function y(e,t,r,n,s,l){let c,y=0,C=!1,A=!1,E=!1,{isCurrencySymbolLead:b,currencySymbol:R}=e;s!==v.None&&(b=s===v.Lead,R="€");let T=0;for(;T<r.length;){if(void 0===c&&b){const t=F(e,R,r,T);if(void 0!==t){({currency:c,i:T}=t);continue}}const t=r.charCodeAt(T);switch(t){case d:T+=1,y+=1;continue;case g:T+=1;continue;case m:case h:case p:if(T+=1,A)return(0,u.success)(void 0);A=!0,t===m&&(C=!0),E=t!==p;continue}break}const k=(0,a.parseNumberLiteral)(e,t,r,T,!0,y>0||n,l);if(void 0===k||void 0===k.value)return(0,u.success)(void 0);T=k.i;const N=E?t.neg(k.value):k.value;for(;T<r.length;){if(void 0===c&&!b){const t=F(e,R,r,T);if(void 0!==t){({currency:c,i:T}=t);continue}}switch(r.charCodeAt(T)){case d:T+=1,y+=1;continue;case g:T+=1;continue;case f:if(T+=1,!C)return(0,u.success)(void 0);C=!1;continue}break}if(T!==r.length||C||y>1||void 0!==c&&y>0)return(0,u.success)(void 0);let I,O=k.numDigDec;if(k.consumedDecimal&&O<e.numberDecimals&&(k.consumedThousands||y>0?O=e.numberDecimals:void 0!==c&&(O=e.currencyDecimals)),void 0!==k.format)I=k.format;else if(c===S.DollarUS)I=k.consumedDecimal?i.KnownFormat.USCoCurrencyDec:i.KnownFormat.USCoCurrency;else if(c===S.DollarExtra)I=(0,o.buildCurrencyFormat)({...e,isCurrencySymbolLead:!0,isCurrencySepBySpace:!1,currencyFormat:i.CurrencyFormat.Paren},!1,k.consumedDecimal?2:0,!0,!1,e.isChinaT?(0,o.buildQuoted)(e,"NT$"):(0,o.buildQuoted)(e,"US$"));else if(k.numShape===i.NumberShape.Thai&&e.isThai)I=void 0!==c?k.consumedDecimal?i.KnownFormat.CoCurrencyDec_Tha:i.KnownFormat.CoCurrency_Tha:y>0?k.consumedDecimal?i.KnownFormat.Pct_Tha:i.KnownFormat.Pct0_Tha:k.consumedThousands?k.consumedDecimal?i.KnownFormat.Fixed_Tha:i.KnownFormat.Fixed0_Tha:k.consumedDecimal?i.KnownFormat.NoComFixed_Tha:i.KnownFormat.NoComFixed0_Tha;else if(k.numShape!==i.NumberShape.ASCII)I=(0,o.buildNumShapeConstFormat)(e,t,k.numShape,void 0!==c,y>0,k.consumedThousands,O,N);else if(void 0!==c)switch(s){case v.None:I=k.consumedDecimal?i.KnownFormat.CoCurrencyDec:i.KnownFormat.CoCurrency;break;case v.Lead:I=(0,o.buildCurrencyFormat)({...e,isCurrencySymbolLead:!0,isCurrencySepBySpace:!0,currencyFormat:i.CurrencyFormat.Lead},!0,k.consumedDecimal?2:0,!0,!1,"[$€-x-euro2]");break;case v.Trail:I=(0,o.buildCurrencyFormat)({...e,isCurrencySymbolLead:!1,isCurrencySepBySpace:!0,currencyFormat:i.CurrencyFormat.Lead},!0,k.consumedDecimal?2:0,!0,!1,"[$€-x-euro1]")}else I=y>0?k.consumedDecimal?i.KnownFormat.Pct:i.KnownFormat.Pct0:k.consumedThousands?k.consumedDecimal?i.KnownFormat.Fixed:i.KnownFormat.Fixed0:i.KnownFormat.General;return(0,u.success)({value:N,format:I})}!function(e){e[e.Default=0]="Default",e[e.DollarUS=1]="DollarUS",e[e.DollarExtra=2]="DollarExtra"}(S||(S={})),function(e){e[e.None=0]="None",e[e.Lead=1]="Lead",e[e.Trail=2]="Trail"}(v||(v={})),t.parseConstInternal=function(e,t,r,n,a,i){if(!a)return y(e,t,r,n,v.None,i);for(let a=v.None;a<=v.Trail;a+=1){const o=y(e,t,r,n,a,i);if(!(0,u.isSuccess)(o))return o;if(void 0!==o.value)return o;if(a===v.None&&r.indexOf("€")<0)break}return(0,u.success)(void 0)}},78781:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseDateInternal=t.initParseDateGlobals=void 0;const n=r(74643),a=r(74837),i=r(31828),o=r(14587),s=r(27007),u=r(27509),l=n.__importStar(r(27511)),c=r(77409),d=r(25969),g=r(34284),m=r(18642),h=r(60888),p=r(1585),f=r(44442),{codePointSlash:S,codePointSpace:v,codePointMinusSign:F,codePointColon:y}=l,C={getTime:()=>(0,d.assertFalse)("calc.numfmt.parseDateInternal: default getTime")};var A;function E(e,t){return(0,d.assertTrue)("calc.numfmt.monthToken",U(e,1,12)),{kind:A.Month,value:e,bidiDate:t}}t.initParseDateGlobals=function(e){return{config:e.config,getTime:e.getTime?.bind(e)??C.getTime}},function(e){e[e.Month=0]="Month",e[e.AMPM=1]="AMPM",e[e.Number=2]="Number"}(A||(A={}));const b=[...new Array(12)].map(((e,t)=>E(t+1))),R=e=>b[e],T=e=>E(e+1,i.BidiDate.English),k=e=>E(e+1,i.BidiDate.Lunar),[N,I]=[!0,!1].map((e=>({kind:A.AMPM,am:e}))),O=e=>0===e?N:I;function _(e,t,r){return(0,d.assertTrue)("calc.numfmt.numberToken",(0,h.isInteger)(e)&&U(e,-9999,9999)&&U(t,1,4)),{kind:A.Number,value:e,digits:t,numShape:r}}var P;!function(e){e[e.Nil=0]="Nil",e[e.Space=1]="Space",e[e.Date=2]="Date",e[e.Time=3]="Time",e[e.TimeAlt=4]="TimeAlt",e[e.FracSec=5]="FracSec",e[e.Intl1St3=6]="Intl1St3"}(P||(P={}));const M=e=>e===P.Time||e===P.TimeAlt,D=(e,t)=>e.lcid===a.LCID.Hungarian&&t===P.Date,w=e=>e<=P.Space,L=e=>e<=P.Date,x=["上午","下午"],K={[a.Country.FRN]:[["Jun",E(6)],["Jul",E(7)]],[a.Country.DUT]:[["Mrt",E(3)]],[a.Country.GER]:[["Mrz",E(3)]]},W=["محرم","صفر","ربيع الاول","ربيع الثاني","جمادى الاولى","جمادى الثانية","رجب","شعبان","رمضان","شوال","ذو القعدة","ذو الحجة"];function U(e,t,r){return e>=t&&e<=r}function G(e,t){const r=e.getTime(m.TimeGranularity.Year,t);if(!(0,p.isSuccess)(r))return r;const n=e.config,a=n.datepack.fromNum(n,r.value,m.Rounding.RoundSec);return(0,d.assertTrue)("calc.numfmt.parseDateInternal: current year fromNum",!1!==a),(0,p.success)(a.yr)}function B(e,t,r,n){return n+t.length<=r.length&&0===e.stringCompareCI(t,r.substring(n,n+t.length))}function V(e,t,r,n,a,i){const s=t.indexOf(" ",r);for(let u=0;u<n.length;u+=1){const l=n[u],c=(0,o.fastMin)(a,l.length);if(s>=0&&l.indexOf(" ")<0&&s-r>=c&&s-r<=l.length){const n=l.substring(0,s-r);if(B(e,n,t,r))return[i(u),r+n.length]}let d;for(let n=c;n<=l.length;n+=1){const a=l.substring(0,n);if(!B(e,a,t,r))break;d=r+a.length}if(void 0!==d)return[i(u),d]}}function j(e,t,r,n,a){for(let i=0;i<n.length;i+=1){const o=n[i];if(B(e,o,t,r))return[a(i),r+o.length]}}function H(e,t,r){const n=K[e.country];if(void 0!==n)for(const[a,i]of n)if(B(e,a,t,r))return[i,r+a.length];let i;if(e.isEastAsia){if(i=V(e,t,r,(0,a.getEnglishLocaleInfo)().monthNameLong,3,R),void 0!==i)return i}else if(e.isComplexScript){if(i=j(e,t,r,e.monthNameLong,R),void 0!==i)return i;if(i=j(e,t,r,e.monthNameShort,R),void 0!==i)return i;if(i=j(e,t,r,(0,a.getEnglishLocaleInfo)().monthNameLong,T),void 0!==i)return i;if(i=j(e,t,r,(0,a.getEnglishLocaleInfo)().monthNameShort,T),void 0!==i)return i}else if(i=V(e,t,r,e.monthNameLong,3,R),void 0!==i)return i;return(e.lcid&a.LCID.LANG)==(a.LCID.Arabic&a.LCID.LANG)&&(i=j(e,t,r,W,k),void 0!==i)?i:(i=V(e,t,r,e.ampmSymbols,1,O),void 0!==i?i:(i=V(e,t,r,(0,a.getEnglishLocaleInfo)().ampmSymbols,1,O),void 0!==i||(e.isChinaS||e.isChinaT)&&(i=V(e,t,r,x,1,O),void 0!==i)?i:[void 0,r]))}function q(e,t,r,n){let a=r;const i=t.charCodeAt(a)===F;let o,s,l;if(i&&(a+=1),n===P.FracSec){if([o,s]=(0,c.parseUint)(e,4,a+4<t.length?t.substring(0,a+4):t,a),l=s-a,(0,d.assertTrue)("calc.numfmt.parseDateInternal: 0 < digits <= 4",U(l,1,4)),4===l){let r;for(;s<t.length&&e.isNumeral(r=(0,u.stringCodePointAt)(t,s));)s+=(0,u.numCodeUnits)(r);o=Math.round(o/10),l=3}}else if([o,s]=(0,c.parseUint)(e,4,t,a),l=s-a,l>4||l>2&&o<100)return[void 0,r];if(0===l)return[void 0,r];const m=function(e,t){let r=g.NumberShape.ASCII;for(const n of(0,u.codePointIterator)(t)){const t=e.getNumberShape(n);t!==g.NumberShape.ASCII&&(r=t)}return r}(e,t.substring(a,s));return a=s,[_(i?-o:o,l,m),a]}function $(e,t,r,n){let a=P.Nil,i=r;if(t.charCodeAt(i)===v)for(a=P.Space;t.charCodeAt(i)===v;)i+=1;return null!=e.timeAltSeparator&&e.timeAltSeparator!==e.timeSeparator&&n===P.Time&&(0,h.stringStartsWith)(t,e.timeAltSeparator,i)?(a=P.TimeAlt,i+=e.timeAltSeparator.length):(0,h.stringStartsWith)(t,e.dateSeparator,i)?(a=P.Date,i+=e.dateSeparator.length):(0,h.stringStartsWith)(t,e.timeSeparator,i)?(a=P.Time,i+=e.timeSeparator.length):(0,h.stringStartsWith)(t,e.decimalSeparator,i)&&n===P.Time?(a=P.FracSec,i+=e.decimalSeparator.length):t.charCodeAt(i)===S||t.charCodeAt(i)===F?(a=P.Date,i+=1):t.charCodeAt(i)===y?(a=P.Time,i+=1):(0,h.stringStartsWith)(t,", ",i)&&(a=P.Intl1St3,i+=2),a===P.Space&&(" "===e.dateSeparator?a=P.Date:" "===e.timeSeparator?a=P.Time:" "===e.decimalSeparator&&n===P.Time&&(a=P.FracSec)),[a,i]}function z(e,t,r,n){return t===g.NumberShape.ASCII?r:t!==g.NumberShape.Lao&&t!==g.NumberShape.Thai||!e.isThai?(0,f.buildNumShapeDateTimeFormat)(e,t,r):n}t.parseDateInternal=function(e,t,r,n){const{config:a}=e,{localeInfo:o}=a;if(!o.isEastAsia&&!function(e,t){for(const r of(0,u.codePointIterator)(t))if(e.isNumeral(r))return!0;return!1}(o,t))return(0,p.success)(void 0);if(o.isEastAsia)return(0,p.failure)((0,s.notImplemented)(["parse East Asia date"]));if(o.isThai){let e=t.indexOf("b");if(e<0&&(e=t.indexOf("B")),e>=0&&e+1<t.length&&o.isNumeral((0,u.stringCodePointAt)(t,e+1)))return(0,p.failure)((0,s.notImplemented)(["parse Thai Buddhist date"]))}const l=function(e,t,r){const{localeInfo:n,dateCompatibility:a}=e,i=[];let o=r?.bidiDate,l=g.NumberShape.ASCII;const c=r?.culture;let m,h=!1,f=!1;for(let e=0;e<t.length;){if(i.length>=9)return(0,p.success)(void 0);let r;if(n.isNumeral((0,u.stringCodePointAt)(t,e))||!a&&e+1<t.length&&t.charCodeAt(e)===F&&n.isNumeral((0,u.stringCodePointAt)(t,e+1))){const[a,i]=q(n,t,e,m);if(void 0===a)return(0,p.success)(void 0);e=i,a.numShape!==g.NumberShape.ASCII&&(l=a.numShape),r=a}else{if(t.charCodeAt(e)===v)return(0,p.failure)((0,s.notImplemented)(["absurd date/time string with leading space"]));{const[a,s]=H(n,t,e);if(void 0===a)return(0,p.success)(void 0);if(e=s,a.kind===A.Month){if(h)return(0,p.success)(void 0);h=!0,void 0!==a.bidiDate&&(o=a.bidiDate)}if(a.kind===A.AMPM){if(f)return(0,p.success)(void 0);if(f=!0,0===i.length||i[i.length-1].sep!==P.Space)return(0,p.success)(void 0);m=i[i.length-1].sep=P.Time}r=a}}const[c,d]=$(n,t,e,m);for(e=d;e<t.length&&t.charCodeAt(e)===v;)e+=1;i.push({tok:r,sep:c}),m=c}return(0,d.assertTrue)("calc.numfmt.parseDateInternal: > 0 tokens",0!==i.length),(0,p.success)({tokens:i,bidiDate:o,numShape:l,culture:c})}(a,t,r);if(!(0,p.isSuccess)(l)||void 0===l.value)return l;const{tokens:c,bidiDate:h,numShape:f,culture:S}=l.value;if(h===i.BidiDate.Lunar)return(0,p.failure)((0,s.notImplemented)(["Lunar calendar"]));if(void 0!==S&&(S.localCalendarInput||S.tag===i.CultureTag.Gannen))return(0,p.failure)((0,s.notImplemented)(["parse date: possible local calendar"]));const y=function(e,t){const{localeInfo:r}=e;let n,a,i,o,u,l,c;for(let e=0;e<t.length;e+=1)if(M(t[e].sep)){n={start:e,end:e+1};break}if(void 0!==n){if(0!==n.start&&t[n.start-1].sep!==P.Space&&!D(r,t[n.start-1].sep))return(0,p.success)(void 0);for(;n.end<t.length&&M(t[n.end-1].sep);)n.end+=1;if(n.end<t.length&&t[n.end-1].sep===P.FracSec){n.end+=1;const e=t[n.end-1];if(e.tok.kind!==A.Number)return(0,p.success)(void 0);if(e.tok,l=e,n.end<t.length&&M(t[n.end-1].sep)){n.end+=1;const e=t[n.end-1];if(e.tok.kind!==A.AMPM)return(0,p.failure)((0,s.notImplemented)(["non-AM/PM after FracSec"]));e.tok,c=e}}else{const e=t[n.end-1];e.tok.kind===A.AMPM&&(e.tok,c=e)}const e=n.end-n.start-(void 0!==l?1:0)-(void 0!==c?1:0);for(let r=0;r<e;r+=1)if(t[n.start+r].tok.kind!==A.Number)return(0,p.failure)((0,s.notImplemented)(["non-number in H/M/S component"]));switch(e){case 0:return(0,d.assertFalse)("calc.numfmt.parseDateInternal: 0 time");case 1:(0,d.assertTrue)("calc.numfmt.parseDateInternal: 1 time => !fracSec",void 0===l),i=t[n.start];break;case 2:void 0===l?(i=t[n.start],o=t[n.start+1]):(o=t[n.start],u=t[n.start+1]);break;case 3:i=t[n.start],o=t[n.start+1],u=t[n.start+2];break;default:return(0,p.success)(void 0)}for(let e=n.end;e<t.length;e+=1)if(M(t[e].sep))return(0,p.success)(void 0);if(n.end===t.length){const e=t[n.end-1].sep;if(!(w(e)||void 0!==c&&e===P.FracSec))return(0,p.failure)((0,s.notImplemented)(["trailing sep after time"]))}else{const e=t[n.end-1].sep;if(!w(e)&&e!==P.Intl1St3)return(0,p.failure)((0,s.notImplemented)(["unexpected sep between time and date"]))}if(0===n.start)n.end!==t.length&&(a={start:n.end,end:t.length});else{if(n.end!==t.length)return(0,p.failure)((0,s.notImplemented)(["date part split around time part"]));a={start:0,end:n.start}}}else a={start:0,end:t.length};return(0,p.success)({time:n,date:a,hour:i,min:o,sec:u,fracSec:l,ampm:c})}(a,c);if(!(0,p.isSuccess)(y)||void 0===y.value)return y;const{time:C,date:E,hour:b,min:R,sec:T,fracSec:k,ampm:N}=y.value,I=function(e,t,r,n){const{config:a}=e,{localeInfo:i,dateCompatibility:o,datepack:u}=a;let l,c,m,h=!1;if(void 0!==n){const e=n.end-n.start;if(e<2||e>3)return(0,p.success)(void 0);const{tok:t,sep:a}=r[n.start],{tok:u,sep:f}=r[n.start+1],{tok:S,sep:v}=r[n.end-1];if((0,d.assertTrue)("calc.numfmt.parseDateInternal: all not AM/PM",t.kind!==A.AMPM&&u.kind!==A.AMPM&&S.kind!==A.AMPM),!w(v)&&!D(i,v))return(0,p.success)(void 0);const F=void 0!==function(e,t){for(let r=t.start;r<t.end;r+=1)if(e[r].tok.kind===A.Month)return r}(r,n);if(h=F,F)if(L(a)&&L(f))if(t.kind===A.Month){if(e>2)return(0,p.success)(void 0);c=t,(0,d.assertTrue)("calc.numfmt.parseDateInternal: yr not Month",S.kind!==A.Month),l=S}else{if(u.kind!==A.Month)return(0,p.success)(void 0);m=t,c=u,3===e&&((0,d.assertTrue)("calc.numfmt.parseDateInternal: yr not Month",S.kind!==A.Month),l=S)}else{if(3!==e)return(0,p.success)(void 0);if(w(f))return(0,p.success)(void 0);const r=i.longDateFormat?t:u,n=i.longDateFormat?u:t;if(r.kind!==A.Month)return(0,p.success)(void 0);(0,d.assertTrue)("calc.numfmt.parseDateInternal: Int1 dom & yr not Month",n.kind!==A.Month&&S.kind!==A.Month),m=n,c=r,l=S}else if((0,d.assertTrue)("calc.numfmt.parseDateInternal: all not Month",t.kind!==A.Month&&u.kind!==A.Month&&S.kind!==A.Month),2===e&&a===P.Date)switch(h=!0,i.dateOrder){case g.DateOrder.MDY:c=t,l=S;break;case g.DateOrder.YMD:U(t.value,1,12)?(c=t,m=S):(l=t,c=S);break;case g.DateOrder.DMY:U(S.value,1,12)?(m=t,c=S):(c=t,l=S);break;default:return(0,p.failure)((0,s.notImplemented)(["date parse date order"]))}else{if(e<3||a!==P.Date||f!==P.Date)return(0,p.success)(void 0);switch(t.value>999||!o&&t.value>99?g.DateOrder.YMD:i.dateOrder){case g.DateOrder.MDY:c=t,m=u,l=S;break;case g.DateOrder.YMD:l=t,c=u,m=S;break;case g.DateOrder.DMY:m=t,c=u,l=S;break;default:return(0,p.failure)((0,s.notImplemented)(["date parse date order"]))}}}let f=!1;if(i.dateOrder!==g.DateOrder.DMY&&void 0===m&&void 0!==c&&U(c.value,1,12)&&void 0!==l&&U(l.value,1,31)){const r=G(e,t);if(!(0,p.isSuccess)(r))return r;l.value<=u.daysPerMonth(c.value,r.value,o)&&(m=l,l=_(r.value,4,g.NumberShape.ASCII),f=!0)}return(0,p.success)({yr:l,mon:c,dom:m,useMonthName:h,usingCurrentYear:f})}(e,n,c,E);if(!(0,p.isSuccess)(I)||void 0===I.value)return I;const{yr:O,mon:x,dom:K,useMonthName:W,usingCurrentYear:B}=I.value,V=function(e,t,r,n,a,i,o,u,l,c){const{config:g}=e,{mathpack:h,datepack:f,dateCompatibility:S}=g;let v,F,y;if(void 0!==n||void 0!==a||void 0!==r){if((0,d.assertTrue)("calc.numfmt.parseDateInternal: dom || yr",void 0!==a||void 0!==r),(0,d.assertTrue)("calc.numfmt.parseDateInternal: mon",void 0!==n),F=n.value,!U(F,1,12))return(0,p.success)(void 0);if(void 0===r){const r=G(e,t);if(!(0,p.isSuccess)(r))return r;v=r.value}else v=U(r.value,0,99)?function(e){return 1900+(e<30?100:0)+e}(r.value):r.value;if(!U(v,1900,9999))return(0,p.success)(void 0);if(y=a?.value??1,!U(y,1,f.daysPerMonth(F,v,S)))return(0,p.success)(void 0)}else{const e=f.fromNum(g,h.zero,m.Rounding.RoundSec);(0,d.assertTrue)("calc.numfmt.parseDateInternal: zeroDtr fromNum",!1!==e),({yr:v,mon:F,dom:y}=e)}let C,A=0,E=0,b=0,R=0,T=m.Rounding.RoundSec,k=0;if(void 0!==i){if(i.value<0)return(0,p.failure)((0,s.notImplemented)(["negative hour"]));if(i.value>23){if(void 0!==C)return(0,p.success)(void 0);k=i.value,C=m.TimeDivision.Hour}else A=i.value}if(void 0!==o){if(o.value<0)return(0,p.failure)((0,s.notImplemented)(["negative minute"]));if(o.value>59){if(void 0!==C)return(0,p.success)(void 0);k=o.value,C=m.TimeDivision.Minute}else E=o.value}if(void 0!==u){if(u.value<0)return(0,p.failure)((0,s.notImplemented)(["negative second"]));if(u.value>59){if(void 0!==C)return(0,p.success)(void 0);k=u.value,C=m.TimeDivision.Second}else b=u.value}if(void 0!==l){if(l.value<0)return(0,p.failure)((0,s.notImplemented)(["negative fractional second"]));(0,d.assertTrue)("calc.numfmt.parseDateInternal: fracSec.digits",l.digits>=1&&l.digits<=3),T=l.digits,(0,d.assertTrue)("calc.numfmt.parseDateInternal: fracSec.value",l.value<(3===T?1001:2===T?100:10)),R=l.value}if(void 0!==c){if(void 0!==C||A>12)return(0,p.success)(void 0);c.am?12===A&&(A=0):A<12&&(A+=12)}const N=(0,m.dateTime)(v,F,y,A,E,b,1,R,T),I=void 0!==C?f.toNumWithDuration(g,N,C,k):f.toNum(g,N);return(0,s.isErrorOper)(I)?(0,p.success)(void 0):(0,p.success)({value:I,duration:C})}(e,n,O,x,K,b?.tok,R?.tok,T?.tok,k?.tok,N?.tok);if(!(0,p.isSuccess)(V)||void 0===V.value)return V;const{value:j,duration:Q}=V.value,Y=function(e,t,r,n,a,i,o,u,l,c,h,f,S){if(u)return l?.sep===P.TimeAlt?(0,p.success)(e.sysTimeFormat):void 0!==h?(0,p.success)(z(e,t,g.KnownFormat.SS0,g.KnownFormat.SS0_Tha)):void 0!==S?S!==m.TimeDivision.Hour||void 0!==f||r?(0,p.success)(g.KnownFormat.General):(0,p.success)(z(e,t,g.KnownFormat.AbsHMMSS,g.KnownFormat.AbsHMMSS_Tha)):r?(0,p.success)(z(e,t,g.KnownFormat.MDYHMS,g.KnownFormat.MDYHMS_Tha)):void 0!==f?(0,p.success)(z(e,t,void 0!==c?g.KnownFormat.HHMMSSAP:g.KnownFormat.HHMMAP,void 0!==c?g.KnownFormat.HHMMSS_Tha:g.KnownFormat.HHMM_Tha)):(0,p.success)(z(e,t,void 0!==c?g.KnownFormat.HHMMSS:g.KnownFormat.HHMM,void 0!==c?g.KnownFormat.HHMMSS_Tha:g.KnownFormat.HHMM_Tha));if((0,d.assertTrue)("calc.numfmt.parseDateInternal: !haveTime => haveDate",r),!i)return(0,p.success)(z(e,t,g.KnownFormat.MMDDYY,g.KnownFormat.MMDDYY_Tha));const v=void 0!==n&&!o,F=z(e,t,void 0===a?g.KnownFormat.MMMYY:v?g.KnownFormat.DDMMMYY:g.KnownFormat.DDMMM,void 0===a?g.KnownFormat.MMMYY_Tha:v?g.KnownFormat.DDMMMYY_Tha:g.KnownFormat.DDMMM_Tha);return e.isEastAsia&&F===g.KnownFormat.DDMMM&&r?(0,p.failure)((0,s.notImplemented)(["parseDateInternal ifmt for East Asian DDMMM"])):(0,p.success)(F)}(o,f,void 0!==E,O,K,W,B,void 0!==C,R,T,k,N,Q);return(0,p.isSuccess)(Y)?(0,p.success)({value:j,format:Y.value}):Y}},99188:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderHashesValue=t.renderValue=t.renderGeneral=void 0;const n=r(31828),a=r(27007),i=r(25969),o=r(14587),s=r(17585),u=r(60888),l=r(1585),c=e=>e.kind!==n.FormattedUnitKind.General,d=e=>e.kind!==n.FormattedUnitKind.Flexible,g=255;function m(e,t,r){return 0!=(t&n.Clip.MaxChars)&&r.length>g?n.Clip.MaxChars:0!=(t&n.Clip.CellWidth)&&e.renderWidth<1/0&&e.getTextWidth(r)>e.renderWidth?n.Clip.CellWidth:void 0}function h(e,t,r,n,a,s,u){const l=(0,o.fastMax)(0,g-r.length-n.length);let c=0===a.length?l:Math.floor(l/a.length);if(e.renderWidth!==1/0){const t=e.getTextWidth(a);t>0&&(c=(0,o.fastMin)(c,(0,o.fastMax)(Math.floor((e.renderWidth-e.getTextWidth(r+n))/t),0)))}const d=u(c);if(e.bestFit&&s&&(!1===d||d.indexOf("E")>=0)){let e=1,t=d;for(;(!1===t||t.indexOf("E")>=0)&&c+e<=f;)t=u(c+e),e++;if(!1!==t)return t}let h;if(!1===d||void 0===(h=m(e,t,r+d+n))){let a=d;for(let i=c+1;i<c+50;i+=1){const o=u(i);if(!1===o)continue;if(o===a)break;const s=m(e,t,r+o+n);if(void 0!==s){!1===a&&(a=s);break}a=o}return(0,i.assertTrue)("calc.numfmt.renderValue: false after upwards search",!1!==a),a}let p=h;for(let a=c-1;a>=0;a-=1){const i=u(a);if(!1===i)break;const o=m(e,t,r+i+n);if(void 0===o)return i;p=o}return p}const p=(0,a.createFailureErrorClass)("RenderHashesError"),f=11;function S(e,t,r){const n=e.fromNumber(t.num),a=t.includeSign&&e.cond(n)<0?"-":"";let o=a+e.formatGeneral(t,e.abs(n),r-a.length);if("-0"===o&&(o="0"),o.length>r)return!1;const u=o.indexOf("E");if(u>=0){const e=(0,s.convertNumberShape)(t,o.substring(0,u),t.expNumberShape),r=o.substring(u,u+2),n=(0,s.convertDigitsShape)(o.substring(u+2),t.expNumberShape);return(0,i.assertTrue)("calc.numfmt.render: formatGeneral ePart","E-"===r||"E+"===r),e+r+n}return(0,s.convertNumberShape)(t,o,t.numberShape)}t.renderGeneral=S,t.renderValue=function(e,t,r){try{return(0,n.isHashesValue)(t)?(0,l.success)((0,n.hashesValue)(t.units,t.color)):(0,l.success)(function(e,{units:t,color:r,alignment:a,clip:s},l){const g=(0,n.memoizedRenderCallback)(l);let v,F;if(t.every(c))v=t;else if(g.renderWidth===1/0)v=t.map((t=>{if(t.kind!==n.FormattedUnitKind.General)return t;const r=S(e,t,f);return(0,i.assertTrue)("calc.numfmt.renderValue: false after format at defaultGenPrecision",!1!==r),(0,n.formattedUnitString)(r)}));else{let r,a,u="",l="";for(let e=0;e<t.length;e+=1){const o=t[e];switch(o.kind){case n.FormattedUnitKind.String:case n.FormattedUnitKind.Blank:void 0!==r?l+=o.str:u+=o.str;break;case n.FormattedUnitKind.General:(0,i.assertTrue)("calc.numfmt.renderValue: expected a single General unit",void 0===r),r=e,a=o;case n.FormattedUnitKind.Flexible:}}(0,i.assertTrue)("calc.numfmt.renderValue: genUnit",void 0!==r&&void 0!==a);const c=a,d=h(g,s,u,l,"0",c.builtin,(t=>S(e,c,(0,o.fastMin)(t,f))));if("number"==typeof d)throw new p((0,n.tooWide)(d));v=t.map((e=>e.kind===n.FormattedUnitKind.General?(0,n.formattedUnitString)(d):e))}if(v.every(d))F=v;else if(g.renderWidth===1/0||g.bestFit)F=v.filter(d);else{let e,t,r="",a="";for(let i=0;i<v.length;i+=1){const o=v[i];switch(o.kind){case n.FormattedUnitKind.String:case n.FormattedUnitKind.Blank:void 0!==e?a+=o.str:r+=o.str;break;case n.FormattedUnitKind.Flexible:e=i,t=o}}(0,i.assertTrue)("calc.numfmt.renderValue: lastFlexUnit",void 0!==e&&void 0!==t);const l=t;let c=h(g,n.Clip.All,r,a,t.str,!1,(e=>(0,u.repeat)(l.str,e)));if("number"==typeof c){if(0!=(c&s))throw new p((0,n.tooWide)(c));c=""}let d=c.length/l.str.length;d=(0,o.fastMax)(d-1,0);const m=(0,u.repeat)(l.str,d);F=v.map(((t,r)=>t.kind!==n.FormattedUnitKind.Flexible?t:(0,n.formattedUnitString)(r===e?m:"")))}if(s!==n.Clip.None){let e="";for(let t=0;t<F.length;t+=1)e+=F[t].str;const t=m(g,s,e);if(g.bestFit&&t===n.Clip.CellWidth)return(0,n.renderedValue)(F,r,a,s);if(void 0!==t)throw new p((0,n.tooWide)(t))}return(0,n.renderedValue)(F,r,a,s)}(e,t,r))}catch(e){return e instanceof p?(0,l.success)((0,n.hashesValue)(e.reason,t.color)):(0,l.failure)((0,l.javaScriptError)(e))}},t.renderHashesValue=function(e,t){try{let r=h((0,n.memoizedRenderCallback)(t),e.clip,"","","#",!1,(e=>(0,u.repeat)("#",e)));if("number"==typeof r)switch(r){case n.Clip.MaxChars:r=(0,u.repeat)("#",g);break;case n.Clip.CellWidth:r="";break;default:return(0,i.assertNever)("calc.numFmt.renderHashesValue",r)}const a=(0,n.formattedUnitString)(r);return(0,l.success)((0,n.renderedValue)([a],e.color,e.alignment,e.clip))}catch(e){return(0,l.failure)((0,l.javaScriptError)(e))}}},29787:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRibbonFormat=t.RibbonFormat=void 0;const n=r(74837),a=r(34284),i=r(44442);var o;function s(e,t){return(0,i.buildSingle)(e,n.PictureSingle.ColorStart,"$-",t,n.PictureSingle.ColorEnd)}!function(e){e.GalleryGeneral="GalleryGeneral",e.GalleryNumber="GalleryNumber",e.GalleryCurrency="GalleryCurrency",e.GalleryAccounting="GalleryAccounting",e.GalleryShortDate="GalleryShortDate",e.GalleryLongDate="GalleryLongDate",e.GalleryTime="GalleryTime",e.GalleryPercentage="GalleryPercentage",e.GalleryFraction="GalleryFraction",e.GalleryScientific="GalleryScientific",e.GalleryText="GalleryText",e.ButtonComma="ButtonComma",e.ButtonPercentage="ButtonPercentage",e.ButtonAccounting="ButtonAccounting",e.KeyboardGeneral="KeyboardGeneral",e.KeyboardNumber="KeyboardNumber",e.KeyboardCurrency="KeyboardCurrency",e.KeyboardDate="KeyboardDate",e.KeyboardTime="KeyboardTime",e.KeyboardPercentage="KeyboardPercentage",e.KeyboardScientific="KeyboardScientific"}(o||(t.RibbonFormat=o={})),t.getRibbonFormat=function(e,t,r){const u=(r?.culture?.calendar??a.Calendar.Gregorian)===a.Calendar.Gregorian;switch(t){case o.GalleryGeneral:case o.KeyboardGeneral:return(0,i.getKnownFormat)(e,a.KnownFormat.General);case o.GalleryNumber:return(0,i.buildNumberFormat)(e,!1,1,e.currencyDecimals);case o.KeyboardNumber:return(0,i.buildNumberFormat)(e,!0,4,e.currencyDecimals);case o.GalleryCurrency:{const t={...e,currencyFormat:e.currencyFormat===a.CurrencyFormat.Paren?a.CurrencyFormat.Lead:e.currencyFormat};return(0,i.buildCurrencyFormat)(t,!1,e.currencyDecimals,!0,!1,void 0,!0)}case o.KeyboardCurrency:return(0,i.buildCurrencyFormat)(e,!0,e.currencyDecimals,!0,!1);case o.GalleryAccounting:case o.ButtonAccounting:return(0,i.buildCurrencyFormat)(e,!1,e.currencyDecimals,!0,!0);case o.GalleryShortDate:return u?(0,i.getKnownFormat)(e,a.KnownFormat.MMDDYY):(0,i.buildSingle)(e,n.PictureSingle.Month,n.PictureSingle.DateSep,n.PictureSingle.Day,n.PictureSingle.Sep,n.PictureSingle.Text);case o.GalleryLongDate:return u?s(e,"x-sysdate")+(0,i.buildSingle)(e,n.PictureSingle.Day,n.PictureSingle.Day,n.PictureSingle.Day,n.PictureSingle.Day,", ",n.PictureSingle.Month,n.PictureSingle.Month,n.PictureSingle.Month,n.PictureSingle.Month," ",n.PictureSingle.Day,n.PictureSingle.Day,", ",n.PictureSingle.Year,n.PictureSingle.Year,n.PictureSingle.Year,n.PictureSingle.Year):(0,i.buildSingle)(e,n.PictureSingle.Month,n.PictureSingle.DateSep,n.PictureSingle.Day,n.PictureSingle.DateSep,n.PictureSingle.Year,n.PictureSingle.Year,n.PictureSingle.Sep,n.PictureSingle.Text);case o.GalleryTime:return s(e,"x-systime")+(0,i.buildSingle)(e,n.PictureSingle.Hour,n.PictureSingle.Colon,n.PictureSingle.Minute,n.PictureSingle.Minute,n.PictureSingle.Colon,n.PictureSingle.Second,n.PictureSingle.Second," ")+(0,i.getSpecial)(e,n.PictureSpecial.AP1);case o.KeyboardDate:return s(e,"en-US")+(0,i.buildSingle)(e,n.PictureSingle.Day,"-",n.PictureSingle.Month,n.PictureSingle.Month,n.PictureSingle.Month,"-",n.PictureSingle.Year,n.PictureSingle.Year,n.PictureSingle.Sep,n.PictureSingle.Text);case o.KeyboardTime:return s(e,"en-US")+(0,i.buildSingle)(e,n.PictureSingle.Hour,n.PictureSingle.Colon,n.PictureSingle.Minute,n.PictureSingle.Minute," ",(0,i.getSpecial)(e,n.PictureSpecial.AP1),n.PictureSingle.Sep,n.PictureSingle.Text);case o.GalleryPercentage:return(0,i.buildPercentFormat)(e,e.currencyDecimals);case o.ButtonPercentage:case o.KeyboardPercentage:return(0,i.getKnownFormat)(e,a.KnownFormat.Pct0);case o.GalleryFraction:return(0,i.getKnownFormat)(e,a.KnownFormat.Fract);case o.GalleryScientific:case o.KeyboardScientific:return(0,i.buildScientificFormat)(e,1,e.currencyDecimals,2);case o.GalleryText:return(0,i.getKnownFormat)(e,a.KnownFormat.Text);case o.ButtonComma:return(0,i.buildCurrencyFormat)(e,!1,e.currencyDecimals,!1,!0)}}},31828:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.evalFormatLocalsGrid=t.createFormatGlobals=t.NumberFormatSource=t.otherEdit=t.numberEdit=t.stringEdit=t.formulaEdit=t.EditKind=t.renderedValueToString=t.renderInfiniteWidth=t.memoizedRenderCallback=t.renderCallback=t.isHashesValue=t.renderedValue=t.formattedValue=t.hashesValue=t.formattedUnitFlexible=t.formattedUnitBlank=t.formattedUnitString=t.formattedUnitGeneral=t.FormattedUnitKind=t.Clip=t.GetTimeKind=t.Alignment=t.NamedColor=t.FormatCurrency=t.isFormatCultureEqual=t.isSystemCultureTag=t.CultureTag=t.BidiDate=t.FormatValueType=t.formatLocIFormat=t.formatLocKnownFormat=t.FormatLocKind=t.previousFormatFailure=t.aggregationError=t.fractionOverflow=t.dateOverflow=t.tooWide=t.noFormatPart=t.notFormatString=t.notValueString=t.ReasonKind=t.FormatReasonKind=void 0;const n=r(27007),a=r(14587),i=r(1585);var o,s,u,l,c,d,g,m,h,p,f,S,v;function F(e,t,r,n){return{units:e,color:t,alignment:r,clip:n}}function y(e,t,r){return{renderWidth:e,bestFit:r,getTextWidth:t}}!function(e){e.NotValueString="NotValueString",e.NotFormatString="NotFormatString",e.NoFormatPart="NoFormatPart",e.TooWide="TooWide",e.DateOverflow="DateOverflow",e.FractionOverflow="FractionOverflow",e.AggregationError="AggregationError",e.PreviousFormatFailure="PreviousFormatFailure"}(o||(t.FormatReasonKind=o={})),t.ReasonKind={...n.LangReasonKind,...o},t.notValueString=function(e){return{kind:t.ReasonKind.NotValueString,message:e}},t.notFormatString=function(e){return{kind:t.ReasonKind.NotFormatString,message:e}},t.noFormatPart={kind:t.ReasonKind.NoFormatPart},t.tooWide=function(e){return{kind:t.ReasonKind.TooWide,clip:e}},t.dateOverflow={kind:t.ReasonKind.DateOverflow},t.fractionOverflow={kind:t.ReasonKind.FractionOverflow},t.aggregationError={kind:t.ReasonKind.AggregationError},t.previousFormatFailure=function(e){return{kind:t.ReasonKind.PreviousFormatFailure,format:e}},function(e){e.FormatString="FormatString",e.KnownFormat="KnownFormat",e.IFormat="IFormat"}(s||(t.FormatLocKind=s={})),t.formatLocKnownFormat=function(e,t){return{kind:s.KnownFormat,document:e,knownFormat:t}},t.formatLocIFormat=function(e,t){return{kind:s.IFormat,document:e,iformat:t}},function(e){e.General="General",e.Number="Number",e.Currency="Currency",e.Accounting="Accounting",e.Date="Date",e.Time="Time",e.Percentage="Percentage",e.Fraction="Fraction",e.Scientific="Scientific",e.Text="Text",e.Custom="Custom"}(u||(t.FormatValueType=u={})),function(e){e.English="English",e.Lunar="Lunar"}(l||(t.BidiDate=l={})),function(e){e.SysDate="sysdate",e.SysTime="systime",e.Euro1="euro1",e.Euro2="euro2",e.GenLower="genlower",e.GenUpper="genupper",e.NomLower="nomlower",e.Bitcoin1="xbt1",e.Bitcoin2="xbt2",e.Gannen="gannen"}(c||(t.CultureTag=c={})),t.isSystemCultureTag=function(e){return e===c.SysDate||e===c.SysTime},t.isFormatCultureEqual=function(e,t){return e.culture===t.culture&&e.numberShape===t.numberShape&&e.nationalNumberInput===t.nationalNumberInput&&e.calendar===t.calendar&&e.localCalendarInput===t.localCalendarInput&&e.tag===t.tag},function(e){e[e.LocaleInfo=0]="LocaleInfo"}(d||(t.FormatCurrency=d={})),function(e){e.Black="Black",e.White="White",e.Red="Red",e.Green="Green",e.Blue="Blue",e.Yellow="Yellow",e.Magenta="Magenta",e.Cyan="Cyan"}(g||(t.NamedColor=g={})),function(e){e.Left="Left",e.Center="Center",e.Right="Right"}(m||(t.Alignment=m={})),function(e){e.ValueCell="ValueCell",e.Volatile="Volatile",e.NonVolatile="NonVolatile"}(h||(t.GetTimeKind=h={})),function(e){e[e.MaxChars=2]="MaxChars",e[e.CellWidth=4]="CellWidth",e[e.None=0]="None",e[e.All=6]="All"}(p||(t.Clip=p={})),function(e){e.String="String",e.Blank="Blank",e.General="General",e.Flexible="Flexible"}(f||(t.FormattedUnitKind=f={})),t.formattedUnitGeneral=function(e,t,r,n,a,i){return{kind:f.General,num:e,decimalSeparator:t,includeSign:r,numberShape:n,expNumberShape:a,builtin:i}},t.formattedUnitString=function(e){return{kind:f.String,str:e}},t.formattedUnitBlank=function(e){return{kind:f.Blank,str:e}},t.formattedUnitFlexible=function(e){return{kind:f.Flexible,str:e}},t.hashesValue=function(e,t){return F(e,t,m.Center,p.All)},t.formattedValue=F,t.renderedValue=F,t.isHashesValue=function(e){return!Array.isArray(e.units)},t.renderCallback=y,t.memoizedRenderCallback=function(e){const t=(0,a.makeStringMap)();return y(e.renderWidth,(r=>{if(null!=t[r])return t[r];const n=e.getTextWidth(r);return t[r]=n,n}),e.bestFit)},t.renderInfiniteWidth={renderWidth:1/0,bestFit:!1,getTextWidth:e=>e.length},t.renderedValueToString=function(e){let t="";for(const r of e.units)switch(r.kind){case f.String:t+=r.str;break;case f.Blank:for(let e=0;e<r.str.length;e+=1)t+=" "}return t},function(e){e.Formula="Formula",e.String="String",e.Number="Number",e.Other="Other"}(S||(t.EditKind=S={})),t.formulaEdit=function(e){return{kind:S.Formula,fmla:e}},t.stringEdit=function(e,t){return{kind:S.String,value:e,tick:t}},t.numberEdit=function(e,t){return{kind:S.Number,value:e,format:t}},t.otherEdit=function(e){return{kind:S.Other,value:e}},function(e){e.Builtin="Builtin",e.CustomString="CustomString",e.CustomBytecode="CustomBytecode",e.System="System"}(v||(t.NumberFormatSource=v={})),t.createFormatGlobals=function(e,t){return{config:e,getTime:t}},t.evalFormatLocalsGrid=function(e,t){const r=(0,n.sheetGridRangeAnchor)(e.range);return{config:t??void 0,lexicalSource:e,originGridCell:(0,i.success)(r.range),originSheet:(0,i.success)(r.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1}}},84980:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.commonFormats=void 0,t.commonFormats=["#","##","###","########\\ \\ \\ \\ \\ \\ \\ \\ ","###,###","###\\ ###","###\\-##\\-####","##,###.##\\ \\ \\ ","#,###","#,###.#","#,###.##","#,###_)","#,###_)_ ","#.##","#.##%","#.#%","#;\\(\\ \\ @\\ \\ \\ \\)",'#"\\""\\""\\""\\"\\ ??/??',"#\\ ###",";;",";;;","@\\ ","\\ #######\\ \\ \\ \\ ","\\ \\ @","\\(###\\)\\ ###\\-####","\\(\\ ###\\ \\)\\ ###\\-####","\\:","__@","[$$]#,##0_);\\([$$]#,##0\\);[$$]#,##0_);@_)","[$$]#,##0.0_);\\([$$]#,##0.0\\);[$$]#,##0.0_);@_)","[$$-1009]#,##0.00","[$$-1009]#,##0;[Red]\\-[$$-1009]#,##0","[$$-409]#,##0","[$$-409]#,##0.00","[$$-409]#,##0.00_);\\([$$-409]#,##0.00\\)",'_([$$-409]* #,##0.00_);_([$$-409]* \\(#,##0.00\\);_([$$-409]* "-"??_);_(@_)',"[$$-409]#,##0.0000","[$$-409]#,##0.0000_);\\([$$-409]#,##0.0000\\)","[$$-409]#,##0.00_);[Red]\\([$$-409]#,##0.00\\)","[$$-409]#,##0;[Red][$$-409]#,##0","[$$-409]#,##0_);[Red]\\([$$-409]#,##0\\)","[$$-C09]#,##0.00","[$$-C09]#,##0.000","[$$-C09]#,##0.0000","[$$-C09]#,##0.00000","[$£-809]#,##0","[$£-809]#,##0.00","[$£-809]#,##0.00;[Red]\\-[$£-809]#,##0.00","[$£-809]#,##0;[Red][$£-809]#,##0","[$¥-411]#,##0","[$€-2]\\ #,##0.00","[$€-2]\\ #,##0.00_);[Red]\\([$€-2]\\ #,##0.00\\)","[$€-2]\\ #,##0_);[Red]\\([$€-2]\\ #,##0\\)",'"$"#,##0','"$"#,##0;\\("$"#,##0\\)','"$"#,##0;\\-"$"#,##0','"$"#,##0_);\\("$"#,##0\\)','"$"#,##0_);\\("$"#,##0\\);"-"??_)','"$"#,##0_);\\("$"#,##0\\);\\ \\-\\ ','"$"\\ #,##0;\\("$"\\ #,##0\\)',"\\$#,##0_);\\(\\$#,##0\\)",'_ "$"\\ * #,##0_ ;_ "$"\\ * \\-#,##0_ ;_ "$"\\ * "-"??_ ;_ @_ ','_ "$"\\ * #,##0_ ;_ "$"\\ * \\-#,##0_ ;_ "$"\\ * "-"_ ;_ @_ ','_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"??_);_(@_)','_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)','_("$"\\ * #,##0_);_("$"\\ * \\(#,##0\\);_("$"\\ * "-"_);_(@_)','_-"$"* #,##0_-;\\-"$"* #,##0_-;_-"$"* "-"_-;_-@_-','"$"#,##0_%_);\\("$"#,##0\\)_%;"$"#,##0_%_);@_%_)','"$"#,##0.0','"$"#.00','"$"0.0','"$"#,##0.0,_);\\("$"#,##0.0,\\)','"$"#,##0.0;\\("$"#,##0.0\\);','"$"#,##0.0_);\\("$"#,##0.0\\)','"$"\\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','_ "$"\\ * #,##0.0_ ;_ "$"\\ * \\-#,##0.0_ ;_ "$"\\ * "-"??_ ;_ @_ ','_("$"* #,##0.0_);_("$"* \\(#,##0.0\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.0_);_("$"* \\(#,##0.0\\);_("$"* "-"?_);_(@_)','_("$"* #,##0.0_);_("$"* \\(#,##0.0\\);_("$"* "-"_);_(@_)','_-"$"* #,##0.0_-;\\-"$"* #,##0.0_-;_-"$"* "-"_-;_-@_-','"$"#,##0.0_%_);\\("$"#,##0.0\\)_%;"$"#,##0.0_%_);@_%_)','"$"#,##0.00','"$"#.000','"$"\\ #,##0.00','"$"#,##0.00,_);\\("$"#,##0.00,\\)','"$"#,##0.00;\\("$"#,##0.00\\)','"$"#,##0.00;\\-"$"#,##0.00','"$"#,##0.00_);\\("$"#,##0.00\\)','"$"\\ \\ \\ #,##0.00_);\\("$"\\ \\ \\ #,##0.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','_ "$"\\ * #,##0.00_ ;_ "$"\\ * \\-#,##0.00_ ;_ "$"\\ * "-"??_ ;_ @_ ','_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"????_);_(@_)','_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"???_);_(@_)','_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"_);_(@_)','_("$"\\ * #,##0.00_);_("$"\\ * \\(#,##0.00\\);_("$"\\ * "-"??_);_(@_)','_-"$"* #,##0.00_-;\\-"$"* #,##0.00_-;_-"$"* "-"??_-;_-@_-','"$"#,##0.00_%_);\\("$"#,##0.00\\)_%;"$"#,##0.00_%_);@_%_)','"$"#,##0.000','"$"0.000','"$"0000','"$"#,##0.000_);\\("$"#,##0.0\\)','"$"#,##0.000_);\\("$"#,##0.00\\)','"$"#,##0.000_);\\("$"#,##0.000\\)','_("$"* #,##0.000_);_("$"* \\(#,##0.000\\);_("$"* "-"???_);_(@_)','_("$"* #,##0.000_);_("$"* \\(#,##0.000\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.000_);_("$"* \\(#,##0.000\\);_("$"* "-"_);_(@_)','"$"#,##0.0000','"$"0.0000','"$"#,##0.0000_);\\("$"#,##0.00\\)','"$"#,##0.0000_);\\("$"#,##0.0000\\)','_("$"* #,##0.0000_);_("$"* \\(#,##0.0000\\);_("$"* "-"????_);_(@_)','_("$"* #,##0.0000_);_("$"* \\(#,##0.0000\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.0000_);_("$"* \\(#,##0.0000\\);_("$"* "-"_);_(@_)','"$"#,##0.00000','"$"#,##0.00000_);\\("$"#,##0.000\\)','"$"#,##0.00000_);\\("$"#,##0.00000\\)','_("$"* #,##0.00000_);_("$"* \\(#,##0.00000\\);_("$"* "-"?????_);_(@_)','_("$"* #,##0.00000_);_("$"* \\(#,##0.00000\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.00000_);_("$"* \\(#,##0.00000\\);_("$"* "-"_);_(@_)','"$"#,##0.000000','"$"#,##0.000000_);\\("$"#,##0.000000\\)','_("$"* #,##0.000000_);_("$"* \\(#,##0.000000\\);_("$"* "-"??????_);_(@_)','_("$"* #,##0.000000_);_("$"* \\(#,##0.000000\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.000000_);_("$"* \\(#,##0.000000\\);_("$"* "-"_);_(@_)','"$"#,##0.0000000','"$"#,##0.0000000_);\\("$"#,##0.0000000\\)','_("$"* #,##0.0000000_);_("$"* \\(#,##0.0000000\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.0000000_);_("$"* \\(#,##0.0000000\\);_("$"* "-"_);_(@_)','"$"#,##0.00000000','"$"#,##0.00000000_);\\("$"#,##0.00000000\\)','_("$"* #,##0.00000000_);_("$"* \\(#,##0.00000000\\);_("$"* "-"??_);_(@_)','"$"#,##0.000000000_);\\("$"#,##0.000000000\\)','_("$"* #,##0.000000000_);_("$"* \\(#,##0.000000000\\);_("$"* "-"??_);_(@_)','"$"#,##0.0000000000_);\\("$"#,##0.0000000000\\)','"$"#,##0.0000000;[Red]\\-"$"#,##0.0000000','"$"#,##0.0000000_);[Red]\\("$"#,##0.0000000\\)','"$"#,##0.000000_);[Red]\\("$"#,##0.000000\\)','"$"#,##0.000000_);[Red]\\("$"#,##0.000000\\);"- "_)','"$"#,##0.00000;[Red]\\-"$"#,##0.00000','"$"#,##0.00000_);[Red]\\("$"#,##0.00000\\)','"$"#,##0.0000;[Red]\\-"$"#,##0.0000','"$"#,##0.0000_);[Red]\\("$"#,##0.0000\\)','"$"#,##0.0000_);[Red]\\("$"#,##0.0000\\);"- "_)','"$"#,##0.000" /GJ"','"$"#,##0.000_);[Red]\\("$"#,##0.000\\)','"$"#,##0.00" /GJ"','"$"#,##0.00" /mmbtu"','"$"#,##0.00" /MWh"','"$"#,##0.00;[Red]"$"#,##0.00','"$"#,##0.00;[Red]\\-"$"#,##0.00','"$"#,##0.00_);[Red]\\("$"#,##0.00\\)','"$"#,##0.00_);[Red]\\("$"#,##0.00\\);','"$"#,##0.00_);[Red]\\("$"#,##0.00\\);"- "_)','"$"#,##0.00_);[Red]\\("$"#,##0.00\\);"-"','"$"* #,##0.00;[Red]\\ \\("$"* #,##0.00\\)','"$"\\ #,##0.00;[Red]"$"\\ \\-#,##0.00','"$"\\ #,##0.00_);[Red]\\("$"\\ #,##0.00\\)','"$"\\ \\ #,##0.00_);[Red]\\("$"\\ \\ #,##0.00\\)',"\\$#,##0.00;[Red]\\$\\(#,##0.00\\);\\-",'"$"0.0"MM"','"$"#,##0.0;[Red]\\("$"#,##0.0\\)','"$"#,##0.0;[Red]\\-"$"#,##0.0','"$"#,##0.0_);[Red]\\("$"#,##0.0\\)','"$"#,##0.0_);[Red]\\("$"#,##0.0\\);','"$"#,##0.0_);[Red]\\("$"#,##0.0\\);"- "_)','"$"\\ \\ #,##0.0_);[Red]\\("$"\\ \\ #,##0.0\\)','"$"0" / kW"','"$"0"MM"','"$"#,##0\\ "/MW"','"$"#,##0\\ "/MWh"','"$"#,##0\\ "/MWH"','"$"#,##0;[Red]"$"#,##0','"$"#,##0;[Red]\\-"$"#,##0','"$"#,##0_);[Red]\\("$"#,##0\\)','"$"#,##0_);[Red]\\("$"#,##0\\);"- "_)','"$"#,##0_);[Red]\\<"$"#,##0\\>','"$"\\ #,##0;[Red]\\-"$"\\ #,##0','"$"\\ #,##0_);[Red]\\("$"\\ #,##0\\)','"$"\\ \\ #,##0_);[Red]\\("$"\\ \\ #,##0\\)','"$"\\ \\ \\ #,##0_);[Red]"$"\\ \\ \\ \\(#,##0\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ #,##0_);[Red]"$"\\ \\ \\ \\(#,##0\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','_("$"* #,##0_);[Red]_("$"* \\(#,##0\\);_("$"* "-"??_);_(@_)','_("$"* #,##0_);[Red]_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',"[$CAD]\\ #,##0.000","[$CAD]\\ #,##0.000_);\\([$CAD]\\ #,##0.000\\)","[$R$ -416]#,##0_);\\([$R$ -416]#,##0\\)","[$R$ -416]#,##0.00_);\\([$R$ -416]#,##0.00\\)","[$R$-416]#,##0.0000_);[Red]\\([$R$-416]#,##0.0000\\)","[$R$-416]#,##0.000_);[Red]\\([$R$-416]#,##0.000\\)","[$R$-416]#,##0.00_);[Red]\\([$R$-416]#,##0.00\\)","[$R$-416]#,##0_);[Red]\\([$R$-416]#,##0\\)",'"£"#,##0','"£"#,##0;\\-"£"#,##0',"\\£#,##0_);\\(\\£#,##0\\)",'_ "£"* #,##0_ ;_ "£"* \\-#,##0_ ;_ "£"* "-"_ ;_ @_ ','_("£"* #,##0_);_("£"* \\(#,##0\\);_("£"* "-"_);_(@_)','_-"£"* #,##0_-;\\-"£"* #,##0_-;_-"£"* "-"_-;_-@_-','"£"#,##0.0',"\\£#,##0.0_);\\(\\£#,##0.0\\)",'"£"#,##0.00','"£"#,##0.00;\\-"£"#,##0.00',"\\£#,##0.00_);\\(\\£#,##0.00\\)",'_ "£"* #,##0.00_ ;_ "£"* \\-#,##0.00_ ;_ "£"* "-"??_ ;_ @_ ','_("£"* #,##0.00_);_("£"* \\(#,##0.00\\);_("£"* "-"??_);_(@_)','_-"£"* #,##0.00_-;\\-"£"* #,##0.00_-;_-"£"* "-"??_-;_-@_-',"\\£#,##0.000_);\\(\\£#,##0.000\\)","\\£#,##0.0000_);\\(\\£#,##0.0000\\)",'_-"£"* #,##0.0000_-;\\-"£"* #,##0.0000_-;_-"£"* "-"??_-;_-@_-','"£"#,##0.00;[Red]\\-"£"#,##0.00','"£"#,##0.00_);[Red]\\("£"#,##0.00\\)',"\\£#,##0.00_);[Red]\\(\\£#,##0.00\\)","\\£#,##0.0_);[Red]\\(\\£#,##0.0\\)",'"£"#,##0;[Red]\\-"£"#,##0','"£"#,##0_);[Red]\\("£"#,##0\\)',"\\£#,##0_);[Red]\\(\\£#,##0\\)","###\\ ###\\ ###\\ ###.0","###0","#,###.0#","#,###_);\\(#,##0\\);\\ \\-_ ","#,###___);\\(#,##0\\);\\ \\-\\ __","#,##0.##","#,##0.####","#,##0_)","#.0%","#0",'"#"\\ 0',"\\(0\\)",'0%;_("-"\\)',"0%\\ \\ ","0.",'0"  "',"0_)","0_;",'0" $/MWh"','#,##0"£"_);\\(#,##0"£"\\)','_ * #,##0_)"£"_ ;_ * \\(#,##0\\)"£"_ ;_ * "-"_)"£"_ ;_ @_ ','_ * #,##0_)_£_ ;_ * \\(#,##0\\)_£_ ;_ * "-"_)_£_ ;_ @_ ','#,##0"£"_);[Red]\\(#,##0"£"\\)',"#,###.00###","#,###.00###\\ \\ \\ ","#,##0.;\\-#,##0.","#,##0.0","#,##0.0___;","#,##0;\\(#,##0\\)","#,##0;\\(#,##0\\);\\-\\-","#,##0;\\-#,##0",'#,##0;\\-#,##0;"-"',"#,##0\\ ;\\(#,##0\\)","#,##0_ ;\\-#,##0\\ ","#,##0_ \\ ;\\(#,##0\\ \\ \\)","#,##0_);\\(#,##0\\);",'#,##0_);\\(#,##0\\);\\ "  -"',"#,##0_);\\(#,##0\\);\\ \\-\\ ","#,##0_);\\(#,##0\\);\\ \\-\\ \\ ","#,##0_);\\(#,##0\\);\\ \\-\\ \\ \\ \\ ","#,##0_);\\(#,##0\\);\\-","#,##0_);\\(#,##0\\);\\-\\ \\ ","#,##0_);\\(#,##0\\);\\-_)","#,##0_);\\(#,##0\\);\\-_)_ _ ","#,##0_);\\(#,##0\\);_ \\-\\ \\ ","#,##0_);\\(#,##0\\)\\ ;\\-_)_ _ ","#,##0_);\\(#,##0\\)\\-","#,##0_)_ ;\\(#,##0\\)\\ ;\\ \\-_ _)","#,##0_)_ ;\\(#,##0\\)\\ ;\\-_)_ _ ","#,##0___);\\(#,##0\\);\\ \\-\\ __","#,##0___);\\(#,##0\\);\\ \\-__\\ \\ ","#,##0___);\\(#,##0\\);___-\\ \\ ","#,##0___);\\(#,##0\\)_;\\ \\-__\\ \\ ","#,##0___);\\(#,##0\\)___;\\ \\-__\\ \\ ","#,##0_____);\\(#,##0\\);_____-\\ \\ ","#,##0_________);\\(#,##0\\);_________-\\ \\ ","#,#00",".00",'"**"_(* #,##0_);_(* \\(#,##0\\);_(* "-"??_);_(@_)','"*"_(* #,##0_);_(* \\(#,##0\\);_(* "-"??_);_(@_)','"\\"#,##0;"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;"\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;"\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;"\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;"\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;\\-"\\"#,##0',"\\(#,##0_)\\);\\(#,##0\\)",'_ * #,##0_ ;_ * "\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * "\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * "\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * "\\""\\""\\""\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * "\\""\\""\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * "\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * \\-#,##0_ ;_ * "-"??_ ;_ @_ ','_ * #,##0_ ;_ * \\-#,##0_ ;_ * "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* \\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ',"_##,##0_);\\(#,##0\\);\\-_)_ _ ","_##,##0_);\\(#,##0\\)\\ ;\\-_)_ _ ","_(##0_);\\(##0\\)_ ;\\-_)_ _ ",'_(#,##0_);\\(#,##0\\);"-    "','_(* #,##0_);_(* \\(#,##0\\);_(* "-"???_);_(@_)','_(* #,##0_);_(* \\(#,##0\\);_(* "-"??_);_(@_)','_(* #,##0_);_(* \\(#,##0\\);_(* "-"?_);_(@_)','_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)','_(* #,##0_);_(* \\(#,##0\\);_(* ""??_);_(@_)','_-* #,##0_-;\\-* #,##0_-;_-* "-"??_-;_-@_-','_-* #,##0_-;\\-* #,##0_-;_-* "-"_-;_-@_-','_-* #,##0_-;_-* #,##0\\-;_-* "-"??_-;_-@_-','_-"\\"* #,##0_-;\\-"\\"* #,##0_-;_-"\\"* "-"_-;_-@_-',"0%\\-0%","0.0","0.0%",'0.0%;_(* "-"_)','0.0%;_("-"\\)','0.0%;_("-"_)','0.0%;_(\\ "-"_)',"0.0%\\ \\)",'0.0%\\-;_("-"_)','0.0"  "','0.0"%"','0.0_ "  "',"0.0_)","0.0_;","0.0____","0;\\-0;","0;\\-0;;","0;\\-0;;@\\ ","0_ ;\\-0\\ ","0_);\\(0\\)","00","###0_%_);\\(#,##0\\)_%;#,##0_%_);@_%_)","#,###.0_);\\(#,##0.0\\);\\ \\-\\ _ ","#,##0.00#","#,##0.00###","#,##0.00__;","#,##0_%_);\\(#,##0\\)_%;#,##0_%_);@_%_)","#,##0_);\\(#,##0\\);#,##0_);@_)",'"@ "\\&0.00%','"@ "0.00%','_(* #,##0_);_(* \\(#,##0\\);_(* "0"??_);_(@_)',"0%_);\\(0%\\);0%_);@_%_)","0.00#%",'0.00%;_(* "-"_)','0.00%;_("-"\\)',"0.00;;",'0.00"  "',"0.00_)","0_%_);\\(0\\)_%;0_%_);@_%_)","000","000#",'#,##0.00" $";\\-#,##0.00" $"',"#,##0.00\\ [$DM-407]","#,##0.00\\ [$EUR-407]",'#,##0.00" $";[Red]\\-#,##0.00" $"','#,##0.00"£"_);\\(#,##0.00"£"\\)','_ * #,##0.00_)"£"_ ;_ * \\(#,##0.00\\)"£"_ ;_ * "-"??_)"£"_ ;_ @_ ','_ * #,##0.00_)_£_ ;_ * \\(#,##0.00\\)_£_ ;_ * "-"??_)_£_ ;_ @_ ','#,##0.00"£"_);[Red]\\(#,##0.00"£"\\)',"##0.000","#,##0.0%_);\\(#,##0.0%\\);","#,##0.0_);\\(#,##0.0\\)","#,##0.0_);\\(#,##0.0\\);\\ \\-\\ \\ ","#,##0.0_);\\(#,##0.0\\);_ \\ \\-","#,##0.0____\\);\\(#,##0.0\\);___ \\-\\ \\ ","#,##0.0_______);\\(#,##0.0\\);______\\ \\-\\ \\ ","#,##0.0________\\);\\(#,##0.0\\);_______ \\-\\ \\ ","#,##0.0________\\);\\(#,##0.0\\);________\\ \\-\\ \\ ","#,##0.0_________);\\(#,##0.0\\);\\ \\-\\ \\ ","#,##0.0_________);\\(#,##0.0\\);________\\ \\-\\ \\ ","#,##0.000","#,##0.000___;",".0000",".0000%",'_(* #,##0.0_);_(* \\(#,##0.0\\);_(* "-"??_);_(@_)','_(* #,##0.0_);_(* \\(#,##0.0\\);_(* "-"?_);_(@_)','_(* #,##0.0_);_(* \\(#,##0.0\\);_(* "-"_);_(@_)','_-* #,##0.0_-;\\-* #,##0.0_-;_-* "-"??_-;_-@_-','_-* #,##0.0_-;\\-* #,##0.0_-;_-* "-"_-;_-@_-',"0.0%;\\(0.0\\)%;\\ \\-\\ \\ ",'0.0%;\\-0.0%;\\ "-"_%;@_%',"0.0%\\ ;\\(0.0\\)%\\ ;\\-\\ \\ \\ ","0.0%\\);\\(0.0\\)%;\\ \\-","0.0%_);\\(0.0%\\)","0.0%_);\\(0.0\\)%;\\ \\-","0.0%_;\\(0.0\\)%;\\ \\-\\ \\ \\ ","0.0_%;\\(0.0\\)%;\\ \\-\\ \\ \\ ","0.0_);\\(0.0\\)","0.000","0.000%",'0.000%;_("-"\\)',"0.000_)","0.000_;","0000","##0.000\\ \\¢","#,##0.00_);\\(#,##0.0\\)","#,##0.0000","#,##0.0000___;","0.0000","0.0000%",'0.0000%;_(* "-"_)','0.0000%;_("-"\\)','0.0000"  "',"0.0000\\ %","0.0000_)","00\\-000","00\\-000_)","00000","###0.00_);\\(#,##0.00\\)","#,##0.0%_);\\(#,##0.0%\\);0.0%_);@_%_)","#,##0.0_%_);\\(#,##0.0\\)_%;#,##0.0_%_);@_%_)","#,##0.0_);\\(#,##0.0\\);#,##0.0_);@_)","#,##0.00%_);\\(#,##0.00%\\)","#,##0.00;#,##0.00;","#,##0.00;\\(#,##0.00\\)","#,##0.00;\\(#,##0.00\\);\\-\\-","#,##0.00_);\\(#,##0.00\\);\\ \\-\\ ","#,##0.00_);\\(#,##0.00\\);\\-","#,##0.00_);\\(#,##0.00\\);\\-\\ \\ ","#,##0.00_);\\(#,##0.00\\);_ \\ \\-","#,##0.00_);\\(#,##0.00\\);_ \\-\\ \\ ","#,##0.00__\\);\\(#,##0.00\\);__\\ \\ \\-","#,##0.00___);\\(#,##0.00\\);___ \\ \\-","#,##0.00___);\\(#,##0.00_);\\ \\-\\ \\ \\ ","#,##0.00000","#,##0.00000___;",'"\\"#,##0.00;"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\"\\-#,##0.00','"\\"#,##0.00;\\-"\\"#,##0.00','_ * #,##0.00_ ;_ * "\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ * #,##0.00_ ;_ * "\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ * #,##0.00_ ;_ * "\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ * #,##0.00_ ;_ * "\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ * #,##0.00_ ;_ * "\\""\\""\\""\\"\\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ * #,##0.00_ ;_ * \\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* \\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"????_);_(@_)','_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)','_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"?_);_(@_)','_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"_);_(@_)','_-* #,##0.00_-;\\-* #,##0.00_-;_-* "-"??_-;_-@_-','_-* #,##0.00_-;\\-* #,##0.00_-;_-* "-"_-;_-@_-','_-* #,##0.00_-;_-* #,##0.00\\-;_-* "-"??_-;_-@_-','_-"\\"* #,##0.00_-;\\-"\\"* #,##0.00_-;_-"\\"* "-"??_-;_-@_-',"0.0%_);\\(0.0%\\);0.0%_);@_%_)","0.0\\%_);\\(0.0\\%\\);0.0\\%_);@_%_)","0.00%_);\\(0.00%\\)","0.00;\\-0.00;","0.00_);\\(0.00\\)","0.00000","0.00000%",'0.00000"  "',"0.00000_)","000000","#,###.000_);\\(#,##0.000\\);\\ \\-\\ _ ","#,##0.000000","0.000000","0.000000%","0.000000_)","#,##0.000;\\(#,##0.000\\)","#,##0.000;\\(#,##0.000\\);\\-\\-","#,##0.000_);\\(#,##0.000\\)","#,##0.000_);\\(#,##0.000\\);\\ \\-\\ \\ ","#,##0.000_);\\(#,##0.000\\);\\-","#,##0.000_);\\(#,##0.000\\);_ \\-\\ \\ ","#,##0.0000000",'_(* #,##0.000_);_(* \\(#,##0.000\\);_(* "-"???_);_(@_)','_(* #,##0.000_);_(* \\(#,##0.000\\);_(* "-"??_);_(@_)','_(* #,##0.000_);_(* \\(#,##0.000\\);_(* "-"?_);_(@_)','_(* #,##0.000_);_(* \\(#,##0.000\\);_(* "-"_);_(@_)','_-* #,##0.000_-;\\-* #,##0.000_-;_-* "-"??_-;_-@_-',"_00000000","0.000_);\\(0.000\\)","0.0000000","0.0000000%","0.0000000_)","0000\\ \\-\\ 0000","00000000","#,###.0000_);\\(#,##0.0000\\);\\ \\-\\ _ ","#,##0.00_%_);\\(#,##0.00\\)_%;#,##0.00_%_);@_%_)","#,##0.00000000","0.00%_);\\(0.00%\\);0.00%_);@_%_)","0.00000000","0.00000000%","0.00000000_)","000\\-00\\-0000","000000000","#,##0.0000;\\(#,##0.0000\\)","#,##0.0000;\\-#,##0.0000","#,##0.0000_);\\(#,##0.0000\\)","#,##0.0000_);\\(#,##0.0000\\);_ \\-\\ \\ ","#,##0.0000_);\\(#,##0.0000_)","#,##0.0000___);\\(#,##0.0000_);\\ \\-\\ \\ \\ ","#,##0.000000000","\\(000\\)000\\-0000",'_(* #,##0.0000_);_(* \\(#,##0.0000\\);_(* "-"????_);_(@_)','_(* #,##0.0000_);_(* \\(#,##0.0000\\);_(* "-"??_);_(@_)','_(* #,##0.0000_);_(* \\(#,##0.0000\\);_(* "-"?_);_(@_)','_(* #,##0.0000_);_(* \\(#,##0.0000\\);_(* "-"_);_(@_)','_-* #,##0.0000_-;\\-* #,##0.0000_-;_-* "-"??_-;_-@_-',"0.0000_);\\(0.0000\\)","0.000000000","0.000000000%","0.000000000_)","0000000000","#,###.00000_);\\(#,##0.00000\\);\\ \\-\\ _ ","#,##0.0000000000","0.0000000000","0.0000000000_)","#,##0.00000_);\\(#,##0.00000\\)","#,##0.00000000000",'_(* #,##0.00000_);_(* \\(#,##0.00000\\);_(* "-"?????_);_(@_)','_(* #,##0.00000_);_(* \\(#,##0.00000\\);_(* "-"??_);_(@_)','_(* #,##0.00000_);_(* \\(#,##0.00000\\);_(* "-"_);_(@_)','_-* #,##0.00000_-;\\-* #,##0.00000_-;_-* "-"??_-;_-@_-',"0.00000_);\\(0.00000\\)","0.00000000000","0.00000000000_)","#,###.000000_);\\(#,##0.000000\\);\\ \\-\\ _ ","0.000000000000","#,##0.000000_);\\(#,##0.000000\\)",'_(* #,##0.000000_);_(* \\(#,##0.000000\\);_(* "-"??_);_(@_)','0.000000%;\\-0.000000%;\\ "-"_%;@_%',"0.0000000000000","0.0000000000000_)","0.00000000000000%","#,##0.0000000_);\\(#,##0.0000000\\)",'_(* #,##0.0000000_);_(* \\(#,##0.0000000\\);_(* "-"??_);_(@_)',"0.0000000_);\\(0.0000000\\)","0.000000000000000%","0.0000000000000000","#,##0.00000000_);\\(#,##0.00000000\\)",'_(* #,##0.00000000_);_(* \\(#,##0.00000000\\);_(* "-"??_);_(@_)',"0.00000000000000000","0.00000000000000000%","0.000000000000000000","0.000000000000000000%","#,##0.000000000_);\\(#,##0.000000000\\)",'_(* #,##0.000000000_);_(* \\(#,##0.000000000\\);_(* "-"??_);_(@_)',"#,##0.00000000000000000000","#,##0.0000000000_);\\(#,##0.0000000000\\)",'_(* #,##0.0000000000_);_(* \\(#,##0.0000000000\\);_(* "-"_);_(@_)',"0.0000000000000000000000","0.0000000000000000000000%",'_(* #,##0.000000000000_);_(* \\(#,##0.000000000000\\);_(* "-"_);_(@_)',"0.0000000000000000000000000","0.00000000000000000000000000",'_(* #,##0.0000000000000_);_(* \\(#,##0.0000000000000\\);_(* "-"_);_(@_)',"0.000000000000000000000000000","0.0000000000000000000000000000",'_(* #,##0.00000000000000_);_(* \\(#,##0.00000000000000\\);_(* "-"??_);_(@_)','_(* #,##0.00000000000000_);_(* \\(#,##0.00000000000000\\);_(* "-"_);_(@_)',"0.000000000000000000000000000000","0.00000000000000000000000000000000","#,##0.0000000000000000_);\\(#,##0.0000000000000000\\)","0.000000000000000000000000000000000","0.0000000000000000000000000000000000","0.00000000000000000000000000000000000","#,##0.00000000000000000000_);[Red]\\(#,##0.00000000000000000000\\)","#,##0.0000000000000_);[Red]\\(#,##0.0000000000000\\)","#,##0.000000000000_);[Red]\\(#,##0.000000000000\\)","#,##0.00000000000_);[Red]\\(#,##0.00000000000\\)","#,##0.0000000000_);[Red]\\(#,##0.0000000000\\)","#,##0.00000000_);[Red]\\(#,##0.00000000\\)","#,##0.0000000_);[Red]\\(#,##0.0000000\\)","#,##0.000000_);[Red]\\(#,##0.000000\\)","0.000000\\x_);\\(0.000000\\x\\)","0.00000E+00","#,##0.00000_);[Red]\\(#,##0.00000\\)","0.00000_);[Red]\\(0.00000\\)","0.0000E+00","###0.0000_);[Red]\\(###0.0000\\)","#,##0.0000\\ ;[Red]\\(#,##0.0000\\)","#,##0.0000_ ;[Red]\\-#,##0.0000\\ ","#,##0.0000_);[Red]\\(#,##0.0000\\)","0.0000%;[Red]\\-0.0000%","0.0000%\\ ;[Red]\\(0.0000%\\)","0.0000;[Red]0.0000","0.0000_ ;[Red]\\-0.0000\\ ","0.0000_);[Red]\\(0.0000\\)","0.0000\\x_);\\(0.0000\\x\\)","0.000E+00","0.000E+00_)",'0.000" MWh/GJ"',"###0.000_);[Red]\\(###0.000\\)","#,##0.000;[Red]\\(#,##0.000\\)","#,##0.000;[Red]\\(#,##0.000\\);\\-","#,##0.000\\ ;[Red]\\(#,##0.000\\)","#,##0.000_);[Red]\\(#,##0.000\\)","0.000;[Red]0.000","0.000_);[Red]\\(0.000\\)","0.000_);[Red]\\-0.000_)","#,##0.0_%_);\\(#,##0.0\\)_%;[White]#,##0.0_%_);@_%_)",'0.00%" Capitalization Rate"','0.00%" Discount Rate"','_-* #,##0.00\\ "DM"_-;\\-* #,##0.00\\ "DM"_-;_-* "-"??\\ "DM"_-;_-@_-','_-* #,##0.00\\ _D_M_-;\\-* #,##0.00\\ _D_M_-;_-* "-"??\\ _D_M_-;_-@_-','#,##0.00" F"_);\\(#,##0.00" F"\\)','_-* #,##0.00\\ "F"_-;\\-* #,##0.00\\ "F"_-;_-* "-"??\\ "F"_-;_-@_-','_-* #,##0.00\\ _F_-;\\-* #,##0.00\\ _F_-;_-* "-"??\\ _F_-;_-@_-','0.00" GJ//MWh"','0.00" GJ/MWh"','0.00\\ "MW"','0.00%" of Avg LTD"','0.00%" of Sales"','0.00%" perpetual annual growth"','_-* #,##0.00\\ "Pts"_-;\\-* #,##0.00\\ "Pts"_-;_-* "-"??\\ "Pts"_-;_-@_-','_-* #,##0.00\\ _P_t_s_-;\\-* #,##0.00\\ _P_t_s_-;_-* "-"??\\ _P_t_s_-;_-@_-',"###0.00_);[Red]\\(###0.00\\)","#,##0.00%_);[Red]\\(#,##0.00%\\)","#,##0.00;[Red]#,##0.00",'#,##0.00;[Red]"-"#,##0.00',"#,##0.00;[Red]\\(#,##0.00\\)","#,##0.00;[Red]\\(#,##0.00\\);\\-","#,##0.00\\ ;[Red]\\(#,##0.00\\)","#,##0.00\\ \\);[Red]\\(#,##0.00\\)","#,##0.00_ ;[Red]\\-#,##0.00\\ ",'#,##0.00_);[Red]\\(#,##0.00\\);"-"','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\"\\-#,##0.00','"\\"#,##0.00;[Red]\\-"\\"#,##0.00','_(* #,##0.00_);[Red]_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',"0.00%;[Red]\\(0.00%\\)","0.00%\\ ;[Red]\\(0.00%\\)","0.00%\\ ;[Red]\\(0.00%\\);\\-","0.00;[Red]0.00","0.00_ ;[Red]\\-0.00\\ ","0.00_);[Red]\\(0.00\\)","0.00_);[Red]\\(0.00\\);;","#,##0.00_);[Red]\\(#,##0.00\\)*1000","0.00\\x",'_(* #,##0.00\\x\\ \\ ;_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',"0.00\\x_);\\(0.00\\x\\)","_(##0_);\\(##0\\)_1;\\-_)_ _ ",'""0.0%" --\x3e 61.5% of Sales 1st 5 yrs.; steady state thereafter"','00\\ "Coal Upgrade"',"0.0E+00",'0.0" GJ/MWh"','00\\ "Hydro"','00\\ "Incremental"','0.0" mmbtu//MWh"','0.0%" of beg. Net PPE + Intgble Amort."','0.0%" of Sales"','0.0%" of Total Assets"',"#,##0.0_);[Red]\\(#,##0\\)","###0.0_);[Red]\\(###0.0\\)","#,##0.0;[Red]\\(#,##0.0\\)","#,##0.0;[Red]\\(#,##0.0\\);\\-","#,##0.0;[Red]\\-#,##0.0","#,##0.0\\ ;[Red]\\(#,##0.0\\)","#,##0.0_ ;[Red]\\-#,##0.0\\ ","#,##0.0_);[Red]\\(#,##0.0\\)","#,##0.0_);[Red]\\(#,##0.0\\);","#,##0.0_);[Red]\\(#,##0.0\\);\\-","0.0%;[Red]\\(0.0%\\)","0.0%\\ ;[Red]\\(0.0%\\)","0.0%_);[Red]\\(0.0%\\)","0.0_);[Red]\\(0.0\\)","0.0_);[Red]\\-0.0_)","#,##0.0_);[Red]\\(#,##0.0\\)*1000",'0.0"x"','0.0\\ "x"',"0.0\\x","#,##0.0\\x_);\\(#,##0.0\\x\\)","#,##0.0\\x_);\\(#,##0.0\\x\\);",'0.0\\x_)_);"NM"_x_)_);0.0\\x_)_);@_%_)',"#,##0.0\\x_);[Red]\\(#,##0.0\\x\\);",'0%\\ "Beg. Net PPE + Intangibles"','0" Days"','_-* #,##0\\ "DM"_-;\\-* #,##0\\ "DM"_-;_-* "-"\\ "DM"_-;_-@_-','_-* #,##0\\ _D_M_-;\\-* #,##0\\ _D_M_-;_-* "-"\\ _D_M_-;_-@_-',"#,##0_e","0.E+00","0E+00","0\\ \\f",'_-* #,##0\\ "F"_-;\\-* #,##0\\ "F"_-;_-* "-"\\ "F"_-;_-@_-','_-* #,##0\\ _F_-;\\-* #,##0\\ _F_-;_-* "-"\\ _F_-;_-@_-','#,##0" GJ/D"','0\\ "Hydro"','0" / kW"','0\\ "Last Year"','#,##0" MMBTUs";\\-#,##0" MMBTUs"','0" months"','0\\ "mos"','0" MW"','#,##0" MWh";\\-#,##0" MWh"','#,##0" MWh/D"','#,##0_)"MWH";[Red]\\("$"#,##0\\);"- "_)','#,##0_)"mW";[Red]\\("$"#,##0\\);"- "_)','0\\ " of"','0%" of Sales"','_-* #,##0\\ "Pts"_-;\\-* #,##0\\ "Pts"_-;_-* "-"\\ "Pts"_-;_-@_-','_-* #,##0\\ _P_t_s_-;\\-* #,##0\\ _P_t_s_-;_-* "-"\\ _P_t_s_-;_-@_-',"#,##0_r_)",'#,##0"r"_)',"###0_);[Red]\\(#,##0\\)","##,##0;[Red]\\(##,##0\\)","#,##0;[Red]#,##0",'#,##0;[Red]"-"#,##0',"#,##0;[Red]\\(#,##0\\)","#,##0;[Red]\\(#,##0\\);\\-","#,##0;[Red]\\-#,##0","#,##0;[Red]\\-#,##0;\\-","#,##0\\ ;[Red]\\(#,##0\\)","#,##0_ ;[Red]\\-#,##0\\ ","#,##0_);[Red]\\(#,##0\\);","#,##0_);[Red]\\(#,##0\\);;",'#,##0_);[Red]\\(#,##0\\);"-   "','#,##0_);[Red]\\(#,##0\\);"- "_)','#,##0_);[Red]\\(#,##0\\);"-"',"#,##0_);[Red]\\(#,##0\\);\\-","#,##0_);[Red]\\<#,##0\\>","#.0,,;[Red]\\(#.0,,\\)",'"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\"\\-#,##0','"\\"#,##0;[Red]\\-"\\"#,##0','_(* #,##0_);[Red]* \\(#,##0\\);_(* "-"_);_(@_)','_(* #,##0_);[Red]\\(* \\(#,##0\\);_(* "-"_);_(@_)',"0%\\ ;[Red]\\(0%\\)",'0%\\ ;[Red]\\(0%\\)\\ ;"-  "',"0%\\);[Red]\\(0%\\)","0%_);[Red]\\(0%\\)","0;[Red]0","0_);[Red]\\(0\\)","0_);[Red]\\(0\\);;","0_);[Red]\\-0_)","#,##0_);[Red]\\(#,##0,\\)*1000",'0%" Tax Rate"','0\\ "Wind"','0\\ "WTG"','0" Year"','0" years"',"0\\ \\y\\e\\a\\r\\s",'0"  Years"',"\\10000000","#?/12","#\\ ?/32","#\\ ?/32;[Red]\\(#?/32\\)","#\\ ?/32;[Red]\\(#\\ ?/32\\)","#\\ ?/4","#\\ ?/64","[<=9999999]###\\-####;\\(###\\)\\ ###\\-####",'"and"\\ 0\\ "--\x3e6-year average"','"As of "\\ mm/dd/yy','"As of "mmmm\\ dd\\,\\ yyyy','"As of"\\ mmmm\\ dd\\,\\ yyyy','"As of "mmmm\\ d\\,\\ yyyy','"Ave. Debt Bal. * "0.00%" cost * (1-t)"','#\\ "BP"','_(\\C"$"* #,##0.00000_);_(\\C"$"* \\(#,##0.00000\\);_(\\C"$"* "0"_);_(@_)','\\C"$"#,##0_);\\(\\C"$"#,##0\\)','_(\\C"$"* #,##0_);_(\\C"$"* \\(#,##0\\);_(\\C"$"* "0"_);_(@_)','\\C"$"\\ #,##0\\);[Red]\\(\\C"$"\\ #,##0\\)','"Canada Cash Desk Economics (CDN$) for"\\ mmm\\-yy\\ "as of:"','"Change since "mmmm\\ dd\\,\\ yyyy','"Changes Since "mmmm\\ dd\\,\\ yyyy','_ "CHF"\\ * #,##0.00_ ;_ "CHF"\\ * \\-#,##0.00_ ;_ "CHF"\\ * "-"??_ ;_ @_ ','"Converted at "_(* #,##0.0000_);_(* \\(#,##0.0000\\);_(* "-"??_);_(@_)','"Cr$"\\ #,##0_);\\("Cr$"\\ #,##0\\)','"Current Day ("mm/dd/yy") Theoretical Sensitivities"\\ ','"Curves Loaded for"\\ \\ mm/dd/yy','"DATE:"\\ dd\\-mmm\\-yy','"DATE="mm/dd/yy','#\\ "Day"',"dd","ddd","dddd","ddd\\ \\-\\ dd","ddd\\-dd","dddd\\ d\\ mmmm\\ yyyy","ddd\\-dd\\-mmm\\-yy","ddd\\ dd\\ mmm\\ yyyy\\ hh:mm","dd\\-ddd\\-yy","dddd\\ mmmm\\ dd\\ ","dddd\\,\\ mmmm\\ dd\\,\\ yyyy","dddd\\,\\ mmmm\\ d\\,\\ yyyy","dddd\\,\\ mmmm\\,\\ d\\,\\ yyyy","dddd\\,mmmm\\,d\\,yyyy","ddd\\,\\ mmm\\ d","ddd\\-mmm\\-dd","ddd\\ yy/mm/dd","dd\\-mmm_)","dd\\-mmm\\-yy","dd\\-mmm\\-yy_)","dd\\-mmm\\-yy_);[Red]dd\\-mmm\\-yy_)","dd\\ mmm\\ yyyy","dd\\-mmm\\-yyyy","ddmmyy",'"Detail of New Transactions By Originator - "mmmm\\,\\ yyyy','"Discount Rate of"\\ 0.00%',"d\\-mmm\\,ddd",'d\\-mmm\\-yy\\ "Cycle 6"',"d/mmm/yyyy","d\\-mmm\\-yyyy",'d\\-mmm\\-yyyy\\ "Cycle 6"',"d/m/yy\\ h:mm","d\\.m\\.yy\\ h:mm",'"down"\\ 0.0','"DR="0.00%','"Effective Date: "\\ dd\\-mmm\\-yyyy','"EQUITY CASH FLOW PV AT "#0.00"%"','"First Period Days =  "\\ 0','"Fuel Cost:"\\ 0.00',"General\\ ","General_)","General;[Red]\\-General","General_);[Red]\\-General_)","h","hh:mm","hh:mm\\ AM/PM","hh:mm\\ AM/PM_)","hh:mm:ss","[h]:mm",'h:mm:ss"\\""\\""\\""\\"\\ AM/PM','"Include";;"Exclude"','" K-"#','_ "kr"\\ * #,##0.00_ ;_ "kr"\\ * \\-#,##0.00_ ;_ "kr"\\ * "-"??_ ;_ @_ ','_ "kr"\\ * #,##0_ ;_ "kr"\\ * \\-#,##0_ ;_ "kr"\\ * "-"_ ;_ @_ ','"LTD Through "mmmm\\ dd\\,\\ yyyy','##"m"',"m","m/d","m/dd/yyyy","m/d/yy","m/d/yy_%_)","m\\-d\\-yy","m/d/yy\\ h:mm","m/d/yy\\ h:mm\\ AM/PM","m\\/d\\/yyyy","m/d/yyyy\\ h:mm:ss","mm","mm/dd","mmdd","mm/dd/ddd","mm/dd/yy","mm/dd/yy_)","mm\\-dd\\-yy","mmddyy","mm/dd/yy\\ hh:mm","mm\\-dd\\-yy\\ hmm\\ AM/PM","mm/dd/yyyy",'mm"/"dd"/"yyyy',"mm\\-dd\\-yyyy","mm\\-dd\\-yyyy\\ ","mm\\/dd\\/yyyy","mm/dd/yyyy\\ hh:mm\\ AM/PM","mm/dd/yyyy\\ hh:mmAM/PM","mm\\-dd\\-yyyy\\ \\ hh:mm:ss\\ AM/PM\\ \\ ","mm\\-dd\\-yyyy\\ hh:mm:ss\\ AM/PM","mmm","mmm\\ d","mmm\\-dd","mmm\\-dd\\ \\ \\ h:mm\\ AM/PM","mmm\\ dd\\ yy_;","mmm\\-dd\\-yy","mmm\\-dd\\-yy\\ h:mm\\ AM/PM","mmm\\ dd\\ yyyy;","mmmddyyyy","mmm\\ dd\\ yyyy\\ hh:mm\\ AM/PM","mmm\\-d\\-yy","mmm\\-d\\-yy\\ ","mmm\\ d\\,\\ yyyy","mmmm","mmmm\\ d",'mmmm\\ dd","\\ yyyy',"mmmm\\ dd\\,\\ yyyy","mmmm\\ dd\\,\\ yyyy\\ \\ h:mm\\ AM/PM","\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ mmmm\\ d\\,\\ yyyy","mmmm\\ d\\,\\ yyyy","mmmmm","mm\\-mmm\\-yy","mmmm\\-yy","mmmm\\ yyyy","mmmm\\-yyyy","mmm\\ yy","mmm\\-yy_)","mmm\\.yy","mmm\\ yyyy","mmm\\,\\ yyyy","mmm\\-yyyy","mmm\\-yyyy_)","mm/yy","mm\\-yy","mm/yyyy","mm\\-yyyy",'"MTD Through "mmmm\\ dd\\,\\ yyyy',"m/yy","m\\/yy","m/yyyy","\\n\\o\\t\\ \\Q0",'"On";;"Off"','_("P"* #,##0.00_);_("P"* \\(#,##0.00\\);_("P"* "-"??_);_(@_)','_("P"\\ * #,##0.00_);_("P"\\ * \\(#,##0.00\\);_("P"\\ * "-"??_);_(@_)','_("P"* #,##0_);_("P"* \\(#,##0\\);_("P"* "-"_);_(@_)','_("P"\\ * #,##0_);_("P"\\ * \\(#,##0\\);_("P"\\ * "-"_);_(@_)','"Pmts per Year = "0',"\\P\\P\\ #,##0.00000_);\\(\\P\\P\\ #,##0.00000_)",'_("Ps. "* #,##0.00_);_("Ps. "* \\(#,##0.00\\);_("Ps. "* "-"??_);_(@_)','"Ps. "#,##0.00_);[Red]\\("Ps. "#,##0.00\\)','_("Ps. "* #,##0_);_("Ps. "* \\(#,##0\\);_("Ps. "* "-"_);_(@_)',"\\Q\\ 0","\\Q0",'_("R$"* #,##0.00_);_("R$"* \\(#,##0.00\\);_("R$"* "-"??_);_(@_)','_("R$"* #,##0_);_("R$"* \\(#,##0\\);_("R$"* "-"_);_(@_)',"[Red]#,##0;\\-#,##0","[Red]#,##0.0;[Blue]\\<#,##0.0\\>",'_-"Rs."* #,##0.00_-;\\-"Rs."* #,##0.00_-;_-"Rs."* "-"??_-;_-@_-','_-"Rs."* #,##0_-;\\-"Rs."* #,##0_-;_-"Rs."* "-"_-;_-@_-','_-"S/."\\ * #,##0.00_-;\\-"S/."\\ * #,##0.00_-;_-"S/."\\ * "-"??_-;_-@_-','_-"S/."\\ * #,##0_-;\\-"S/."\\ * #,##0_-;_-"S/."\\ * "-"_-;_-@_-','"Sales growth declines from "0.0%" to 10% in yr 5"','"Sensitivity Change from Prior Day ("mm/dd/yy")"','_ "SFr."* #,##0.00_ ;_ "SFr."* \\-#,##0.00_ ;_ "SFr."* "-"??_ ;_ @_ ','"SFr."#,##0;[Red]"SFr."\\-#,##0','"SFr."#,##0;"SFr."\\-#,##0','_ "SFr."* #,##0_ ;_ "SFr."* \\-#,##0_ ;_ "SFr."* "-"_ ;_ @_ ','"Stmt Date "m/d/yy','"Through "mmmm\\ dd\\,\\ yyyy','_(\\U"$"* #,##0_);_(\\U"$"* \\(#,##0\\);_(\\U"$"* "0"_);_(@_)','"up"\\ 0.0','"VS"\\ mmm\\-yy',"\\W#,##0","\\W#,##0.0",'"Wire Date "m/d/yy','"with "0%" tax"',"#\\x","\\X",'"Yes";;"No"','"Yes"_%_);;"No"_%_)','"YTD Through "mmmm\\ dd\\,\\ yyyy',"yyddmm","yy/m","yy/mm","yy\\-mm\\-dd","yymmdd",'yy"\\""\\""\\"\\-mm"\\""\\""\\"\\-dd"\\""\\""\\""\\"\\ h:mm',"yy\\ mmm","yy\\ mmm\\ dd","yyyy","yyyyddmm","yyyy/mm","yyyy\\.mm\\.dd","yyyy\\-mm\\-dd\\ hh:mm","yyyy/mm/dd\\ hh:mm:ss:ss","yyyy\\-mm\\-dd\\ hh:mm:ss\\.ss","yyyy\\ \\-\\ mmm","yyyy\\-mmm","yyyy\\-mmm\\-dd","yyyymmmdd","yyyy\\ mmmm"]},17585:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.insertCommas=t.convertNumberShape=t.convertDigitsShape=void 0;const n=r(74643),a=r(25969),i=r(27509),o=n.__importStar(r(27511)),s=r(34284),{codePointDigitZero:u,codePointDigitNine:l,codePointDigitOne:c}=o,d={[s.NumberShape.ArabicIndic]:{zero:1632,one:1633},[s.NumberShape.ExtendedArabicIndic]:{zero:1776,one:1777},[s.NumberShape.Devanagari]:{zero:2406,one:2407},[s.NumberShape.Bengali]:{zero:2534,one:2535},[s.NumberShape.Gurmukhi]:{zero:2662,one:2663},[s.NumberShape.Gujarati]:{zero:2790,one:2791},[s.NumberShape.Oriya]:{zero:2918,one:2919},[s.NumberShape.Tamil]:{zero:48,one:3047},[s.NumberShape.Telugu]:{zero:3174,one:3175},[s.NumberShape.Kannada]:{zero:3302,one:3303},[s.NumberShape.Malayalam]:{zero:3430,one:3431},[s.NumberShape.Thai]:{zero:3664,one:3665},[s.NumberShape.Lao]:{zero:3792,one:3793},[s.NumberShape.Tibetan]:{zero:3872,one:3873},[s.NumberShape.Myanmar]:{zero:4160,one:4161},[s.NumberShape.Ethiopic]:{zero:48,one:4969},[s.NumberShape.Khmer]:{zero:6112,one:6113},[s.NumberShape.Mongolian]:{zero:6160,one:6161}},g={[s.NumberShape.Japanese1]:{digits:[12295,19968,20108,19977,22235,20116,20845,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806,langId:"Japanese",dbnum:1},[s.NumberShape.Japanese2]:{digits:[12295,22769,24336,21442,22235,20237,20845,19971,20843,20061],ten:25342,hundred:30334,thousand:38433,tenThousand:33836,hundredMillion:20740,trillion:20806,langId:"Japanese",dbnum:2},[s.NumberShape.Japanese3]:{digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806,langId:"Japanese",dbnum:3},[s.NumberShape.Korean1]:{digits:[65296,19968,20108,19977,22235,20116,63953,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806,langId:"Korean",dbnum:1},[s.NumberShape.Korean2]:{digits:[63922,22777,36019,63851,22235,20237,63953,19971,20843,20061],ten:63859,hundred:30334,thousand:38433,tenThousand:33836,hundredMillion:20740,trillion:20806,langId:"Korean",dbnum:2},[s.NumberShape.Korean3]:{digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806,langId:"Korean",dbnum:3},[s.NumberShape.Korean4]:{digits:[50689,51068,51060,49340,49324,50724,50977,52832,54036,44396],ten:49901,hundred:48177,thousand:52380,tenThousand:47564,hundredMillion:50613,trillion:51312,langId:"Korean",dbnum:4},[s.NumberShape.ChineseSimp1]:{digits:[9675,19968,20108,19977,22235,20116,20845,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20159,trillion:20806,langId:"ChineseSimp",dbnum:1},[s.NumberShape.ChineseSimp2]:{digits:[38646,22777,36144,21441,32902,20237,38470,26578,25420,29590],ten:25342,hundred:20336,thousand:20191,tenThousand:19975,hundredMillion:20159,trillion:20806,langId:"ChineseSimp",dbnum:2},[s.NumberShape.ChineseSimp3]:{digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20159,trillion:20806,langId:"ChineseSimp",dbnum:3},[s.NumberShape.ChineseTrad1]:{digits:[9675,19968,20108,19977,22235,20116,20845,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:33836,hundredMillion:20740,trillion:20806,langId:"ChineseTrad",dbnum:1},[s.NumberShape.ChineseTrad2]:{digits:[38646,22777,36019,21443,32902,20237,38520,26578,25420,29590],ten:25342,hundred:20336,thousand:20191,tenThousand:33836,hundredMillion:20740,trillion:20806,langId:"ChineseTrad",dbnum:2},[s.NumberShape.ChineseTrad3]:{digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:33836,hundredMillion:20740,trillion:20806,langId:"ChineseTrad",dbnum:3}};function m(e,t){if(t===s.NumberShape.ASCII)return e;switch(t){case s.NumberShape.ArabicIndic:case s.NumberShape.ExtendedArabicIndic:case s.NumberShape.Devanagari:case s.NumberShape.Bengali:case s.NumberShape.Gurmukhi:case s.NumberShape.Gujarati:case s.NumberShape.Oriya:case s.NumberShape.Tamil:case s.NumberShape.Telugu:case s.NumberShape.Kannada:case s.NumberShape.Malayalam:case s.NumberShape.Thai:case s.NumberShape.Lao:case s.NumberShape.Tibetan:case s.NumberShape.Myanmar:case s.NumberShape.Ethiopic:case s.NumberShape.Khmer:case s.NumberShape.Mongolian:{let r="";const n=d[t];for(let t=0;t<e.length;t+=1){const o=e.charCodeAt(t);(0,a.assertTrue)("calc.numfmt.convertDigitsShape",u<=o&&o<=l),r+=o===u?(0,i.stringFromCodePoint)(n.zero):(0,i.stringFromCodePoint)(n.one+(o-c))}return r}case s.NumberShape.ChineseTrad1:case s.NumberShape.ChineseTrad2:case s.NumberShape.ChineseTrad3:case s.NumberShape.ChineseSimp1:case s.NumberShape.ChineseSimp2:case s.NumberShape.ChineseSimp3:case s.NumberShape.Japanese1:case s.NumberShape.Japanese2:case s.NumberShape.Japanese3:case s.NumberShape.Korean1:case s.NumberShape.Korean2:case s.NumberShape.Korean3:case s.NumberShape.Korean4:{let r="";const n=g[t];for(let t=0;t<e.length;t+=1)r+=h(n,e.charCodeAt(t));return r}}}function h(e,t){return(0,a.assertTrue)("calc.numfmt.ideographicDigit",u<=t&&t<=l),(0,i.stringFromCodePoint)(e.digits[t-u])}var p;function f(e,t){switch(t){case p.Ten:return(0,i.stringFromCodePoint)(e.ten);case p.Hundred:return(0,i.stringFromCodePoint)(e.hundred);case p.Thousand:return(0,i.stringFromCodePoint)(e.thousand);case p.TenThousand:return(0,i.stringFromCodePoint)(e.tenThousand);case p.HundredMillion:return(0,i.stringFromCodePoint)(e.hundredMillion);case p.Trillion:return(0,i.stringFromCodePoint)(e.trillion);default:return(0,a.assertFalse)("calc.numfmt.ideographicRank")}}t.convertDigitsShape=m,function(e){e[e.Ten=10]="Ten",e[e.Hundred=11]="Hundred",e[e.Thousand=12]="Thousand",e[e.TenThousand=13]="TenThousand",e[e.HundredMillion=14]="HundredMillion",e[e.Trillion=15]="Trillion"}(p||(p={})),t.convertNumberShape=function({decimalSeparator:e},t,r){if(r===s.NumberShape.ASCII)return t;switch(r){case s.NumberShape.ArabicIndic:case s.NumberShape.ExtendedArabicIndic:case s.NumberShape.Devanagari:case s.NumberShape.Bengali:case s.NumberShape.Gurmukhi:case s.NumberShape.Gujarati:case s.NumberShape.Oriya:case s.NumberShape.Tamil:case s.NumberShape.Telugu:case s.NumberShape.Kannada:case s.NumberShape.Malayalam:case s.NumberShape.Thai:case s.NumberShape.Lao:case s.NumberShape.Tibetan:case s.NumberShape.Myanmar:case s.NumberShape.Ethiopic:case s.NumberShape.Khmer:case s.NumberShape.Mongolian:{const n=t.indexOf(e);return m(t.substring(0,n<0?void 0:n),r)+(n<0?"":e)+(n<0?"":m(t.substring(n+e.length),r))}case s.NumberShape.ChineseTrad1:case s.NumberShape.ChineseTrad2:case s.NumberShape.ChineseTrad3:case s.NumberShape.ChineseSimp1:case s.NumberShape.ChineseSimp2:case s.NumberShape.ChineseSimp3:case s.NumberShape.Japanese1:case s.NumberShape.Japanese2:case s.NumberShape.Japanese3:case s.NumberShape.Korean1:case s.NumberShape.Korean2:case s.NumberShape.Korean3:case s.NumberShape.Korean4:{const n=g[r],i="ChineseSimp"===n.langId||"ChineseTrad"===n.langId,o=2===n.dbnum||"Korean"===n.langId&&(1===n.dbnum||4===n.dbnum),s=t.indexOf(e);let l=0,d=s<0?t.length:s,m="";if(d>12){if(d>16)for(;12<d;d--,l++)m+=h(n,t.charCodeAt(l));else{let e=16,r=p.Thousand,a=!1;do{if(e>d){e--,r--;continue}const s=t.charCodeAt(l);s!==u?((i||o||s>c||e%4==1)&&(i&&a&&(m+=h(n,u),a=!1),m+=h(n,s)),r>=p.Ten&&(m+=f(n,r))):a=!0,e--,r--,d--,l++}while(e>12)}m+=f(n,p.Trillion)}{let e=12;do{let r=p.Thousand,a=!1,s=!1;do{if(e>d){e--,r--;continue}const g=t.charCodeAt(l);g!==u||0===m.length?((i||o||g>c||e%4==1)&&(i&&s&&(m+=h(n,u),s=!1),m+=h(n,g)),r>=p.Ten&&(m+=f(n,r)),a=!0):s=!0,e--,r--,d--,l++}while(e%4);a&&d/4!=0&&(8===d?m+=f(n,p.HundredMillion):4===d&&(m+=f(n,p.TenThousand)))}while(d>0)}if(l!==t.length)for((0,a.assertTrue)("calc.numfmt.convertNumberShape",s>=0&&l===s),m+=e,l=s+e.length;l<t.length;l++)m+=h(n,t.charCodeAt(l));return m}default:return(0,a.assertNever)("calc.numfmt.convertNumberShape",r)}},t.insertCommas=function(e,t,r){if(""===t)return"";const n=(0,i.countCodePoints)(t,0,t.length);let a="";for(let o=0,s=0;o<t.length;){const u=(0,i.stringCodePointAt)(t,o),l=(0,i.numCodeUnits)(u);a+=t.substring(o,o+l),o+=l,s+=1,e.isThousandsPosition(r+(n-s))&&(a+=e.thousandsSeparator)}return a}},16700:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toXLNumber=t.applyValueEdit=t.getValueEditOperKind=t.renderFormat=t.getFormatString=t.initUtilGlobals=void 0;const n=r(27007),a=r(31828),i=r(34284),o=r(1585),s=r(25969),u=r(65556),l=r(44442),c={getKnownFormat:()=>(0,s.assertFalse)("calc.numfmt: default getKnownFormat"),getIformat:()=>(0,s.assertFalse)("calc.numfmt: default getIformat"),getFormatString:()=>(0,s.assertFalse)("calc.numfmt: default getFormatString")};t.initUtilGlobals=function(e){return{config:e.config,getKnownFormat:e.getKnownFormat?.bind(e)??c.getKnownFormat,getIformat:e.getIformat?.bind(e)??c.getIformat,getFormatString:e.getFormatString?.bind(e)??c.getFormatString}},t.getFormatString=function(e,t,r,n,a){const i=t.getFormatString(r,n);return(0,o.isSuccess)(i)?void 0!==i.value?t.getIformat(r,i.value):e.createFormat(n,a):i},t.renderFormat=function(e,t,r){const i=(0,n.isStringOper)(r)?a.Clip.None:a.Clip.All,s=t.apply(r,a.Alignment.Right,i,!0);if(!(0,o.isSuccess)(s))return s;const u=e.renderValue(s.value,a.renderInfiniteWidth);return(0,o.isSuccess)(u)?(0,a.isHashesValue)(u.value)?(0,o.success)(u.value.units):(0,o.success)((0,a.renderedValueToString)(u.value)):u},t.getValueEditOperKind=function(e){return e.value.kind},t.applyValueEdit=function(e,t,r,n){let s=r;if(n.kind===a.EditKind.Number&&n.format!==i.KnownFormat.General){const a=n.format,i="string"==typeof a?a:(0,l.getKnownFormat)(t,a),c="string"!=typeof a,d=e.createFormat(i,c);if(!(0,o.isSuccess)(d))return d;const g=d.value;(0,u.shouldInstallFormat)(g,r)&&(s=g)}return e.applyFormat(s,n.value,!0)},t.toXLNumber=function(e,t,r){const n=t.parseGeneral(r,!1,!0,a.GetTimeKind.NonVolatile);return(0,o.isSuccess)(n)?null==n.value?(0,o.failure)(null):(0,o.success)(e.toNumber(n.value.value)):n}},40841:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PackageName=void 0,t.PackageName="excel-online-calc-recalc"},17277:function(e,t,r){"use strict";const n=r(55174);e.exports=n.analyzeService},70186:function(e,t,r){"use strict";const n=r(55174);e.exports=n.analyzeServiceTypes},84949:function(e,t,r){"use strict";const n=r(91092);e.exports=n.anonymizer},93371:function(e,t,r){"use strict";const n=r(91092);e.exports=n.arrayUtils},18612:function(e,t,r){"use strict";const n=r(91092);e.exports=n.assertions},33372:function(e,t,r){"use strict";const n=r(91092);e.exports=n.codePoint},49043:function(e,t,r){"use strict";const n=r(91092);e.exports=n.config},71766:function(e,t,r){"use strict";const n=r(91092);e.exports=n.core},64481:function(e,t,r){"use strict";const n=r(91092);e.exports=n.rTree},77981:function(e,t,r){"use strict";const n=r(91092);e.exports=n.rbMapTree},3825:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.overrideTypedFeatureGates=t.isTypedChangeGateEnabled=t.getTypedFeatureGate=t.getFeatures=t.isFeatureEnabled=t.initFeatureConfiguration=t.FeatureName=void 0;const n=r(91092);t.FeatureName=n.featureConfiguration.FeatureName,t.initFeatureConfiguration=n.featureConfiguration.initFeatureConfiguration,t.isFeatureEnabled=n.featureConfiguration.isFeatureEnabled,t.getFeatures=n.featureConfiguration.getFeatures,t.getTypedFeatureGate=n.featureConfiguration.getTypedFeatureGate,t.isTypedChangeGateEnabled=n.featureConfiguration.isTypedChangeGateEnabled;var a=r(66761);Object.defineProperty(t,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return a.overrideTypedFeatureGates}}),Object.defineProperty(t,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return a.setFeatureGateDictionaryGetter}})},43376:function(e,t,r){"use strict";const n=r(91092);e.exports=n.result},54051:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.breakTransition=t.nextTransition=t.nextOnSuccessReceiver=t.callMachineTransition=t.TransitionKind=t.MachineRuntime=t.MachineCycle=t.VoidMachine=t.AllMachine=void 0;const n=r(91092);t.AllMachine=n.machine.AllMachine,t.VoidMachine=n.machine.VoidMachine,t.MachineCycle=n.machine.MachineCycle,t.MachineRuntime=n.machine.MachineRuntime,t.TransitionKind=n.machine.TransitionKind,t.callMachineTransition=n.machine.callMachineTransition,t.nextOnSuccessReceiver=n.machine.nextOnSuccessReceiver,t.nextTransition=n.machine.nextTransition,t.breakTransition=n.machine.breakTransition},56497:function(e,t,r){"use strict";const n=r(91092);e.exports=n.pledge},7537:function(e,t,r){"use strict";const n=r(91092);e.exports=n.testUtil},23262:function(e,t,r){"use strict";const n=r(91092);e.exports=n.unicode},51465:function(e,t,r){"use strict";const n=r(91092);e.exports=n.util},46478:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.geomean=t.devsq=t.avedev=t.rank_avg=t.rank=t.aggregate=t.subtotal=t.mode_mult=t.mode=t.varpa=t.vara=t.varp=t.var_=t.stdevpa=t.stdeva=t.stdevp=t.stdev=t.trimmean=t.median=t.quartile_exc=t.quartile=t.percentile_exc=t.percentile=t.small=t.large=t.xor=t.or=t.and=t.minifs=t.maxifs=t.mina=t.maxa=t.min=t.max=t.countifs=t.countif=t.counta=t.countblank=t.count=t.textjoin=t.concat=t.averagea=t.averageifs=t.averageif=t.average=t.product=t.sumifs=t.sumif=t.sumsq=t.sum=void 0,t.sumproduct=t.harmean=void 0;const n=r(18612),a=r(70633),i=r(92158),o=r(64316),s=r(11181),u=r(52182),l=r(71766),c=r(59242),d=r(87665),g=r(88435),m=r(36094),h=r(79673),p=r(43376),f=r(44470),S=r(31663);function v(e,t){const r=(0,i.isRichOper)(t)?t.getFallback():t;switch(r.kind){case h.OperKind.Number:return r;case h.OperKind.Boolean:case h.OperKind.String:return;case h.OperKind.Error:return r;case h.OperKind.Missing:case h.OperKind.Blank:return;default:return(0,n.assertNever)("calc.funcs.arithmeticOperationCoerce",r)}}function F(e,t){const r=(0,i.isRichOper)(t)?t.getFallback():t;switch(r.kind){case h.OperKind.Boolean:return r.value?e.mathpack.one:e.mathpack.zero;case h.OperKind.Number:return r;case h.OperKind.String:return e.mathpack.zero;case h.OperKind.Error:return r;case h.OperKind.Missing:case h.OperKind.Blank:return;default:return(0,n.assertNever)("calc.funcs.arithmeticAOperationCoerce",r)}}function y(e){return function(t,r,a){if(void 0!==t&&(0,i.isErrorOper)(t))return t;if((0,n.assertTrue)("calc.funcs.numberReducer",void 0===t||(0,i.isNumberOper)(t)),(0,i.isErrorOper)(r))return r;let o,s;(0,n.assertTrue)("calc.funcs.numberReducer",(0,i.isNumberOper)(r)),void 0===t?(o=r,s=a-1):(o=t,s=a);for(let t=0;t<s;t+=1){const t=e(o,r);if((0,i.isErrorOper)(t))return t;o=t}return o}}function C(e){return(t,r,n)=>(e.count+=n,r)}function A(e,t,r){if(!(0,i.isNumberOper)(r))return r;const n=function(e){for(let t=e.length-1;t>=0;t-=1){const r=e[t];if(void 0!==r&&(0,o.isRangeValues)(r))for(let e=r.arrays.length-1;e>=0;e-=1){const t=r.arrays[e];if(t.rows>t.denseRows||t.cols>t.denseCols){const e=t.getSparse();if(e?.kind===h.OperKind.Number)return e}for(let e=t.denseRows-1;e>=0;e-=1)for(let r=t.denseCols-1;r>=0;r-=1){const n=t.get(e,r);if(n?.kind===h.OperKind.Number)return n}}}}(t);return n?.kind!==h.OperKind.Number?r:e.mathpack.checkAlmostCancellation(n,r)}function E(e,t,r){let n=(0,d.reduceDerefOpers)(t,y(t.mathpack.add),v,r);return null==n?t.mathpack.zero:(e&&(n=A(t,r,n)),n)}const b=E.bind(void 0,!1),R=E.bind(void 0,!0);function T(e){return(0,i.isRangeOper)(e)&&1!==e.ranges.length}function k(e,t,r){if(T(t))return(0,p.failure)(a.valueErrorOper);if(void 0===r){const r=e.dereferenceAllOpers([t])[0];return(0,p.success)({values:r,valuesToFilter:r})}if(T(r))return(0,p.failure)(a.valueErrorOper);const{actualEvalRange:n,actualFilterRange:i}=function(e,t){const r=e.ranges[0],n=t.ranges[0],i=(0,l.fastMin)(r.cols,s.sheetCols-n.col),o=(0,l.fastMin)(r.rows,s.sheetRows-n.row),u=(0,s.gridRange)(r.row,r.col,o,i),c=(0,a.range3DOper)(e.sheets,u),d=(0,s.gridRange)(n.row,n.col,o,i);return{actualEvalRange:c,actualFilterRange:(0,a.range3DOper)(t.sheets,d)}}(t,r),o=n.ranges[0],u=i.ranges[0],c=e.dereferenceAllOpers([n])[0];if(o.col===u.col&&o.row===u.row)return(0,p.success)({values:c,valuesToFilter:c});const d=e.dereferenceAllOpers([i])[0];return(0,p.success)({values:c,valuesToFilter:d})}function N(e,[t,r,n]){const a=k(e,t,n);if(!(0,p.isSuccess)(a))return a.reason;const{values:i,valuesToFilter:s}=a.value,l=[(0,o.rangeValues)([(0,u.applyCriteria)(e,i.arrays[0],r,s.arrays[0])])];return b(e,l)}function I(e,t,r=!1,n=!1){const i=t[0];if(T(i))return(0,p.failure)(a.valueErrorOper);let s,l;if(r){const r=t[1],[n]=e.dereferenceAllOpers([i]);s=(0,u.applyCriteria)(e,n.arrays[0],r),l=2}else{const[t]=e.dereferenceAllOpers([i]);s=t.arrays[0],l=1}for(let r=l;r<t.length;r+=2){const n=t[r],o=t[r+1];if(T(n))return(0,p.failure)(a.valueErrorOper);if(n.ranges[0].cols!==i.ranges[0].cols||n.ranges[0].rows!==i.ranges[0].rows)return(0,p.failure)(a.valueErrorOper);const[l]=e.dereferenceAllOpers([n]);s=(0,u.applyCriteria)(e,l.arrays[0],o,s)}return n&&(s=s.strict()),(0,p.success)((0,o.rangeValues)([s]))}function O(e,t){const r=(0,d.reduceDerefOpers)(e,y(e.mathpack.mul),v,t);return null==r?e.mathpack.zero:r}function _(e,t,r,a,o,s){let u=(0,d.reduceDerefOpers)(o,y(o.mathpack.add),e,s,t);if(null==u)return a;if(r&&(u=A(o,s,u)),(0,i.isErrorOper)(u))return u;const l={count:0},c=(0,d.reduceDerefOpers)(o,C(l),e,s,t);(0,n.assertTrue)("calc.funcs.averageCoerceInner",(0,i.isNumberOper)(u)&&c?.kind===h.OperKind.Number&&l.count>0);const g=o.mathpack.div(u,o.mathpack.fromNumber(l.count));return(0,i.isErrorOper)(g)?g:[g,l.count]}function P(e,t,r,n,i){const o=_(e,t,r,a.div0ErrorOper,n,i);return Array.isArray(o)?o[0]:o}t.sum=function(e,t){const r=e.dereferenceAllOpers(t);return R(e,r)},t.sumsq=function(e,t){const r=e.dereferenceAllOpers(t),n=me(v),a=(0,d.reduceDerefOpers)(e,y(e.mathpack.add),n,r);return null==a?e.mathpack.zero:a},t.sumif=N,t.sumifs=function(e,t){if(3===t.length)return N(e,[t[1],t[2],t[0]]);const r=I(e,t);return(0,p.isSuccess)(r)?b(e,[r.value]):r.reason},t.product=function(e,t){const r=e.dereferenceAllOpers(t);return O(e,r)};const M=P.bind(void 0,v,void 0,!1),D=P.bind(void 0,v,void 0,!0),w=P.bind(void 0,F,(function(e,t){const r=(0,i.isRichOper)(t)?t.getFallback():t;return(0,i.isStringOper)(r)?e.mathpack.zero:v(0,r)}),!0);function L(e,[t,r,n]){const a=k(e,t,n);if(!(0,p.isSuccess)(a))return a.reason;const{values:i,valuesToFilter:s}=a.value,l=[(0,o.rangeValues)([(0,u.applyCriteria)(e,i.arrays[0],r,s.arrays[0]).strict()])];return M(e,l)}function x(e,t,r,o,s){let u,l=0,c="";const g=(e,t)=>e.coerceOper(t,h.OperKind.String),m=(e,o,s)=>{if(void 0!==e&&(0,i.isErrorOper)(e))return e;for(let e=0;e<s;e+=1){if(void 0!==u&&t.length>0&&(!r||u.value.length>0)){const e=t[l];if(l=(l+1)%t.length,c.length+e.value.length>a.cellStringLimit)return a.valueErrorOper;c+=e.value}if((0,i.isErrorOper)(o))return o;if((0,n.assertTrue)("calc.funcs.concatInner: expected string in reducer",(0,i.isStringOper)(o)),c.length+o.value.length>a.cellStringLimit)return a.valueErrorOper;if(c+=o.value,u=o,""===o.value&&(0===t.length||r))break}return o};for(let t=0;t<s.length;t+=1){const r=o[t];if((0,i.isRangeOper)(r)&&r.ranges.length>1)return a.valueErrorOper;const u=(0,d.reduceDerefOpers)(e,m,g,s.slice(t,t+1));if(void 0!==u&&(0,i.isErrorOper)(u))return u;(0,n.assertTrue)("calc.funcs.concatInner: expected string from reduce",void 0!==u&&(0,i.isStringOper)(u))}if(r&&void 0!==u&&""===u.value&&t.length>0&&c.length>0){const e=t[(l+t.length-1)%t.length];c=c.substring(0,c.length-e.value.length)}return(0,a.stringOper)(c)}function K(e,t,r){const n={count:0};return(0,d.reduceDerefOpers)(t,C(n),e,r),t.mathpack.fromNumber(n.count)}t.average=function(e,t){const r=e.dereferenceAllOpers(t);return D(e,r)},t.averageif=L,t.averageifs=function(e,t){if(3===t.length)return L(e,[t[1],t[2],t[0]]);const r=I(e,t,void 0,!0);return(0,p.isSuccess)(r)?M(e,[r.value]):r.reason},t.averagea=function(e,t){const r=e.dereferenceAllOpers(t);return w(e,r)},t.concat=function(e,t){const r=e.dereferenceAllOpers(t);return x(e,[],!0,t,r)},t.textjoin=function(e,t){const[r,o,...s]=t,u=[];if(!(0,i.isMissingOper)(r)){if((0,i.isRangeOper)(r)&&r.ranges.length>1)return a.valueErrorOper;const t=(e,t)=>e.coerceOper(t,h.OperKind.String),o=(0,d.reduceDerefOpers)(e,re(u,g.assertString),t,e.dereferenceAllOpers([r]));if(void 0!==o&&(0,i.isErrorOper)(o))return o;(0,n.assertTrue)("calc.funcs.textjoin: expected string from reduce",void 0!==o&&(0,i.isStringOper)(o))}return x(e,u,(0,i.isMissingOper)(o)||o.value,s,e.dereferenceAllOpers(s))};const W=K.bind(void 0,(function(e,t){const r=(0,i.isRichOper)(t)?t.getFallback():t;return(0,i.isNumberOper)(r)?r:void 0}));t.count=function(e,t){const r=e.dereferenceAllOpers(t);return W(e,r)};const U=K.bind(void 0,(function(e,t){const r=(0,i.isRichOper)(t)?t.getFallback():t;return(0,i.isBlankOper)(r)||(0,m.isEmptyStringOper)(r)?r:void 0}));t.countblank=function(e,t){const r=t[0];if(!(0,i.isSheetIndex)(r.sheets)||1!==r.ranges.length)return a.valueErrorOper;const n=e.dereferenceAllOpers(t);return U(e,n)};const G=K.bind(void 0,(function(e,t){const r=(0,i.isRichOper)(t)?t.getFallback():t;return(0,i.isPrimitiveOper)(r)||(0,i.isErrorOper)(r)?r:void 0}));t.counta=function(e,t){const r=e.dereferenceAllOpers(t);return G(e,r)};const B=K.bind(void 0,((e,t)=>t));function V(e,[t,r]){if(T(t))return a.valueErrorOper;const[n]=e.dereferenceAllOpers([t]),i=[(0,o.rangeValues)([(0,u.applyCriteria)(e,n.arrays[0],r)])];return B(e,i)}t.countif=V,t.countifs=function(e,t){if(2===t.length)return V(e,t);const r=I(e,t,!0);return(0,p.isSuccess)(r)?B(e,[r.value]):r.reason};const j=(e,t,r)=>e.mathpack.cond2(t,r)>0,H=(e,t,r)=>e.mathpack.cond2(t,r)<0;function q(e,t,r,a,o){const s=(0,d.reduceDerefOpers)(a,((t,r,o)=>void 0===t?r:(0,i.isErrorOper)(t)?t:((0,n.assertTrue)("calc.funcs.minMaxCoerceInner",(0,i.isNumberOper)(t)),(0,i.isErrorOper)(r)?r:((0,n.assertTrue)("calc.funcs.minMaxCoerceInner",(0,i.isNumberOper)(r)),e(a,t,r)?t:r))),t,o,r);return null==s?a.mathpack.zero:s}const $=q.bind(void 0,j,v,void 0),z=q.bind(void 0,H,v,void 0),Q=q.bind(void 0,j,F,v),Y=q.bind(void 0,H,F,v);function J(e,t){const r=(0,i.isRichOper)(t)?t.getFallback():t;switch(r.kind){case h.OperKind.Boolean:return r;case h.OperKind.Number:return(0,a.booleanOper)(0!==e.mathpack.cond(r));case h.OperKind.String:return;case h.OperKind.Error:return r;case h.OperKind.Missing:case h.OperKind.Blank:return;default:return(0,n.assertNever)("calc.funcs.aggregationFuncs: booleanOperationCoerce",r)}}function X(e,t,r){const o=(0,d.reduceDerefOpers)(t,((t,r,o)=>void 0!==t&&(0,i.isErrorOper)(t)?t:(0,i.isErrorOper)(r)?r:((0,n.assertTrue)("calc.funcs.booleanInner",(void 0===t||(0,i.isBooleanOper)(t))&&(0,i.isBooleanOper)(r)),(0,a.booleanOper)(e(t?.value,r.value,o)))),J,r);return null==o?a.valueErrorOper:o}t.max=function(e,t){const r=e.dereferenceAllOpers(t);return $(e,r)},t.min=function(e,t){const r=e.dereferenceAllOpers(t);return z(e,r)},t.maxa=function(e,t){const r=e.dereferenceAllOpers(t);return Q(e,r)},t.mina=function(e,t){const r=e.dereferenceAllOpers(t);return Y(e,r)},t.maxifs=function(e,t){const r=I(e,t);return(0,p.isSuccess)(r)?$(e,[r.value]):r.reason},t.minifs=function(e,t){const r=I(e,t);return(0,p.isSuccess)(r)?z(e,[r.value]):r.reason};const Z=X.bind(void 0,((e,t)=>!1!==e&&t)),ee=X.bind(void 0,((e,t)=>!0===e||t)),te=X.bind(void 0,((e,t,r)=>t?((!0===e?1:0)+r)%2==1:!0===e));function re(e,t){return(r,n,a)=>{if(void 0!==r&&(0,i.isErrorOper)(r))return r;if(!(0,i.isErrorOper)(n)){const r=t(n);for(let t=0;t<a;t+=1)e.push(r)}return n}}function ne(e,t,r,n){const o=[],s=(0,d.reduceDerefOpers)(t,re(o,g.assertNumber),v,[r]);if(null==s)return a.numErrorOper;if((0,i.isErrorOper)(s))return s;const u=t.mathpack;if(u.cond2(n,u.one)<0)return a.numErrorOper;if(u.cond2(n,u.fromNumber(o.length))>0)return a.numErrorOper;const l=o.sort(u.cond2);if(e){const e=(0,g.assertNumber)(u.add((0,g.assertNumber)(u.sub(u.fromNumber(o.length),n)),u.one));return l[u.lfix(e)-1]}return l[u.lfix(n)-1]}t.and=function(e,t){const r=e.dereferenceAllOpers(t);return Z(e,r)},t.or=function(e,t){const r=e.dereferenceAllOpers(t);return ee(e,r)},t.xor=function(e,t){const r=e.dereferenceAllOpers(t);return te(e,r)};const ae=ne.bind(void 0,!0),ie=ne.bind(void 0,!1);function oe(e,t,r,n){const o=e.mathpack,s=[],u=(0,d.reduceDerefOpers)(e,re(s,g.assertNumber),v,t);if(null==u)return a.numErrorOper;if((0,i.isErrorOper)(u))return u;if((0,i.isErrorOper)(r))return r;if(o.cond(r)<0)return a.numErrorOper;if(o.cond2(r,o.one)>0)return a.numErrorOper;const l=s.sort(o.cond2),c=(0,g.assertNumber)(o.sub(o.fromNumber(l.length),o.one)),m=(0,g.assertNumber)(o.add(o.fromNumber(l.length),o.one)),h=n?(0,g.assertNumber)(o.mul(c,r)):(0,g.assertNumber)(o.sub((0,g.assertNumber)(o.mul(m,r)),o.one));if(o.cond(h)<0||o.cond2(h,c)>0)return a.numErrorOper;const p=o.lfix(h),f=(0,g.assertNumber)(o.sub(h,o.fromNumber(p)));if(0===o.cond(f))return l[p];const S=o.sub(l[p+1],l[p]);return(0,i.isErrorOper)(S)?S:o.add(l[p],(0,g.assertNumber)(o.mul(S,f)))}t.large=function(e,t){const[r,n]=e.dereferenceAllOpers(t);return ae(e,r,n)},t.small=function(e,t){const[r,n]=e.dereferenceAllOpers(t);return ie(e,r,n)};const se=(e,t,r)=>oe(e,[t],r,!0);t.percentile=function(e,t){const[r,n]=e.dereferenceAllOpers(t);return se(e,r,n)};const ue=(e,t,r)=>oe(e,[t],r,!1);function le(e,t){const r=e.mathpack;if(r.cond(t)<0)return a.numErrorOper;if(r.cond2(t,r.fromNumber(5))>=0)return a.numErrorOper;const n=r.lfix(t);return r.div(r.fromNumber(n),r.fromNumber(4))}t.percentile_exc=function(e,t){const[r,n]=e.dereferenceAllOpers(t);return ue(e,r,n)};const ce=(e,t,r)=>oe(e,[t],le(e,r),!0);t.quartile=function(e,t){const[r,n]=e.dereferenceAllOpers(t);return ce(e,r,n)};const de=(e,t,r)=>oe(e,[t],le(e,r),!1);function ge(e,t){return oe(e,t,e.mathpack.fromNumber(.5),!0)}function me(e){return function(t,r){const n=e(t,r);return void 0!==n&&(0,i.isNumberOper)(n)?t.mathpack.mul(n,n):n}}function he(e,t){return function(r,n){const a=e(r,n);if(a?.kind!==h.OperKind.Number)return a;const o=r.mathpack,s=o.sub(a,t);return(0,i.isErrorOper)(s)?s:o.mul(s,s)}}function pe(e,t,r,o){const s={count:0};if(null==(0,d.reduceDerefOpers)(r,C(s),e,o,t))return a.div0ErrorOper;(0,n.assertTrue)("calc.funcs.varFirstPass: unexpected count type",s.count>=1);const u=y(r.mathpack.add),l=(0,d.reduceDerefOpers)(r,u,e,o,t),c=(0,d.reduceDerefOpers)(r,u,me(e),o,void 0===t?void 0:me(t));if((0,n.assertTrue)("calc.funcs.varFirstPass: expected sum",null!=l),(0,n.assertTrue)("calc.funcs.varFirstPass: expected sumSq",null!=c),(0,i.isErrorOper)(l))return l;if((0,i.isErrorOper)(c))return c;(0,n.assertTrue)("calc.funcs.varFirstPass: unexpected oper type",(0,i.isNumberOper)(l)&&(0,i.isNumberOper)(c));const g=r.mathpack,m=g.div(l,g.fromNumber(s.count));return(0,i.isErrorOper)(m)?m:[s.count,l,c,m]}function fe(e,t,r,a,i){const o=y(r.mathpack.add),s=(0,d.reduceDerefOpers)(r,o,he(e,i),a,void 0===t?void 0:he(t,i));return(0,n.assertTrue)("calc.funcs.varSecondPass: unexpected error",s?.kind===h.OperKind.Number),s}function Se(e,t,r,n){const o=pe(e,t,r,n);if(!Array.isArray(o))return o;const s=r.mathpack,[u,l,c,d]=o;if(u<2)return a.div0ErrorOper;const m=s.mul(l,l);if((0,i.isErrorOper)(m))return m;const h=(0,g.assertNumber)(s.div(m,s.fromNumber(u))),p=(0,g.assertNumber)(s.sub(c,h));if(0===s.cond(d))return s.cond(p)<0?s.zero:s.div(p,s.fromNumber(u-1));if(s.cond(p)>=0){const e=(0,g.assertNumber)(s.div(p,s.fromNumber(u-1))),t=21219957905e-324;if(s.cond2(e,s.fromNumber(t))>0){const t=s.div(h,c),r=(0,i.isErrorOper)(t)?t:s.sub(t,s.one);if(!(0,i.isErrorOper)(r)&&s.cond2(s.abs(r),s.fromNumber(.01))>0){const t=s.div(d,e),r=(0,i.isErrorOper)(t)?t:s.sub(s.abs(t),s.fromNumber(1e3));if(!(0,i.isErrorOper)(r)&&s.cond(r)<0)return e}}}const f=fe(e,t,r,n,d);return s.cond(f)<0?s.zero:s.div(f,s.fromNumber(u-1))}function ve(e,t,r,n){const o=pe(e,t,r,n);if(!Array.isArray(o))return o;const s=r.mathpack,[u,l,c,d]=o;if(u<1)return a.div0ErrorOper;const m=s.mul(l,l);if((0,i.isErrorOper)(m))return m;const h=s.mul(c,s.fromNumber(u));if((0,i.isErrorOper)(h))return h;const p=(0,g.assertNumber)(s.sub(h,m));if(0===s.cond(d))return s.cond(p)<0?s.zero:s.div(p,s.fromNumber(u*u));if(s.cond(p)>=0){const e=(0,g.assertNumber)(s.div(p,s.fromNumber(u*u))),t=21219957905e-324;if(s.cond2(e,s.fromNumber(t))>0){const t=s.div((0,g.assertNumber)(s.div(m,s.fromNumber(u))),c),r=(0,i.isErrorOper)(t)?t:s.sub(t,s.one);if(!(0,i.isErrorOper)(r)&&s.cond2(s.abs(r),s.fromNumber(.01))>0){const t=s.div(d,e),r=(0,i.isErrorOper)(t)?t:s.sub(s.abs(t),s.fromNumber(1e3));if(!(0,i.isErrorOper)(r)&&s.cond(r)<0)return e}}}const f=fe(e,t,r,n,d);return s.cond(f)<0?s.zero:s.div(f,s.fromNumber(u))}t.quartile_exc=function(e,t){const[r,n]=e.dereferenceAllOpers(t);return de(e,r,n)},t.median=function(e,t){const r=e.dereferenceAllOpers(t);return ge(e,r)},t.trimmean=function(e,t){const[r,o]=e.dereferenceAllOpers(t);let s=[];const u=(0,d.reduceDerefOpers)(e,re(s,g.assertNumber),v,[r]);if(null==u)return a.numErrorOper;if((0,i.isErrorOper)(u))return u;const l=e.mathpack;if(l.cond(o)<0)return a.numErrorOper;if(l.cond2(o,l.one)>=0)return a.numErrorOper;s=s.sort(l.cond2);const c=l.lfix((0,g.assertNumber)(l.div((0,g.assertNumber)(l.mul(l.fromNumber(s.length),o)),l.fromNumber(2))));(0,n.assertTrue)("calc.funcs.trimmean",c+c<s.length);const m=s[c],h=s[s.length-1-c];let p=0,f=0;const S=(0,d.reduceDerefOpers)(e,y(e.mathpack.add),((e,t)=>{const r=v(0,t);if(void 0===r)return r;(0,n.assertTrue)("calc.funcs.trimmean: unexpected error",(0,i.isNumberOper)(r));const a=e.mathpack;if(a.cond2(r,m)<0)p+=1;else{if(!(a.cond2(r,h)>0))return r;f+=1}}),[r]);(0,n.assertTrue)("calc.funcs.trimmean: found no elements",void 0!==S&&(0,i.isNumberOper)(S)),(0,n.assertTrue)("calc.funcs.trimmean: trimmed too many",p<=c&&f<=c);let F=S;for(;p<c;p+=1){const e=l.sub(F,m);if((0,i.isErrorOper)(e))return e;F=e}for(;f<c;f+=1){const e=l.sub(F,h);if((0,i.isErrorOper)(e))return e;F=e}return l.div(F,l.fromNumber(s.length-c-c))};const Fe=Se.bind(void 0,v,void 0),ye=ve.bind(void 0,v,void 0),Ce=Se.bind(void 0,F,v),Ae=ve.bind(void 0,F,v);function Ee(e){return function(t,r){const n=e(t,r);return(0,i.isNumberOper)(n)?t.mathpack.sqrt(n):n}}const be=Ee(Fe),Re=Ee(ye),Te=Ee(Ce),ke=Ee(Ae);t.stdev=function(e,t){const r=e.dereferenceAllOpers(t);return be(e,r)},t.stdevp=function(e,t){const r=e.dereferenceAllOpers(t);return Re(e,r)},t.stdeva=function(e,t){const r=e.dereferenceAllOpers(t);return Te(e,r)},t.stdevpa=function(e,t){const r=e.dereferenceAllOpers(t);return ke(e,r)},t.var_=function(e,t){const r=e.dereferenceAllOpers(t);return Fe(e,r)},t.varp=function(e,t){const r=e.dereferenceAllOpers(t);return ye(e,r)},t.vara=function(e,t){const r=e.dereferenceAllOpers(t);return Ce(e,r)},t.varpa=function(e,t){const r=e.dereferenceAllOpers(t);return Ae(e,r)};const Ne=[D,W,G,$,z,O,be,Re,R,Fe,ye];function Ie(e,t){const r=[],o=(0,d.reduceDerefOpers)(e,(s=r,(e,t,r)=>{if(void 0!==e&&(0,i.isErrorOper)(e))return e;if((0,i.isNumberOper)(t))for(let e=0;e<r;e+=1)s.push({value:t,index:s.length});return t}),v,t);var s;if(null==o)return a.naErrorOper;if((0,i.isErrorOper)(o))return o;const u=e.mathpack,l=r.sort(((e,t)=>u.cond2(e.value,t.value)));let c=1,g=0,m=1/0;const h=[];function p(e){c=1,m=e.index}const f=e=>{const{value:t}=e;c>g?(g=c,h.length=0,h.push({value:t,index:m})):c===g&&h.push({value:t,index:m})};p(l[0]);for(let e=1;e<l.length;e+=1)F=l[e-1],y=l[e],0===u.cond2(F.value,y.value)?((S=l[e]).index<m&&(m=S.index),c+=1):(f(l[e-1]),p(l[e]));var S,F,y;return f(l[l.length-1]),g<2?a.naErrorOper:((0,n.assertTrue)("calc.funcs.modeInner: unexpected error",0!==h.length),h.sort(((e,t)=>e.index-t.index)))}function Oe(e,t){const r=Ie(e,t);return Array.isArray(r)?r[0].value:r}t.mode=function(e,t){return Oe(e,t)},t.mode_mult=function(e,t){const r=Ie(e,t);return Array.isArray(r)?(0,a.arrayOper)(r.length,1,r.map((e=>[e.value]))):r};const _e=(0,f.binaryVisitor)({...(0,f.constVisitor)(!1),wsfNode:e=>e===c.WorksheetFuncId.SUBTOTAL||e===c.WorksheetFuncId.AGGREGATE},((e,t)=>e||t));function Pe(e){if(!(0,o.isRangeValues)(e))return e;const t=e.arrays.map((e=>e.map((([e,t])=>{return void 0!==t&&(r=t.formula,(0,f.reduceBottomUp)(_e,r))?void 0:e;var r}))));return(0,o.rangeValues)(t)}t.subtotal=function(e,[t,...r]){const n=e.mathpack.sfix(t),i=Ne.length;if(!(n>=1&&n<=i||n>=101&&n<=i+100))return a.valueErrorOper;const o=n>100||e.isInFilterMode(r),s=e.dereferenceAllOpersAndFormulae(r,o).map(Pe);return(0,Ne[n%100-1])(e,s)};const Me=[...Ne,ge,Oe],De=[ae,ie,se,ce,ue,de];function we(e,[t,r,n=a.falseOper],o){const s=n.value?1:-1;let u=0,l=0;const c=e.mathpack,m=(0,d.reduceDerefOpers)(e,((e,r,n)=>{if(void 0!==e)return e;if((0,i.isErrorOper)(r))return r;const a=c.cond2(t,(0,g.assertNumber)(r));0===a?u+=n:a===s&&(l+=n)}),v,e.dereferenceAllOpers([r]));if(void 0!==m)return m;if(0===u)return a.naErrorOper;const h=c.fromNumber(l+1);if(o){const e=c.div(c.fromNumber(u-1),c.fromNumber(2));return c.add(h,(0,g.assertNumber)(e))}return h}function Le(e){return function(t,r){const n=e(t,r);return n?.kind===h.OperKind.Number?t.mathpack.abs(n):n}}function xe(e,t,r){const o=_(v,void 0,!0,a.numErrorOper,t,r);if(!Array.isArray(o))return o;const[s,u]=o,l=(0,d.reduceDerefOpers)(t,y(t.mathpack.add),e(function(e,t){return function(r,n){const a=e(r,n);return a?.kind===h.OperKind.Number?r.mathpack.sub(a,t):a}}(v,s)),r);return(0,n.assertTrue)("calc.funcs.sumDevAndCount",void 0!==l),(0,i.isErrorOper)(l)?l:[(0,g.assertNumber)(l),u]}t.aggregate=function(e,t){const[r,u,l,c,...g]=t,m=e.mathpack,p=m.sfix(r),f=m.sfix(u);if(!(p>=1&&p<=Me.length+De.length&&f>=0&&f<=7))return a.valueErrorOper;const v=1==(1&f),F=2==(2&f),y=!(4==(4&f));function C(t){let r=y?e.dereferenceAllOpersAndFormulae(t,v).map(Pe):e.dereferenceAllOpers(t,v);return F&&(r=r.map((e=>{if((0,d.isPrimitiveCoercedOper)(e))return e;if((0,o.isRangeValues)(e)){const t=e.arrays.map((e=>e.map((e=>void 0===e||(0,i.isErrorOper)(e)?void 0:e))));return(0,o.rangeValues)(t)}if((0,d.isCoercedArrayOper)(e)){const t=e.opers.map((e=>e.map((e=>void 0===e||(0,i.isErrorOper)(e)?void 0:e))));return(0,d.coercedArrayOper)(e.rows,e.cols,t)}return e}))),r}if(p>Me.length){if(void 0===c||g.length>0)return a.valueErrorOper;const t=h.OperKind.Number;!(0,i.isRangeOper)(c)||(0,i.isSheetIndex)(c.sheets)&&1===c.ranges.length&&(0,s.isGridCell)(c.ranges[0])||(0,S.throwEvaluationError)((0,i.notImplemented)(["AGGREGATE multi-cell array param"]));const r=e.coerceOper(e.dereferenceOper(c,t),t);if((0,i.isErrorOper)(r))return a.valueErrorOper;if((0,i.isRangeOper)(l)&&!(0,i.isSheetIndex)(l.sheets))return a.valueErrorOper;const[n]=C([l]);return(0,De[p-Me.length-1])(e,n,r)}for(let e=2;e<t.length;e+=1){const r=t[e];if(!r||!(0,i.isRangeOper)(r)||!(0,i.isSheetIndex)(r.sheets))return a.valueErrorOper}const A=C(t.slice(2));return(0,n.assertTrue)("calc.funcs.aggregate: requested non-array function with unexpected number",p>=1&&p<=Me.length),(0,Me[p-1])(e,A)},t.rank=function(e,t){return we(e,t,!1)},t.rank_avg=function(e,t){return we(e,t,!0)},t.avedev=function(e,t){const r=e.dereferenceAllOpers(t),n=xe(Le,e,r);if(!Array.isArray(n))return n;const[a,i]=n;return e.mathpack.div(a,e.mathpack.fromNumber(i))},t.devsq=function(e,t){const r=e.dereferenceAllOpers(t),n=xe(me,e,r);if(!Array.isArray(n))return n;const[a]=n;return a};const Ke=new Float64Array(1),We=new Int32Array(Ke.buffer);function Ue(e,t){Ke[0]=e.toNumber(t);const r=((2146435072&We[1])>>>20)-1023;return We[1]=-2146435073&We[1]|1072693248,[e.fromNumber(Ke[0]),r]}function Ge(e,t,r){Ke[0]=e.toNumber(t);const n=((2146435072&We[1])>>>20)-1023;return We[1]=-2146435073&We[1]|n+r+1023<<20&2146435072,e.fromNumber(Ke[0])}t.geomean=function(e,t){const r=e.mathpack,o=e.dereferenceAllOpers(t),s={count:0,prodExp:0};let u=(0,d.reduceDerefOpers)(e,function(e,t){const r=e.mathpack;return function(e,o,s){if(void 0!==e&&(0,i.isErrorOper)(e))return e;if((0,n.assertTrue)("calc.funcs.geometricReducer",void 0===e||(0,i.isNumberOper)(e)),(0,i.isErrorOper)(o))return o;if((0,n.assertTrue)("calc.funcs.geometricReducer",(0,i.isNumberOper)(o)),r.cond(o)<=0)return a.numErrorOper;const[u,l]=Ue(r,o);let c=e??r.one;for(let e=0;e<s;e+=1){if(t.count%512==511){const[e,n]=Ue(r,c);if(t.prodExp+=n,c=e,t.prodExp>2130706431||t.prodExp<-2130706431)return a.numErrorOper}t.count+=1,t.prodExp+=l,c=r.mul(c,u),(0,n.assertTrue)("calc.funcs.geometricReducer",!(0,i.isErrorOper)(c))}return c}}(e,s),v,o);if(null==u)return a.numErrorOper;if((0,i.isErrorOper)(u))return u;if((0,n.assertTrue)("calc.funcs.geomean",s.count>0&&(0,i.isNumberOper)(u)),1===s.count)return Ge(r,u,s.prodExp);{const[e,t]=Ue(r,u);s.prodExp+=t,u=e}const l=s.prodExp/s.count|0,c=s.prodExp%s.count,g=r.div(r.one,r.fromNumber(s.count));if((0,n.assertTrue)("calc.funcs.geomean",!(0,i.isErrorOper)(g)),c<=1e3){const e=Ge(r,u,c),t=r.power(e,g);return(0,n.assertTrue)("calc.funcs.geomean",!(0,i.isErrorOper)(t)),Ge(r,t,l)}const m=c-1e3,h=Ge(r,u,c-m),p=r.power(h,g);(0,n.assertTrue)("calc.funcs.geomean",!(0,i.isErrorOper)(p));const f=Ge(r,p,l),S=r.mul(r.fromNumber(s.count),r.fromNumber(1.4426950408889636));(0,n.assertTrue)("calc.funcs.geomean",!(0,i.isErrorOper)(S));const F=r.div(r.fromNumber(m),S);(0,n.assertTrue)("calc.funcs.geomean",!(0,i.isErrorOper)(F));const y=r.exp(F);return(0,i.isErrorOper)(y)?y:r.mul(f,y)},t.harmean=function(e,t){const r=e.dereferenceAllOpers(t),o=(s=v,function(e,t){const r=s(e,t);if(void 0===r||!(0,i.isNumberOper)(r))return r;const n=e.mathpack;return n.cond(r)<=0?a.numErrorOper:n.div(n.one,r)});var s;const u=(0,d.reduceDerefOpers)(e,y(e.mathpack.add),o,r);if(null==u)return a.naErrorOper;if((0,i.isErrorOper)(u))return u;const l={count:0},c=(0,d.reduceDerefOpers)(e,C(l),o,r);(0,n.assertTrue)("calc.funcs.harmean",(0,i.isNumberOper)(u)&&c?.kind===h.OperKind.Number&&l.count>0);const g=e.mathpack.div(u,e.mathpack.fromNumber(l.count));return(0,i.isErrorOper)(g)?g:e.mathpack.div(e.mathpack.one,g)};const Be=e=>(0,i.isRichOper)(e)?e.getFallback():e;t.sumproduct=(e,t)=>{const r=t.map((e=>(0,a.arrayOper)(e.rows,e.cols,e.opers.map((e=>e.map(Be)))))),n=e.mathpack;for(const e of r)for(const t of e.opers)for(const e of t)if((0,i.isErrorOper)(e))return e;const o=r[0].rows,s=r[0].cols;if(!r.every((e=>e.rows===o&&e.cols===s)))return a.valueErrorOper;let u=n.zero;for(let e=0;e<o;++e)e:for(let t=0;t<s;++t){const a=r[0].opers[e][t];if(!(0,i.isNumberOper)(a))continue e;let o=a;for(let a=1;a<r.length;++a){const s=r[a].opers[e][t];if(!(0,i.isNumberOper)(s))continue e;if(o=n.mul(o,s),(0,i.isErrorOper)(o))return o}if(u=n.add(o,u),(0,i.isErrorOper)(u))return u}return u}},86075:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unique=t.sortby=t.sort=t.filter=void 0;const n=r(93371),a=r(18612),i=r(77981),o=r(51465),s=r(79673),u=r(92158),l=r(70633),c=r(70633),d=r(64316),g=r(47691),m=r(88435);function h(e){return(0,u.isBlankOper)(e)?(0,c.arrayOper)(1,1,[[e]]):e}function p(e,t=l.missingOper,r,n){const a=e.mathpack,i=(0,u.isMissingOper)(t)?(0,c.arrayOper)(1,1,[[a.one]]):t;if(!(1===i.rows&&i.cols>=1||1===i.cols&&i.rows>=1))return c.valueErrorOper;if(i.rows*i.cols>r)return c.valueErrorOper;const o=[];for(let t=0;t<i.rows;++t)for(let r=0;r<i.cols;++r){const l=e.coerceOper(i.opers[t][r],s.OperKind.Number);if(!(0,u.isNumberOper)(l))return(0,m.assertError)(l);const c=n(a.sfix(l));if("number"!=typeof c)return c;o.push(c)}return o}function f(e,t){return t?new n.NonstrictArray2D(e.cols,e.rows,((t,r)=>e.opers[r][t])):new n.StrictArray2D(e.rows,e.cols,e.opers)}function S(e,t,r,a){const{rows:i,cols:o}=t,s=e.config,u=[];for(let e=0;e<i;++e)u.push(e);u.sort(((e,t)=>{for(let r=0;r<a.length;++r){const[n,i]=a[r],o=(0,g.sortOpers)(s,n(e),n(t),i,!1);if(0!==o)return o}return e-t}));const l=new n.NonstrictArray2D(i,o,((e,r)=>t.get(u[e],r))),d=r?(0,n.transposeArray2D)(l):l;return(0,c.arrayOper)(d.rows,d.cols,(0,n.array2DToJaggedArray)(d))}t.filter=function(e,t){const[r,a,i]=t,o=(0,m.rangeOrArrayToVal)(r,c.refErrorOper);if((0,u.isErrorOper)(o))return o;const l=(0,m.rangeOrArrayToVal)(a,c.refErrorOper);if((0,u.isErrorOper)(l))return l;const{rows:g,cols:h}=(0,m.makeSlicer)(o),{rows:p,cols:f}=(0,m.makeSlicer)(l);if(!(1===p&&f>=1||1===f&&p>=1))return c.valueErrorOper;const S=1===p&&1===f?1===g:p>1;if(S?p!==g:f!==h)return c.valueErrorOper;const[v]=e.dereferenceAllOpers([l]),F=(0,n.sparseArray2DTo1D)((0,d.isRangeValues)(v)?v.arrays[0]:new n.StrictSparseArray2D(v.rows,v.cols,v.rows,v.cols,v.opers,c.blankOper),!S),y=[];for(let t=0;t<F.length;++t){const r=e.coerceOper(F.get(t),s.OperKind.Boolean);if(!(0,u.isBooleanOper)(r))return r;if(r.value)y.push(t);else if(t>=F.denseLength)break}if(S?(0,m.validateArraySize)(y.length,h):(0,m.validateArraySize)(g,y.length),0===y.length)return void 0===i||(0,u.isMissingOper)(i)?c.calcErrorOper:i;const[C]=e.dereferenceAllOpers([o]),A=(0,d.isRangeValues)(C)?C.arrays[0]:new n.StrictArray2D(C.rows,C.cols,C.opers),E=e=>new n.NonstrictArray2D(y.length,e.cols,((t,r)=>e.get(y[t],r))),b=S?E(A):(0,n.transposeArray2D)(E((0,n.transposeArray2D)(A)));return(0,c.arrayOper)(b.rows,b.cols,(0,n.array2DToJaggedArray)(b))},t.sort=function(e,t){const[r,n,a,i]=t,s=h(r),u=!!i&&i.value,l=f(s,u),d=l.cols,g=p(e,n,d,(e=>e>=1&&e<=d?e-1:c.valueErrorOper));if(!Array.isArray(g))return g;const m=p(e,a,g.length,(e=>1===e||-1===e?e:c.valueErrorOper));if(!Array.isArray(m))return m;if(1===m.length)m.length=g.length,(0,o.arrayFill)(m,m[0]);else if(m.length!==g.length)return c.valueErrorOper;const v=g.map(((e,t)=>[t=>l.get(t,e),m[t]]));return 1===l.rows?s:S(e,l,u,v)},t.sortby=function(e,t){const[r,...n]=t,i=h(r);(0,a.assertTrue)("calc.funcs.sortby",n.every(((e,t)=>t%2==0?(0,u.isArrayOper)(e)||(0,u.isBlankOper)(e):(0,u.isNumberOper)(e)||(0,u.isMissingOper)(e))));const o=[];for(let e=0;e<n.length;e+=2)o.push([h(n[e]),n[e+1]??l.missingOper]);const s=o[0][0].cols>=o[0][0].rows&&o[0][0].cols===i.cols,d=f(i,s),g=[];for(const[t,r]of o){if(1!==t.rows&&1!==t.cols)return c.valueErrorOper;if(!(s?t.cols===i.cols:t.rows===i.rows))return c.valueErrorOper;const n=t.opers,a=e.mathpack.sfix((0,u.isNumberOper)(r)?r:e.mathpack.one);if(1!==a&&-1!==a)return c.valueErrorOper;g.push([s?e=>n[0][e]:e=>n[e][0],a])}return 1===d.rows?i:S(e,d,s,g)},t.unique=function(e,t){const[r,a,o]=t,s=h(r),u=a?.value??!1,l=o?.value??!1,d=f(s,u);if(1===d.rows)return s;const m=e.config,p=[];let S=i.RedBlackMapTree.create(((e,t)=>{for(let r=0;r<d.cols;++r){const n=(0,g.sortOpers)(m,d.get(e,r),d.get(t,r),1,!0);if(0!==n)return n}return 0}));for(let e=0;e<d.rows;++e){let t;[S,t]=S.getOrSetValue(e,(()=>({firstRow:e,count:0}))),t.count+=1,p.push(t)}const v=l?p.filter((e=>1===e.count)):p.filter(((e,t)=>e.firstRow===t));if(0===v.length)return c.calcErrorOper;const F=new n.NonstrictArray2D(v.length,d.cols,((e,t)=>d.get(v[e].firstRow,t))),y=u?(0,n.transposeArray2D)(F):F;return(0,c.arrayOper)(y.rows,y.cols,(0,n.array2DToJaggedArray)(y))}},52182:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyCriteria=t.compileCriteria=t.parseCriteria=void 0;const n=r(70633),a=r(59242),i=r(93371),o=r(71766),s=r(95625),u=r(92158),l=r(18612),c=r(91282),d=r(36094),g=r(79673),m={"=":a.OperatorId.Eq,"<":a.OperatorId.Lt,">":a.OperatorId.Gt},h={"<>":a.OperatorId.Ne,"<=":a.OperatorId.Le,">=":a.OperatorId.Ge};function p(e,t){if(!(0,u.isStringOper)(t))return t;const[r,a]=function(e){if(e.length>=2){const t=h[e.substring(0,2)];if(void 0!==t)return[t,e.substring(2)]}if(e.length>=1){const t=m[e.substring(0,1)];if(void 0!==t)return[t,e.substring(1)]}return[void 0,e]}(t.value),i=function(e,t){const{localeInfo:r}=e.config;if(0===r.stringCompareCI(t,r.trueName))return n.trueOper;if(0===r.stringCompareCI(t,r.falseName))return n.falseOper;for(let e=1;e<r.errorNames.length;e+=1){const a=r.errorNames[e];if(null!=a&&0===r.stringCompareCI(a,t))return(0,n.errorOper)(e)}const a=e.parseGeneral(t,!1);return void 0!==a?a:(0,n.stringOper)(t)}(e,a);return{kind:"FilterExpression",operator:r,operand:i}}function f(e,t){const r="FilterExpression"===t.kind?t:{kind:"FilterExpression",operator:a.OperatorId.Eq,operand:t},{mathpack:n,localeInfo:i}=e.config;if(r.operator===a.OperatorId.Ne&&(0,d.isEmptyStringOper)(r.operand))return e=>!(0,u.isBlankOper)(e);if(r.operator===a.OperatorId.Eq&&(0,d.isEmptyStringOper)(r.operand))return u.isBlankOper;if(void 0!==r.operator&&(0,d.isEmptyStringOper)(r.operand))return e=>!1;if(void 0===r.operator&&(0,d.isEmptyStringOper)(r.operand))return e=>(0,u.isBlankOper)(e)||(0,d.isEmptyStringOper)(e);const o=void 0===r.operator?a.OperatorId.Eq:r.operator;switch(r.operand.kind){case g.OperKind.Number:return m=o,h=r.operand,t=>{const r=(0,u.isRichOper)(t)?t.getFallback():t;if((0,u.isNumberOper)(r))return(0,s.cmpNum)(n,m,r,h);if((0,u.isStringOper)(r)&&m===a.OperatorId.Eq){const t=e.parseGeneral(r.value,!1);return void 0!==t&&(0,s.cmpNum)(n,m,t,h)}return m===a.OperatorId.Ne};case g.OperKind.Boolean:return function(e,t){return r=>{const n=(0,u.isRichOper)(r)?r.getFallback():r;return(0,u.isBooleanOper)(n)?(0,s.cmpBool)(e,n,t):e===a.OperatorId.Ne}}(o,r.operand);case g.OperKind.String:return function(e,t){switch(e){case a.OperatorId.Eq:case a.OperatorId.Ne:const r=new c.WildExp(i,t.value);return t=>{const n=(0,u.isRichOper)(t)?t.getFallback():t;return(0,u.isStringOper)(n)?r.test(n.value)===(e===a.OperatorId.Eq):e===a.OperatorId.Ne};case a.OperatorId.Lt:case a.OperatorId.Gt:case a.OperatorId.Le:case a.OperatorId.Ge:return r=>{const n=(0,u.isRichOper)(r)?r.getFallback():r;return!!(0,u.isStringOper)(n)&&(0,s.cmpStr)(i,e,n,t)}}}(o,r.operand);case g.OperKind.Error:return function(e,t){return r=>{const n=(0,u.isRichOper)(r)?r.getFallback():r;return(0,u.isErrorOper)(n)?(0,s.cmpInt)(e,n.type-t.type):e===a.OperatorId.Ne}}(o,r.operand);default:return(0,l.assertNever)("calc.funcs.criteria.compileCriteria",r.operand)}var m,h}t.parseCriteria=p,t.compileCriteria=f,t.applyCriteria=function(e,t,r,n){const a=f(e,p(e,r)),s=t,u=void 0===n?s:n;return new i.NonstrictSparseArray2D(u.rows,u.cols,(0,o.fastMax)(s.denseRows,u.denseRows),(0,o.fastMax)(s.denseCols,u.denseCols),((e,t)=>{const r=s.get(e,t);return a(r)?u.get(e,t):void 0}),(()=>{const e=s.getSparse();return a(e)?u.getSparse():void 0}))}},3387:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.yearFrac=t.networkdays=t.networkdays_intl=t.eomonth=t.edate=t.workday=t.workday_intl=t.days=t.datedif=t.days360=t.time=t.date=t.weeknum=t.isoweeknum=t.weekday=t.second=t.minute=t.hour=t.day=t.month=t.year=void 0;const n=r(70633),a=r(10919),i=r(88435),o=r(92158),s=r(43376),u=r(79673),l=r(18612);function c(e,t,[r]){const{datepack:i,config:o}=t,s=i.fromNum(o,r,a.Rounding.RoundSec);return!1===s?n.numErrorOper:t.mathpack.fromNumber(e(s))}function d(e,[t,r],i=!1){const{config:o,mathpack:s,datepack:u}=e,l=u.fromNum({...o,date1904:o.date1904&&!i},t,a.Rounding.RoundSec);if(!1===l)return n.numErrorOper;let c;switch(void 0!==r?s.sfix(r):1){case 1:case 17:c=l.wdy;break;case 2:case 11:c=1===l.wdy?7:l.wdy-1;break;case 3:c=1===l.wdy?6:l.wdy-2;break;case 12:c=(l.wdy+4)%7+1;break;case 13:c=(l.wdy+3)%7+1;break;case 14:c=(l.wdy+2)%7+1;break;case 15:c=(l.wdy+1)%7+1;break;case 16:c=l.wdy%7+1;break;default:return n.numErrorOper}return s.fromNumber(c)}function g(e,t,r){if(!t){const t=e.lfix(r);if(0===t||1===t)return e.fromNumber(52)}return n.numErrorOper}function m(e,t,[r,s]){const u=(0,i.chkDateOper)(t,r);if((0,o.isErrorOper)(u))return u;const[c,m]=function(e,t,r){if(void 0===t||(0,o.isMissingOper)(t))return[r?2:1,r];const n=(0,i.chkNumOper)(e,t);if(!(0,o.isErrorOper)(n)){const t=e.mathpack.sfix(n);if(r){if(1===t||2===t)return[t,r]}else{if(1===t||2===t)return[t,r];if(t>=11&&t<=16)return[t-9,r];if(17===t)return[1,r];if(21===t)return[2,!0]}}return[void 0,r]}(t,s,e);if(void 0===c)return n.numErrorOper;const{mathpack:h,datepack:p,config:f}=t,S={...f,date1904:!1},v=p.fromNum(S,u,a.Rounding.RoundSec);if(!1===v)return g(h,S.dateCompatibility,u);const F=(0,a.dateTime)(v.yr,1,1,0,0,0,0,0,a.Rounding.RoundSec),y=p.toNum(S,F);if((0,o.isErrorOper)(y))return g(h,S.dateCompatibility,u);const C=d(t,[y],!0);if((0,o.isErrorOper)(C))return C;const A=(0,i.assertNumber)(h.add((0,i.assertNumber)(h.sub(C,h.fromNumber(c))),h.fromNumber(7))),E=(0,i.assertNumber)((0,i.numMod)(h,A,h.fromNumber(7))),b=(0,i.assertNumber)(h.add(h.floor((0,i.assertNumber)(h.div((0,i.assertNumber)(h.add((0,i.assertNumber)(h.sub(u,y)),E)),h.fromNumber(7)))),h.one));return m?function(e,t,r,n){const{mathpack:a,datepack:o,config:s}=e,u={...n},c=(t+6-u.wdy)%7;if(12===u.mon&&u.dom+c>=35)return a.one;u.dom=4,u.mon=1;let d=o.toDays(s,u);if((0,l.assertTrue)("calc.funcs.weeknumISOAmendments",!1!==d),d=(d-1)%7+1,(d-t+7)%7<3){const e=(0,i.assertNumber)(a.sub(r,a.one));if(0===a.cond(e)){const e=u.yr-1;return t===d||e%4==0&&(e%100!=0||e%400==0)&&(t-d+7)%7==6?a.fromNumber(53):a.fromNumber(52)}return e}return r}(t,c,b,v):b}t.year=c.bind(void 0,(e=>e.yr)),t.month=c.bind(void 0,(e=>e.mon)),t.day=c.bind(void 0,(e=>e.dom)),t.hour=c.bind(void 0,(e=>e.hour)),t.minute=c.bind(void 0,(e=>e.min)),t.second=c.bind(void 0,(e=>e.sec)),t.weekday=function(e,t){return d(e,t)},t.isoweeknum=m.bind(void 0,!0),t.weeknum=m.bind(void 0,!1);const h=-32768,p=32767,f=1900;function S(e,t){let r;if((0,o.isStringOper)(t)){const a=t.value.replace(/^\s+/,"");if(r=e.coerceOper((0,n.stringOper)(a),u.OperKind.Number),(0,o.isErrorOper)(r))return r}else r=t;return(0,i.chkDateOper)(e,r)}function v(e,t,r){return r?(0,i.assertNumber)(e.sub(t,e.fromNumber(i.atpm1904to1900Days))):t}function F(e,t){return 0!=(e>>t%7&1)}var y;function C(e){switch(e){case 1:return y.Saturday|y.Sunday;case 2:return y.Sunday|y.Monday;case 3:return y.Monday|y.Tuesday;case 4:return y.Tuesday|y.Wednesday;case 5:return y.Wednesday|y.Thursday;case 6:return y.Thursday|y.Friday;case 7:return y.Friday|y.Saturday;case 11:return y.Sunday;case 12:return y.Monday;case 13:return y.Tuesday;case 14:return y.Wednesday;case 15:return y.Thursday;case 16:return y.Friday;case 17:return y.Saturday;default:return!1}}function A(e){if(7!==e.length)return!1;let t=y.None;for(let r=0;r<e.length;r+=1)if("1"===e[r])t|=1<<(r+2)%7;else if("0"!==e[r])return!1;return t}function E(e,[t,r,a,l]){let c=y.Saturday|y.Sunday,d=(0,i.chkDateOper)(e,t);if((0,o.isErrorOper)(d))return d;let g=(0,i.chkNumOper)(e,r);if((0,o.isErrorOper)(g))return g;const{mathpack:m,config:h}=e;g=m.floor(g);const p=m.cond(g)>0?m.one:m.fromNumber(-1);let f=m.abs(g);const S=(0,i.assertNumber)(m.add(d,g));if(!(0,i.validDateRange)(e,S))return n.numErrorOper;if(0===m.cond(f))return v(m,d,h.date1904);let E=null;const b=[];if(a){if(!(0,o.isMissingOper)(a)){if((0,o.isNumberOper)(a)){const e=C(m.lfix(a));if(!1===e)return n.numErrorOper;c=e}else{if(!(0,o.isStringOper)(a))return n.numErrorOper;{const e=A(a.value);if(!1===e)return n.valueErrorOper;c=e}}if(127===c)return n.valueErrorOper}if(l&&!(0,o.isMissingOper)(l)){const t=(0,i.chkNumMultiOper)(e,l);if(!(0,s.isSuccess)(t))return t.reason;E=t.value}}const R=null==E?[]:function(e){const t=[],r=e.getSparse(),n=e.cols-e.denseCols;for(let a=0;a<e.denseRows;a+=1){for(let r=0;r<e.denseCols;r+=1){const n=e.get(a,r);void 0!==n&&t.push(n)}if(n>0&&void 0!==r)for(let e=0;e<n;e+=1)t.push(r)}const a=(e.rows-e.denseRows)*e.cols;if(a>0&&void 0!==r)for(let e=0;e<a;e+=1)t.push(r);return t}(E);for(let t=R.length-1;t>=0;t-=1){const r=R[t];switch(r.kind){case u.OperKind.Number:case u.OperKind.String:case u.OperKind.Blank:const a=(0,i.chkDateOper)(e,r);if((0,o.isErrorOper)(a))return a;b[t]=a;break;case u.OperKind.Error:return r;default:return n.valueErrorOper}}for(;m.cond(f)>0;){if(d=(0,i.assertNumber)(m.add(d,p)),F(c,m.lfix(d)))continue;let e=!0;for(let t=0;t<R.length;t+=1)if(0===m.cond2(b[t],d)){e=!1;break}e&&(f=(0,i.assertNumber)(m.sub(f,m.one)))}return d=v(m,d,h.date1904),(0,i.validDateRange)(e,d)?d:n.numErrorOper}t.date=function(e,[t,r,i]){const{mathpack:o,datepack:s,config:u}=e;let l=o.sfix(t);if(l>9999)return n.numErrorOper;const c=o.sfix(r);if(c>p||c<h)return n.numErrorOper;let d=o.sfix(i);(d>p||d<h)&&(d=p),u.dateCompatibility?l<f&&(l+=1900):l<f&&!(1899===l&&12===c&&d>=30)&&(l+=1900);const g=(0,a.dateTime)(l,c,d,0,0,0,0,0,a.Rounding.RoundSec);return s.toNum(u,g)},t.time=function(e,[t,r,i]){const{mathpack:s,datepack:u,config:l}=e,c=s.sfix(t);if(c>32767)return n.numErrorOper;const d=s.sfix(r);if(d>32767)return n.numErrorOper;const g=s.sfix(i);if(g>32767)return n.numErrorOper;let m,h,p;l.dateCompatibility?(m=l.date1904?1904:1900,h=1,p=l.date1904?1:0):(m=1899,h=12,p=30);const f=(0,a.dateTime)(m,h,p,c,d,g,0,0,a.Rounding.RoundSec),S=u.toNum(l,f);return(0,o.isErrorOper)(S)?S:s.cond(S)<0?n.numErrorOper:s.sub(S,s.trunc(S))},t.days360=function(e,[t,r,i]){const{mathpack:o,datepack:s,config:u}=e,l=i?.value??!1,c=s.fromNum(u,t,a.Rounding.RoundSec);if(!1===c)return n.naErrorOper;const d=31===c.dom||!l&&2===c.mon&&c.dom===s.daysPerMonth(2,c.yr,u.dateCompatibility)?30:c.dom,g=o.fromNumber(360*(c.yr-f)+30*c.mon+d),m=s.fromNum(u,r,a.Rounding.RoundSec);if(!1===m)return n.naErrorOper;const h=31!==m.dom||!l&&30!==c.dom?m.dom:30,p=o.fromNumber(360*(m.yr-f)+30*m.mon+h);return o.sub(p,g)},t.datedif=function(e,[t,r,{value:i}]){if(i.length>2||0===i.length)return n.numErrorOper;const{mathpack:o,datepack:s,config:u}=e,l=o.lfix(t),c=s.fromNum(u,t,a.Rounding.RoundSec);if(!1===c)return n.numErrorOper;const d=e.mathpack.lfix(r),g=s.fromNum(u,r,a.Rounding.RoundSec);if(!1===g)return n.numErrorOper;if(l>d)return n.numErrorOper;let m=g.dom,h=g.mon,p=g.yr;c.dom>m&&(h-=1,0===h&&(h=12,p-=1),m+=s.daysPerMonth(h,p,u.dateCompatibility)),c.mon>h&&(h+=12,p-=1);const f=(e,t)=>0===u.localeInfo.stringCompareCI(e,t);if(f(i,"Y"))return o.fromNumber(p-c.yr);if(f(i,"M"))return o.fromNumber(12*(p-c.yr)+(h-c.mon));if(f(i,"D"))return o.fromNumber(d-l);if(f(i,"MD"))return o.fromNumber(m-c.dom);if(f(i,"YM"))return o.fromNumber(h-c.mon);if(f(i,"YD")){let e=0;for(let t=c.mon;t<h;t+=1)e+=s.daysPerMonth(t,c.yr,u.dateCompatibility);return o.fromNumber(e+(m-c.dom))}return n.numErrorOper},t.days=function(e,[t,r]){if((0,o.isStringOper)(t)&&t.value.length>255||(0,o.isStringOper)(r)&&r.value.length>255)return n.valueErrorOper;const a=S(e,t);if((0,o.isErrorOper)(a))return a;const i=S(e,r);return(0,o.isErrorOper)(i)?i:e.mathpack.sub(a,i)},function(e){e[e.None=0]="None",e[e.Saturday=1]="Saturday",e[e.Sunday=2]="Sunday",e[e.Monday=4]="Monday",e[e.Tuesday=8]="Tuesday",e[e.Wednesday=16]="Wednesday",e[e.Thursday=32]="Thursday",e[e.Friday=64]="Friday"}(y||(y={})),t.workday_intl=E,t.workday=function(e,[t,r,a]){return E(e,a?[t,r,n.missingOper,a]:[t,r])};const b=1900,R=-9999;function T(e,t,[r,s]){const u=(0,i.chkDateOper)(t,r);if((0,o.isErrorOper)(u))return u;let l=(0,i.chkNumOper)(t,s);if((0,o.isErrorOper)(l))return l;const{mathpack:c,config:d}=t;l=c.cond(l)>0?c.floor(l):c.ceil(l);const g=function(e,t,r,n){const{mathpack:s,datepack:u,config:l}=e,c={...l,date1904:!1},d=u.fromNum(c,t,a.Rounding.RoundSec);if(!1===d)return d;let g=s.fromNumber(d.dom),m=s.fromNumber(d.mon);const h=s.fromNumber(12);let p=s.fromNumber(d.yr);if(s.cond(r)>=0){p=(0,i.assertNumber)(s.add(s.floor((0,i.assertNumber)(s.div(r,h))),p));const e=(0,i.assertNumber)((0,i.numMod)(s,r,h)),t=(0,i.assertNumber)(s.add(e,m));1===s.cond2(t,h)&&(p=(0,i.assertNumber)(s.add(p,s.one))),m=(0,i.assertNumber)((0,i.numMod)(s,t,h))}else{const e=s.neg(r),t=s.floor((0,i.assertNumber)(s.div(e,h)));p=(0,i.assertNumber)(s.sub(p,t));const n=(0,i.assertNumber)((0,i.numMod)(s,e,h));if(s.cond2(n,m)>=0)p=(0,i.assertNumber)(s.sub(p,s.one)),m=(0,i.assertNumber)(s.add((0,i.assertNumber)(s.sub(m,n)),h));else{const e=(0,i.assertNumber)(s.sub(m,n));m=(0,i.assertNumber)((0,i.numMod)(s,e,h))}}0===s.cond(m)&&(m=h);const f=s.lfix(m);switch(f){case 4:case 6:case 9:case 11:const e=s.fromNumber(30);s.cond2(g,e)>0&&(g=e);break;case 2:s.cond2(g,s.fromNumber(28))>0&&(g=s.fromNumber(u.daysPerMonth(2,s.toNumber(p),!1)))}if(n&&(g=s.fromNumber(u.daysPerMonth(f,s.toNumber(p),!1))),s.lfix(p)<(c.dateCompatibility?b:R))return!1;const S=function(e,t,r,n,i,o){const s=e.lfix(n),u=e.lfix(i),l=e.lfix(o);return t.toNum(r,(0,a.dateTime)(l,u,s,0,0,0,0,0,a.Rounding.RoundSec))}(s,u,c,g,m,p);return!(0,o.isErrorOper)(S)&&S}(t,u,l,!e);return!1===g?n.numErrorOper:v(c,g,d.date1904)}function k(e,[t,r,a,s]){const l=e.mathpack;let c,d=y.Saturday|y.Sunday,g=5;function m(e){d=e,g=7;let t=d;for(;0!==t;)1==(1&t)&&(g-=1),t>>=1}if(void 0!==a&&!(0,o.isMissingOper)(a))if((0,o.isStringOper)(a)){const e=A(a.value);if(!1===e)return n.valueErrorOper;m(e)}else{const t=(0,i.chkNumOper)(e,a);if((0,o.isErrorOper)(t))return n.valueErrorOper;const r=C(l.lfix(t));if(!1===r)return n.numErrorOper;m(r)}const h=s??n.missingOper,p=(0,i.chkDateOper)(e,t);if((0,o.isErrorOper)(p))return p;const f=(0,i.chkDateOper)(e,r);if((0,o.isErrorOper)(f))return f;let S,v=l.lfix(p),E=l.lfix(f);v>E?(S=v,v=E,E=S,c=-1):c=1,S=v%7,S=E%7;let b=0,R=v<E?v:E,T=v<E?E:v;for(;R%7!=0&&R!==T;)F(d,R)||(b+=1),R+=1;for(;T%7!=6&&R!==T;)F(d,T)||(b+=1),T-=1;if(T===R&&1!=(d>>R%7&1)&&(b+=1),v>E){const e=R;R=T,T=e}let k=l.fromNumber(g*Math.floor((T+1-R)/7)+b);switch(h.kind){case u.OperKind.Number:case u.OperKind.String:const t=(0,i.chkDateOper)(e,h);if((0,o.isErrorOper)(t))return t;S=l.lfix(t),S>=v&&S<=E&&S%7>=2&&(k=(0,i.assertNumber)(l.sub(k,l.one)));break;case u.OperKind.Range:case u.OperKind.Array:const r=function(e,t,r,a,s,l){let c;const d=e.mathpack;if(void 0===l||(0,o.isMissingOper)(l))c=y.Saturday|y.Sunday;else if((0,o.isStringOper)(l)){const e=A(l.value);if(!1===e)return n.valueErrorOper;c=e}else{const t=(0,i.chkNumOper)(e,l);if((0,o.isErrorOper)(t))return n.valueErrorOper;const r=C(d.lfix(t));if(!1===r)return n.numErrorOper;c=r}const g=d.fromNumber(r),m=d.fromNumber(a),h=e.dereferenceOper(s,u.OperKind.Array);if(!(0,o.isArrayOper)(h))return n.valueErrorOper;const p=[];function f(e){if(d.cond2(e,g)>=0&&d.cond2(e,m)<=0){const t=d.lfix(e);F(c,t)||p.push(e)}}for(let t=0;t<h.rows;t+=1)for(let r=0;r<h.cols;r+=1){const a=h.opers[t][r];switch(a.kind){case u.OperKind.Number:case u.OperKind.String:const t=(0,i.chkDateOper)(e,a);if((0,o.isErrorOper)(t))return t;f(t);break;case u.OperKind.Blank:break;case u.OperKind.Error:return a;default:return n.valueErrorOper}}let S=t;if(0!==p.length){const e=p.sort(((e,t)=>d.cond2(e,t)));let t=e[0];S=(0,i.assertNumber)(d.sub(S,d.one));for(let r=0;r<e.length;r+=1){const n=e[r];0!==d.cond2(n,t)&&(t=n,S=(0,i.assertNumber)(d.sub(S,d.one)))}}return S}(e,k,v,E,h,a);if((0,o.isErrorOper)(r))return r;k=r;break;case u.OperKind.Error:return h;case u.OperKind.Missing:break;default:return n.valueErrorOper}return l.mul(l.fromNumber(c),k)}function N(e,t,r,n,a,i,o){const{mathpack:s}=e,u=360*(r-t),l=30*(a-n);return s.fromNumber(o-i+l+u)}function I(e,t,r,n){const{datepack:a,config:i}=e;return t===a.daysPerMonth(r,n,i.dateCompatibility)}var O;t.edate=T.bind(void 0,!0),t.eomonth=T.bind(void 0,!1),t.networkdays_intl=k,t.networkdays=function(e,[t,r,a]){return k(e,a?[t,r,n.missingOper,a]:[t,r])},function(e){e[e.DefaultBasis=0]="DefaultBasis",e[e.Basis30360=0]="Basis30360",e[e.BasisActual=1]="BasisActual",e[e.BasisActual360=2]="BasisActual360",e[e.BasisActual365=3]="BasisActual365",e[e.BasisE30360=4]="BasisE30360"}(O||(O={})),t.yearFrac=function(e,[t,r,s]){let u=O.DefaultBasis;if(void 0!==s){const t=function(e,t){let r=O.DefaultBasis;if(void 0===t||(0,o.isMissingOper)(t))return r;const a=(0,i.chkNumOper)(e,t);if((0,o.isErrorOper)(a))return a;const s=e.mathpack;switch(r=s.lfix(s.floor(a)),r){case O.Basis30360:case O.BasisActual:case O.BasisActual360:case O.BasisActual365:case O.BasisE30360:return r;default:return n.numErrorOper}}(e,s);if("number"!=typeof t)return t;u=t}let l=(0,i.chkDateOper)(e,t);if((0,o.isErrorOper)(l))return l;let c=(0,i.chkDateOper)(e,r);if((0,o.isErrorOper)(c))return c;const d=e.mathpack;if(d.cond2(l,c)>0){const e=l;l=c,c=e}const g=function(e,t,r,n,o){const s=e.mathpack;switch(s.cond2(t,r)){case 1:break;case 0:return s.zero;case-1:switch(n){case O.Basis30360:return function(e,t,r,n,i){const{datepack:o,config:s}=e,u=o.fromNum(s,t,a.Rounding.RoundSec);if(!1===u)return!1;let l=u.dom;const c=u.mon,d=u.yr,g=o.fromNum(s,r,a.Rounding.RoundSec);if(!1===g)return!1;let m=g.dom;const h=g.mon,p=g.yr;return 2===m&&I(e,m,h,p)&&(2===l&&I(e,l,c,d)||3===n)&&(m=30),31===m&&(l>=30||3===n)&&(m=30),31===l&&(l=30),2===c&&I(e,l,c,d)&&(l=30),N(e,d,p,c,h,l,m)}(e,t,r,o);case O.BasisActual360:case O.BasisActual365:case O.BasisActual:return(0,i.assertNumber)(s.sub(r,t));case O.BasisE30360:return function(e,t,r){const{datepack:n,config:i}=e,o=n.fromNum(i,t,a.Rounding.RoundSec);if(!1===o)return!1;let s=o.dom;const u=o.mon,l=o.yr,c=n.fromNum(i,r,a.Rounding.RoundSec);if(!1===c)return!1;let d=c.dom;const g=c.mon;return 31===s&&(s=30),31===d&&(d=30),N(e,l,c.yr,u,g,s,d)}(e,t,r)}}return!1}(e,l,c,u,0);if(!1===g)return n.numErrorOper;const m=function(e,t,r,n){const{mathpack:s,datepack:u,config:l}=e,c=s.fromNumber(360),d=s.fromNumber(365),g=s.fromNumber(366);switch(t){case O.BasisActual:const e=u.fromNum(l,r,a.Rounding.RoundSec);if(!1===e)return!1;const t=e.dom,m=e.mon,h=e.yr,p=u.fromNum(l,n,a.Rounding.RoundSec);if(!1===p)return!1;const f=p.dom,S=p.mon,v=p.yr,F=v-1;if(h===v)return 29===u.daysPerMonth(2,h,l.dateCompatibility)?g:d;if(F===h&&(m>S||m===S&&t>=f)){if(29===u.daysPerMonth(2,h,l.dateCompatibility)){const e=u.toNum(l,(0,a.dateTime)(h,2,29,0,0,0,0,0,a.Rounding.RoundSec));return!(0,o.isErrorOper)(e)&&(s.cond2(e,r)>=0?g:d)}if(29===u.daysPerMonth(2,v,l.dateCompatibility)){const e=u.toNum(l,(0,a.dateTime)(h,2,29,0,0,0,0,0,a.Rounding.RoundSec));return!(0,o.isErrorOper)(e)&&(s.cond2(e,n)<=0?g:d)}return d}let y=0;for(let e=h;e<=v;e+=1)29===u.daysPerMonth(2,e,l.dateCompatibility)?y+=366:y+=365;const C=s.fromNumber(v-h+1);return(0,i.assertNumber)(s.div(s.fromNumber(y),C));case O.Basis30360:case O.BasisActual360:case O.BasisE30360:return c;case O.BasisActual365:return d;default:return c}}(e,u,l,c);return!1===m?n.numErrorOper:d.div(g,m)}},89745:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.gestep=t.delta=void 0;const n=r(88435),a=r(92158);function i(e,t){const[r,i]=t,o=void 0===i||(0,a.isMissingOper)(i)?e.mathpack.zero:(0,n.chkNumOper)(e,i);if((0,a.isErrorOper)(o))return o;const s=(0,n.chkNumOper)(e,r);return(0,a.isErrorOper)(s)?s:[s,o]}t.delta=function(e,t){const r=i(e,t);if(!Array.isArray(r))return r;const[n,a]=r,o=e.mathpack;return 0===o.cond2(n,a)?o.one:o.zero},t.gestep=function(e,t){const r=i(e,t);if(!Array.isArray(r))return r;const[n,a]=r,o=e.mathpack;return o.cond2(n,a)>=0?o.one:o.zero}},57837:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getWorksheetFunc=void 0;const n=r(74643),a=n.__importStar(r(46478)),i=n.__importStar(r(3387)),o=n.__importStar(r(89745)),s=n.__importStar(r(76066)),u=n.__importStar(r(17569)),l=n.__importStar(r(657)),c=n.__importStar(r(32058)),d=n.__importStar(r(46866)),g=n.__importStar(r(7449)),m=n.__importStar(r(34343)),h=n.__importStar(r(60747)),p=n.__importStar(r(71251)),f=n.__importStar(r(95771)),S=n.__importStar(r(60383)),v=n.__importStar(r(93440)),F=n.__importStar(r(39714)),y=n.__importStar(r(86075)),C=r(3825),A=r(59242),E={};E[A.WorksheetFuncId.SUM]=a.sum,E[A.WorksheetFuncId.PRODUCT]=a.product,E[A.WorksheetFuncId.AVERAGE]=a.average,E[A.WorksheetFuncId.COUNTBLANK]=a.countblank,E[A.WorksheetFuncId.MAX]=a.max,E[A.WorksheetFuncId.MIN]=a.min,E[A.WorksheetFuncId.AND]=a.and,E[A.WorksheetFuncId.COUNTA]=a.counta,E[A.WorksheetFuncId.OR]=a.or,E[A.WorksheetFuncId.CONCAT]=a.concat,E[A.WorksheetFuncId.AVERAGEIF]=a.averageif,E[A.WorksheetFuncId.AVERAGEIFS]=a.averageifs,E[A.WorksheetFuncId.COUNT]=a.count,E[A.WorksheetFuncId.COUNTIF]=a.countif,E[A.WorksheetFuncId.COUNTIFS]=a.countifs,E[A.WorksheetFuncId.MEDIAN]=a.median,E[A.WorksheetFuncId.SUMSQ]=a.sumsq,E[A.WorksheetFuncId.SUMIF]=a.sumif,E[A.WorksheetFuncId.SUMIFS]=a.sumifs,E[A.WorksheetFuncId.LARGE]=a.large,E[A.WorksheetFuncId.SMALL]=a.small,E[A.WorksheetFuncId.RANK]=a.rank,E[A.WorksheetFuncId.RANK_EQ]=a.rank,E[A.WorksheetFuncId.RANK_AVG]=a.rank_avg,E[A.WorksheetFuncId.PERCENTILE]=a.percentile,E[A.WorksheetFuncId.PERCENTILE_INC]=a.percentile,E[A.WorksheetFuncId.PERCENTILE_EXC]=a.percentile_exc,E[A.WorksheetFuncId.QUARTILE]=a.quartile,E[A.WorksheetFuncId.QUARTILE_INC]=a.quartile,E[A.WorksheetFuncId.QUARTILE_EXC]=a.quartile_exc,E[A.WorksheetFuncId.TRIMMEAN]=a.trimmean,E[A.WorksheetFuncId.AVERAGEA]=a.averagea,E[A.WorksheetFuncId.MAXA]=a.maxa,E[A.WorksheetFuncId.MINA]=a.mina,E[A.WorksheetFuncId.MAXIFS]=a.maxifs,E[A.WorksheetFuncId.MINIFS]=a.minifs,E[A.WorksheetFuncId.XOR]=a.xor,E[A.WorksheetFuncId.AGGREGATE]=a.aggregate,E[A.WorksheetFuncId.SUBTOTAL]=a.subtotal,E[A.WorksheetFuncId.VAR]=a.var_,E[A.WorksheetFuncId.VAR_S]=a.var_,E[A.WorksheetFuncId.VARP]=a.varp,E[A.WorksheetFuncId.VAR_P]=a.varp,E[A.WorksheetFuncId.STDEV]=a.stdev,E[A.WorksheetFuncId.STDEV_S]=a.stdev,E[A.WorksheetFuncId.STDEVP]=a.stdevp,E[A.WorksheetFuncId.STDEV_P]=a.stdevp,E[A.WorksheetFuncId.VARA]=a.vara,E[A.WorksheetFuncId.VARPA]=a.varpa,E[A.WorksheetFuncId.STDEVA]=a.stdeva,E[A.WorksheetFuncId.STDEVPA]=a.stdevpa,E[A.WorksheetFuncId.AVEDEV]=a.avedev,E[A.WorksheetFuncId.DEVSQ]=a.devsq,E[A.WorksheetFuncId.MODE]=a.mode,E[A.WorksheetFuncId.MODE_SNGL]=a.mode,E[A.WorksheetFuncId.MODE_MULT]=a.mode_mult,E[A.WorksheetFuncId.TEXTJOIN]=a.textjoin,E[A.WorksheetFuncId.SUMPRODUCT]=a.sumproduct,E[A.WorksheetFuncId.GEOMEAN]=a.geomean,E[A.WorksheetFuncId.HARMEAN]=a.harmean,E[A.WorksheetFuncId.YEAR]=i.year,E[A.WorksheetFuncId.MONTH]=i.month,E[A.WorksheetFuncId.DAY]=i.day,E[A.WorksheetFuncId.HOUR]=i.hour,E[A.WorksheetFuncId.MINUTE]=i.minute,E[A.WorksheetFuncId.SECOND]=i.second,E[A.WorksheetFuncId.WEEKNUM]=i.weeknum,E[A.WorksheetFuncId.ISOWEEKNUM]=i.isoweeknum,E[A.WorksheetFuncId.WEEKDAY]=i.weekday,E[A.WorksheetFuncId.DATE]=i.date,E[A.WorksheetFuncId.TIME]=i.time,E[A.WorksheetFuncId.DAYS360]=i.days360,E[A.WorksheetFuncId.DAYS]=i.days,E[A.WorksheetFuncId.DATEDIF]=i.datedif,E[A.WorksheetFuncId.WORKDAY]=i.workday,E[A.WorksheetFuncId.WORKDAY_INTL]=i.workday_intl,E[A.WorksheetFuncId.EDATE]=i.edate,E[A.WorksheetFuncId.EOMONTH]=i.eomonth,E[A.WorksheetFuncId.NETWORKDAYS]=i.networkdays,E[A.WorksheetFuncId.NETWORKDAYS_INTL]=i.networkdays_intl,E[A.WorksheetFuncId.YEARFRAC]=i.yearFrac,E[A.WorksheetFuncId.DELTA]=o.delta,E[A.WorksheetFuncId.GESTEP]=o.gestep,E[A.WorksheetFuncId.NA]=s.na,E[A.WorksheetFuncId.T]=s.t_,E[A.WorksheetFuncId.N]=s.n_,E[A.WorksheetFuncId.TYPE]=s.type,E[A.WorksheetFuncId.ERROR_TYPE]=s.error_type,E[A.WorksheetFuncId.INFO]=s.info,E[A.WorksheetFuncId.IF]=l.if_,E[A.WorksheetFuncId.IFS]=l.ifs,E[A.WorksheetFuncId.SWITCH]=l.switch_,E[A.WorksheetFuncId.TRUE]=l.true_,E[A.WorksheetFuncId.FALSE]=l.false_,E[A.WorksheetFuncId.NOT]=l.not,E[A.WorksheetFuncId.CHOOSE]=l.choose,E[A.WorksheetFuncId.INDEX]=c.index,E[A.WorksheetFuncId.MATCH]=c.match,E[A.WorksheetFuncId.LOOKUP]=c.lookup,E[A.WorksheetFuncId.HLOOKUP]=c.hlookup,E[A.WorksheetFuncId.VLOOKUP]=c.vlookup,E[A.WorksheetFuncId.ABS]=d.abs,E[A.WorksheetFuncId.CEILING]=d.ceiling,E[A.WorksheetFuncId.ECMA_CEILING]=d.ceiling,E[A.WorksheetFuncId.DEGREES]=d.degrees,E[A.WorksheetFuncId.FLOOR]=d.floor,E[A.WorksheetFuncId.RADIANS]=d.radians,E[A.WorksheetFuncId.ROUND]=d.round,E[A.WorksheetFuncId.ROUNDUP]=d.roundup,E[A.WorksheetFuncId.ROUNDDOWN]=d.rounddown,E[A.WorksheetFuncId.EVEN]=d.even,E[A.WorksheetFuncId.SIGN]=d.sign,E[A.WorksheetFuncId.PI]=d.pi,E[A.WorksheetFuncId.SQRT]=d.sqrt,E[A.WorksheetFuncId.EXP]=d.exp,E[A.WorksheetFuncId.POWER]=d.power,E[A.WorksheetFuncId.LN]=d.ln,E[A.WorksheetFuncId.LOG10]=d.log10,E[A.WorksheetFuncId.LOG]=d.log,E[A.WorksheetFuncId.SIN]=d.sin,E[A.WorksheetFuncId.COS]=d.cos,E[A.WorksheetFuncId.TAN]=d.tan,E[A.WorksheetFuncId.ASIN]=d.asin,E[A.WorksheetFuncId.ACOS]=d.acos,E[A.WorksheetFuncId.ATAN]=d.atan,E[A.WorksheetFuncId.ATAN2]=d.atan2,E[A.WorksheetFuncId.FACT]=d.fact,E[A.WorksheetFuncId.SQRTPI]=d.sqrtpi,E[A.WorksheetFuncId.FACTDOUBLE]=d.factdouble,E[A.WorksheetFuncId.INT]=d.int,E[A.WorksheetFuncId.TRUNC]=d.trunc,E[A.WorksheetFuncId.ODD]=d.odd,E[A.WorksheetFuncId.MROUND]=d.mround,E[A.WorksheetFuncId.QUOTIENT]=d.quotient,E[A.WorksheetFuncId.FLOOR_MATH]=d.floor_math,E[A.WorksheetFuncId.FLOOR_PRECISE]=d.floor_precise,E[A.WorksheetFuncId.CEILING_MATH]=d.ceiling_math,E[A.WorksheetFuncId.CEILING_PRECISE]=d.ceiling_precise,E[A.WorksheetFuncId.ISO_CEILING]=d.ceiling_precise,E[A.WorksheetFuncId.MOD]=d.mod,E[A.WorksheetFuncId.TEXT]=g.text,E[A.WorksheetFuncId.FIXED]=g.fixed,E[A.WorksheetFuncId.DOLLAR]=g.dollar,E[A.WorksheetFuncId.VALUE]=g.value,E[A.WorksheetFuncId.DATEVALUE]=g.datevalue,E[A.WorksheetFuncId.TIMEVALUE]=g.timevalue,E[A.WorksheetFuncId.NUMBERVALUE]=g.numbervalue,E[A.WorksheetFuncId.ARRAYTOTEXT]=g.arraytotext,E[A.WorksheetFuncId.VALUETOTEXT]=g.valuetotext,E[A.WorksheetFuncId.ISERROR]=m.iserror,E[A.WorksheetFuncId.ISERR]=m.iserr,E[A.WorksheetFuncId.ISBLANK]=m.isblank,E[A.WorksheetFuncId.ISLOGICAL]=m.islogical,E[A.WorksheetFuncId.ISNA]=m.isna,E[A.WorksheetFuncId.ISNONTEXT]=m.isnontext,E[A.WorksheetFuncId.ISTEXT]=m.istext,E[A.WorksheetFuncId.ISNUMBER]=m.isnumber,E[A.WorksheetFuncId.ISREF]=m.isref,E[A.WorksheetFuncId.ISEVEN]=m.iseven,E[A.WorksheetFuncId.ISODD]=m.isodd,E[A.WorksheetFuncId.ISFORMULA]=m.isformula,E[A.WorksheetFuncId.FORMULATEXT]=m.formulatext,E[A.WorksheetFuncId.ROWS]=h.rows,E[A.WorksheetFuncId.COLUMNS]=h.columns,E[A.WorksheetFuncId.AREAS]=h.areas,E[A.WorksheetFuncId.SHEETS]=h.sheets,E[A.WorksheetFuncId.ROW]=h.row,E[A.WorksheetFuncId.COLUMN]=h.column,E[A.WorksheetFuncId.SHEET]=h.sheet,E[A.WorksheetFuncId.OFFSET]=h.offset,E[A.WorksheetFuncId.TRANSPOSE]=h.transpose,E[A.WorksheetFuncId.SINGLE]=h.single,E[A.WorksheetFuncId.ADDRESS]=f.address,E[A.WorksheetFuncId.INDIRECT]=f.indirect,E[A.WorksheetFuncId.TAKE]=f.take,E[A.WorksheetFuncId.DROP]=f.drop,E[A.WorksheetFuncId.SEQUENCE]=f.sequence,E[A.WorksheetFuncId.HSTACK]=f.hstack,E[A.WorksheetFuncId.VSTACK]=f.vstack,E[A.WorksheetFuncId.CHOOSECOLS]=f.choosecols,E[A.WorksheetFuncId.CHOOSEROWS]=f.chooserows,E[A.WorksheetFuncId.TOCOL]=f.tocol,E[A.WorksheetFuncId.TOROW]=f.torow,E[A.WorksheetFuncId.EXPAND]=f.expand,E[A.WorksheetFuncId.WRAPCOLS]=f.wrapcols,E[A.WorksheetFuncId.WRAPROWS]=f.wraprows,E[A.WorksheetFuncId.FILTER]=y.filter,E[A.WorksheetFuncId.SORT]=y.sort,E[A.WorksheetFuncId.SORTBY]=y.sortby,E[A.WorksheetFuncId.UNIQUE]=y.unique,E[A.WorksheetFuncId.LEFT]=S.left,E[A.WorksheetFuncId.RIGHT]=S.right,E[A.WorksheetFuncId.MID]=S.mid,E[A.WorksheetFuncId.LEN]=S.len,E[A.WorksheetFuncId.CONCATENATE]=S.concatenate,E[A.WorksheetFuncId.EXACT]=S.exact,E[A.WorksheetFuncId.REPT]=S.rept,E[A.WorksheetFuncId.TRIM]=S.trim,E[A.WorksheetFuncId.CLEAN]=S.clean,E[A.WorksheetFuncId.CHAR]=S.char,E[A.WorksheetFuncId.UNICHAR]=S.unichar,E[A.WorksheetFuncId.CODE]=S.code,E[A.WorksheetFuncId.UNICODE]=S.unicode,E[A.WorksheetFuncId.LOWER]=S.lower,E[A.WorksheetFuncId.UPPER]=S.upper,E[A.WorksheetFuncId.PROPER]=S.proper,E[A.WorksheetFuncId.FIND]=S.find,E[A.WorksheetFuncId.REPLACE]=S.replace,E[A.WorksheetFuncId.SEARCH]=S.search,E[A.WorksheetFuncId.SUBSTITUTE]=S.substitute,E[A.WorksheetFuncId.TEXTBEFORE]=S.textBefore,E[A.WorksheetFuncId.TEXTAFTER]=S.textAfter,E[A.WorksheetFuncId.TEXTSPLIT]=S.textSplit,E[A.WorksheetFuncId.RAND]=v.rand,E[A.WorksheetFuncId.RANDBETWEEN]=v.randbetween,E[A.WorksheetFuncId.NOW]=v.now,E[A.WorksheetFuncId.TODAY]=v.today,E[A.WorksheetFuncId.RANDARRAY]=v.randarray,E[A.WorksheetFuncId.HYPERLINK]=F.hyperlink,E[A.WorksheetFuncId.FIELDVALUE]=p.fieldvalue,E[A.WorksheetFuncId._FV]=p.fieldvalue,E[A.WorksheetFuncId.MAKEARRAY]=u.makearray,E[A.WorksheetFuncId.ISOMITTED]=m.isomitted,E[A.WorksheetFuncId.MAP]=u.map,E[A.WorksheetFuncId.BYROW]=u.byrow,E[A.WorksheetFuncId.BYCOL]=u.bycol,E[A.WorksheetFuncId.REDUCE]=u.reduce,E[A.WorksheetFuncId.SCAN]=u.scan,E[A.WorksheetFuncId.XLOOKUP]=c.xlookup,E[A.WorksheetFuncId.XMATCH]=c.xmatch;let b=!1;t.getWorksheetFunc=function(e){return b||(b=!0,(0,C.isFeatureEnabled)(C.FeatureName.CalcRecordFunctions)&&(E[A.WorksheetFuncId.RECORD]=p.record),(0,C.isFeatureEnabled)(C.FeatureName.CalcNestedRecordFunction)&&(E[A.WorksheetFuncId.NESTEDRECORD]=p.record),(0,C.isFeatureEnabled)(C.FeatureName.CalcLambdaBasicFunctions)&&(E[A.WorksheetFuncId.APPLY]=u.apply,E[A.WorksheetFuncId.ISLAMBDA]=m.islambda)),E[e]}},76066:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.info=t.error_type=t.type=t.n_=t.t_=t.na=void 0;const n=r(70633),a=r(98677),i=r(92158),o=r(18612),s=r(79673),u=r(36094),l=r(31663);function c(e,t){if((0,i.isRangeOper)(t)){if((0,i.isSheetIndex)(t.sheets)){const r=(0,n.rangeSeqOper)(t.sheets,[(0,i.gridRangeAnchor)(t.ranges[0])]);return e.dereferenceOper(r,a.readOperType)}return n.valueErrorOper}return t}t.na=function(e,t){return n.naErrorOper},t.t_=function(e,[t]){const r=c(e,t);return(0,i.isStringOper)(r)||(0,i.isErrorOper)(r)?r:u.emptyStringOper},t.n_=function(e,[t]){const r=c(e,t);if((0,i.isNumberOper)(r)||(0,i.isErrorOper)(r))return r;const n=e.mathpack;return(0,i.isBooleanOper)(r)&&r.value?n.one:n.zero},t.type=function(e,[t]){const r=e.mathpack;switch(t.kind){case s.OperKind.Number:return r.fromNumber(1);case s.OperKind.String:return r.fromNumber(2);case s.OperKind.Boolean:return r.fromNumber(4);case s.OperKind.Error:return r.fromNumber(16);case s.OperKind.Array:return r.fromNumber(64);case s.OperKind.Rich:return r.fromNumber(128);default:return(0,o.assertNever)("calc.funcs.type",t)}},t.error_type=function(e,[t]){return(0,i.isErrorOper)(t)?(t.type>n.ErrorType.CALC&&(0,l.throwEvaluationError)((0,i.notImplemented)(["ERROR.TYPE for "+String(t.type)])),e.mathpack.fromNumber(t.type)):n.naErrorOper},t.info=function(e,t){return n.valueErrorOper}},17569:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scan=t.reduce=t.bycol=t.byrow=t.map=t.makearray=t.apply=void 0;const n=r(70633),a=r(7625),i=r(98677),o=r(98677),s=r(31663),u=r(92158),l=r(59242),c=r(88435),d=r(79673),g=r(71766),m=r(18612),h=r(43376),p=r(19552);function f(e,t,r){const i=function(e,t){return(0,u.isRangeOper)(t)&&(0,u.isSheetIndex)(t.sheets)&&1===t.ranges.length&&(0,u.isGridCell)(t.ranges[0])?e.dereferenceOper(t,d.SignatureType.All&~d.OperKind.Range):t}(e,t);return i instanceof a.LambdaOper&&i.checkArity(r)?i:n.valueErrorOper}function S(e,t){return r=>{let a=r;if((0,u.isRangeOper)(a)){if(!(0,u.isSheetIndex)(a.sheets)||1!==a.ranges.length||!(0,u.isGridCell)(a.ranges[0]))return(0,i.earlyReturn)((0,h.success)(n.calcErrorOper));a=t.dereferenceOper(a,d.SignatureType.All&~d.OperKind.Range),(0,m.assertTrue)("calc.funcs.coerceLambdaRvToArrayElt",!(0,u.isRangeOper)(a))}return(0,u.isArrayOper)(a)?1!==a.rows||1!==a.cols?(0,i.earlyReturn)((0,h.success)(n.calcErrorOper)):a.opers[0][0]:((0,u.isMissingOper)(a)&&(0,s.throwEvaluationError)((0,u.notImplemented)([`${(0,p.englishWorksheetFuncIdToName)(e)}: MissingOper in result`])),a)}}function v(e,t,r,a,i){const s=f(e,a,r.length);if((0,u.isErrorOper)(s))return s;const l=[];for(const e of r){if(!(0,u.isArrayOper)(e)&&!(0,u.isRangeOper)(e))return n.valueErrorOper;const t=(0,c.rangeOrArrayToVal)(e,n.valueErrorOper);if((0,u.isErrorOper)(t))return t;l.push(i((0,c.makeSlicer)(t)))}const d=l.map((e=>e.rows)).reduce(g.fastMin),m=l.map((e=>e.rows)).reduce(g.fastMax),h=l.map((e=>e.cols)).reduce(g.fastMin),p=l.map((e=>e.cols)).reduce(g.fastMax);return(0,c.validateArraySize)(m,p),(0,o.machineCall)(new o.ArrayMachine(e,m,p,((t,r)=>t>=d||r>=h?n.naErrorOper:e.applyLambda(s,l.map((e=>e.slice(t,1,r,1))))),S(t,e)))}function F(e,t,r,a,s){const d=(0,c.rangeOrArrayToVal)(a,n.valueErrorOper);if((0,u.isErrorOper)(d))return d;const g=(0,c.makeSlicer)(d),h=f(e,s,2);if((0,u.isErrorOper)(h))return h;const p=!(0,u.isMissingOper)(r);let v,F=p?r:void 0,y=!0;if(t===l.WorksheetFuncId.REDUCE)v=e=>(F=e,n.blankOper);else{const r=S(t,e);v=e=>{const t=r(e);return t.kind===i.EarlyReturnKind.EarlyReturn||(F=t),t}}const C=(0,o.machineCall)(new o.ArrayMachine(e,g.rows,g.cols,((t,r)=>{const n=y;return y=!1,n&&!p?g.slice(t,1,r,1):((0,m.assertTrue)("calc.funcs.scanReduce",void 0!==F),e.applyLambda(h,[F,g.slice(t,1,r,1)]))}),v));return t===l.WorksheetFuncId.REDUCE?(0,o.machineCall)(new o.ThenMachine(e,(()=>C),(()=>((0,m.assertTrue)("calc.funcs.scanReduce",void 0!==F),F)))):C}t.apply=function(e,[t,...r]){const n=f(e,t,r.length);return(0,u.isErrorOper)(n)?n:e.applyLambda(n,r)},t.makearray=function(e,[t,r,a]){const i=f(e,a,2);if((0,u.isErrorOper)(i))return i;const s=e.mathpack,d=(0,u.isMissingOper)(t)?1:s.fix(t),g=(0,u.isMissingOper)(r)?1:s.fix(r);return d<1||g<1?n.valueErrorOper:((0,c.validateArraySize)(d,g),(0,o.machineCall)(new o.ArrayMachine(e,d,g,((t,r)=>{const n=e.mathpack,a=[n.fromNumber(t+1),n.fromNumber(r+1)];return e.applyLambda(i,a)}),S(l.WorksheetFuncId.MAKEARRAY,e))))},t.map=function(e,t){const r=t.slice(0,t.length-1),n=t[t.length-1];return v(e,l.WorksheetFuncId.MAP,r,n,g.identity)},t.byrow=function(e,t){const r=[t[0]],a=t[1];return void 0===a?n.naErrorOper:v(e,l.WorksheetFuncId.BYROW,r,a,(e=>({rows:e.rows,cols:1,slice:(t,r,n,a)=>e.slice(t,r,0,e.cols)})))},t.bycol=function(e,t){const r=[t[0]],a=t[1];return void 0===a?n.naErrorOper:v(e,l.WorksheetFuncId.BYCOL,r,a,(e=>({rows:1,cols:e.cols,slice:(t,r,n,a)=>e.slice(0,e.rows,n,a)})))},t.reduce=function(e,t){const[r,n,a]=t;return F(e,l.WorksheetFuncId.REDUCE,r,n,a)},t.scan=function(e,t){const[r,n,a]=t;return F(e,l.WorksheetFuncId.SCAN,r,n,a)}},657:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.not=t.false_=t.true_=t.switch_=t.ifs=t.choose=t.if_=void 0;const n=r(70633),a=r(18612),i=r(36094),o=r(59242),s=r(92158),u=r(31663),l=r(79673),c=(0,i.makeStrict)((0,o.getWorksheetFuncType)(o.WorksheetFuncId.IFS)),d=(0,i.makeStrict)((0,o.getWorksheetFuncType)(o.WorksheetFuncId.SWITCH));function g(e,t,r,n){const a=n.slice();return e.dereferenceOpers(a,t),(0,i.arrayLift)(e,t,(n=>{const a=[];for(let r=0;r<n.length;r+=1){const i=(0,s.getArgType)(t,r,n.length);a[r]=e.coerceOper(n[r],i)}return r(e,a)}),a)}t.if_=function(e,t){const r=t[0];(0,a.assertTrue)("calc.funcs.if: condition is not a boolean",(0,s.isBooleanOper)(r));const n=t[r.value?1:2];return(0,a.assertTrue)("calc.funcs.if: result is undefined",void 0!==n),n},t.choose=function(e,t){const r=t[0];(0,a.assertTrue)("calc.funcs.choose",(0,s.isNumberOper)(r));const i=e.mathpack.fix(r);return i<1||i>t.length-1?n.valueErrorOper:t[i]},t.ifs=function e(t,r){for(let n=0;n<r.length;n+=2){const i=r[n];if((0,s.isArrayOper)(i)){const a=r.slice(n);return g(t,c,e,a)}if((0,s.isErrorOper)(i))return i;if((0,a.assertTrue)("calc.funcs.ifs",(0,s.isBooleanOper)(i)),i.value)return r[n+1]}return n.naErrorOper},t.switch_=function e(t,r){const i=r[0];if((0,s.isArrayOper)(i))return g(t,d,e,r);if((0,s.isErrorOper)(i))return i;const o=function({mathpack:e,localeInfo:t},r){switch(r.kind){case l.OperKind.Number:return t=>(0,s.isRichOper)(t)?(0,u.throwEvaluationError)((0,s.notImplemented)(["SWITCH with a rich value case"])):(0,s.isNumberOper)(t)&&0===e.compare(r,t);case l.OperKind.String:return e=>(0,s.isRichOper)(e)?(0,u.throwEvaluationError)((0,s.notImplemented)(["SWITCH with a rich value case"])):(0,s.isStringOper)(e)&&0===t.stringCompareCI(r.value,e.value);case l.OperKind.Boolean:return e=>(0,s.isRichOper)(e)?(0,u.throwEvaluationError)((0,s.notImplemented)(["SWITCH with a rich value case"])):(0,s.isBooleanOper)(e)&&r.value===e.value;case l.OperKind.Rich:return(0,u.throwEvaluationError)((0,s.notImplemented)(["SWITCH with a rich value condition"]));default:return(0,a.assertNever)("calc.funcs.makeSwitchComparer",r)}}(t.config,i);for(let n=1;n<r.length-1;n+=2){const a=l.OperKind.Error|l.OperKind.Rich|l.OperKind.Number|l.OperKind.Boolean|l.OperKind.String|l.OperKind.Array,i=t.coerceOper(t.dereferenceOper(r[n],a),a);if((0,s.isArrayOper)(i))return g(t,d,e,r);if((0,s.isErrorOper)(i))return i;if(o(i))return r[n+1]}return r.length%2==0?r[r.length-1]:n.naErrorOper},t.true_=function(e,t){return n.trueOper},t.false_=function(e,t){return n.falseOper},t.not=function(e,[t]){return(0,n.booleanOper)(!t.value)}},32058:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xmatch=t.xlookup=t.makeWildcardComparer=t.vlookup=t.hlookup=t.lookup=t.match=t.linearSearch=t.binarySearch=t.makeLookupComparer=t.index=void 0;const n=r(59242),a=r(70633),i=r(64316),o=r(92158),s=r(18612),u=r(31663),l=r(91282),c=r(11181),d=r(93371),g=r(71766),m=r(79673),h=r(47691);function p(e,[t,r,n,i]){const u=e.mathpack,l=u.sfix(r);if(l<0)return a.valueErrorOper;const d=void 0===n?void 0:u.sfix(n);if(void 0!==d&&d<0)return a.valueErrorOper;const h=void 0===i?0:u.sfix(i)-1;if(h<0)return a.valueErrorOper;let p,f;switch(t.kind){case m.OperKind.Range:if(!(0,o.isSheetIndex)(t.sheets))return a.valueErrorOper;if(h>=t.ranges.length)return a.refErrorOper;const e=t.ranges[h];if(void 0===d)if(1===e.rows)p=0,f=l-1;else{if(1!==e.cols)return a.refErrorOper;p=l-1,f=-1}else p=l-1,f=d-1;if(p>=e.rows||f>=e.cols)return a.refErrorOper;const r=(0,c.gridRange)(e.row+(0,g.fastMax)(p,0),e.col+(0,g.fastMax)(f,0),-1===p?e.rows:1,-1===f?e.cols:1);return(0,a.rangeSeqOper)(t.sheets,[r]);case m.OperKind.Array:return h>0?a.refErrorOper:(void 0===d?1===t.rows?(p=0,f=l-1):(p=l-1,f=-1):(p=l-1,f=d-1),p>=t.rows||f>=t.cols?a.refErrorOper:-1===p&&-1===f?t:-1===p?(0,a.arrayOper)(t.rows,1,t.opers.map((e=>[e[f]]))):-1===f?(0,a.arrayOper)(1,t.cols,[t.opers[p]]):t.opers[p][f]);default:return(0,s.assertNever)("calc.funcs.lookupFuncs: INDEX",t)}}t.index=p;const f=e=>e<0?n.OperatorId.Lt:e>0?n.OperatorId.Gt:n.OperatorId.Eq,S=(e,t,r)=>f(e.cond2(t,r)),v=(e,t)=>f(e-t);function F(e,t,r=!1){const a=!0,{localeInfo:i,mathpack:c}=e.config;let d;switch(t.kind){case m.OperKind.Number:d=e=>({correctType:a,sgnT:S(c,e,t)});break;case m.OperKind.String:if(r){const e=new l.WildExp(i,t.value);d=t=>({correctType:a,sgnT:e.test(t.value)?n.OperatorId.Eq:n.OperatorId.Ne})}else d=e=>({correctType:a,sgnT:f(i.stringCompareCI(e.value,t.value))});break;case m.OperKind.Boolean:d=e=>({correctType:a,sgnT:v(e.value,t.value)});break;case m.OperKind.Rich:return(0,u.throwEvaluationError)((0,o.notImplemented)(["lookup with rich value condition"]));case m.OperKind.Blank:d=()=>({correctType:a,sgnT:n.OperatorId.Eq});break;default:return(0,s.assertNever)("calc.funcs.makeLookupComparer",t)}return e=>{const r=(0,o.isRichOper)(e)?e.getFallback():e;return t.kind!==r.kind?{correctType:!1,sgnT:n.OperatorId.Ne}:d(r)}}function y(e,t,r){let a=!1;const i=r.length-1;let o=Math.floor((0+i)/2),s=0,u=i;const l=F(e,t);for(;;){let e=l(r.get(o)).sgnT;if(e===n.OperatorId.Ne){if(o<u)for(let t=o+1;t<=u;t+=1)if(e=l(r.get(t)).sgnT,e!==n.OperatorId.Ne){o=t;break}e===n.OperatorId.Ne&&(o=Math.floor((s+u)/2),e=n.OperatorId.Gt)}if(e===n.OperatorId.Eq){if(o<i){o+=1,a=!0,s=o,u=o;continue}return o}if(e===n.OperatorId.Lt?s=o+1:u=o-1,!(s<=u)){if(a)o-=1;else if(e===n.OperatorId.Gt&&(o-=1,o>=0)){s=o,u=o;continue}return o}o=Math.floor((s+u)/2)}}function C(e,t,r,a){let i=-1;const o=F(e,t,a===n.OperatorId.Eq);for(let e=0;e<r.length;e+=1){const t=r.get(e),{correctType:s,sgnT:u}=o(t);if(s){if(u===n.OperatorId.Eq)return e;if(u!==n.OperatorId.Ne&&u===a)return i;i=e}e===r.denseLength&&(e=(0,g.fastMax)(e,r.length-2))}return a!==n.OperatorId.Eq?i:r.length}function A(e){switch(e.kind){case m.OperKind.Number:return a.naErrorOper;case m.OperKind.Range:return(0,o.isSheetIndex)(e.sheets)?e.ranges.length>1?a.naErrorOper:e:a.valueErrorOper;case m.OperKind.Array:return e}}function E(e,t){let r;switch(t.kind){case m.OperKind.Number:return t;case i.DerefOperKind.RangeValues:r=t.arrays[0].get(0,0);break;case m.OperKind.Array:r=t.opers[0][0];break;default:return(0,s.assertNever)("calc.funcs.lookupFuncs.getNumFromRef",t)}return r=e.coerceOper(r,m.OperKind.Number),(0,o.isErrorOper)(r)?a.refErrorOper:r}function b(e){switch(e.kind){case m.OperKind.Number:case m.OperKind.Rich:return a.naErrorOper;case m.OperKind.Range:if(!(0,o.isSheetIndex)(e.sheets))return a.valueErrorOper;if(e.ranges.length>1)return a.naErrorOper;const t=e.ranges[0];return 1!==t.rows&&1!==t.cols?a.naErrorOper:e;case m.OperKind.Array:return 1!==e.rows&&1!==e.cols?a.naErrorOper:e}}function R(e){switch(e.kind){case i.DerefOperKind.RangeValues:return e.arrays[0];case m.OperKind.Array:return new d.StrictSparseArray2D(e.rows,e.cols,e.rows,e.cols,e.opers,a.blankOper)}}function T(e,t){switch(t.kind){case m.OperKind.Range:const r=t.sheets,n=t.ranges[0];return new d.NonstrictSparseArray2D(n.rows,n.cols,n.rows,n.cols,((t,i)=>{const o=(0,c.gridCell)(n.row+t,n.col+i),[s]=e.dereferenceAllOpers([(0,a.rangeSeqOper)(r,[o])]);return s.arrays[0].get(0,0)}),(()=>(0,s.assertFalse)("calc.funcs.lookupFuncs: rangeOrArrayOperToLazyArray2D")));case m.OperKind.Array:return new d.StrictSparseArray2D(t.rows,t.cols,t.rows,t.cols,t.opers,a.blankOper)}}function k(e){if((0,o.isRangeOper)(e)){const t=e.ranges[0];return t.cols>t.rows}return e.cols>e.rows}function N(e,[t,r,i,s=a.trueOper],l){const c=A(r);if((0,o.isErrorOper)(c))return c;const g=I(c,l),[h]=e.dereferenceAllOpers([g]),p=(0,d.sparseArray2DTo1D)(R(h),l),f=s.value?y(e,t,p):C(e,t,p,n.OperatorId.Eq);if(f<0||f>=p.length)return a.naErrorOper;const S=function(e,t){switch(t.kind){case m.OperKind.Number:return t;case m.OperKind.Range:if(!(0,o.isSheetIndex)(t.sheets))return a.valueErrorOper;if(t.ranges.length>1)return a.refErrorOper;const r=t.ranges;return e.calcingArray?(0,u.throwEvaluationError)((0,o.notImplemented)(["HLOOKUP/VLOOKUP ref argument 3 in array formula"])):r[0].rows>1||r[0].cols>1?(0,u.throwEvaluationError)((0,o.notImplemented)(["HLOOKUP/VLOOKUP non-singleton ref argument 3"])):t;case m.OperKind.Array:return(0,u.throwEvaluationError)((0,o.notImplemented)(["HLOOKUP/VLOOKUP array argument 3"]))}}(e,i);if((0,o.isErrorOper)(S))return S;const[v]=e.dereferenceAllOpers([S]),F=E(e,v);if((0,o.isErrorOper)(F))return F;const b=e.mathpack.sfix(F)-1,k=T(e,c);return b<0?a.valueErrorOper:b>=(l?k.rows:k.cols)?a.refErrorOper:l?k.get(b,f):k.get(f,b)}function I(e,t){if((0,o.isRangeOper)(e)){const r=e.ranges[0],n=(0,c.gridRange)(r.row,r.col,t?1:r.rows,t?r.cols:1);return(0,a.rangeSeqOper)(e.sheets,[n])}return e}var O,_;function P(e){return e===_.DescendingBinary||e===_.AscendingBinary}function M(e,t,r=a.missingOper,n=a.missingOper){const i=(0,o.isMissingOper)(r)?O.Exact:e.mathpack.sfix(r);if(i<O.Lower||i>O.Wildcard)return a.valueErrorOper;const s=(0,o.isMissingOper)(n)?_.Linear:e.mathpack.sfix(n);if(s<_.DescendingBinary||s>_.AscendingBinary||0===s)return a.valueErrorOper;if(i===O.Wildcard&&P(s))return a.valueErrorOper;const u=A(t);if((0,o.isErrorOper)(u))return u;const[l]=e.dereferenceAllOpers([u]),c=R(l),{rows:g,cols:m}=c;let h;if(1===g)h=!0;else{if(1!==m)return a.valueErrorOper;h=!1}return{kind:void 0,lookupArray:(0,d.sparseArray2DTo1D)(c,h),matchMode:i,searchMode:s,isHorizontal:h}}function D(e,t,r,a,i){return r===n.OperatorId.Gt?t===O.Higher&&(void 0===i||f((0,h.sortOpers)(e,a,i,1,!1))===n.OperatorId.Lt):t===O.Lower&&(void 0===i||f((0,h.sortOpers)(e,a,i,1,!1))===n.OperatorId.Gt)}function w(e,t){const r=new l.WildExp(e.config.localeInfo,t.value);return e=>(0,o.isStringOper)(e)&&r.test(e.value)?n.OperatorId.Eq:n.OperatorId.Ne}function L(e,t,r){return P(t.searchMode)?function(e,{lookupArray:t,matchMode:r,searchMode:a},i){const o=e.config,u=a===_.DescendingBinary;let l,c=0,d=t.length-1;(0,s.assertTrue)("calc.funcs.xBinarySearch",r!==O.Wildcard);let g=!1;for(;d>=c;){const e=Math.floor((d+c)/2),a=(m=t.get(e),f((0,h.sortOpers)(o,m,i,1,!1)));if(a===n.OperatorId.Eq)g=!0,l=e;else if(!g){const t=r===O.Higher&&a===n.OperatorId.Gt,i=r===O.Lower&&a===n.OperatorId.Lt;(t||i)&&(l=e)}u!==(a===n.OperatorId.Lt)?c=e+1:d=e-1}var m;return l}(e,t,r):function(e,{lookupArray:t,matchMode:r,searchMode:a},i){const u=e.config;let l;const c=r===O.Lower||r===O.Higher,d=r===O.Wildcard&&(0,o.isStringOper)(i)?w(e,i):e=>f((0,h.sortOpers)(u,e,i,1,!1)),m=a===_.ReverseLinear?t.length-1:0,p=a===_.ReverseLinear?-1:1;for(let e=m;e>=0&&e<t.length;e+=p){const a=t.get(e),i=d(a);if(i===n.OperatorId.Eq){l=e;break}if(c&&((0,s.assertTrue)("calc.funcs.xLinearSearch",i!==n.OperatorId.Ne),D(u,r,i,a,void 0===l?void 0:t.get(l))&&(l=e)),e>=t.denseLength){const r=t.denseLength,n=t.length-1;e=p>0?(0,g.fastMax)(e,n-1):(0,g.fastMin)(e,r+1)}}return l}(e,t,r)}t.makeLookupComparer=F,t.binarySearch=y,t.linearSearch=C,t.match=function(e,[t,r,i=e.mathpack.one]){const s=e.mathpack,u=function(e){switch(e.kind){case m.OperKind.Number:return e;case m.OperKind.Range:if(!(0,o.isSheetIndex)(e.sheets))return a.valueErrorOper;if(e.ranges.length>1)return a.refErrorOper;const t=e.ranges[0];return 1!==t.rows||1!==t.cols?a.refErrorOper:e}}(i);if((0,o.isErrorOper)(u))return u;const[l]=e.dereferenceAllOpers([u]),c=E(e,l);if((0,o.isErrorOper)(c))return c;const g=b(r);if((0,o.isErrorOper)(g))return g;const[h]=e.dereferenceAllOpers([g]),p=R(h),f=1===p.rows,S=(0,d.sparseArray2DTo1D)(p,f);let v=-1;return v=s.cond(c)>0?y(e,t,S):0===s.cond(c)?C(e,t,S,n.OperatorId.Eq):C(e,t,S,n.OperatorId.Lt),v<0||v>=S.length?a.naErrorOper:e.mathpack.fromNumber(v+1)},t.lookup=function(e,[t,r,n]){const i=A(r);if((0,o.isErrorOper)(i))return i;const s=k(i),u=I(i,s),[l]=e.dereferenceAllOpers([u]),m=(0,d.sparseArray2DTo1D)(R(l),s),h=y(e,t,m);if(h<0)return a.naErrorOper;if(void 0!==n){const t=b(n);if((0,o.isErrorOper)(t))return t;const r=k(t),i=function(e,t,r){if((0,o.isRangeOper)(r)){const n=r.ranges[0],i=(0,c.gridRange)(n.row,n.col,(0,g.fastMin)(t?1:e,c.sheetRows-n.row),(0,g.fastMin)(t?e:1,c.sheetCols-n.col));return(0,a.range3DOper)(r.sheets,i)}return r}(m.length,r,t),s=(0,d.sparseArray2DTo1D)(T(e,i),r);return h>=s.length?(0,o.isArrayOper)(t)?a.naErrorOper:a.blankOper:s.get(h)}const p=T(e,i);return s?p.get(p.rows-1,h):p.get(h,p.cols-1)},t.hlookup=function(e,t){return N(e,t,!0)},t.vlookup=function(e,t){return N(e,t,!1)},function(e){e[e.Lower=-1]="Lower",e[e.Exact=0]="Exact",e[e.Higher=1]="Higher",e[e.Wildcard=2]="Wildcard"}(O||(O={})),function(e){e[e.DescendingBinary=-2]="DescendingBinary",e[e.ReverseLinear=-1]="ReverseLinear",e[e.Linear=1]="Linear",e[e.AscendingBinary=2]="AscendingBinary"}(_||(_={})),t.makeWildcardComparer=w,t.xlookup=function(e,t){const[r,n,i,u=a.missingOper,l,c]=t,d=M(e,n,l,c);if(void 0!==d.kind)return d;const g=function(e){switch(e.kind){case m.OperKind.Range:return(0,s.assertTrue)("calc.funcs.xlookup",(0,o.isSheetIndex)(e.sheets)),e.ranges.length>1?a.naErrorOper:[e.ranges[0].rows,e.ranges[0].cols];case m.OperKind.Array:return[e.rows,e.cols]}}(i);if(!Array.isArray(g))return g;const[h,f]=g,S=d.lookupArray.length,v=S===h&&(1===h||!d.isHorizontal),F=S===f&&(1===f||d.isHorizontal);if(!v&&!F)return a.valueErrorOper;const y=L(e,d,r);if(void 0===y)return(0,o.isMissingOper)(u)?a.naErrorOper:u;const C=e.mathpack;return p(e,v?[i,C.fromNumber(y+1),1===f?C.one:C.zero]:[i,1===h?C.one:C.zero,C.fromNumber(y+1)])},t.xmatch=function(e,t){const[r,n,i,o]=t,s=M(e,n,i,o);if(void 0!==s.kind)return s;const u=L(e,s,r);return void 0===u?a.naErrorOper:e.mathpack.fromNumber(u+1)}},46866:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sqrtpi=t.factdouble=t.fact=t.quotient=t.mod=t.radians=t.degrees=t.sign=t.abs=t.odd=t.even=t.floor_precise=t.floor_math=t.floor=t.ceiling_precise=t.ceiling_math=t.ceiling=t.mround=t.rounddown=t.roundup=t.trunc=t.round=t.int=t.atan2=t.atan=t.acos=t.asin=t.tan=t.cos=t.sin=t.log=t.log10=t.ln=t.power=t.exp=t.sqrt=t.pi=void 0;const n=r(88435),a=r(70633),i=r(92158);function o(e,t,r){const n=e.cond(t),o=e.cond(r);if(n>0&&o<0)return a.numErrorOper;if(0===n||0===o)return e.zero;const s=e.div(t,r);return(0,i.isErrorOper)(s)?s:e.mul(e.ceil(e.viewRound(s)),r)}function s(e,t,r){const n=e.cond(t),o=e.cond(r);if(n>0&&o<0)return a.numErrorOper;if(0===n&&0===o)return t;const s=e.div(t,r);return(0,i.isErrorOper)(s)?s:e.mul(e.floor(e.viewRound(s)),r)}function u(e,t,[r]){const a=t.mathpack;if(a.cond(r)>=0){const t=a.ceil(r);return 0===a.cond2((0,n.assertNumber)((0,n.numMod)(a,t,a.fromNumber(2))),a.one)===e?a.add(t,a.one):t}const i=a.floor(r);return 0===a.cond2((0,n.assertNumber)((0,n.numMod)(a,i,a.fromNumber(2))),a.one)===e?a.sub(i,a.one):i}t.pi=function(e,t){return e.mathpack.pi},t.sqrt=(0,n.wrap1)((e=>e.mathpack.sqrt)),t.exp=(0,n.wrap1)((e=>e.mathpack.exp)),t.power=(0,n.wrap2)((e=>e.mathpack.power)),t.ln=(0,n.wrap1)((e=>e.mathpack.ln)),t.log10=(0,n.wrap1)((e=>e.mathpack.log)),t.log=function(e,[t,r]){const n=e.mathpack;if(void 0===r)return n.log(t);const a=n.ln(t);if((0,i.isErrorOper)(a))return a;const o=n.ln(r);return(0,i.isErrorOper)(o)?o:n.div(a,o)},t.sin=(0,n.wrap1)((e=>e.mathpack.sin)),t.cos=(0,n.wrap1)((e=>e.mathpack.cos)),t.tan=(0,n.wrap1)((e=>e.mathpack.tan)),t.asin=(0,n.wrap1)((e=>e.mathpack.asin)),t.acos=(0,n.wrap1)((e=>e.mathpack.acos)),t.atan=(0,n.wrap1)((e=>e.mathpack.atan)),t.atan2=(0,n.wrap2)((e=>e.mathpack.atan2)),t.int=function(e,t){let[r]=t;const n=e.mathpack;return n.cond2(n.abs(r),n.fromNumber(1e15))<0&&(r=n.viewRound(r)),n.floor(r)},t.round=(0,n.wrap2)((e=>e.mathpack.round)),t.trunc=function(e,[t,r=e.mathpack.zero]){return e.mathpack.roundDown(t,r)},t.roundup=(0,n.wrap2)((e=>e.mathpack.roundUp)),t.rounddown=(0,n.wrap2)((e=>e.mathpack.roundDown)),t.mround=function(e,[t,r]){const o=(0,n.chkNumOper)(e,t);if((0,i.isErrorOper)(o))return o;const s=(0,n.chkNumOper)(e,r);if((0,i.isErrorOper)(s))return s;const u=e.mathpack;if(0===u.cond(s))return u.zero;if(0!==u.cond(o)&&u.cond(o)<0!=u.cond(s)<0)return a.numErrorOper;const l=u.div(o,s);if((0,i.isErrorOper)(l))return a.numErrorOper;const c=u.floor(l),d=(0,n.assertNumber)(u.sub(l,c)),g=u.fromNumber(.5-5e-15);if(u.cond2(d,g)<0)return u.mul(c,s);const m=u.add(c,u.one);return(0,i.isErrorOper)(m)?m:u.mul(m,s)},t.ceiling=function(e,[t,r]){return o(e.mathpack,t,r)},t.ceiling_math=function(e,[t,r,n]){const a=e.mathpack;let s=void 0===r||(0,i.isMissingOper)(r)?a.one:a.abs(r);const u=void 0===n||(0,i.isMissingOper)(n)?a.zero:n;return 0!==a.cond(u)&&a.cond(t)<0&&(s=a.neg(s)),0===a.cond(s)?a.zero:o(a,t,s)},t.ceiling_precise=function(e,[t,r]){const n=e.mathpack,a=void 0===r||(0,i.isMissingOper)(r)?n.one:n.abs(r);return 0===n.cond(a)?n.zero:o(n,t,a)},t.floor=function(e,[t,r]){return s(e.mathpack,t,r)},t.floor_math=function(e,[t,r,n]){const a=e.mathpack;let o=void 0===r||(0,i.isMissingOper)(r)?a.one:a.abs(r);const u=void 0===n||(0,i.isMissingOper)(n)?a.zero:n;return 0!==a.cond(u)&&a.cond(t)<0&&(o=a.neg(o)),0===a.cond(o)?a.zero:s(a,t,o)},t.floor_precise=function(e,[t,r]){const n=e.mathpack,a=void 0===r||(0,i.isMissingOper)(r)?n.one:n.abs(r);return 0===n.cond(a)?n.zero:s(n,t,a)},t.even=u.bind(void 0,!0),t.odd=u.bind(void 0,!1),t.abs=(0,n.wrap1)((e=>e.mathpack.abs)),t.sign=function(e,[t]){const r=e.mathpack;return r.fromNumber(r.cond(t))},t.degrees=function(e,[t]){const r=e.mathpack,a=(0,n.assertNumber)(r.div(r.fromNumber(180),r.pi));return r.mul(t,a)},t.radians=function(e,[t]){const r=e.mathpack,a=(0,n.assertNumber)(r.div(r.pi,r.fromNumber(180)));return r.mul(t,a)},t.mod=(0,n.wrap2)((e=>e.mathpack.mod)),t.quotient=function(e,[t,r]){const o=(0,n.chkNumOper)(e,t);if((0,i.isErrorOper)(o))return o;const s=(0,n.chkNumOper)(e,r);if((0,i.isErrorOper)(s))return s;const u=e.mathpack;if(0===u.cond(s))return a.div0ErrorOper;const l=u.div(o,s);return(0,i.isErrorOper)(l)?a.numErrorOper:u.cond(l)>0?u.floor(l):u.ceil(l)},t.fact=function(e,[t]){const r=e.mathpack,n=r.sfix(t);if(r.cond(t)<0||n>170)return a.numErrorOper;let o=r.one;for(let e=n;e>0;e-=1){if((0,i.isErrorOper)(o))return o;o=r.mul(r.fromNumber(e),o)}return o},t.factdouble=function(e,[t]){const r=(0,n.chkNumOper)(e,t);if((0,i.isErrorOper)(r))return r;const o=e.mathpack,s=o.floor(r);if(o.cond2(s,o.fromNumber(-1))<0||o.cond2(s,o.fromNumber(300))>0)return a.numErrorOper;let u=o.one;for(let e=o.toNumber(s);e>1;e-=2){if((0,i.isErrorOper)(u))return u;u=o.mul(o.fromNumber(e),u)}return u},t.sqrtpi=function(e,[t]){const r=(0,n.chkNumOper)(e,t);if((0,i.isErrorOper)(r))return r;const o=e.mathpack;if(o.cond(r)<0)return a.numErrorOper;const s=o.mul(o.pi,r);return(0,i.isErrorOper)(s)?s:o.sqrt(s)}},16427:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nextFuncs=void 0,t.nextFuncs={v1:{}}},7449:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.valuetotext=t.arraytotext=t.numbervalue=t.isWhitespace=t.timevalue=t.datevalue=t.value=t.dollar=t.fixed=t.text=void 0;const n=r(74643),a=r(70633),i=r(18612),o=r(46866),s=r(66269),u=n.__importStar(r(33372)),l=r(92158),c=r(60443),d=r(79673),g=r(75811),m=r(31663),h=r(23262),p=r(51465),{codePointSpace:f,codePointTab:S,codePointLF:v,codePointCR:F}=u;function y(e,t,r,n){if(void 0===r||(0,l.isMissingOper)(r))return{formatValue:t,formatDecimals:n??2};const s=e.config.mathpack;if(s.cond(r)<0){const n=0,a=(0,o.round)(e,[t,r]);return(0,i.assertTrue)("calc.funcs.fixedDollarRound",(0,l.isNumberOper)(a)||(0,l.isErrorOper)(a)),{formatValue:a,formatDecimals:n}}const u=s.sfix(r);return u<0||u>127?{formatValue:a.valueErrorOper,formatDecimals:0}:{formatValue:t,formatDecimals:u}}function C(e){let t=0;for(;t<e.length&&e.charCodeAt(t)===f;)t+=1;return e.substring(t)}function A(e,t){return(0,l.isStringOper)(t)?t.value.length>255?a.valueErrorOper:e.parseDate(C(t.value))??a.valueErrorOper:a.valueErrorOper}function E(e){return e===f||e===S||e===F||e===v}var b;function R(e,t,r){const n=void 0===r?b.Concise:e.mathpack.sfix(r);return n!==b.Concise&&n!==b.Strict?a.valueErrorOper:T(e,t,n)}function T(e,t,r){const n=[],o=e.config.localeInfo;switch(t.kind){case d.OperKind.Array:{for(let e=0;e<t.rows;++e)for(let r=0;r<t.cols;++r){const n=t.opers[e][r];if((0,l.isArrayOper)(n)||(0,l.isRangeOper)(n))return a.calcErrorOper}const i=r===b.Concise?o.listSeparator:o.rowSeparator,s=r===b.Concise?o.listSeparator:o.columnSeparator;r===b.Strict&&n.push(o.leftBrace);for(let a=0;a<t.rows;++a){0!==a&&(n.push(i),r===b.Concise&&n.push(" "));for(let i=0;i<t.cols;++i){0!==i&&(n.push(s),r===b.Concise&&n.push(" "));const o=T(e,t.opers[a][i],r);if((0,l.isErrorOper)(o))return o;n.push(o.value)}}r===b.Strict&&n.push(o.rightBrace);break}case d.OperKind.String:r===b.Strict?n.push('"'+t.value.replace(/"/g,'""')+'"'):n.push(t.value);break;case d.OperKind.Number:case d.OperKind.Boolean:{const r=e.coerceOper(t,d.OperKind.String);(0,i.assertTrue)("calc.funcs.operToText",(0,l.isStringOper)(r)),n.push(r.value);break}case d.OperKind.Blank:break;case d.OperKind.Error:{const e=o.errorNames[t.type];null==e&&(0,m.throwEvaluationError)((0,l.internal)(`No locale data for error type ${t.type}`)),n.push(e);break}case d.OperKind.Rich:(0,m.throwEvaluationError)((0,l.notImplemented)(["ARRAYTOTEXT/VALUETOTEXT rich argument"]));default:return(0,i.assertNever)("calc.funcs.operToText",t)}return n.reduce(((e,t)=>e+t.length),0)>a.cellStringLimit?a.calcErrorOper:(0,a.stringOper)(n.join(""))}t.text=function(e,[t,{value:r}]){const n=(0,l.isRichOper)(t)?t.getFallback():t;if((0,l.isStringOper)(n)&&n.value.length>255||r.length>255)return a.valueErrorOper;let o;switch(n.kind){case d.OperKind.String:{const t=e.coerceOper(n,d.OperKind.Number);o=(0,l.isNumberOper)(t)?t:n;break}case d.OperKind.Number:o=n;break;case d.OperKind.Boolean:{const t=e.coerceOper(n,d.OperKind.String);(0,i.assertTrue)("calc.funcs.text",(0,l.isStringOper)(t)),o=t;break}case d.OperKind.Error:return a.valueErrorOper}const s=e.applyFormat(e.originSheet.document,r,o,g.NumberFormatSource.CustomString);return void 0!==s?(0,a.stringOper)(s):a.valueErrorOper},t.fixed=function(e,[t,r,n]){const{formatValue:i,formatDecimals:o}=y(e,t,r,void 0);if((0,l.isErrorOper)(i))return i;let u;u=n?.value?0===o?s.KnownFormat.NoComFixed0:2===o?s.KnownFormat.NoComFixed:(0,c.buildNumberFormat)(e.config.localeInfo,!1,1,o):0===o?s.KnownFormat.Fixed0:2===o?s.KnownFormat.Fixed:(0,c.buildNumberFormat)(e.config.localeInfo,!0,4,o);const d=e.applyFormat(e.originSheet.document,u,i,g.NumberFormatSource.CustomBytecode);return void 0!==d?(0,a.stringOper)(d):a.valueErrorOper},t.dollar=function(e,[t,r]){const{localeInfo:n}=e.config,{formatValue:i,formatDecimals:o}=y(e,t,r,n.isEastAsia?n.currencyDecimals:void 0);if((0,l.isErrorOper)(i))return i;const u=0===o?s.KnownFormat.Currency:2===o?s.KnownFormat.CurrencyDec:(0,c.buildCurrencyFormat)(n,!1,o,!0,!1),d=e.applyFormat(e.originSheet.document,u,i,g.NumberFormatSource.CustomBytecode);return void 0!==d&&d.length>0&&d.charCodeAt(d.length-1)===f?(0,a.stringOper)(d.substring(0,d.length-1)):void 0!==d?(0,a.stringOper)(d):a.valueErrorOper},t.value=function(e,[t]){switch(t.kind){case d.OperKind.Boolean:return a.valueErrorOper;case d.OperKind.Number:return t;case d.OperKind.String:return t.value.length>255?a.valueErrorOper:e.coerceOper((0,a.stringOper)(C(t.value)),d.OperKind.Number)}},t.datevalue=function(e,[t]){const r=A(e,t);return(0,l.isErrorOper)(r)?r:e.mathpack.trunc(r)},t.timevalue=function(e,[t]){const r=A(e,t);return(0,l.isErrorOper)(r)?r:e.mathpack.sub(r,e.mathpack.trunc(r))},t.isWhitespace=E,t.numbervalue=function(e,t){const[r,n,o]=t,s=e.mathpack,u=e.config.localeInfo;if(void 0!==n&&(!(0,l.isStringOper)(n)||""===n.value)||void 0!==o&&(!(0,l.isStringOper)(o)||""===o.value))return a.valueErrorOper;const c=e=>(0,h.stringFromCodePoint)((0,h.stringCodePointAt)(e,0)),g=u.decimalSeparator,m=n?c(n.value):g;let f=o?c(o.value):u.thousandsSeparator;if(m===f){if(void 0!==o)return a.valueErrorOper;f=g}const S=r.value;if(""===S)return s.zero;let v=!1,F=0;const y=[];let C=0;const A=e=>(y.push(e),C+=e.length);for(;F<S.length&&C<255;)if(E(S.charCodeAt(F)))F+=1;else if(v||!(0,p.stringStartsWith)(S,f,F))if((0,p.stringStartsWith)(S,m,F))v=!0,A(g),F+=m.length;else{const e=(0,h.stringCodePointAt)(S,F);A((0,h.stringFromCodePoint)(e)),F+=(0,h.numCodeUnits)(e)}else F+=f.length;if(F!==S.length)return a.valueErrorOper;let b=0;for(;y.length>0&&"%"===y[y.length-1];)C-=y.pop().length,++b;if(0===y.length)return s.zero;const R=e.coerceOper((0,a.stringOper)(y.join("")),d.OperKind.Number);if(!(0,l.isNumberOper)(R))return a.valueErrorOper;let T=R;for(;b>0;)T=s.div(T,s.fromNumber(100)),(0,i.assertTrue)("calc.funcs.numberValue",(0,l.isNumberOper)(T)),--b;return T},function(e){e[e.Concise=0]="Concise",e[e.Strict=1]="Strict"}(b||(b={})),t.arraytotext=function(e,t){return R(e,t[0],t[1])},t.valuetotext=function(e,t){return R(e,t[0],t[1])}},34343:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formulatext=t.isformula=t.isodd=t.iseven=t.isomitted=t.islambda=t.isref=t.isnumber=t.istext=t.isnontext=t.isna=t.islogical=t.isblank=t.iserr=t.iserror=void 0;const n=r(70633),a=r(92158),i=r(11181),o=r(93371),s=r(7625),u=r(88435);function l(e,[t]){const r=(0,u.chkNumOper)(e,t);if((0,a.isErrorOper)(r))return r;const i=e.mathpack,o=(0,u.assertNumber)(i.add(i.abs(r),i.fromNumber(1.0000000000000003e-10))),s=(0,u.assertNumber)(i.div(i.floor(o),i.fromNumber(2)));return(0,n.booleanOper)(0===i.cond2(s,i.floor(s)))}function c(e,t,r){if(!(0,a.isSheetIndex)(t.sheets))return n.valueErrorOper;const s=t.ranges[0];if(e.calcingArray||!(0,a.isGridCell)(s)){const a=t.sheets;return(0,n.arrayOper)(s.rows,s.cols,(0,o.jaggedArray)(s.rows,s.cols,((t,n)=>{const o=(0,i.sheetGridCell)(a,(0,i.gridCell)(s.row+t,s.col+n));return r(e.getCellFormula(o),o)})))}const u=(0,a.sheetGridRangeAnchor)((0,i.sheetGridRange)(t.sheets,s));return r(e.getCellFormula(u),u)}t.iserror=function(e,[t]){return(0,n.booleanOper)((0,a.isErrorOper)(t))},t.iserr=function(e,[t]){return(0,n.booleanOper)((0,a.isErrorOper)(t)&&t.type!==n.ErrorType.NA)},t.isblank=function(e,[t]){return(0,n.booleanOper)((0,a.isBlankOper)(t))},t.islogical=function(e,[t]){return(0,n.booleanOper)((0,a.isBooleanOper)(t))},t.isna=function(e,[t]){return(0,n.booleanOper)((0,a.isErrorOper)(t)&&t.type===n.ErrorType.NA)},t.isnontext=function(e,[t]){return(0,n.booleanOper)(!(0,a.isStringOper)(t))},t.istext=function(e,[t]){return(0,n.booleanOper)((0,a.isStringOper)(t))},t.isnumber=function(e,[t]){return(0,n.booleanOper)((0,a.isNumberOper)(t))},t.isref=function(e,[t]){return(0,n.booleanOper)((0,a.isRangeOper)(t))},t.islambda=function(e,[t]){return(0,n.booleanOper)(t instanceof s.LambdaOper)},t.isomitted=function(e,[t]){return(0,n.booleanOper)((0,a.isMissingOper)(t))},t.iseven=l,t.isodd=function(e,t){const r=l(e,t);return(0,a.isBooleanOper)(r)?(0,n.booleanOper)(!r.value):r},t.isformula=function(e,[t]){return c(e,t,(e=>(0,n.booleanOper)(void 0!==e)))},t.formulatext=function(e,[t]){return c(e,t,((t,r)=>{if(void 0===t)return n.naErrorOper;const a=e.printFormula(t,r.range);return t.source.kind===i.LexicalKind.Cell?(0,n.stringOper)(a):(0,n.stringOper)("{"+a+"}")}))}},60747:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.single=t.transpose=t.offset=t.sheet=t.sheets=t.column=t.row=t.columns=t.rows=t.areas=void 0;const n=r(70633),a=r(92158),i=r(11181),o=r(71766),s=r(18612),u=r(93371);function l(e,t){if(!t)return[e.reflectionGridCell,!e.calcingArray];if(!(0,a.isSheetIndex)(t.sheets))return n.valueErrorOper;if(t.ranges.length>1)return n.refErrorOper;const r=t.ranges[0];return[r,(0,a.isGridCell)(r)]}t.areas=function(e,[t]){return(0,a.isSheetIndex)(t.sheets)?e.mathpack.fromNumber(t.ranges.length):n.valueErrorOper},t.rows=function(e,[t]){const r=e.mathpack;return(0,a.isArrayOper)(t)?r.fromNumber(t.rows):(0,a.isSheetIndex)(t.sheets)?t.ranges.length>1?n.refErrorOper:r.fromNumber(t.ranges[0].rows):n.valueErrorOper},t.columns=function(e,[t]){const r=e.mathpack;return(0,a.isArrayOper)(t)?r.fromNumber(t.cols):(0,a.isSheetIndex)(t.sheets)?t.ranges.length>1?n.refErrorOper:r.fromNumber(t.ranges[0].cols):n.valueErrorOper},t.row=function(e,[t]){const r=l(e,t);if(!Array.isArray(r))return r;const[a,i]=r,o=e.mathpack;return i?o.fromNumber(a.row+1):(0,n.arrayOper)(a.rows,1,(0,u.jaggedArray)(a.rows,1,(e=>o.fromNumber(a.row+e+1))))},t.column=function(e,[t]){const r=l(e,t);if(!Array.isArray(r))return r;const[a,i]=r,o=e.mathpack;return i?o.fromNumber(a.col+1):(0,n.arrayOper)(1,a.cols,(0,u.jaggedArray)(1,a.cols,((e,t)=>o.fromNumber(a.col+t+1))))},t.sheets=function(e,[t]){const r=e.mathpack;return t?(0,a.isArrayOper)(t)?n.naErrorOper:r.fromNumber(e.getSheetRangeIndexes(t.sheets).length):r.fromNumber(e.getSheetRangeIndexes((0,i.allSheetsRange)(e.reflectionSheet.document)).length)},t.sheet=function(e,[t]){const r=e.mathpack;if(!t){const t=e.reflectionSheet;return void 0===t.index?n.naErrorOper:r.fromNumber(e.getSheetRangePosition(t)+1)}if((0,a.isStringOper)(t)){const a=e.getSheetIndex(e.reflectionSheet.document,t.value);return void 0===a?n.naErrorOper:r.fromNumber(e.getSheetRangePosition(a)+1)}return(0,a.isRangeOper)(t)?r.fromNumber(e.getSheetRangePosition(t.sheets)+1):(0,a.isArrayOper)(t)?n.naErrorOper:(0,s.assertNever)("calc.funcs.sheet",t)},t.offset=function(e,[t,r,s,u,l]){if(!(0,a.isSheetIndex)(t.sheets))return n.valueErrorOper;if(1!==t.ranges.length)return n.valueErrorOper;const c=e.mathpack,{row:d,col:g,rows:m,cols:h}=t.ranges[0];let p=d;(0,a.isNumberOper)(r)&&(p+=c.lfix(r));let f=g;(0,a.isNumberOper)(s)&&(f+=c.lfix(s));let S=p+m-1;if(void 0!==u&&(0,a.isNumberOper)(u)){const e=c.cond(u);if(0===e)return n.refErrorOper;S=p+c.lfix(u)-(e>0?1:-1)}let v=f+h-1;if(void 0!==l&&(0,a.isNumberOper)(l)){const e=c.cond(l);if(0===e)return n.refErrorOper;v=f+c.lfix(l)-(e>0?1:-1)}const F=(0,o.fastMin)(p,S),y=(0,o.fastMin)(f,v),C=(0,o.fastMax)(p,S)-F+1,A=(0,o.fastMax)(f,v)-y+1;return F<0||y<0||F+C>i.sheetRows||y+A>i.sheetCols?n.refErrorOper:(0,n.rangeSeqOper)(t.sheets,[(0,i.gridRange)(F,y,C,A)])},t.transpose=function(e,[t]){return(0,a.isArrayOper)(t)?(0,n.arrayOper)(t.cols,t.rows,(0,u.jaggedArray)(t.cols,t.rows,((e,r)=>t.opers[r][e]))):t},t.single=function(e,[t]){if((0,a.isPrimitiveOper)(t)||(0,a.isMissingOper)(t)||(0,a.isBlankOper)(t)||(0,a.isRichOper)(t))return t;if((0,a.isArrayOper)(t))return t.opers[0][0];if(!(0,a.isSheetIndex)(t.sheets))return n.refErrorOper;if(1!==t.ranges.length)return n.valueErrorOper;const r=e.originGridCell,i=(0,a.gridCellImplicitIsect)(r,t.ranges[0]);return void 0===i?n.valueErrorOper:(0,n.rangeSeqOper)(t.sheets,[i])}},71251:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.record=t.fieldvalue=void 0;const n=r(70633),a=r(92158),i=r(77981),o=r(7625);t.fieldvalue=function(e,[t,{value:r}]){if((0,a.isRichOper)(t)){const e=t.getField(r);if(void 0!==e)return e}return n.fieldErrorOper},t.record=function(e,t){const r=t[0],n=e.config.localeInfo;let a=i.RedBlackMapTree.create(n.stringCompareCI);for(let e=1;e<t.length;e+=2){const{value:r}=t[e],n=t[e+1];a=a.setValue(r,n)}return new o.RecordOper(a,r)}},87665:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reduceDerefOpers=t.isPrimitiveCoercedOper=t.isCoercedArrayOper=t.coercedArrayOper=void 0;const n=r(64316),a=r(93371),i=r(18612),o=r(79673);t.coercedArrayOper=function(e,t,r){return(0,i.assertNatural)("calc.runtime.coercedArrayOper",e),(0,i.assertNatural)("calc.runtime.coercedArrayOper",t),r.length!==e?(0,i.assertFalse)("calc.runtime.coercedArrayOper: Inconsistent row number"):{kind:o.OperKind.Array,rows:e,cols:t,opers:r}},t.isCoercedArrayOper=function(e){return e.kind===o.OperKind.Array};const s=o.OperKind.Number|o.OperKind.String|o.OperKind.Boolean;t.isPrimitiveCoercedOper=function(e){const{kind:t}=e;return"number"==typeof t&&0!=(t&s)},t.reduceDerefOpers=function(e,t,r,i,s){const u=(n,i,u,c)=>{if(i?.kind===o.OperKind.Array){const e=new a.StrictArray2D(i.rows,i.cols,i.opers);let t=n;for(let r=0;r<u;r+=1)t=l(t,e);return t}const d=(c&&void 0!==s?s:r)(e,i);return null==d?n:t(n,d,u)};function l(e,t){let r=e;for(let e=0;e<t.rows;e+=1)for(let n=0;n<t.cols;n+=1){const a=t.get(e,n);void 0!==a&&(r=u(r,a,1,!0))}return r}function c(e,t){let r=e;const n=t.getSparse(),a=t.cols-t.denseCols;for(let e=0;e<t.denseRows;e+=1){for(let n=0;n<t.denseCols;n+=1){const a=t.get(e,n);void 0!==a&&(r=u(r,a,1,!1))}a>0&&void 0!==n&&(r=u(r,n,a,!1))}const i=(t.rows-t.denseRows)*t.cols;return i>0&&void 0!==n&&(r=u(r,n,i,!1)),r}return i.reduce(((e,t)=>(0,n.isRangeValues)(t)?t.arrays.reduce(c,e):u(e,t,1,!1)),void 0)}},95771:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wraprows=t.wrapcols=t.torow=t.tocol=t.chooserows=t.choosecols=t.vstack=t.hstack=t.expand=t.drop=t.take=t.sequence=t.indirect=t.address=void 0;const n=r(70633),a=r(70633),i=r(11181),o=r(69210),s=r(66785),u=r(92158),l=r(59242),c=r(59242),d=r(18612),g=r(51465),m=r(43376),h=r(79673),p=r(31663),f=r(71766),S=r(93371),v=r(64316),F=r(88435);function y(e,t){if((0,f.fastAbs)(e)<t){const r=(0,f.fastAbs)(e);return e<0?{start:t-r,count:r}:{start:0,count:r}}return{start:0,count:t}}function C(e,t){if((0,f.fastAbs)(e)<t){const r=t-(0,f.fastAbs)(e);return e<0?{start:0,count:r}:{start:e,count:r}}return{start:0,count:0}}t.address=function(e,[t,r,n,l,c]){const g=e.mathpack,m=n?.kind===h.OperKind.Number?g.sfix(n)-1:0;if(m<0||m>3)return a.valueErrorOper;const p=0!=(1&m),f=0!=(2&m),S=l?.kind!==h.OperKind.Boolean||l.value?o.RefStyle.A1:o.RefStyle.R1C1,v=(e,t,r)=>S===o.RefStyle.R1C1&&e?-t<r&&r<t:1<=r&&r<=t,F=g.sfix(t);if(!v(f,i.sheetRows,F))return a.valueErrorOper;if(!(0,u.isNumberOper)(r))return a.valueErrorOper;const y=g.sfix(r);if(!v(p,i.sheetCols,y))return a.valueErrorOper;const C=(0,i.gridCell)(F<0?i.sheetRows-1:0,y<0?i.sheetCols-1:0),A=(0,o.pos)(f?o.PosKind.Rel:o.PosKind.Abs,S===o.RefStyle.R1C1&&f?F:F-1),E=(0,o.pos)(p?o.PosKind.Rel:o.PosKind.Abs,S===o.RefStyle.R1C1&&p?y:y-1),b=(0,s.formatCellPos)(e.config.localeInfo,S,C,A,E,!1);return(0,d.assertTrue)("calc.funcs.address: cell wrapped",void 0!==b),c?.kind===h.OperKind.String?""===c.value?(0,a.stringOper)("!"+b):c.value.length>255?a.valueErrorOper:(0,a.stringOper)((0,s.formatQualifier)(e.config.localeInfo,e.config.refStyle,c.value)+"!"+b):(0,a.stringOper)(b)},t.indirect=function(e,[{value:t},r]){const n=r?.value??1?o.RefStyle.A1:o.RefStyle.R1C1;if(t.length>255||(0,g.stringStartsWith)(t," "))return a.valueErrorOper;let s=(0,i.originCell)(e.originSheet,e.originGridCell);const l={lexicalKind:i.LexicalKind.Indirect,originGridCell:(0,m.success)(s.range),originSheet:(0,m.success)(s.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0,allowImplicitTable:!1,wrapCellReferences:!0,workbookLoad:!1},d=e.parseFormula(n,s.range,l,"="+t);if(!(0,m.isSuccess)(d))return a.refErrorOper;let h=d.value.node,f=!1,S=!1;for(;;){if(!f&&h.kind===o.NodeKind.App&&(0,u.isOperatorNode)(h.head)&&h.head.id===c.OperatorId.Pound&&1===h.args.length&&(f=!0,h=h.args[0]),S||h.kind!==o.NodeKind.Name){if(h.kind===o.NodeKind.CellRef){const t=e.getCellRef(h.qualifier,h.ref,s,!0);return void 0===t?a.refErrorOper:(0,u.isSheetIndex)(t.sheets)?f?(0,p.throwEvaluationError)((0,u.notImplemented)(["# operator in INDIRECT"])):t:a.refErrorOper}if(h.kind===o.NodeKind.StructRef){if(void 0===h.lhs)return a.refErrorOper;const t=e.getStructRef(h.lhs,h.rhs,s);return void 0===t||f?a.refErrorOper:t}return a.refErrorOper}{const t=e.getNameFormula(h.qualifier,h.whole,i.NameSource.Indirect);if(void 0===t)return a.refErrorOper;s=(0,i.originCell)(s.sheet,(0,i.gridCell)(0,0)),h=t[1],S=!0}}},t.sequence=(e,t)=>{const[r,n,o,s]=t,l=e.mathpack,c=(0,u.isMissingOper)(r)?1:l.sfix(r),d=void 0===n||(0,u.isMissingOper)(n)?1:l.sfix(n);if(c<0||c>i.sheetRows||d<0||d>i.sheetRows)return a.valueErrorOper;if((0,F.validateArraySize)(c,d),0===c||0===d)return a.calcErrorOper;const g=void 0===o||(0,u.isMissingOper)(o)?l.fromNumber(1):o,m=void 0===s||(0,u.isMissingOper)(s)?l.fromNumber(1):s;let h=g;const p=[];for(let e=0;e<c;e++){const e=[];for(let t=0;t<d;t++){if(e.push(h),(0,u.isErrorOper)(h))continue;const t=l.add(h,m);h=(0,u.isErrorOper)(t)?t:l.checkAlmostCancellation(m,t)}p.push(e)}return(0,a.arrayOper)(c,d,p)},t.take=(e,t)=>{const[r,n,i]=t,o=e.mathpack,s=(0,F.rangeOrArrayToVal)(r,a.valueErrorOper);if(!(0,u.isArrayOper)(s)&&!(0,u.isRangeOper)(s))return s;const l=(0,F.makeSlicer)(s),c=(0,u.isMissingOper)(n)?l.rows:o.lfix(n),d=void 0===i||(0,u.isMissingOper)(i)?l.cols:o.lfix(i),{start:g,count:m}=y(c,l.rows),{start:h,count:p}=y(d,l.cols);return 0===m||0===p?a.calcErrorOper:l.slice(g,m,h,p)},t.drop=(e,t)=>{const[r,n,i]=t,o=e.mathpack,s=(0,F.rangeOrArrayToVal)(r,a.valueErrorOper);if(!(0,u.isArrayOper)(s)&&!(0,u.isRangeOper)(s))return s;const l=(0,F.makeSlicer)(s),c=(0,u.isMissingOper)(n)?0:o.lfix(n),d=void 0===i||(0,u.isMissingOper)(i)?0:o.lfix(i),{start:g,count:m}=C(c,l.rows),{start:h,count:p}=C(d,l.cols);return 0===m||0===p?a.calcErrorOper:l.slice(g,m,h,p)},t.expand=function(e,t){const[r,o,s=n.missingOper,l=n.missingOper]=t,c=e.mathpack,d=(0,u.isMissingOper)(o)?r.rows:c.lfix(o),g=(0,u.isMissingOper)(s)?r.cols:c.lfix(s);if(d<r.rows||g<r.cols)return a.valueErrorOper;if(0===d||0===g)return a.calcErrorOper;if(g>i.sheetRows||d>i.sheetRows)return n.numErrorOper;(0,F.validateArraySize)(d,g);const m=(0,u.isMissingOper)(l)?n.naErrorOper:l;return(0,u.isArrayOper)(m)?a.valueErrorOper:(0,a.arrayOper)(d,g,(0,S.array2DToJaggedArray)(new S.StrictSparseArray2D(d,g,r.rows,r.cols,r.opers,m)))},t.hstack=(e,t)=>E(e,t,!0),t.vstack=(e,t)=>E(e,t,!1);const A=()=>n.naErrorOper;function E(e,t,r){const o=e.dereferenceAllOpers(t).map((e=>(0,v.isRangeValues)(e)?e.arrays:[new S.StrictArray2D(e.rows,e.cols,e.opers)])),s=(0,f.safeConcat)([],o).map((e=>r?(0,S.transposeArray2D)(e):e)),u=s.reduce(((e,t)=>(0,f.fastMax)(t.cols,e)),0),l=s.reduce(((e,t)=>e+t.rows),0);if(u>i.sheetRows||l>i.sheetRows)return n.numErrorOper;(0,F.validateArraySize)(l,u);const c=(0,f.safeConcat)([],s.map((e=>function(e,t,r){return e.cols>=t?e:new S.NonstrictSparseArray2D(e.rows,t,e.rows,e.cols,e.get.bind(e),r)}(e,u,A))).map(S.array2DToJaggedArray)),d=new S.StrictArray2D(c.length,c[0].length,c),g=r?(0,S.transposeArray2D)(d):d;return(0,a.arrayOper)(g.rows,g.cols,(0,S.array2DToJaggedArray)(g))}function b(e,t,r){const n=t.lfix(e),i=n>0?n:-n;return i>r||0===i?a.valueErrorOper:(0,F.getAbsoluteIndex)(r,n)}function R(e,t,r){if(e.rows>1&&e.cols>1)return a.valueErrorOper;const n=[];for(const i of e.opers)for(const e of i){if(!(0,u.isNumberOper)(e))return(0,u.isErrorOper)(e)?e:a.valueErrorOper;const i=b(e,t,r);if("number"!=typeof i)return i;n.push(i)}return n}const T=(e,t)=>{const r=[];for(const n of e){const e=t.opers[n];r.push(e)}return r},k=(e,t)=>t.opers.map((t=>{const r=[];for(const n of e)r.push(t[n]);return r})),N=(e,t,r,o)=>{const[s,...l]=t;if((0,u.isRangeOper)(s)){if(s.ranges.length>1)return a.refErrorOper;(0,d.assertTrue)("calc.funcs.ChooseColRow: not 3D ref",(0,u.isSheetIndex)(s.sheets))}const c=e.dereferenceOper(s,h.OperKind.Array);if(!(0,u.isArrayOper)(c))return c;const g=function(e,t,r){const n=[];for(const a of e)if((0,u.isArrayOper)(a)){const e=R(a,t,r);if(!Array.isArray(e))return e;(0,f.safePush)(n,e)}else{const e=b(a,t,r);if("number"!=typeof e)return e;n.push(e)}return n}(l,e.mathpack,o?c.rows:c.cols);if(!Array.isArray(g))return g;if(g.length>i.sheetRows||(o?c.cols:c.rows)>i.sheetRows)return n.numErrorOper;o?(0,F.validateArraySize)(g.length,c.cols):(0,F.validateArraySize)(c.rows,g.length);const m=r(g,c);return 0===m.length||0===m[0].length?a.calcErrorOper:(0,a.arrayOper)(m.length,m[0].length,m)};function I(e,t){return t?new S.NonstrictArray2D(1,e.length,((t,r)=>e[r])):new S.NonstrictArray2D(e.length,1,(t=>e[t]))}function O(e,t,r){const[o,s,c]=r,d=e.mathpack,[g]=e.dereferenceAllOpers([o]),m=(0,v.isRangeValues)(g)?g.arrays:[new S.StrictSparseArray2D(g.rows,g.cols,g.rows,g.cols,g.opers,n.blankOper)],h=void 0===s||(0,u.isMissingOper)(s)?0:d.lfix(s),p=void 0!==c&&!(0,u.isMissingOper)(c)&&c.value;if(h<0||h>3)return a.valueErrorOper;const f=1===h||3===h,y=2===h||3===h,C=[],A=[],E=(e,t)=>{f&&(0,u.isBlankOper)(e)||y&&(0,u.isErrorOper)(e)||(C.push(e),A.push(t))};for(const e of m){const t=p?(0,S.transposeSparseArray2D)(e):e,{rows:r,cols:n,denseRows:a,denseCols:i}=t;for(let e=0;e<a;++e){for(let r=0;r<i;++r)E(t.get(e,r),1);i<n&&E(t.getSparse(),n-i)}a<r&&n>0&&E(t.getSparse(),n*(r-a))}const b=A.reduce(((e,t)=>e+t),0);if(0===b)return a.calcErrorOper;if(b>i.sheetRows)return n.numErrorOper;t===l.WorksheetFuncId.TOROW?(0,F.validateArraySize)(1,b):(0,F.validateArraySize)(b,1);const R=[];for(let e=0;e<C.length;++e){const t=C[e],r=A[e];for(let e=0;e<r;++e)R.push(t)}const T=I(R,t===l.WorksheetFuncId.TOROW);return(0,a.arrayOper)(T.rows,T.cols,(0,S.array2DToJaggedArray)(T))}function _(e,t,r){const[i,o,s=n.missingOper]=r;if(!(1===i.rows&&i.cols>=1||1===i.cols&&i.rows>=1))return a.valueErrorOper;const c=e.mathpack.lfix(o);if(c<1)return n.numErrorOper;const d=1===i.rows?i.opers[0]:i.opers.map((e=>e[0])),g=d.length;if(c>=g){const e=I(d,t===l.WorksheetFuncId.WRAPROWS);return(0,a.arrayOper)(e.rows,e.cols,(0,S.array2DToJaggedArray)(e))}const m=Math.floor((g+c-1)/c);t===l.WorksheetFuncId.WRAPROWS?(0,F.validateArraySize)(m,c):(0,F.validateArraySize)(c,m);const h=(0,u.isMissingOper)(s)?n.naErrorOper:s,p=(e,t)=>{const r=e*c+t;return r>=d.length?h:d[r]},f=t===l.WorksheetFuncId.WRAPROWS?new S.NonstrictArray2D(m,c,((e,t)=>p(e,t))):new S.NonstrictArray2D(c,m,((e,t)=>p(t,e)));return(0,a.arrayOper)(f.rows,f.cols,(0,S.array2DToJaggedArray)(f))}t.choosecols=(e,t)=>N(e,t,k,!1),t.chooserows=(e,t)=>N(e,t,T,!0),t.tocol=function(e,t){return O(e,l.WorksheetFuncId.TOCOL,t)},t.torow=function(e,t){return O(e,l.WorksheetFuncId.TOROW,t)},t.wrapcols=function(e,t){return _(e,l.WorksheetFuncId.WRAPCOLS,t)},t.wraprows=function(e,t){return _(e,l.WorksheetFuncId.WRAPROWS,t)}},47691:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sortOpers=void 0;const n=r(71766),a=r(79673),i=r(92158),o=r(31663),s=e=>e<0?-1:e>0?1:0,u={[a.OperKind.Number]:1,[a.OperKind.String]:2,[a.OperKind.Boolean]:3,[a.OperKind.Array]:4,[a.OperKind.Error]:5};t.sortOpers=function e(t,r,l,c,d){if((0,i.isBlankOper)(r))return(0,i.isBlankOper)(l)?0:1;if((0,i.isBlankOper)(l))return-1;if((0,i.isRichOper)(r)||(0,i.isRichOper)(l))return(0,o.throwEvaluationError)((0,i.notImplemented)(["rich value sort"]));if(r.kind!==l.kind)return s(c*(u[r.kind]-u[l.kind]));switch(r.kind){case a.OperKind.Number:return s(c*t.mathpack.cond2(r,l));case a.OperKind.String:return s(c*t.localeInfo.stringCompareCI(r.value,l.value));case a.OperKind.Boolean:return s(c*(r.value-l.value));case a.OperKind.Array:{const a=r,i=l,o=(0,n.fastMin)(a.rows,i.rows),u=(0,n.fastMin)(a.cols,i.cols);for(let r=0;r<o;++r){for(let n=0;n<u;++n){const o=e(t,a.opers[r][n],i.opers[r][n],c,d);if(0!==o)return o}if(a.cols!==i.cols)return s(c*(a.cols-i.cols))}return a.rows!==i.rows?s(c*(a.rows-i.rows)):0}case a.OperKind.Error:return d?s(c*(r.type-l.type)):0}}},60383:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.textAfter=t.textBefore=t.textSplit=t.substitute=t.search=t.replace=t.find=t.proper=t.upper=t.lower=t.unicode=t.code=t.unichar=t.char=t.clean=t.trim=t.rept=t.exact=t.concatenate=t.len=t.mid=t.left=t.right=void 0;const n=r(74643),a=r(92158),i=r(70633),o=r(31663),s=r(23262),u=r(91282),l=n.__importStar(r(33372)),c=r(51465),d=r(79673),g=r(36094),m=r(18612),h=r(71766),p=r(88435),{codePointSpace:f,codePointCapitalA:S,codePointCapitalZ:v,codePointSmallA:F,codePointSmallZ:y}=l,C=2147483647;function A(e,t){return void 0===t?1:e.cond(t)<0?i.valueErrorOper:e.sfix(t)}function E(e){return e>=S&&e<=v||e>=F&&e<=y}function b(e,t,r){return""===e?e:function(e){for(let t=0;t<e.length;t+=1)if(e.charCodeAt(t)>=128)return!1;return!0}(e)?r():(0,o.throwEvaluationError)((0,a.notImplemented)([t+" for non-ASCII input"]))}function R(e,t,r){if(void 0===t||(0,a.isMissingOper)(t))return[];if((0,a.isStringOper)(t))return r&&0===t.value.length?i.valueErrorOper:[t.value];const n=[];for(let o=0;o<t.rows;++o){const s=t.opers[o];for(let t=0;t<s.length;++t){const o=s[t],u=e.coerceOper(o,d.OperKind.String);if((0,a.isErrorOper)(u))return u;const l=(0,p.assertString)(u).value;if(r&&0===l.length)return i.valueErrorOper;n.push(l)}}return n.sort(((e,t)=>e.length-t.length)),n}function T(e,t,r){for(const n of r)if((0,c.stringStartsWith)(e,n,t))return n}function k(e,t,r,n,o,s,u,l){const c=function(e,t,r,n,o,s,u){const l=t.value,c=void 0===n||(0,a.isMissingOper)(n)?1:e.mathpack.sfix(n),d=R(e,r,!1);if(!Array.isArray(d))return d;const g=d.reduce(((e,t)=>t.length<e?t.length:e),d[0].length),m=-(l.length-g+1),h=l.length-g+1;if(void 0!==n&&!(0,a.isMissingOper)(n)){if(0!==g&&!(c>=m&&c<=h))return i.valueErrorOper;if(0===c)return i.valueErrorOper}let p,f;if(void 0===o||(0,a.isMissingOper)(o))p=!1;else{const t=e.mathpack.lfix(o);if(0!==t&&1!==t)return i.valueErrorOper;p=1===t}if(void 0===s||(0,a.isMissingOper)(s))f=!1;else{const t=e.mathpack.lfix(s);if(0!==t&&1!==t)return i.valueErrorOper;f=1===t}return function(e,t,r,n,a,i,o){let s=e,u=t;if(0===r)return n>0?[0,0]:[s.length,s.length];if(s.length-r<0)return o;a&&(s=s.toLowerCase(),u=u.map((e=>e.toLowerCase())));let l=n,c=0;const d=s.length;let g=1;for(n<0&&(g=-1,c=d);c<=d&&c>=0;){const e=T(s,c,u);if(void 0!==e){if(l-=g,0===l)return[c,e.length];c+=g*(e.length-1)}c+=g}return i&&n-g==0?1===g?[s.length,0]:[0,0]:o}(l,d,g,c,p,f,void 0===u||(0,a.isMissingOper)(u)?i.naErrorOper:u)}(t,r,n,o,s,u,l);if(Array.isArray(c)){const[t,n]=c;return e===N.TEXTBEFORE?(0,i.stringOper)(r.value.slice(0,t)):(0,i.stringOper)(r.value.slice(t+n))}return c}var N;t.right=function(e,[{value:t},r]){if(void 0!==r&&(0,a.isErrorOper)(r))return r;const n=A(e.mathpack,r);if("number"!=typeof n&&(0,a.isErrorOper)(n))return i.valueErrorOper;const o=(0,s.scanCodePointsBack)(t,t.length,n)??0;return(0,i.stringOper)(t.substring(o))},t.left=function(e,[{value:t},r]){if(void 0!==r&&(0,a.isErrorOper)(r))return r;const n=A(e.mathpack,r);if("number"!=typeof n&&(0,a.isErrorOper)(n))return i.valueErrorOper;const o=(0,s.scanCodePoints)(t,0,n)??t.length;return(0,i.stringOper)(t.substring(0,o))},t.mid=function(e,[{value:t},r,n]){const a=e.mathpack,o=a.fix(r)-1,u=a.fix(n);if(a.cond(r)<0||o<0||a.cond(n)<0||u<0)return i.valueErrorOper;const l=(0,s.scanCodePoints)(t,0,o)??t.length,c=(0,s.scanCodePoints)(t,l,u)??t.length;return(0,i.stringOper)(t.substring(l,c))},t.len=function(e,[{value:t}]){return e.mathpack.fromNumber((0,s.countCodePoints)(t,0,t.length))},t.concatenate=function(e,t){let r="";for(let e=0;e<t.length;e+=1){const{value:n}=t[e];if(r.length+n.length>i.cellStringLimit){r+=n.substring(0,i.cellStringLimit-r.length);break}r+=n}return(0,i.stringOper)(r)},t.exact=function(e,[t,r]){return((0,a.isRichOper)(t)||(0,a.isRichOper)(r))&&(0,o.throwEvaluationError)((0,a.notImplemented)(["EXACT rich argument"])),(0,i.booleanOper)(t.value===r.value)},t.rept=function(e,[{value:t},r]){const n=e.mathpack,a=n.fix(r);return n.cond(r)<0||a>C?i.valueErrorOper:""===t?g.emptyStringOper:a*t.length>i.cellStringLimit?i.valueErrorOper:(0,i.stringOper)((0,c.repeat)(t,a))},t.trim=function(e,[{value:t}]){let r="";for(let e=0;e<t.length;){for(;e<t.length&&t.charCodeAt(e)===f;)e+=1;const n=e;for(;e<t.length;){const r=t.charCodeAt(e)===f;if(e+=1,r)break}r+=t.substring(n,e)}return r.length>0&&r.charCodeAt(r.length-1)===f&&(r=r.substring(0,r.length-1)),(0,i.stringOper)(r)},t.clean=function(e,[{value:t}]){let r="";for(let e=0;e<t.length;e+=1){const n=t.charCodeAt(e);(n>=256||(127&n)>=32)&&(r+=t.charAt(e))}return(0,i.stringOper)(r)},t.char=function(e,[t]){const r=e.mathpack.sfix(t);return r<1||r>255?i.valueErrorOper:(0,i.stringOper)(String.fromCharCode(r))},t.unichar=function(e,[t]){const r=e.mathpack,n=r.lfix(r.trunc(t));return r.cond2(t,r.one)<0||n>=1114112?i.valueErrorOper:n<=65535&&(0,s.isAnySurrogate)(n)||n>=64976&&n<=65007||(65535&n)>=65534?i.naErrorOper:(0,i.stringOper)((0,s.stringFromCodePoint)(n))},t.code=function(e,[{value:t}]){if(0===t.length)return i.valueErrorOper;const r=t.charCodeAt(0);return r>255?(0,o.throwEvaluationError)((0,a.notImplemented)(["CODE for codepoints > 255"])):e.mathpack.fromNumber(r)},t.unicode=function(e,[{value:t}]){if(0===t.length)return i.valueErrorOper;const r=t.charCodeAt(0),n=e.mathpack;if(!(0,s.isAnySurrogate)(r))return n.fromNumber(r);if(1===t.length)return i.valueErrorOper;const a=t.charCodeAt(1),o=(0,s.surrogatePairToCodePoint)(r,a);return void 0===o?i.valueErrorOper:n.fromNumber(o)},t.lower=function(e,[{value:t}]){return(0,i.stringOper)(b(t,"LOWER",t.toLowerCase.bind(t)))},t.upper=function(e,[{value:t}]){return(0,i.stringOper)(b(t,"UPPER",t.toUpperCase.bind(t)))},t.proper=function(e,[{value:t}]){return(0,i.stringOper)(b(t,"PROPER",(()=>{const e=t.toLowerCase();let r="",n=0;for(;;){const t=n;for(;n<e.length&&!E(e.charCodeAt(n));)n+=1;if(r+=e.substring(t,n),n===e.length)break;const a=n,i=(0,s.stringCodePointAt)(e,n);for(r+=(0,s.stringFromCodePoint)(i).toUpperCase(),n+=(0,s.numCodeUnits)(i);n<e.length&&E(e.charCodeAt(n));)n+=1;r+=e.substring(a+1,n)}return r})))},t.find=function(e,[{value:t},{value:r},n]){const a=void 0!==n?e.mathpack.sfix(n)-1:0;if(a<0||a>=C)return i.valueErrorOper;const o=(0,s.scanCodePoints)(r,0,a)??r.length,u=r.indexOf(t,o);return u>=0?e.mathpack.fromNumber((0,s.countCodePoints)(r,0,u)+1):i.valueErrorOper},t.replace=function(e,[{value:t},r,n,{value:a}]){const o=e.mathpack.sfix(r)-1;if(o<0||o>=i.cellStringLimit)return i.valueErrorOper;const u=e.mathpack.sfix(n);if(u<0||u>i.cellStringLimit)return i.valueErrorOper;const l=(0,s.scanCodePoints)(t,0,o)??t.length,c=(0,s.scanCodePoints)(t,l,u)??t.length,d=t.slice(0,l),g=t.slice(c);return d.length+a.length+g.length>i.cellStringLimit?i.valueErrorOper:(0,i.stringOper)(d+a+g)},t.search=function(e,[{value:t},{value:r},n]){const a=void 0!==n?e.mathpack.sfix(n)-1:0;if(a<0||a>=C)return i.valueErrorOper;let o=(0,s.scanCodePoints)(r,0,a)??r.length;const l=new u.WildExp(e.config.localeInfo,t,!0);for(;o<r.length;o+=1)if(l.test(r.slice(o)))return e.mathpack.fromNumber((0,s.countCodePoints)(r,0,o)+1);return i.valueErrorOper},t.substitute=function(e,[t,{value:r},{value:n},o]){const{value:s}=t;let u=1/0;if(void 0!==o){const t=e.coerceOper(o,d.OperKind.Number);if((0,a.isErrorOper)(t))return t;if(u=e.mathpack.sfix(t),u<1||u>2147483646)return i.valueErrorOper}const l=r.length;if(l>0){let e="",t=0,a=0;for(;u>=0&&-1!==(a=s.indexOf(r,a));)if(u-=1,u===1/0||0===u){const r=s.slice(t,a);if(e.length+r.length+n.length>i.cellStringLimit)return i.valueErrorOper;e+=r,e+=n,a+=l,t=a}else a+=1;const o=s.slice(t);return e.length+o.length>i.cellStringLimit?i.valueErrorOper:(e+=o,(0,i.stringOper)(e))}return t},t.textSplit=(e,t)=>{const[r,n,o,s,u,l]=t,c=r.value;if(0===c.length)return i.valueErrorOper;let d=R(e,n,!0);if(!Array.isArray(d))return d;let g=R(e,o,!0);if(!Array.isArray(g))return g;const p=void 0!==s&&!(0,a.isMissingOper)(s)&&s.value;let f;if(void 0===u||(0,a.isMissingOper)(u))f=!1;else{const t=e.mathpack.lfix(u);if(0!==t&&1!==t)return i.valueErrorOper;f=1===t}const S=void 0===l||(0,a.isMissingOper)(l)?i.naErrorOper:l;if((0,a.isArrayOper)(S))return i.valueErrorOper;let v=c;if(f&&(v=c.toLowerCase(),d=d.map((e=>e.toLowerCase())),g=g.map((e=>e.toLowerCase()))),0===d.length&&0===g.length)return i.valueErrorOper;const F=function(e,t,r,n,a){let o=0,s=0;const u=[];let l;for(;o<=t.length;){let c,d;if(s<t.length&&(c=T(t,s,r),d=void 0===c?T(t,s,n):void 0),(0,m.assertTrue)("calc.runtime.textsplit: current in bounds",s<=t.length),void 0!==c||void 0!==d||s===t.length){(s-o>0||!a)&&(void 0===l&&(l=[],u.push(l)),l.push((0,i.stringOper)(e.slice(o,s))),void 0!==d&&(l=void 0));const t=(c??d??"1").length;(0,m.assertTrue)("calc.runtime.textsplit: matchLength > 0",t>0),s+=t,o=s}else++s}return u}(c,v,d,g,p);if(!Array.isArray(F))return F;if(0===F.length)return i.calcErrorOper;const y=F.reduce(((e,t)=>(0,h.fastMax)(t.length,e)),0);return(0,m.assertTrue)("calc.runtime.textsplit: non-zero cols",y>0),(0,i.arrayOper)(F.length,y,F.map((e=>{for(;e.length<y;)e.push(S);return e})))},function(e){e[e.TEXTBEFORE=1]="TEXTBEFORE",e[e.TEXTAFTER=2]="TEXTAFTER"}(N||(N={})),t.textBefore=(e,t)=>{const[r,n,a,i,o,s]=t;return k(N.TEXTBEFORE,e,r,n,a,i,o,s)},t.textAfter=(e,t)=>{const[r,n,a,i,o,s]=t;return k(N.TEXTAFTER,e,r,n,a,i,o,s)}},92890:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FuncContextMock=void 0;const n=r(13597),a=r(31663),i=r(75811),o=r(43376);t.FuncContextMock=class{get calcingArray(){throw new Error("Method not implemented.")}get originGridCell(){throw new Error("Method not implemented.")}get originSheet(){throw new Error("Method not implemented.")}get reflectionGridCell(){throw new Error("Method not implemented.")}get reflectionSheet(){throw new Error("Method not implemented.")}get followHyperlinks(){throw new Error("Method not implemented.")}applyFunction(e,t){throw new Error("Method not implemented.")}applyLambda(e,t){throw new Error("Method not implemented.")}handleEvaluationError(e){throw new Error("Method not implemented.")}coerceOper(e,t){throw new Error("Method not implemented.")}parseGeneral(e,t){const r=this.formatter.parseGeneral(e,!1,t,i.GetTimeKind.NonVolatile);return(0,o.isSuccess)(r)||(0,a.throwEvaluationError)(r.reason),r.value?.value}parseDate(e){const t=this.formatter.parseDate(e,i.GetTimeKind.NonVolatile);return(0,o.isSuccess)(t)||(0,a.throwEvaluationError)(t.reason),t.value?.value}getCellFormula(e){throw new Error("Method not implemented.")}getSheetIndex(e,t){throw new Error("Method not implemented.")}getSheetRangePosition(e){throw new Error("Method not implemented.")}getSheetRangeIndexes(e){throw new Error("Method not implemented.")}getNameFormula(e,t){throw new Error("Method not implemented.")}getCellRef(e,t,r,n){throw new Error("Method not implemented.")}getStructRef(e,t,r){throw new Error("Method not implemented.")}dereferenceAllOpers(){throw new Error("Method not implemented.")}dereferenceAllOpersAndFormulae(){throw new Error("Method not implemented.")}dereferenceOper(e,t){throw new Error("Method not implemented.")}dereferenceOpers(e,t){throw new Error("Method not implemented.")}isInFilterMode(){throw new Error("Method not implemented.")}printFormula(e,t){throw new Error("Method not implemented.")}getBinaryOperator(e){throw new Error("Method not implemented.")}getUnaryOperator(e){throw new Error("Method not implemented.")}parseFormula(e,t,r,n){throw new Error("Method not implemented.")}applyFormat(e,t,r){throw new Error("Method not implemented.")}getRandom(){throw new Error("Method not implemented.")}getTime(e){throw new Error("Method not implemented.")}constructor(e){this.config=e,this.formatter=(0,n.createNumberFormatter)({config:this.config}),this.mathpack=this.config.mathpack,this.datepack=this.config.datepack}}},88435:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAbsoluteIndex=t.rangeOrArrayToVal=t.makeSlicer=t.ArraySlicer=t.RangeSlicer=t.validateArraySize=t.numInt=t.numMod=t.validDateRange=t.chkNumMultiOper=t.chkDateOper=t.atpm1904to1900Days=t.chkNumOper=t.assertError=t.assertString=t.assertNumber=t.wrap2=t.wrap1=void 0;const n=r(70633),a=r(98677),i=r(18612),o=r(92158),s=r(93371),u=r(79673),l=r(43376),c=r(31663),d=r(11181),g=r(51465);function m(e,t){const r=(0,a.refToVal)(e,t,!1),s=(0,o.isRichOper)(r)?r.getFallback():r;switch(s.kind){case u.OperKind.Number:return s;case u.OperKind.Boolean:return n.valueErrorOper;case u.OperKind.String:const t=e.coerceOper(s,u.OperKind.Number);return(0,o.isNumberOper)(t)?t:n.valueErrorOper;case u.OperKind.Error:return s;case u.OperKind.Array:return n.valueErrorOper;case u.OperKind.Missing:return n.naErrorOper;case u.OperKind.Blank:return e.mathpack.zero;default:return(0,i.assertNever)("calc.funcs.chkNumOper",s)}}t.wrap1=function(e){return(t,r)=>e(t)(r[0])},t.wrap2=function(e){return(t,r)=>e(t)(r[0],r[1])},t.assertNumber=e=>(0,o.isNumberOper)(e)?e:(0,i.assertFalse)("calc.funcs.assertNumber"),t.assertString=e=>(0,o.isStringOper)(e)?e:(0,i.assertFalse)("calc.funcs.assertString"),t.assertError=e=>(0,o.isErrorOper)(e)?e:(0,i.assertFalse)("calc.funcs.assertError"),t.chkNumOper=m,t.atpm1904to1900Days=1462,t.chkDateOper=function(e,r){let a=m(e,r);if((0,o.isErrorOper)(a))return a;const i=e.mathpack;return i.cond(a)<0?n.numErrorOper:(a=i.floor(a),v(e,a)?(e.config.date1904&&!(0,o.isStringOper)(r)&&(a=i.add(i.fromNumber(t.atpm1904to1900Days),a)),a):n.numErrorOper)},t.chkNumMultiOper=function e(t,r){switch(r.kind){case u.OperKind.Number:return(0,l.success)(new s.StrictSparseArray2D(1,1,1,1,[[r]],n.blankOper));case u.OperKind.String:const i=t.coerceOper(r,u.OperKind.Number);return(0,o.isErrorOper)(i)?(0,l.failure)(n.valueErrorOper):(0,l.success)(new s.StrictSparseArray2D(1,1,1,1,[[i]],n.blankOper));case u.OperKind.Blank:return(0,l.success)(new s.StrictSparseArray2D(1,1,1,1,[[t.mathpack.zero]],n.blankOper));case u.OperKind.Missing:return(0,l.failure)(n.naErrorOper);case u.OperKind.Error:return(0,l.failure)(r);case u.OperKind.Range:return e(t,(0,a.refToVal)(t,r,!1));case u.OperKind.Array:return(0,l.success)(new s.StrictSparseArray2D(r.rows,r.cols,r.rows,r.cols,r.opers,n.blankOper));default:return(0,l.failure)(n.valueErrorOper)}};const h=0,p=2958465,f=0,S=2957003;function v(e,t){let r,n;const a=e.mathpack.lfix(t);return e.config.date1904?(r=f,n=S):(r=h,n=p),a>=r&&a<=n}t.validDateRange=v,t.numMod=function(e,t,r){const n=e.div(t,r);if((0,o.isErrorOper)(n))return n;const a=e.mul(e.trunc(n),r);if((0,o.isErrorOper)(a))return a;const i=e.sub(t,a);return!(0,o.isErrorOper)(i)&&e.cond(t)<0?e.abs(i):i},t.numInt=function(e,t){const r=e.sub(e.trunc(t),t);return(0,o.isNumberOper)(r)&&0===e.cond(r)},t.validateArraySize=function(e,t){if(e*t>1048576)return(0,c.throwEvaluationError)((0,o.notImplemented)(["Very large array size"]))};class F{slice(e,t,r,a){const{row:i,col:o}=this.oper.ranges[0];return(0,n.range3DOper)(this.oper.sheets,(0,d.gridRange)(i+e,o+r,t,a))}constructor(e){this.oper=e;const{rows:t,cols:r}=e.ranges[0];this.rows=t,this.cols=r}}t.RangeSlicer=F;class y{slice(e,t,r,a){return(0,n.arrayOper)(t,a,this.oper.opers.slice(e,e+t).map((e=>e.slice(r,r+a))))}constructor(e){this.oper=e,this.rows=e.opers.length,this.cols=e.opers[0].length}}t.ArraySlicer=y,t.makeSlicer=function(e){return(0,o.isArrayOper)(e)?new y(e):new F(e)},t.rangeOrArrayToVal=function(e,t){return(0,o.isRangeOper)(e)?e.ranges.length>1?t:((0,i.assertTrue)("calc.funcs.rangeOrArrayToVal: not 3D ref",(0,o.isSheetIndex)(e.sheets)),e):e},t.getAbsoluteIndex=function(e,t){return(0,i.assertTrue)("calc.funcs.getAbsoluteIndex",(0,g.isInteger)(t)&&0!==t&&t<=e&&t>=-e),t>0?t-1:e+t}},93440:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.today=t.now=t.randarray=t.randbetween=t.rand=void 0;const n=r(70633),a=r(88435),i=r(92158),o=r(10919),s=r(11181),u=r(18612);function l(e,t,r){const n=e.mathpack,i=(0,a.assertNumber)(n.add(r,n.one));return n.floor(c(e,t,i))}function c(e,t,r){const n=e.mathpack,o=n.sub(r,t),s=e.getRandom();if((0,i.isErrorOper)(o)){const e=n.div(t,n.fromNumber(3)),o=n.div(r,n.fromNumber(3));(0,u.assertTrue)("calc.funcs.getRandomFloatBetween",!(0,i.isErrorOper)(e)&&!(0,i.isErrorOper)(o));const l=n.sub(o,e);return(0,u.assertTrue)("calc.funcs.getRandomFloatBetween",!(0,i.isErrorOper)(l)&&n.cond(l)>=0),(0,a.assertNumber)(n.mul(n.fromNumber(3),(0,a.assertNumber)(n.add(e,(0,a.assertNumber)(n.mul(s,l))))))}return(0,a.assertNumber)(n.add(t,(0,a.assertNumber)(n.mul(s,o))))}t.rand=function(e,t){return e.getRandom()},t.randbetween=function(e,[t,r]){const o=(0,a.chkNumOper)(e,t),s=(0,a.chkNumOper)(e,r);if((0,i.isErrorOper)(o))return o;if((0,i.isErrorOper)(s))return s;const u=e.mathpack;if(u.cond2(o,s)>0)return n.numErrorOper;const l=e.getRandom(),c=u.ceil(o),d=u.floor(s),g=u.sub(d,c);return(0,i.isErrorOper)(g)?g:u.add(u.floor((0,a.assertNumber)(u.mul((0,a.assertNumber)(u.add(g,u.one)),l))),c)},t.randarray=function(e,t){const[r=n.missingOper,o=n.missingOper,u=n.missingOper,d=n.missingOper,g=n.missingOper]=t,m=e.mathpack,h=(0,i.isMissingOper)(r)?1:m.sfix(r),p=(0,i.isMissingOper)(o)?1:m.sfix(o);if(h<0||h>s.sheetRows||p<0||p>s.sheetRows)return n.valueErrorOper;if((0,a.validateArraySize)(h,p),0===h||0===p)return n.calcErrorOper;const f=(0,i.isMissingOper)(u)?m.zero:u,S=(0,i.isMissingOper)(d)?m.one:d;if(m.cond2(f,S)>0)return n.valueErrorOper;const v=!(0,i.isMissingOper)(g)&&g.value;if(v&&(!(0,a.numInt)(m,f)||!(0,a.numInt)(m,S)))return n.valueErrorOper;const F=[];for(let t=0;t<h;t++){const t=[];for(let r=0;r<p;r++){const r=v?l(e,f,S):c(e,f,S);t.push(r)}F.push(t)}return(0,n.arrayOper)(h,p,F)},t.now=function(e,t){return e.getTime(o.TimeGranularity.Instant)},t.today=function(e,t){return e.getTime(o.TimeGranularity.Day)}},39714:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hyperlink=void 0,t.hyperlink=function(e,[t,r]){return e.followHyperlinks?t:r??t}},91282:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WildExp=void 0;const n=r(74643).__importStar(r(33372)),a=r(23262);var i;!function(e){e[e.OP_DOT=-1]="OP_DOT",e[e.OP_DOTSTAR=-2]="OP_DOTSTAR"}(i||(i={}));const{codePointTilde:o,codePointQuestionMark:s,codePointAsterisk:u}=n;t.WildExp=class{pushBlock(e){if(""===e)return;const t=this.blocks.length;this.blocks.push(e),this.bytecode.push(t);for(let t=1;t<e.length;t+=1)this.bytecode.push(i.OP_DOT)}pushMeta(e){e===s?this.bytecode.push(i.OP_DOT):this.bytecode.push(i.OP_DOTSTAR)}test(e){if(void 0!==this.simplePattern)return this.testSimple(e,this.simplePattern);let t=Object.create(null);this.addState(t,0);for(let r=0;r<e.length;r+=1){const n=Object.keys(t);if(t=Object.create(null),0===n.length)return!1;for(let a=0;a<n.length;a+=1){const o=Number(n[a]);if(o===this.bytecode.length)continue;const s=this.bytecode[o];switch(s){case i.OP_DOT:this.addState(t,o+1);break;case i.OP_DOTSTAR:this.addState(t,o);break;default:const n=this.blocks[s];r+n.length<=e.length&&0===this.localeInfo.stringCompareCI(n,e.substring(r,r+n.length))&&this.addState(t,o+1)}}}return this.bytecode.length in t}addState(e,t){e[t]=!0;const r=this.bytecode;for(let n=t;n<r.length&&r[n]===i.OP_DOTSTAR;n+=1)e[n+1]=!0}testSimple(e,t){return t.length<=e.length&&(t.length===e.length||this.appendWildcard)&&0===this.localeInfo.stringCompareCI(t,e.substring(0,t.length))}constructor(e,t,r=!1){this.localeInfo=e,this.source=t,this.appendWildcard=r,this.bytecode=[],this.blocks=[];let n="";for(let e=0;e<t.length;e+=1){const r=t.charCodeAt(e);if(r===o&&e+1<t.length){const r=(0,a.stringCodePointAt)(t,e+1);n+=(0,a.stringFromCodePoint)(r),e+=(0,a.numCodeUnits)(r)}else r!==o&&(r!==s&&r!==u?n+=t.charAt(e):(this.pushBlock(n),n="",this.pushMeta(r)))}0===this.bytecode.length&&(this.simplePattern=n),this.pushBlock(n),r&&this.pushMeta(u)}}},42459:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nextFuncs=t.wildcard=t.webFuncs=t.volatileFuncs=t.funcsUtil=t.funcsTestUtils=t.stringFuncs=t.referenceFuncs=t.reduce=t.recordFuncs=t.rangeFuncs=t.predicateFuncs=t.numfmtFuncs=t.mathFuncs=t.lookupFuncs=t.logicalFuncs=t.lambdaFuncs=t.informationFuncs=t.getWorksheetFuncModule=t.engineeringFuncs=t.dateTimeFuncs=t.criteria=t.aggregationFuncs=t.visitedMap=t.value=t.util=t.testUtils=t.term=t.serviceTypes=t.rtree=t.machine=t.extensionTypes=t.evaluatorService=t.evalTypes=t.evalFormula=t.evalCell=t.evalRuntime=t.evalFunction=t.operatorsModule=t.dereferenceModule=t.compilerService=t.coerce=t.calcChain=t.PackageName=void 0;const n=r(74643);t.PackageName="excel-online-calc-runtime",t.calcChain=n.__importStar(r(3354)),t.coerce=n.__importStar(r(47267)),t.compilerService=n.__importStar(r(97392)),t.dereferenceModule=n.__importStar(r(41200)),t.operatorsModule=n.__importStar(r(95625)),t.evalFunction=n.__importStar(r(17384)),t.evalRuntime=n.__importStar(r(76950)),t.evalCell=n.__importStar(r(50468)),t.evalFormula=n.__importStar(r(65176)),t.evalTypes=n.__importStar(r(31663)),t.evaluatorService=n.__importStar(r(4982)),t.extensionTypes=n.__importStar(r(64316)),t.machine=n.__importStar(r(98677)),t.rtree=n.__importStar(r(57186)),t.serviceTypes=n.__importStar(r(59370)),t.term=n.__importStar(r(66096)),t.testUtils=n.__importStar(r(45077)),t.util=n.__importStar(r(36094)),t.value=n.__importStar(r(7625)),t.visitedMap=n.__importStar(r(64462)),t.aggregationFuncs=n.__importStar(r(46478)),t.criteria=n.__importStar(r(52182)),t.dateTimeFuncs=n.__importStar(r(3387)),t.engineeringFuncs=n.__importStar(r(89745)),t.getWorksheetFuncModule=n.__importStar(r(57837)),t.informationFuncs=n.__importStar(r(76066)),t.lambdaFuncs=n.__importStar(r(17569)),t.logicalFuncs=n.__importStar(r(657)),t.lookupFuncs=n.__importStar(r(32058)),t.mathFuncs=n.__importStar(r(46866)),t.numfmtFuncs=n.__importStar(r(7449)),t.predicateFuncs=n.__importStar(r(34343)),t.rangeFuncs=n.__importStar(r(60747)),t.recordFuncs=n.__importStar(r(71251)),t.reduce=n.__importStar(r(87665)),t.referenceFuncs=n.__importStar(r(95771)),t.stringFuncs=n.__importStar(r(60383)),t.funcsTestUtils=n.__importStar(r(92890)),t.funcsUtil=n.__importStar(r(88435)),t.volatileFuncs=n.__importStar(r(93440)),t.webFuncs=n.__importStar(r(39714)),t.wildcard=n.__importStar(r(91282)),t.nextFuncs=n.__importStar(r(16427))},39141:function(e,t,r){"use strict";const n=r(84817);e.exports=n.adjust},66785:function(e,t,r){"use strict";const n=r(84817);e.exports=n.cellFormat},19552:function(e,t,r){"use strict";const n=r(84817);e.exports=n.config},10919:function(e,t,r){"use strict";const n=r(84817);e.exports=n.datepack},69210:function(e,t,r){"use strict";const n=r(84817);e.exports=n.formulaModule},11181:function(e,t,r){"use strict";const n=r(84817);e.exports=n.location},66269:function(e,t,r){"use strict";const n=r(84817);e.exports=n.numfmt},59884:function(e,t,r){"use strict";const n=r(84817);e.exports=n.printService},51675:function(e,t,r){"use strict";const n=r(84817);e.exports=n.printServiceTypes},70221:function(e,t,r){"use strict";const n=r(84817);e.exports=n.resolveService},184:function(e,t,r){"use strict";const n=r(84817);e.exports=n.resolveServiceTypes},59242:function(e,t,r){"use strict";const n=r(84817);e.exports=n.signature},58385:function(e,t,r){"use strict";const n=r(84817);e.exports=n.testUtil},79673:function(e,t,r){"use strict";const n=r(84817);e.exports=n.types},92158:function(e,t,r){"use strict";const n=r(84817);e.exports=n.util},70633:function(e,t,r){"use strict";const n=r(84817);e.exports=n.value},44470:function(e,t,r){"use strict";const n=r(84817);e.exports=n.visitor},13597:function(e,t,r){"use strict";const n=r(64562);e.exports=n.formatService},60443:function(e,t,r){"use strict";const n=r(64562);e.exports=n.knownFormat},75811:function(e,t,r){"use strict";const n=r(64562);e.exports=n.serviceTypes},44079:function(e,t,r){"use strict";const n=r(64562);e.exports=n.util},72189:function(e,t,r){"use strict";const n=r(55174);e.exports=n.parserService},10087:function(e,t,r){"use strict";const n=r(55174);e.exports=n.parseServiceTypes},3354:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IterativeRecalcState=t.cellRead=t.cellWrite=t.rangeWrite=t.TransactionLogMessageKind=t.TransactionLog=t.WriteResultKind=void 0;const n=r(11181),a=r(57186),i=r(71766),o=r(64462),s=r(36094),u=r(92158);var l,c;!function(e){e[e.Next=0]="Next",e[e.Done=1]="Done",e[e.CellWriteLimitReached=2]="CellWriteLimitReached",e[e.CellCycle=3]="CellCycle"}(l||(t.WriteResultKind=l={}));class d{forEachMeets(e,t){const r=this.state[e.sheet.index];void 0!==r&&r.forEachMeets(e.range,t)}setValue(e,t){const r=this.state[e.sheet.index]??(0,a.makeGridRangeTable)();return new d({...this.state,[e.sheet.index]:r.setValue(e.range,t)})}constructor(e){this.state=e}}d.empty=()=>new d({});class g{extract(){return this.log}lookup(e){const t=[];return void 0!==this.current&&(this.current.previousVersions.forEachMeets(e,((e,r)=>(t.push(r),!0))),g.meets(e,this.current.range)&&t.push(this.current)),t}get current(){return this.log[this.log.length-1]}get size(){return this.log.length}insert(e,t){if(void 0===this.current)return void this.log.push({version:0,range:e,message:t,previousVersions:d.empty()});const r={version:this.current.version+1,range:e,message:t,previousVersions:this.current.previousVersions.setValue(this.current.range,this.current)};this.log.push(r)}rollBack(e){if(void 0===this.current)return!1;let t;return this.current.previousVersions.forEachMeets(e,((e,r)=>((void 0===t||r.version<t.version)&&(t=r),!0))),void 0===t?!!g.meets(e,this.current.range)&&(this.truncLog(this.log.length-1),!0):(this.truncLog(t.version),!0)}truncLog(e){this.log.length=(0,i.fastMax)(e,0)}static meets(e,t){return e.sheet.index===t.sheet.index&&(0,u.gridRangeIsects)(e.range,t.range)}constructor(){this.log=[]}}function m(e,t){return{kind:c.RangeWrite,range:e,opers:t}}function h(e,t){return{kind:c.CellWrite,cell:e,oper:t}}t.TransactionLog=g,function(e){e[e.RangeWrite=0]="RangeWrite",e[e.CellWrite=1]="CellWrite",e[e.CellRead=2]="CellRead"}(c||(t.TransactionLogMessageKind=c={})),t.rangeWrite=m,t.cellWrite=h,t.cellRead={kind:c.CellRead};const p={kind:l.CellWriteLimitReached};t.IterativeRecalcState=class{registerVisibleCells(e){for(const t of e)this.ensureNeedsVisit(t);return{kind:l.Next,address:this.address}}registerDynamicDependency(e){for(const t of e){const e={cell:t,previous:this.visitedCells.current,cycle:void 0},r=this.visitedCells.map.getValue(t);if(void 0!==r)return(0,o.recordCellCycle)(r,this.visitedCells.current),{kind:l.CellCycle,cycle:r.cycle};this.workStack.push([t,(0,o.appendVisitedCell)(this.visitedCells,e)]),this.ensureNeedsVisit(t)}return{kind:l.Next,address:this.address}}registerRead(){return 0===this.transactionLog.lookup(this.address).length&&this.transactionLog.insert(this.address,t.cellRead),this.next()}writeRange(e){const{sheet:t,range:{row:r,col:a}}=this.address,i=(0,n.sheetGridRange)(t,(0,n.gridRange)(r,a,e.length,e[0].length));return this.write(i,m(i,e))}writeCell(e){return this.write(this.address,h(this.address,e))}get address(){return this.workStack[this.workStack.length-1][0]}get visitedCells(){return this.workStack[this.workStack.length-1][1]}get grid(){return this.transactionLog}get remainingWork(){return this.workStack}incrementCellWriteCount(e){const t=this.ensureNeedsVisit(e);if(t[1]+=1,t[1]>10)return p}ensureNeedsVisit(e){let t=this.anchorVisitCounts[e.sheet.index];return void 0===t&&(t=this.anchorVisitCounts[e.sheet.index]={}),t[(0,s.gridRangeAnchorHash)(e.range)]=t[(0,s.gridRangeAnchorHash)(e.range)]??[e,0]}write(e,t){if(this.transactionLog.rollBack(e))return{kind:l.Next,address:this.address};const r=this.incrementCellWriteCount(this.address);return void 0!==r?r:(this.transactionLog.insert(e,t),this.next())}next(){for(;this.workStack.length>1;)if(this.workStack.pop(),0===this.transactionLog.lookup(this.address).length)return{kind:l.Next,address:this.address};if(0===this.transactionLog.lookup(this.address).length)return{kind:l.Next,address:this.address};const e=this.unevaluatedVisibleRanges();if((0,i.safePush)(this.workStack,e),e.length>0)return{kind:l.Next,address:this.address};const t=[],r=[];for(const e of this.transactionLog.extract())switch(e.message.kind){case c.CellWrite:t.push([e.message.cell,e.message.oper]);break;case c.RangeWrite:r.push([e.range,e.message.opers])}return{kind:l.Done,cellWrites:t,rangeWrites:r}}unevaluatedVisibleRanges(){const e=[];for(const t in this.anchorVisitCounts)for(const r in this.anchorVisitCounts[t]){const[n]=this.anchorVisitCounts[t][r];0===this.transactionLog.lookup(n).length&&e.push([n,o.emptyVisitedCells])}return e}constructor(e){this.transactionLog=new g,this.anchorVisitCounts={},this.workStack=[[e,o.emptyVisitedCells]]}}},47267:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.coerceOper=void 0;const n=r(36094),a=r(31663),i=r(79673),o=r(70633),s=r(75811),u=r(92158),l=r(43376),c=r(36094),d=r(18612);function g(e,t){return 0!=(t&i.OperKind.Number)?e.zero:0!=(t&i.OperKind.String)?c.emptyStringOper:0!=(t&i.OperKind.Boolean)?o.falseOper:o.valueErrorOper}function m(e,t,r){const{localeInfo:n,mathpack:c}=e.globals.config;if(0!=(r&t.kind))return t;if((0,u.isNumberOper)(t)){if(0!=(r&i.OperKind.String)){const e=20;return(0,o.stringOper)(c.formatGeneral(n,t,e))}return 0!=(r&i.OperKind.Boolean)?(0,o.booleanOper)(0!==c.cond(t)):0!=(r&i.OperKind.Array)?(0,o.arrayOper)(1,1,[[t]]):o.valueErrorOper}if((0,u.isStringOper)(t)){if(0!=(r&i.OperKind.Number)){if(0===t.value.length)return o.valueErrorOper;if(t.value.length>255)return o.valueErrorOper;const r=e.numberFormatter.parseGeneral(t.value,!1,!0,s.GetTimeKind.NonVolatile);return(0,l.isSuccess)(r)||(0,a.throwEvaluationError)(r.reason),void 0!==r.value?r.value.value:o.valueErrorOper}if(0!=(r&i.OperKind.Boolean)){if(0===n.stringCompareCI(t.value,n.trueName))return o.trueOper;if(0===n.stringCompareCI(t.value,n.falseName))return o.falseOper}return 0!=(r&i.OperKind.Array)?(0,o.arrayOper)(1,1,[[t]]):o.valueErrorOper}if((0,u.isBooleanOper)(t))return 0!=(r&i.OperKind.Number)?t.value?c.one:c.zero:0!=(r&i.OperKind.String)?(0,o.stringOper)(t.value?n.trueName:n.falseName):0!=(r&i.OperKind.Array)?(0,o.arrayOper)(1,1,[[t]]):o.valueErrorOper;switch(t.kind){case i.OperKind.Error:return t;case i.OperKind.Missing:return 0!=(r&i.OperKind.Blank)?o.blankOper:g(c,r);case i.OperKind.Blank:return g(c,r);case i.OperKind.Rich:return 0!=(r&i.OperKind.Array)?(0,o.arrayOper)(1,1,[[t]]):m(e,t.getFallback(),r);case i.OperKind.Range:case i.OperKind.Array:return o.valueErrorOper;default:return(0,d.assertNever)("calc.runtime.coerceOper",t)}}t.coerceOper=function(e,t,r){const a=m(e,t,r);return(0,u.isErrorOper)(a)&&!(0,u.isErrorOper)(t)&&(0,n.traceErrorOper)("calc.runtime.coerceOper",a.type,`kind = ${t.kind}`),a}},97392:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createCompiler=t.compiledFormulaTerm=t.compiledFormula=void 0;const n=r(84949),a=r(18612),i=r(66096),o=r(59370),s=r(36094),u=r(69210),l=r(92158),c=r(59242),d=r(77981),g=r(70633),m=r(43376),h=r(44470),p=r(71766),f=r(56497),S=r(11181),v=r(3825),F=r(70221),y=(0,l.createFailureErrorClass)("CompileError"),C=(0,s.makeStrict)((0,c.getWorksheetFuncType)(c.WorksheetFuncId.IF)),A=(0,s.makeStrict)((0,c.getWorksheetFuncType)(c.WorksheetFuncId.CHOOSE));function E(e){return(0,i.isOperTerm)(e)&&(0,l.isWriteOper)(e)}class b{literalNode(e,t,r){return f.Pledge.resolve(this.noopTerm(e,r))}arrayNode(e,t,r){return f.Pledge.all(e.map((e=>f.Pledge.all(e.map(this.lazyVisitFormulaNode))))).bind((e=>this.toArrayTerm(e,r)))}toArrayTerm(e,t){const r=e.length,n=void 0===e[0]?0:e[0].length,a=e.map((e=>e.map((e=>e.kind===i.TermKind.Noop?e.children:e))));return a.every((e=>e.every(E)))?this.noopTerm((0,g.arrayOper)(r,n,a),t):(0,i.arrayTerm)(r,n,e,t)}appNode(e,t,r,n){const o=this.context.annotations[n]?.kind===u.AnnotationKind.FormulaRoot;if((0,l.isOperatorNode)(e)){const r=(0,c.getOperatorType)(e.id);return f.Pledge.all(t.map(this.lazyVisitFormulaNode)).bind((t=>(0,i.appTerm)((0,i.operatorIdToName)(e.id),r,o,void 0,t,n)))}const s=(0,l.getArguments)(t);if((0,l.isWSFNode)(e)){const{id:t}=e;switch(t){case c.WorksheetFuncId.IFERROR:case c.WorksheetFuncId.IFNA:{(0,a.assertTrue)("calc.runtime.toIfPredicateTerm: expected wff",2===s.length);const[e,r]=s,i=new b({...this.context,numNames:this.context.numNames+1});return f.Pledge.all([this.lazyVisitFormulaNode(e),f.Pledge.try((()=>(0,h.visitFormulaNode)(i,r)))]).bind((([e,r])=>this.toIfPredicateTerm(t===c.WorksheetFuncId.IFERROR?c.WorksheetFuncId.ISERROR:c.WorksheetFuncId.ISNA,e,r,n)))}case c.WorksheetFuncId._UDF:return(0,a.assertFalse)("calc.runtime.appNode: expected wff (not UDF)")}return f.Pledge.all(s.map(this.lazyVisitFormulaNode)).bind((e=>{switch(t){case c.WorksheetFuncId.IF:return this.toIfTerm(e,n);case c.WorksheetFuncId.CHOOSE:return this.toChooseTerm(e,n)}const r=(0,c.getWorksheetFuncType)(t);return(0,i.appTerm)((0,i.worksheetFunctionIdToName)(t),r,!1,void 0,e,n)}))}return this.lazyVisitFormulaNode(e).bind((e=>f.Pledge.all(s.map(this.lazyVisitFormulaNode)).bind((t=>this.toAppTerm(e,t,n)))))}toIfPredicateTerm(e,t,r,n){const a=(0,i.readStackTerm)(0,void 0),o=(0,i.conditionalTerm)((0,i.worksheetFunctionIdToName)(c.WorksheetFuncId.IF),C,!1,(0,i.appTerm)((0,i.worksheetFunctionIdToName)(e),(0,c.getWorksheetFuncType)(e),!1,void 0,[a],void 0),[r,a],void 0);return(0,i.letTerm)([t],!1,[void 0],o,n)}toIfTerm(e,t){switch(e.length){case 3:return(0,i.conditionalTerm)((0,i.worksheetFunctionIdToName)(c.WorksheetFuncId.IF),C,!1,e[0],[e[1],e[2]],t);case 2:return(0,i.conditionalTerm)((0,i.worksheetFunctionIdToName)(c.WorksheetFuncId.IF),C,!1,e[0],[e[1],g.falseOper],t);case 1:throw new y((0,l.notImplemented)(["single-argument IF"]));default:return(0,a.assertFalse)("calc.runtime.toIfTerm: expected wff")}}toChooseTerm(e,t){return(0,a.assertTrue)("calc.runtime.toChooseTerm: expected wff",e.length>=1),(0,i.conditionalTerm)((0,i.worksheetFunctionIdToName)(c.WorksheetFuncId.CHOOSE),A,!1,e[0],e.slice(1),t)}toAppTerm(e,t,r){return(0,i.appTerm)((0,i.worksheetFunctionIdToName)(c.WorksheetFuncId._UDF),(0,c.higherOrderFunctionType)(),!1,void 0,[e,...t],r)}letNode(e,t,r,n,s,u){const l=e.id===c.WorksheetFuncId.LETREC||e.id!==c.WorksheetFuncId.LET&&(0,a.assertFalse)("calc.runtime.compile");(0,a.assertTrue)("calc.runtime.letNode: expected wff",void 0!==r);const d=this.bindNames(t),g=d[t.length],m=t.map((({name:e})=>e.arg.label));let p;return p=l?f.Pledge.all(t.map((({binder:e})=>f.Pledge.try((()=>(0,h.visitFormulaNode)(g,e.arg)))))):f.Pledge.all(t.map((({binder:e},t)=>{const r=d[t];return f.Pledge.try((()=>(0,h.visitFormulaNode)(r,e.arg)))}))),p.bind((e=>(0,h.visitFormulaNode)(g,r.arg).bind((r=>(0,i.letTerm)(e.map(((e,r)=>this.noopTerm(e,(0,o.runtimePositionLetVal)(t[r].name.arg.label,t[r].binder.arg.label)))),l,m,r,u)))))}lambdaNode(e,t,r,n,o,s){(0,a.assertTrue)("calc.runtime.lambdaNode: expected wff",void 0!==r);const u=this.bindNames(t),l=u[t.length],c=t.reduce(((e,{name:t},r)=>(0,p.fastMax)(e,t.arg.isOptional?0:r+1)),0),d=t.length;return f.Pledge.all(t.map((({name:e},t)=>{if(void 0===e.arg.def)return f.Pledge.resolve(void 0);const r=u[t],n=e.arg.def.rhs;return f.Pledge.try((()=>(0,h.visitFormulaNode)(r,n)))}))).bind((e=>(0,h.visitFormulaNode)(l,r.arg).bind((r=>{const n=[...e.map(((e,t)=>[e,t])).filter((e=>void 0!==e[0])).map((([e])=>e)),r];return(0,i.lambdaTerm)((e=>e>=c&&e<=d),t.map((({name:e})=>({paramNodeLabel:e.arg.label,paramNameLabel:e.arg.name.name.label,hasDef:void 0!==e.arg.def,isRest:!1}))),n,s)}))))}bindNames(e){const t=this.context.numNames,r=[this];return e.reduce(((e,{name:n},i)=>{(0,a.assertTrue)("calc.runtime.bindNames: expected wff",void 0!==n.arg.wholeName);const o=e.setValue((0,l.getBoundName)(this.context.localeInfo,n.arg.wholeName),t+i);return r.push(new b({...this.context,names:o,numNames:t+i+1})),o}),this.context.names),r}parenNode(e,t,r){return this.lazyVisitFormulaNode(e).bind((e=>this.noopTerm(e,r)))}nameNode(e,t,r){const n=this.context.annotations[r]?.kind===u.AnnotationKind.AppHeadName;return f.Pledge.resolve(this.toNameTerm(e,t,n))}toNameTerm(e,t,r){const{locals:n,names:s,numNames:d}=this.context,g=(0,u.flattenNameParts)(e).parts;if((0,F.canDenoteLocalName)(t,g)){const[e,...t]=g,r=s.getEntry((0,l.getBoundName)(this.context.localeInfo,e.asWhole));if(void 0!==r){const n=r.value,a=(0,i.readStackTerm)(d-n-1,e.qualifiedLabel);return f.Pledge.resolve(t.reduce(((e,t)=>this.toFieldRefTerm(e,t.rhs.field.whole,t.qualifiedLabel)),a))}}let m;if(null==t&&(0,v.getTypedFeatureGate)("Microsoft.Office.Excel.CalcEtaLambda")&&(0,v.getTypedFeatureGate)("Microsoft.Office.Excel.EtaReducedLambdas")){const t=(0,l.getEtaFuncId)(this.context.localeInfo,e.asWhole);if(void 0!==t){const r={...(0,c.getWorksheetFuncType)(t)};r.maxArgs=(0,p.fastMin)(254,r.maxArgs),m=(0,i.lambdaTerm)((e=>(0,l.isValidArgsLength)(r,e)),[{paramNodeLabel:void 0,paramNameLabel:void 0,hasDef:!1,isRest:!0}],[(0,i.appTerm)((0,i.worksheetFunctionIdToName)(t),r,!1,[{isSpread:!0}],[(0,i.readStackTerm)(0,void 0)],(0,o.runtimePositionEtaLambdaBody)(t))],e.qualifiedLabel)}}if((0,F.canDenoteCellRef)(n,t,g)){const[e,...r]=g,n=null!=t&&t.kind===u.QualifierKind.Ident?(0,u.sheetQualifier)(t.name,void 0,t.isQuoted,t.label):t,a=(0,i.cellRefTerm)(e.ref,n,e.qualifiedLabel);m=r.reduce(((e,t)=>this.toFieldRefTerm(e,t.rhs.field.whole,t.qualifiedLabel)),a)}return(0,F.canDenoteUserDefinedFunc)(r,t,e)&&(m=(0,i.udfTerm)(e.asWhole,t,m,e.qualifiedLabel)),e.canDenoteNamedObject&&(m=(0,i.nameTerm)(e.asWhole,t,r?S.NameSource.AppHead:S.NameSource.Plain,m,e.qualifiedLabel)),(0,a.assertTrue)("calc.runtime.compile: expected wff NameNode",void 0!==m),f.Pledge.resolve(m)}cellRefNode(e,t,r){return f.Pledge.resolve((0,i.cellRefTerm)(e,t,r))}fieldRefNode(e,t,r){(0,a.assertTrue)("calc.runtime.compile: expected wff FieldRef",t.field.kind===u.NodeKind.Ident);const n=t.field.whole;return this.lazyVisitFormulaNode(e).bind((e=>this.toFieldRefTerm(e,n,r)))}toFieldRefTerm(e,t,r){const n=c.WorksheetFuncId.FIELDVALUE;return(0,i.appTerm)((0,i.worksheetFunctionIdToName)(n),(0,c.getWorksheetFuncType)(n),!1,void 0,[e,(0,g.stringOper)(t)],r)}noopTerm(e,t){return this.context.locals.emitStepInfo?(0,i.noopTerm)(e,t):e}structRefNode(e,t,r){return f.Pledge.resolve((0,i.structRefTerm)((0,u.structRefNode)(e,t,r),r))}missingNode(e,t){return(0,a.assertFalse)("calc.runtime.compile: unexpected missing node")}badSequenceNode(e,t,r){return(0,a.assertFalse)("calc.runtime.compile: unexpected bad node")}badCharsNode(e,t,r){return(0,a.assertFalse)("calc.runtime.compile: unexpected bad node")}operatorNode(e,t){return f.Pledge.resolve((0,u.operatorNode)(e,t))}wsfNode(e,t,r){return f.Pledge.resolve((0,u.wsfNode)(e,t,r))}constructor(e){this.context=e,this.visitFormulaNode=e=>(0,h.visitFormulaNode)(this,e),this.lazyVisitFormulaNode=e=>f.Pledge.resolve(e).bind(this.visitFormulaNode)}}const R={[c.OperatorId.At]:c.WorksheetFuncId.SINGLE,[c.OperatorId.Pound]:c.WorksheetFuncId.ANCHORARRAY},T=[function(e){if(!(0,i.isOperTerm)(e)&&e.kind===i.TermKind.App&&(0,i.isOperatorName)(e.data.funName)){const t=R[(0,i.operatorNameToId)(e.data.funName)];if(void 0!==t)return(0,i.appTerm)((0,i.worksheetFunctionIdToName)(t),(0,c.getWorksheetFuncType)(t),e.data.isFormulaRoot,e.data.args,e.children,e.position)}return e}],k=(e,t)=>t(e),N=e=>T.reduce(k,e);function I(e,t){return{...e,term:t}}t.compiledFormula=I,t.compiledFormulaTerm=function(e,t){return"object"!=typeof t.term?(0,a.assertFalse)(`${e}: expected known compiled formula type; given ${(0,n.anonymize)(t)}`):t.term},t.createCompiler=function(e){return{compileFormula:(t,r)=>function(e,t,r){try{const a=t.config?.localeInfo??e.config.localeInfo,{names:o,numNames:s}=function(e,t){const r=t.annotations[t.node.label],n=d.RedBlackMapTree.create(e.stringCompareCI);if(r?.kind===u.AnnotationKind.FormulaRoot){const{contextNames:t=[]}=r;return{names:t.reduce(((t,r,n)=>t.setValue((0,l.getBoundName)(e,r.whole),n)),n),numNames:t.length}}return{names:n,numNames:0}}(a,r),c={globals:e,locals:t,localeInfo:a,annotations:r.annotations,names:o,numNames:s},g=(n=(0,h.reducePledge)(new b(c),r),(0,i.transformBottomUp)(n,N));return(0,m.success)(I(r,g))}catch(e){return e instanceof y?(0,m.failure)(e.reason):(0,m.failure)((0,m.javaScriptError)(e))}var n}(e,t,r)}}},41200:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dereferenceOpers=t.dereferenceOper=t.dereference=t.getCellValuesAsArray=void 0;const n=r(18612),a=r(3825),i=r(93371),o=r(84949),s=r(59370),u=r(31663),l=r(98677),c=r(36094),d=r(82438),g=r(70633),m=r(71766),h=r(92158),p=r(11181),f=r(64462),S=r(79673),v=r(43376),F=16;function y(e,t){const r=t.map.getValue(e);if(void 0!==r){const e=(0,f.recordCellCycle)(r,t.current);return(0,u.throwEvaluationError)(e)}}function C(e,t,r){e.precedents.cells.push(t);const n=e.globals.getCellValue(t);if(n.kind===v.ResultKind.Failure)return(0,u.throwEvaluationError)(n.reason);const a=n.value;if(a.kind===s.CellKind.FinalValue)return a.oper;y(a.anchor,e.visitedCells),r.push(a.anchor)}function A(e,t,r,a){let o;if(e.precedents.cells.push(t),!a||(0,h.gridRangeSize)(t.range)<=F)o=t;else{const r=e.globals.getUsedRange(t.sheet);let n;(0,v.isSuccess)(r)?n=null==r.value?void 0:r.value.range:(0,u.throwEvaluationError)(r.reason);const a=void 0===n?void 0:(0,h.gridRangeIsect)(t.range,(0,p.gridRange)(0,0,n.row+n.rows,n.col+n.cols));if(void 0===a)return new i.StrictSparseArray2D(t.range.rows,t.range.cols,0,0,[],g.blankOper);o=(0,p.sheetGridRange)(t.sheet,a)}const l=e.globals.getCellValues(o);if(l.kind===v.ResultKind.Failure)return(0,u.throwEvaluationError)(l.reason);const c=r.length,d=function(e,t,r,a,o){const u=[],l=a.length;let c=0;(0,n.assertTrue)("calc.runtime.deference: readIntoArray2D number of rows",l===r.rows);for(let i=0;i<l;i+=1){u.push([]);const l=a[i].length;(0,n.assertTrue)("calc.runtime.deference: readIntoArray2D number of cols",l===r.cols),c=0===i?l:(0,m.fastMin)(l,c);for(let r=0;r<l;r+=1){const l=a[i][r];s.CellKind.FinalValue===l.kind?u[i][r]=l.oper:(y(l.anchor,e.visitedCells),(0,n.assertTrue)("calc.runtime.deference: readIntoArray2D correct sheet",(0,h.isSheetIndexEqual)(l.anchor.sheet,t.sheet)),o.push(l.anchor),u[i][r]=g.refErrorOper)}}return new i.StrictSparseArray2D(t.range.rows,t.range.cols,l,c,u,g.blankOper)}(e,t,o.range,l.value,r);return c===r.length?d:void 0}function E(e,t,r){const n=A(e,t,r,!1);if(null!=n)return(0,g.arrayOper)(n.rows,n.cols,n.rows===n.denseRows&&n.cols===n.denseCols?n.denseElements:(0,i.array2DToJaggedArray)(n))}function b(e,t,r,n){if(0!=(r&S.OperKind.Range))return t;if(!(0,h.isRangeOper)(t))return t;const i=t.sheets;if(!(0,h.isSheetIndex)(i))return(0,c.traceErrorOper)("calc.runtime.dereference",g.ErrorType.REF,`3D range, oper = ${(0,o.anonymize)(t)}`),g.refErrorOper;if(1!==t.ranges.length)return(0,c.traceErrorOper)("calc.runtime.dereference",g.ErrorType.VALUE,`union range, oper = ${(0,o.anonymize)(t)}`),g.valueErrorOper;const s=t.ranges[0];if(0!=(r&l.singleReadOperType)){if((0,h.isGridCell)(s))return C(e,(0,p.sheetGridCell)(i,s),n);if(e.locals.implicitIntersect&&(0,a.isFeatureEnabled)(a.FeatureName.CalcLegacyImplicitIntersection)&&!(0,a.isFeatureEnabled)(a.FeatureName.CalcPreventSpillingHack)){const r=e.locals.originGridCell;if(!(0,v.isSuccess)(r))return(0,u.throwEvaluationError)(r.reason);const a=(0,h.gridCellImplicitIsect)(r.value,s);return null==a?((0,c.traceErrorOper)("calc.runtime.dereference",g.ErrorType.VALUE,`empty intersection, oper = ${(0,o.anonymize)(t)}`),g.valueErrorOper):C(e,(0,p.sheetGridCell)(i,a),n)}return E(e,(0,p.sheetGridRange)(i,s),n)}return 0!=(r&S.OperKind.Array)?E(e,(0,p.sheetGridRange)(i,s),n):((0,c.traceErrorOper)("calc.runtime.dereference",g.ErrorType.VALUE,`bad target type ${r}`),g.valueErrorOper)}t.getCellValuesAsArray=A,t.dereference=b,t.dereferenceOper=function(e,t,r){const a=[],i=b(e,t,r,a);if(null==i){if(a.length>0)return(0,u.throwEvaluationError)((0,u.unevaluated)(a));const e=`calc.runtime.dereferenceOper: internal error: expected nonempty anchors; oper = ${(0,o.anonymize)(t)}`;return n.ulsLogger.ULS.assertTag(595980819,d.LogCategory.msoulscat_ES_EWAJS,!1,e)}return i},t.dereferenceOpers=function(e,t,r){const n=[];for(let a=0;a<t.length;a+=1){const i=b(e,t[a],(0,h.getArgType)(r,a,t.length),n);null!=i&&(t[a]=i)}if(n.length>0)return(0,u.throwEvaluationError)((0,u.unevaluated)(n))}},50468:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createCellEvaluationMachine=void 0;const n=r(18612),a=r(59370),i=r(31663),o=r(31663),s=r(98677),u=r(43376),l=r(64462),c=r(64462),d=r(11181),g=r(56497),m=r(70633),h=r(84949),p=r(92158),f=r(36094),S=r(7625),v=r(3825);class F{evalCell(){const e=this.context.globals.getCellValue(this.cell);if(e.kind===u.ResultKind.Failure)return{kind:i.CellEvaluationResultKind.ReadFailure,failure:e};const t=e.value;if(t.kind===a.CellKind.FinalValue)return{kind:i.CellEvaluationResultKind.ReadOper};const r=this.context.globals.getCellFormula(t.anchor);if(r.kind===u.ResultKind.Failure){const e="calc.runtime.CellEvaluationMachine.next: unexpected Failure from getCellFormula";return(0,n.assertFalse)(e)}const d=r.value;if(null==d){const e=`calc.runtime.CellEvaluationMachine.next: client error: expected getCellFormula(${(0,h.anonymize)(t.anchor)}) != null`;return(0,n.assertFalse)(e)}const m=this.visitAnchor(d),p=this.context.createFormulaEvaluationMachine(this.context,this.stepConfig,(0,o.evalLocalsGrid)(m.source),m.precedents,(0,c.appendVisitedCell)(this.visitedCells,m),l.emptyVisitedNames,s.readOperType,d.formula);return g.Pledge.fromMachine(p).bind(this.receiveSuccess(m)).catch(this.receiveFailure(m))}visitAnchor(e){const t=(0,p.sheetGridRangeAnchor)(e.source.range),r=this.visitedCells.map.getValue(t);if(null!=r){const e=`calc.runtime.CellEvaluationMachine.visitAnchor: unexpected visitValue at ${(0,h.anonymize)(t)}; given ${(0,h.anonymize)(r)}`;return(0,n.assertFalse)(e)}return{cell:t,cycle:void 0,previous:this.visitedCells.current,source:e.source,precedents:(0,o.bottomEvalPrecedents)()}}receiveSuccess(e){return t=>{if((0,p.isRangeOper)(t)||(0,p.isMissingOper)(t)){const e=`calc.runtime.CellEvaluationMachine.receiveSuccess: expected ReadOper; given ${(0,h.anonymize)(t)}`;return(0,n.assertFalse)(e)}return this.writeSuccess(e.source,t,e.precedents)}}receiveFailure(e){return t=>{const r=t.kind===a.ReasonKind.PreviousFailure&&void 0!==e.cycle?e.cycle:t;return this.writeFailure(e.source,r,e.precedents)}}writeSuccess(e,t,r){return this.setCellValue(e,t,r),{kind:i.CellEvaluationResultKind.WroteOper,source:e}}writeFailure(e,t,r){return this.context.globals.setCellFailure(e.range,t,r),{kind:i.CellEvaluationResultKind.WroteFailure,source:e}}setCellValue(e,t,r){const n=this.context.globals.config.mathpack.zero,a=(0,p.isBlankOper)(t)?n:t;if(e.kind===d.LexicalKind.Cell){if((0,p.isArrayOper)(a)){const t=void 0===a.opers[0]?m.naErrorOper:a.opers[0][0],i=(0,p.isBlankOper)(t)?n:t;if(!this.isLambdaEnabled(e,i,r))return;return this.context.globals.setCellValue(e.range,i,r)}if(!this.isLambdaEnabled(e,a,r))return;return this.context.globals.setCellValue(e.range,a,r)}const i=e.range.range,o=(0,f.broadcastWriteOper)(i.rows,i.cols,a).opers,s=e=>(0,p.isBlankOper)(e)?n:e,u=o.map((e=>e.map(s)));if(this.isLambdaEnabled(e,u,r))return this.context.globals.setCellValues(e.range,u,r)}isLambdaEnabled(e,t,r){return!((Array.isArray(t)?t.some((e=>e.some((e=>e instanceof S.LambdaOper)))):t instanceof S.LambdaOper)&&!(0,v.isFeatureEnabled)(v.FeatureName.CalcLambdaCellValues)&&(this.context.globals.setCellFailure(e.range,(0,p.notImplemented)(["LAMBDA cell values"]),r),1))}constructor(e,t,r,n){this.context=e,this.stepConfig=t,this.visitedCells=r,this.cell=n}}t.createCellEvaluationMachine=function(e,t,r,n){return g.Pledge.try((()=>new F(e,t,r,n).evalCell()))}},65176:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createCallTermEvaluationMachine=t.createFormulaEvaluationMachine=void 0;const n=r(18612),a=r(59370),i=r(31663),o=r(31663),s=r(31663),u=r(31663),l=r(31663),c=r(31663),d=r(71766),g=r(98677),m=r(43376),h=r(64462),p=r(11181),f=r(11181),S=r(70633),v=r(84949),F=r(92158),y=r(36094),C=r(7625),A=r(3825),E=r(66096),b=r(17384),R=r(41200),T=r(79673),k=r(47267),N=r(97392),I=r(36094),O=r(184),_=r(69210),P=r(59242),M=()=>(0,c.throwEvaluationError)((0,F.notImplemented)(["LETREC cycle"]));function D(e,t){return{context:e,holeIndex:0,locals:t}}class w{get globals(){return this.context.globals}get numberFormatter(){return this.context.numberFormatter}next(){try{return this.doNext()}catch(e){if(e instanceof c.EvaluationError)return(0,c.handleEvaluationError)(this.context,this.visitedCells,e.reason);throw e}}receiveResult(e){return(0,m.isSuccess)(e)?this.updateTermTransition(e.value):e}doNext(){if((0,E.isOperTerm)(this.term)){const e=this.continuation;if(0===e.length){(0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.doNext: lambdaDepth correctly decremented",this.usage.lambdaDepth===this.initialLambdaDepth);const e=(0,R.dereferenceOper)(this,this.term,this.target),t=(0,k.coerceOper)(this,e,this.target);return this.precedents.bound=S.PrecsBound.Exact,!(0,A.isFeatureEnabled)(A.FeatureName.CalcPreventSpillingHack)||this.isNested||this.locals.lexicalSource.kind!==f.LexicalKind.Cell||!(0,F.isArrayOper)(t)||1===t.rows&&1===t.cols?(0,m.success)(t):(0,m.failure)((0,F.notImplemented)(["spilling"]))}const t=e[e.length-1];return this.applyContinuation(this.term,t)}return this.reduceFormula(this.term)}applyContinuation(e,t){const r=t.context;switch(r.kind){case E.TermKind.App:{const a=t.holeIndex,i=r.children.length;(0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.applyContinuation",a<=i);const o=t.locals;if(a===i)return(0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.applyContinuation",(0,F.isMissingOper)(e)),this.dispatchFunction(o,r.data,r.position);const s=r.data.args[a]?.isSpread;return!0===s?((0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.applyContinuation",e instanceof b.RestArgsOper),(0,d.safePush)(o,e.opers)):((0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.applyContinuation",!(e instanceof b.RestArgsOper)),o.push(e)),a+1<i?this.nextHoleTransition(t,r.children[a+1]):this.nextHoleTransition(t,S.missingOper)}case E.TermKind.Conditional:{const a=t.holeIndex;if(0===a){const i=(0,E.worksheetFunctionNameToId)(r.data.funName),o=i===P.WorksheetFuncId.IF?T.OperKind.Boolean:T.OperKind.Number;let s=(0,R.dereferenceOper)(this,e,o);if((0,F.isArrayOper)(s))return t.locals=[s],this.nextHoleTransition(t,r.children[a+1]);if((0,F.isRichOper)(s))return(0,m.failure)((0,F.notImplemented)(["IF/CHOOSE with a rich value condition"]));if(s=(0,k.coerceOper)(this,s,o),i===P.WorksheetFuncId.IF&&(0,F.isBooleanOper)(s))return this.popContextTransition(r.children[s.value?1:2]);if(i===P.WorksheetFuncId.CHOOSE&&(0,F.isNumberOper)(s)){const e=this.context.globals.config.mathpack.fix(s);if(e<1||e>r.children.length-1){const t=`CHOOSE; out of bounds option = ${(0,v.anonymize)(e)}`;return(0,I.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.applyContinuation",S.ErrorType.VALUE,t),this.popContextTransition(S.valueErrorOper)}return this.popContextTransition(r.children[e])}return(0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.applyContinuation",(0,F.isErrorOper)(s)),this.popContextTransition(s)}const i=t.locals;return i[a]=e,a+1<r.children.length?this.nextHoleTransition(t,r.children[a+1]):this.dispatchFunction(i,r.data,r.position)}case E.TermKind.CallName:{const r=t.locals;return this.locals=r.locals,this.caller=r.caller,this.restoreStack(r),this.visitedNames=r.visitedNames,this.popContextTransition(e)}case E.TermKind.Let:{const n=t.holeIndex,a=r.children.length-1;if(n>=a){const r=t.locals;return this.restoreStack(r),this.popContextTransition(e)}if(r.data.rec){const t=this.stackEnv.getCount()-a+n;this.stackEnv.getValue(t).value=e,this.stackEnv=this.stackEnv.setValue(t,e)}else this.stackEnv=this.stackEnv.setValue(this.stackEnv.getCount(),e),this.stackMapNumPushed+=1;return n+1>=a&&this.isLetTcoPossible()?this.popContextTransition(r.children[n+1]):this.nextHoleTransition(t,r.children[n+1])}case E.TermKind.Array:{const n=(0,R.dereferenceOper)(this,e,y.writeOperType),{rows:a,cols:i}=r.data,o=t.holeIndex,s=o%i,u=i===s+1,l=(o-s)/i,c=t.locals;if(c[l][s]=(0,k.coerceOper)(this,n,y.writeOperType),a===l+1&&u)return this.popContextTransition((0,S.arrayOper)(a,i,c));const d=u?l+1:l,g=u?0:s+1;return this.nextHoleTransition(t,r.children[d][g])}case E.TermKind.CallLambda:{const r=t.locals;return this.locals=r.locals,this.caller=r.caller,this.restoreStack(r),this.usage.lambdaDepth-=1,this.popContextTransition(e)}case E.TermKind.CallFirstOrderFunc:{const r=t.locals;return this.locals=r.locals,this.caller=r.caller,this.restoreStack(r),this.popContextTransition(e)}case E.TermKind.PostStep:{const r=t.locals;return this.stepConfig?.postStep(r,e),this.popContextTransition(e)}default:return(0,n.assertNever)("calc.runtime.FormulaEvaluationMachine.applyContinuation",r)}}reduceFormula(e){switch(e.kind){case E.TermKind.CellRef:return this.updateTermTransition(this.evalCellRefTerm(e));case E.TermKind.StructRef:return this.updateTermTransition(this.evalStructRefTerm(e));case E.TermKind.App:{const t=e.data.funName;if(!(0,E.isOperatorName)(t)){const e=(0,E.worksheetFunctionNameToId)(t);if(e!==P.WorksheetFuncId._UDF){const t=this.globals.getWorksheetFunc(e);if(t.kind===m.ResultKind.Failure)return(0,c.throwEvaluationError)(t.reason)}}if(0===e.children.length){const r=new b.FunctionDispatcher(this.context,this.stepConfig,this.locals,this.stackFrameList(e.position),this.precedents,this.visitedCells,this.visitedNames,this.usage).dispatchFunction(t,e.data.funType,e.data.isFormulaRoot,[]);return this.updateTermTransition(r)}return this.pushContextTransition(e,e.children[0],[])}case E.TermKind.CallLambda:{const t=this.isCallLambdaTcoPossible();if(this.usage.lambdaCalls[0]+1>(this.globals.limits.maxLambdaCalls??1/0))return(0,c.throwEvaluationError)((0,a.limitExceeded)(a.LimitKind.LambdaCalls));if(!t&&this.usage.lambdaDepth+1>(this.globals.limits.maxLambdaDepth??1/0))return(0,c.throwEvaluationError)((0,a.limitExceeded)(a.LimitKind.LambdaDepth));t||(this.usage.lambdaDepth+=1),this.usage.lambdaCalls[0]+=1;const r=this.stackEnv;this.stackEnv=e.data.capturedStackEnv;const n=this.stackMapList();this.stackMapLabels=void 0,this.stackMapNumPushed=0,this.stackMapNext=e.data.capturedStackMap;const i=this.locals;this.locals=(0,c.evalLocalsLambda)(e.data.capturedLocals,this.locals);const o=this.caller;return this.switchCaller(e.data.caller,t),t?this.updateTermTransition(e.children):this.pushContextTransition(e,e.children,{locals:i,caller:o,stackEnv:r,stackMap:n})}case E.TermKind.CallFirstOrderFunc:{const t=this.locals;this.locals=(0,i.evalLocalsFirstOrderFunc)(e.data.source,this.locals);const r=this.caller;this.switchCaller(e.data.caller,!1);const n=this.stackEnv;this.stackEnv=l.emptyStackEnv;const a=this.stackMapList();return this.stackMapLabels=void 0,this.stackMapNumPushed=0,this.stackMapNext=void 0,this.pushContextTransition(e,e.children,{locals:t,caller:r,stackEnv:n,stackMap:a})}case E.TermKind.CallMachine:return(0,g.callMachineTransition)(e.data.machine,this);case E.TermKind.Conditional:return this.pushContextTransition(e,e.children[0],void 0);case E.TermKind.Let:{const t=e.children.length-1;if(0===t)return this.updateTermTransition(e.children[0]);const r=this.stackEnv,n=this.stackMapList();if(this.stackMapLabels=e.data.varLabels,this.stackMapNumPushed=0,this.stackMapNext=n,e.data.rec){for(let e=0;e<t;e+=1)this.stackEnv=this.stackEnv.setValue(this.stackEnv.getCount(),new l.LazyOper(M));this.stackMapNumPushed+=t}return this.pushContextTransition(e,e.children[0],{stackEnv:r,stackMap:n})}case E.TermKind.Name:return this.updateTermTransition(this.evalNameTerm(e));case E.TermKind.CallName:{const t=e.data.loc,r=this.checkForNameCycle(t),n=this.stackFrameList(e.position),a=this.locals;this.locals=(0,c.evalLocalsName)((0,p.lexicalSourceName)(t),a);const i=this.caller;this.switchCaller(n,!1);const o=this.stackEnv;this.stackEnv=l.emptyStackEnv;const s=this.stackMapList();this.stackMapLabels=void 0,this.stackMapNumPushed=0,this.stackMapNext=void 0;const u=this.visitedNames;return this.visitedNames=r,this.pushContextTransition(e,e.children,{locals:a,caller:i,stackEnv:o,stackMap:s,visitedNames:u})}case E.TermKind.Udf:return this.updateTermTransition(this.evalUdfTerm(e));case E.TermKind.ReadStack:{const t=this.stackEnv.getValue(this.stackEnv.getCount()-1-e.data);return(0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.reduceFormula: ReadStack oper",void 0!==t),this.updateTermTransition(t instanceof l.LazyOper?t.value:t)}case E.TermKind.Array:return this.pushContextTransition(e,e.children[0][0],e.children.map((()=>[])));case E.TermKind.Lambda:return this.updateTermTransition(new C.LambdaOper(e.data.checkArity,e.position,e.data.params??[],this.locals,this.stackEnv,this.stackMapList(),e.children));case E.TermKind.Noop:return this.updateTermTransition(e.children);default:return(0,n.assertNever)("calc.runtime.FormulaEvaluationMachine.reduceFormula",e)}}dispatchFunction(e,t,r){const{funName:n,funType:a,isFormulaRoot:i}=t;(0,R.dereferenceOpers)(this,e,a);const o=new b.FunctionDispatcher(this.context,this.stepConfig,this.locals,this.stackFrameList(r),this.precedents,this.visitedCells,this.visitedNames,this.usage).dispatchFunction(n,a,i,e);return this.popContextTransition(o)}stackFrameList(e){return(0,s.stackFrameList)(this.locals.lexicalSource,e,this.stackEnv,this.stackMapList(),this.caller)}stackMapList(){return void 0!==this.stackMapLabels&&0!==this.stackMapNumPushed?(0,o.stackMapList)(this.stackMapLabels,this.stackMapNumPushed,this.stackMapNext):this.stackMapNext}noopTerm(e,t){return null!=this.stepConfig?(0,E.noopTerm)(e,t):e}pushContextTransition(e,t,r){const n=D(e,r);return this.continuation.push(n),this.updateTermTransition(t)}popContextTransition(e){return this.continuation.pop(),this.updateTermTransition(e)}nextHoleTransition(e,t){return e.holeIndex+=1,this.updateTermTransition(t)}updateTermTransition(e){if(this.term=e,null!=this.stepConfig&&!(0,E.isOperTerm)(e)&&void 0!==e.position&&e.kind!==E.TermKind.Name&&e.kind!==E.TermKind.Udf){const t=function(e,t,r,n,a){const i=(0,s.stackFrameList)(e,t,r,n,a);return{stack:new u.IterableStackFrame(i)}}(this.locals.lexicalSource,e.position,this.stackEnv,this.stackMapList(),this.caller);if(this.continuation.push(D(E.postStepTerm,t)),this.stepConfig.preStep(t)===a.StepAction.Break)return g.breakTransition}return g.nextTransition}switchCaller(e,t){(0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.switchCaller: correct nesting",e.caller===this.caller),t||(this.caller=e)}restoreStack({stackEnv:e,stackMap:t}){this.stackEnv=e,this.stackMapLabels=t?.labels,this.stackMapNumPushed=t?.numPushed??0,this.stackMapNext=t?.next}isLetTcoPossible(){const e=this.continuation[this.continuation.length-2];if(void 0===e)return!1;const t=e.context;return t.kind===E.TermKind.Let?e.holeIndex>=t.children.length-1:t.kind===E.TermKind.CallLambda||t.kind===E.TermKind.CallName}isCallLambdaTcoPossible(){const e=this.continuation[this.continuation.length-1];return void 0!==e&&e.context.kind===E.TermKind.CallLambda}getNameFormulaAsTerm(e,t){const r=this.globals.getNameFormula(e,t);if(r.kind===m.ResultKind.Failure)return(0,c.throwEvaluationError)(r.reason);const n=r.value;return null!=n?(0,N.compiledFormulaTerm)("calc.runtime.FormulaEvaluationMachine.getNameFormulaAsTerm",n):void 0}checkForNameCycle(e){const t=this.visitedNames,r=t.map.getValue(e);if(void 0!==r){const e=(0,h.recordNameCycle)(r,t.current);return(0,c.throwEvaluationError)(e)}return this.visitedNames.map.getCount()+1>(this.globals.limits.maxNameChain??1/0)?(0,c.throwEvaluationError)((0,a.limitExceeded)(a.LimitKind.NameChain)):(0,h.appendVisitedName)(this.visitedNames,e)}evalNameTerm(e){const{resolution:t,precedents:r}=this.context.resolver.resolveName(this.locals,(0,_.nameNode)((0,_.identNamePart)(e.data.name,!0),e.data.qualifier),e.data.source);if((0,d.safePush)(this.precedents.names,r),!(0,m.isSuccess)(t)){if(t.reason.kind===O.ResolveReasonKind.NoOriginSheet){const t=`error ref, no sheet, qualifier = ${(0,v.anonymize)(e.data.qualifier)}`;return(0,I.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalName",S.ErrorType.REF,t),this.noopTerm(S.refErrorOper,e.position)}const r=e.children;return t.reason.kind===O.ResolveReasonKind.InvalidQualifier&&void 0!==r?r:(0,c.throwEvaluationError)(t.reason)}const n=t.value;let i;if(void 0===n||void 0===(i=this.getNameFormulaAsTerm(n,e.data.source))){const t=e.children;if(void 0===t){const t=`error ref, qualifier = ${(0,v.anonymize)(e.data.qualifier)}`;return(0,I.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalName",S.ErrorType.NAME,t),this.noopTerm(S.nameErrorOper,e.position)}return t}return(0,E.callNameTerm)(n,this.noopTerm(i,a.runtimePositionFormulaRoot),e.position)}evalCellRefTerm(e){const{resolution:t}=this.context.resolver.resolveCellRef(this.locals,(0,_.cellRefNode)(e.data.ref,e.data.qualifier));if(!(0,m.isSuccess)(t)){if(t.reason.kind===O.ResolveReasonKind.NoOriginSheet){const t=`error ref, no sheet, qualifier = ${(0,v.anonymize)(e.data.qualifier)}`;return(0,I.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",S.ErrorType.REF,t),S.refErrorOper}return(0,c.throwEvaluationError)(t.reason)}const r=t.value;if(!r){const t=`error ref, qualifier = ${(0,v.anonymize)(e.data.qualifier)}`;return(0,I.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",S.ErrorType.REF,t),S.refErrorOper}return(0,S.range3DOper)(r.sheet,r.range)}evalStructRefTerm(e){const{resolution:t,precedents:r}=this.context.resolver.resolveStructRef(this.locals,e.data);if((0,d.safePush)(this.precedents.names,r),!(0,m.isSuccess)(t)){if(t.reason.kind===O.ResolveReasonKind.NoOriginSheet){const t=`error ref, no sheet, struct ref = ${(0,v.anonymize)(e.data)}`;return(0,I.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalStructRefTerm",S.ErrorType.REF,t),S.refErrorOper}if(t.reason.kind===O.ResolveReasonKind.EmptyIntersection){const t=`error ref, empty intersection, struct ref = ${(0,v.anonymize)(e.data)}`;return(0,I.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalStructRefTerm",S.ErrorType.VALUE,t),S.valueErrorOper}return(0,c.throwEvaluationError)(t.reason)}const n=t.value;if(!n){const t=`error ref, struct ref = ${(0,v.anonymize)(e.data)}`;return(0,I.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalStructRefTerm",S.ErrorType.REF,t),S.refErrorOper}return(0,S.range3DOper)(n.sheet,n.range)}evalUdfTerm(e){const{resolution:t,precedents:r}=this.context.resolver.resolveUserDefinedFunc(this.locals,(0,_.nameNode)((0,_.identNamePart)(e.data.name,!0),e.data.qualifier));if((0,d.safePush)(this.precedents.udfs,r),!(0,m.isSuccess)(t)){const r=e.children;if(t.reason.kind===O.ResolveReasonKind.InvalidQualifier&&void 0!==r)return r;(0,c.throwEvaluationError)(t.reason)}const n=t.value;if(!n){const t=e.children;if(void 0===t){const t=`UDF resolution, qualifier = ${(0,v.anonymize)(e.data.qualifier)}`;return(0,I.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalUdfTerm",S.ErrorType.NAME,t),this.noopTerm(S.nameErrorOper,e.position)}return t}if(n.length>1){const t="UDF resolution, ambiguous name";return(0,I.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalUdfTerm",S.ErrorType.NAME,t),this.noopTerm(S.nameErrorOper,e.position)}const a=n[0],i=this.globals.getUserDefinedFunc(a);return(0,m.isSuccess)(i)||(0,c.throwEvaluationError)(i.reason),new b.UdfOper(a,i.value)}constructor(e,t,r,a,i,o,s,u,c,d,g){this.context=e,this.stepConfig=t,this.locals=r,this.precedents=a,this.visitedCells=i,this.visitedNames=o,this.usage=s,this.target=u,this.isNested=c,this.runStatus=!1,this.stackEnv=l.emptyStackEnv,this.stackMapLabels=void 0,this.stackMapNumPushed=0,this.stackMapNext=void 0,this.continuation=[],d.kind!==E.TermKind.CallLambda&&d.kind!==E.TermKind.CallFirstOrderFunc?(this.term=null!=t?(0,E.noopTerm)(d,void 0):d,this.caller=void 0):((0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.constructor: no preStep for CallTerm",void 0===d.position),this.term=d,this.caller=d.data.caller.caller),this.initialLambdaDepth=s.lambdaDepth,g.length>0&&(this.stackEnv=g.reduce(((e,{value:t})=>e.setValue(e.getCount(),t)),this.stackEnv),this.stackMapLabels=g.map((({label:e})=>e)),this.stackMapNumPushed=g.length)}}t.createFormulaEvaluationMachine=function(e,t,r,i,o,s,u,l){const{contextNames:d=[]}=r,g=l.annotations[l.node.label],m=(g?.kind===_.AnnotationKind.FormulaRoot?g.contextNames:void 0)??[];return(0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.createFormulaEvaluationMachine: contextNames",m.length===d.length&&d.every(((e,t)=>e.label===m[t].label))),new w(e,t,r,i,o,s,(0,c.evalUsage)([0],0),u,!1,(0,E.noopTerm)((0,N.compiledFormulaTerm)("calc.runtime.createFormulaEvaluationMachine",l),a.runtimePositionFormulaRoot),d)},t.createCallTermEvaluationMachine=function(e,t,r,n,a,i,o,s){return new w(e,t,r,n,a,i,(0,c.evalUsage)(o.lambdaCalls,o.lambdaDepth),T.SignatureType.All,!0,s,[])}},17384:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FunctionDispatcher=t.RestArgsOper=t.UdfOper=void 0;const n=r(84949),a=r(18612),i=r(93371),o=r(59370),s=r(59370),u=r(31663),l=r(64316),c=r(95625),d=r(66096),g=r(66096),m=r(66096),h=r(66096),p=r(66096),f=r(66096),S=r(36094),v=r(36094),F=r(71766),y=r(19552),C=r(11181),A=r(11181),E=r(92158),b=r(69210),R=r(184),T=r(10087),k=r(70633),N=r(70633),I=r(70186),O=r(39141),_=r(7625),P=r(59242),M=r(98677),D=r(75811),w=r(44079),L=r(79673),x=r(41200),K=r(47267),W=r(43376),U=r(51465),G=r(51675),B=r(3825);class V{getFallback(){return(0,a.assertFalse)("calc.runtime.UdfOper.getFallback")}getField(e){return(0,a.assertFalse)("calc.runtime.UdfOper.getField")}constructor(e,t){this.kind=L.OperKind.Rich,this.loc=e,this.arity=t.arity,this.func=t.func}}t.UdfOper=V;class j{getFallback(){return(0,a.assertFalse)("calc.runtime.RestArgsOper.getFallback")}getField(e){return(0,a.assertFalse)("calc.runtime.RestArgsOper.getField")}constructor(e){this.opers=e,this.kind=L.OperKind.Rich}}function H(e,t,r,n){(0,a.assertTrue)("calc.runtime.compileCallLambda",e.checkArity(t.length));const i=[];{let r=0,n=0;for(const a of e.params){if(a.isRest){i.push(new j(t.slice(n))),n=t.length;continue}let o=n>=t.length?k.missingOper:t[n++];a.hasDef&&((0,E.isMissingOper)(o)&&(o=e.defsAndBody[r]),++r),i.push(o)}(0,a.assertTrue)("calc.runtime.compileCallLambda",n===t.length&&r===e.defsAndBody.length-1)}const s=n?i.map(((t,r)=>{const n=e.params[r];return void 0===n.paramNodeLabel&&void 0===n.paramNameLabel?t:(0,g.noopTerm)(t,(0,o.runtimePositionLambdaParam)(r,n.paramNodeLabel,n.paramNameLabel))})):i,u=i.map(((t,r)=>e.params[r].paramNodeLabel)),l=e.defsAndBody[e.defsAndBody.length-1],c=(0,g.letTerm)(s,!1,u,l,(0,o.runtimePositionLambdaRoot)(e.lambdaNodeLabel,e,t));return(0,g.callLambdaTerm)(e.locals,e.stackEnv,e.stackMap,r,c)}t.RestArgsOper=j;class q{get globals(){return this.context.globals}get numberFormatter(){return this.context.numberFormatter}get internalCaller(){return(0,a.assertTrue)("calc.runtime.FunctionDispatcher.internalCaller",void 0!==this.internalSource),(0,u.stackFrameList)(this.internalSource,q.internalPosition,u.emptyStackEnv,void 0,this.caller)}get internalContext(){const e=this.internalCaller;return{stack:new u.IterableStackFrame(e)}}get calcingArray(){return this.locals.calcingArray}get originGridCell(){const e=this.locals.originGridCell;return(0,W.isSuccess)(e)?e.value:(0,u.throwEvaluationError)(e.reason)}get originSheet(){const e=this.locals.originSheet;return(0,W.isSuccess)(e)?e.value:(0,u.throwEvaluationError)(e.reason)}get reflectionGridCell(){const e=this.locals.reflectionGridCell;return(0,W.isSuccess)(e)?e.value:(0,u.throwEvaluationError)(e.reason)}get reflectionSheet(){const e=this.locals.reflectionSheet;return(0,W.isSuccess)(e)?e.value:(0,u.throwEvaluationError)(e.reason)}get followHyperlinks(){const e=this.locals.followHyperlinks;return(0,W.isSuccess)(e)?e.value:(0,u.throwEvaluationError)(e.reason)}makeChildDispatcher(e){return new q(this.context,this.stepConfig,this.locals,e,this.precedents,this.visitedCells,this.visitedNames,this.usage)}useAsFuncContext(e){return(0,a.assertTrue)("calc.runtime.FunctionDispatcher.useAsFuncContext: caller shouldn't be set",void 0===this.internalSource),void 0!==e&&(this.internalSource=e),this}applyFunction(e,t){const r=this.makeChildDispatcher(this.internalCaller),n=(0,P.getWorksheetFuncType)(e),a=t.some(E.isRangeOper)?t.slice(0):t;return(0,x.dereferenceOpers)(r,a,n),r.termToFuncResult(r.dispatchFunction((0,f.worksheetFunctionIdToName)(e),n,!1,a))}applyLambda(e,t){return this.termToFuncResult(H(e,t,this.internalCaller,null!=this.stepConfig))}handleEvaluationError(e){if(e instanceof u.EvaluationError)return(0,u.handleEvaluationError)(this.context,this.visitedCells,e.reason)}applyOperatorOrFunction(e,t,r){if((0,f.isOperatorName)(e))return(0,c.applyOperator)(this.globals,(0,f.operatorNameToId)(e),t,r);const n=(0,f.worksheetFunctionNameToId)(e);if(n===P.WorksheetFuncId._UDF){if(t[0]instanceof _.LambdaOper){const e=t[0],r=t.slice(1);return e.checkArity(r.length)?((0,a.assertTrue)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction: caller shouldn't be set",void 0===this.internalSource),H(e,r,this.caller,null!=this.stepConfig)):N.valueErrorOper}if(t[0]instanceof V){const e=t[0];if(t.length-1!==e.arity)return N.valueErrorOper;const r=e.func(this.useAsFuncContext((0,C.lexicalSourceUDF)(e.loc)),t.slice(1));if(r.kind===L.OperKind.Error){const e="UDF function return value";(0,v.traceErrorOper)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",r.type,e)}return this.funcContextResultToTerm(r)}switch(t[0].kind){case L.OperKind.Error:return t[0];case L.OperKind.Number:return N.valueErrorOper;case L.OperKind.Rich:return(0,u.throwEvaluationError)((0,E.notImplemented)(["Rich UDF head"]));case L.OperKind.String:case L.OperKind.Boolean:case L.OperKind.Blank:case L.OperKind.Missing:return N.refErrorOper;case L.OperKind.Array:return(0,B.isFeatureEnabled)(B.FeatureName.CalcLambdaArrayLifting)?(0,a.assertFalse)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction: unexpected array UDF head"):(0,u.throwEvaluationError)((0,E.notImplemented)(["Array UDF head"]));case L.OperKind.Range:return(0,B.isFeatureEnabled)(B.FeatureName.CalcLambdaCellValues)?(0,a.assertFalse)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction: unexpected range UDF head"):(0,u.throwEvaluationError)((0,E.notImplemented)(["Range UDF head"]));default:return(0,a.assertNever)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",t[0])}}const i=this.globals.getWorksheetFunc(n);if(i.kind===W.ResultKind.Failure)return(0,u.throwEvaluationError)(i.reason);const o=i.value;if(null==o){const e=`nonexistent worksheet function ${n}`;return(0,v.traceErrorOper)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",N.ErrorType.NAME,e),N.nameErrorOper}try{const e=o(this.useAsFuncContext((0,C.lexicalSourceWSF)(n)),t);if(e.kind===L.OperKind.Error){const t=`worksheet function ${n} return value`;(0,v.traceErrorOper)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",e.type,t)}return this.funcContextResultToTerm(e)}catch(e){throw(0,U.prependErrorMessage)(e,`(in WSF ${(0,y.englishWorksheetFuncIdToName)(n)})`)}}termToFuncResult(e){switch(e.kind){case p.TermKind.CallLambda:case p.TermKind.CallFirstOrderFunc:return(0,M.machineCall)(this.context.createCallTermEvaluationMachine(this.context,this.stepConfig,this.locals,this.precedents,this.visitedCells,this.visitedNames,this.usage,e));case p.TermKind.CallMachine:return(0,M.machineCall)(e.data.machine)}return e}funcContextResultToTerm(e){return(0,a.assertTrue)("calc.runtime.FunctionDispatcher.funcContextResultToTerm",void 0!==this.internalSource),(0,M.isMachineCall)(e)?(0,d.callFirstOrderFuncTerm)(this.internalSource,this.caller,(0,h.callMachineTerm)(e.machine,q.internalPosition)):e}dispatchFunction(e,t,r,i){if(!(0,E.isValidArgsLength)(t,i.length)){const r=JSON.stringify(t),n=`calc.runtime.FunctionDispatcher.dispatchFunction: bad application of ${JSON.stringify(e)} to ${i.length} arguments, ftype = ${r}`;return(0,a.assertFalse)(n)}const o=i.length;let s=L.SignatureType.None;for(let e=0;e<o;e+=1){const r=i[e],n=r.kind,a=(0,E.getArgType)(t,e,o);0==(n&a)&&(s|=n),(0,E.isRangeOper)(r)&&0==(t.flags&L.FunctionFlags.Allow3dRef)&&0==(a&L.SignatureType.Ref3D)&&!(0,E.isSheetIndex)(r.sheets)&&(s|=n),(0,E.isStringOper)(r)&&0==(t.flags&L.FunctionFlags.AllowLStrs)&&r.value.length>255&&(s|=n)}if(s===L.SignatureType.None)return this.applyOperatorOrFunction(e,i,r);if(0!=(s&L.OperKind.Array)){const r=r=>{const n=this.makeChildDispatcher(this.caller);return n.termToFuncResult(n.dispatchFunction(e,t,!1,r))},{machine:n}=(0,S.arrayLift)(this.useAsFuncContext(void 0),t,r,i);return(0,h.callMachineTerm)(n,void 0)}s&=~L.OperKind.Array;const u=[];for(let e=0;e<o;e+=1){let r=i[e];if(0!=(s&r.kind)){const a=(0,E.getArgType)(t,e,o);if(r=this.coerceOper(r,a),(0,E.isErrorOper)(r)&&0==(a&L.OperKind.Error))return r;if((0,E.isRangeOper)(r)&&0==(t.flags&L.FunctionFlags.Allow3dRef)&&0==(a&L.SignatureType.Ref3D)&&!(0,E.isSheetIndex)(r.sheets)){const e=`3D reference, oper = ${(0,n.anonymize)(r)}`;return(0,v.traceErrorOper)("calc.runtime.FunctionDispatcher.dispatchFunction",N.ErrorType.VALUE,e),N.valueErrorOper}if((0,E.isStringOper)(r)&&0==(t.flags&L.FunctionFlags.AllowLStrs)&&r.value.length>255){const e=`LStr, oper = ${(0,n.anonymize)(r)}`;return(0,v.traceErrorOper)("calc.runtime.FunctionDispatcher.dispatchFunction",N.ErrorType.VALUE,e),N.valueErrorOper}}u[e]=r}return this.applyOperatorOrFunction(e,u,r)}getAvailableFormula(e){const t=this.globals.getCellFormula(e);return(0,W.isSuccess)(t)?(0,F.isNone)(t.value)?void 0:t.value:(0,u.throwEvaluationError)(t.reason)}getNameFormula(e,t,r){const{resolution:n,precedents:a}=this.context.resolver.resolveName(this.locals,(0,b.nameNode)((0,b.identNamePart)(t,!0),e),r);if((0,F.safePush)(this.precedents.names,a),!(0,W.isSuccess)(n))switch(n.reason.kind){case R.ResolveReasonKind.NoOriginSheet:case R.ResolveReasonKind.InvalidQualifier:return;default:return(0,u.throwEvaluationError)(n.reason)}const i=n.value;if(!i)return;const o=this.globals.getNameFormula(i,r);(0,W.isSuccess)(o)||(0,u.throwEvaluationError)(o.reason);const s=o.value;return(0,F.isNone)(s)?void 0:[i,s.node]}getCellRef(e,t,r,n){const a={originGridCell:(0,W.success)(r.range),originSheet:(0,W.success)(r.sheet),allowUnqualifiedCell:!0,wrapCellReferences:n},{resolution:i}=this.context.resolver.resolveCellRef(a,(0,b.cellRefNode)(t,e));if(!(0,W.isSuccess)(i))switch(i.reason.kind){case R.ResolveReasonKind.NoOriginSheet:case R.ResolveReasonKind.InvalidQualifier:return;default:return(0,u.throwEvaluationError)(i.reason)}const o=i.value;if(o)return(0,N.range3DOper)(o.sheet,o.range)}getStructRef(e,t,r){const n={originGridCell:(0,W.success)(r.range),originSheet:(0,W.success)(r.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1},{resolution:a,precedents:i}=this.context.resolver.resolveStructRef(n,(0,b.structRefNode)(e,t));if((0,F.safePush)(this.precedents.names,i),!(0,W.isSuccess)(a))switch(a.reason.kind){case R.ResolveReasonKind.NoOriginSheet:case R.ResolveReasonKind.InvalidQualifier:case R.ResolveReasonKind.InvalidStructRef:case R.ResolveReasonKind.EmptyIntersection:return;default:return(0,u.throwEvaluationError)(a.reason)}const o=a.value;if(o)return(0,N.range3DOper)(o.sheet,o.range)}dereferenceOper(e,t){return(0,x.dereferenceOper)(this,e,t)}dereferenceOpers(e,t){(0,x.dereferenceOpers)(this,e,t)}getCellFormula(e){this.precedents.cells.push(e);const t=this.globals.getCellValue(e);return(0,W.isSuccess)(t)?this.getAvailableFormula(e):(0,u.throwEvaluationError)(t.reason)}getSheetIndex(e,t){const r=this.globals.getSheetIndex(e,t);return(0,W.isSuccess)(r)?(this.precedents.special|=L.SpecialPrecs.OwnDocSheets,null==r.value?void 0:(0,A.sheetIndex)(e,r.value)):(0,u.throwEvaluationError)(r.reason)}getSheetRangePosition(e){this.precedents.special|=L.SpecialPrecs.OwnDocSheets;const t=this.globals.getSheetRangeIndexes(e);return(0,W.isSuccess)(t)?t.value.position:(0,u.throwEvaluationError)(t.reason)}getSheetRangeIndexes(e){if(void 0!==e.index&&e.index===e.index2)return[e.index];this.precedents.special|=L.SpecialPrecs.OwnDocSheets;const t=this.globals.getSheetRangeIndexes(e);return(0,W.isSuccess)(t)?t.value.sheets:(0,u.throwEvaluationError)(t.reason)}dereferenceAllOpersInner(e,t,r=!1){const n=[],i=[];for(let o=0;o<e.length;o+=1){const s=e[o];if(!(0,E.isRangeOper)(s)){i.push(s);continue}const c=[],d=e=>{const r=(0,x.getCellValuesAsArray)(this,e,n,!0);void 0!==r&&c.push(t(r,e))},g=this.getSheetRangeIndexes(s.sheets);for(let e=0;e<g.length;e+=1){const t=(0,A.sheetIndex)(s.sheets.document,g[e]);for(let e=0;e<s.ranges.length;e+=1){const n=s.ranges[e];if(!r){d((0,A.sheetGridRange)(t,n));continue}const i=this.globals.tryGetHiddenRows(t,n.row,n.row+n.rows);if(!(0,W.isSuccess)(i))return(0,u.throwEvaluationError)(i.reason);const o=i.value;if(0===o.length){d((0,A.sheetGridRange)(t,n));continue}const l=(e,r)=>{const a=(0,A.gridRange)(e,n.col,r-e,n.cols);d((0,A.sheetGridRange)(t,a))};for(let e=0;e<o.length;e+=1){const{start:r,end:i}=o[e],s=0===e?n.row:o[e-1].end;(0,a.assertTrue)("calc.runtime.FunctionDispatcher.dereferenceAllOpersInner: valid interval",s<=r&&r<i&&i<=n.row+n.rows),s!==r&&l(s,r);const u=(0,A.gridRange)(r,n.col,i-r,n.cols);this.precedents.cells.push((0,A.sheetGridRange)(t,u))}const c=o[o.length-1].end;c!==n.row+n.rows&&l(c,n.row+n.rows)}}i.push({kind:l.DerefOperKind.RangeValues,arrays:c})}return n.length>0?(0,u.throwEvaluationError)((0,u.unevaluated)(n)):i}dereferenceAllOpers(e,t){return this.dereferenceAllOpersInner(e,F.identity,t)}dereferenceAllOpersAndFormulae(e,t){return this.dereferenceAllOpersInner(e,((e,t)=>new i.NonstrictSparseArray2D(e.rows,e.cols,e.denseRows,e.denseCols,((r,n)=>{const a=e.get(r,n),i=(0,A.sheetGridCell)(t.sheet,(0,A.gridCell)(t.range.row+r,t.range.col+n));return[a,this.getAvailableFormula(i)]}),(()=>[e.getSparse(),void 0])).strict()),t)}parseFormula(e,t,r,n){const a=this.context.parser.parseFormula((0,T.parseLocals)(r.lexicalKind,t,{refStyle:e}),n);if(!(0,W.isSuccess)(a))return a;const i=this.context.analyzer.checkFormula(r,a.value);return(0,W.isSuccess)(i)?(0,E.isWellFormed)(i.value)?(i.value,i):(0,W.failure)((0,s.illFormedFormula)("ill-formed indirect formula","indirect")):i}getRandom(){this.precedents.special|=L.SpecialPrecs.Calc;const e=this.internalContext,t=this.globals.getRandom(e);return(0,W.isSuccess)(t)||(0,u.throwEvaluationError)(t.reason),t.value}getTime(e){this.precedents.special|=L.SpecialPrecs.Time;const t=this.globals.getTime(e,D.GetTimeKind.Volatile);return(0,W.isSuccess)(t)||(0,u.throwEvaluationError)(t.reason),t.value}coerceOper(e,t){return(0,K.coerceOper)(this,e,t)}parseGeneral(e,t){const r=this.numberFormatter.parseGeneral(e,!1,t,D.GetTimeKind.NonVolatile);return(0,W.isSuccess)(r)||(0,u.throwEvaluationError)(r.reason),r.value?.value}parseDate(e){const t=this.numberFormatter.parseDate(e,D.GetTimeKind.NonVolatile);return(0,W.isSuccess)(t)||(0,u.throwEvaluationError)(t.reason),t.value?.value}getBinaryOperator(e){const t=(0,P.getOperatorType)(e),r=[N.falseOper,N.falseOper];return(n,i)=>{r[0]=n,r[1]=i,(0,x.dereferenceOpers)(this,r,t);const o=this.dispatchFunction((0,f.operatorIdToName)(e),t,!1,r);return(0,a.assertTrue)("calc.runtime.FunctionDispatcher.getBinaryOperator",(0,m.isOperTerm)(o)),o}}getUnaryOperator(e){const t=(0,P.getOperatorType)(e),r=[N.falseOper];return n=>{r[0]=n,(0,x.dereferenceOpers)(this,r,t);const i=this.dispatchFunction((0,f.operatorIdToName)(e),t,!1,r);return(0,a.assertTrue)("calc.runtime.FunctionDispatcher.getUnaryOperator",(0,m.isOperTerm)(i)),i}}isInFilterMode(e){this.precedents.special|=L.SpecialPrecs.InFilterMode;for(const t of e)if((0,E.isRangeOper)(t))for(const e of this.getSheetRangeIndexes(t.sheets)){const r=this.globals.isInFilterMode((0,A.sheetIndex)(t.sheets.document,e));if(!(0,W.isSuccess)(r))return(0,u.throwEvaluationError)(r.reason);if(r.value)return!0}return!1}printFormula(e,t){const r=(0,A.sheetGridCell)(e.source.range.sheet,t),n=(0,O.adjustFormulaOrigin)(this.globals,(0,I.analyzeLocalsGrid)(A.LexicalKind.Cell,(0,E.sheetGridRangeAnchor)(e.source.range)),t,e.formula);if(!(0,W.isSuccess)(n))return(0,u.throwEvaluationError)(n.reason);const a=this.context.printer.printFormula((0,G.printLocalsGrid)(e.source,r,{refStyle:this.config.refStyle}),n.value);return(0,W.isSuccess)(a)?a.value:(0,u.throwEvaluationError)(a.reason)}applyFormat(e,t,r,n){let a;if("number"==typeof t){const r=this.globals.getKnownFormat(e,t);if(!(0,W.isSuccess)(r))return(0,u.throwEvaluationError)(r.reason);a=r.value}else{const r=(0,w.getFormatString)(this.context.numberFormatter,this.globals,e,t,n);if(!(0,W.isSuccess)(r))switch(r.reason.kind){case D.FormatReasonKind.PreviousFormatFailure:case D.FormatReasonKind.NotFormatString:return;default:return(0,u.throwEvaluationError)(r.reason)}a=r.value}const i=(0,w.renderFormat)(this.context.numberFormatter,a,r);return(0,W.isSuccess)(i)?"string"==typeof i.value?i.value:void 0:(0,u.throwEvaluationError)(i.reason)}constructor(e,t,r,n,a,i,o,s){this.context=e,this.stepConfig=t,this.locals=r,this.caller=n,this.precedents=a,this.visitedCells=i,this.visitedNames=o,this.usage=s,this.internalSource=void 0;const u=e.globals.config.refStyle;this.config={localeInfo:e.globals.config.localeInfo,get refStyle(){return a.special|=L.SpecialPrecs.RefStyle,u},mathpack:e.globals.config.mathpack,date1904:e.globals.config.date1904,dateCompatibility:e.globals.config.dateCompatibility,timezone:e.globals.config.timezone,datepack:e.globals.config.datepack},this.mathpack=this.config.mathpack,this.datepack=this.config.datepack}}t.FunctionDispatcher=q,q.internalPosition=o.runtimePositionFirstOrderFunc},11375:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createNameEvaluationMachine=void 0;const n=r(84949),a=r(18612),i=r(43376),o=r(56497),s=r(11181),u=r(79673),l=r(31663),c=r(64462);class d{evalName(){const e=this.context.globals.getNameFormula(this.name,s.NameSource.Plain);if(e.kind===i.ResultKind.Failure)return o.Pledge.reject(e.reason);const t=e.value;if(null==t)return o.Pledge.resolve(void 0);const r=(0,l.bottomEvalPrecedents)(),n=this.context.createFormulaEvaluationMachine(this.context,this.stepConfig,(0,l.evalLocalsName)((0,s.lexicalSourceName)(this.name),(0,l.evalLocalsGrid)(this.origin)),r,c.emptyVisitedCells,(0,c.appendVisitedName)(c.emptyVisitedNames,this.name),u.SignatureType.All,t);return o.Pledge.fromMachine(n).catch(this.receiveFailure())}receiveFailure(){return e=>{if(e.kind===l.RuntimeInternalReasonKind.Unevaluated){const t=`calc.runtime.NameEvaluationMachine.receiveFailure: unexpected reason ${(0,n.anonymize)(e)}`;return(0,a.assertFalse)(t)}return o.Pledge.reject(e)}}constructor(e,t,r,n){this.context=e,this.stepConfig=t,this.name=r,this.origin=n}}t.createNameEvaluationMachine=function(e,t,r,n){return o.Pledge.try((()=>new d(e,t,r,n).evalName()))}},76950:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EvaluationRuntime=t.runtimeTimer=t.calculateNextDeadline=t.createSchedule=void 0;const n=r(18612),a=r(59370),i=r(71766),o=r(98677),s=r(51465),u=r(43376);function l(e){if(void 0===e.yieldIntervalMs&&void 0===e.endTimeMs)return;if(void 0===e.yieldIntervalMs)return e.endTimeMs;const t=(0,i.now)()+e.yieldIntervalMs;return void 0===e.endTimeMs?t:(0,i.fastMin)(e.endTimeMs,t)}t.createSchedule=function(e){return{yieldIntervalMs:e.yieldIntervalMs,endTimeMs:null==e.totalTimeMs?void 0:(0,i.now)()+e.totalTimeMs,scheduleFunction:null!=e.scheduleFunction?e.scheduleFunction:e=>setTimeout(e,0)}},t.calculateNextDeadline=l,t.runtimeTimer=function(){return{doTimeout:e=>void 0!==e&&(0,i.now)()>=e}};const c={kind:a.ReasonKind.Timeout},d={kind:a.ReasonKind.Breakpoint};t.EvaluationRuntime=class{evaluateAsync(e){if(this.context.globals.interruptToken[0]===a.Interrupt.Stop)return this.generatePartialResults(),Promise.resolve(this.results);if(this.context.timer.doTimeout(e.endTimeMs))return this.generatePartialResults(),Promise.resolve(this.results);try{const t=this.evaluate(l(e));return Array.isArray(t)?Promise.resolve(t):((0,n.assertTrue)("calc.runtime.EvaluationRuntime.evaluateAsync",t.kind===a.ReasonKind.Timeout),new Promise(((t,r)=>e.scheduleFunction((()=>{try{t(this.evaluateAsync(e))}catch(e){r(e)}})))))}catch(e){return Promise.reject(e)}}evaluateSync(e){const t=r=>{if(this.context.globals.interruptToken[0]===a.Interrupt.Stop||this.context.timer.doTimeout(e.endTimeMs))return this.generatePartialResults(),this.results;const i=this.evaluate(r);if(Array.isArray(i))return i;switch(i.kind){case a.ReasonKind.Timeout:return(0,a.paused)((r=>t(r??l(e))));case a.ReasonKind.Breakpoint:return(0,a.breaked)((()=>t(l(e))));default:return(0,n.assertNever)("calc.runtime.EvaluationRuntime.evaluateSync",i)}};return t(l(e))}evaluate(e){const t=()=>this.context.timer.doTimeout(e);try{for(;this.results.length<this.machineRuntimes.length;){const e=this.machineRuntimes[this.results.length].run(t);if(e.kind===o.TransitionKind.Next)return c;if(e.kind===o.TransitionKind.Break)return d;this.pushResult(e)}return this.results}catch(e){const t=`calc.runtime.EvaluationRuntime.evaluate: unhandled error ${(0,s.messageFromError)(e)}`;return(0,n.assertFalse)(t)}}pushResult(e){return this.results.push(e),o.nextTransition}generatePartialResults(){for(;this.results.length<this.machineRuntimes.length;)this.results.push((0,u.failure)(a.stopped))}constructor(e,t){(0,n.assertPositiveInteger)("calc.runtime.EvaluationRuntime",t.length),this.context=e,this.machineRuntimes=t.map((e=>new o.MachineRuntime(e))),this.results=[]}}},31663:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CellEvaluationResultKind=t.IterableStackFrame=t.IterableStackValue=t.stackFrameList=t.stackMapList=t.emptyStackEnv=t.LazyOper=t.evalLocalsSlice=t.evalLocalsFirstOrderFunc=t.evalLocalsLambda=t.evalLocalsName=t.evalLocalsGrid=t.evalUsage=t.bottomEvalPrecedents=t.handleEvaluationError=t.throwEvaluationError=t.EvaluationError=t.unevaluated=t.RuntimeInternalReasonKind=void 0;const n=r(59370),a=r(92158),i=r(11181),o=r(18612),s=r(70633),u=r(98677),l=r(79673),c=r(43376),d=r(77981);var g,m;function h(e){throw new t.EvaluationError(e)}!function(e){e.Unevaluated="Unevaluated"}(g||(t.RuntimeInternalReasonKind=g={})),t.unevaluated=function(e){return 0===e.length&&(0,o.assertFalse)("calc.runtime.unevaluated: expected nonempty array"),{kind:g.Unevaluated,anchors:e}},t.EvaluationError=(0,a.createFailureErrorClass)("EvaluationError"),t.throwEvaluationError=h;class p{next(){return(0,u.callMachineTransition)(this.machine,this)}receiveResult(e){if(!(0,c.isSuccess)(e))return e;switch(e.value.kind){case m.ReadFailure:return e.value.failure;case m.WroteFailure:return(0,c.failure)((0,n.previousFailure)(e.value.source.range))}return c.successUndefined}constructor(e){this.machine=e,this.runStatus=!1}}t.handleEvaluationError=function(e,t,r){if(r.kind===g.Unevaluated){if(t.map.getCount()+1>(e.globals.limits.maxCellChain??1/0))return(0,c.failure)((0,n.limitExceeded)(n.LimitKind.CellChain));const a=r.anchors.map((r=>new p(e.createCellEvaluationMachine(e,void 0,t,r))));return(0,u.callMachineTransition)(new u.AllMachine(a),(0,u.nextOnSuccessReceiver)())}return(0,c.failure)(r)},t.bottomEvalPrecedents=function(){return(0,s.precedents)([],[],[],l.SpecialPrecs.None,s.PrecsBound.Lower)},t.evalUsage=function(e,t){return{lambdaCalls:e,lambdaDepth:t}},t.evalLocalsGrid=function(e){const t=(0,a.sheetGridRangeAnchor)(e.range),r=(0,c.success)(t.range),o=(0,c.success)(t.sheet);return(0,n.evalLocals)(e,r,o,e.kind===i.LexicalKind.Range,r,o,e.kind===i.LexicalKind.Cell,!0,!1,(0,c.success)(!1),void 0)},t.evalLocalsName=function(e,t){const r=e.name.scope;let i;if(void 0!==r.index)i=(0,c.success)(r);else{const e=t.originSheet;if(!(0,c.isSuccess)(e))return h(e.reason);i=(0,a.isDocumentLocEqual)(e.value.document,r.document)?e:(0,c.success)(r)}const o=t.originGridCell;return(0,n.evalLocals)(e,o,i,t.calcingArray,o,i,!1,!1,!0,(0,c.success)(!1),void 0)},t.evalLocalsLambda=function(e,t){return(0,n.evalLocals)(e.lexicalSource,e.originGridCell,e.originSheet,t.calcingArray,t.reflectionGridCell,t.reflectionSheet,t.implicitIntersect,e.allowUnqualifiedCell,e.wrapCellReferences,(0,c.success)(!1),void 0)},t.evalLocalsFirstOrderFunc=function(e,{originGridCell:t,originSheet:r,calcingArray:a,reflectionGridCell:i,reflectionSheet:o,implicitIntersect:s,allowUnqualifiedCell:u,wrapCellReferences:l,followHyperlinks:c}){return(0,n.evalLocals)(e,t,r,a,i,o,s,u,l,c,void 0)},t.evalLocalsSlice=function({lexicalSource:e,originGridCell:t,originSheet:r,calcingArray:a,reflectionGridCell:i,reflectionSheet:o,implicitIntersect:s,allowUnqualifiedCell:u,wrapCellReferences:l,followHyperlinks:c,contextNames:d}){return(0,n.evalLocals)(e,t,r,a,i,o,s,u,l,c,d)};class f{get value(){return void 0===this._value?this.fallback():this._value}set value(e){this._value=e}get valueOrUndefined(){return this._value}constructor(e){this.fallback=e}}t.LazyOper=f,t.emptyStackEnv=d.RedBlackMapTree.create(((e,t)=>e-t)),t.stackMapList=function(e,t,r){return{labels:e,numPushed:t,next:r}},t.stackFrameList=function(e,t,r,n,a){return{stackDepth:1+(a?.stackDepth??0),lexicalSource:e,position:t,localValues:new S(r,n),caller:a}};class S{*[Symbol.iterator](){let e=this.stackEnv.getCount()-1;for(let t=this.stackMap;void 0!==t;t=t.next)for(let r=t.numPushed-1;r>=0;r--){const a=t.labels[r],i=this.stackEnv.getValue(e--);if(void 0===a||void 0===i)continue;const o=i instanceof f?i.valueOrUndefined:i;void 0!==o&&(yield(0,n.stackValue)(a,o))}}constructor(e,t){this.stackEnv=e,this.stackMap=t}}t.IterableStackValue=S;class v{*[Symbol.iterator](){for(let e=this.leafFrame;void 0!==e;e=e.caller)yield e}constructor(e){this.leafFrame=e}}t.IterableStackFrame=v,function(e){e[e.ReadFailure=0]="ReadFailure",e[e.ReadOper=1]="ReadOper",e[e.WroteFailure=2]="WroteFailure",e[e.WroteOper=3]="WroteOper"}(m||(t.CellEvaluationResultKind=m={}))},4982:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createEvaluator=t.evalName=t.evalCellsAsync=t.evalCells=t.evalFormula=t.evaluationMachineContext=t.runtimeEvaluationContext=void 0;const n=r(17277),a=r(84949),i=r(18612),o=r(43376),s=r(59884),u=r(70221),l=r(92158),c=r(13597),d=r(72189),g=r(50468),m=r(65176),h=r(11375),p=r(76950),f=r(31663),S=r(98677),v=r(98677),F=r(59370),y=r(64462);function C(e){return{globals:e,timer:(0,p.runtimeTimer)(),machineContext:A(e)}}function A(e){return{globals:e,resolver:(0,u.createResolver)(e),numberFormatter:(0,c.createNumberFormatter)(e),parser:(0,d.createParser)(e),printer:(0,s.createPrinter)(e),analyzer:(0,n.createAnalyzer)(e),createCellEvaluationMachine:g.createCellEvaluationMachine,createFormulaEvaluationMachine:m.createFormulaEvaluationMachine,createCallTermEvaluationMachine:m.createCallTermEvaluationMachine}}function E(e){if(Array.isArray(e)){const t=e[0];if(t.kind===o.ResultKind.Success){if((0,l.isRangeOper)(t.value)||(0,l.isMissingOper)(t.value)){const e=`calc.runtime.evalFormula: expected ReadOper; given ${(0,a.anonymize)(t)}`;return(0,i.assertFalse)(e)}return t}return t}return e.kind===o.ResultKind.Paused?(0,F.paused)((t=>E(e.resume(t)))):(0,F.breaked)((()=>E(e.resume())))}function b(e,t,r){const n=C(e),a=(0,f.bottomEvalPrecedents)(),i=(0,m.createFormulaEvaluationMachine)(n.machineContext,t.stepConfig,(0,f.evalLocalsSlice)(t),a,y.emptyVisitedCells,y.emptyVisitedNames,v.readOperType,r),o=new p.EvaluationRuntime(n,[i]),s=(0,p.createSchedule)(t.schedulerConfig??e.schedulerConfig);return E(o.evaluateSync(s))}function R(e,t,r){const n=C(e),a=[];for(let e=0;e<r.length;e+=1)a.push(new S.VoidMachine((0,g.createCellEvaluationMachine)(n.machineContext,t,y.emptyVisitedCells,r[e])));return new p.EvaluationRuntime(n,a)}function T(e,t,r){if(0===r.length)return[];const n=R(e,t.stepConfig,r),a=(0,p.createSchedule)(t.schedulerConfig??e.schedulerConfig);return n.evaluateSync(a)}function k(e,t,r){if(0===r.length)return Promise.resolve([]);const n=R(e,void 0,r),a=(0,p.createSchedule)(t.schedulerConfig??e.schedulerConfig);return n.evaluateAsync(a)}function N(e){return Array.isArray(e)?e[0]:e.kind===o.ResultKind.Paused?(0,F.paused)((t=>N(e.resume(t)))):(0,F.breaked)((()=>N(e.resume())))}function I(e,t,r,n){const a=C(e),i=(0,h.createNameEvaluationMachine)(a.machineContext,t.stepConfig,r,n),o=new p.EvaluationRuntime(a,[i]),s=(0,p.createSchedule)(t.schedulerConfig??e.schedulerConfig);return N(o.evaluateSync(s))}t.runtimeEvaluationContext=C,t.evaluationMachineContext=A,t.evalFormula=b,t.evalCells=T,t.evalCellsAsync=k,t.evalName=I,t.createEvaluator=function(e){return{evalFormula:(t,r)=>b(e,t,r),evalCells:(t,r)=>T(e,t,r),evalName:(t,r,n)=>I(e,t,r,n),evalCellsAsync:(t,r)=>k(e,t,r)}}},64316:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isRangeValues=t.rangeValues=t.DerefOperKind=t.machine=void 0;const n=r(74643).__importStar(r(98677));var a;t.machine=n,function(e){e.RangeValues="RangeValues"}(a||(t.DerefOperKind=a={})),t.rangeValues=function(e){return{kind:a.RangeValues,arrays:e}},t.isRangeValues=function(e){return e.kind===a.RangeValues}},98677:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.refToVal=t.ArrayMachine=t.earlyReturn=t.EarlyReturnKind=t.ThenMachine=t.isMachineCall=t.machineCall=t.MachineCallKind=t.readOperType=t.singleReadOperType=void 0;const n=r(74643),a=r(70633),i=r(54051),o=r(92158),s=r(43376),u=r(79673);var l,c;function d(e){return e.kind===l.MachineCall}n.__exportStar(r(54051),t),t.singleReadOperType=u.OperKind.Number|u.OperKind.String|u.OperKind.Boolean|u.OperKind.Error|u.OperKind.Blank|u.OperKind.Rich,t.readOperType=t.singleReadOperType|u.OperKind.Array,function(e){e.MachineCall="MachineCall"}(l||(t.MachineCallKind=l={})),t.machineCall=function(e){return{kind:l.MachineCall,machine:e}},t.isMachineCall=d,t.ThenMachine=class{next(){try{if(void 0===this.oper1){const e=this.f1();if(d(e))return(0,i.callMachineTransition)(e.machine,this);this.oper1=e}if(void 0===this.oper2){const e=this.f2(this.oper1);if(d(e))return(0,i.callMachineTransition)(e.machine,this);this.oper2=e}return(0,s.success)(this.oper2)}catch(e){return this.context.handleEvaluationError(e)??(0,s.failure)((0,s.javaScriptError)(e))}}receiveResult(e){return(0,s.isSuccess)(e)?(void 0===this.oper1?this.oper1=e.value:void 0===this.oper2&&(this.oper2=e.value),i.nextTransition):e}constructor(e,t,r){this.context=e,this.f1=t,this.f2=r,this.runStatus=!1,this.oper1=void 0,this.oper2=void 0}},function(e){e.EarlyReturn="EarlyReturn"}(c||(t.EarlyReturnKind=c={})),t.earlyReturn=function(e){return{kind:c.EarlyReturn,value:e}},t.ArrayMachine=class{next(){try{if(void 0!==this.toDeref){const e=this.coercer(this.toDeref,this.opers.length,this.row.length);if(e.kind===c.EarlyReturn)return e.value;this.row.push(e),this.row.length===this.cols&&(this.opers.push(this.row),this.row=[]),this.toDeref=void 0}if(this.opers.length>=this.rows)return(0,s.success)((0,a.arrayOper)(this.rows,this.cols,this.opers));const e=this.func(this.opers.length,this.row.length);return d(e)?(0,i.callMachineTransition)(e.machine,this):(this.toDeref=e,i.nextTransition)}catch(e){return this.context.handleEvaluationError(e)??(0,s.failure)((0,s.javaScriptError)(e))}}receiveResult(e){return(0,s.isSuccess)(e)?(this.toDeref=e.value,i.nextTransition):e}constructor(e,t,r,n,a){this.context=e,this.rows=t,this.cols=r,this.func=n,this.coercer=a,this.runStatus=!1,this.toDeref=void 0,this.row=[],this.opers=[]}},t.refToVal=function(e,t,r){if(!(0,o.isRangeOper)(t))return t;if(!(0,o.isSheetIndex)(t.sheets))return a.valueErrorOper;if(!r)return 1===t.ranges.length&&(0,o.isGridCell)(t.ranges[0])?e.dereferenceOper(t,u.SignatureType.All&~u.OperKind.Range):e.dereferenceOper(t,u.OperKind.Array);const n=e.dereferenceOper(t,u.SignatureType.All&~(u.OperKind.Range|u.OperKind.Array));return(0,o.isArrayOper)(n)?a.naErrorOper:n}},95625:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyOperator=t.cmpNum=t.cmpStr=t.cmpBool=t.cmpInt=void 0;const n=r(84949),a=r(36094),i=r(19552),o=r(70633),s=r(18612),u=r(59242),l=r(79673),c=r(11181),d=r(92158),g=r(36094);function m(e,r,n){return(0,t.cmpInt)(e,r.value-n.value)}function h(e,r,n,a){return(0,t.cmpInt)(r,e.stringCompareCI(n.value,a.value))}function p(e,r,n,a){return(0,t.cmpInt)(r,e.compare(n,a))}function f(e,t,r){if((0,d.isSheetIndex)(t.sheets))if((0,d.isSheetIndex)(r.sheets))if((0,d.isDocumentLocEqual)(t.sheets.document,r.sheets.document)){if(t.sheets.index===r.sheets.index)return(0,c.sheetIndex)(t.sheets.document,t.sheets.index);{const i=`different sheet, range1 = ${(0,n.anonymize)(t)}, range2 = ${(0,n.anonymize)(r)}`;(0,a.traceErrorOper)(e,o.ErrorType.VALUE,i)}}else{const i=`different document, range1 = ${(0,n.anonymize)(t)}, range2 = ${(0,n.anonymize)(r)}`;(0,a.traceErrorOper)(e,o.ErrorType.VALUE,i)}else(0,a.traceErrorOper)(e,o.ErrorType.VALUE,`3D reference, range2 = ${(0,n.anonymize)(r)}`);else(0,a.traceErrorOper)(e,o.ErrorType.VALUE,`3D reference, range1 = ${(0,n.anonymize)(t)}`)}t.cmpInt=d.applyComparison,t.cmpBool=m,t.cmpStr=h,t.cmpNum=p,t.applyOperator=function(e,r,c,S=!1){const{mathpack:v}=e.config;if(1===c.length){const e=c[0];switch(r){case u.OperatorId.Percent:return v.percent(e);case u.OperatorId.Neg:return v.neg(e);case u.OperatorId.Pos:return e;default:{const e=`calc.runtime.applyOperator: bad application of ${r} to 1 argument`;return s.ulsLogger.ULS.assertTag(593372496,i.LogCategory.msoulscat_ES_EWAJS,!1,e)}}}if(2===c.length){const F=c[0],y=c[1];switch(r){case u.OperatorId.Add:{const e=v.add(F,y);return S&&(0,d.isNumberOper)(e)?v.checkAlmostCancellation(F,e):e}case u.OperatorId.Sub:{const e=v.sub(F,y);return S&&(0,d.isNumberOper)(e)?v.checkAlmostCancellation(F,e):e}case u.OperatorId.Mul:return v.mul(F,y);case u.OperatorId.Div:return v.div(F,y);case u.OperatorId.Pow:return v.power(F,y);case u.OperatorId.Concat:return(0,o.stringOper)((F.value+y.value).substring(0,o.cellStringLimit));case u.OperatorId.Eq:case u.OperatorId.Ne:case u.OperatorId.Lt:case u.OperatorId.Le:case u.OperatorId.Gt:case u.OperatorId.Ge:return(0,o.booleanOper)(function(e,r,n,a){const{localeInfo:i,mathpack:s}=e.config;if(n.kind!==a.kind){if((0,d.isBlankOper)(n))switch(a.kind){case l.OperKind.Number:return p(s,r,s.zero,a);case l.OperKind.String:return h(i,r,g.emptyStringOper,a);case l.OperKind.Boolean:return m(r,o.falseOper,a)}if((0,d.isBlankOper)(a))switch(n.kind){case l.OperKind.Number:return p(s,r,n,s.zero);case l.OperKind.String:return h(i,r,n,g.emptyStringOper);case l.OperKind.Boolean:return m(r,n,o.falseOper)}return(0,t.cmpInt)(r,n.kind-a.kind)}switch(n.kind){case l.OperKind.Number:return p(s,r,n,a);case l.OperKind.String:return h(i,r,n,a);case l.OperKind.Boolean:return m(r,n,a);case l.OperKind.Blank:return(0,t.cmpInt)(r,0);default:return!1}}(e,r,F,y));case u.OperatorId.Range:return function(e,t){const r=f("calc.runtime.applyRangeOp",e,t);if(null==r)return o.valueErrorOper;const n=(0,d.gridRangesJoin)(e.ranges),a=(0,d.gridRangesJoin)(t.ranges),i=[(0,d.gridRangeJoin)(n,a)];return(0,o.rangeSeqOper)(r,i)}(F,y);case u.OperatorId.Isect:return function(e,t){const r=f("calc.runtime.applyIsectOp",e,t);if(null==r)return o.valueErrorOper;const i=[];for(let r=0;r<e.ranges.length;r+=1)for(let n=0;n<t.ranges.length;n+=1){const a=(0,d.gridRangeIsect)(e.ranges[r],t.ranges[n]);null!=a&&i.push(a)}if(0===i.length){const r=`empty intersection, range1 = ${(0,n.anonymize)(e)}, range2 = ${(0,n.anonymize)(t)}`;return(0,a.traceErrorOper)("calc.runtime.applyIsectOp",o.ErrorType.NULL,r),o.nullErrorOper}return(0,o.rangeSeqOper)(r,i)}(F,y);case u.OperatorId.Union:return function(e,t){const r=f("calc.runtime.applyUnionOp",e,t);return null==r?o.valueErrorOper:(0,o.rangeSeqOper)(r,e.ranges.concat(t.ranges))}(F,y);case u.OperatorId.And:return(0,o.booleanOper)(F.value&&y.value);case u.OperatorId.Or:return(0,o.booleanOper)(F.value||y.value);case u.OperatorId.Xor:return(0,o.booleanOper)(F.value!==y.value);case u.OperatorId.Min:return v.cond2(F,y)<=0?F:y;case u.OperatorId.Max:return v.cond2(F,y)>=0?F:y;default:{const e=`calc.runtime.applyOperator: bad application of ${r} to 2 arguments`;return s.ulsLogger.ULS.assertTag(593372497,i.LogCategory.msoulscat_ES_EWAJS,!1,e)}}}const F=`calc.runtime.applyOperator: bad application of ${r} to ${c.length} arguments`;return s.ulsLogger.ULS.assertTag(593372498,i.LogCategory.msoulscat_ES_EWAJS,!1,F)}},57186:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGridRangeTable=t.gridRangeDistance=void 0;const n=r(64481),a=r(71766),i=r(92158);function o(e,t){const{row:r,col:n,rows:i,cols:o}=e,{row:s,col:u,rows:l,cols:c}=t;return(0,a.fastAbs)(r-s+.5*(i-l))+(0,a.fastAbs)(n-u+.5*(o-c))}t.gridRangeDistance=o,t.makeGridRangeTable=function(){return n.RTree.create(i.gridRangeJoin,i.gridRangeIsects,i.gridRangeCompare,o)}},59370:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runtimePositionFirstOrderFunc=t.runtimePositionFormulaRoot=t.runtimePositionEtaLambdaBody=t.runtimePositionLambdaParam=t.runtimePositionLambdaRoot=t.runtimePositionLetVal=t.breaked=t.paused=t.limitExceeded=t.previousNameFailure=t.previousFailure=t.cellCycle=t.nameCycle=t.evalLocals=t.evalGlobals=t.userDefinedFunc=t.stopped=t.cellFormula=t.cellWellFormedFormula=t.pendingValue=t.finalValue=t.illFormedFormula=t.LimitKind=t.StepAction=t.RuntimePositionKind=t.stackValue=t.Interrupt=t.CellKind=t.interval=t.compileLocalsName=t.compileLocalsGrid=t.createCompileGlobals=t.ReasonKind=void 0;const n=r(18612),a=r(71766),i=r(92158),o=r(11181),s=r(75811),u=r(43376),l=r(184);var c,d,g,m,h,p;!function(e){e.Timeout="Timeout",e.Breakpoint="Breakpoint",e.Stopped="Stopped",e.NameCycle="NameCycle",e.CellCycle="CellCycle",e.PreviousFailure="PreviousFailure",e.PreviousNameFailure="PreviousNameFailure",e.LimitExceeded="LimitExceeded",e.IllFormedFormula="IllFormedFormula"}(c||(c={})),t.ReasonKind={...i.ReasonKind,...c,...s.FormatReasonKind,...l.ResolveReasonKind},t.createCompileGlobals=function(e){return{config:e}},t.compileLocalsGrid=function(e,t,r){return{config:r??void 0,lexicalKind:e,originGridCell:(0,u.success)(t),allowUnqualifiedCell:!0,emitStepInfo:!1}},t.compileLocalsName=function(e,t){return{config:t??void 0,lexicalKind:o.LexicalKind.NameManager,originGridCell:(0,u.success)(e),allowUnqualifiedCell:!1,emitStepInfo:!1}},t.interval=(0,a.typedInstanceCreator)()(((e,t)=>((0,n.assertPositiveInteger)("calc.runtime.interval: end",t),(0,n.assertIndex)("calc.runtime.interval: start",e,t),{start:e,end:t}))),function(e){e.FinalValue="FinalValue",e.PendingValue="PendingValue"}(d||(t.CellKind=d={})),function(e){e[e.Continue=1]="Continue",e[e.Stop=2]="Stop"}(g||(t.Interrupt=g={})),t.stackValue=(0,a.typedInstanceCreator)()(((e,t)=>({label:e,value:t}))),function(e){e.LetVar="LetVar",e.LambdaRoot="LambdaRoot",e.LambdaParam="LambdaParam",e.EtaLambdaBody="EtaLambdaBody",e.FormulaRoot="FormulaRoot",e.FirstOrderFunc="FirstOrderFunc"}(m||(t.RuntimePositionKind=m={})),function(e){e.Continue="Continue",e.Break="Break"}(h||(t.StepAction=h={})),function(e){e[e.CellChain=0]="CellChain",e[e.NameChain=1]="NameChain",e[e.LambdaCalls=2]="LambdaCalls",e[e.LambdaDepth=3]="LambdaDepth"}(p||(t.LimitKind=p={})),t.illFormedFormula=function(e,r,n){return{kind:t.ReasonKind.IllFormedFormula,message:e,mode:r,diagnostics:n}},t.finalValue=function(e){return{kind:d.FinalValue,oper:e}},t.pendingValue=function(e){return{kind:d.PendingValue,anchor:e}},t.cellWellFormedFormula=function(e,t){return{source:e,formula:t}},t.cellFormula=function(e,t){return{source:e,formula:t}},t.stopped={kind:t.ReasonKind.Stopped},t.userDefinedFunc=function(e,t){return{arity:e,func:t}},t.evalGlobals=function(e,t,r,n,a,o,s,l,c,d,m,h,p,f,S,v,F,y,C,A,E,b,R,T,k,N,I,O,_,P){return{config:e,getDocumentLoc:t,getSheetIndex:r,getSheetName:n,getSheetRangeIndexes:a,getNameLoc:o,getUserDefinedFuncLoc:s,getCellValue:l,getCellValues:c,getWorksheetFunc:d,getUserDefinedFunc:m,getNameFormula:h,getCellFormula:p,getUsedRange:f,interruptToken:[g.Continue],tryGetHiddenRows:S,tryGetHiddenCols:v,isInFilterMode:F,getKnownFormat:y,getIformat:C,getFormatString:A,getRandom:E,getTime:b,schedulerConfig:null!=_?_:{},limits:null!=P?P:{},setCellValue:R,setCellValues:T,setCellFailure:k,getContainingTable:N,getStructRefColumn:I,getStructRefSpecialRef:O,getIntersectingTables:()=>(0,u.failure)((0,i.notImplemented)(["getIntersectingTables"]))}},t.evalLocals=(0,a.typedInstanceCreator)()(((e,t,r,n,a,i,o,s,u,l,c)=>({lexicalSource:e,originGridCell:t,originSheet:r,calcingArray:n,reflectionGridCell:a,reflectionSheet:i,implicitIntersect:o,allowUnqualifiedCell:s,wrapCellReferences:u,followHyperlinks:l,contextNames:c}))),t.nameCycle=function(e){return{kind:t.ReasonKind.NameCycle,names:e}},t.cellCycle=function(e){return{kind:t.ReasonKind.CellCycle,cells:e}},t.previousFailure=function(e){return{kind:t.ReasonKind.PreviousFailure,range:e}},t.previousNameFailure=function(e){return{kind:t.ReasonKind.PreviousNameFailure,name:e}},t.limitExceeded=function(e){return{kind:t.ReasonKind.LimitExceeded,limit:e}},t.paused=function(e){return{kind:u.ResultKind.Paused,reason:t.ReasonKind.Timeout,resume:e}},t.breaked=function(e){return{kind:u.ResultKind.Breaked,resume:e}},t.runtimePositionLetVal=function(e,t){return{kind:m.LetVar,varNamePosition:e,varBinderPosition:t}},t.runtimePositionLambdaRoot=function(e,t,r){return{kind:m.LambdaRoot,lambdaNodePosition:e,head:t,args:r}},t.runtimePositionLambdaParam=function(e,t,r){return{kind:m.LambdaParam,idx:e,paramNodePosition:t,paramNamePosition:r}},t.runtimePositionEtaLambdaBody=function(e){return{kind:m.EtaLambdaBody,wsfId:e}},t.runtimePositionFormulaRoot={kind:m.FormulaRoot},t.runtimePositionFirstOrderFunc={kind:m.FirstOrderFunc}},66096:function(e,t,r){"use strict";var n,a;Object.defineProperty(t,"__esModule",{value:!0}),t.transformBottomUp=t.isOperTerm=t.postStepTerm=t.callMachineTerm=t.callFirstOrderFuncTerm=t.callLambdaTerm=t.callNameTerm=t.noopTerm=t.conditionalTerm=t.readStackTerm=t.structRefTerm=t.cellRefTerm=t.udfTerm=t.nameTerm=t.appTerm=t.letTerm=t.lambdaTerm=t.arrayTerm=t.isOperatorName=t.worksheetFunctionNameToId=t.worksheetFunctionIdToName=t.operatorNameToId=t.operatorIdToName=t.TermKind=void 0;const i=r(71766),o=r(18612),s=r(56497);var u;function l(e,t){return{kind:e,data:void 0,children:void 0,position:t}}function c(e,t,r,n){const a=l(u.Array,n);return a.children=r,a.data={rows:e,cols:t},a}function d(e,t,r,n){(0,o.assertTrue)("calc.runtime.lambdaTerm: defsAndBody",r.length===1+t.reduce(((e,t)=>e+(t.hasDef?1:0)),0)),(0,o.assertTrue)("calc.runtime.lambdaTerm: params",t.every(((e,t,r)=>!(e.hasDef&&e.isRest||e.isRest&&t!==r.length-1))));const a=l(u.Lambda,n);return a.children=r,a.data={checkArity:e,params:t},a}function g(e,t,r,n,a){(0,o.assertTrue)("calc.runtime.letTerm",e.length===r.length);const i=l(u.Let,a);return i.children=[...e,n],i.data={rec:t,varLabels:r},i}!function(e){e[e.Array=-2147483648]="Array",e[e.Lambda=-2147483647]="Lambda",e[e.Let=-2147483646]="Let",e[e.App=-2147483645]="App",e[e.Name=-2147483644]="Name",e[e.Udf=-2147483643]="Udf",e[e.CellRef=-2147483642]="CellRef",e[e.ReadStack=-2147483641]="ReadStack",e[e.Conditional=-2147483640]="Conditional",e[e.StructRef=-2147483639]="StructRef",e[e.Noop=-2147483638]="Noop",e[e.CallLambda=-2147483637]="CallLambda",e[e.CallName=-2147483636]="CallName",e[e.CallFirstOrderFunc=-2147483635]="CallFirstOrderFunc",e[e.CallMachine=-2147483634]="CallMachine",e[e.PostStep=-2147483633]="PostStep"}(u||(t.TermKind=u={})),n=(0,i.makeNewtypeIso)(i.identity,i.identity),t.operatorIdToName=n.wrap,t.operatorNameToId=n.unwrap,a=(0,i.makeNewtypeIso)((e=>-e),(e=>-e)),t.worksheetFunctionIdToName=a.wrap,t.worksheetFunctionNameToId=a.unwrap,t.isOperatorName=function(e){return e>0},t.arrayTerm=c,t.lambdaTerm=d,t.letTerm=g;const m=[];function h(e,t,r,n=m,a,i){const o=l(u.App,i);return o.children=a,o.data={funName:e,funType:t,isFormulaRoot:r,args:n},o}function p(e,t,r,n,a){const i=l(u.Name,a);return i.data={name:e,qualifier:t,source:r},i.children=n,i}function f(e,t,r,n){const a=l(u.Udf,n);return a.data={name:e,qualifier:t},a.children=r,a}function S(e,t,r,n,a,i){const o=l(u.Conditional,i);return o.children=[n,...a],o.data={funName:e,funType:t,isFormulaRoot:r,args:m},o}function v(e,t){const r=l(u.Noop,t);return r.children=e,r}function F(e){return e.kind>0}t.appTerm=h,t.nameTerm=p,t.udfTerm=f,t.cellRefTerm=function(e,t,r){const n=l(u.CellRef,r);return n.data={ref:e,qualifier:t},n},t.structRefTerm=function(e,t){const r=l(u.StructRef,t);return r.data=e,r},t.readStackTerm=function(e,t){const r=l(u.ReadStack,t);return r.data=e,r},t.conditionalTerm=S,t.noopTerm=v,t.callNameTerm=function(e,t,r){const n=l(u.CallName,r);return n.children=t,n.data={loc:e},n},t.callLambdaTerm=function(e,t,r,n,a){const i=l(u.CallLambda,void 0);return i.children=a,i.data={capturedLocals:e,capturedStackEnv:t,capturedStackMap:r,caller:n},i},t.callFirstOrderFuncTerm=function(e,t,r){const n=l(u.CallFirstOrderFunc,void 0);return n.children=r,n.data={source:e,caller:t},n},t.callMachineTerm=function(e,t){const r=l(u.CallMachine,t);return r.data={machine:e},r},t.postStepTerm=l(u.PostStep,void 0),t.isOperTerm=F,t.transformBottomUp=function(e,t){function r(e){if(F(e))return s.Pledge.resolve(e);switch(e.kind){case u.Let:return s.Pledge.all(e.children.map(n)).bind((t=>g(t.slice(0,t.length-1),e.data.rec,e.data.varLabels,t[t.length-1],e.position)));case u.App:return s.Pledge.all(e.children.map(n)).bind((t=>h(e.data.funName,e.data.funType,e.data.isFormulaRoot,e.data.args,t,e.position)));case u.Conditional:return s.Pledge.all(e.children.map(n)).bind((([t,...r])=>S(e.data.funName,e.data.funType,e.data.isFormulaRoot,t,r,e.position)));case u.Lambda:return s.Pledge.all(e.children.map(n)).bind((t=>d(e.data.checkArity,e.data.params,t,e.position)));case u.Array:return s.Pledge.all(e.children.map((e=>s.Pledge.all(e.map(n))))).bind((t=>c(e.data.rows,e.data.cols,t,e.position)));case u.Name:return(void 0===e.children?s.Pledge.resolve(void 0):n(e.children)).bind((t=>p(e.data.name,e.data.qualifier,e.data.source,t,e.position)));case u.Udf:return(void 0===e.children?s.Pledge.resolve(void 0):n(e.children)).bind((t=>f(e.data.name,e.data.qualifier,t,e.position)));case u.CellRef:case u.StructRef:case u.ReadStack:return s.Pledge.resolve(e);case u.Noop:return n(e.children).bind((t=>v(t,e.position)));default:return(0,o.assertNever)("calc.runtime.transformBottomUp",e)}}function n(e){return s.Pledge.resolve(e).bind(r).bind(t)}return s.Pledge.settleOrThrow(n(e))}},45077:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomCellEvaluationTest=t.randomTestSheetContents=t.randomTestCellContents=t.randomTestFormula=t.runCellEvaluationTest=t.runMockCellEvaluationTest=t.makeRandomizedTimer=t.abstractEvalCells=t.sheet=t.document=t.makeDirtyCellContents=t.makeFailedCellContents=t.makeFinalCellContents=t.TestCellState=t.SpecialContents=t.locationFormula=t.locationValue=t.parsed=t.compiled=t.makeTestContext=void 0;const n=r(18612),a=r(93371),i=r(47128),o=r(70186),s=r(59370),u=r(31663),l=r(76950),c=r(97392),d=r(58385),g=r(57837),m=r(11181),h=r(92158),p=r(10087),f=r(72189),S=r(19552),v=r(49043),F=r(69210),y=r(70633),C=r(59242),A=r(70221),E=r(98677),b=r(17277),R=r(64462),T=r(13597),k=r(43376),N=r(7537),I=r(59884),O=r(15569),_=r(50468),P=r(65176),M=r(3825);function D(e,r,n,a,i=!1){const u=r.kind===m.LexicalKind.NameManager?(0,o.analyzeLocalsName)((0,m.sheetGridCell)(t.sheet,n)):(0,o.analyzeLocalsGrid)(r.kind,(0,m.sheetGridCell)(t.sheet,n)),l=e.analyzer.checkFormula(u,a);if((0,k.isSuccess)(l)&&(0,h.isWellFormed)(l.value)){const t=r.kind===m.LexicalKind.NameManager?(0,s.compileLocalsName)(n):(0,s.compileLocalsGrid)(r.kind,n),a=e.compiler.compileFormula(i?{...t,emitStepInfo:i}:t,l.value);if(a.kind===k.ResultKind.Success)return a.value;throw new Error(`unexpected result ${JSON.stringify(a)}`)}throw new Error(`not well formed formula ${JSON.stringify(l)}`)}var w,L;t.makeTestContext=function(e,t,r){const n=(0,O.createArrayLogger)();(0,v.initCalc)(n,e??i.featureEnabledDummyCallback),(0,M.overrideTypedFeatureGates)(M.getTypedFeatureGate,{"Microsoft.Office.Excel.CalcEtaLambda":!0,"Microsoft.Office.Excel.EtaReducedLambdas":!0});const a=(0,S.calcConfig)(t??(0,S.getEnglishLocaleInfo)(),void 0,r),o={config:a},s={config:a},u={config:a};return{logger:n,config:a,compileGlobals:s,parser:(0,f.createParser)(o),analyzer:(0,b.createAnalyzer)(u),compiler:(0,c.createCompiler)(s)}},t.compiled=D,t.parsed=function(e,t,r,a=F.RefStyle.A1,i=(t.kind!==m.LexicalKind.NameManager?(0,h.gridRangeAnchor)(t.range.range):(0,n.assertFalse)("must pass origin for LexicalSourceName")),o=!1,s){const u=e.parser.parseFormula((0,p.parseLocals)(t.kind,i,{refStyle:a},s),r);if(u.kind!==k.ResultKind.Success)throw new Error(`unexpected result ${JSON.stringify(u)}`);return D(e,t,i,u.value,o)},t.locationValue=function(e,t){return{cell:e,oper:t}},t.locationFormula=function(e,t){return{source:e,formula:(0,F.formula)(t,[],[],1)}},function(e){e.ValueMocked="ValueMocked",e.ValueUnavailable="ValueUnavailable",e.FormulaUnavailable="FormulaUnavailable",e.EvalNotImplemented="EvalNotImplemented",e.EvalJavaScriptError="EvalJavaScriptError"}(w||(t.SpecialContents=w={})),function(e){e.Dirty="Dirty",e.Final="Final",e.Failed="Failed"}(L||(t.TestCellState=L={}));const x=(()=>{const e=(0,u.bottomEvalPrecedents)();return e.bound=y.PrecsBound.Exact,e})();function K(e,t,r){return{oper:e,reason:t,state:r,precedents:x}}function W(e){return K(e,void 0,L.Final)}function U(e){return K(e,void 0,L.Dirty)}function G({row:e,col:t}){return`R${e+1}C${t+1}`}function B(e,t){return"number"==typeof t?(0,F.literalNode)(e.config.mathpack.fromNumber(t)):t===w.EvalNotImplemented?(0,F.appNode)((0,F.wsfNode)(C.WorksheetFuncId.RAND,"RAND"),[]):t===w.EvalJavaScriptError?(0,F.appNode)((0,F.wsfNode)(C.WorksheetFuncId.NOW,"NOW"),[]):Array.isArray(t)?(0,F.appNode)((0,F.wsfNode)(C.WorksheetFuncId.SUM,"SUM"),t.map(B.bind(void 0,e))):(0,F.cellRefNode)((0,F.cellRefSingle)((0,d.absPos)(t.row),(0,d.absPos)(t.col)))}function V(e,t,r){const a={};for(const r in t){const i=t[r];if(null==i)continue;const o=i[1];if("number"==typeof o){const t=W(e.config.mathpack.fromNumber(o));a[r]=t}else if(Array.isArray(o)||o===w.FormulaUnavailable||o===w.EvalNotImplemented||o===w.EvalJavaScriptError){const e=U(y.blankOper);a[r]=e}else o===w.ValueUnavailable||o===w.ValueMocked||(0,n.assertNever)("calc.runtime.abstractEvalCells, tc",o)}const i={},o=[];function u(r,c){if("number"==typeof c)return(0,k.success)(e.config.mathpack.fromNumber(c));if(c===w.EvalNotImplemented)return(0,k.failure)({kind:s.ReasonKind.NotImplemented});if(c===w.EvalJavaScriptError)return(0,k.failure)({kind:s.ReasonKind.JavaScriptError});const d=[];for(let t=0;t<c.length;t+=1){const n=c[t];if("object"!=typeof n||Array.isArray(n)){const t=u(r,n);if(!(0,k.isSuccess)(t))return t;d.push(e.config.mathpack.toNumber(t.value))}else d.push(n)}for(let e=0;e<d.length;e+=1){const r=d[e];if("number"==typeof r)continue;const n=G(r),u=t[n];if(null!=u&&u[1]===w.ValueUnavailable)return(0,k.failure)({kind:s.ReasonKind.Unavailable});const l=a[n];if(null!=l&&l.state===L.Failed)return(0,k.failure)({kind:s.ReasonKind.PreviousFailure});const c=i[n];if(void 0!==c){for(let e=o.findIndex((e=>e===c));-1!==e&&e<o.length;e+=1)o[e].cycle=!0;return(0,k.failure)({kind:s.ReasonKind.CellCycle})}}let g=0;for(let t=0;t<d.length;t+=1){const i=d[t];if("number"==typeof i){g+=i;continue}const o=l(i);if(void 0!==o)return(0,k.failure)({kind:o});const u=G(i),c=a[u];if(null!=c){if(c.state===L.Failed)return(0,k.failure)({kind:r.cycle?s.ReasonKind.CellCycle:s.ReasonKind.PreviousFailure});(0,n.assertTrue)("calc.runtime.testUtil: Final after abstractEvalCell",c.state===L.Final),g+=e.config.mathpack.toNumber(c.oper)}}return(0,k.success)(e.config.mathpack.fromNumber(g))}function l(e){const r=G(e),l=t[r];if(null==l)return;const c=l[1];if("number"==typeof c||c===w.ValueUnavailable)return;let d=a[r];if(null==d&&(d=W(y.blankOper),a[r]=d),d.state===L.Failed)return void(0,n.assertTrue)("calc.runtime.makeCellEvaluationTest",null!=d.reason);if(d.state===L.Final)return;const g={cycle:!1};(0,n.assertTrue)("calc.runtime.makeCellEvaluationTest.abstractEvalCell: undetected cycle",null==i[r]),i[r]=g,o.push(g);try{switch(c){case w.ValueMocked:return(0,n.assertFalse)("calc.runtime.makeCellEvaluationTest.abstractEvalCell: unexpected ValueMocked");case w.FormulaUnavailable:throw new Error("calc.runtime.makeCellEvaluationTest.abstractEvalCell: dummy Failure from getCellFormula")}const e=u(g,c);return(0,k.isSuccess)(e)?void function(e,t){if(e.state!==L.Dirty){const t=`expected dirty cellContent; given ${JSON.stringify(e)}`;(0,n.assertFalse)(`calc.runtime.makeCellEvaluationTest.setContentFinal: ${t}`)}e.oper=t,e.state=L.Final}(d,e.value):void function(e,t){if(e.state!==L.Dirty){const t=`expected dirty cellContent; given ${JSON.stringify(e)}`;(0,n.assertFalse)(`calc.runtime.makeCellEvaluationTest.setContentFailed: ${t}`)}e.reason=t,e.state=L.Failed}(d,e.reason.kind)}catch{return s.ReasonKind.JavaScriptError}finally{delete i[r],o.pop()}}return{evalResults:r.map((e=>{try{return l(e)}catch{return s.ReasonKind.JavaScriptError}})),sheetState:a}}function j(e){return"string"==typeof e?s.ReasonKind.PreviousFailure:e}function H(e){return null==e?e:{...e,reason:void 0}}function q(e,t){for(const r in e){const n=e[r];null!=n&&n.state===L.Dirty&&(delete e[r],delete t[r])}}function $(e,t){const r={};for(const n in e)r[n]=t(e[n]);return r}function z(e){const t=[];for(let r=0;r<e;r+=1)t.push(r);return t}function Q(e,t){return null==t?t:"number"==typeof t.row&&"number"==typeof t.col&&1===t.rows&&1===t.cols?`gridCell(${t.row}, ${t.col})`:128===t.kind&&1===Object.getOwnPropertyNames(t).length?"blankOper":t}function Y(e,r,i,o,c,d,p,S={}){const[v,N,O]=function(e,r){const i={},o={};function l(e){let t=i[e];return null==t&&(t=W(y.blankOper),i[e]=t),t}for(const a in r){const i=r[a];if(null==i)continue;const[s,u]=i;if("number"==typeof u)l(a).oper=e.config.mathpack.fromNumber(u);else if(Array.isArray(u)||u===w.EvalNotImplemented||u===w.EvalJavaScriptError){l(a).state=L.Dirty;const r=(0,F.formula)(B(e,u),[],[],2);o[a]=D(e,(0,m.lexicalSourceCell)((0,m.sheetGridCell)(t.sheet,s)),s,r)}else u===w.ValueMocked||u===w.FormulaUnavailable?l(a).state=L.Dirty:u===w.ValueUnavailable||(0,n.assertNever)("calc.runtime.makeCellEvaluationTest, tc",u)}function c(e,t){return(0,u.throwEvaluationError)((0,h.notImplemented)(["RAND"]))}function d(e,t){throw new Error("JavaScript error")}const p={config:e.config,getDocumentLoc:(e,r)=>(0,k.success)(t.document),getSheetIndex:(e,r)=>(0,k.success)(t.sheet.index),getSheetName:(e,t)=>(0,k.success)("Sheet1"),getSheetRangeIndexes:e=>(0,k.success)((0,m.sheetRangeIndexes)([t.sheet.index],0)),getNameLoc:(e,t)=>(0,k.failure)((0,h.unavailable)([`name at ${JSON.stringify((0,m.nameLoc)(e,t))}`])),getUserDefinedFuncLoc:(e,t)=>(0,k.success)([]),getCellValue:function(e){const t=G(e.range),n=r[t];if(null!=n&&n[1]===w.ValueUnavailable)return(0,k.failure)((0,h.unavailable)([`value at ${t}`]));const a=i[t];return null==a?(0,k.success)((0,s.finalValue)(y.blankOper)):a.state===L.Final?(0,k.success)((0,s.finalValue)(a.oper)):a.state===L.Failed?(0,k.failure)((0,s.previousFailure)(e)):(0,k.success)((0,s.pendingValue)(e))},getCellValues:function(e){const{sheet:t,range:{row:r,col:n,rows:i,cols:o}}=e;let u;const l=(0,a.jaggedArray)(i,o,((e,a)=>{const i=p.getCellValue((0,m.sheetGridCell)(t,(0,m.gridCell)(e+r,a+n)));return i.kind===k.ResultKind.Failure?(null==u&&(u=i),(0,s.finalValue)(y.blankOper)):i.value}));return null!=u?u:(0,k.success)(l)},getWorksheetFunc:function(e){if(e===C.WorksheetFuncId.SUM){const t=(0,g.getWorksheetFunc)(e);return null!=t?(0,k.success)(t):(0,k.failure)((0,h.notImplemented)(["SUM"]))}return(0,k.success)(e===C.WorksheetFuncId.RAND?c:d)},getUserDefinedFunc:()=>(0,k.failure)((0,h.unavailable)(["getUserDefinedFunc"])),getNameFormula:e=>(0,k.failure)((0,h.unavailable)([`name at ${JSON.stringify(e)}`])),getCellFormula:function(e){const t=G(e.range),n=r[t];if(null!=n&&n[1]===w.FormulaUnavailable)return(0,k.failure)((0,h.unavailable)([`formula at ${t}`]));const a=o[t];return null!=a?(0,k.success)((0,s.cellFormula)((0,m.lexicalSourceCell)(e),a)):(0,k.success)(void 0)},interruptToken:[s.Interrupt.Continue],tryGetHiddenRows:(e,t,r)=>(0,k.success)([]),tryGetHiddenCols:(e,t,r)=>(0,k.success)([]),isInFilterMode:e=>(0,k.success)(!1),getKnownFormat:()=>(0,k.failure)((0,h.notImplemented)(["getKnownFormat"])),getIformat:()=>(0,k.failure)((0,h.notImplemented)(["getIformat"])),getFormatString:()=>(0,k.failure)((0,h.notImplemented)(["getFormatString"])),getRandom:()=>(0,k.failure)((0,h.notImplemented)(["getRandom"])),getTime:()=>(0,k.failure)((0,h.notImplemented)(["getTime"])),schedulerConfig:{},limits:{},setCellValue:function(e,t){const r=G(e.range),a=i[r];if(null==a||a.state!==L.Dirty){const r=`expected dirty cell at ${JSON.stringify(e)} but have ${JSON.stringify(a)}; given ${JSON.stringify(t)}`;(0,n.assertFalse)(`calc.runtime.makeCellEvaluationTest.setCellValue: ${r}`)}a.oper=t,a.state=L.Final},setCellValues:(e,t)=>{throw new Error("unexpected call to setCellValues")},setCellFailure:function(e,t){if(!(0,h.isSheetGridCell)(e)){const t=`expected cell; given range ${JSON.stringify(e)}`;return(0,n.assertFalse)(`calc.runtime.makeCellEvaluationTest.setCellFailure: ${t}`)}const r=G(e.range),a=i[r];if(null==a||a.state!==L.Dirty){const r=`expected dirty cell at ${JSON.stringify(e)} but have ${JSON.stringify(a)}; given ${JSON.stringify(t)}`;(0,n.assertFalse)(`calc.runtime.makeCellEvaluationTest.setCellFailure: ${r}`)}a.reason=t.kind,a.state=L.Failed},getUsedRange:function(e){return(0,k.success)((0,m.sheetGridRange)(e,(0,m.gridRange)(0,0,m.sheetRows,m.sheetCols)))},getContainingTable:()=>(0,k.failure)((0,h.notImplemented)(["getContainingTable"])),getIntersectingTables:()=>(0,k.failure)((0,h.notImplemented)(["getIntersectingTables"])),getStructRefColumn:()=>(0,k.failure)((0,h.notImplemented)(["getStructRefColumn"])),getStructRefSpecialRef:()=>(0,k.failure)((0,h.notImplemented)(["getStructRefSpecialRef"]))};return[t.sheet,i,p]}(e,o);for(const e in S){const t=e;O[t]=S[t](O[t])}const _=[o,c,d,p],P=c.map((e=>(0,m.sheetGridCell)(v,e))),M=null!=p?p:z(c.length),x=[];for(let e=0;e<M.length;e+=1)x[M[e]]=e;const K={globals:O,resolver:(0,A.createResolver)(O),numberFormatter:(0,T.createNumberFormatter)(O),parser:(0,f.createParser)(O),printer:(0,I.createPrinter)(O),analyzer:(0,b.createAnalyzer)(O),createCellEvaluationMachine:r.createCellEvaluationMachine.bind(r),createFormulaEvaluationMachine:r.createFormulaEvaluationMachine.bind(r),createCallTermEvaluationMachine:r.createCallTermEvaluationMachine.bind(r)},U={globals:O,timer:i,machineContext:K},V=[];for(let e=0;e<M.length;e+=1){const t=P[M[e]];V.push(new E.VoidMachine(K.createCellEvaluationMachine(K,void 0,R.emptyVisitedCells,t)))}return new l.EvaluationRuntime(U,V).evaluateAsync((0,l.createSchedule)(U.globals.schedulerConfig)).then((e=>x.map((t=>{const r=e[t];return r.kind===k.ResultKind.Success?r.value:r.reason.kind})))).catch((e=>null!=e.reason?e.reason.stack:e.stack)).then((e=>{if(Array.isArray(e)){let t=e,r=N,{evalResults:n,sheetState:a}=d;null!=p&&(t=t.map(j),n=n.map(j),r=$(r,H),a=$(a,H),function(e,t){q(e,t),q(t,e)}(r,a));try{expect([_,t,r]).toEqual([_,n,a])}catch(e){throw console.warn("runMockCellEvaluationTest: test failure:",JSON.stringify({testData:_,testResults:t,testState:r},Q,2)),e}}else expect([_,e]).toEqual([_,void 0])}))}t.makeFinalCellContents=W,t.makeFailedCellContents=function(e,t){return K(e,t,L.Failed)},t.makeDirtyCellContents=U,t.document={path:void 0,name:"Book1"},t.sheet=(0,m.sheetIndex)(t.document,0),t.abstractEvalCells=V,t.makeRandomizedTimer=function(e=.5){return{doTimeout:t=>(0,N.randomFloat)()>e}},t.runMockCellEvaluationTest=Y,t.runCellEvaluationTest=function(e,t,r,n,a,i={}){return Y(e,{createCellEvaluationMachine:_.createCellEvaluationMachine,createFormulaEvaluationMachine:P.createFormulaEvaluationMachine,createCallTermEvaluationMachine:e=>{}},(0,l.runtimeTimer)(),t,r,n,a,i)};const J=3;function X(e,t,r=0){const n=(0,N.randomFloat)()*(r<J?1:.625);return n<.05?w.EvalJavaScriptError:n<.1?w.EvalNotImplemented:n<.55?1:[...new Array((0,N.randomIndex)(3)+1)].map((()=>(0,N.randomFloat)()<.5?(0,m.gridCell)((0,N.randomIndex)(e),(0,N.randomIndex)(t)):X(e,t,r+1)))}function Z(e,t){for(;;){const r=(0,N.randomFloat)();return r<.1?w.ValueUnavailable:r<.2?w.FormulaUnavailable:X(e,t)}}function ee(e,t){const r={};for(let n=0;n<e;n+=1)for(let a=0;a<t;a+=1)if((0,N.randomFloat)()<.5){const i=Z(e,t),o=(0,m.gridCell)(n,a);r[G(o)]=[o,i]}return r}t.randomTestFormula=X,t.randomTestCellContents=Z,t.randomTestSheetContents=ee,t.randomCellEvaluationTest=function(e,t,r){const n=ee(t,r);let a=[];for(const e in n){const t=n[e];null!=t&&(0,N.randomFloat)()<.75&&a.push(t[0])}return a=(0,N.randomShuffled)(a),[n,a,V(e,n,a),(0,N.randomFloat)()<.5?(0,N.randomShuffled)(z(a.length)):void 0]}},36094:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.arrayLift=t.makeStrict=t.gridRangeAnchorHash=t.broadcastWriteOper=t.isEmptyStringOper=t.emptyStringOper=t.traceErrorOper=t.writeOperType=t.singleWriteOperType=void 0;const n=r(93371),a=r(70633),i=r(92158),o=r(11181),s=r(71766),u=r(98677),l=r(79673),c=r(18612),d=r(19552);t.singleWriteOperType=l.OperKind.Number|l.OperKind.String|l.OperKind.Boolean|l.OperKind.Error|l.OperKind.Rich,t.writeOperType=t.singleWriteOperType|l.OperKind.Array,t.traceErrorOper=function(e,t,r){const n=`${e}: generated Excel error, type ${t}; ${r}`;c.ulsLogger.ULS.traceTag(596120270,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Verbose,n)},t.emptyStringOper=(0,a.stringOper)(""),t.isEmptyStringOper=function(e){return(0,i.isStringOper)(e)&&""===e.value},t.broadcastWriteOper=function(e,t,r){const o=(0,i.isArrayOper)(r)?(0,n.broadcastArray)(r.rows,r.cols,e,t,r.opers,a.naErrorOper):(0,n.constantArray)(e,t,r);return(0,a.arrayOper)(e,t,o)},t.gridRangeAnchorHash=function(e){return o.sheetCols*e.row+e.col},t.makeStrict=function(e){const t=e=>e&~(l.OperKind.Array|l.OperKind.Range);return(0,l.functionType)(e.minArgs,e.maxArgs,e.headTypes.map(t),e.restTypes.map(t),e.tailTypes.map(t),e.returnType,e.staticPrecs,e.flags)},t.arrayLift=function(e,t,r,o){let d=0,g=0;for(let e=0;e<o.length;e+=1){const r=o[e];(0,i.isArrayOper)(r)&&0==((0,i.getArgType)(t,e,o.length)&l.OperKind.Array)?(d=(0,s.fastMax)(d,r.rows),g=(0,s.fastMax)(g,r.cols)):(d=(0,s.fastMax)(d,1),g=(0,s.fastMax)(g,1))}const m=o.map(((r,o,s)=>function(e,t,r,i,o){switch(i.kind){case l.OperKind.Missing:case l.OperKind.Blank:return(0,n.constantArray2D)(t,r,e.zero);case l.OperKind.Array:return 0!=(o&l.OperKind.Array)?(0,n.constantArray2D)(t,r,i):(0,n.broadcastArray2D)(t,r,new n.StrictArray2D(i.rows,i.cols,i.opers),a.naErrorOper);case l.OperKind.Range:default:return(0,n.constantArray2D)(t,r,i)}}(e.mathpack,d,g,r,(0,i.getArgType)(t,o,s.length))));return(0,u.machineCall)(new u.ArrayMachine(e,d,g,((e,t)=>r(m.map((r=>r.get(e,t))))),(t=>{const r=e.coerceOper((0,u.refToVal)(e,t,!0),u.readOperType);return(0,c.assertTrue)("calc.runtime.arrayLift",!(0,i.isMissingOper)(r)&&!(0,i.isRangeOper)(r)),(0,i.isArrayOper)(r)?r.opers[0][0]:r})))}},7625:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LambdaOper=t.RecordOper=void 0;const n=r(70633),a=r(79673);t.RecordOper=class{getFallback(){return this._fallback}getField(e){return this._fields.getValue(e)}constructor(e,t=n.valueErrorOper){this._fields=e,this._fallback=t,this.kind=a.OperKind.Rich}},t.LambdaOper=class{getFallback(){return n.valueErrorOper}getField(e){}constructor(e,t,r,n,i,o,s){this.checkArity=e,this.lambdaNodeLabel=t,this.params=r,this.locals=n,this.stackEnv=i,this.stackMap=o,this.defsAndBody=s,this.kind=a.OperKind.Rich}}},64462:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.recordNameCycle=t.appendVisitedName=t.emptyVisitedNames=t.recordCellCycle=t.appendVisitedCell=t.emptyVisitedCells=void 0;const n=r(77981),a=r(59370),i=r(18612);function o(e,t,r){return void 0===e?void 0===t?0:-1:void 0===t?1:r(e,t)}function s(e,t){return e<t?-1:e===t?0:1}function u(e,t){return"string"==typeof e?"string"!=typeof t?1:s(e,t):"string"==typeof t||e<t?-1:e===t?0:1}function l(e,t){let r;return 0!==(r=s(e.name,t.name))?r:o(e.path,t.path,s)}function c(e,t){return{current:e,map:t}}function d(e,t){return{current:e,map:t}}t.emptyVisitedCells=c(void 0,n.RedBlackMapTree.create((function(e,t){let r;return 0!=(r=e.range.col-t.range.col)||0!=(r=e.range.row-t.range.row)||0!==(r=u(e.sheet.index,t.sheet.index))?r:l(e.sheet.document,t.sheet.document)}))),t.appendVisitedCell=function(e,t){return(0,i.assertTrue)("calc.runtime.appendVisitedCell",t.previous===e.current),c(t,e.map.setValue(t.cell,t))},t.recordCellCycle=function(e,t){const r=[],n=(0,a.cellCycle)(r);for(let a=t;r.push(a.cell),a.cycle=n,a!==e;a=a.previous);return r.reverse(),n},t.emptyVisitedNames=d(void 0,n.RedBlackMapTree.create((function(e,t){let r;return 0!==(r=s(e.name,t.name))||0!==(r=o(e.scope.index,t.scope.index,u))?r:l(e.scope.document,t.scope.document)}))),t.appendVisitedName=function(e,t){const r={name:t,previous:e.current};return d(r,e.map.setValue(t,r))},t.recordNameCycle=function(e,t){const r=[];for(let n=t;r.push(n.name),n!==e;n=n.previous);return r.reverse(),(0,a.nameCycle)(r)}},15569:function(e,t,r){"use strict";const n=r(91092);e.exports=n.arrayLogger},47128:function(e,t,r){"use strict";const n=r(91092);e.exports=n.testConfig},23490:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createAnalyzer=void 0;const n=r(80766),a=r(80730),i=r(94052);t.createAnalyzer=function(e){return{checkFormula:(t,r)=>(0,n.checkFormula)(e,t,r),checkFormulaWithDiagnostics:(t,r)=>(0,n.checkFormulaWithDiagnostics)(e,t,r),autocorrectFormula:(t,r)=>(0,a.autocorrectFormula)(e,t,r),resolveStaticPrecedents:(t,r)=>(0,i.resolveStaticPrecedents)(e,t,r)}}},80730:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocorrectFormula=void 0;const n=r(10741),a=r(18643),i=r(3085),o=r(46061),s=r(28581),u=r(49219),l=r(10228),c=r(88516),d=r(43436),g=r(46090),m=r(84538),h={getDocumentLoc:()=>(0,i.assertFalse)("calc.analyze.autocorrectFormula: default getDocumentLoc"),getSheetIndex:()=>(0,i.assertFalse)("calc.analyze.autocorrectFormula: default getSheetIndex"),getSheetName:()=>(0,i.assertFalse)("calc.analyze.autocorrectFormula: default getSheetName"),getNameLoc:()=>(0,i.assertFalse)("calc.analyze.autocorrectFormula: default getNameLoc"),getUserDefinedFuncLoc:()=>(0,i.assertFalse)("calc.analyze.autocorrectFormula: default getUserDefinedFuncLoc"),getSheetRangeIndexes:()=>(0,i.assertFalse)("calc.analyze.autocorrectFormula: default getSheetRangeIndexes"),getContainingTable:()=>(0,i.assertFalse)("calc.analyze.autocorrectFormula: default getContainingTable"),getStructRefColumn:()=>(0,i.assertFalse)("calc.analyze.autocorrectFormula: default getStructRefColumn"),getStructRefSpecialRef:()=>(0,i.assertFalse)("calc.analyze.autocorrectFormula: default getStructRefSpecialRef")},p=(0,a.createFailureErrorClass)("AutocorrectError"),f={...(0,s.binaryVisitor)((0,s.constVisitor)(!1),((e,t)=>e||t)),badSequenceNode:(e,t,r)=>!0,badCharsNode:(e,t,r)=>!0};class S extends s.IdentityVisitor{autocorrect(){return(0,s.reduceBottomUp)(f,this.f)?this.f.node:(0,s.reduceBottomUp)(this,this.f)}literalNode(e,t,r){return t||(this.seenUnclosed=!0),!this.locals.allowUnqualifiedCell&&e.kind===g.OperKind.Error&&e.type===m.ErrorType.REF&&this.qualifyCellRef()?(0,n.cellRefNode)((0,n.cellRefError)(),this.qualifyCellRef(),r):(0,n.literalNode)(e,t,r)}nameNode(e,t,r){const a=(0,n.nameNode)(e,t,r),s=(0,n.flattenNameParts)(e).parts,c={...this.locals,allowUnqualifiedCell:!0},{headResolved:d,fieldsResolved:g}=this.resolver.resolveDottedName(c,a,this.f.annotations);if((0,l.canDenoteCellRef)(c,t,s)){const[e,t,...r]=s;if(d.kind===u.ResolvedKind.ResolvedCellRef){const{ref:a,qualifier:o,label:u}=d.node,{ref:l,qualifier:c}=this.cellRefNode(a,o,u);(0,i.assertTrue)("calc.analyze.autocorrectFormula: resolved CellRefKind correct",a.kind===e.ref.kind),(0,i.assertTrue)("calc.analyze.autocorrectFormula: autocorrect doesn't change CellRefKind",l.kind===a.kind),(0,i.assertTrue)("calc.analyze.autocorrectFormula: autocorrect doesn't generate ErrorQualifier",c?.kind!==n.QualifierKind.Error),(0,i.assertTrue)("calc.analyze.autocorrectFormula: all flattened field parts resolved",s.length===1+g.length);const m=(e,{rhs:t,canDenoteNamedObject:r,label:a,qualifiedLabel:i})=>(0,n.fieldRefNamePart)(e,t,r,a,i);return(0,n.nameNode)(r.reduce(m,m((0,n.cellRefNamePart)(l,e.asWhole,e.label,e.qualifiedLabel),t)),c,u)}this.throwIfResolutionUnknown(d.resolution)}if(this.locals.allowRelativeQualifier&&void 0===t){if(d.kind===u.ResolvedKind.ResolvedName&&(0,o.isSuccess)(d.resolution)&&d.resolution.value&&void 0!==d.resolution.value.scope.index)return(0,n.nameNode)(e,this.qualifySheetName(d.resolution.value.scope),r);this.throwIfResolutionUnknown(d.resolution)}if(t&&(t.kind===n.QualifierKind.Sheet||t.kind===n.QualifierKind.Ident)){if(d.kind===u.ResolvedKind.ResolvedName&&(0,o.isSuccess)(d.resolution)&&d.resolution.value&&void 0===d.resolution.value.scope.index&&d.qualifierResolution===n.QualifierKind.Sheet)return(0,n.nameNode)(e,this.qualifyBookName(d.resolution.value.scope),r);this.throwIfResolutionUnknown(d.resolution)}return a}arrayNode(e,t,r){return t||(this.seenUnclosed=!0),(0,n.arrayNode)(e,t,r)}appNode(e,t,r,i){const o=this.appNodeBase(e,r,i);return r||(this.seenUnclosed=!0),(0,a.isOperatorNode)(e)||(this.seenParen=!0),(0,a.isOperatorNode)(e)&&t.some(a.isMissingNode)&&(this.seenMissingOperand=!0),(0,n.appNode)(e,t,o,i)}letNode(e,t,r,a,i,o){const s=this.appNodeBase(e,i,o);return i||(this.seenUnclosed=!0),this.seenParen=!0,(0,n.letNode)(e,t,r,a,s,o)}lambdaNode(e,t,r,a,i,o){const s=this.appNodeBase(e,i,o);return i||(this.seenUnclosed=!0),this.seenParen=!0,(0,n.lambdaNode)(e,t,r,a,s,o)}parenNode(e,t,r){return t||(this.seenUnclosed=!0),this.seenParen=!0,(0,n.parenNode)(e,t,r)}cellRefNode(e,t,r){return e.isBracketed&&"("===this.localeInfo.rcLeftBracket&&(this.seenParen=!0),this.locals.allowUnqualifiedCell||void 0!==t?(0,n.cellRefNode)(e,t,r):(0,n.cellRefNode)(e,this.qualifyCellRef(),r)}fieldRefNode(e,t,r){return t.isClosed||(this.seenUnclosed=!0),(0,n.fieldRefNode)(e,t,r)}structRefNode(e,t,r){if(t.isClosed||(this.seenUnclosed=!0),void 0!==e&&e.qualifier){const{resolution:a,qualifierResolution:i}=this.resolver.resolveName(this.locals,e,c.NameSource.StructRef);if((0,o.isSuccess)(a)&&a.value&&i===n.QualifierKind.Sheet)return(0,n.structRefNode)((0,n.nameNode)(e.parts,void 0,e.label),t,r);this.throwIfResolutionUnknown(a)}return(0,n.structRefNode)(e,t,r)}qualifyCellRef(){const e=this.locals.originSheet;if(!(0,o.isSuccess)(e))throw new p(e.reason);if(void 0===e.value.index)return;const t=this.globals.getSheetName(e.value.document,e.value.index);if(!(0,o.isSuccess)(t))throw new p(t.reason);return(0,n.sheetQualifier)(t.value,void 0,(0,d.shouldQuoteQualifier)(this.localeInfo,this.refStyle,t.value))}qualifySheetName(e){const t=this.globals.getSheetName(e.document,e.index);if(!(0,o.isSuccess)(t))throw new p(t.reason);return(0,n.sheetQualifier)(t.value,void 0,(0,d.shouldQuoteQualifier)(this.localeInfo,this.refStyle,t.value))}qualifyBookName({document:e}){return(0,n.identQualifier)(e.name,(0,d.shouldQuoteQualifier)(this.localeInfo,this.refStyle,e.name))}appNodeBase(e,t,r){return t||!(0,a.isOperatorNode)(e)&&this.isFormulaRoot(r)&&!this.seenParen&&!this.seenUnclosed&&!this.seenMissingOperand}isFormulaRoot(e){return this.f.annotations[e]?.kind===n.AnnotationKind.FormulaRoot}throwIfResolutionUnknown(e){if(!(0,o.isSuccess)(e)&&e.reason.kind!==u.ResolveReasonKind.NoOriginSheet&&e.reason.kind!==u.ResolveReasonKind.InvalidQualifier&&e.reason.kind!==u.ResolveReasonKind.InvalidCellRef&&e.reason.kind!==u.ResolveReasonKind.InvalidStructRef&&e.reason.kind!==u.ResolveReasonKind.EmptyIntersection)throw new p(e.reason)}constructor(e,t,r){super(),this.f=r,this.seenUnclosed=!1,this.seenParen=!1,this.seenMissingOperand=!1;const n=function(e){return{config:e.config,getDocumentLoc:e.getDocumentLoc?.bind(e)??h.getDocumentLoc,getSheetIndex:e.getSheetIndex?.bind(e)??h.getSheetIndex,getSheetName:e.getSheetName?.bind(e)??h.getSheetName,getNameLoc:e.getNameLoc?.bind(e)??h.getNameLoc,getUserDefinedFuncLoc:e.getUserDefinedFuncLoc?.bind(e)??h.getUserDefinedFuncLoc,getSheetRangeIndexes:e.getSheetRangeIndexes?.bind(e)??h.getSheetRangeIndexes,getContainingTable:e.getContainingTable?.bind(e)??h.getContainingTable,getStructRefColumn:e.getStructRefColumn?.bind(e)??h.getStructRefColumn,getStructRefSpecialRef:e.getStructRefSpecialRef?.bind(e)??h.getStructRefSpecialRef}}(e);this.globals=n,this.locals=t,this.resolver=(0,l.createResolver)(n),this.localeInfo=t.config?.localeInfo??e.config.localeInfo,this.refStyle=t.config?.refStyle??e.config.refStyle}}t.autocorrectFormula=function(e,t,r){try{const{spans:a,annotations:i,depthUpperBound:s}=r,u=new S(e,t,r).autocorrect();return(0,o.success)((0,n.formula)(u,a,i,s))}catch(e){return e instanceof p?(0,o.failure)(e.reason):(0,o.failure)((0,o.javaScriptError)(e))}}},80766:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkFormula=t.checkFormulaWithDiagnostics=void 0;const n=r(3085),a=r(6791),i=r(73421),o=r(9552),s=r(18643),u=r(46090),l=r(10741),c=r(84538),d=r(261),g=r(46061),m=r(88516),h=r(58088),p=r(10228),f={};function S(e,t){return{context:e,result:t}}const v=u.OperKind.String|u.OperKind.Boolean|u.OperKind.Error,F=(y=e=>0!=(e.kind&v),e=>e.kind===l.NodeKind.Literal&&y(e.oper));var y;function C(e,t,r,n=!1){n||(e.errorData=e.reportError(t,r,e.errorData))}function A(e,t){return t!==u.OperKind.Range||0!=(e&u.OperKind.Range)}function E(e,t){if(t.kind===l.NodeKind.Literal)switch(C(e,t,i.baseErrors.Unclosed_literal,t.isClosed),t.oper.kind){case u.OperKind.Number:case u.OperKind.Boolean:case u.OperKind.String:case u.OperKind.Error:return;case u.OperKind.Missing:break;default:return(0,n.assertNever)("calc.analyze.checker.checkArrayElement: literal kind",t.oper)}C(e,t,i.baseErrors.Illegal_array_literal_element)}function b(e,t,r,a,o){return h.Pledge.try((()=>{if(e.earlyExit&&!e.isOk())throw f;return N(e,t,o)})).bind((o=>(A(o.result,r)||((0,n.assertTrue)("calc.analyze.checker.check: typeSource passed",void 0!==a),C(e,t,{kind:i.TypeError.Types_not_related,typeGiven:o.result,typeExpected:r,typeSource:a})),o.result=r,o)))}function R(e,t,r){if(r.kind===l.NodeKind.Ident){const n=(0,s.getBoundName)(e.localeInfo,r.whole);return C(e,r,i.baseErrors.Invalid_binder,n.indexOf(".")<0),C(e,r,i.baseErrors.Duplicate_binder,!t.contains(n)),t.setValue(n,!0)}return C(e,r,r.kind===l.NodeKind.Missing?i.baseErrors.Missing_binder:i.baseErrors.Invalid_binder),t}const T=e=>0===e.args.length?e:e.args[e.args.length-1];function k(e,t){return h.Pledge.try((()=>(C(e,t,i.baseErrors.Unclosed_application,t.isClosed),(0,s.isWSFNode)(t.head)?function(e,t){return h.Pledge.try((()=>{const r=t.head.id,c=(0,d.getWorksheetFuncType)(r),{minArgs:g,maxArgs:p,headTypes:f,restTypes:v,tailTypes:F,flags:y}=c,A=t.args,E=A.length,k=(0,s.getArguments)(t.args).length;if(C(e,t.head,i.baseErrors.Invalid_function_name,(0==(y&u.FunctionFlags.OnlyParsedDuringLoad)||e.locals.workbookLoad)&&0==(y&u.FunctionFlags.Chart)&&(0==(y&u.FunctionFlags.Macro)||e.locals.lexicalKind===m.LexicalKind.NameManager)),k<g)switch(r){case d.WorksheetFuncId.IF:case d.WorksheetFuncId.LET:case d.WorksheetFuncId.LETREC:case d.WorksheetFuncId.LAMBDA:break;default:const n=A[E-1];C(e,void 0===n?t:n,{kind:i.TypeError.Insufficient_function_arguments,funcId:r,numArgsGiven:k,numArgsExpected:g})}if(k>p){const n=A[E-1];C(e,void 0===n?t:n,{kind:i.TypeError.Excess_function_arguments,funcId:r,numArgsGiven:k,numArgsExpected:p})}else if(v.length>1&&k>f.length+v.length){const n=(k-f.length)%v.length;n>F.length&&C(e,T(t),{kind:i.TypeError.Insufficient_function_arguments,funcId:r,numArgsGiven:k,numArgsExpected:k+(v.length-n)})}let I;if(t.kind===l.NodeKind.App)I=(0,s.getArguments)(t.args).map(((t,n)=>b(e,t,(0,s.getArgType)(c,n,k),{kind:i.TypeSourceKind.WSFArgument,funcId:r,argIndex:n,numArgsGiven:k})));else if(t.kind===l.NodeKind.Let)I=[...t.vars.map((({binder:e})=>e.arg)),...t.body?[t.body.arg]:[]].map((t=>N(e,t)));else{const r=t.params.map((({name:e})=>e.arg.def?.rhs)).filter(a.isDefined),n=t.body?[t.body.arg]:[];I=[...r.map((t=>N(e,t,i.baseErrors.Missing_default_expression))),...n.map((t=>N(e,t)))]}return h.Pledge.all(I).bind((r=>(function(e,t){const r=t.head.id,u=(0,s.getArguments)(t.args).length;switch(r){case d.WorksheetFuncId.IF:const c=e.locals.lexicalKind===m.LexicalKind.NameManager?1:2;return void(u<c&&C(e,T(t),{kind:i.TypeError.Insufficient_function_arguments,funcId:r,numArgsGiven:u,numArgsExpected:c}));case d.WorksheetFuncId._UDF:return C(e,t,i.baseErrors.Unexpected_application_head);case d.WorksheetFuncId.LET:case d.WorksheetFuncId.LETREC:{(0,n.assertTrue)("calc.analyze.applySpecificWorksheetFunctionChecks",t.kind===l.NodeKind.Let);let s=o.RedBlackMapTree.create(e.localeInfo.stringCompareCI);for(const{name:r}of t.vars)s=R(e,s,r.arg.name);for(const r of t.badArgs)C(e,r.arg,i.baseErrors.Invalid_binder);C(e,T(t),{kind:i.TypeError.Insufficient_function_arguments,funcId:r,numArgsGiven:u,numArgsExpected:(0,a.fastMax)(3,u+1+u%2)},u>=3&&void 0!==t.body);break}case d.WorksheetFuncId.LAMBDA:{(0,n.assertTrue)("calc.analyze.applySpecificWorksheetFunctionChecks",t.kind===l.NodeKind.Lambda);let a=o.RedBlackMapTree.create(e.localeInfo.stringCompareCI),c=!1;for(const{name:r}of t.params)C(e,r.arg.name,i.baseErrors.Unclosed_bracket,r.arg.name.isClosed),void 0!==r.arg.def&&C(e,r.arg.name,i.baseErrors.Binder_requires_brackets,r.arg.name.isBracketed),r.arg.isOptional?c=!0:C(e,r.arg,i.baseErrors.Mandatory_binder_after_optional,!c),a=R(e,a,r.arg.name.name);for(const r of t.badArgs)C(e,r.arg,i.baseErrors.Invalid_binder);u>=1&&void 0!==t.body?void 0!==t.body&&(0,s.isMissingLiteralNode)(t.body.arg)&&C(e,t.body.arg,i.baseErrors.Invalid_body):C(e,T(t),{kind:i.TypeError.Insufficient_function_arguments,funcId:r,numArgsGiven:u,numArgsExpected:u+1});break}}}(e,t),S(e,c.returnType))))}))}(e,t):(0,s.isOperatorNode)(t.head)?function(e,t){return h.Pledge.try((()=>{const{head:r,args:n}=t,a=r.id,o=(0,d.getOperatorType)(a),l=n.length,c=l===o.minArgs;return C(e,r,{kind:i.TypeError.Incorrect_number_of_operator_arguments,opId:a},c),h.Pledge.all(n.map(((t,r)=>h.Pledge.try((()=>b(e,t,(0,s.getArgType)(o,r,l),{kind:i.TypeSourceKind.OperatorArgument,opId:a,argIndex:r,numArgsGiven:l},{kind:i.SyntaxError.Missing_operation_argument,opId:a})))))).bind((t=>c&&!n.some(s.isMissingNode)?S(e,o.returnType):S(e,u.SignatureType.All)))}))}(e,t):function(e,t){return h.Pledge.try((()=>{const r=t.head,n=t.args,a=n.length,o=(0,s.getArguments)(n).length,c=n[a-1],g=(0,d.higherOrderFunctionType)().maxArgs-1;return o>g&&C(e,void 0===c?t:c,{kind:i.SyntaxError.Excess_higher_order_function_arguments,numArgsGiven:o,numArgsExpected:g}),h.Pledge.all(n.map((t=>b(e,t,u.SignatureType.All,void 0)))).bind((t=>N(e,r).bind((t=>(A(t.result,u.OperKind.Range)||0!=(t.result&(u.OperKind.Array|u.OperKind.Rich))||C(e,r,F(r)||r.kind===l.NodeKind.Array?i.baseErrors.Unexpected_application_head:i.baseErrors.Unexpected_application_head_with_fix),S(e,u.SignatureType.All))))))}))}(e,t))))}function N(e,t,r,a=!1){return h.Pledge.try((()=>{if(e.earlyExit&&!e.isOk())throw f;switch(t.kind){case l.NodeKind.App:case l.NodeKind.Let:case l.NodeKind.Lambda:return k(e,t);case l.NodeKind.Array:return function(e,t){return h.Pledge.try((()=>{C(e,t,i.baseErrors.Unclosed_array,t.isClosed);const r=t.nodes.length>0&&!(1===t.nodes.length&&1===t.nodes[0].length&&(0,s.isMissingNode)(t.nodes[0][0]));if(C(e,t,i.baseErrors.Empty_array_literal,r),!r)return S(e,u.OperKind.Array);const n=t.nodes[0].length;for(let r=0;r<t.nodes.length;r+=1){const a=t.nodes[r],o=a.length;C(e,t,i.baseErrors.Irregular_array_shape,o===n);for(let t=0;t<o;t+=1)E(e,a[t])}return S(e,u.OperKind.Array)}))}(e,t);case l.NodeKind.BadChars:case l.NodeKind.BadSequence:return function(e,t){return h.Pledge.try((()=>{if(t.kind===l.NodeKind.BadSequence){switch(t.type){case l.BadType.Unexpected:C(e,t,i.baseErrors.Bad_node,t.contents.some((e=>e.kind===l.NodeKind.BadChars||e.kind===l.NodeKind.BadSequence)));break;case l.BadType.StructRef:C(e,t.contents[0]??t,i.baseErrors.Invalid_struct_ref_table_name);break;case l.BadType.FieldRef:return void C(e,t,i.baseErrors.Unexpected_field_ref)}return h.Pledge.all(t.contents.map((t=>N(e,t))))}switch(t.type){case l.BadType.Unexpected:switch(t.chars){case")":return C(e,t,i.baseErrors.Unexpected_closing_paren);case e.localeInfo.rightBrace:return C(e,t,i.baseErrors.Unexpected_closing_brace);case e.localeInfo.rightBracket:return C(e,t,i.baseErrors.Unexpected_closing_bracket);case".":return C(e,t,i.baseErrors.Unexpected_dot);default:return C(e,t,{kind:i.SyntaxError.Unexpected_character,text:t.chars})}case l.BadType.NumberLiteral:return C(e,t,i.baseErrors.Invalid_number_literal);case l.BadType.StringLiteral:return C(e,t,i.baseErrors.Invalid_string_literal);case l.BadType.ErrorLiteral:return C(e,t,i.baseErrors.Invalid_error_literal);case l.BadType.FieldName:case l.BadType.ParamName:return C(e,t,i.baseErrors.Bad_node);case l.BadType.Qualifier:return C(e,t,i.baseErrors.Invalid_qualifier);default:(0,n.assertNever)("calc.analyze.diagnoseBadNode",t)}}))}(e,t).bind((()=>S(e,u.SignatureType.All)));case l.NodeKind.Missing:return!1!==r&&C(e,t,r??i.baseErrors.Bad_node),S(e,u.SignatureType.All);case l.NodeKind.CellRef:return e.locals.allowRelativeQualifier||t.qualifier?.kind!==l.QualifierKind.Relative?e.locals.allowUnqualifiedCell||void 0!==t.qualifier?t.qualifier?.kind===l.QualifierKind.Document||t.qualifier?.kind===l.QualifierKind.Bad?(C(e,t,i.baseErrors.Invalid_qualifier),S(e,u.SignatureType.All)):t.ref.kind===l.CellRefKind.Bad?(C(e,t,i.baseErrors.Invalid_cell_ref),S(e,u.SignatureType.All)):S(e,u.OperKind.Range):(C(e,t,i.baseErrors.Invalid_unqualified_cell),S(e,u.SignatureType.All)):(C(e,t,i.baseErrors.Invalid_rel_sheet_qualifier_in_cell),S(e,u.SignatureType.All));case l.NodeKind.Literal:return C(e,t,i.baseErrors.Unclosed_literal,t.isClosed),(0,s.isErrorOper)(t.oper)&&C(e,t,i.baseErrors.Invalid_error_literal,!((o=t.oper.type)>c.ErrorType.GETTING_DATA&&o!==c.ErrorType.BUSY&&o!==c.ErrorType.EXTERNAL)),S(e,t.oper.kind|((0,s.isErrorOper)(t.oper)&&t.oper.type===c.ErrorType.REF?u.OperKind.Range:0));case l.NodeKind.Name:{const{qualifier:r}=t;if((a||!e.locals.allowRelativeQualifier)&&r?.kind===l.QualifierKind.Relative)return C(e,t,i.baseErrors.Invalid_rel_sheet_qualifier_in_name),S(e,u.SignatureType.All);if(!e.locals.workbookLoad&&r?.kind===l.QualifierKind.Document&&!r.isQuoted)return C(e,t,i.baseErrors.Invalid_qualifier),S(e,u.SignatureType.All);if(r?.kind===l.QualifierKind.SheetRange||r?.kind===l.QualifierKind.Bad)return C(e,t,i.baseErrors.Invalid_qualifier),S(e,u.SignatureType.All);const n=(0,l.flattenNameParts)(t.parts).parts,o=e.annotations[n[0].label],s=e.annotations[t.label],c=s?.kind===l.AnnotationKind.AppHeadName;return o?.kind===l.AnnotationKind.LocalNameUse?C(e,t,i.baseErrors.Invalid_name,(0,p.canDenoteLocalName)(r,n)):C(e,t,a?i.baseErrors.Invalid_struct_ref_table_name:i.baseErrors.Invalid_name,t.parts.canDenoteNamedObject||(0,p.canDenoteUserDefinedFunc)(c,r,t.parts)||(0,p.canDenoteCellRef)(e.locals,r,n)),S(e,u.SignatureType.All)}case l.NodeKind.Paren:return C(e,t,i.baseErrors.Unclosed_paren,t.isClosed),C(e,t,i.baseErrors.Empty_parenthesis,!(0,s.isMissingNode)(t.node)),N(e,t.node,!1);case l.NodeKind.FieldRef:return C(e,t,i.baseErrors.Unclosed_bracket,t.rhs.isClosed),C(e,t,i.baseErrors.Unexpected_field_ref,!(0,s.isMissingNode)(t.lhs)&&!(0,s.isNumberLiteralNode)(t.lhs)),t.rhs.field.kind!==l.NodeKind.Ident&&C(e,t.rhs.field,t.rhs.field.kind===l.NodeKind.Missing?i.baseErrors.Missing_field_name:i.baseErrors.Invalid_field_name),N(e,t.lhs,!1).bind((t=>S(e,u.SignatureType.All)));case l.NodeKind.StructRef:if(C(e,t,i.baseErrors.Missing_struct_ref_table_name,void 0!==t.lhs||e.locals.allowImplicitTable),void 0===t.rhs.innerRef);else{const r=t=>{switch(t?.kind){case void 0:break;case l.StructRefKind.RangeOpRef:r(t.lhs),r(t.rhs);break;case l.StructRefKind.CommaOpRef:C(e,t,i.baseErrors.Invalid_struct_ref_comma_parts,(0,s.isCommaOpRefWellFormed)(t)),t.refs.forEach(r);break;case l.StructRefKind.SpecialRef:case l.StructRefKind.ColumnRef:C(e,t,i.baseErrors.Unclosed_bracket,t.isClosed);break;case l.StructRefKind.ThisRowOpRef:r(t.ref);break;case l.StructRefKind.MissingRef:C(e,t,i.baseErrors.Invalid_struct_ref_missing_part);break;case l.StructRefKind.BadRef:C(e,t,i.baseErrors.Unclosed_bracket,t.isClosed),C(e,t,i.baseErrors.Invalid_struct_ref_bad_part)}};r(t.rhs.innerRef)}return C(e,t,i.baseErrors.Unclosed_bracket,t.rhs.isClosed),(void 0===t.lhs?h.Pledge.resolve(void 0):N(e,t.lhs,void 0,!0)).bind((t=>S(e,u.SignatureType.All)));default:return(0,n.assertNever)("calc.analyze.checker.infer: unhandled formula case",t)}var o}))}const I={ok:!0,isOk:a.identity,collect:(e,t,r)=>!1};function O(e,t,{annotations:r},n,a=!0){const i={globals:e,locals:t,localeInfo:t.config?.localeInfo??e.config.localeInfo,annotations:r,reportError:n.collect,isOk:()=>n.isOk(i.errorData),earlyExit:a,errorData:n.ok};return i}function _(e,t){try{const r=h.Pledge.settleOrThrow(b(e,t.node,u.SignatureType.All,void 0,i.baseErrors.Empty_formula));return function(e,t){const r=t.annotations[t.node.label];function o(t){for(const r of t)C(e,r,i.baseErrors.Unclosed_comment,r.isClosed)}function s(e){const r=t.spans[e];null!=r&&(r.preComments&&o(r.preComments),r.postComments&&o(r.postComments))}r?.kind===l.AnnotationKind.FormulaRoot&&void 0!==r.syntaxFeatures&&r.syntaxFeatures[l.SyntaxFeature.Comments]&&h.Pledge.settleOrThrow(function e(t){return h.Pledge.try((()=>{switch(s(t.label),t.kind){case l.NodeKind.Literal:case l.NodeKind.Missing:case l.NodeKind.BadChars:break;case l.NodeKind.App:case l.NodeKind.Let:case l.NodeKind.Lambda:return t.head.kind===l.NodeKind.Operator&&s(t.head.label),h.Pledge.all(t.args.map(e));case l.NodeKind.Array:return h.Pledge.all((0,a.safeConcat)([],t.nodes.map((t=>t.map(e)))));case l.NodeKind.BadSequence:return h.Pledge.all(t.contents.map(e));case l.NodeKind.CellRef:case l.NodeKind.Name:t.qualifier&&s(t.qualifier.label);break;case l.NodeKind.Paren:return e(t.node);case l.NodeKind.FieldRef:return s(t.rhs.label),s(t.rhs.field.label),e(t.lhs);case l.NodeKind.StructRef:return t.lhs?e(t.lhs):void 0;case l.NodeKind.Var:s(t.name.label);break;case l.NodeKind.Param:if(s(t.name.label),s(t.name.name.label),t.def)return s(t.def.label),e(t.def.rhs);break;default:return(0,n.assertNever)("calc.analyze.checker.comments",t)}}))}(t.node))}(e,t),r}catch(t){if(t===f)return S(e,u.SignatureType.All);throw t}}t.checkFormulaWithDiagnostics=function(e,t,r){try{const n=_(O(e,t,r,{ok:void 0,isOk:e=>void 0===e,collect:(e,t,r)=>{const n=r??[];return(n[e.label]??(n[e.label]=[])).push(t),n}},!1),r).context.errorData;return(0,g.success)([{...r,isWellFormed:void 0===n},n])}catch(e){return(0,g.failure)((0,g.javaScriptError)(e))}},t.checkFormula=function(e,t,r){try{const n=_(O(e,t,r,I),r).context.errorData;return(0,g.success)({...r,isWellFormed:n})}catch(e){return(0,g.failure)((0,g.javaScriptError)(e))}}},73421:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertDiagnosticToNLMessage=t.baseNLErrors=t.formatDiagnostic=t.baseErrors=t.TypeSourceKind=t.TypeError=t.SyntaxError=void 0;const n=r(63745),a=r(70308);var i,o,s;!function(e){e.Unclosed_application="Unclosed_application",e.Unclosed_paren="Unclosed_paren",e.Unclosed_bracket="Unclosed_bracket",e.Unclosed_array="Unclosed_array",e.Unclosed_literal="Unclosed_literal",e.Unclosed_comment="Unclosed_comment",e.Invalid_number_literal="Invalid_number_literal",e.Invalid_string_literal="Invalid_string_literal",e.Invalid_error_literal="Invalid_error_literal",e.Invalid_function_name="Invalid_function_name",e.Invalid_name="Invalid_name",e.Illegal_array_literal_element="Illegal_array_literal_element",e.Empty_array_literal="Empty_array_literal",e.Irregular_array_shape="Irregular_array_shape",e.Empty_parenthesis="Empty_parenthesis",e.Missing_operation_argument="Missing_operation_argument",e.Bad_node="Bad_node",e.Invalid_qualifier="Invalid_qualifier",e.Invalid_cell_ref="Invalid_cell_ref",e.Invalid_binder="Invalid_binder",e.Missing_binder="Missing_binder",e.Duplicate_binder="Duplicate_binder",e.Invalid_body="Invalid_body",e.Mandatory_binder_after_optional="Mandatory_binder_after_optional",e.Missing_default_expression="Missing_default_expression",e.Binder_requires_brackets="Binder_requires_brackets",e.Invalid_field_name="Invalid_field_name",e.Missing_field_name="Missing_field_name",e.Empty_formula="Empty_formula",e.Invalid_rel_sheet_qualifier_in_cell="Invalid_rel_sheet_qualifier_in_cell",e.Invalid_rel_sheet_qualifier_in_name="Invalid_rel_sheet_qualifier_in_name",e.Invalid_unqualified_cell="Invalid_unqualified_cell",e.Unexpected_closing_paren="Unexpected_closing_paren",e.Unexpected_closing_brace="Unexpected_closing_brace",e.Unexpected_closing_bracket="Unexpected_closing_bracket",e.Unexpected_character="Unexpected_character",e.Unexpected_field_ref="Unexpected_field_ref",e.Unexpected_dot="Unexpected_dot",e.Invalid_struct_ref_table_name="Invalid_struct_ref_table_name",e.Missing_struct_ref_table_name="Missing_struct_ref_table_name",e.Invalid_struct_ref_comma_parts="Invalid_struct_ref_comma_parts",e.Invalid_struct_ref_missing_part="Invalid_struct_ref_missing_part",e.Invalid_struct_ref_bad_part="Invalid_struct_ref_bad_part",e.Excess_higher_order_function_arguments="Excess_higher_order_function_arguments"}(i||(t.SyntaxError=i={})),function(e){e.Types_not_related="Types_not_related",e.Unexpected_application_head="Unexpected_application_head",e.Unexpected_application_head_with_fix="Unexpected_application_head_with_fix",e.Incorrect_number_of_operator_arguments="Incorrect_number_of_operator_arguments",e.Excess_function_arguments="Excess_function_arguments",e.Insufficient_function_arguments="Insufficient_function_arguments"}(o||(t.TypeError=o={})),function(e){e.WSFArgument="WSFArgument",e.OperatorArgument="OperatorArgument"}(s||(t.TypeSourceKind=s={})),t.baseErrors={[i.Unclosed_application]:{kind:i.Unclosed_application},[i.Unclosed_paren]:{kind:i.Unclosed_paren},[i.Unclosed_bracket]:{kind:i.Unclosed_bracket},[i.Unclosed_array]:{kind:i.Unclosed_array},[i.Unclosed_literal]:{kind:i.Unclosed_literal},[i.Unclosed_comment]:{kind:i.Unclosed_comment},[i.Invalid_number_literal]:{kind:i.Invalid_number_literal},[i.Invalid_string_literal]:{kind:i.Invalid_string_literal},[i.Invalid_error_literal]:{kind:i.Invalid_error_literal},[i.Invalid_function_name]:{kind:i.Invalid_function_name},[i.Invalid_name]:{kind:i.Invalid_name},[i.Illegal_array_literal_element]:{kind:i.Illegal_array_literal_element},[i.Empty_array_literal]:{kind:i.Empty_array_literal},[i.Irregular_array_shape]:{kind:i.Irregular_array_shape},[i.Empty_parenthesis]:{kind:i.Empty_parenthesis},[i.Bad_node]:{kind:i.Bad_node},[i.Invalid_qualifier]:{kind:i.Invalid_qualifier},[i.Invalid_cell_ref]:{kind:i.Invalid_cell_ref},[i.Invalid_binder]:{kind:i.Invalid_binder},[i.Missing_binder]:{kind:i.Missing_binder},[i.Duplicate_binder]:{kind:i.Duplicate_binder},[i.Invalid_body]:{kind:i.Invalid_body},[i.Mandatory_binder_after_optional]:{kind:i.Mandatory_binder_after_optional},[i.Missing_default_expression]:{kind:i.Missing_default_expression},[i.Binder_requires_brackets]:{kind:i.Binder_requires_brackets},[i.Invalid_field_name]:{kind:i.Invalid_field_name},[i.Missing_field_name]:{kind:i.Missing_field_name},[i.Empty_formula]:{kind:i.Empty_formula},[i.Invalid_rel_sheet_qualifier_in_cell]:{kind:i.Invalid_rel_sheet_qualifier_in_cell},[i.Invalid_rel_sheet_qualifier_in_name]:{kind:i.Invalid_rel_sheet_qualifier_in_name},[i.Invalid_unqualified_cell]:{kind:i.Invalid_unqualified_cell},[i.Unexpected_closing_paren]:{kind:i.Unexpected_closing_paren},[i.Unexpected_closing_brace]:{kind:i.Unexpected_closing_brace},[i.Unexpected_closing_bracket]:{kind:i.Unexpected_closing_bracket},[i.Unexpected_field_ref]:{kind:i.Unexpected_field_ref},[i.Unexpected_dot]:{kind:i.Unexpected_dot},[i.Invalid_struct_ref_table_name]:{kind:i.Invalid_struct_ref_table_name},[i.Missing_struct_ref_table_name]:{kind:i.Missing_struct_ref_table_name},[i.Invalid_struct_ref_comma_parts]:{kind:i.Invalid_struct_ref_comma_parts},[i.Invalid_struct_ref_missing_part]:{kind:i.Invalid_struct_ref_missing_part},[i.Invalid_struct_ref_bad_part]:{kind:i.Invalid_struct_ref_bad_part},[o.Unexpected_application_head]:{kind:o.Unexpected_application_head},[o.Unexpected_application_head_with_fix]:{kind:o.Unexpected_application_head_with_fix}},t.formatDiagnostic=function(e){switch(e.kind){case o.Insufficient_function_arguments:case o.Excess_function_arguments:return`${e.kind}: ${(0,n.englishWorksheetFuncIdToName)(e.funcId)}`;case i.Missing_operation_argument:case o.Incorrect_number_of_operator_arguments:return`${e.kind}: ${(0,n.englishOperatorIdToName)(e.opId)}`;case i.Unexpected_character:return`${e.kind}: ${(0,a.anonymizeFormulaString)(e.text)}`;case o.Types_not_related:return`${e.kind}: ${function(e){const{kind:t,argIndex:r}=e;switch(e.kind){case s.WSFArgument:return JSON.stringify({kind:t,funcId:(0,n.englishWorksheetFuncIdToName)(e.funcId),argIndex:r});case s.OperatorArgument:return JSON.stringify({kind:t,opId:(0,n.englishOperatorIdToName)(e.opId),argIndex:r})}}(e.typeSource)}`;default:return e.kind}};const u="The formulas has an error";t.baseNLErrors={[i.Unclosed_application]:"The formula is missing a parenthesis",[i.Unclosed_paren]:"The formula is missing a parenthesis",[i.Unclosed_bracket]:"The formula is missing a bracket",[i.Unclosed_array]:"The formula is missing a brace",[i.Unclosed_literal]:"The formula is missing a quote",[i.Unclosed_comment]:"The formula comment is missing an end",[i.Invalid_number_literal]:"The formula has an invalid number",[i.Invalid_string_literal]:"The formula has an invalid string",[i.Invalid_error_literal]:"The formula has an invalid value",[i.Invalid_function_name]:"The formula has an invalid function name",[i.Invalid_name]:"The formula has an invalid name",[i.Illegal_array_literal_element]:"The formula has an invalid value",[i.Empty_array_literal]:"The formula has an empty array",[i.Irregular_array_shape]:"The formula has an incorrectly shaped array",[i.Empty_parenthesis]:"The formula is missing values between parentheses",[i.Missing_operation_argument]:"The formula has an extra operator",[i.Bad_node]:u,[i.Invalid_qualifier]:"The formula has an invalid sheet reference",[i.Invalid_cell_ref]:"The formula has an invalid cell reference",[i.Invalid_binder]:u,[i.Missing_binder]:u,[i.Duplicate_binder]:u,[i.Invalid_body]:u,[i.Mandatory_binder_after_optional]:u,[i.Missing_default_expression]:u,[i.Binder_requires_brackets]:u,[i.Invalid_field_name]:"The formula has an invalid field name",[i.Missing_field_name]:"The formula is missing a field name",[i.Empty_formula]:"The formula is empty",[i.Invalid_rel_sheet_qualifier_in_cell]:"The formula has an incorrect reference",[i.Invalid_rel_sheet_qualifier_in_name]:"The formula has an incorrect reference",[i.Invalid_unqualified_cell]:"The formula has an incorrect reference",[i.Unexpected_closing_paren]:"The formula has an extra parenthesis",[i.Unexpected_closing_brace]:"The formula has an extra brace",[i.Unexpected_closing_bracket]:"The formula has an extra bracket",[i.Unexpected_character]:"The formula has some extra characters",[i.Unexpected_field_ref]:"The formula has an extra field",[i.Unexpected_dot]:"The formula has an extra dot",[i.Invalid_struct_ref_table_name]:"The formula has a malformed table name in a structured reference",[i.Missing_struct_ref_table_name]:"The formula is missing the table name in a structured reference",[i.Invalid_struct_ref_comma_parts]:"The formula has a structured reference with commas that has issues between its brackets",[i.Invalid_struct_ref_missing_part]:"The formula has a structured reference with missing references between its brackets",[i.Invalid_struct_ref_bad_part]:"The formula has a bad reference in a structured reference",[i.Excess_higher_order_function_arguments]:"The formula has a function call with too many arguments",[o.Types_not_related]:"The formula has an operation using data that cannot be mixed together",[o.Unexpected_application_head]:"The formula has a malformed function call",[o.Unexpected_application_head_with_fix]:"The formula has a malformed function call",[o.Incorrect_number_of_operator_arguments]:"The formula has an operation with the wrong number of arguments",[o.Excess_function_arguments]:"The formula has a function call with too many arguments",[o.Insufficient_function_arguments]:"The formula has a function call with missing arguments"},t.convertDiagnosticToNLMessage=function(e){return t.baseNLErrors[e.kind]}},94052:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveStaticPrecedents=void 0;const n=r(3085),a=r(6791),i=r(46061),o=r(10741),s=r(88516),u=r(10228),l=r(49219),c=r(261),d=r(46090),g=r(18643),m=r(84538),h=r(28581),p=r(28761),f={getDocumentLoc:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getDocumentLoc"),getSheetIndex:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getSheetIndex"),getSheetName:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getSheetName"),getNameLoc:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getNameLoc"),getUserDefinedFuncLoc:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getUserDefinedFuncLoc"),getSheetRangeIndexes:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getSheetRangeIndexes"),getContainingTable:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getContainingTable"),getStructRefColumn:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getStructRefColumn"),getStructRefSpecialRef:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getStructRefSpecialRef")},S=(0,g.createFailureErrorClass)("ResolveStaticPrecedentsError");class v extends h.IdentityVisitor{appNode(e,t,r,n){if(e.kind===o.NodeKind.WSF){const r=e.id;let n=(0,c.getWorksheetFuncType)(r).staticPrecs;switch(r){case c.WorksheetFuncId.LOOKUP:case c.WorksheetFuncId.SUMIF:case c.WorksheetFuncId.AVERAGEIF:const e=({label:e})=>{const t=this.resolutions[e],r=t?.kind===l.ResolvedKind.ResolvedCellRef||t?.kind===l.ResolvedKind.ResolvedStructRef?t.resolution:void 0;return r?.kind===i.ResultKind.Success?r.value:void 0},a=(t,r)=>{const n=e(t),a=e(r);return void 0!==n&&void 0!==a&&(0,s.isSheetGridRange)(n)&&(0,s.isSheetGridRange)(a)&&(0,g.isDocumentLocEqual)(n.sheet.document,a.sheet.document)&&n.range.rows===a.range.rows&&n.range.cols===a.range.cols};(t.length<3||t[2].kind===o.NodeKind.Literal||t[2].kind===o.NodeKind.Array||a(t[2],r===c.WorksheetFuncId.LOOKUP?t[1]:t[0]))&&(n&=~d.SpecialPrecs.AllCells)}n!==d.SpecialPrecs.None&&(this.ownSpecial|=n)}return super.appNode(e,t,r,n)}nameNode(e,t,r){const n=this.resolver.resolveDottedName(this.locals,(0,o.nameNode)(e,t,r),this.annotations);this.resolutions[r]=n,(0,a.safePush)(this.names,n.precedents.names),(0,a.safePush)(this.udfs,n.precedents.udfs);const{headResolved:s}=n;switch(s.kind){case l.ResolvedKind.ResolvedName:if(!(0,i.isSuccess)(s.resolution)){this.handleResolutionError(s.resolution.reason);break}void 0!==s.resolution.value&&(this.nameSpecial|=d.SpecialPrecs.All);break;case l.ResolvedKind.ResolvedUserDefinedFunc:if(!(0,i.isSuccess)(s.resolution)){this.handleResolutionError(s.resolution.reason);break}break;case l.ResolvedKind.ResolvedCellRef:this.pushResolvedGridRef(s.resolution)}return super.nameNode(e,t,r)}cellRefNode(e,t,r){const n=this.resolver.resolveCellRef(this.locals,(0,o.cellRefNode)(e,t,r));this.resolutions[r]=n;const{resolution:a}=n;return this.pushResolvedGridRef(a),super.cellRefNode(e,t,r)}structRefNode(e,t,r){const n=this.resolver.resolveStructRef(this.locals,(0,o.structRefNode)(e,t,r));this.resolutions[r]=n,(0,a.safePush)(this.names,n.precedents);const{resolution:i}=n;return this.pushResolvedGridRef(i),super.structRefNode(e,t,r)}pushResolvedGridRef(e){if(e.kind!==i.ResultKind.Success)return this.handleResolutionError(e.reason);if(void 0!==e.value){const t=e.value;if((0,s.isSheetGridRange)(t))this.cells.push(t);else{this.ownSpecial|=d.SpecialPrecs.OwnDocSheets;const e=this.globals.getSheetRangeIndexes(t.sheet);if(!(0,i.isSuccess)(e))throw new S(e.reason);(0,a.safePush)(this.cells,e.value.sheets.map((e=>(0,s.sheetGridRange)((0,s.sheetIndex)(t.sheet.document,e),t.range))))}}}handleResolutionError(e){switch(e.kind){case l.ResolveReasonKind.NoOriginSheet:case l.ResolveReasonKind.InvalidStructRef:case l.ResolveReasonKind.InvalidCellRef:case l.ResolveReasonKind.InvalidQualifier:case l.ResolveReasonKind.EmptyIntersection:return}throw new S(e)}constructor(e,t,r){super(),this.locals=t,this.annotations=r,this.cells=[],this.names=[],this.udfs=[],this.nameSpecial=d.SpecialPrecs.None,this.ownSpecial=d.SpecialPrecs.None,this.resolutions=[],this.globals=function(e){return{config:e.config,getDocumentLoc:e.getDocumentLoc?.bind(e)??f.getDocumentLoc,getSheetIndex:e.getSheetIndex?.bind(e)??f.getSheetIndex,getSheetName:e.getSheetName?.bind(e)??f.getSheetName,getNameLoc:e.getNameLoc?.bind(e)??f.getNameLoc,getUserDefinedFuncLoc:e.getUserDefinedFuncLoc?.bind(e)??f.getUserDefinedFuncLoc,getSheetRangeIndexes:e.getSheetRangeIndexes?.bind(e)??f.getSheetRangeIndexes,getContainingTable:e.getContainingTable?.bind(e)??f.getContainingTable,getStructRefColumn:e.getStructRefColumn?.bind(e)??f.getStructRefColumn,getStructRefSpecialRef:e.getStructRefSpecialRef?.bind(e)??f.getStructRefSpecialRef}}(e),this.resolver=(0,u.createResolver)(this.globals)}}t.resolveStaticPrecedents=function(e,t,r){try{const n=new v(e,t,r.annotations);return(0,h.reduceBottomUp)(n,r),(0,i.success)((0,p.staticPrecedents)(n.cells,n.names,n.udfs,n.nameSpecial|n.ownSpecial,n.ownSpecial,m.PrecsBound.Upper,n.resolutions))}catch(e){return e instanceof S?(0,i.failure)(e.reason):(0,i.failure)((0,i.javaScriptError)(e))}}},28761:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.analyzeLocalsName=t.analyzeLocalsGrid=t.createAnalyzeGlobals=t.staticPrecedents=t.summarizeFormulaDiagnostics=t.diagnostics=void 0;const n=r(74643),a=r(88516),i=n.__importStar(r(73421));t.diagnostics=i;const o=r(46061);t.summarizeFormulaDiagnostics=function(e){if(void 0===e)return;const t={};return Object.keys(e).forEach((r=>{e[Number(r)].forEach((e=>{const r=i.formatDiagnostic(e);t[r]=(t[r]??0)+1}))})),t},t.staticPrecedents=function(e,t,r,n,a,i,o){return{cells:e,names:t,udfs:r,special:n,ownSpecial:a,bound:i,resolutions:o}},t.createAnalyzeGlobals=function(e,t){return{config:e,getSheetName:t}},t.analyzeLocalsGrid=function(e,t,r,n=!1){return{config:r??void 0,lexicalKind:e,originGridCell:(0,o.success)(t.range),originSheet:(0,o.success)(t.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0,allowImplicitTable:!0,wrapCellReferences:!1,workbookLoad:n}},t.analyzeLocalsName=function(e,t,r=!1){return{config:t??void 0,lexicalKind:a.LexicalKind.NameManager,originGridCell:(0,o.success)(e.range),originSheet:(0,o.success)(e.sheet),allowRelativeQualifier:!0,allowUnqualifiedCell:!1,allowImplicitTable:!1,wrapCellReferences:!0,workbookLoad:r}}},70308:function(e,t,r){"use strict";const n=r(91092);e.exports=n.anonymizer},3085:function(e,t,r){"use strict";const n=r(91092);e.exports=n.assertions},98539:function(e,t,r){"use strict";const n=r(91092);e.exports=n.codePoint},6791:function(e,t,r){"use strict";const n=r(91092);e.exports=n.core},9552:function(e,t,r){"use strict";const n=r(91092);e.exports=n.rbMapTree},60364:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.overrideTypedFeatureGates=t.isTypedChangeGateEnabled=t.getTypedFeatureGate=t.getFeatures=t.isFeatureEnabled=t.initFeatureConfiguration=t.FeatureName=void 0;const n=r(91092);t.FeatureName=n.featureConfiguration.FeatureName,t.initFeatureConfiguration=n.featureConfiguration.initFeatureConfiguration,t.isFeatureEnabled=n.featureConfiguration.isFeatureEnabled,t.getFeatures=n.featureConfiguration.getFeatures,t.getTypedFeatureGate=n.featureConfiguration.getTypedFeatureGate,t.isTypedChangeGateEnabled=n.featureConfiguration.isTypedChangeGateEnabled;var a=r(66761);Object.defineProperty(t,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return a.overrideTypedFeatureGates}}),Object.defineProperty(t,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return a.setFeatureGateDictionaryGetter}})},46061:function(e,t,r){"use strict";const n=r(91092);e.exports=n.result},58088:function(e,t,r){"use strict";const n=r(91092);e.exports=n.pledge},86433:function(e,t,r){"use strict";const n=r(91092);e.exports=n.unicode},76076:function(e,t,r){"use strict";const n=r(91092);e.exports=n.util},55174:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.util=t.tokenizeFormulaModule=t.token=t.parseStructRefModule=t.parserState=t.parserService=t.parseResultHelperModule=t.parseRefModule=t.parser=t.parseQualifierModule=t.parseOperators=t.parseLiteralModule=t.parseFormulaModule=t.parseFieldRefModule=t.parseCommon=t.parseServiceTypes=t.analyzeServiceTypes=t.diagnostics=t.checker=t.autocorrect=t.analyzeService=t.PackageName=void 0;const n=r(74643);t.PackageName="excel-online-calc-syntax",t.analyzeService=n.__importStar(r(23490)),t.autocorrect=n.__importStar(r(80730)),t.checker=n.__importStar(r(80766)),t.diagnostics=n.__importStar(r(73421)),t.analyzeServiceTypes=n.__importStar(r(28761)),t.parseServiceTypes=n.__importStar(r(48792)),t.parseCommon=n.__importStar(r(81120)),t.parseFieldRefModule=n.__importStar(r(8684)),t.parseFormulaModule=n.__importStar(r(28723)),t.parseLiteralModule=n.__importStar(r(44682)),t.parseOperators=n.__importStar(r(49704)),t.parseQualifierModule=n.__importStar(r(13053)),t.parser=n.__importStar(r(89487)),t.parseRefModule=n.__importStar(r(60400)),t.parseResultHelperModule=n.__importStar(r(58796)),t.parserService=n.__importStar(r(65976)),t.parserState=n.__importStar(r(38758)),t.parseStructRefModule=n.__importStar(r(18559)),t.token=n.__importStar(r(66667)),t.tokenizeFormulaModule=n.__importStar(r(15287)),t.util=n.__importStar(r(30912))},16605:function(e,t,r){"use strict";const n=r(84817);e.exports=n.annotations},43436:function(e,t,r){"use strict";const n=r(84817);e.exports=n.cellFormat},68112:function(e,t,r){"use strict";const n=r(84817);e.exports=n.cellParse},63745:function(e,t,r){"use strict";const n=r(84817);e.exports=n.config},10741:function(e,t,r){"use strict";const n=r(84817);e.exports=n.formulaModule},47445:function(e,t,r){"use strict";const n=r(84817);e.exports=n.literalParse},88516:function(e,t,r){"use strict";const n=r(84817);e.exports=n.location},10228:function(e,t,r){"use strict";const n=r(84817);e.exports=n.resolveService},49219:function(e,t,r){"use strict";const n=r(84817);e.exports=n.resolveServiceTypes},261:function(e,t,r){"use strict";const n=r(84817);e.exports=n.signature},46090:function(e,t,r){"use strict";const n=r(84817);e.exports=n.types},18643:function(e,t,r){"use strict";const n=r(84817);e.exports=n.util},84538:function(e,t,r){"use strict";const n=r(84817);e.exports=n.value},28581:function(e,t,r){"use strict";const n=r(84817);e.exports=n.visitor},81120:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseBracketedTokens=t.parseIdentContinue=t.parseEnd=t.parseEscape=t.parseAtOp=t.parseRangeOp=t.parseDotSepTokenNotFollowedByLeftBracket=t.parseRightBracket=t.parseLeftBracket=t.parseRightSQuote=t.parseLeftSQuote=t.parseRightBrace=t.parseLeftBrace=t.parseRightParen=t.parseLeftParen=t.parseAssignToken=t.parseDotSepToken=t.parseQualSep=t.parseColSep=t.parseRowSep=t.parseListSep=t.parseCharIndex=t.parseSpacesOnly=t.parseWhitespace=t.isWhitespaceToken=t.isCommentToken=t.isBracketToken=t.isRightBracketToken=t.isLeftBracketToken=t.isRefErrorToken=t.isAtOpToken=t.isRangeOpToken=t.isListSepToken=t.isDotSepToken=void 0;const n=r(70308),a=r(3085),i=r(84538),o=r(261),s=r(66667),u=r(89487),l=r(46090);function c(e){return e.kind===s.TokenKind.Sep&&e.value===s.SepId.Dot}function d(e){return e.kind===s.TokenKind.Operator&&e.value===o.OperatorId.Range}function g(e){return e.kind===s.TokenKind.Operator&&e.value===o.OperatorId.At}function m(e){return e.kind===s.TokenKind.Left&&e.value===s.DelimId.Bracket}function h(e){return(e.kind===s.TokenKind.Left||e.kind===s.TokenKind.Right)&&e.value===s.DelimId.Bracket}function p(e){return e.kind===s.TokenKind.Spaces||e.kind===s.TokenKind.SingleLineComment||e.kind===s.TokenKind.MultiLineComment}function f(e){return(0,u.take)(((t,r)=>r.kind===s.TokenKind.Sep&&r.value===e?r:void 0))}function S(e){return(0,u.take)(((t,r)=>r.kind===s.TokenKind.Left&&r.value===e?r:void 0))}function v(e){return(0,u.take)(((t,r)=>r.kind===s.TokenKind.Right&&r.value===e?r:void 0))}t.isDotSepToken=c,t.isListSepToken=function(e){return e.kind===s.TokenKind.Sep&&e.value===s.SepId.List},t.isRangeOpToken=d,t.isAtOpToken=g,t.isRefErrorToken=function(e){return e.kind===s.TokenKind.Literal&&e.oper.kind===l.OperKind.Error&&e.oper.type===i.ErrorType.REF},t.isLeftBracketToken=m,t.isRightBracketToken=function(e){return e.kind===s.TokenKind.Right&&e.value===s.DelimId.Bracket},t.isBracketToken=h,t.isCommentToken=function(e){return e.kind===s.TokenKind.SingleLineComment||e.kind===s.TokenKind.MultiLineComment},t.isWhitespaceToken=p,t.parseWhitespace=(0,u.many)((0,u.take)(((e,t)=>p(t)?t:void 0))),t.parseSpacesOnly=(0,u.opt)((0,u.take)(((e,t)=>t.kind===s.TokenKind.Spaces?t.chars:void 0)),""),t.parseCharIndex=function(e,t,r,i,o){const s=e[t];if(null==s){const r=`calc.parse.pStart: internal error: expected token at ${t} in ${(0,n.anonymize)(e)}`;return(0,a.assertFalse)(r)}return i(s.start,t)},t.parseListSep=f(s.SepId.List),t.parseRowSep=f(s.SepId.Row),t.parseColSep=f(s.SepId.Col),t.parseQualSep=f(s.SepId.Qual),t.parseDotSepToken=f(s.SepId.Dot),t.parseAssignToken=f(s.SepId.Assign),t.parseLeftParen=S(s.DelimId.Paren),t.parseRightParen=v(s.DelimId.Paren),t.parseLeftBrace=S(s.DelimId.Brace),t.parseRightBrace=v(s.DelimId.Brace),t.parseLeftSQuote=S(s.DelimId.SQuote),t.parseRightSQuote=v(s.DelimId.SQuote),t.parseLeftBracket=S(s.DelimId.Bracket),t.parseRightBracket=v(s.DelimId.Bracket),t.parseDotSepTokenNotFollowedByLeftBracket=(0,u.takePeek)(((e,t,r)=>c(t)&&!m(r)?t:void 0)),t.parseRangeOp=(0,u.take)(((e,t)=>d(t)?t:void 0)),t.parseAtOp=(0,u.take)(((e,t)=>g(t)?t:void 0)),t.parseEscape=(0,u.take)(((e,t)=>t.kind===s.TokenKind.Escape?t:void 0)),t.parseEnd=(0,u.take)(((e,t)=>t.kind===s.TokenKind.End?t:void 0)),t.parseIdentContinue=(0,u.apply)((0,u.many1)((0,u.take)(((e,t)=>t.isIdentContinue?t:void 0))),((e,t)=>{const r=t[0];return 1===t.length?r:(0,s.identToken)(r.start,t.map((e=>e.chars)).join(""))}));const F=(0,u.take)(((e,t)=>h(t)||t.kind===s.TokenKind.End?void 0:t)),y=(0,u.lazy)((()=>(0,u.flatten)((0,u.many)((0,u.any)((0,u.many1)(F),(0,u.concat)((0,u.tuple)(t.parseLeftBracket),y,(0,u.opt)((0,u.tuple)(t.parseRightBracket),[])))))));t.parseBracketedTokens=(0,u.apply)((0,u.tuple)(t.parseLeftBracket,y,t.parseCharIndex,(0,u.opt)(t.parseRightBracket,void 0)),((e,[t,r,n,a])=>(r.push((0,s.endToken)(n)),[r,void 0!==a])))},8684:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseFieldRef=t.isUnbracketedField=void 0;const n=r(74643),a=r(10741),i=r(66667),o=r(89487),s=r(49704),u=r(38758),l=r(81120),c=r(46061),d=r(86433),g=n.__importStar(r(98539)),{codePointQuestionMark:m,codePointBackslash:h,codePointUnderscore:p}=g;function f(e,t){function r(t){return t!==m&&t!==h&&e.isIdentContinue(t)}if(0===t.length)return!1;const n=(0,d.stringCodePointAt)(t,0);if((a=n)===p||a===h||!e.isIdentStart(a)&&!e.isNumeral(a))return!1;var a;for(const e of(0,d.codePointIterator)(t,(0,d.numCodeUnits)(n)))if(!r(e))return!1;return!0}t.isUnbracketedField=f;const S=(0,o.take)(((e,t)=>(0,l.isBracketToken)(t)||t.kind===i.TokenKind.Escape||t.kind===i.TokenKind.End?void 0:t.chars)),v=(0,o.take)(((e,t)=>t.kind!==i.TokenKind.Ident||t.chars!==e.localeInfo.leftBracket&&t.chars!==e.localeInfo.rightBracket&&"'"!==t.chars?void 0:t.chars)),F=(0,o.any)(S,(0,o.right)(l.parseEscape,v)),y=(0,o.apply)((0,o.tuple)((0,o.many)(F),l.parseEnd),((e,[t,r])=>t.join(""))),C=(0,o.applyTake)(l.parseBracketedTokens,((e,[t,r])=>{const n=(0,o.runParser)(y,t,0,e);if(!(0,c.isSuccess)(n))return;const i=t[0].start,s=t[t.length-1].start,l=n.value.output;if(l.length>255){const r=t.map((e=>e.chars)).join("");return[(0,a.badCharsNode)(a.BadType.FieldName,r,(0,u.addSpan)(e,i,s,"","")),!1,!0]}return[(0,a.identNode)(l,(0,u.addSpan)(e,i,s,"","")),!0,r]})),A=(0,o.apply)(l.parseIdentContinue,((e,t)=>{const r=t.start,n=t.start+t.chars.length;return!f(e.localeInfo,t.chars)||t.chars.length>255?[(0,a.badCharsNode)(a.BadType.FieldName,t.chars,(0,u.addSpan)(e,r,n,"","")),!1,!0]:[(0,a.identNode)(t.chars,(0,u.addSpan)(e,r,n,"","")),!1,!0]}));t.parseFieldRef=(0,o.apply)((0,o.tuple)(l.parseCharIndex,l.parseWhitespace,l.parseDotSepToken,(0,o.any)(A,C),l.parseCharIndex),((e,[t,r,n,[i,o,l],c])=>{const d=(0,u.addSpan)(e,n.start,c,r,""),g=(0,a.fieldRef)(i,o,l,!1,d);return(0,s.fieldRefTerm)(r.length>0,g,t,c)}))},28723:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseSpParam=t.runFormulaParser=t.parseFormula=void 0;const n=r(70308),a=r(3085),i=r(10741),o=r(10741),s=r(261),u=r(66667),l=r(89487),c=r(49704),d=r(38758),g=r(81120),m=r(60400),h=r(44682),p=r(8684),f=r(18559),S=r(46061),v=r(16605),F=r(86433),y=r(91092),C=r(68112),A=r(60364),E=r(18643),b=r(84538),R=(0,l.apply)((0,l.tuple)(g.parseWhitespace,(0,l.lazy)((()=>t.parseFormula)),g.parseWhitespace),((e,[t,r,n])=>{const i=(0,d.getNodeSpan)(e,r);return(0,a.assertTrue)("calc.parse.parseSpFormula",!(i.pre.length>0&&t.length>0)),(0,a.assertTrue)("calc.parse.parseSpFormula",!(i.post.length>0&&n.length>0)),t.length>0&&([i.pre,i.preComments]=(0,d.addWhitespace)(e,t)),n.length>0&&([i.post,i.postComments]=(0,d.addWhitespace)(e,n)),r})),T=(0,l.apply)((0,l.tuple)(g.parseLeftParen,(0,d.withDelim)({delimId:u.DelimId.Paren,listSep:d.ListSep.Union},R),(0,l.opt)(g.parseRightParen,void 0),g.parseCharIndex),((e,[t,r,n,a])=>(0,i.parenNode)(r,void 0!==n,(0,d.addSpan)(e,t.start,a,"","")))),k=(0,l.many1)(R,(0,l.right)(g.parseColSep,R)),N=(0,l.many1)(k,(0,l.right)(g.parseRowSep,k)),I=(0,l.apply)((0,l.tuple)(g.parseLeftBrace,(0,d.withDelim)({delimId:u.DelimId.Brace,listSep:d.ListSep.Union},N),(0,l.opt)(g.parseRightBrace,void 0),g.parseCharIndex),((e,[t,r,n,a])=>(0,i.arrayNode)(r,void 0!==n,(0,d.addSpan)(e,t.start,a,"",""))));function O(e){return(0,l.takePeek)(((t,r,n)=>e(r)?(0,i.badCharsNode)(i.BadType.Unexpected,r.chars,(0,d.addSpan)(t,r.start,n.start,"","")):void 0))}const _=(0,l.apply)((0,l.tuple)(g.parseCharIndex,O(g.isLeftBracketToken),(0,d.withDelim)({delimId:u.DelimId.Bracket,listSep:d.ListSep.Union},R),(0,l.opt)(O(g.isRightBracketToken),void 0),g.parseCharIndex),((e,[t,r,n,a,o])=>{const s=[r,n];return null!=a&&s.push(a),(0,i.badSequenceNode)(i.BadType.Unexpected,s,(0,d.addSpan)(e,t,o,"",""))})),P=(0,l.takePeek)(((e,t,r)=>{switch(t.kind){case u.TokenKind.End:case u.TokenKind.Operator:case u.TokenKind.Spaces:case u.TokenKind.SingleLineComment:case u.TokenKind.MultiLineComment:return;case u.TokenKind.Sep:if(t.value===u.SepId.Dot)return;if(t.value===u.SepId.Qual||t.value===u.SepId.Assign)break;if(e.delim.delimId===u.DelimId.Brace||t.value!==u.SepId.Col&&t.value!==u.SepId.Row)return;break;case u.TokenKind.Right:if(t.value!==u.DelimId.SQuote&&e.delim.stack[t.value])return}return(0,i.badCharsNode)(i.BadType.Unexpected,t.chars,(0,d.addSpan)(e,t.start,r.start,"",""))})),M=(0,l.any)(m.parseRef,h.parseLiteral,T,I,p.parseFieldRef,f.parseStructRef,_,m.parseUnqualBadRef,P);function D(e){return(0,l.tuple)(g.parseLeftParen,(0,d.withDelim)({delimId:u.DelimId.Paren,listSep:d.ListSep.Arg},(0,l.apply)((0,l.many1)(e,(0,l.right)(g.parseListSep,e)),((e,t)=>t.map((e=>e.kind===i.NodeKind.Missing?(0,i.literalNode)(b.missingOper,!0,e.label):e))))),(0,l.opt)(g.parseRightParen,void 0),g.parseCharIndex)}const w=(0,l.apply)(D(R),((e,[t,r,n,a])=>(0,c.argsTerm)(r,void 0!==n,t.start,a))),L=(0,l.apply)(D((0,l.any)((0,l.lazy)((()=>t.parseSpParam)),R)),((e,[t,r,n,a])=>(0,c.lambdaArgsTerm)(r,void 0!==n,t.start,a))),x=(0,l.take)(((e,t)=>t.kind!==u.TokenKind.Operator||t.value!==s.OperatorId.Percent&&t.value!==s.OperatorId.Pound?void 0:t)),K=(0,l.take)(((e,t)=>t.kind===u.TokenKind.Operator||(0,g.isDotSepToken)(t)?t:function(e,t){return t.kind===u.TokenKind.Sep&&t.value===u.SepId.List&&e.delim.listSep===d.ListSep.Union?(0,u.operatorToken)(t.start,e.localeInfo.listSeparator,s.OperatorId.Union):void 0}(e,t))),W=(0,l.many)((0,l.take)(((e,t)=>(0,g.isWhitespaceToken)(t)?t:void 0))),U=(0,l.any)((0,l.concat)((0,l.bind)((0,l.any)(M,x),((e,t)=>{const r=(0,c.isWSFNode)(e.localeInfo,t);return r?.id===s.WorksheetFuncId.LAMBDA?(0,l.concat)((0,l.parseSucceed)([t]),(0,l.opt)((0,l.tuple)(L),[])):(0,l.parseSucceed)([t])})),(0,l.many)((0,l.any)(w,p.parseFieldRef,f.parseStructRef))),(0,l.tuple)(K)),G=(0,l.flatten)((0,l.many1)(U,(0,l.concat)(W,U)));t.parseFormula=(0,l.apply)((0,l.tuple)((0,l.opt)(G,void 0),g.parseCharIndex),((e,[t,r])=>{if(null==t){const t=(0,d.addSpan)(e,r,r,"","");return(0,i.missingNode)("",t)}const n=t;return n.push((0,u.endToken)(r)),(0,c.runOperatorPrecedenceParser)(e,n)})),t.runFormulaParser=function(e,t,r,s,c,g,m,h){const p=h.length-1;if(p<0){const e="calc.parse.runTokenParser: internal error: expected at least 1 token";return(0,a.assertFalse)(e)}if(h[p].kind!==u.TokenKind.End){const e=`calc.parse.runTokenParser: internal error: array[n] !== End in ${(0,n.anonymize)(h)}`;return(0,a.assertFalse)(e)}const f=(0,d.makeState)(e,t,r,s,c),F=(0,l.runParser)(R,h,0,f);if(!(0,S.isSuccess)(F)||F.value.index<p){const e=`calc.parse.runTokenParser: internal error: consumed ${(0,S.isSuccess)(F)?F.value.index:0} out of ${p} in ${(0,n.anonymize)(h)}`;return(0,a.assertFalse)(e)}const y=F.value.output,C=f.spans,A=(0,v.buildAnnotations)(e,y,g,void 0===m?void 0:{[o.SyntaxFeature.Comments]:!0===m[o.SyntaxFeature.Comments],[o.SyntaxFeature.Statements]:!0===m[o.SyntaxFeature.Statements]});return(0,i.formula)(y,C,A)};const{codePointFullStop:B}=y.codePoint,V=(0,l.apply)((0,l.many1)((0,l.take)(((e,t)=>t.isIdentContinue||(0,g.isDotSepToken)(t)?t:void 0))),((e,t)=>{const r=t[0].start,n=t.map((e=>e.chars)).join(""),a=(0,d.addSpan)(e,r,r+n.length,"","");return function(e,t){if(!e.localeInfo.isIdentStart((0,F.stringCodePointAt)(t,0)))return!1;for(const r of(0,F.codePointIterator)(t))if(r!==B&&!e.localeInfo.isIdentContinue(r))return!1;const r=(0,C.parseCellRef)(e.localeInfo,e.refStyle,e.origin,t,0);if(void 0!==r&&r.i===t.length){const n=r.refStyle===i.RefStyle.A1?(0,u.cellRefA1Token)(0,t,r.row,r.col):(0,u.cellRefR1C1Token)(0,t,r.row,r.col,r.enLocale);if((0,m.isCompleteCellRefToken)(e,n))return!1}return!0}(e,n)?(0,i.identNode)(n,a):(0,i.badCharsNode)(i.BadType.ParamName,n,a)})),j=(0,l.applyTake)((0,l.tuple)(g.parseCharIndex,g.parseLeftBracket,g.parseCharIndex,g.parseSpacesOnly,(0,l.opt)(V,void 0),g.parseSpacesOnly,g.parseCharIndex,(0,l.opt)(g.parseRightBracket,void 0),g.parseCharIndex),((e,[t,r,n,a,o,s,u,l,c])=>{if(void 0!==o){const t=(0,d.getNodeSpan)(e,o);t.pre=a,t.post=s}const g=o??(0,i.missingNode)(a+s,(0,d.addSpan)(e,n,u,"",""));return(0,i.paramName)(g,!0,void 0!==l,(0,d.addSpan)(e,t,c,"",""))})),H=(0,l.applyTake)((0,l.tuple)(g.parseCharIndex,m.parseRef,g.parseCharIndex),((e,[t,r,n])=>{const a=r.kind===c.TermKind.MaybeWSFTerm?r.node:r;if((0,E.isUnqualifiedNameNode)(a))return(0,i.paramName)((0,i.identNode)(a.whole,a.label),!1,!0,(0,d.addSpan)(e,t,n,"",""))})),q=(0,l.apply)((0,l.tuple)(g.parseWhitespace,g.parseCharIndex,g.parseAssignToken,g.parseWhitespace,(0,l.lazy)((()=>t.parseFormula)),g.parseCharIndex),((e,[t,r,n,a,o,s])=>{const u=(0,d.getNodeSpan)(e,o);return[u.pre,u.preComments]=(0,d.addWhitespace)(e,a),(0,i.paramDefault)(o,(0,d.addSpan)(e,r,s,t,""))})),$=(0,l.lazy)((()=>(0,A.isFeatureEnabled)(A.FeatureName.CalcLambdaDefaultParameters)?q:(0,l.parseFail)()));t.parseSpParam=(0,l.applyTake)((0,l.tuple)(g.parseWhitespace,g.parseCharIndex,(0,l.bind)((0,l.any)(H,j),((e,t)=>t.isClosed?(0,l.apply)((0,l.opt)($,void 0),((e,r)=>[t,r])):(0,l.parseSucceed)([t,void 0]))),g.parseCharIndex,g.parseWhitespace,(0,l.peek)(((e,t)=>t))),((e,[t,r,[n,a],o,s,l])=>{if(void 0!==a||l.kind===u.TokenKind.End&&n.isBracketed||(0,g.isListSepToken)(l)&&n.isClosed)return(0,i.paramNode)(n,a,(0,d.addSpan)(e,r,o,t,s))}))},44682:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseLiteral=void 0;const n=r(10741),a=r(66667),i=r(89487),o=r(49704),s=r(38758),u=r(81120),l=r(84538),c=r(18643),d=r(46090),g=(0,i.take)(((e,t)=>t.kind===a.TokenKind.Literal&&t.oper.kind!==d.OperKind.Boolean?t:t.kind===a.TokenKind.CellRef&&function(e){return e.refStyle===n.RefStyle.A1&&null==e.col&&"object"==typeof e.row&&e.row.kind===n.PosKind.Rel}(t)?(0,a.literalToken)(t.start,t.chars,e.mathpack.fromNumber(t.row.index+e.origin.row+1)):void 0)),m=(0,i.take)(((e,t)=>t.kind===a.TokenKind.Literal&&t.oper.kind===d.OperKind.Boolean?t:void 0));t.parseLiteral=(0,i.apply)((0,i.tuple)((0,i.any)(g,(0,i.left)(m,(0,i.fails)(u.parseDotSepTokenNotFollowedByLeftBracket))),u.parseCharIndex),((e,[t,r])=>{const i=(0,s.addSpan)(e,t.start,r,"","");if((0,a.isBadNumberOper)(t.oper))return(0,n.badCharsNode)(n.BadType.NumberLiteral,t.chars,i);if((0,a.isBadErrorOper)(t.oper))return(0,n.badCharsNode)(n.BadType.ErrorLiteral,t.chars,i);if((0,c.isStringOper)(t.oper)&&t.oper.value.length>l.cellStringLimit)return(0,n.badCharsNode)(n.BadType.StringLiteral,t.chars,i);const u=(0,n.literalNode)(t.oper,t.hasRight,i);return(0,c.isBooleanOper)(t.oper)?(0,o.maybeWSFTerm)(u,t.chars):u}))},49704:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runOperatorPrecedenceParser=t.isWSFNode=t.maybeWSFTerm=t.structRefTerm=t.fieldRefTerm=t.argsTerm=t.lambdaArgsTerm=t.TermKind=void 0;const n=r(70308),a=r(3085),i=r(10741),o=r(261),s=r(66667),u=r(89487),l=r(38758),c=r(18643),d=r(81120),g=r(46061),m=r(60364),h=r(46090);var p;function f(e,t,r,n){return{kind:p.FieldRefTerm,hasDotPreSpace:e,rhs:t,start:r,end:n}}function S(e){return e.kind!==s.TokenKind.Operator&&e.kind!==s.TokenKind.Sep&&e.kind!==s.TokenKind.End&&e.kind!==s.TokenKind.Spaces&&e.kind!==s.TokenKind.SingleLineComment&&e.kind!==s.TokenKind.MultiLineComment&&!(e.kind in p)}function v(e){return e.kind===s.TokenKind.Spaces||e.kind===s.TokenKind.SingleLineComment||e.kind===s.TokenKind.MultiLineComment}function F(e,t){return S(t=t.kind===p.MaybeWSFTerm?t.node:t)?(0,l.getNodeSpan)(e,t).start:t.start}!function(e){e.LambdaArgsTerm="LambdaArgsTerm",e.ArgsTerm="ArgsTerm",e.FieldRefTerm="FieldRefTerm",e.StructRefTerm="StructRefTerm",e.MaybeWSFTerm="MaybeWSFTerm"}(p||(t.TermKind=p={})),t.lambdaArgsTerm=function(e,t,r,n){return{kind:p.LambdaArgsTerm,nodes:e,isClosed:t,start:r,end:n}},t.argsTerm=function(e,t,r,n){return{kind:p.ArgsTerm,nodes:e,isClosed:t,start:r,end:n}},t.fieldRefTerm=f,t.structRefTerm=function(e,t,r){return{kind:p.StructRefTerm,rhs:e,start:t,end:r}},t.maybeWSFTerm=function(e,t){return{kind:p.MaybeWSFTerm,node:e,whole:t}};const y=(0,u.many)((0,u.take)(((e,t)=>v(t)?t:void 0))),C=(0,u.many1)((0,u.take)(((e,t)=>v(t)?t:void 0))),A=(0,u.peek)(((e,t)=>t)),E=function(e,t,r,i,o){const s=e[t];if(null==s){const r=`calc.parse.pStart: internal error: expected term at ${t} in ${(0,n.anonymize)(e)}`;return(0,a.assertFalse)(r)}return i(F(r,s),t)};function b(e){return(0,u.apply)((0,u.tuple)(y,E,(0,u.take)(e),E,y),((e,[t,r,n,a,o])=>(0,i.operatorNode)(n,(0,l.addSpan)(e,r,a,t,o))))}function R(e){return(0,u.apply)((0,u.tuple)(y,E,(0,u.take)(e),E),((e,[t,r,n,a])=>(0,i.operatorNode)(n,(0,l.addSpan)(e,r,a,t,""))))}function T(e){return(0,u.apply)((0,u.tuple)(E,(0,u.take)(e),E,y),((e,[t,r,n,a])=>(0,i.operatorNode)(r,(0,l.addSpan)(e,t,n,"",a))))}const k=b(((e,t)=>t.kind!==s.TokenKind.Operator||t.value!==o.OperatorId.Add&&t.value!==o.OperatorId.Sub?void 0:t.value)),N=T(((e,t)=>{if(t.kind===s.TokenKind.Operator){if(t.value===o.OperatorId.Add)return o.OperatorId.Pos;if(t.value===o.OperatorId.Sub)return o.OperatorId.Neg}})),I=T(((e,t)=>t.kind===s.TokenKind.Operator&&t.value===o.OperatorId.At?t.value:void 0)),O=R(((e,t)=>t.kind===s.TokenKind.Operator&&t.value===o.OperatorId.Pound?t.value:void 0)),_=(0,u.take)(((e,t)=>t.kind===p.StructRefTerm?t:void 0)),P=b(((e,t)=>t.kind!==s.TokenKind.Operator||t.value!==o.OperatorId.Mul&&t.value!==o.OperatorId.Div?void 0:t.value)),M=b(((e,t)=>t.kind===s.TokenKind.Operator&&t.value===o.OperatorId.Pow?t.value:void 0)),D=R(((e,t)=>t.kind===s.TokenKind.Operator&&t.value===o.OperatorId.Percent?t.value:void 0)),w=b(((e,t)=>t.kind===s.TokenKind.Operator&&t.value===o.OperatorId.Concat?t.value:void 0)),L=b(((e,t)=>t.kind===s.TokenKind.Operator&&t.value>=o.OperatorId.Eq&&t.value<=o.OperatorId.Ge?t.value:void 0)),x=b(((e,t)=>t.kind===s.TokenKind.Operator&&t.value===o.OperatorId.Range?t.value:void 0)),K=b(((e,t)=>t.kind===s.TokenKind.Operator&&t.value===o.OperatorId.Union?t.value:void 0)),W=(0,u.applyTake)((0,u.tuple)(C,A),((e,[t,r])=>{if(!(r.kind===s.TokenKind.End||r.kind===s.TokenKind.Operator&&r.value!==o.OperatorId.At||r.kind===s.TokenKind.Sep&&(0,d.isDotSepToken)(r))){if(1!==t.length||t[0].kind!==s.TokenKind.Spaces)return t;const n=F(e,r),a=(0,l.addSpan)(e,n,n,t[0].chars,"");return(0,i.operatorNode)(o.OperatorId.Isect,a)}})),U=(0,u.take)(((e,t)=>t.kind===s.TokenKind.Sep&&(0,d.isDotSepToken)(t)?t:void 0)),G=(0,u.take)(((e,t)=>t.kind===p.ArgsTerm?t:void 0)),B=(0,u.take)(((e,t)=>t.kind===p.LambdaArgsTerm?t:void 0)),V=(0,u.take)(((e,t)=>t.kind===p.ArgsTerm||t.kind===p.FieldRefTerm?t:void 0)),j={[o.WorksheetFuncId.LETREC]:m.FeatureName.CalcLetRecFunction};function H(e,t){if(t.kind===p.MaybeWSFTerm&&void 0!==t.whole){const r=(0,c.getWorksheetFuncId)(e,t.whole);if(void 0===r)return;if((0,a.assertTrue)("calc.parse.parseWSFName: unexpected UDF",r!==o.WorksheetFuncId._UDF),0!=((0,o.getWorksheetFuncType)(r).flags&h.FunctionFlags.Internal))return;const n=j[r];if(void 0!==n&&!(0,m.isFeatureEnabled)(n))return;return(0,i.wsfNode)(r,t.whole,t.node.label)}}t.isWSFNode=H;const q=(0,u.take)(((e,t)=>H(e.localeInfo,t))),$=(0,u.take)(((e,t)=>{const r=H(e.localeInfo,t);return r?.id===o.WorksheetFuncId.LAMBDA?r:void 0})),z=(0,u.apply)((0,u.tuple)($,B),((e,[t,r])=>{const n=(0,l.getNodeSpan)(e,t).start,a=r.nodes,o=(t.id,[]);let s;const u=[];for(let e=0;e<a.length;e+=1){const t=a[e];t.kind===i.NodeKind.Param?o.push((0,i.lambdaParam)((0,i.indexedArg)(t,e))):e===a.length-1?s=(0,i.indexedArg)(t,e):u.push((0,i.indexedArg)(t,e))}const c=(0,l.addSpan)(e,n,r.end,"","");return(0,i.lambdaNode)(t,o,s,u,r.isClosed,c)})),Q=(0,u.apply)((0,u.tuple)(q,G),((e,[t,r])=>{const n=(0,l.getNodeSpan)(e,t).start,s=r.nodes;switch(t.id){case o.WorksheetFuncId.LET:case o.WorksheetFuncId.LETREC:{t.id;const a=[],o=[];let g;for(let t=0;t<s.length;t+=1){const r=s[t];t!==s.length-1?!(t+1<s.length&&(0,c.isUnqualifiedNameNode)(r))||t+3<s.length&&(u=e.refStyle,d=s[t+2],!((0,c.isUnqualifiedNameNode)(d)||u===i.RefStyle.A1&&d.kind===i.NodeKind.CellRef&&void 0===d.qualifier&&d.ref.kind===i.CellRefKind.Single&&d.ref.col.kind===i.PosKind.Rel&&d.ref.row.kind===i.PosKind.Rel))&&(0,c.isUnqualifiedNameNode)(s[t+1])?o.push((0,i.indexedArg)(r,t)):(a.push((0,i.letVar)((0,i.indexedArg)((0,i.varNode)((0,i.identNode)(r.whole,r.parts.label),r.label),t),(0,i.indexedArg)(s[t+1],t+1))),t+=1):g=(0,i.indexedArg)(r,t)}const m=(0,l.addSpan)(e,n,r.end,"","");return(0,i.letNode)(t,a,g,o,r.isClosed,m)}case o.WorksheetFuncId.LAMBDA:return(0,a.assertFalse)("calc.parse.parseWSFApp: unexpected LAMBDA+ArgTerm")}var u,d;return Z(e,t,s,r.isClosed,n,r.end)}));function Y(e,t,r){return(0,u.apply)((0,u.tuple)((0,u.many)(e),t),((e,[t,n])=>t.reduceRight(r(e),n)))}function J(e,t,r){return(0,u.apply)((0,u.tuple)(e,(0,u.many)(t)),((e,[t,n])=>n.reduce(r(e),t)))}function X(e){return(t,[r,n])=>{if(o=r,Array.isArray(o)){const o=(0,l.getNodeSpan)(e,t);(0,a.assertTrue)("calc.parse.makeAppNodeInfix",0===o.post.length),[o.post,o.postComments]=(0,l.addWhitespace)(e,r);const s=(0,l.getNodeSpan)(e,n),u=(0,l.addSpan)(e,o.start,s.end,"","");return(0,i.badSequenceNode)(i.BadType.Unexpected,[t,n],u)}var o;const s=(0,l.getNodeSpan)(e,t).start,u=(0,l.getNodeSpan)(e,n).end,c=(0,l.addSpan)(e,s,u,"","");return(0,i.appNode)(r,[t,n],!0,c)}}function Z(e,t,r,n,a,o){const s=(0,l.addSpan)(e,a,o,"","");return(0,i.appNode)(t,r,n,s)}function ee(e){return(t,r)=>{const n=(0,l.getNodeSpan)(e,t).start;switch(r.kind){case p.ArgsTerm:return Z(e,t,r.nodes,r.isClosed,n,r.end);case p.FieldRefTerm:{const a=(0,l.addSpan)(e,n,r.end,"",""),{start:o,end:s,pre:u}=(0,l.getNodeSpan)(e,r.rhs);if((0,c.isNumberLiteralNode)(t)){const n=(0,l.addSpan)(e,o,o,"",""),u=(0,i.missingNode)("",n),c=r.rhs.label,d=(0,l.addSpan)(e,o,s,"",""),g=!1,m=(0,i.fieldRef)(r.rhs.field,r.rhs.isBracketed,r.rhs.isClosed,g,d);return(0,i.badSequenceNode)(i.BadType.FieldRef,[t,(0,i.fieldRefNode)(u,m,c)],a)}const d=!r.rhs.isBracketed&&(0,c.shouldFieldRefBeBracketed)(t,r.rhs,u),g=(0,i.fieldRef)(r.rhs.field,r.rhs.isBracketed,r.rhs.isClosed,d,r.rhs.label);return(0,i.fieldRefNode)(t,g,a)}case p.StructRefTerm:{const a=(0,l.addSpan)(e,n,r.end,"","");switch(t.kind){case i.NodeKind.Name:return(0,i.structRefNode)(t,r.rhs,a);case i.NodeKind.Missing:return(0,i.structRefNode)(void 0,r.rhs,a)}return(0,i.badSequenceNode)(i.BadType.StructRef,[t,(0,i.structRefNode)(void 0,r.rhs,(0,l.addSpan)(e,r.start,r.end,"",""))],a)}case i.NodeKind.Operator:return Z(e,r,[t],!0,n,(0,l.getNodeSpan)(e,r).end)}}}function te(e){let t=!0;return(r,n)=>{const a=(0,l.getNodeSpan)(e,n).start,s=(0,l.getNodeSpan)(e,r).end,u=(0,l.addSpan)(e,a,s,"","");if((n.id===o.OperatorId.Pos||n.id===o.OperatorId.Neg)&&t&&(t=!1,(0,c.isNumberLiteralNode)(r)&&""===(0,l.getNodeSpan)(e,n).post)){const t=n.id===o.OperatorId.Pos?r.oper:e.mathpack.neg(r.oper);return(0,i.literalNode)(t,!0,u)}return(0,i.appNode)(n,[r],!0,u)}}const re=(0,u.take)(((e,t)=>t.kind===p.MaybeWSFTerm?t.node:S(t)?t:void 0)),ne=(0,u.apply)((0,u.tuple)(y,U,E,y),((e,[t,r,n,a])=>(0,i.badCharsNode)(i.BadType.Unexpected,r.chars,(0,l.addSpan)(e,r.start,n,t,a)))),ae=(0,u.apply)((0,u.tuple)(E,y,U,E),((e,[t,r,n,a])=>{const o=(0,l.addSpan)(e,a,a,"",""),s=(0,l.addSpan)(e,n.start,a,r,""),u=(0,i.fieldRef)((0,i.missingNode)("",o),!1,!0,!1,s);return f(r.length>0,u,t,a)})),ie=(0,u.lazy)((()=>(0,u.apply)((0,u.tuple)(E,(0,u.many)((0,u.any)(z,Q,re,ne),(0,u.any)(z,Q,re,(0,u.right)((0,u.succeeds)(I),ce))),E),((e,[t,r,n])=>{if(1===r.length)return r[0];const a=(0,l.addSpan)(e,t,n,"","");return 0===r.length?(0,i.missingNode)("",a):(0,i.badSequenceNode)(i.BadType.Unexpected,r,a)})))),oe=J((0,u.lazy)((()=>(0,u.any)((0,u.right)((0,u.succeeds)(I),ce),(0,u.right)((0,u.succeeds)(N),ge),ie))),(0,u.any)(O,_),ee),se=J(oe,(0,u.tuple)(x,oe),X),ue=J(se,(0,u.tuple)(W,se),X),le=J(ue,(0,u.any)(V,ae),ee),ce=Y(I,le,te),de=J(ce,(0,u.tuple)(K,ce),X),ge=Y(N,de,te),me=J(ge,D,ee),he=J(me,(0,u.tuple)(M,me),X),pe=J(he,(0,u.tuple)(P,he),X),fe=J(pe,(0,u.tuple)(k,pe),X),Se=J(fe,(0,u.tuple)(w,fe),X),ve=J(Se,(0,u.tuple)(L,Se),X);t.runOperatorPrecedenceParser=function(e,t){let r=t.length-1;if(r<1){const e="calc.parse.runTermParser: internal error: expected at least 1 term";return(0,a.assertFalse)(e)}if(t[r].kind!==s.TokenKind.End){const e=`calc.parse.runTermParser: internal error: array[n].kind !== End in ${(0,n.anonymize)(t)}`;return(0,a.assertFalse)(e)}if(1===r&&S(t[0]))return t[0];if(v(t[0])){const e=`calc.parse.runTermParser: internal error: array[0].kind === Spaces/comment in ${(0,n.anonymize)(t)}`;return(0,a.assertFalse)(e)}if(v(t[r-1])){const e=`calc.parse.runTermParser: internal error: array[n-1].kind === Spaces/comment in ${(0,n.anonymize)(t)}`;return(0,a.assertFalse)(e)}for(;;){const i=(0,u.runParser)(ve,t,0,e);if((0,g.isSuccess)(i)&&i.value.index>=r)return i.value.output;if(!(0,g.isSuccess)(i)||0===i.value.index||1===i.value.index&&S(t[0])){const e=`calc.parse.runTermParser: internal error: consumed ${(0,g.isSuccess)(i)?i.value.index:0} out of ${r} in ${(0,n.anonymize)(t)}`;return(0,a.assertFalse)(e)}r=(t=[i.value.output,...t.slice(i.value.index)]).length-1}}},13053:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseQualifier=void 0;const n=r(74643),a=r(10741),i=r(89487),o=r(38758),s=r(81120),u=r(66667),l=n.__importStar(r(98539)),c=r(46090),d=r(43436),g=r(3085);function m(e){return e.kind===u.TokenKind.Literal&&e.oper.kind===c.OperKind.Boolean}const{codePointFullStop:h}=l,p=(0,i.opt)((0,i.takePeek)(((e,t,r)=>t.kind!==u.TokenKind.Spaces||(0,s.isWhitespaceToken)(r)?void 0:t.chars)),""),f=(0,i.take)(((e,t)=>t.isIdentContinue&&!m(t)&&t.chars.length>0&&t.chars.charCodeAt(0)!==h?t.chars:void 0)),S=(0,i.take)(((e,t)=>t.isIdentContinue||(0,s.isDotSepToken)(t)?t.chars:void 0)),v=(0,i.apply)((0,i.many1)(f,S),((e,t)=>t.join(""))),F=(0,i.take)(((e,t)=>t.kind===u.TokenKind.Ident?t.chars:void 0)),y=(e,t)=>(t.path??"")+e.leftBracket+t.document+e.rightBracket;function C(e,t,r,n,i,o){let s,u;if(null==t)null==n?(s=(0,a.identQualifier)(r,i,o),u=r):(s=(0,a.sheetRangeQualifier)(r,n,void 0,i,o),u=`${r}:${n}`);else{const l=y(e.localeInfo,t);null==n?(s=(0,a.sheetQualifier)(r,t,i,o),u=`${l}${r}`):(s=(0,a.sheetRangeQualifier)(r,n,t,i,o),u=`${l}${r}:${n}`)}return[s,i?(0,d.quoteQualifier)(u):u]}const A=(0,i.take)(((e,t)=>t.kind===u.TokenKind.Ident||(0,s.isRangeOpToken)(t)?t.chars:void 0)),E=(0,i.apply)((0,i.tuple)(s.parseCharIndex,(0,i.many)(A),s.parseLeftBracket,(0,i.many1)(A),s.parseRightBracket,s.parseCharIndex),((e,[t,r,n,i,s,u])=>{const l=r.join(""),c=i.join("");return(0,a.documentQualifier)(c,""!==l?l:void 0,!0,(0,o.addSpan)(e,t,u,"",""))})),b=(0,i.apply)((0,i.tuple)(s.parseCharIndex,s.parseLeftBracket,(0,i.many1)(S),s.parseRightBracket,s.parseCharIndex),((e,[t,r,n,i,s])=>{const u=n.join("");return(0,a.documentQualifier)(u,void 0,!1,(0,o.addSpan)(e,t,s,"",""))})),R=(0,i.apply)((0,i.tuple)(s.parseCharIndex,(0,i.opt)(b,void 0),v,(0,i.opt)((0,i.right)(s.parseRangeOp,v),void 0),s.parseCharIndex),((e,[t,r,n,a,i])=>C(e,r,n,a,!1,(0,o.addSpan)(e,t,i,"","")))),T=(0,i.apply)((0,i.tuple)(s.parseLeftSQuote,(0,i.opt)(E,void 0),F,(0,i.opt)((0,i.right)(s.parseRangeOp,F),void 0),s.parseRightSQuote,s.parseCharIndex),((e,[t,r,n,a,i,s])=>C(e,r,n,a,!0,(0,o.addSpan)(e,t.start,s,"","")))),k=(0,i.apply)(b,((e,t)=>[t,y(e.localeInfo,t)])),N=(0,i.apply)((0,i.tuple)(s.parseLeftSQuote,E,s.parseRightSQuote,s.parseCharIndex),((e,[t,r,n,i])=>[(0,a.documentQualifier)(r.document,r.path,!0,(0,o.addSpan)(e,t.start,i,"","")),(0,d.quoteQualifier)(y(e.localeInfo,r))])),I=(0,i.take)(((e,t)=>t.kind===u.TokenKind.End||t.kind===u.TokenKind.Right&&t.value===u.DelimId.SQuote?void 0:t.chars)),O=(0,i.apply)((0,i.tuple)(s.parseLeftSQuote,(0,i.many)(I),(0,i.opt)((0,i.tuple)(s.parseRightSQuote,(0,i.opt)((0,i.tuple)(s.parseQualSep,p),[void 0,""])),[void 0,[void 0,""]]),s.parseCharIndex),((e,[t,r,[n,[i,s]],u])=>{const l=void 0!==n,c=void 0!==i,d=`'${r.join("")}${l?"'":""}${c?"!":""}`,g=(0,o.addSpan)(e,t.start,u-s.length,"",s);return[(0,a.badQualifier)(d,!0,l,c,g),d]})),_=(0,i.takePeek)(((e,t,r)=>{if((0,s.isRefErrorToken)(t)){const n=(0,o.addSpan)(e,t.start,r.start,"","");return[(0,a.errorQualifier)(n),t.chars]}})),P=(0,i.peek)(((e,t)=>{const r=(0,o.addSpan)(e,t.start,t.start,"","");return[(0,a.relativeQualifier)(r),""]})),M=(0,i.apply)((0,i.tuple)((0,i.any)(R,T,k,N,P),s.parseQualSep,p),((e,[[t,r],n,a])=>{const i=(0,o.getNodeSpan)(e,t);return i.end+=1,(0,g.assertTrue)("calc.parse.parseGoodQualifier",i.end===n.start+n.chars.length),(0,g.assertTrue)("calc.parse.parseGoodQualifier",0===i.post.length),i.post=a,[t,`${r}!`]})),D=(0,i.take)(((e,t)=>t.isIdentContinue||(0,s.isDotSepToken)(t)||m(t)||function(e){return e.kind===u.TokenKind.Literal&&(0,u.isNumberLikeOper)(e.oper)}(t)?t.chars:void 0)),w=(0,i.apply)((0,i.tuple)(s.parseCharIndex,(0,i.many)(D),s.parseQualSep,s.parseCharIndex,p),((e,[t,r,n,i,s])=>{const u=`${r.join("")}!`,l=(0,o.addSpan)(e,t,i,"",s);return[(0,a.badQualifier)(u,!1,!0,!0,l),u]}));t.parseQualifier=(0,i.any)(_,M,w,O)},60400:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseRef=t.parseUnqualBadRef=t.isCompleteCellRefToken=void 0;const n=r(70308),a=r(3085),i=r(10741),o=r(84538),s=r(68112),u=r(66667),l=r(89487),c=r(49704),d=r(38758),g=r(18643),m=r(81120),h=r(13053),p=r(46090),f=r(86433),S=r(8684);function v(e,t){return e.refStyle===t.refStyle&&!t.isBadLocale&&t.row!==s.SpecialPos.A1BadDollar&&t.col!==s.SpecialPos.A1BadDollar}function F(e){return e.refStyle===i.RefStyle.R1C1||"object"==typeof e.row&&"object"==typeof e.col}function y(e,t){return t.kind===u.TokenKind.CellRef&&v(e,t)&&F(t)}t.isCompleteCellRefToken=y;const C=(0,i.pos)(i.PosKind.Rel,0);function A(e){return e===s.SpecialPos.RCNoNum?C:e}function E(e,t){if(e.row!==s.SpecialPos.A1BadDollar&&e.col!==s.SpecialPos.A1BadDollar){const r=e.refStyle===i.RefStyle.R1C1&&!e.isIdentContinue;if(null!=e.row&&null!=e.col)return(0,i.cellRefSingle)(A(e.row),A(e.col),r,t);if(null!=e.row){const n=A(e.row);return(0,i.cellRefRow)(n,n,r,t)}if(null!=e.col){const n=A(e.col);return(0,i.cellRefCol)(n,n,r,t)}}const r=`calc.parse.cellRefToken2cellRef: bad token ${(0,n.anonymize)(e)}`;return(0,a.assertFalse)(r)}function b(e,t){return t.isIdentContinue&&e.localeInfo.isIdentStart((0,f.stringCodePointAt)(t.chars,0))}const R=(0,l.take)(((e,t)=>y(e,t)&&!b(e,t)||(0,m.isRefErrorToken)(t)?t:void 0)),T=(0,l.take)(((e,t)=>y(e,t)&&b(e,t)?t:void 0)),k=(0,l.apply)((0,l.tuple)((0,l.any)(R,(0,l.withState)((e=>e.cellRefMustBeCellRefNode?T:(0,l.left)(T,(0,l.fails)((0,l.any)(m.parseIdentContinue,m.parseDotSepTokenNotFollowedByLeftBracket)))))),m.parseCharIndex),((e,[t,r])=>{const n=t.kind===u.TokenKind.CellRef?E(t,(0,d.addSpan)(e,t.start,r,"","")):(0,i.cellRefError)((0,d.addSpan)(e,t.start,r,"","")),a=t.kind===u.TokenKind.CellRef?t.chars:void 0;return(0,c.maybeWSFTerm)((0,i.cellRefNode)(n,void 0,(0,d.addSpan)(e,t.start,r,"","")),a)})),N=(0,l.takePeek)(((e,t,r)=>t.kind!==u.TokenKind.CellRef||!v(e,t)||function(e,t,r){return r.kind===u.TokenKind.Left&&r.value===u.DelimId.Paren&&t.isIdentContinue&&null!=(0,g.getWorksheetFuncId)(e.localeInfo,t.chars)}(e,t,r)||r.isIdentContinue?void 0:[t,r.start])),I=(0,l.bind)((0,l.tuple)(N,m.parseSpacesOnly,m.parseRangeOp,m.parseSpacesOnly,N),((e,[[t,r],n,a,o,[s,g]])=>{const m=(0,d.addSpan)(e,t.start,r,"",n),h=(0,d.addSpan)(e,s.start,g,o,""),p=E(t,m),f=E(s,h);let S;if(p.kind===i.CellRefKind.Single&&f.kind===i.CellRefKind.Single){const r=(0,d.addSpan)(e,t.start,g,"","");S=(0,i.cellRefRange)(p,f,r)}else if(0===n.length&&0===o.length)if(p.kind===i.CellRefKind.Row&&f.kind===i.CellRefKind.Row){const r=p.isBracketed||f.isBracketed,n=(0,d.addSpan)(e,t.start,g,"","");S=(0,i.cellRefRow)(p.row1,f.row1,r,n)}else if(p.kind===i.CellRefKind.Col&&f.kind===i.CellRefKind.Col){const r=p.isBracketed||f.isBracketed,n=(0,d.addSpan)(e,t.start,g,"","");S=(0,i.cellRefCol)(p.col1,f.col1,r,n)}if(null==S)return(0,l.parseFail)();const v=(0,c.maybeWSFTerm)((0,i.cellRefNode)(S,void 0,(0,d.addSpan)(e,t.start,g,"","")),void 0);return t.isIdentContinue&&s.isIdentContinue?(0,l.peek)(((e,t)=>t.kind===u.TokenKind.Sep&&t.value===u.SepId.Qual?void 0:v)):(0,l.parseSucceed)(v)})),O=(0,l.any)(I,k);t.parseUnqualBadRef=(0,l.apply)((0,l.take)(((e,t)=>t.kind===u.TokenKind.CellRef?t:void 0)),((e,t)=>{const r=t.start+t.chars.length,n=t.refStyle===i.RefStyle.R1C1&&!t.isIdentContinue;return(0,c.maybeWSFTerm)((0,i.cellRefNode)((0,i.cellRefBad)(t.chars,n,(0,d.addSpan)(e,t.start,r,"","")),void 0,(0,d.addSpan)(e,t.start,r,"","")),t.chars)}));const _=(0,l.take)(((e,t)=>t.kind===u.TokenKind.Ident&&e.localeInfo.isIdentStart((0,f.stringCodePointAt)(t.chars,0))||t.kind===u.TokenKind.CellRef&&b(e,t)?t:void 0)),P=(0,l.take)(((e,t)=>t.kind===u.TokenKind.Literal&&t.oper.kind===p.OperKind.Boolean?t:void 0)),M=(0,l.any)(_,(0,l.left)(P,(0,l.succeeds)(m.parseDotSepTokenNotFollowedByLeftBracket))),D=(0,l.peek)(((e,t)=>(0,m.isLeftBracketToken)(t))),w=(0,l.tuple)((0,l.many1)(M,m.parseIdentContinue),(0,l.many)((0,l.any)(m.parseIdentContinue,m.parseDotSepTokenNotFollowedByLeftBracket)),D,m.parseCharIndex),L=(0,l.apply)(w,(function(e,[t,r,n,o]){const l=t[0],g=1===t.length&&r[0]?.kind===u.TokenKind.Sep,m=l.kind!==u.TokenKind.CellRef||(h=l).refStyle===i.RefStyle.A1&&null==h.row&&"object"==typeof h.col&&h.col.kind===i.PosKind.Rel||function(e,t){return t.refStyle===i.RefStyle.A1&&e.refStyle===i.RefStyle.A1&&t.isIdentContinue||t.refStyle===i.RefStyle.R1C1&&(0,s.isR1C1IdentStart)(t.row,t.col)}(e,l)&&g;var h;if(n||function(e,t,r){return 0===r.length||1===t.length&&t[0].kind===u.TokenKind.Literal||r.some(((t,r)=>r%2==0?t.kind!==u.TokenKind.Sep:t.kind===u.TokenKind.Sep||!(0,S.isUnbracketedField)(e.localeInfo,t.chars)))}(e,t,r)){const n=[...t,...r].map((e=>e.chars)).join(""),a=(0,d.addSpan)(e,l.start,o,"",""),s=(0,d.addSpan)(e,l.start,o,"",""),u=(0,i.identNamePart)(n,m,a,s),g=(0,i.nameNode)(u,void 0,(0,d.addSpan)(e,l.start,o,"",""));return(0,c.maybeWSFTerm)(g,g.whole)}let p,f=m,y=0,C=r[y]?.start??o,A=(0,d.addSpan)(e,l.start,C,"",""),b=(0,d.addSpan)(e,l.start,C,"","");if(1===t.length&&l.kind===u.TokenKind.CellRef)if(v(e,l))if(F(l)){const t=E(l,(0,d.addSpan)(e,l.start,C,"",""));p=(0,i.cellRefNamePart)(t,l.chars,A,b)}else p=(0,i.identNamePart)(l.chars,f,A,b);else f=!1,p=(0,i.identNamePart)(l.chars,f,A,b);else{let n=t.map((e=>e.chars)).join("");(0===e.localeInfo.stringCompareCI(n,"_xlpm")||0===e.localeInfo.stringCompareCI(n,"_xleta"))&&y+1<r.length&&(n+="."+r[y+1].chars,y+=2,C=r[y]?.start??o,A=(0,d.addSpan)(e,l.start,C,"",""),b=(0,d.addSpan)(e,l.start,C,"","")),p=(0,i.identNamePart)(n,f,A,b)}let R=p;for(;y+1<r.length;y+=2){const t=r[y],n=r[y+1],a=r[y+2]?.start??o;R=(0,i.fieldRefNamePart)(R,(0,i.fieldRef)((0,i.identNode)(n.chars,(0,d.addSpan)(e,n.start,a,"","")),!1,!0,!1,(0,d.addSpan)(e,t.start,a,"","")),y+2>=r.length?m:f,(0,d.addSpan)(e,l.start,a,"",""),(0,d.addSpan)(e,l.start,a,"",""))}if(y<r.length){const t=r[y],n=r[y+1]?.start??o,a=(0,i.fieldRef)((0,i.missingNode)("",(0,d.addSpan)(e,n,n,"","")),!1,!0,!1,(0,d.addSpan)(e,t.start,n,"",""));R=(0,i.fieldRefNamePart)(R,a,m,(0,d.addSpan)(e,l.start,n,"",""),(0,d.addSpan)(e,l.start,n,"","")),y+=1}(0,a.assertTrue)("calc.parse.pUnqualName: i == tailTokens",y===r.length),R.kind===i.NamePartKind.CellRefNamePart&&(0,a.assertFalse)("calc.parse.pUnqualName: expected lhs.kind !== NamePartKind.CellRefNamePart");const T=(0,i.nameNode)(R,void 0,(0,d.addSpan)(e,l.start,o,"",""));return(0,c.maybeWSFTerm)(T,T.whole)})),x=(0,l.opt)((0,l.any)(O,L,t.parseUnqualBadRef),{node:void 0}),K=(0,l.any)(O,(0,l.right)((0,l.fails)(L),t.parseUnqualBadRef)),W=(0,l.bind)(h.parseQualifier,((e,[t,r])=>(0,l.apply)(t.kind===i.QualifierKind.SheetRange?(0,d.cellRefMustBeCellRefNode)(t.isQuoted?x:K):t.kind===i.QualifierKind.Error?(0,d.cellRefMustBeCellRefNode)(x):x,((e,{node:n})=>{if(null==n)return t.kind===i.QualifierKind.Error?(0,i.literalNode)(o.refErrorOper,!0,t.label):(0,i.badCharsNode)(i.BadType.Qualifier,r,t.label);const s=(0,d.getNodeSpan)(e,t).start,u=(0,d.getNodeSpan)(e,n).end;if(n.kind===i.NodeKind.Name){const r=(0,d.addSpan)(e,s,u,"","");if(t.kind===i.QualifierKind.Error){const e=(0,i.literalNode)(o.refErrorOper,!0,t.label);return(0,i.badSequenceNode)(i.BadType.Unexpected,[e,n],r)}return(0,a.assertTrue)("calc.parse.pQualRef: sheet-range-name quoted",t.kind!==i.QualifierKind.SheetRange||t.isQuoted),t.kind===i.QualifierKind.SheetRange&&void 0===t.document&&(t=(0,i.identQualifier)(`${t.sheet1}:${t.sheet2}`,t.isQuoted,t.label)),(0,i.nameNode)(function(e,t,r){let n=t;for(;(0,d.getSpan)(e,n.qualifiedLabel).start=r,n.kind===i.NamePartKind.FieldRefNamePart;)n=n.lhs;return t}(e,n.parts,s),t,r)}const l=(0,d.addSpan)(e,s,u,"","");return t.kind===i.QualifierKind.Ident&&(t=(0,i.sheetQualifier)(t.name,void 0,t.isQuoted,t.label)),(0,i.cellRefNode)(n.ref,t,l)})))),U=(0,l.apply)((0,l.any)(O,L),((e,t)=>t.node.kind===i.NodeKind.CellRef&&t.node.ref.kind===i.CellRefKind.Error?(0,i.literalNode)(o.refErrorOper,!0,t.node.label):t));t.parseRef=(0,l.any)(W,U)},58796:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseResultHelper=t.ExtractLetVisitor=t.CaretInsideArrayNodeIdentityVisitor=void 0;const n=r(3085),a=r(10741),i=r(63745),o=r(261),s=r(46061),u=r(28581),l=r(6791),c=r(76076),d=r(46090),g=r(84538),m=r(66761);class h extends u.IdentityVisitor{arrayNode(e,t,r){const n=super.arrayNode(e,t,r);return this.autoCompleteFixForArrayNodesEnabled&&this.caretInNode(n)&&(this.isInsideArrayNode=!0),n}caretInNode(e){if(void 0===e)return!1;const t=this.parsedFormulaTree.spans[e.label];return void 0!==t&&this.caretPosition>=t.start&&this.caretPosition<=t.end}constructor(e,t){super(),this.parsedFormulaTree=e,this.caretPosition=t,this.isInsideArrayNode=!1,this.autoCompleteFixForArrayNodesEnabled=(0,m.isChangeGateEnabled)("OfficeVSO:7896479_autoCompleteFixForArrayNodesEnabled")}}function p(e,t){const r=e[t];return(0,n.assertTrue)("ParseResultHelper.getFormulaSpan: expected span to be defined",void 0!==r),r}t.CaretInsideArrayNodeIdentityVisitor=h;class f extends h{letNode(e,t,r,n,a,i){if(this.caretInNode(r?.arg))this.pushNames(t);else for(let r=0;r<t.length;r+=1){const{binder:n}=t[r];if(this.caretInNode(n.arg)){this.pushNames(e.id===o.WorksheetFuncId.LET?t.slice(0,r):t);break}}return super.letNode(e,t,r,n,a,i)}lambdaNode(e,t,r,n,a,i){if(this.caretInNode(r?.arg))this.pushNames(t);else for(let e=0;e<t.length;e+=1){const{name:r}=t[e];if(void 0!==r.arg.def&&this.caretInNode(r.arg.def.rhs)){this.pushNames(t.slice(0,e));break}}return super.lambdaNode(e,t,r,n,a,i)}pushNames(e){(0,l.safePush)(this.references,e.map((({name:e})=>e.arg.wholeName)).filter(l.isDefined).reverse())}constructor(e,t){super(e,t),this.references=[]}}function S(e,t,r,o,l=!1,m,h){if(!(0,s.isSuccess)(e))return!1;try{!function(e,t,r,n,i,o,l){if(null==e||null==n)return;const c={};null!=r?r.forEach((e=>{c[e]=!0})):c["*"]=!0;const m={};{let t=0;const r=[],n={...u.voidVisitor,letNode(n,a,i,o,s,u){for(const{name:e}of a)m[e.arg.label]=t;r.push({letCount:t,span:p(e.spans,u)}),t+=1},lambdaNode(n,a,i,o,s,u){for(const{name:e}of a)m[e.arg.label]=t;r.push({letCount:t,span:p(e.spans,u)}),t+=1}};(0,u.reduceBottomUp)(n,e),r.sort(((e,t)=>e.span.start-t.span.start));const a={};for(let e=0;e<r.length;e+=1)a[r[e].letCount]=e;for(const e of Object.keys(m).map(Number))m[e]=a[m[e]]}const h={literalNode(e,t,r){const a=u.identityVisitor.literalNode(e,t,r);return f("literal")&&n("literal",{label:r,value:a,valueKind:e.kind}),a},missingNode(e,t){const r=u.identityVisitor.missingNode(e,t);return f("literal")&&n("literal",{label:t,value:(0,a.literalNode)(g.missingOper,!0,t),valueKind:d.OperKind.Missing}),r},arrayNode:(e,t,r)=>u.identityVisitor.arrayNode(e,t,r),appNode(e,t,r,n){const a=u.identityVisitor.appNode(e,t,r,n);return v(e,0,r,n),a},letNode(e,t,r,i,o,s){const u=(0,a.letNode)(e,t,r,i,o,s);v(e,u.args,o,s);for(const{name:e}of t)f("letName")&&n("letName",{label:e.arg.label,name:e.arg.wholeName,number:m[e.arg.label],qualifier:void 0});return u},lambdaNode(e,t,r,i,o,s){const u=(0,a.lambdaNode)(e,t,r,i,o,s);v(e,u.args,o,s);for(const{name:e}of t)f("letName")&&n("letName",{label:e.arg.name.name.label,name:e.arg.wholeName,number:m[e.arg.label],qualifier:void 0});return u},parenNode:(e,t,r)=>u.identityVisitor.parenNode(e,t,r),nameNode(t,r,i){const o=(0,a.nameNode)(t,r,i),s=e.annotations[t.label],u=e.annotations[i];if(u?.kind===a.AnnotationKind.AppHeadName);else if(s?.kind===a.AnnotationKind.LocalNameUse){const e=m[s.label];f("letName")&&null!=e&&n("letName",{label:i,name:s.name,number:e,qualifier:void 0})}else if(f("namedRange")){const e=o.whole.split(".");n("namedRange",{label:i,name:e[0],names:e.slice(1),qualifier:S(o)})}return o},cellRefNode(t,r,i){const o=(0,a.cellRefNode)(t,r,i);return f("range")&&function(t){if(null!=e&&null!=n)switch(t.ref.kind){case a.CellRefKind.Error:break;case a.CellRefKind.Col:const r=t.ref;n("range",{label:t.label,type:"col",startIndex:r.col1,endIndex:r.col2,span:p(e.spans,r.label),qualifier:S(t)});break;case a.CellRefKind.Row:const i=t.ref;n("range",{label:t.label,type:"row",startIndex:i.row1,endIndex:i.row2,span:p(e.spans,i.label),qualifier:S(t)});break;case a.CellRefKind.Single:const o=t.ref;n("range",{label:t.label,type:"cell",row:o.row,col:o.col,span:p(e.spans,o.label),qualifier:S(t)});break;case a.CellRefKind.Range:const s=t.ref;n("range",{label:t.label,type:"range",top:s.ref1.row,left:s.ref1.col,bottom:s.ref2.row,right:s.ref2.col,topLeftSpan:p(e.spans,s.ref1.label),bottomRightSpan:p(e.spans,s.ref2.label),qualifier:S(t)})}}(o),o},fieldRefNode:(e,t,r)=>u.identityVisitor.fieldRefNode(e,t,r),structRefNode(t,r,i){const u=(0,a.structRefNode)(t,r,i);if(f("structRefRange")){if(null==l||null==o)return u;const{resolution:r}=l.resolveStructRef(o,u);if(!(0,s.isSuccess)(r)||void 0===r.value)return u;const c=r.value;n("structRefRange",{label:i,type:"range",top:(0,a.pos)(a.PosKind.Rel,c.range.row),left:(0,a.pos)(a.PosKind.Rel,c.range.col),bottom:(0,a.pos)(a.PosKind.Rel,c.range.row+c.range.rows-1),right:(0,a.pos)(a.PosKind.Rel,c.range.col+c.range.cols-1),span:p(e.spans,i),qualifier:void 0!==t?S(t):void 0,name:void 0!==t?t.whole:void 0})}return u},badSequenceNode:(e,t,r)=>u.identityVisitor.badSequenceNode(e,t,r),badCharsNode:(e,t,r)=>u.identityVisitor.badCharsNode(e,t,r),operatorNode:(e,t)=>u.identityVisitor.operatorNode(e,t),wsfNode:(e,t,r)=>u.identityVisitor.wsfNode(e,t,r)};function f(e){return c[e]||c["*"]}function S(e){if(null!=e.qualifier){const t={};switch(e.qualifier.kind){case a.QualifierKind.Sheet:const r=e.qualifier;t.type="Sheet",t.sheet=r.sheet,null!=r.document&&(t.document=r.document.document,null!=r.document.path&&(t.documentPath=r.document.path));break;case a.QualifierKind.SheetRange:const n=e.qualifier;t.type="SheetRange",t.sheet1=n.sheet1,t.sheet2=n.sheet2,null!=n.document&&(t.document=n.document.document,null!=n.document.path&&(t.documentPath=n.document.path));break;case a.QualifierKind.Ident:const i=e.qualifier;t.type="Ident",t.name=i.name;break;case a.QualifierKind.Document:const o=e.qualifier;t.type="Document",t.document=o.document,null!=o.path&&(t.documentPath=o.path)}return t}}function v(e,t,r,i){if(null!=n)switch(e.kind){case a.NodeKind.Operator:f("operator")&&n("operator",{label:i,value:e.id});break;case a.NodeKind.WSF:case a.NodeKind.Name:f("function")&&n("function",{label:i,name:e.whole,isClosed:r,args:[]})}}(0,u.reduceBottomUp)(h,e)}(e.value,o??(0,i.getEnglishLocaleInfo)(),t,r,0,m,h)}catch(e){const t=`ParseResultHelper.traverse: unhandled error ${(0,c.messageFromError)(e)}`;n.ulsLogger.ULS.traceTag(507381982,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,t)}return!0}t.ExtractLetVisitor=f,t.parseResultHelper={isSuccess:s.isSuccess,traverse:S,extractReferences:function(e,t,r=!1,n,a){if(!(0,s.isSuccess)(e))return;const i=[];return S(e,["range","namedRange","letName","literal","function","structRefRange"],((t,r)=>{const n={kind:t,ref:r,span:p(e.value.spans,r.label)};i.push(n)}),t,r,n,a),i.sort(((e,t)=>{let r;return 0!=(r=e.span.start-t.span.start)||0!=(r=t.span.end-e.span.end)?r:0})),i},extractLetVariables:function(e,t){if((0,s.isSuccess)(e))try{const r=new f(e.value,t);return(0,u.reduceBottomUp)(r,e.value),r.references.reverse()}catch(e){const t=`ParseResultHelper.extractLetVariables: unhandled error ${(0,c.messageFromError)(e)}`;return n.ulsLogger.ULS.traceTag(507381983,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,t),[]}}}},18559:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseStructRef=void 0;const n=r(89487),a=r(49704),i=r(81120),o=r(10741),s=r(38758),u=r(66667),l=r(46061),c=(0,n.take)(((e,t)=>t.isIdentContinue||t.kind===u.TokenKind.Spaces?t:void 0)),d=(0,n.apply)((0,n.many1)(c),((e,t)=>{const r=t[0];return 1===t.length?r:(0,u.identToken)(r.start,t.map((e=>e.kind===u.TokenKind.Escape?"":e.chars)).join(""))})),g=(0,n.take)(((e,t)=>t.isIdentContinue||t.kind===u.TokenKind.Spaces||t.kind===u.TokenKind.Escape||(0,i.isListSepToken)(t)||(0,i.isRangeOpToken)(t)?t:void 0)),m=(0,n.apply)((0,n.many1)(g),((e,t)=>{const r=t[0];return 1===t.length?r:(0,u.identToken)(r.start,t.map((e=>e.kind===u.TokenKind.Escape?"":e.chars)).join(""))})),h=(0,n.take)(((e,t)=>t.kind===u.TokenKind.SpecialRef?t:void 0)),p=(0,n.apply)((0,n.tuple)(i.parseCharIndex,h,i.parseCharIndex),((e,[t,r,n])=>(0,o.specialRef)(r.value,!1,!0,(0,s.addSpan)(e,t,n,"","")))),f=(0,n.apply)((0,n.tuple)(i.parseCharIndex,i.parseLeftBracket,h,(0,n.opt)(i.parseRightBracket,void 0),i.parseCharIndex),((e,[t,r,n,a,i])=>(0,o.specialRef)(n.value,!0,void 0!==a,(0,s.addSpan)(e,t,i,"","")))),S=(0,n.any)(p,f),v=(0,n.apply)((0,n.tuple)(i.parseCharIndex,d,i.parseCharIndex),((e,[t,r,n])=>(0,o.columnRef)(r.chars,!1,!0,(0,s.addSpan)(e,t,n,"","")))),F=(0,n.apply)((0,n.tuple)(i.parseCharIndex,i.parseLeftBracket,(0,n.opt)(m,void 0),(0,n.opt)(i.parseRightBracket,void 0),i.parseCharIndex),((e,[t,r,n,a,i])=>(0,o.columnRef)(n?.chars??"",!0,void 0!==a,(0,s.addSpan)(e,t,i,"","")))),y=(0,n.apply)((0,n.tuple)(i.parseCharIndex,m,i.parseCharIndex),((e,[t,r,n])=>(0,o.columnRef)(r.chars,!1,!0,(0,s.addSpan)(e,t,n,"","")))),C=(0,n.any)(v,F),A=(0,n.apply)(i.parseCharIndex,((e,t)=>(0,o.missingRef)((0,s.addSpan)(e,t,t,"","")))),E=(0,n.any)(C,A),b=(0,n.take)(((e,t)=>"#"===t.chars?t:void 0)),R=(0,n.apply)((0,n.many1)(b,c),((e,t)=>(0,u.unexpectedToken)(t[0].start,t.map((e=>e.chars)).join("")))),T=(0,n.apply)((0,n.many1)(b,g),((e,t)=>(0,u.unexpectedToken)(t[0].start,t.map((e=>e.chars)).join("")))),k=(0,n.apply)((0,n.tuple)(i.parseCharIndex,R,i.parseCharIndex),((e,[t,r,n])=>(0,o.badRef)(r.chars,!1,!0,(0,s.addSpan)(e,t,n,"","")))),N=(0,n.apply)((0,n.tuple)(i.parseCharIndex,i.parseLeftBracket,T,(0,n.opt)(i.parseRightBracket,void 0),i.parseCharIndex),((e,[t,r,n,a,i])=>(0,o.badRef)(n.chars,!0,void 0!==a,(0,s.addSpan)(e,t,i,"","")))),I=(0,n.any)(k,N),O=(0,n.apply)((0,n.tuple)(i.parseCharIndex,E,i.parseRangeOp,E,i.parseCharIndex),((e,[t,r,n,a,i])=>(0,o.rangeOpRef)(r,a,(0,s.addSpan)(e,t,i,"","")))),_=(0,n.any)(O,C),P=(0,n.any)(S,I,O,C,A),M=(0,n.apply)((0,n.tuple)(i.parseCharIndex,P,(0,n.many1)((0,n.tuple)(i.parseListSep,P)),i.parseCharIndex),((e,[t,r,n,a])=>(0,o.commaOpRef)([r,...n.map((([e,t])=>t))],(0,s.addSpan)(e,t,a,"","")))),D=(0,n.apply)((0,n.tuple)(i.parseCharIndex,i.parseAtOp,(0,n.opt)(_,void 0),i.parseCharIndex),((e,[t,r,n,a])=>(0,o.thisRowOpRef)(n,(0,s.addSpan)(e,t,a,"","")))),w=(0,n.apply)(i.parseSpacesOnly,(()=>{})),L=(0,n.any)((0,n.left)(w,i.parseEnd),(0,n.left)(y,i.parseEnd),(0,n.left)(M,i.parseEnd),(0,n.left)(D,i.parseEnd),(0,n.left)(O,i.parseEnd),(0,n.left)(S,i.parseEnd),(0,n.left)(I,i.parseEnd),(0,n.left)(F,i.parseEnd));t.parseStructRef=(0,n.applyTake)((0,n.tuple)(i.parseCharIndex,i.parseBracketedTokens,i.parseCharIndex),((e,[t,[r,i],u])=>{const c=(0,n.runParser)(L,r,0,e);return(0,l.isSuccess)(c)?(0,a.structRefTerm)((0,o.structRef)(c.value.output,i,(0,s.addSpan)(e,t,u,"","")),t,u):void 0}))},89487:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.concat=t.flatten=t.middle=t.right=t.left=t.tuple=t.many1=t.many=t.reduce=t.applyTake=t.takePeek=t.peek=t.take=t.fails=t.succeeds=t.opt=t.any=t.withState=t.apply=t.bind=t.parseFail=t.parseSucceed=t.warnSucceedOrFail=t.setDebugging=t.lazy=t.runParser=void 0;const n=r(3085),a=r(70308),i=r(46061),o=r(6791);t.runParser=function(e,t,r,o){let s;if(function(e){let t=e;for(;null!=t;)t=t()}(e(t,r,o,(function(e,t){s=(0,i.success)({output:e,index:t})}),(function(){s=(0,i.failure)(void 0)}))),null==s){const e=`calc.parse.runParser: internal error: parser did not call resolve or reject on ${(0,a.anonymize)(t)}`;return(0,n.assertFalse)(e)}return s},t.lazy=function(e){let t;return function(r,n,a,i,o){const s=t??(t=e());return()=>s(r,n,a,i,o)}};let s=!1;function u(e){return function(t,r,n,a,i){return a(e,r)}}t.setDebugging=function(e){s=e},t.warnSucceedOrFail=function(e,t){return function(r,n,a,i,o){return e(r,n,a,((e,n)=>(s&&console.warn(`${t} succeeded, returning index ${n} (of ${r.length}) with`,e),i(e,n))),(()=>(s&&console.warn(`${t} failed at index ${n} (of ${r.length})`),o)))}},t.parseSucceed=u;const l=(e,t,r,n,a)=>a;function c(){return l}function d(e,t){return function(r,n,a,i,o){return e(r,n,a,((e,n)=>t(a,e)(r,n,a,i,o)),o)}}function g(e,t){return function(r,n,a,i,o){return e(r,n,a,((e,r)=>i(t(a,e),r)),o)}}function m(e,t){return function(r,n,a,i,o){return e(r,n,a,i,(()=>t(r,n,a,i,o)))}}function h(e,t){return function(r,n,a,i,o){const s=r[n];if(null==s)return o;const u=e(a,s);return null==u?o:i(u,n+t)}}function p(e,t,r){return function(i,o,s,u,l){let c=r,d=o;function g(){return e(i,d,s,m,h)}function m(e,r){if(r<=d){const e=(0,a.anonymize)(i),t=`calc.parse.reduce: internal error: no progress made at index ${d} on ${e}`;return(0,n.assertFalse)(t)}return c=t(s,e,c),d=r,g}function h(){return u(c,d)}return g}}function f(e,t){return p(e,(function(e,t,r){return r.push(t),r}),t)}function S(...e){if(0===e.length)return u([]);if(1===e.length)return g(e[0],((e,t)=>[t]));const t=e.length;return function(r,n,a,i,o){let s=n;const u=[];function l(){return e[u.length](r,s,a,c,o)}function c(e,r){return s=r,u.push(e),u.length<t?l:i(u,s)}return l}}function v(e){return g(e,((e,t)=>(0,o.safeConcat)([],t)))}t.parseFail=c,t.bind=d,t.apply=g,t.withState=function(e){return(t,r,n,a,i)=>e(n)(t,r,n,a,i)},t.any=function(...e){return 0===e.length?c():e.reduce(m)},t.opt=function(e,t){return function(r,n,a,i,o){return e(r,n,a,i,(()=>i(t,n)))}},t.succeeds=function(e){return function(t,r,n,a,i){return e(t,r,n,(()=>a(!0,r)),i)}},t.fails=function(e){return function(t,r,n,a,i){return e(t,r,n,i,(()=>a(!0,r)))}},t.take=function(e){return h(e,1)},t.peek=function(e){return h(e,0)},t.takePeek=function(e){return function(t,r,n,a,i){const o=t[r],s=t[r+1];if(null==o||null==s)return i;const u=e(n,o,s);return null==u?i:a(u,r+1)}},t.applyTake=function(e,t){return function(r,n,a,i,o){return e(r,n,a,((e,r)=>{const n=t(a,e);return null==n?o:i(n,r)}),o)}},t.reduce=p,t.many=function(e,t){return void 0===t?function(t,r,n,a,i){return f(e,[])(t,r,n,a,i)}:function(r,n,a,i,o){return e(r,n,a,((e,n)=>f(t,[e])(r,n,a,i,o)),(()=>i([],n)))}},t.many1=function(e,t=e){return d(e,((e,r)=>f(t,[r])))},t.tuple=S,t.left=function(e,t){return g(S(e,t),((e,[t])=>t))},t.right=function(e,t){return g(S(e,t),((e,[,t])=>t))},t.middle=function(e,t,r){return g(S(e,t,r),((e,[,t])=>t))},t.flatten=v,t.concat=function(...e){return v(S(...e))}},65976:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createParser=void 0;const n=r(74643),a=r(15287),i=r(28723),o=r(48792),s=r(18643),u=r(46061),l=n.__importStar(r(98539)),{codePointEqualsSign:c,codePointPlusSign:d,codePointMinusSign:g,codePointAtSign:m}=l,h={[c]:1,[d]:0,[g]:0,[m]:-1};function p(e,t,r,n){const o=t.config?.localeInfo??e.config.localeInfo,s=t.config?.refStyle??e.config.refStyle,l=e.config.mathpack,c=(0,a.tokenizeFormula)(o,l,s,t.originGridCell.value,r,n,t.syntaxFeatures),d=(0,i.runFormulaParser)(o,l,s,t.lexicalKind,t.originGridCell.value,t.contextNames,t.syntaxFeatures,c);return(0,u.success)(d)}t.createParser=function(e){return{parseFormula:(t,r,n)=>function(e,t,r,n=0){try{const a=n>=0&&n<r.length?h[r.charCodeAt(n)]:void 0;return null==a?(0,u.failure)((0,o.notFormulaString)("first character is not '=', '+', '-' or '@'")):a<0?(0,u.failure)((0,s.notImplemented)(["Lotus 1-2-3 syntax"])):p(e,t,r,n+a)}catch(e){return(0,u.failure)((0,u.javaScriptError)(e))}}(e,t,r,n),parseFormulaExpression:(t,r,n)=>function(e,t,r,n=0){try{return p(e,t,r,n)}catch(e){return(0,u.failure)((0,u.javaScriptError)(e))}}(e,t,r,n)}}},38758:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cellRefMustBeCellRefNode=t.withDelim=t.addSpan=t.addWhitespace=t.getSpan=t.getNodeSpan=t.makeState=t.ListSep=void 0;const n=r(70308),a=r(3085),i=r(66667),o=r(10741),s=r(81120);var u;!function(e){e[e.Union=1]="Union",e[e.Arg=2]="Arg"}(u||(t.ListSep=u={})),t.makeState=function(e,t,r,n,a){return{localeInfo:e,mathpack:t,refStyle:r,lexicalKind:n,origin:a,delim:{delimId:void 0,listSep:u.Union,stack:{[i.DelimId.Paren]:!1,[i.DelimId.Brace]:!1,[i.DelimId.Bracket]:!1}},cellRefMustBeCellRefNode:!1,label:1,spans:[]}},t.getNodeSpan=function(e,t){const r=e.spans[t.label];if(null==r){const e=`calc.parse.getNodeSpan: internal error: expected node to have a span; given ${(0,n.anonymize)(t)}`;(0,a.assertFalse)(e)}return r},t.getSpan=function(e,t){const r=e.spans[t];return(0,a.assertTrue)("calc.parse.getSpan: internal error: expected label to have a span",null!=r),r};const l=[];function c(e,t){const r="string"==typeof t?l:t.filter(s.isCommentToken);return["string"==typeof t?t:t.map((e=>e.chars)).join(""),r.length>0?r.map((t=>function(e,t){const r=d(e,t.start,t.start+t.chars.length,"","");return t.kind===i.TokenKind.SingleLineComment?(0,o.singleLineComment)(t.chars,r):(0,o.multiLineComment)(t.chars,t.isClosed,r)}(e,t))):void 0]}function d(e,t,r,n,a){const i=e.label;e.label+=1;const[s,u]=c(e,n),[l,d]=c(e,a);return e.spans[i]=(0,o.formulaSpan)(t,r,s,l,u,d),i}function g(e,t,r){return(n,a,i,o,s)=>{const u=e(i);return r(n,a,i,((e,r)=>(t(i,u),o(e,r))),(()=>(t(i,u),s)))}}t.addWhitespace=c,t.addSpan=d,t.withDelim=function({delimId:e,listSep:t},r){return g((r=>{const n=r.delim;return r.delim={delimId:e,listSep:t,stack:{...n.stack,[e]:!0}},n}),((e,t)=>e.delim=t),r)},t.cellRefMustBeCellRefNode=function(e){return g((e=>{const t=e.cellRefMustBeCellRefNode;return e.cellRefMustBeCellRefNode=!0,t}),((e,t)=>e.cellRefMustBeCellRefNode=t),e)}},48792:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.notFormulaString=t.ReasonKind=t.parseLocals=t.createParseGlobals=void 0;const n=r(18643),a=r(46061);var i;t.createParseGlobals=function(e){return{config:e}},t.parseLocals=function(e,t,r,n,i){return{config:r??void 0,lexicalKind:e,originGridCell:(0,a.success)(t),contextNames:n,syntaxFeatures:i}},function(e){e.NotFormulaString="NotFormulaString"}(i||(i={})),t.ReasonKind={...n.ReasonKind,...i},t.notFormulaString=function(e){return{kind:t.ReasonKind.NotFormulaString,message:e}}},66667:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rangeOperatorToken=t.geOperatorToken=t.leOperatorToken=t.neOperatorToken=t.gtOperatorToken=t.ltOperatorToken=t.eqOperatorToken=t.concatOperatorToken=t.percentOperatorToken=t.powOperatorToken=t.divOperatorToken=t.mulOperatorToken=t.subOperatorToken=t.addOperatorToken=t.operatorToken=t.identOrBooleanToken=t.literalToken=t.cellRefR1C1Token=t.cellRefA1Token=t.specialRefToken=t.assignSepToken=t.dotSepToken=t.qualSepToken=t.rowSepToken=t.colSepToken=t.listSepToken=t.rightSQuoteToken=t.rightBraceToken=t.rightBracketToken=t.rightParenToken=t.leftSQuoteToken=t.leftBraceToken=t.leftBracketToken=t.leftParenToken=t.identToken=t.multiLineCommentToken=t.singleLineCommentToken=t.escapeToken=t.unexpectedToken=t.spacesToken=t.endToken=t.badErrorOper=t.isBadErrorOper=t.badNumberOper=t.isNumberLikeOper=t.isBadNumberOper=t.TokenOperKind=t.SepId=t.DelimId=t.TokenKind=void 0,t.appendToken=t.poundOperatorToken=t.atOperatorToken=void 0;const n=r(74643),a=r(261),i=r(10741),o=r(84538),s=r(46090),u=r(86433),l=n.__importStar(r(98539)),c=r(68112),{codePointAsterisk:d,codePointMinusSign:g,codePointPlusSign:m,codePointSlash:h,codePointSpace:p}=l;var f,S,v,F;function y(e){return e.kind===F.BadNumber||e.kind===s.OperKind.Number}function C(e,t,r,n){return{kind:e,start:t,chars:r,isIdentContinue:n}}function A(e,t,r,n){return{kind:e,start:t,chars:r,isIdentContinue:!1,value:n}}function E(e,t,r,n,a,i,o){return{kind:f.CellRef,start:e,chars:t,isIdentContinue:r,row:n,col:a,refStyle:i,isBadLocale:o}}function b(e,t,r,n=!0){const a=r.kind===s.OperKind.Boolean||y(r)&&function(e){for(const t of(0,u.codePointIterator)(e))if(t===m||t===g||t===d||t===p||t===h)return!1;return!0}(t);return{kind:f.Literal,start:e,chars:t,isIdentContinue:a,oper:r,hasRight:n}}function R(e,t,r){return{kind:f.Operator,start:e,chars:t,isIdentContinue:!1,value:r}}function T(e){const t=a.operatorStrings[e];if(null==t)throw new Error(`operatorTokenMaker: invalid operator ${e}`);return r=>R(r,t,e)}!function(e){e[e.End=1]="End",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Sep=4]="Sep",e[e.Operator=5]="Operator",e[e.Spaces=6]="Spaces",e[e.Ident=7]="Ident",e[e.CellRef=8]="CellRef",e[e.Literal=9]="Literal",e[e.SpecialRef=10]="SpecialRef",e[e.Unexpected=11]="Unexpected",e[e.Escape=12]="Escape",e[e.SingleLineComment=13]="SingleLineComment",e[e.MultiLineComment=14]="MultiLineComment"}(f||(t.TokenKind=f={})),function(e){e[e.Paren=1]="Paren",e[e.Bracket=2]="Bracket",e[e.Brace=3]="Brace",e[e.SQuote=4]="SQuote"}(S||(t.DelimId=S={})),function(e){e[e.List=1]="List",e[e.Row=2]="Row",e[e.Col=3]="Col",e[e.Qual=4]="Qual",e[e.Dot=5]="Dot",e[e.Assign=6]="Assign"}(v||(t.SepId=v={})),function(e){e.BadNumber="BadNumber",e.BadError="BadError"}(F||(t.TokenOperKind=F={})),t.isBadNumberOper=function(e){return e.kind===F.BadNumber},t.isNumberLikeOper=y,t.badNumberOper={kind:F.BadNumber},t.isBadErrorOper=function(e){return e.kind===F.BadError},t.badErrorOper={kind:F.BadError},t.endToken=e=>C(f.End,e,"",!1),t.spacesToken=(e,t)=>C(f.Spaces,e,t,!1),t.unexpectedToken=(e,t)=>C(f.Unexpected,e,t,!1),t.escapeToken=(e,t)=>C(f.Escape,e,t,!1),t.singleLineCommentToken=(e,t)=>C(f.SingleLineComment,e,t,!1),t.multiLineCommentToken=(e,t,r)=>({kind:f.MultiLineComment,start:e,chars:t,isIdentContinue:!1,isClosed:r}),t.identToken=(e,t)=>C(f.Ident,e,t,!0),t.leftParenToken=e=>A(f.Left,e,"(",S.Paren),t.leftBracketToken=(e,t)=>A(f.Left,e,t,S.Bracket),t.leftBraceToken=(e,t)=>A(f.Left,e,t,S.Brace),t.leftSQuoteToken=e=>A(f.Left,e,"'",S.SQuote),t.rightParenToken=e=>A(f.Right,e,")",S.Paren),t.rightBracketToken=(e,t)=>A(f.Right,e,t,S.Bracket),t.rightBraceToken=(e,t)=>A(f.Right,e,t,S.Brace),t.rightSQuoteToken=e=>A(f.Right,e,"'",S.SQuote),t.listSepToken=(e,t)=>A(f.Sep,e,t,v.List),t.colSepToken=(e,t)=>A(f.Sep,e,t,v.Col),t.rowSepToken=(e,t)=>A(f.Sep,e,t,v.Row),t.qualSepToken=e=>A(f.Sep,e,"!",v.Qual),t.dotSepToken=e=>A(f.Sep,e,".",v.Dot),t.assignSepToken=e=>A(f.Sep,e,":=",v.Assign),t.specialRefToken=(e,t,r)=>A(f.SpecialRef,e,t,r),t.cellRefA1Token=function(e,t,r,n){return E(e,t,(null==r||"object"==typeof r&&r.kind===i.PosKind.Rel)&&(null==n||"object"==typeof n&&n.kind===i.PosKind.Rel),r,n,i.RefStyle.A1,!1)},t.cellRefR1C1Token=function(e,t,r,n,a=!1){return E(e,t,!(r!==c.SpecialPos.RCNoNum&&null!=r&&r.kind!==i.PosKind.Abs||n!==c.SpecialPos.RCNoNum&&null!=n&&n.kind!==i.PosKind.Abs),r,n,i.RefStyle.R1C1,a)},t.literalToken=b,t.identOrBooleanToken=function(e,r,n){return 0===e.stringCompareCI(e.falseName,n)?b(r,n,o.falseOper):0===e.stringCompareCI(e.trueName,n)?b(r,n,o.trueOper):(0,t.identToken)(r,n)},t.operatorToken=R,t.addOperatorToken=T(a.OperatorId.Add),t.subOperatorToken=T(a.OperatorId.Sub),t.mulOperatorToken=T(a.OperatorId.Mul),t.divOperatorToken=T(a.OperatorId.Div),t.powOperatorToken=T(a.OperatorId.Pow),t.percentOperatorToken=T(a.OperatorId.Percent),t.concatOperatorToken=T(a.OperatorId.Concat),t.eqOperatorToken=T(a.OperatorId.Eq),t.ltOperatorToken=T(a.OperatorId.Lt),t.gtOperatorToken=T(a.OperatorId.Gt),t.neOperatorToken=T(a.OperatorId.Ne),t.leOperatorToken=T(a.OperatorId.Le),t.geOperatorToken=T(a.OperatorId.Ge),t.rangeOperatorToken=T(a.OperatorId.Range),t.atOperatorToken=T(a.OperatorId.At),t.poundOperatorToken=T(a.OperatorId.Pound),t.appendToken=function(e,t,r){return r.push(t),t.start+e}},15287:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tokenizeFormula=void 0;const n=r(74643),a=r(3085),i=r(66667),o=r(84538),s=r(68112),u=r(47445),l=r(6791),c=r(10741),d=r(30912),g=r(86433),m=n.__importStar(r(98539)),h=r(76076),p=r(60364),f=r(81120),{codePointAsterisk:S,codePointAtSign:v,codePointColon:F,codePointDoubleQuote:y,codePointExclamationMark:C,codePointHash:A,codePointLeftParen:E,codePointQuestionMark:b,codePointRightParen:R,codePointSingleQuote:T,codePointFullStop:k,codePointDigitZero:N,codePointSlash:I,codePointMinusSign:O,codePointSpace:_,codePointInvertedExclamationMark:P,codePointInvertedQuestionMark:M,codePointLeftSingleQuotationMark:D,codePointRightSingleQuotationMark:w}=m;let L;function x(e){if(!L){L=(0,l.makeStringMap)();for(const e of Object.getOwnPropertyNames(K))L[e.charCodeAt(0)]=!0;for(const e of Object.getOwnPropertyNames(W))L[e.charCodeAt(0)]=!0}return!0===L[e]}const K={"+":i.addOperatorToken,"-":i.subOperatorToken,"*":i.mulOperatorToken,"/":i.divOperatorToken,"^":i.powOperatorToken,"%":i.percentOperatorToken,"&":i.concatOperatorToken,"=":i.eqOperatorToken,"<":i.ltOperatorToken,">":i.gtOperatorToken,":":i.rangeOperatorToken,".":i.dotSepToken,"@":i.atOperatorToken,"#":i.poundOperatorToken},W={"<>":i.neOperatorToken,"<=":i.leOperatorToken,">=":i.geOperatorToken};function U(e,t,r){if(t<e.length-1){const n=W[e.substring(t,t+2)];if(null!=n)return(0,i.appendToken)(2,n(t),r)}const n=K[e.charAt(t)];return null!=n?(0,i.appendToken)(1,n(t),r):(0,a.assertFalse)("calc.parse.tokenizeOperator: internal error: expected operator")}function G(e,t,r,n,a){const o=(0,u.parseNumberLiteral)(e,t,r,n,!1,!1,!1);if(void 0===o)return;const{value:s,i:l}=o,c=r.substring(n,l);return(0,i.appendToken)(l-n,(0,i.literalToken)(n,c,s??i.badNumberOper,!0),a),l}const B=(e,t)=>e.charCodeAt(t)!==y,V=(e,t)=>e.charCodeAt(t)===y;function j(e,t,r){const[n,a]=(0,d.scanEscapedWhile)(e,t+1,B,'"',V),s=e.substring(t,a+1);return a<e.length?(0,i.appendToken)(a+1-t,(0,i.literalToken)(t,s,(0,o.stringOper)(n),!0),r):(0,i.appendToken)(a-t,(0,i.literalToken)(t,s,(0,o.stringOper)(n),!1),r)}function H(e,t,r,n){for(let a=1;a<e.errorNames.length;a+=1){const s=e.errorNames[a];if(null==s)continue;const u=t.substring(r,r+s.length);if(0===e.stringCompareCI(s,u))return(0,i.appendToken)(s.length,(0,i.literalToken)(r,u,(0,o.errorOper)(a)),n)}let a=r+1,s=!1;for(;a<t.length;){const n=(0,g.stringCodePointAt)(t,a);if(a!==r+1||n!==P&&n!==M)if(!(a>r+1)||n!==I&&n!==O&&n!==_||s)if(a>r+1&&n===k)a+=1;else{if(a>r+1&&n===N){a+=1,a<t.length&&t.charCodeAt(a)===C&&(a+=1);break}if(n===C||n===b){a!==r+1&&(a+=1);break}if(!e.isIdentContinue(n)||e.isNumeral(n)){if(n!==D&&n!==w)break;a+=1}else a+=(0,g.numCodeUnits)(n)}else s=!0,a+=1;else a+=1}for(;a>r+1&&t.charCodeAt(a-1)===_;)--a;if(a>r+1){const e=t.substring(r,a);return(0,i.appendToken)(a-r,(0,i.literalToken)(r,e,i.badErrorOper),n)}}function q(e,t,r,n){for(let a=1;a<e.specialRefNames.length;a+=1){const o=e.specialRefNames[a];if(null==o)continue;const s=t.substring(r,r+o.length);if(0===e.stringCompareCI(o,s))return(0,i.appendToken)(o.length,(0,i.specialRefToken)(r,s,a),n)}}function $(e,t,r){const n=t.charCodeAt(r);return!((0,u.isSpace)(n)||n===T||n===A||n===F||n===v||(0,h.stringStartsWith)(t,e.listSeparator,r)||(0,h.stringStartsWith)(t,e.leftBracket,r)||(0,h.stringStartsWith)(t,e.rightBracket,r))}const z=(e,t)=>(0,u.isSpace)((0,g.stringCodePointAt)(e,t)),Q=(e,t)=>!(0,u.isLineBreak)((0,g.stringCodePointAt)(e,t)),Y=(e,t)=>!(t+1<e.length&&e.charCodeAt(t)===S&&e.charCodeAt(t+1)===I);function J(e,t,r,n){let a=r,o=0;const s=(t,r)=>$(e,t,r),l=(t,r)=>!$(e,t,r),c=(0,d.makeProgressAsserter)("calc.parse.tokenizeBracketedRef",a);for(;a<t.length;){c(a);const r=(0,g.stringCodePointAt)(t,a);if(n.length>0&&n[n.length-1].kind===i.TokenKind.Escape&&l(t,a))a=(0,i.appendToken)((0,g.numCodeUnits)(r),(0,i.identToken)(a,(0,g.stringFromCodePoint)(r)),n);else if(r!==v){if(r===A){const r=q(e,t,a,n);if(null!=r){a=r;continue}}if(r!==T)if((0,h.stringStartsWith)(t,e.rightBracket,a)){if(a=(0,i.appendToken)(e.rightBracket.length,(0,i.rightBracketToken)(a,e.rightBracket),n),o-=1,0===o)return a}else if(s(t,a)){const[e,r]=(0,d.scanWhile)(t,a,s);a=(0,i.appendToken)(r-a,(0,i.identToken)(a,e),n)}else if((0,u.isSpace)(r)){const[e,r]=(0,d.scanWhile)(t,a,z);a=(0,i.appendToken)(r-a,(0,i.spacesToken)(a,e),n)}else r!==F?(0,h.stringStartsWith)(t,e.listSeparator,a)?a=(0,i.appendToken)(e.listSeparator.length,(0,i.listSepToken)(a,e.listSeparator),n):(0,h.stringStartsWith)(t,e.leftBracket,a)&&o<2?(a=(0,i.appendToken)(e.leftBracket.length,(0,i.leftBracketToken)(a,e.leftBracket),n),o+=1):a=(0,i.appendToken)((0,g.numCodeUnits)(r),(0,i.unexpectedToken)(a,(0,g.stringFromCodePoint)(r)),n):a=(0,i.appendToken)(1,(0,i.rangeOperatorToken)(a),n);else a=(0,i.appendToken)(1,(0,i.escapeToken)(a,"'"),n)}else a=(0,i.appendToken)(1,(0,i.atOperatorToken)(a),n)}return a}function X(e,t,r,n){let a=(0,i.appendToken)(1,(0,i.leftSQuoteToken)(r),n);const o=(t,r)=>function(e,t,r){const n=t.charCodeAt(r);return n!==T&&n!==F&&n!==S&&n!==b&&!(0,h.stringStartsWith)(t,e.leftBracket,r)&&!(0,h.stringStartsWith)(t,e.rightBracket,r)}(e,t,r),s=(e,t)=>e.charCodeAt(t)===T,u=(0,d.makeProgressAsserter)("calc.parse.tokenizeQuotedQualifier",a);for(;a<t.length;){u(a);const r=(0,g.stringCodePointAt)(t,a);if(r===T&&!(a+1<t.length&&t.charCodeAt(a+1)===T))return(0,i.appendToken)(1,(0,i.rightSQuoteToken)(a),n);if(r!==F)if((0,h.stringStartsWith)(t,e.leftBracket,a))a=(0,i.appendToken)(e.leftBracket.length,(0,i.leftBracketToken)(a,e.leftBracket),n);else if((0,h.stringStartsWith)(t,e.rightBracket,a))a=(0,i.appendToken)(e.rightBracket.length,(0,i.rightBracketToken)(a,e.rightBracket),n);else if((0,d.getEscapedSkip)(t,a,o,"'",s)>0){const[e,r]=(0,d.scanEscapedWhile)(t,a,o,"'",s);a=(0,i.appendToken)(r-a,(0,i.identToken)(a,e),n)}else a=(0,i.appendToken)((0,g.numCodeUnits)(r),(0,i.unexpectedToken)(a,(0,g.stringFromCodePoint)(r)),n);else a=(0,i.appendToken)(1,(0,i.rangeOperatorToken)(a),n)}return a}function Z(e,t,r,n,a,o){const u=(0,s.parseCellRef)(e,t,r,n,a);if(null!=u){const e=u.i,t=n.substring(e,a),r=u.refStyle===c.RefStyle.A1?(0,i.cellRefA1Token)(a,t,u.row,u.col):(0,i.cellRefR1C1Token)(a,t,u.row,u.col,u.enLocale);return(0,i.appendToken)(e-a,r,o)}}function ee(e,t,r,n){let a=n.length-1,o=n[a];if(null==o)return!0;if(o.kind===i.TokenKind.Sep&&o.value===i.SepId.Dot)return!1;if((0,h.stringStartsWith)(t,e.decimalSeparator,r)){for(;null!=o&&(0,f.isWhitespaceToken)(o);)o=n[--a];return null==o||o.kind!==i.TokenKind.Ident&&o.kind!==i.TokenKind.CellRef&&o.kind!==i.TokenKind.Right&&(o.kind!==i.TokenKind.Literal||(0,i.isNumberLikeOper)(o.oper))}return e.isNumeral((0,g.stringCodePointAt)(t,r))}function te(e,t,r,n){let a=e[t],i=t+1;for(;i<e.length;i+=1){const t=e[i];if(t.kind!==r)break;a=n(a,t)}return[a,i]}t.tokenizeFormula=function(e,t,r,n,o,s,l){const[m,f]=function(e,t,r,n,o,s,l){const m=[],f=[];let v=s;const F=!0===l?.[c.SyntaxFeature.Comments],b=!0===l?.[c.SyntaxFeature.Statements],k=!(0,h.stringStartsWith)(e.statementSeparator,e.columnSeparator)&&!(0,h.stringStartsWith)(e.statementSeparator,e.rowSeparator),N=!(0,h.stringStartsWith)(e.statementSeparator,e.listSeparator)&&!(0,h.stringStartsWith)(e.statementSeparator,e.decimalSeparator),O=(0,d.makeProgressAsserter)("calc.parse.tokenize",v);for(;v<o.length;){O(v);const s=Z(e,r,n,o,v,m);if(null!=s){v=s;continue}const l=(0,g.stringCodePointAt)(o,v),c=f.length>0&&f[f.length-1].delim===i.DelimId.Brace;if(ee(e,o,v,m)){const r=G(e,t,o,v,m);if(null!=r){v=r;continue}}if(l!==y)if(!e.isIdentContinue(l)||(0,h.stringStartsWith)(o,e.listSeparator,v)||c&&(0,h.stringStartsWith)(o,e.columnSeparator,v)||c&&(0,h.stringStartsWith)(o,e.rowSeparator,v))if(l!==A)if((0,u.isSpace)(l)){const[e,t]=(0,d.scanWhile)(o,v,z);v=(0,i.appendToken)(t-v,(0,i.spacesToken)(v,e),m)}else if(l!==E)if(l!==R)if((0,h.stringStartsWith)(o,e.leftBrace,v))f.push({delim:i.DelimId.Brace,lastParen:f.length>0?f[f.length-1].lastParen:void 0,lastBrace:f.length}),v=(0,i.appendToken)(e.leftBrace.length,(0,i.leftBraceToken)(v,e.leftBrace),m);else if((0,h.stringStartsWith)(o,e.rightBrace,v)){const t=f.length>0?f[f.length-1].lastBrace:void 0;void 0!==t&&(f.length=t),v=(0,i.appendToken)(e.rightBrace.length,(0,i.rightBraceToken)(v,e.rightBrace),m)}else if((0,h.stringStartsWith)(o,e.leftBracket,v))v=J(e,o,v,m);else if((0,h.stringStartsWith)(o,e.rightBracket,v))v=(0,i.appendToken)(e.rightBracket.length,(0,i.rightBracketToken)(v,e.rightBracket),m);else{if(c){if(b&&k&&(0,h.stringStartsWith)(o,e.statementSeparator,v))break;if((0,h.stringStartsWith)(o,e.columnSeparator,v)){v=(0,i.appendToken)(e.columnSeparator.length,(0,i.colSepToken)(v,e.columnSeparator),m);continue}if((0,h.stringStartsWith)(o,e.rowSeparator,v)){v=(0,i.appendToken)(e.rowSeparator.length,(0,i.rowSepToken)(v,e.rowSeparator),m);continue}}if(b&&(0,h.stringStartsWith)(o,e.statementSeparator,v)&&(N||0===f.length))break;if((0,h.stringStartsWith)(o,e.listSeparator,v))v=(0,i.appendToken)(e.listSeparator.length,(0,i.listSepToken)(v,e.listSeparator),m);else if(l!==C)if(l!==T){if(l===I&&v+1<o.length&&F){const e=o.charCodeAt(v+1);if(e===I){const[e,t]=(0,d.scanWhile)(o,v,Q);v=(0,i.appendToken)(t-v,(0,i.singleLineCommentToken)(v,e),m);continue}if(e===S){let[e,t]=(0,d.scanWhile)(o,v+2,Y);const r=(0,h.stringStartsWith)(o,"*/",t);(0,a.assertTrue)("calc.parse.tokenize: /**/",r||t===o.length),t+=r?2:0,e="/*"+e+(r?"*/":""),v=(0,i.appendToken)(t-v,(0,i.multiLineCommentToken)(v,e,r),m);continue}}if(x(l)){if((0,h.stringStartsWith)(o,":=",v)&&(0,p.isFeatureEnabled)(p.FeatureName.CalcLambdaDefaultParameters)){v=(0,i.appendToken)(2,(0,i.assignSepToken)(v),m);continue}v=U(o,v,m)}else v=(0,i.appendToken)((0,g.numCodeUnits)(l),(0,i.unexpectedToken)(v,(0,g.stringFromCodePoint)(l)),m)}else v=X(e,o,v,m);else v=(0,i.appendToken)(1,(0,i.qualSepToken)(v),m)}else{const e=f.length>0?f[f.length-1].lastParen:void 0;void 0!==e&&(f.length=e),v=(0,i.appendToken)(1,(0,i.rightParenToken)(v),m)}else f.push({delim:i.DelimId.Paren,lastParen:f.length,lastBrace:f.length>0?f[f.length-1].lastBrace:void 0}),v=(0,i.appendToken)(1,(0,i.leftParenToken)(v),m);else{const t=H(e,o,v,m);if(null!=t){v=t;continue}v=U(o,v,m)}else{const[t,r]=(0,d.scanWhile)(o,v,((t,r)=>e.isIdentContinue((0,g.stringCodePointAt)(t,r))));v=(0,i.appendToken)(r-v,(0,i.identOrBooleanToken)(e,v,t),m)}else v=j(o,v,m)}return[m,v]}(e,t,r,n,o,s,l),v=[];let F=0;for(;F<m.length;){const e=m[F];if(e.kind!==i.TokenKind.Unexpected)v.push(e),F+=1;else{const[e,t]=te(m,F,i.TokenKind.Unexpected,((e,t)=>{const r=e,n=t;return(0,i.unexpectedToken)(r.start,r.chars+n.chars)}));v.push(e),F=t}}return v.push((0,i.endToken)(f)),v}},30912:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scanEscapedWhile=t.getEscapedSkip=t.scanWhile=t.makeProgressAsserter=void 0;const n=r(3085),a=r(86433),i=r(76076);function o(e,t,r,n,a){return r(e,t)?1:(0,i.stringStartsWith)(e,n,t)&&t+n.length<e.length&&a(e,t+n.length)?2:0}t.makeProgressAsserter=function(e,t){let r=t-1;return function(t){if(t<=r){const r=`${e}: internal error: no progress made at index ${t}`;return(0,n.assertFalse)(r)}r=t}},t.scanWhile=function(e,t,r){let n=t;for(;n<e.length&&r(e,n);)n+=(0,a.numCodeUnits)((0,a.stringCodePointAt)(e,n));return[e.substring(t,n),n]},t.getEscapedSkip=o,t.scanEscapedWhile=function(e,t,r,n,i){const s=[];let u=t,l=t;for(;l<e.length;){const t=o(e,l,r,n,i);if(0===t)break;2===t&&(u!==l&&s.push(e.substring(u,l)),u=l+n.length,l+=n.length),l+=(0,a.numCodeUnits)((0,a.stringCodePointAt)(e,l))}return u!==l&&s.push(e.substring(u,l)),[s.join(""),l]}},68954:function(e,t,r){"use strict";const n=r(55174);e.exports=n.analyzeService},97729:function(e,t,r){"use strict";const n=r(55174);e.exports=n.analyzeServiceTypes},51123:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createAnalyzeGlobals=t.staticPrecedents=t.summarizeFormulaDiagnostics=t.diagnostics=t.analyzeLocalsName=t.analyzeLocalsGrid=t.createAnalyzer=void 0;var n=r(68954);Object.defineProperty(t,"createAnalyzer",{enumerable:!0,get:function(){return n.createAnalyzer}});var a=r(97729);Object.defineProperty(t,"analyzeLocalsGrid",{enumerable:!0,get:function(){return a.analyzeLocalsGrid}}),Object.defineProperty(t,"analyzeLocalsName",{enumerable:!0,get:function(){return a.analyzeLocalsName}}),Object.defineProperty(t,"diagnostics",{enumerable:!0,get:function(){return a.diagnostics}}),Object.defineProperty(t,"summarizeFormulaDiagnostics",{enumerable:!0,get:function(){return a.summarizeFormulaDiagnostics}}),Object.defineProperty(t,"staticPrecedents",{enumerable:!0,get:function(){return a.staticPrecedents}}),Object.defineProperty(t,"createAnalyzeGlobals",{enumerable:!0,get:function(){return a.createAnalyzeGlobals}})},70052:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.evalFormulaFormatToUnion=t.cellFormatToInferredFormat=t.namedObjectToNamedObjectData=t.namedObjectDataToNamedObject=t.readOperToCellValue=t.cellValueToReadOper=t.createExcludeCellSet=t.gridCellToCellLocation=t.sheetGridRangeToLocation=t.sheetGridRangeToHiddenCols=t.sheetGridRangeToHiddenRows=t.sheetGridRangeToCellSet=t.unusedCellsUpdateToUsedRange=t.sheetCellLocationToGridCell=t.sheetRangeLocationToGridRange=t.localeInfoFromData=t.createLocaleInfo=void 0;const n=r(36159),a=r(57993),i=r(60140),o=r(91304),s=r(57786),u=r(55),l=r(41739),c=r(96978),d=r(92587),g=r(26795),m=r(89817),h=r(73701),p=r(94973),f=r(97207),S=r(83970),v=r(12973);function F(e,t){const r=(0,n.makeStringCompareCI)("en-US"),{getWorksheetFuncId:i,getWorksheetFuncName:o}=function(e,t,r){const n=(0,a.getEnglishWorksheetFuncIdToName)().slice();return(0,p.filterCheck)(t,p.chWorksheetFunctionName,r,"localeData.worksheetFunctionNames").forEach((e=>n[e.functionId]=e.functionName)),(0,a.createWorksheetFuncNameCallbacks)(e,n)}(r,e.worksheetFunctionNames,t),s=(u=e.thousandsData,(0,n.isNone)(u)?e=>e>0&&e%3==0:(0,a.createIsThousandsPositionCallback)(u));var u;const l=function(e,t){const r=a.englishErrorNames.slice();return(0,p.filterCheck)(e,p.chErrorTypeName,t,"localeData.errorTypeNames").forEach((e=>r[e.errorType]=e.errorName)),r}(e.errorTypeNames,t),{lcid:c}=e,d=c===a.LCID.Thailand,g=c===a.LCID.Korea,m=c===a.LCID.Japan,h=c===a.LCID.ChinaT||c===a.LCID.HongKong,f=c===a.LCID.China,S=g||m||f||h,v=c===a.LCID.Hindi||c===a.LCID.Tamil,F=c===a.LCID.Thailand||c===a.LCID.Vietnam||v,y=(c&a.LCID.LANG)==(a.LCID.Hebrew&a.LCID.LANG)||(c&a.LCID.LANG)==(a.LCID.Arabic&a.LCID.LANG)||c===a.LCID.Syriac||F,C=";"===e.listSeparator||";"===e.decimalSeparator?";;":";";return{...e,cultureTag:{primary:e.cultureTagPrimary,userDefault:e.cultureTagUserDefault,instLang:e.cultureTagInstLang,userCurrent:e.cultureTagUserCurrent},leftBracket:"[",rightBracket:"]",rcLeftBracket:e.leftBracket,rcRightBracket:e.rightBracket,getWorksheetFuncId:i,getWorksheetFuncName:o,isNumeral:a.isNumeral,getOrdinal:a.getOrdinal,getNumberShape:a.getNumberShape,isThousandsPosition:s,isIdentStart:a.isIdentStart,isIdentContinue:a.isIdentContinue,stringCompareCI:r,errorNames:l,statementSeparator:C,isThai:d,isEastAsia:S,isKorea:g,isJapan:m,isChinaT:h,isChinaS:f,isComplexScript:y}}function y(e,t){return(0,n.isNone)(t)?{index:e,length:1}:{index:e,length:(0,n.fastAbs)(t-e)+1}}function C(e,t){const{index:r,length:n}=y(t.row,t.lastRow),{index:a,length:o}=y(t.column,t.lastColumn);return(0,i.sheetGridRange)((0,i.sheetIndex)(e,t.sheetId),(0,i.gridRange)(r,a,n,o))}function A(e){return(0,d.isSheetGridCell)(e)?(0,o.sheetRangeLocation)(e.sheet.index,e.range.row,e.range.col):(0,o.sheetRangeLocation)(e.sheet.index,e.range.row,e.range.col,e.range.row+e.range.rows-1,e.range.col+e.range.cols-1)}t.createLocaleInfo=F,t.localeInfoFromData=function(e){return F(e,{})},t.sheetRangeLocationToGridRange=C,t.sheetCellLocationToGridCell=function(e,t){const{row:r,column:n}=t;return(0,i.sheetGridCell)((0,i.sheetIndex)(e,t.sheetId),(0,i.gridCell)(r,n))},t.unusedCellsUpdateToUsedRange=function(e,t){const{sheetId:r,usedRange:a}=t;return(0,n.isDefined)(a)?C(e,{sheetId:r,...a}):(0,l.sheetUsedRange)((0,i.sheetIndex)(e,r),u.emptyUsedRange)},t.sheetGridRangeToCellSet=function({sheet:e,range:t},r,n){const a=function(e,t,r){const n=(0,m.createFromProduct)({row:t}),a=(0,m.createFromProduct)({col:r}),i=(0,m.unionProduct)(n,a);return(0,m.exceptProduct)((0,s.createCellSetFromRange)(e),i)}(t,r,n);return{sheet:e,set:a}},t.sheetGridRangeToHiddenRows=function({sheet:e,range:t},r){return{sheet:e,range:t,hidden:r}},t.sheetGridRangeToHiddenCols=function({sheet:e,range:t},r){return{sheet:e,range:t,hidden:r}},t.sheetGridRangeToLocation=A,t.gridCellToCellLocation=function({row:e,col:t}){return{row:e,column:t}},t.createExcludeCellSet=function(e,t,r,a){let i=g.empty;if((0,n.isNone)(a))return i;for(let o=0;o<a.length;o+=1){const s=a[o];if(e<=s&&s<e+t){let e=1;for(;o+e<a.length&&a[o+e]===s+e;)e+=1;o+=e-1,i=(0,g.union)(i,r((0,n.pair)(s,s+e)))}}return i},t.cellValueToReadOper=function(e,t){switch(typeof t){case"string":return(0,c.stringOper)(t);case"boolean":return(0,c.booleanOper)(t);case"number":return e.fromNumber(t)}switch(t.kind){case"Blank":return c.blankOper;case"Error":return(0,c.errorOper)(t.type);default:return}},t.readOperToCellValue=function(e,t){switch(t.kind){case S.OperKind.String:case S.OperKind.Boolean:return t.value;case S.OperKind.Number:return e.toNumber(t);case S.OperKind.Error:return(0,o.errorValue)(t.type);case S.OperKind.Blank:return o.blankValue;default:return}},t.namedObjectDataToNamedObject=function(e,t,r,a){if(!(0,n.isNone)(a))switch(a.kind){case"NamedValue":switch(typeof a.value){case"string":return(0,f.namedValue)((0,c.stringOper)(a.value));case"boolean":return(0,f.namedValue)((0,c.booleanOper)(a.value));case"number":return(0,f.namedValue)(e.fromNumber(a.value))}return"Error"===a.value.kind?(0,f.namedValue)((0,c.errorOper)(a.value.type)):(0,h.assertNever)("calc.calc.namedObjectDataToNamedObject: NamedValue",a.value.kind);case"NamedFormula":return(0,f.namedFormula)(a.formulaBarText);case"NamedRange":{const e=C(r,a.range);return(0,f.namedRange)((0,c.range3DOper)(e.sheet,e.range))}case"NamedTable":{const e=C(r,a.range);return(0,f.namedTable)(e,a.hasHeadersRow,a.hasTotalsRow,a.columns,t)}case"NamedFailure":return(0,f.namedFailure)(a.failureReason,(0,n.isNone)(a.objectKind)?void 0:a.objectKind);default:return(0,h.assertNever)("calc.calc.namedObjectDataToNamedObject: kind",a)}},t.namedObjectToNamedObjectData=function(e,t,r){if(r)switch(r.kind){case"NamedValue":switch(r.value.kind){case S.OperKind.Number:return(0,o.namedValueData)(e.toNumber(r.value));case S.OperKind.String:case S.OperKind.Boolean:return(0,o.namedValueData)(r.value.value);case S.OperKind.Error:return(0,o.namedValueData)(r.value.type);default:return}case"NamedFormula":return(0,o.namedFormulaData)(r.fmla);case"NamedRange":{const e=(0,i.sheetGridRange)((0,i.sheetIndex)(t,r.value.sheets.index),r.value.ranges[0]);return(0,o.namedRangeData)(A(e))}case"NamedTable":{const e=r.specialRefRanges[v.SpecialRefId.Data],t=[];return r.columnIndexes.forEach(((e,r)=>(t.push((0,o.columnData)(e,r)),!0))),(0,o.namedTableData)(A(e),r.hasHeadersRow,r.hasTotalsRow,t)}case"NamedFailure":return r;default:return(0,h.assertNever)("calc.calc.namedObjectToNamedObjectData: kind",r)}},t.cellFormatToInferredFormat=function(e){if(void 0!==e)return(0,l.isOutputFormatUnavailable)(e.format)?(0,o.inferredFormat)({kind:e.format.kind},e.valueType,e.decimals):(0,o.inferredFormat)(e.format,e.valueType,e.decimals)},t.evalFormulaFormatToUnion=function(e){if(null!=e)switch(e.kind){case"Origin":return{kind:l.SpecialFormat.Origin};case"Iformat":return(0,h.assertTrue)("calc.calc.evalFormulaFormatToUnion: iformat","number"==typeof e.iformat),e.iformat;case"Known":return(0,h.assertTrue)("calc.calc.evalFormulaFormatToUnion: knownFormat","number"==typeof e.knownFormat),{kind:l.SpecialFormat.Known,knownFormat:e.knownFormat};case"Inferred":return{kind:l.SpecialFormat.Inferred};case"Aggregate":return{kind:l.SpecialFormat.Aggregate};default:return(0,h.assertNever)("calc.calc.evalFormulaFormatToUnion: kind",e.kind)}}},5579:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExceLintExperiment=void 0;const n=r(60140),a=r(21625),i=r(91092),o=r(62020),s=r(69820),u=r(73701),l=r(57993),c=r(1765),d=r(12973);t.ExceLintExperiment=class{get done(){return!0}setContext({documents:e}){try{u.ulsLogger.ULS.traceTag(578588694,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"calc.calc.RecalcService: ExceLint experiment setContext started");const t=function(e){const t=e.getServerDocument(),r=[];for(const a of e.getServerAvailableCells()){let s="UndefinedSheet";if(void 0!==t){const r=e.getSheetName(t,a.sheetIdx.index);r.kind===c.ResultKind.Success&&(s=r.value)}const u=e.getServerUsedRange(a.sheetIdx);if(u.kind===c.ResultKind.Failure||void 0===u.value)continue;const l=u.value.sheet,g={...u.value.range};g.cols=Math.min(g.cols,75),g.rows=Math.min(g.rows,1e3);const m=[],h=[],p=[];let f=0;for(let t=g.row,r=g.row+g.rows-1;t<=r;t+=1){const r=[],a=[],o=[];for(let s=g.col,u=g.col+g.cols-1;s<=u;s+=1){const u=(0,n.sheetGridCell)(l,(0,n.gridCell)(t,s)),d=e.getServerValue(u),g=d.kind===c.ResultKind.Success?JSON.stringify(d.value):"";a.push(g);const m=e.getServerFormat(u),h=m.kind===c.ResultKind.Success?(0,i.fnv1a)(JSON.stringify(m.value)).toString():"";o.push(h);const p=e.getServerFormula(u),S=p.kind===c.ResultKind.Success?p.value?.[1].compiledFmla?.getValue():void 0,v=S?.kind===c.ResultKind.Success?p.value?.[1].fmla??"":"";""!==v&&(f+=1),r.push(v)}m.push(r),h.push(a),p.push(o)}if(0===f)continue;const S={sheetName:s,usedRangeAddress:(0,o.formatGridRange)(e.config.localeInfo,g,d.RefStyle.A1,s),values:h,formulas:m,styles:p};r.push(S)}return{workbookName:"PartialWorkbook",worksheets:r}}(e);this.result=(0,a.detect_errors)(t,void 0,void 0,this.timeLimitMS)}catch(e){this.result=`ExceLint experiment crashed with error: ${e}`}}step(){}get report(){return void 0===this.result||"string"==typeof this.result?[]:Object.keys(this.result.worksheets).map((e=>{const t=this.result.worksheets[e],r=t.exampleFixes.map(((e,r)=>{const n=t.proposedFixes[r][0],a=e.rangeSizes,i=a.reduce(((e,t)=>e+t),0);return{anomalousnessIndex:n,categories:e.bin,sizeOfCellRange:i,sizeOfEachSFRRange:a,redactedFormulaForEachSFR:e.formulas.map(s.anonymizeFormulaString),stylesDiffer:!e.sameFormat,operatorsDiffer:null,direction:e.direction}})),n=r.map((e=>e.sizeOfEachSFRRange.length)).reduce(((e,t)=>e+t),0);return{totalFormulas:t.numFormulaCells,totalSimilarFormulaRanges:n,numberOfAdjacentSFRs:r.length,numberOfAnomalousRanges:t.suspiciousRanges,numberOfCellsInAnomalousRanges:t.suspiciousCells,anomalies:r,elapsedTimeSeconds:t.elapsedTimeSeconds,proposedFixesTimeSeconds:t.proposedFixesTimeSeconds,adjustProposedFixesTimeSeconds:t.adjustProposedFixesTimeSeconds,adjustFormatProposedFixesTimeSeconds:t.adjustFormatProposedFixesTimeSeconds,exampleFixesTimeSeconds:t.exampleFixesTimeSeconds,numCountingTimeSeconds:t.numCountingTimeSeconds,columns:t.columns,rows:t.rows}})).filter((e=>e.totalFormulas>0))}get resultLogMessage(){return"string"==typeof this.result?this.result:void 0===this.result?"ExceLint experiment return <undefined>":`ExceLint experiment done. Result: ${JSON.stringify(this.report)}`}get failedLogMessage(){return this.resultLogMessage+" BTW, experiment ran out of time budget"}constructor(e=75){this.timeLimitMS=e,this.result=void 0}}},31957:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PrecisionExperiment=t.PrecisionStopReason=t.PrecisionMessageKind=t.precisionValue=void 0;const n=r(92587),a=r(60140),i=r(36159),o=r(91092),s=r(69820),u=r(26795),l=r(84272),c=r(63488),d=r(41739),g=r(55),m=r(57786),h=r(89817),p=r(57993),f=r(73701),S=r(83970),v=r(1765),F=r(50013),y=r(27437),C=r(44252),A=r(40238),E=r(4595);function b(e,t){switch(t.kind){case S.OperKind.Number:return{kind:"n",magnitude:(0,s.anonymizeMagnitude)(e.toNumber(t))};case S.OperKind.String:return{kind:"s"};case S.OperKind.Boolean:return{kind:"b"};case S.OperKind.Error:return{kind:"e",type:(0,p.englishErrorTypeToName)(t.type)};case S.OperKind.Rich:return{kind:"r"};case S.OperKind.Array:return{kind:"a"};case S.OperKind.Blank:return{kind:"z"};default:return(0,f.assertNever)("calc.calc.precisionValue",t)}}var R,T;function k(e,t){const r=e[t.sheet.index];return void 0!==r&&(0,h.meetsProduct)(r,(0,m.createCellSetFromRange)(t.range))}function N(e,t){const r=e[t.sheet.index]??u.empty;e[t.sheet.index]=(0,h.unionProduct)(r,(0,m.createCellSetFromRange)(t.range))}t.precisionValue=b,function(e){e.EvalStatistics="EvalStatistics",e.PrintFormulaStatistics="PrintFormulaStatistics",e.UnhandledFailure="UnhandledFailure"}(R||(t.PrecisionMessageKind=R={})),function(e){e.Success="Success",e.Timeout="Timeout"}(T||(t.PrecisionStopReason=T={}));const I={[y.OperatorId.Add]:.05,[y.OperatorId.Sub]:.069,[y.OperatorId.Eq]:.097,[y.OperatorId.Mul]:.1,[y.OperatorId.Div]:.11,[y.OperatorId.Concat]:.36,[y.OperatorId.Gt]:.65,[y.OperatorId.Ne]:.79,[y.OperatorId.Lt]:.89,[y.OperatorId.Le]:1.6,[y.OperatorId.Ge]:1.9,[y.OperatorId.Percent]:2.9,[y.OperatorId.At]:6.2,[y.OperatorId.Pow]:13,[y.OperatorId.Range]:67},O={[y.WorksheetFuncId.IF]:.076,[y.WorksheetFuncId.SUM]:.11,[y.WorksheetFuncId.IFERROR]:.5,[y.WorksheetFuncId.COUNTIF]:.77,[y.WorksheetFuncId.AND]:.82,[y.WorksheetFuncId.VLOOKUP]:1.5,[y.WorksheetFuncId.AVERAGE]:1.5,[y.WorksheetFuncId.HOUR]:1.9,[y.WorksheetFuncId.MINUTE]:1.9,[y.WorksheetFuncId.TEXT]:2,[y.WorksheetFuncId.OR]:2,[y.WorksheetFuncId.NOW]:2.1,[y.WorksheetFuncId.ISBLANK]:2.3,[y.WorksheetFuncId.CONCATENATE]:2.6,[y.WorksheetFuncId.SUMIF]:2.7,[y.WorksheetFuncId.COUNTIFS]:3.3,[y.WorksheetFuncId.LEFT]:3.4,[y.WorksheetFuncId.ISNUMBER]:3.7,[y.WorksheetFuncId.MID]:3.9,[y.WorksheetFuncId.COUNTA]:4,[y.WorksheetFuncId.MONTH]:4.2,[y.WorksheetFuncId.SECOND]:4.3,[y.WorksheetFuncId.LEN]:4.9,[y.WorksheetFuncId.WEEKNUM]:5,[y.WorksheetFuncId.DAY]:5.2,[y.WorksheetFuncId.ROUND]:5.4,[y.WorksheetFuncId.FIND]:5.8,[y.WorksheetFuncId.NETWORKDAYS]:6.2,[y.WorksheetFuncId.COUNT]:6.2,[y.WorksheetFuncId.YEAR]:6.3,[y.WorksheetFuncId.INT]:6.4,[y.WorksheetFuncId.RIGHT]:6.7,[y.WorksheetFuncId.ABS]:7,[y.WorksheetFuncId.CONCAT]:7.2,[y.WorksheetFuncId.CHAR]:7.4,[y.WorksheetFuncId.MAX]:8,[y.WorksheetFuncId.ROW]:8.1,[y.WorksheetFuncId.WEEKDAY]:9.1,[y.WorksheetFuncId.DAYS]:9.2,[y.WorksheetFuncId.MIN]:9.8,[y.WorksheetFuncId.SEARCH]:9.8,[y.WorksheetFuncId.WORKDAY]:11,[y.WorksheetFuncId.DATEDIF]:12,[y.WorksheetFuncId.TIME]:13,[y.WorksheetFuncId.HYPERLINK]:13,[y.WorksheetFuncId.IFS]:13,[y.WorksheetFuncId.ISERROR]:13,[y.WorksheetFuncId.COUNTBLANK]:14,[y.WorksheetFuncId.TODAY]:14,[y.WorksheetFuncId.VALUE]:18,[y.WorksheetFuncId.ROUNDUP]:18,[y.WorksheetFuncId.MATCH]:19,[y.WorksheetFuncId.DATE]:20,[y.WorksheetFuncId.SUBSTITUTE]:20,[y.WorksheetFuncId.INDIRECT]:22,[y.WorksheetFuncId.INDEX]:23,[y.WorksheetFuncId.TRIM]:24,[y.WorksheetFuncId.UPPER]:25,[y.WorksheetFuncId.SUMIFS]:28,[y.WorksheetFuncId.EXACT]:29,[y.WorksheetFuncId.NOT]:32,[y.WorksheetFuncId.PRODUCT]:35,[y.WorksheetFuncId.ROUNDDOWN]:37,[y.WorksheetFuncId.AVERAGEIF]:38,[y.WorksheetFuncId.ISTEXT]:40,[y.WorksheetFuncId.ISOWEEKNUM]:41,[y.WorksheetFuncId.EOMONTH]:42,[y.WorksheetFuncId.MROUND]:45,[y.WorksheetFuncId.COLUMN]:45,[y.WorksheetFuncId.ROWS]:46,[y.WorksheetFuncId.TIMEVALUE]:52,[y.WorksheetFuncId.TRUNC]:53,[y.WorksheetFuncId.LOOKUP]:59,[y.WorksheetFuncId.NA]:59,[y.WorksheetFuncId.DAYS360]:61,[y.WorksheetFuncId.RANK]:67,[y.WorksheetFuncId.EDATE]:72,[y.WorksheetFuncId.MOD]:82,[y.WorksheetFuncId.OFFSET]:83,[y.WorksheetFuncId.STDEV]:87,[y.WorksheetFuncId.SUBTOTAL]:91},_=(0,F.binaryVisitor)({...(0,F.constVisitor)(.01),nameNode:()=>1,operatorNode:e=>I[e]??100,wsfNode:e=>O[e]??100},i.fastMax);t.PrecisionExperiment=class{get done(){return void 0!==this.result}get resultLogMessage(){return this.createResultLogMessage(T.Success)}get failedLogMessage(){return this.createResultLogMessage(T.Timeout)}get readonlyDebugLog(){return this.log}setContext(e){this.stateId=e.stateId,this.docs=e.documents,this.docs.reconfigure({yieldIntervalMs:e.stepBudget/2,totalTimeMs:e.totalBudget},this.docs.limits,this.docs.maxDereferenceCells,this.docs.isServerWorkbookLoad),this.runtime=new l.MachineRuntime(this.sampleCells().bind((({evalCells:e,printCells:t})=>c.Pledge.all([...e.map(this.testEval),...t.map(this.testPrint)]))).catch((e=>{this.log.push({kind:R.UnhandledFailure,reason:e})})))}step(){if(this.result)return;const e=this.runtime.step();this.result=e.kind===C.TransitionKind.Break||e.kind===C.TransitionKind.Next?void 0:e}sampleCells(){const e=[],t=[],r=[];return this.docs.getServerAvailableCells().forEach((({sheetIdx:n})=>(r.push(c.Pledge.try((()=>{this.docs.forEachServerNonBlankCellInSet(n,u.dense,(r=>{const o=(0,a.sheetGridCell)(n,r),{samplePrecisionEvalRate:s,samplePrecisionPrintFormulaRate:u,samplePrecisionPrintValueRate:l}=this.config;if(s>0){const t=this.getWeight(o),r=void 0===t?void 0:s>=1?1:(0,i.fastMin)(1,s*t);void 0!==r&&this.rng.next()<r&&(N(this.sampledSets,o),e.push({cell:o,p:r}))}const c=(0,i.fastMax)(u,l);if(c>0){const e=this.rng.next();if(e<c){const r=this.isValueCell(o)?l:u;e<r&&t.push({cell:o,p:r})}}return!0}))}))),!0))),c.Pledge.all(r).bind((()=>({evalCells:e,printCells:t})))}getWeight(e){const t=this.getFormula(e);if(!(0,v.isSuccess)(t))return this.onUnavailableObject(t.reason);const[,r]=t.value;return void 0!==r.compiledFmla?function(e){return(0,v.isSuccess)(e)?(0,F.reduceBottomUp)(_,e.value):1}(r.compiledFmla.getValue()):void 0}isValueCell(e){const t=this.getFormula(e);return(0,v.isSuccess)(t)?void 0===t.value[1].compiledFmla:(this.onUnavailableObject(t.reason),!1)}resumeToPledge(e,t){return c.Pledge.try((()=>{try{this.p=t;const r=e();return Array.isArray(r)?r:this.resumeToPledge(r.resume,t)}finally{this.p=void 0}}))}getFormula(e){const t=this.docs.getEditedFormula(e);if(!(0,v.isSuccess)(t))return t;const[r,n]=t.value??[e.range,g.blankCellGridFormula],i=(0,a.lexicalSourceGrid)(n.lexicalKind,(0,a.sheetGridRange)(e.sheet,r));return(0,v.success)([i,n])}onRangeFailure(e,t,r,n,a){const i={samples:[],failures:[t]};this.log.push({kind:R.EvalStatistics,stats:i})}onNameFailure(){}onNumberFormatFailure(){}onInferFormatFailure(){}onReturnCellValue(){}onUnavailableObject(e){const t=(0,n.unavailable)([e]);this.onUnavailable(t)}onUnavailable(e){this.log.push({kind:R.UnhandledFailure,reason:e})}hasWrongPrecedent(e){return e.cells.some((e=>k(this.precisionWrongSets,e)))}onSetCellValue(e,t,r,n,a){const i=this.getFormula(e);if(!(0,v.isSuccess)(i))return this.onUnavailableObject(i.reason);const[o,s]=i.value,u=this.hasWrongPrecedent(r);return this.logPrecisionResult(e,t,o,s,u)}onSetCellValues(e,t,r,i,o){const s=this.getFormula((0,n.sheetGridRangeAnchor)(e));if(!(0,v.isSuccess)(s))return this.onUnavailableObject(s.reason);const[u,l]=s.value,c=this.hasWrongPrecedent(r);(0,n.forEachCellInRange)(e.range,((r,n,i)=>(this.logPrecisionResult((0,a.sheetGridCell)(e.sheet,r),t[n][i],u,l,c),!0)))}logPrecisionResult(e,t,r,n,a){const i=this.docs.allServerAvailable(e);if(!(0,v.isSuccess)(i))return this.onUnavailableObject(i.reason);if(!0!==i.value)return;const o=this.docs.getServerValue(e);if(!(0,v.isSuccess)(o))return this.onUnavailableObject(o.reason);const s=k(this.sampledSets,e),u=this.precisionResult(t,o.value.oper,r,n,s,a);(function(e){return void 0===e.sampled})(u)||N(this.precisionWrongSets,e);const l={samples:[u],failures:[]};this.log.push({kind:R.EvalStatistics,stats:l})}precisionResult(e,t,r,a,i,o){const u=this.p,{mathpack:l}=this.docs.config,c=b(l,t),[d,g]=this.docs.anonymizeFormula(r,a);if((0,n.isReadOperEqual)(l,e,t,!0))return{expected:c,formula:d,functions:g,root:i,cascaded:o,p:u};const m=b(l,e);if((0,n.isNumberOper)(t)&&(0,n.isNumberOper)(e)){const r=l.toNumber(t),n=l.toNumber(e);return{expected:c,sampled:m,relMagnitude:(0,s.anonymizeMagnitude)(0===r?n:(n-r)/r),formula:d,functions:g,root:i,cascaded:o,p:u}}return{expected:c,sampled:m,formula:d,functions:g,root:i,cascaded:o,p:u}}createResultLogMessage(e){if(0===this.log.length&&e===T.Success)return;const t={samples:[],failures:{}},r={samples:[],failures:{}},n={};for(const e of this.log)switch(e.kind){case R.EvalStatistics:t.samples.push(...e.stats.samples);for(const r of e.stats.failures)(0,A.incrementFailure)(t.failures,r);break;case R.PrintFormulaStatistics:r.samples.push(...e.stats.samples);for(const t of e.stats.failures)(0,A.incrementFailure)(r.failures,t);break;case R.UnhandledFailure:(0,A.incrementFailure)(n,e.reason);break;default:(0,f.assertNever)("calc.calc.PrecisionExperiment.createResultMessage",e)}return["PrecisionExperiment",e,`stateId = ${this.stateId}`,`evalStats = ${JSON.stringify(t)}`,`printStats = ${JSON.stringify(r)}`,`unhandledFailures = ${JSON.stringify(n)}`].join(", ")}constructor(e){this.sampledSets={},this.precisionWrongSets={},this.log=[],this.result=void 0,this.testEval=({cell:e,p:t})=>this.resumeToPledge((()=>this.docs.evaluate(d.ComputeKind.EditedCell,[e],E.VolatileMode.PrecisionTest)),t),this.testPrint=({cell:e,p:t})=>c.Pledge.try((()=>{const r=this.getFormula(e);if(!(0,v.isSuccess)(r))return this.onUnavailableObject(r.reason);const[n,a]=r.value;let i;if(void 0===a.compiledFmla){const t=this.docs.getServerValue(e);if(!(0,v.isSuccess)(t))return this.onUnavailableObject(t.reason);i=this.docs.renderValueBarText(e,t.value.oper,a.fmla)}else{const e=a.compiledFmla.getValue();i=(0,v.isSuccess)(e)?this.docs.printFormulaBarText(n,a.origin,e.value):e}if(!(0,v.isSuccess)(i))return void this.log.push({kind:R.PrintFormulaStatistics,stats:{samples:[],failures:[i.reason]}});const o=(0,s.anonymizeFormulaString)(a.fmla),u=i.value===a.fmla?{expected:o,p:t}:{expected:o,sampled:(0,s.anonymizeFormulaString)(i.value),p:t};this.log.push({kind:R.PrintFormulaStatistics,stats:{samples:[u],failures:[]}})})),this.config={samplePrecisionEvalRate:e.samplePrecisionEvalRate??0,samplePrecisionPrintFormulaRate:e.samplePrecisionPrintFormulaRate??0,samplePrecisionPrintValueRate:e.samplePrecisionPrintValueRate??0,rngSeed:e.rngSeed??0|(0,i.now)()},this.rng=new o.JSF32(this.config.rngSeed)}}},36025:function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.Messages=void 0,function(e){e.Root="calc.exp.UnitExperiment",e.Default="uninitialised",e.Initialised="init",e.Failure="fail",e.UnifyBound="unifyBound"}(r||(t.Messages=r={}))},32836:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runSolverStep=t.numberFormatFromCellFormat=t.valueTypeFromCellFormat=t.updateFormatStatsFromCellFormat=t.isInterestingFormat=t.makeSolverContext=t.ConstraintKind=t.UnitExperimentSettings=void 0;const n=r(48625),a=r(56504),i=r(36025),o=r(15912),s=r(60140),u=r(92587),l=r(73701),c=r(57786),d=r(41739),g=r(89817),m=r(30070),h=r(1765),p=r(60756);var f,S;t.UnitExperimentSettings={get UnitlessTimeAndDate(){return(0,p.getTypedFeatureGate)("Microsoft.Office.Excel.UnitlessTimeAndDate")},get IgnoreDivMul(){return(0,p.getTypedFeatureGate)("Microsoft.Office.Excel.UnitExpIgnoreDivMul")}},function(e){e[e.RangeEquality=0]="RangeEquality",e[e.StagedRangeEquality=1]="StagedRangeEquality",e[e.UnitEquality=2]="UnitEquality",e[e.FormatEquality=3]="FormatEquality"}(f||(t.ConstraintKind=f={})),function(e){e[e.Solved=0]="Solved",e[e.Failed=1]="Failed",e[e.Deferred=2]="Deferred",e[e.Staged=3]="Staged"}(S||(S={}));const v={kind:S.Solved},F=e=>({kind:S.Failed,error:e}),y=e=>({kind:S.Deferred,constraint:e}),C=(0,a.fromConstants)({error:1}),A=(0,a.fromConstants)({}),E=(0,a.fromConstants)({currency:1}),b=(0,a.fromConstants)({date:1}),R=(0,a.fromConstants)({time:1});function T(e,t){return void 0===t.link&&(t.link=e.uf.makePoint(t.unit)),t.link}function k(e,t,r,n){return(0,l.assertTrue)(i.Messages.Root,0===r.varCount),e.uf.union(void 0===n?e.uf.makePoint(r):n,t,!0),v}function N(e,t,r,n,o){return t===e.errorUnit?((0,l.assertTrue)(i.Messages.Root,r===e.errorPoint),void 0!==o&&e.uf.union(e.errorPoint,o,!0),v):n===e.errorUnit?((0,l.assertTrue)(i.Messages.Root,o===e.errorPoint),void 0!==r&&e.uf.union(e.errorPoint,r,!0),v):0===t.varCount?0===n.varCount?(0,a.areSignaturesEqual)(t,n)?v:(void 0!==r&&e.uf.union(e.errorPoint,r,!0),void 0!==o&&e.uf.union(e.errorPoint,o,!0),F([t,n])):((0,l.assertTrue)(i.Messages.Root,void 0!==o),k(e,o,t,r)):1===n.varCount?((0,l.assertTrue)(i.Messages.Root,void 0!==r),(0,l.assertTrue)(i.Messages.Root,void 0!==o),e.uf.union(r,o),v):((0,l.assertTrue)(i.Messages.Root,void 0!==r),k(e,r,n,o))}function I(e,t,r){if(!(0,a.isSimpleUnit)(t))return y({kind:f.UnitEquality,unit:t,target:r});const n=T(e,r),[o,s]=e.uf.findWithDescriptor(n);if(1===t.varCount){(0,l.assertTrue)(i.Messages.Root,void 0!==t.name);const r=e.symbolContext.getTable().getValue(t.name);(0,l.assertTrue)(i.Messages.Root,void 0!==r);const[n,a]=e.uf.findWithDescriptor(T(e,r));return N(e,a,n,s,o)}return N(e,t,void 0,s,o)}function O(e,t){if(t===d.SpecialFormat.Unavailable||0===t)return!1;const r=M(e,t);if(void 0===r)return!1;const n=r?.valueType;return void 0!==n&&n!==m.FormatValueType.General&&(n!==m.FormatValueType.Currency&&n!==m.FormatValueType.Accounting||void 0!==r.currencySymbol)}function _(e,t,r,n){n?r.referencedFormatCells+=1:r.allFormatCells+=1;const a=M(e,t),i=n?r.enriched.referencedFormatTypes:r.enriched.allFormatTypes,o=a?.valueType;if(void 0!==o&&(i[o]=(i[o]??0)+1),o===m.FormatValueType.Currency||o===m.FormatValueType.Accounting){const e=n?r.enriched.referencedCurrencyTypes:r.enriched.allCurrencyTypes,t=a?.currencySymbol,i=a?.culture?.culture,o=void 0===t?"none":t===m.FormatCurrency.LocaleInfo?"defaultSymbol":t+"_"+i;e[o]=(e[o]??0)+1}}function P(e,t){return M(e,t)?.valueType}function M(e,t){if("number"==typeof t){const r=e.getIformat(t);return(0,h.isSuccess)(r)?r.value:void 0}return t}function D(e,t,r){const a=e.typeContext.types[t.index];if(void 0===a)return(0,l.assertFalse)(i.Messages.Root);const o=a.getValue(r);if(void 0===o){const i=(0,s.sheetGridCell)(t,r),o=e.typeContext.formats(i);if((0,h.isSuccess)(o)){if(!O(e.typeContext,o.value)||e.typeContext.isStringValue(i)){const i=e.symbolContext.freshSymbol().unit;return e.typeContext.types[t.index]=a.setValue(r,(0,n.primitiveUnitType)(i)),i}let s=w(e,o.value);return void 0===s?s=e.symbolContext.freshSymbol().unit:_(e.typeContext,o.value,e.stats,!0),e.typeContext.types[t.index]=a.setValue(r,(0,n.primitiveUnitType)(s)),s}const u=e.symbolContext.freshSymbol().unit;return e.typeContext.types[t.index]=a.setValue(r,(0,n.primitiveUnitType)(u)),u}return o.kind===n.TypeKind.Scalar?o.unit:void 0}function w(e,r){const n=P(e.typeContext,r);if(void 0!==n)switch(n){case m.FormatValueType.Currency:case m.FormatValueType.Accounting:return E;case m.FormatValueType.Percentage:return A;case m.FormatValueType.Date:return t.UnitExperimentSettings.UnitlessTimeAndDate?A:b;case m.FormatValueType.Time:return t.UnitExperimentSettings.UnitlessTimeAndDate?A:R;default:return}}function L(e){const t=e.symbolContext.getTable();return r=>{const n=t.getValue(r);if(void 0!==n&&void 0!==n.link)return void 0===n.ufSubstitution&&(n.ufSubstitution=e.uf.findWithDescriptor(n.link)[1]),n.ufSubstitution}}t.makeSolverContext=function(e,t,r){const n=new o.UF,i=n.makePoint(C),s=(0,a.createPoisonApplication)(C);return{symbolContext:e,typeContext:t,stats:r,uf:n,errorPoint:i,errorUnit:C,apply:s}},t.isInterestingFormat=O,t.updateFormatStatsFromCellFormat=_,t.valueTypeFromCellFormat=P,t.numberFormatFromCellFormat=M;const x={[f.UnitEquality]:function(e,t){return I(e,t.unit,t.target)},[f.FormatEquality]:function(e,t){const r=w(e,t.format);if(void 0===r)return v;const n=D(e,t.cell.sheet,t.cell.range);if(void 0===n)return v;if(!(0,a.isSimpleUnit)(n))return y(t);if(1===n.varCount){(0,l.assertTrue)(i.Messages.Root,void 0!==n.name);const t=e.symbolContext.getTable().getValue(n.name);(0,l.assertTrue)(i.Messages.Root,void 0!==t);const[a,o]=e.uf.findWithDescriptor(T(e,t));return N(e,o,a,r,void 0)}return N(e,n,void 0,r,void 0)},[f.RangeEquality]:function(e,t){const r=t.type.resolution;if(!(0,u.isSheetIndex)(r.sheet))return v;if((0,u.isGridCell)(r.range)){const n=D(e,r.sheet,r.range);return void 0===n?v:I(e,n,t.target)}const n=e.typeContext.available[r.sheet.index];if(void 0===n)return v;const a=n.usedRange;if(void 0===a)return v;const i=(0,u.gridRangeIsect)(r.range,a);if(void 0===i)return v;const o=(0,g.intersectProduct)((0,g.intersectProduct)((0,c.createCellSetFromRange)(i),c.availableReadProduct),n.availableCells),s=[];return(0,c.forEachCellInSet)(o,(e=>(s.push(e),!0))),{kind:S.Staged,constraint:{kind:f.StagedRangeEquality,cursor:0,index:n.sheetIdx,cells:s,target:t.target},output:void 0}},[f.StagedRangeEquality]:function(e,t){const{cursor:r,cells:n}=t;if(r>=n.length)return v;const a=n[r],i=D(e,t.index,a),o=void 0===i?v:I(e,i,t.target);return t.cursor+=1,{kind:S.Staged,constraint:t,output:o}}};t.runSolverStep=function(e){return e.kind===n.ExperimentState.SolvingSimple?e.constraintCursor===e.constraints.length?function(e){const{apply:t,errorUnit:r}=e.context,i={kind:n.ExperimentState.SolvingFull,context:e.context,stats:e.stats,constraints:e.deferred,constraintCursor:0,unifyNF:(e,n)=>{const o=t(i.substitution,e);if(o===r)return;const s=t(i.substitution,n);if(s===r)return;const u=(0,a.unify)(t,o,s);u.kind!==a.UnificationResultKind.Subst?(i.stats.errorCount+=1,i.stats.enriched.errors.push({error:[t(i.substitution,e),t(i.substitution,n)]})):i.substitution=(0,a.compose)(t,u.substitution,i.substitution)},substitution:L(e.context)};return i}(e):function(e){const{constraints:t,context:r,constraintCursor:n,deferred:a}=e,i=t[n],o=x[i.kind](r,i);switch(o.kind){case S.Deferred:a.push(o.constraint);break;case S.Failed:e.stats.errorCount+=1,e.stats.enriched.errors.push({error:o.error});break;case S.Staged:if(t[n]=o.constraint,void 0!==o.output)switch(o.output.kind){case S.Deferred:a.push(o.output.constraint);break;case S.Failed:e.stats.errorCount+=1,e.stats.enriched.errors.push({error:o.output.error})}return e}return e.constraintCursor+=1,e}(e):function(e){const{constraints:t,context:r,constraintCursor:n,unifyNF:a}=e,o=t[n];switch(o.kind){case f.UnitEquality:a(o.unit,o.target.unit);break;case f.FormatEquality:const t=w(r,o.format);if(void 0===t)break;const n=D(r,o.cell.sheet,o.cell.range);if(void 0===n)break;a(t,n);break;default:return e.constraintCursor+=1,(0,l.assertNever)(i.Messages.Root,o)}return e.constraintCursor+=1,e}(e)}},48625:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExperimentState=t.isResolvedReferenceType=t.primitiveUnitType=t.primitiveType=t.topType=t.bottomType=t.oneType=t.errorType=t.dimensionlessNumberType=t.dimensionLess=t.numberType=t.stringType=t.boolType=t.typeFromDimensions=t.joinDimensions=t.getLiftingDimensionsFromTypes=t.dimensionsFromType=t.makeArrayType=t.makeResolvedReferenceType=t.makeReferenceType=t.makePrimitiveType=t.TypeKind=void 0;const n=r(92587),a=r(56504),i=r(83970);var o,s;function u(e,t=void 0){return{kind:o.Scalar,flags:e,unit:t}}function l(e){return{kind:o.Reference,reference:e,resolution:void 0}}function c(e,t){return{kind:o.Array,elementType:e,dimensions:t}}function d(e){return{kind:o.Union,flags:e}}function g(e){switch(e.kind){case o.Reference:const t=e.resolution?.range;return void 0!==t&&(!!(0,n.isGridCell)(t)||{rows:t.rows,columns:t.cols,exact:!0});case o.Array:return e.dimensions;case o.Scalar:return!0;case o.Union:return!1}}function m(e,t){return"object"==typeof e?"object"==typeof t?{rows:Math.max(e.rows,t.rows),columns:Math.max(e.columns,t.columns),exact:e.exact&&t.exact}:{...e,exact:e.exact&&t}:"object"==typeof t?{...t,exact:t.exact&&e}:e&&t}!function(e){e[e.Scalar=0]="Scalar",e[e.Reference=1]="Reference",e[e.Array=2]="Array",e[e.Union=3]="Union"}(o||(t.TypeKind=o={})),t.makePrimitiveType=u,t.makeReferenceType=l,t.makeResolvedReferenceType=function(e,t){const r=l(e);return r.resolution=t,r},t.makeArrayType=c,t.dimensionsFromType=g,t.getLiftingDimensionsFromTypes=function(e,t){return m(g(e),g(t))},t.joinDimensions=m,t.typeFromDimensions=function(e,t){return!0===t?e:c(e,t)},t.boolType=u(i.OperKind.Boolean),t.stringType=u(i.OperKind.String),t.numberType=u(i.OperKind.Number),t.dimensionLess=(0,a.fromConstants)({}),t.dimensionlessNumberType=u(i.OperKind.Number,t.dimensionLess),t.errorType=u(i.OperKind.Error),t.oneType=u(i.OperKind.Missing|i.OperKind.Blank),t.bottomType=d(i.SignatureType.None),t.topType=d(i.SignatureType.All),t.primitiveType=u(i.OperKind.Number|i.OperKind.Boolean|i.OperKind.String),t.primitiveUnitType=e=>u(i.OperKind.Number|i.OperKind.Boolean|i.OperKind.String,e),t.isResolvedReferenceType=function(e){return void 0!==e.resolution},function(e){e[e.Checking=0]="Checking",e[e.SolvingSimple=1]="SolvingSimple",e[e.SolvingFull=2]="SolvingFull"}(s||(t.ExperimentState=s={}))},15912:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UF=void 0,t.UF=class{makePoint(e){const t=this.roots.length;return this.roots.push(t),this.backlinks.push(t),this.descriptors.push(e),this.ranks.push(0),t}find(e){const t=this.roots;let r=e;for(;t[r]!==r;)t[r]=t[t[r]],r=t[r];return r}findWithDescriptor(e){const t=this.find(e);return[t,this.descriptors[t]]}union(e,t,r=!1){const n=this.find(e),a=this.find(t);if(n===a)return;const i=this.roots,o=this.backlinks,s=this.ranks;if(r){const e=o[a];return o[a]=o[n],o[n]=e,i[a]=n,void(s[n]<=s[a]&&(s[n]=s[a]+1))}if(s[n]<s[a]){const e=o[n];o[n]=o[a],o[a]=e,i[n]=a}else{const e=o[a];o[a]=o[n],o[n]=e,i[a]=n,s[n]===s[a]&&(s[n]+=1)}}forEachInClass(e,t){const r=this.backlinks;let n=e;for(t(n);r[n]!==e;)n=r[n],t(n)}constructor(){this.roots=[],this.backlinks=[],this.descriptors=[],this.ranks=[]}}},33903:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnitExperiment=void 0;const n=r(73701),a=r(60140),i=r(27437),o=r(12973),s=r(58251),u=r(92988),l=r(56504),c=r(36025),d=r(48625),g=r(32836),m=r(32836),h=r(43595),p=r(3028),f=r(74599),S=r(1765),v=r(83970),F=r(50013),y=r(63488),C=r(92587),A=r(57786),E=r(89817);t.UnitExperiment=class{get done(){return this.isDone}freshCheckingState(e){this.lastStepMessage="freshCheckingState";const t=[],r={};e.getServerAvailableCells().forEach((n=>{const a=e.getServerUsedRange(n.sheetIdx);if(a.kind!==S.ResultKind.Success)return this.isDone=!0,void(this.statsMessage="Unit experiment: getServerUsedRange failed");const i={...n,usedRange:a.value?.range};r[n.sheetIdx.index]=i,t.push(i)}));const n=void 0===e.getServerDocument()?()=>(0,S.failure)(void 0):t=>e.getIformat(e.getServerDocument(),t);return{kind:d.ExperimentState.Checking,locale:e.config.localeInfo,mathpack:e.config.mathpack,resolver:(0,u.createResolver)(e),documentTypeContext:{formats:t=>e.getServerFormat(t),types:{},available:r,getIformat:n,isStringValue:t=>{if(void 0===e.getServerDocument())return!1;const r=e.getServerValue(t);return r.kind===S.ResultKind.Success&&r.value.oper.kind===v.OperKind.String}},constraints:[],stats:{formulaCells:0,referencedFormatCells:0,allFormatCells:0,totalCells:0,errorCount:0,enriched:{errors:[],referencedFormatTypes:{},allFormatTypes:{},referencedCurrencyTypes:{},allCurrencyTypes:{}}},sheets:t,mutableState:{symbolContext:b.init(),ranges:void 0,cells:void 0,sheetCursor:0,rangeCursor:0,cellCursor:0}}}freshSolvingState(e){return this.lastStepMessage="freshSolvingState",{kind:d.ExperimentState.SolvingSimple,stats:e.stats,context:(0,m.makeSolverContext)(e.mutableState.symbolContext,e.documentTypeContext,e.stats),constraints:e.constraints,constraintCursor:0,deferred:[]}}step(){if(!this.isDone){if(void 0===this.documentContext)return this.isDone=!0,(0,n.assertNever)(`${c.Messages.Root}.${c.Messages.Initialised}`,this.documentContext);void 0===this.state&&(this.state=this.freshCheckingState(this.documentContext));try{const e=this.state;switch(e.kind){case d.ExperimentState.Checking:return e.mutableState.sheetCursor<e.sheets.length?void(this.state=this.runCheckStep(this.documentContext,e)):void(this.state=this.freshSolvingState(e));case d.ExperimentState.SolvingSimple:return this.lastStepMessage="SolvingSimple",void(this.state=(0,m.runSolverStep)(e));case d.ExperimentState.SolvingFull:return e.constraintCursor<e.constraints.length?(this.lastStepMessage="SolvingFull",void(this.state=(0,m.runSolverStep)(e))):(this.lastStepMessage="done SolvingFull",this.isDone=!0,void(this.statsMessage=this.statsForLogging(e.stats)))}}catch(e){return this.statsMessage=`${c.Messages.Root}.${c.Messages.Failure}: ${(0,p.messageFromError)(e)}`,void(this.isDone=!0)}}}setContext({documents:e}){this.documentContext=e}initialiseSheetStep(e){this.lastStepMessage="initialiseSheetStep";const{mutableState:t,sheets:r}=e,{sheetCursor:n}=t,a=r[n],i=a.usedRange,o=[];if(void 0!==i){const e=(0,E.intersectProduct)(a.availableCells,A.availableReadProduct);(0,A.forEachRangeInSet)(e,(e=>{const t=(0,C.gridRangeIsect)(e,i);if(void 0!==t){if((0,C.gridRangeSize)(t)<250)return o.push(t),!0;(0,C.forEachTileInRange)(t,15,(e=>(o.push(e),!0)))}return!0}))}return t.ranges=o,t.rangeCursor=0,e.documentTypeContext.types[a.sheetIdx.index]=(0,f.makeGridRangeTable)(),e}initialiseRangeCells(e,t){this.lastStepMessage="initialiseRangeCells";const{mutableState:r,stats:n,sheets:i}=t,{sheetCursor:o}=r,s=[],u=i[o],l=r.ranges[r.rangeCursor];return e.forEachServerNonBlankCellInSet(u.sheetIdx,(0,A.createCellSetFromRange)(l),(r=>{const i=(0,a.sheetGridCell)(u.sheetIdx,r),o=e.getServerFormula(i);o.kind===S.ResultKind.Success&&void 0!==o.value?.[1].compiledFmla&&(s.push(o.value[1]),n.formulaCells+=1);const l=e.getServerFormat(i);return l.kind===S.ResultKind.Success&&(0,m.isInterestingFormat)(t.documentTypeContext,l.value)&&(0,m.updateFormatStatsFromCellFormat)(t.documentTypeContext,l.value,n,!1),n.totalCells+=1,!0})),r.cells=s,r.cellCursor=0,t}checkCell(e,t){this.lastStepMessage="checkCell";const{sheets:r,constraints:n,stats:i,mutableState:o}=t,{cells:s,sheetCursor:u,cellCursor:l}=o,c=r[u],g=s[l],h=g.compiledFmla.getValue();if(h.kind===S.ResultKind.Success){const r=(0,a.sheetGridCell)(c.sheetIdx,g.origin),o=function(e,t,r){const{constraints:n,locale:a,mathpack:i,resolver:o,documentTypeContext:s}=e,u=s.types[t.sheet.index],l=e.mutableState.symbolContext.copy(),c={origin:t,locale:a,mathpack:i,resolver:o,symbolContext:l,pushConstraint:e=>void 0!==e&&(n.push(e),!0)},g=function(e,t){return(0,F.reducePledge)(new _(e),t)}(c,r),h=N(c,g);let p=I(c,void 0===h?d.topType:h);if(p.kind===d.TypeKind.Reference){const e=l.freshSymbol(),t={kind:m.ConstraintKind.RangeEquality,type:p,target:e};p=(0,d.primitiveUnitType)(e.unit),n.push(t)}return e.mutableState.symbolContext=l,p.kind===d.TypeKind.Array?u:u.setValue(t.range,p)}(t,r,h.value);t.documentTypeContext.types[c.sheetIdx.index]=o;const s=e.getServerFormat(r);s.kind===S.ResultKind.Success&&(0,m.isInterestingFormat)(t.documentTypeContext,s.value)&&(n.push({kind:m.ConstraintKind.FormatEquality,cell:r,format:s.value}),(0,m.updateFormatStatsFromCellFormat)(t.documentTypeContext,s.value,i,!0))}return t.mutableState.cellCursor+=1,t}runCheckStep(e,t){if(!function(e){return void 0!==e.mutableState.ranges}(t))return this.initialiseSheetStep(t);const{mutableState:r}=t;return r.rangeCursor===r.ranges.length?(r.ranges=void 0,r.sheetCursor+=1,t):function(e){return void 0!==e.mutableState.cells}(t)?r.cellCursor<t.mutableState.cells.length?this.checkCell(e,t):(r.cells=void 0,r.rangeCursor+=1,t):this.initialiseRangeCells(e,t)}statsForLogging(e){return JSON.stringify(e)}get resultLogMessage(){return this.statsMessage??`${c.Messages.Root}.${c.Messages.Default}`}get failedLogMessage(){const e=this.state?.kind,t=this.state?.kind===d.ExperimentState.Checking&&0===this.state?.mutableState.cellCursor;return`Units experiment timed out. Last step: ${this.lastStepMessage}. Experiment state: ${void 0!==e?d.ExperimentState[e]:"NotStarted"}. isCellCursorZero: ${t}. Number of constraints: ${this.state?.constraints.length}. Stats: ${this.statsForLogging(this.state?.stats)}`}constructor(){this.isDone=!1,this.lastStepMessage="before started"}};class b{static init(){return new b(0,h.RedBlackMapTree.create(((e,t)=>e.localeCompare(t))))}getTable(){return this.table}freshSymbol(e){const t=`${void 0===e?"gen":e}@${this.seed+=1}`,r={unit:(0,l.fromVar)(t),link:void 0,ufSubstitution:void 0};return this.table=this.table.setValue(t,r),r}copy(){return new b(this.seed,this.table)}constructor(e,t){this.seed=e,this.table=t}}function R(e,t,r){switch(e.kind){case d.TypeKind.Array:if(e.elementType.kind===d.TypeKind.Reference)return;return r?R(e.elementType,t,!1):void 0;case d.TypeKind.Reference:return{kind:m.ConstraintKind.RangeEquality,type:e,target:t};case d.TypeKind.Scalar:return void 0===e.unit?void 0:{kind:m.ConstraintKind.UnitEquality,unit:e.unit,target:t};case d.TypeKind.Union:return;default:return(0,n.assertNever)(c.Messages.Root,e)}}function T(e,t,r){switch(t.kind){case d.TypeKind.Array:if(t.elementType.kind===d.TypeKind.Reference)return;return r?T(e,t.elementType,!1):void 0;case d.TypeKind.Reference:const a=e.symbolContext.freshSymbol(),i={kind:m.ConstraintKind.RangeEquality,type:t,target:a};return[a.unit,i];case d.TypeKind.Scalar:return void 0===t.unit?void 0:[t.unit,void 0];case d.TypeKind.Union:return;default:return(0,n.assertNever)(c.Messages.Root,t)}}function k(e){const t=e.length;if(0===t)return d.topType;let r=d.bottomType;const n=e[0].length;for(let t=0;t<e.length;t+=1){const n=e[t];for(let e=0;e<n.length;e+=1)a=r,i=n[e],r=a===d.bottomType?i:i===d.bottomType||a===d.topType?a:i===d.topType?i:a.kind===d.TypeKind.Scalar&&i.kind===d.TypeKind.Scalar&&void 0===a.unit&&void 0===i.unit?(0,d.makePrimitiveType)(a.flags|i.flags):d.topType}var a,i;return(0,d.makeArrayType)(r,{rows:t,columns:n,exact:!0})}function N(e,t){if(t.kind===d.TypeKind.Reference&&!(0,d.isResolvedReferenceType)(t)){const r=function(e,t){const r=(0,s.resolveLocalsGrid)(e.origin),{resolution:n}=e.resolver.resolveCellRef(r,t.reference);return!!(0,S.isSuccess)(n)&&(!n.value||n.value)}(e,t);return"object"==typeof r?(0,d.makeResolvedReferenceType)(t.reference,r):r?d.errorType:void 0}if(t.kind===d.TypeKind.Array){const r=N(e,t.elementType);return void 0===r?r:r===t.elementType?t:(0,d.makeArrayType)(r,t.dimensions)}return t}function I(e,t){switch(t.kind){case d.TypeKind.Scalar:if(void 0===t.unit){const r=e.symbolContext.freshSymbol();return(0,d.makePrimitiveType)(t.flags,r.unit)}return t;case d.TypeKind.Array:let r=t;const a=[];for(;r.kind===d.TypeKind.Array;)a.push(r.dimensions),r=r.elementType;const i=I(e,r);return a.reduceRight(d.makeArrayType,i);case d.TypeKind.Reference:case d.TypeKind.Union:return t;default:return(0,n.assertNever)(c.Messages.Root,t)}}function O(e,t,r,n,a){const i=e.symbolContext.freshSymbol(),o=R(t,i,n),s=R(r,i,n);if(void 0!==o&&void 0!==s||a&&(void 0!==o||void 0!==s))return e.pushConstraint(o),e.pushConstraint(s),i}class _{literalNode(e){return y.Pledge.resolve(function(e){switch(e.kind){case v.OperKind.Number:return d.numberType;case v.OperKind.String:return d.stringType;case v.OperKind.Boolean:return d.boolType;case v.OperKind.Error:return d.errorType;default:return d.oneType}}(e))}arrayNode(e){return y.Pledge.all(e.map((e=>y.Pledge.all(e.map(this.lazyVisitFormulaNode))))).bind(k)}appNode(e,t){return e.kind===o.NodeKind.Operator?y.Pledge.all(t.map((e=>this.lazyVisitFormulaNode(e).bind((t=>[t,e]))))).bind((t=>function(e,t,r){switch(t){case i.OperatorId.Add:case i.OperatorId.Sub:case i.OperatorId.Mul:case i.OperatorId.Div:case i.OperatorId.Pow:case i.OperatorId.Eq:case i.OperatorId.Ne:case i.OperatorId.Lt:case i.OperatorId.Le:case i.OperatorId.Gt:case i.OperatorId.Ge:case i.OperatorId.Range:case i.OperatorId.Isect:case i.OperatorId.Union:case i.OperatorId.Concat:case i.OperatorId.And:case i.OperatorId.Or:case i.OperatorId.Xor:case i.OperatorId.Min:case i.OperatorId.Max:return function(e,t,r){if(r.length<2)return d.topType;const a=N(e,r[0][0]),o=N(e,r[1][0]);if(void 0===a||void 0===o)return d.topType;const s=(0,d.getLiftingDimensionsFromTypes)(a,o);if(!1===s)return d.topType;const u="object"==typeof s;switch(t){case i.OperatorId.Add:case i.OperatorId.Sub:case i.OperatorId.Min:case i.OperatorId.Max:{const t=O(e,a,o,u,!0);return(0,d.typeFromDimensions)(void 0===t?d.numberType:(0,d.makePrimitiveType)(v.OperKind.Number,t.unit),s)}case i.OperatorId.Eq:case i.OperatorId.Ne:case i.OperatorId.Lt:case i.OperatorId.Le:case i.OperatorId.Gt:case i.OperatorId.Ge:return O(e,a,o,u,!1),(0,d.typeFromDimensions)(d.boolType,s);case i.OperatorId.Mul:case i.OperatorId.Div:if(g.UnitExperimentSettings.IgnoreDivMul)return d.numberType;{const r=e.symbolContext.freshSymbol(),n=e.symbolContext.freshSymbol(),c=R(a,r,u),g=R(o,n,u);if(e.pushConstraint(c),e.pushConstraint(g),void 0===c&&void 0===g)return(0,d.typeFromDimensions)(d.numberType,s);const m=t===i.OperatorId.Mul?(0,l.prod)(r.unit,n.unit):(0,l.prod)(r.unit,(0,l.inv)(n.unit));return(0,d.typeFromDimensions)((0,d.makePrimitiveType)(v.OperKind.Number,m),s)}case i.OperatorId.Pow:const[,m]=r[1];if((0,C.isNumberLiteralNode)(m)){const t=e.mathpack.toNumber(m.oper);if((0,p.isInteger)(t)){const r=T(e,a,"object"==typeof s);return void 0===r?(0,d.typeFromDimensions)(d.numberType,s):(e.pushConstraint(r[1]),(0,d.typeFromDimensions)((0,d.makePrimitiveType)(v.OperKind.Number,(0,l.pow)(r[0],t,d.dimensionLess)),s))}}return d.topType;case i.OperatorId.Range:case i.OperatorId.Isect:case i.OperatorId.Union:return d.topType;case i.OperatorId.Concat:return(0,d.typeFromDimensions)(d.stringType,s);case i.OperatorId.And:case i.OperatorId.Or:case i.OperatorId.Xor:return(0,d.typeFromDimensions)(d.boolType,s);default:return(0,n.assertNever)(c.Messages.Root,t)}}(e,t,r);case i.OperatorId.Percent:case i.OperatorId.Neg:case i.OperatorId.Pos:case i.OperatorId.At:case i.OperatorId.Pound:return function(e,t,r){if(r.length<1)return d.topType;const[a]=r[0],o=N(e,a);if(void 0===o)return d.topType;const s=(0,d.dimensionsFromType)(o);if(!1===s)return d.topType;switch(t){case i.OperatorId.Percent:return(0,d.typeFromDimensions)(d.dimensionlessNumberType,s);case i.OperatorId.Neg:case i.OperatorId.Pos:const r=T(e,o,"object"==typeof s);return void 0===r?(0,d.typeFromDimensions)(d.numberType,s):(e.pushConstraint(r[1]),(0,d.typeFromDimensions)((0,d.makePrimitiveType)(v.OperKind.Number,r[0]),s));case i.OperatorId.At:case i.OperatorId.Pound:return d.topType;default:return(0,n.assertNever)(c.Messages.Root,t)}}(e,t,r);default:return(0,n.assertNever)(c.Messages.Root,t)}}(this.context,e.id,t))):e.kind===o.NodeKind.WSF?y.Pledge.all(t.map(this.lazyVisitFormulaNode)).bind((t=>function(e,t,r){switch(t){case i.WorksheetFuncId.SUM:case i.WorksheetFuncId.AVERAGE:case i.WorksheetFuncId.MAX:case i.WorksheetFuncId.MIN:if(0===r.length)return d.topType;const t=e.symbolContext.freshSymbol();let n=!0;return r.forEach((r=>{const a=N(e,r);a&&e.pushConstraint(R(a,t,!0))&&(n=!1)})),n?d.numberType:(0,d.makePrimitiveType)(v.OperKind.Number,t.unit);case i.WorksheetFuncId.IF:if(r.length<2)return d.topType;const a=N(e,r[0]),o=N(e,r[1]),s=N(e,void 0===r[2]?d.boolType:r[2]);if(void 0===a)return void 0!==o&&void 0!==s&&O(e,o,s,!0,!1),d.topType;const u=(0,d.dimensionsFromType)(a),l="object"==typeof u;if(void 0===o||void 0===s)return d.topType;const c=O(e,o,s,!0,!0),g=c?(0,d.primitiveUnitType)(c.unit):d.primitiveType;return l?(0,d.makeArrayType)(g,u):g;default:return d.topType}}(this.context,e.id,t))):y.Pledge.resolve(d.topType)}letNode(e,t,r,n){return y.Pledge.resolve(d.topType)}lambdaNode(e,t,r,n){return y.Pledge.resolve(d.topType)}parenNode(e){return this.lazyVisitFormulaNode(e)}nameNode(e,t){return y.Pledge.resolve(d.topType)}cellRefNode(e,t){return y.Pledge.resolve((0,d.makeReferenceType)((0,o.cellRefNode)(e,t)))}fieldRefNode(e,t){return y.Pledge.resolve(d.topType)}structRefNode(e,t){return y.Pledge.resolve(d.topType)}missingNode(e){return y.Pledge.resolve(d.topType)}badSequenceNode(e,t){return y.Pledge.resolve(d.topType)}badCharsNode(e,t){return y.Pledge.resolve(d.topType)}operatorNode(e,t){return y.Pledge.resolve((0,o.operatorNode)(e,t))}wsfNode(e,t,r){return y.Pledge.resolve((0,o.wsfNode)(e,t,r))}constructor(e){this.context=e,this.visitFormulaNode=e=>(0,F.visitFormulaNode)(this,e),this.lazyVisitFormulaNode=e=>y.Pledge.resolve(e).bind(this.visitFormulaNode)}}},56504:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unify=t.compose=t.createPoisonApplication=t.UnificationResultKind=t.substituteVariable=t.serialiseMeasure=t.toUnitConstraint=t.shuffleNormalForms=t.pow=t.inv=t.prod=t.areSignaturesEqual=t.isSimpleUnit=t.fromVar=t.fromConstants=t.makeSignature=t.someVar=t.everyVar=t.someConst=t.everyConst=void 0;const n=r(73701),a=r(36025);function i(e,t){for(const r in e)if(!t(r,e[r]))return!1;return!0}const o=(e,t)=>!i(e,((e,r)=>!t(e,r)));function s(e,t){let r=0;!function(e,t){for(const t in e)e[t],r+=1}(t.vars),(0,n.assertTrue)(e,void 0===t.name||1===t.varCount),(0,n.assertTrue)(e,t.varCount===r)}function u(e,t,r){const n={varCount:e,vars:t,consts:r,name:void 0};return s(a.Messages.Root,n),n}function l(){}function c(){return new l}t.everyConst=(e,t)=>i(e.consts,t),t.someConst=(e,t)=>o(e.consts,t),t.everyVar=(e,t)=>i(e.vars,t),t.someVar=(e,t)=>o(e.vars,t),t.makeSignature=u;const d=c();function g(){return u(0,{},c())}function m(e){return u(0,{},e)}t.fromConstants=m,t.fromVar=function(e){const t=u(1,{[e]:1},d);return t.name=e,t};const h=()=>!1;function p(e,r){return(0,t.everyVar)(e,((e,t)=>r.vars[e]===t))&&(0,t.everyConst)(e,((e,t)=>r.consts[e]===t))}function f(e,t){const r=g(),{vars:n,consts:i}=e,{vars:o,consts:u}=t;for(const e in n){const t=n[e]-(o[e]??0);0!==t&&(r.vars[e]=t,r.varCount+=1)}for(const e in i){const t=i[e]-(u[e]??0);0!==t&&(r.consts[e]=t)}for(const e in o)void 0===n[e]&&(r.vars[e]=-o[e],r.varCount+=1);for(const e in u)void 0===i[e]&&(r.consts[e]=-u[e]);return s(a.Messages.Root,r),r}function S(e,t,r,n){return r?1===t?e:`${e}^${t}`:-1===t?e:`${e}^${t*n}`}function v(e,t,r){const{vars:n,consts:a}=t,i=n[e];if(void 0===i)return t;let o=0;const{vars:s,consts:l}=g();for(const t in n){const a=r.vars[t],u=void 0===a?0:a,l=(t===e?0:n[t])+u*i;0!==l&&(o+=1,s[t]=l)}for(const e in r.vars)void 0===n[e]&&(o+=1,s[e]=i*r.vars[e]);for(const e in a){const t=r.consts[e],n=a[e]+i*(void 0===t?0:t);0!==n&&(l[e]=n)}for(const e in r.consts)void 0===a[e]&&(l[e]=i*r.consts[e]);return u(o,s,l)}var F;t.isSimpleUnit=function(e){if(0===e.varCount)return!0;if(void 0!==e.name)return!0;if(1===e.varCount&&(e.consts===d||(0,t.everyConst)(e,h))){const t=function(e,t){for(const t in e.vars)return 1===e.vars[t]?t:void 0}(e);return void 0!==t&&(e.name=t,!0)}return!1},t.areSignaturesEqual=function(e,t){return p(e,t)&&p(t,e)},t.prod=function(e,t){const r=g(),{vars:n,consts:i}=e,{vars:o,consts:u}=t;for(const e in n){const t=n[e]+(o[e]??0);0!==t&&(r.vars[e]=t,r.varCount+=1)}for(const e in i){const t=i[e]+(u[e]??0);0!==t&&(r.consts[e]=t)}for(const e in o)void 0===n[e]&&(r.vars[e]=o[e],r.varCount+=1);for(const e in u)void 0===i[e]&&(r.consts[e]=u[e]);return s(a.Messages.Root,r),r},t.inv=function(e){const t=g(),{vars:r,consts:n}=e;for(const e in r)t.vars[e]=-r[e];for(const e in n)t.consts[e]=-n[e];return t.varCount=e.varCount,s(a.Messages.Root,t),t},t.pow=function(e,t,r){if(0===t)return r;const n=g(),{vars:i,consts:o}=e;for(const e in i)n.vars[e]=i[e]*t;for(const e in o)n.consts[e]=o[e]*t;return n.varCount=e.varCount,s(a.Messages.Root,n),n},t.shuffleNormalForms=function(e,r){const i=g(),o=g(),u=i.vars,l=o.consts;for(const t in e.vars){const n=e.vars[t]-(r.vars[t]??0);0!==n&&(u[t]=n,i.varCount+=1)}for(const t in r.vars)void 0===e.vars[t]&&(u[t]=-r.vars[t],i.varCount+=1);for(const t in r.consts){const n=r.consts[t]-(e.consts[t]??0);0!==n&&(l[t]=n)}for(const t in e.consts)void 0===r.consts[t]&&(l[t]=-e.consts[t]);return s(a.Messages.Root,i),s(a.Messages.Root,o),(0,n.assertTrue)(a.Messages.Root,(0,t.everyConst)(i,h)),{vars:i,consts:o}},t.toUnitConstraint=f,t.serialiseMeasure=function(e){const t=[],r=[];for(const n in e.vars){const a=e.vars[n];a>0?t.push([n,a]):r.push([n,a])}for(const n in e.consts){const a=e.consts[n];a>0?t.push([n,a]):r.push([n,a])}if(0===r.length)return 0===t.length?"1":t.map((([e,t])=>S(e,t,!0,1))).join("*");let n=r.map((([e,t])=>S(e,t,!1,-1))).join("*");return r.length>1&&(n="("+n+")"),0===t.length?`1/${n}`:`${t.map((([e,t])=>S(e,t,!0,1))).join("*")}/${n}`},t.substituteVariable=v,function(e){e[e.Fail=0]="Fail",e[e.Subst=1]="Subst"}(F||(t.UnificationResultKind=F={}));const y=()=>{},C={kind:F.Subst,substitution:y},A=e=>({kind:F.Subst,substitution:e}),E={kind:F.Fail},b=e=>e<0?-e:e;function R(e,t,r){const n={};return r===y?t:t===y?r:a=>{const i=n[a];if(void 0!==i)return i;const o=r(a);return n[a]=void 0===o?t(a):e(t,o)}}function T(e,t){return r=>e===r?t:void 0}function k(e,r,i){if(e>=100)return(0,n.assertFalse)(a.Messages.UnifyBound);if(0===i.varCount)return(0,t.everyConst)(i,h)?C:E;if(1===i.varCount){let e;for(const t in i.vars){e=t;break}(0,n.assertTrue)(a.Messages.Root,void 0!==e);const t=i.vars[e],r={};for(const e in i.consts){const n=i.consts[e];if(n%t!=0)return E;r[e]=-n/t}return A(T(e,m(r)))}let o,s,l=0;const{vars:c,consts:d,varCount:g}=i;for(const e in c){const t=c[e],r=b(t);(void 0===s||r<s)&&(l=t,s=r,o=e)}(0,n.assertTrue)(a.Messages.Root,void 0!==o),(0,n.assertTrue)(a.Messages.Root,0!==l);const p={},f={};for(const e in c)if(e===o)p[e]=1;else{const t=c[e];p[e]=-Math.floor(t/l)}for(const e in d){const t=d[e];f[e]=-Math.floor(t/l)}const S=u(g,p,f),y=k(e+1,r,v(o,i,S));return y.kind===F.Fail?y:A(R(r,y.substitution,T(o,S)))}t.createPoisonApplication=function(e){return(t,r)=>{if(0===r.varCount||t===y)return r;let n=r;for(const a in r.vars){const r=t(a);if(r===e)return e;void 0!==r&&(n=v(a,n,r))}return n}},t.compose=R,t.unify=(e,t,r)=>k(0,e,f(t,r))},14907:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logMissingJSFeatures=t.getMissingJSFeatures=void 0;const n=r(73701),a=r(57993),i=r(3028),o=[{name:"self",test:()=>"undefined"!=typeof self},{name:"setImmediate",test:()=>"function"==typeof setImmediate},{name:"fetch",test:()=>"function"==typeof fetch},{name:"Set",test:()=>"function"==typeof Set},{name:"Map",test:()=>"function"==typeof Map},{name:"WeakMap",test:()=>"function"==typeof WeakMap},{name:"Symbol",test:()=>"function"==typeof Symbol},{name:"WebAssembly",test:()=>"object"==typeof WebAssembly},{name:"Atomics",test:()=>"object"==typeof Atomics},{name:"BigInt",test:()=>"function"==typeof BigInt},{name:"String.startsWith",test:()=>"function"==typeof"".startsWith},{name:"String.codePointAt",test:()=>"function"==typeof"".codePointAt},{name:"Object.assign",test:()=>"function"==typeof Object.assign},{name:"Object.setPrototypeOf",test:()=>"function"==typeof Object.setPrototypeOf},{name:"Number.EPSILON",test:()=>"number"==typeof Number.EPSILON},{name:"Number.isFinite",test:()=>"function"==typeof Number.isFinite},{name:"Number.parseInt",test:()=>"function"==typeof Number.parseInt},{name:"Math.acosh",test:()=>"function"==typeof Math.acosh},{name:"Math.hypot",test:()=>"function"==typeof Math.hypot},{name:"Math.log1p",test:()=>"function"==typeof Math.log1p},{name:"Math.trunc",test:()=>"function"==typeof Math.trunc},{name:"Promise.finally",test:()=>"function"==typeof Promise.resolve().finally},{name:"RegExp_flags",test:()=>(new RegExp("x","i"),!0)},{name:"RegExp.flags",test:()=>"string"==typeof/x/.flags},{name:"Array.of",test:()=>"function"==typeof Array.of},{name:"Array.entries",test:()=>"function"==typeof[].entries},{name:"Array.find",test:()=>"function"==typeof[].find},{name:"performance",test:()=>"object"==typeof performance},{name:"performance.now",test:()=>"function"==typeof performance.now},{name:"performance.timeOrigin",test:()=>"number"==typeof performance.timeOrigin},{name:"performance.memory",test:()=>"object"==typeof performance.memory}];function s(){return o.map((({name:e,test:t})=>{try{return t()?"":e}catch(t){return e}})).filter((e=>e.length>0))}t.getMissingJSFeatures=s,t.logMissingJSFeatures=function(e){e().then((e=>{const t={main:s(),worker:e},r=`calc.calc.logMissingJSFeatures: missing = ${JSON.stringify(t)}`;n.ulsLogger.ULS.traceTag(561534152,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,r)})).catch((e=>{const t=`calc.calc.logMissingJSFeatures: threw ${(0,i.messageFromError)(e)}`;n.ulsLogger.ULS.traceTag(561534153,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,t)}))}},53111:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbook=t.EvalOnClonePropsFromPartialWBDocumentCollection=t.EvalOnClonePropsFromPartialWB=t.MaxStateIdDifferenceForGC=void 0;const n=r(14009),a=r(14009),i=r(14009),o=r(92587),s=r(92587),u=r(60140),l=r(96978),c=r(27437),d=r(41739),g=r(73701),m=r(57786),h=r(55),p=r(94973),f=r(36159),S=r(76726),v=r(91092),F=r(89817),y=r(80957),C=r(82438),A=r(62703),E=r(30070),b=r(13168),R=r(1765),T=r(1765),k=r(50013),N=r(31957),I=r(90437),O=r(91988),_=r(4595),P=r(40238),M=r(3028),D=r(56134),w=r(74599),L=r(18784),x=r(73440),K=r(68954),W=r(97729),U=2*u.sheetCols;t.MaxStateIdDifferenceForGC=17;const G=(0,u.gridRange)(0,0,u.sheetRows,u.sheetCols);function B(e,t){let r;return t.kind===a.ReasonKind.Unavailable&&t.objects.length>0&&"kind"in t.objects[0]&&(r=t.objects[0].kind),(0,T.failure)({cell:e,kind:t.kind,innerKind:r})}const V=(0,k.binaryVisitor)({...(0,k.constVisitor)(!1),wsfNode:e=>e===c.WorksheetFuncId.HYPERLINK},((e,t)=>e||t));var j,H;!function(e){e.EvalFinished="EvalFinished",e.EvalTimedOut="EvalTimedOut",e.StateIdAdvanced="StateIdAdvanced",e.EditReceived="EditReceived",e.SetSheetNames="SetSheetNames",e.SetLangConfig="SetLangConfig"}(j||(j={})),t.EvalOnClonePropsFromPartialWB=class{constructor(e,t){this.formatResults=t,this.resultsPromise=new O.ResolvablePromise,this.stateId=-1,this.cloneLazy=new _.ResettableLazy((()=>e.createSnapshotSync()))}},t.EvalOnClonePropsFromPartialWBDocumentCollection=class{constructor(e,t){this.formatResults=t,this.resultsPromise=new O.ResolvablePromise,this.stateId=-1,this.cloneLazy=new _.ResettableLazy((()=>e.clone(S.voidCallback,h.CloningTarget.Client)))}},function(e){e[e.ServerUpdate=0]="ServerUpdate",e[e.ClientEdit=1]="ClientEdit",e[e.EvalFormula=2]="EvalFormula",e[e.BeforeCompute=3]="BeforeCompute",e[e.ComputeCellValue=4]="ComputeCellValue",e[e.AfterCompute=5]="AfterCompute",e[e.ComputeEvalOnClone=6]="ComputeEvalOnClone",e[e.ComputeEvalFormula=7]="ComputeEvalFormula",e[e.RecalcFinished=8]="RecalcFinished",e[e.CompleteDataQuery=9]="CompleteDataQuery",e[e.MaybeCollectGarbage=10]="MaybeCollectGarbage",e[e.RunExperiment=11]="RunExperiment",e[e.TestAdvanceState=12]="TestAdvanceState"}(H||(H={}));class q{reconfigure(e){this.config=e,this.rng=new v.JSF32(void 0!==e.rngSeed?e.rngSeed:0),this.docs.reconfigure(e,e,e.maxDereferenceCells??U,e.isServerWorkbookLoad??!1)}getDocs(){return this.docs}setWorksheetFuncOverrides(e){this.docs.setWorksheetFuncOverrides(e)}onNameFailure(e,t,r){r.computeKind!==d.ComputeKind.EvalFormula&&this.outputMessageLog.push({kind:d.OutputMessageKind.NameFailure,stateId:this.stateId,name:e,reason:t})}onRangeFailure(e,t,r,n,a){a.computeKind!==d.ComputeKind.EvalFormula&&this.outputMessageLog.push({kind:d.OutputMessageKind.RangeFailure,stateId:this.stateId,cellKind:n,range:e,reason:t})}onNumberFormatFailure(e){this.outputMessageLog.push({kind:d.OutputMessageKind.NumberFormatFailure,stateId:this.stateId,reason:e})}onInferFormatFailure(e,t){this.outputMessageLog.push({kind:d.OutputMessageKind.InferFormatFailure,stateId:this.stateId,range:e,reason:t})}onUnavailableObject(e){const t=(0,s.unavailable)([e]);this.onUnavailable(t)}onUnavailable(e){this.outputMessageLog.push({kind:d.OutputMessageKind.UnhandledFailure,stateId:this.stateId,reason:e})}onSetCellValue(e,t,r,n,a){if(a.computeKind===d.ComputeKind.EvalFormula)return;const i=this.outputCell(e,t,n,this.printFormulaProperties);void 0!==i?(this.outputMessageLog.push({kind:d.OutputMessageKind.RecalcStatistics,message:d.RecalcStatisticsMessage.ChangedCell,stateId:this.stateId,cellKind:n}),n!==d.ComputedCellKind.EditedCell&&n!==d.ComputedCellKind.DependentCell||this.outputMessageLog.push({kind:d.OutputMessageKind.CellWrite,stateId:this.stateId,cellKind:n,cell:e,...i,formatted:this.formatValue(n,e,t)})):this.outputMessageLog.push({kind:d.OutputMessageKind.RecalcStatistics,message:d.RecalcStatisticsMessage.UnchangedCell,stateId:this.stateId,cellKind:n})}onSetCellValues(e,t,r,n,a){if(a.computeKind===d.ComputeKind.EvalFormula)return;const i=this.outputRange(e,t,n);void 0!==i&&(n!==d.ComputedCellKind.EditedCell&&n!==d.ComputedCellKind.DependentCell||this.outputMessageLog.push({kind:d.OutputMessageKind.RangeWrite,stateId:this.stateId,cellKind:n,range:e,...i,formatted:t.map(((t,r)=>t.map(((t,a)=>this.formatValue(n,(0,u.sheetGridCell)(e.sheet,(0,u.gridCell)(e.range.row+r,e.range.col+a)),t)))))}))}onReturnCellValue(e,t,r){const n=this.outputCell(e,t,r,(()=>this.printValueProperties(e,t)));void 0!==n?(this.outputMessageLog.push({kind:d.OutputMessageKind.RecalcStatistics,message:d.RecalcStatisticsMessage.ChangedCell,stateId:this.stateId,cellKind:d.ComputedCellKind.EditedCell}),r===d.ComputedCellKind.EditedCell&&this.outputMessageLog.push({kind:d.OutputMessageKind.CellWrite,stateId:this.stateId,cellKind:d.ComputedCellKind.EditedCell,cell:e,...n,formatted:this.formatValue(r,e,t)})):this.outputMessageLog.push({kind:d.OutputMessageKind.RecalcStatistics,message:d.RecalcStatisticsMessage.UnchangedCell,stateId:this.stateId,cellKind:d.ComputedCellKind.EditedCell})}createSnapshot(e,t=h.CloningTarget.Client){return new Promise((r=>{this.scheduler.addTask(H.CompleteDataQuery,A.QueuePos.Back,{onRun:()=>{let n=!1;const a=this.docs.clone(S.voidCallback,t);void 0!==this.latestSnapshot&&-1!==this.latestSnapshotID&&this.latestSnapshot.compareVersion(a)||(n=!0,this.latestSnapshot=a,this.latestSnapshotID=e),D.x10Logger.log({kind:"snapshotCreation",payload:n}),r({snapshot:this.latestSnapshot,correspondingId:this.latestSnapshotID})},onDeleted:()=>{r(void 0)}})}))}createSnapshotSync(e=h.CloningTarget.Client){return this.docs.clone(S.voidCallback,e)}outputCell(e,t,r,n){let a;if(r===d.ComputedCellKind.EditedCell||r===d.ComputedCellKind.DependentCell){const r=this.docs.testAndSetClientValue(e,t);a=(0,T.isSuccess)(r)?r.value?t:void 0:void this.onUnavailableObject(r.reason)}const i=this.outputFormat(e,r),o=this.outputFormulaProperties(e,r,n);return void 0!==a||void 0!==i||void 0!==o?{value:t,format:i,formulaBarText:o?.formulaBarText,hasHyperlink:o?.hasHyperlink}:void 0}outputRange(e,t,r){if(r===d.ComputedCellKind.EditedCell||r===d.ComputedCellKind.DependentCell){const r=this.docs.setClientValue(e,t);(0,T.isSuccess)(r)||this.onUnavailableObject(r.reason)}const n=t.map(((t,n)=>t.map(((t,a)=>this.outputFormat((0,u.sheetGridCell)(e.sheet,(0,u.gridCell)(e.range.row+n,e.range.col+a)),r))))),a=this.outputFormulaProperties(e,r,this.printFormulaProperties);return{values:t,formats:n,formulaBarText:a?.formulaBarText}}outputFormat(e,t){if(t!==d.ComputedCellKind.EditedCell)return;const r=this.docs.getEditedFormat(e);if(!(0,T.isSuccess)(r))return void this.onUnavailableObject(r.reason);const n=this.docs.testAndSetClientFormat(e,r.value);if(!(0,T.isSuccess)(n))return void this.onUnavailableObject(n.reason);if(!n.value)return;const a=r.value;if(a===d.SpecialFormat.Unavailable)return{format:(0,s.unavailable)([{kind:d.UnavailableKind.CellFormat}]),valueType:E.FormatValueType.Custom,decimals:0};const i=this.docs.resolveCellFormat(e.sheet.document,a);return(0,T.isSuccess)(i)?{format:"number"==typeof a?a:a.formatString,valueType:i.value.valueType,decimals:i.value.decimals}:void 0}outputFormulaProperties(e,t,r){if(t!==d.ComputedCellKind.EditedCell)return;const n=r(e);if(void 0===n)return;const{formulaBarText:a,hasHyperlink:i,isFormula:o}=n,s=this.docs.testAndSetClientFormula(e,a,i);if(!(0,T.isSuccess)(s))return void this.onUnavailableObject(s.reason);const{hasFmlaChanged:u,hasHyperlinkChanged:l}=s.value;return u||l?{formulaBarText:u?a:void 0,hasHyperlink:l?i:void 0,isFormula:o}:void 0}formatValue(e,t,r,n){const a=n??this.docs,i=a.formatValueCell(t,r);if((0,T.isSuccess)(i))return i.value;a===this.docs&&this.outputMessageLog.push({kind:d.OutputMessageKind.FormatValueFailure,stateId:this.stateId,cellKind:e,range:t,reason:i.reason})}getAvailableFormula(e){const t=this.docs.getEditedFormula(e);if(!(0,T.isSuccess)(t))return t;if(void 0===t.value)return(0,T.failure)({kind:d.UnavailableKind.CellMissingFormula});const[r,n]=t.value;if(void 0===n.compiledFmla)return(0,T.failure)({kind:d.UnavailableKind.CellEvaluatingValue});const a=(0,u.lexicalSourceGrid)(n.lexicalKind,(0,u.sheetGridRange)(e.sheet,r));return(0,T.success)([a,n])}formulaHasHyperlink(e){if(e.lexicalKind!==u.LexicalKind.Cell)return!1;const t=e?.compiledFmla.getValue();return(0,T.isSuccess)(t)?(0,k.reduceBottomUp)(V,t.value):void 0}handleSetCellContents(e,t,r,n,a,i,o,l,c,m,h){let p,f,S,v=void 0!==c?(0,s.unavailable)([{kind:d.UnavailableKind.ClientFailure,reason:c}]):void 0,F=o;void 0!==n?(p=n,(0,g.assertTrue)("calc.calc.PartialWorkbook.handleSetCellContents: formula edit",void 0!==a),f=a):void 0===r?((0,g.assertTrue)("calc.calc.PartialWorkbook.handleSetCellContents: format edit",!e&&void 0===a&&void 0!==o&&void 0===v),p=!1,f=void 0):((0,g.assertTrue)("calc.calc.PartialWorkbook.handleSetCellContents: inferred edit",!e&&void 0===v&&F===d.SpecialFormat.Weak),({isFormula:p,oper:f,cellFailure:v,cellFormat:F,inferredFormat:S}=this.parseInferredEdit(t,r,i,v,F,h)));const y=void 0!==h?h.cloneLazy.getValue():this.docs,C=y.setCellContents(e,t,r,p,i,f,v,F,l,m);if(C.kind===T.ResultKind.Failure)return this.onUnavailableObject(C.reason);if(y.onCellModified(e),!e){const e=(0,u.sheetGridCell)(t.sheet,i);let n=void 0===r?(0,T.success)(void 0):p?y.inferFormulaFormat(e):void 0!==S&&S!==b.KnownFormat.General?y.resolveValueFormat(t.sheet.document,S):(0,T.success)(void 0);n.kind!==T.ResultKind.Success&&(this.onInferFormatFailure(e,n.reason),n=(0,T.success)(d.SpecialFormat.Unavailable)),void 0!==n.value&&y.fillInferredFormat(t,n.value),void 0!==h?(h.stateId=this.stateId,this.enqueueEvalFormulaComputeCellValuesOnDocs(t,y,h)):this.enqueueBeforeCompute(m)}}parseInferredEdit(e,t,r,n,a,i){const o=i?i.cloneLazy.getValue().parseInferredEdit((0,u.sheetGridCell)(e.sheet,r),t,this.getVolatileMode()):this.docs.parseInferredEdit((0,u.sheetGridCell)(e.sheet,r),t,this.getVolatileMode());if(!(0,T.isSuccess)(o))return{isFormula:!1,oper:l.blankOper,cellFailure:o.reason,cellFormat:d.SpecialFormat.Unavailable};const s=t.length>0?t.charAt(0):"";switch("="!==s&&"+"!==s&&"-"!==s||o.value.kind!==E.EditKind.Formula&&o.value.kind!==E.EditKind.Number||g.ulsLogger.ULS.dnmTraceTag(541189698,C.LogCategory.msoulscat_ES_EWAJS,C.TraceLevel.Info,JSON.stringify({startChar:s,editKind:String(o.value.kind)})),o.value.kind){case E.EditKind.Formula:return{isFormula:!0,oper:l.blankOper,cellFailure:n,cellFormat:a};case E.EditKind.String:case E.EditKind.Other:return{isFormula:!1,oper:o.value.value,cellFailure:n,cellFormat:a};case E.EditKind.Number:return{isFormula:!1,oper:o.value.value,cellFailure:n,cellFormat:a,inferredFormat:o.value.format}}}handleSetRangeFormula(e,t,r,n,a){const i=(0,p.isFormulaText)(r);(0,g.assertTrue)("calc.calc.PartialWorkbook: handleSetRangeFormula",""===r&&!e||i);const o=e?void 0:l.blankOper,s=e?void 0:d.SpecialFormat.Weak,u=e?void 0:d.SpecialStyle.Weak,c=this.docs.setRangeFormula(e,t,r,n,o,s,u,a);if(c.kind===T.ResultKind.Failure)return this.onUnavailableObject(c.reason);this.docs.onCellModified(e),e||this.enqueueBeforeCompute(a)}handleEditPaste(e,t,r,n){const a=(0,u.sheetGridRange)(t.sheet,(0,u.gridRange)(t.range.row,t.range.col,r.range.rows,r.range.cols)),i=this.docs.copyRange(r);if(i.kind===T.ResultKind.Failure)return this.onUnavailableObject(i.reason);const o=this.docs.pasteRange(a,i.value);if(o.kind===T.ResultKind.Failure)return this.onUnavailableObject(o.reason);this.docs.onCellModified(!1),this.enqueueBeforeCompute(n)}handleAssumeRecalcFinal(e){this.scheduler.getCount(H.BeforeCompute)<0||this.scheduler.addTask(H.ComputeCellValue,A.QueuePos.Front,(()=>{const t=this.docs.assumeRecalcFinal(e);if(t.kind===T.ResultKind.Failure)return this.onUnavailableObject(t.reason)}))}evalFormula(e,t,r,n,a){return new Promise((o=>{const s=()=>o({value:(0,T.failure)(i.stopped)});this.scheduler.deleteTasks(H.EvalFormula,void 0),this.scheduler.addTask(H.EvalFormula,A.QueuePos.Back,{onRun:()=>{if(!a&&!this.trySetStateId(H.EvalFormula,e))return s();this.enqueueComputeEvalFormula(t,r,n,a,o)},onDeleted:s}),this.enqueueRecalcFinished()}))}enqueueBeforeCompute(e){this.scheduler.deleteTasks(H.BeforeCompute,void 0),this.scheduler.addTask(H.BeforeCompute,A.QueuePos.Back,(()=>{this.enqueueAfterCompute(),this.restrictToViewport(this.docs.getNonDirtyEditedCells(),e,d.ComputeKind.EditedCell,this.scheduleAvailableValues),this.restrictToViewport(this.docs.getDirtyEditedCells(),e,d.ComputeKind.EditedCell,this.scheduleAvailableFormulas),this.restrictToViewport(this.docs.getDirtyDependentCells(),e,d.ComputeKind.DependentCell,this.scheduleAvailableFormulas)}))}withEvalTiming(e){const t=this.docs.schedulerConfig.totalTimeMs;if(void 0===t)return e();const r=(0,f.now)();let n;try{n=e()}finally{this.stateEvalTime+=(0,f.fastMax)(1,(0,f.now)()-r),this.stateEvalTime>=t&&(this.deleteComputeTasks(j.EvalTimedOut),this.outputMessageLog.push({kind:d.OutputMessageKind.RecalcStatistics,stateId:this.stateId,message:d.RecalcStatisticsMessage.StateTimedOut}),n=[])}return n}enqueueEvalFormulaComputeCellValuesOnDocs(e,t,r){const l=[];(0,m.forEachCellInSet)(e.set,(t=>(l.push((0,u.sheetGridCell)(e.sheet,t)),!0)));let c=(0,w.makeGridRangeTable)();const h=(t,r,n)=>{(0,s.isSheetIndexEqual)(t.sheet,e.sheet)&&(0,F.meetsProduct)(e.set,(0,m.createCellSetFromRange)(t.range))&&(0,o.forEachCellInRange)(t.range,(e=>(c=c.setValue(e,r),!0)))};let p=()=>t.evaluate(d.ComputeKind.EvalFormula,l,this.getVolatileMode(),h);const S={onRun:()=>{const e=this.withEvalTiming(p);if(Array.isArray(e)){const i=e.map(((e,i)=>{const o=l[i].range;if(!(0,T.isSuccess)(e)){if(e.reason.kind===a.ReasonKind.Stopped)return B(o,e.reason);const t=(0,s.unavailable)([{kind:d.UnavailableKind.EvalFailure,reason:e.reason}]);return this.onUnavailable(t),B(o,t)}const u=t.getCellValue(l[i]);if(!(0,T.isSuccess)(u))return B(o,c.getValue(o)??u.reason);try{(0,g.assertTrue)("calc.calc.PartialWorkbook: FinalValue after evalCell",u.value.kind===n.CellKind.FinalValue)}catch(e){const t=(0,s.unavailable)([{kind:d.UnavailableKind.EvalFailure,reason:(0,R.javaScriptError)(e)}]);return this.onUnavailable(t),B(o,t)}const m=u.value.oper;if(!0===r.formatResults){const e=this.formatValue(d.ComputedCellKind.EditedCell,l[i],m,t);return(0,T.success)({cell:o,value:m,formatted:e})}return!1===r.formatResults?(0,T.success)({cell:o,value:m,formatted:void 0}):(0,T.success)((0,f.pair)(l[i].range,m))}));r.resultsPromise.resolve({stateId:r.stateId,results:i})}else p=e.resume,this.scheduler.addTask(H.ComputeEvalOnClone,A.QueuePos.Front,S)},onDeleted:()=>r.resultsPromise.resolve({stateId:r.stateId,results:(0,M.arrayFill)(new Array(l.length),(0,T.failure)(i.stopped))})};this.scheduler.addTask(H.ComputeEvalOnClone,A.QueuePos.Front,S)}enqueueComputeCellValue(e,t){const r=t===d.ComputeKind.EditedCell&&this.shouldSample(this.config.sampleRecalcEditedStopwatchRate)?(0,y.ulsStopwatchFactory)("calc.calc.PartialWorkbook: recalc edited"):void 0;let n,i=!0,o=()=>this.docs.evaluate(t,[e],this.getVolatileMode());const s=()=>{if(i){i=!1,n=this.shouldSample(this.config.sampleCellEvalStopwatchRate)?(0,y.ulsStopwatchFactory)("calc.calc.PartialWorkbook: cell eval"):void 0;const t=this.docs.getEditedFormula(e);if(!(0,T.isSuccess)(t))return this.onUnavailableObject(t.reason);if(void 0===t.value)return}else this.outputMessageLog.push({kind:d.OutputMessageKind.RecalcStatistics,stateId:this.stateId,message:d.RecalcStatisticsMessage.ContinueComputation});const t=this.withEvalTiming(o);if(Array.isArray(t)){n?.stop(),r?.stop();for(const e of t)(0,T.isSuccess)(e)||e.reason.kind===a.ReasonKind.Stopped||this.onUnavailableObject({kind:d.UnavailableKind.EvalFailure,reason:e.reason})}else o=t.resume,this.scheduler.addTask(H.ComputeCellValue,A.QueuePos.Front,s)};this.scheduler.addTask(H.ComputeCellValue,A.QueuePos.Back,s)}enqueueComputeEvalFormula(e,t,r,n=this.docs,a){const o=this.getVolatileMode();let s=()=>n.evalFormula(e,t,r,o);const u={onRun:()=>{const e=s();e.kind===T.ResultKind.Paused||e.kind===T.ResultKind.Breaked?(s=e.resume,this.scheduler.addTask(H.ComputeEvalFormula,A.QueuePos.Front,u)):a(e.value)},onDeleted:()=>a({value:(0,T.failure)(i.stopped)})};this.scheduler.addTask(H.ComputeEvalFormula,A.QueuePos.Back,u)}enqueueReturnCellValue(e,t){const r=this.getVolatileMode();this.scheduler.addTask(H.ComputeCellValue,A.QueuePos.Back,(()=>{this.docs.evalValue(e,t,r)}))}enqueueAfterCompute(){this.scheduler.deleteTasks(H.AfterCompute,j.EditReceived);const e=this.shouldSample(this.config.sampleRecalcViewportStopwatchRate)?(0,y.ulsStopwatchFactory)("calc.calc.PartialWorkbook: recalc viewport"):void 0;this.scheduler.addTask(H.AfterCompute,A.QueuePos.Back,{onRun:()=>{e?.stop(j.EvalFinished),this.outputMessageLog.push({kind:d.OutputMessageKind.RecalcStatistics,message:d.RecalcStatisticsMessage.EditFinished,stateId:this.stateId})},onDeleted:t=>{e?.stop(t)}})}enqueueRecalcFinished(){this.scheduler.deleteTasks(H.RecalcFinished,void 0),this.scheduler.addTask(H.RecalcFinished,A.QueuePos.Back,(()=>{this.outputMessageLog.push({kind:d.OutputMessageKind.RecalcStatistics,message:d.RecalcStatisticsMessage.RecalcFinished,stateId:this.stateId})}))}promoteCellContents(e,t,r,n){this.scheduler.addTask(H.ServerUpdate,A.QueuePos.Back,(()=>{if(!this.trySetStateId(H.ServerUpdate,e))return;const a=this.docs.promoteServerAvailability(r,n);if(a.kind===T.ResultKind.Failure)return this.onUnavailableObject(a.reason);this.docs.onCellModified(!0),a.value||this.outputMessageLog.push({kind:d.OutputMessageKind.UpdateRequest,stateId:this.stateId,range:t})}))}writeCellContents(e,t,r,n,a,i,o,s,u,l){this.scheduler.addTask(H.ServerUpdate,A.QueuePos.Back,(()=>{(l||this.trySetStateId(H.ServerUpdate,e))&&this.handleSetCellContents(!0,t,r,n,i,a,o,s,u,void 0,l)}))}editCellContents(e,t,r,n,a,i=l.blankOper,o=(0,u.sheetGridRange)(t.sheet,G),s){this.lastViewport=o,this.scheduler.addTask(H.ClientEdit,A.QueuePos.Back,(()=>{this.trySetStateId(H.ClientEdit,e)&&this.handleSetCellContents(!1,t,r,n,i,a,d.SpecialFormat.Weak,d.SpecialStyle.Weak,void 0,o,s)})),this.enqueueRecalcFinished()}editCellContentsOnClone(e,t,r,n,a){this.editCellContents(this.stateId,e,t,r,n,void 0,void 0,a)}editCellFormats(e,t,r,n,a=(0,u.sheetGridRange)(t.sheet,G)){this.lastViewport=a,this.scheduler.addTask(H.ClientEdit,A.QueuePos.Back,(()=>{if(!this.trySetStateId(H.ClientEdit,e))return;const i="SetFormat"===r.kind?this.docs.resolveEditFormat(t.sheet.document,r.format):"RibbonFormat"===r.kind?this.docs.resolveRibbonFormat(t.sheet.document,r.ribbon,(0,u.sheetGridCell)(t.sheet,n)):"ChangeDecimals"===r.kind?this.docs.resolveChangeDecimals(t.sheet.document,r.changeDecimals,(0,u.sheetGridCell)(t.sheet,n)):(0,g.assertNever)("calc.calc.PartialWorkbook: editCellFormats",r);(0,T.isSuccess)(i)||(0,m.forEachRangeInSet)(t.set,(e=>(this.onInferFormatFailure((0,u.sheetGridRange)(t.sheet,e),i.reason),!0))),(0,T.isSuccess)(i)&&void 0===i.value||this.handleSetCellContents(!1,t,void 0,void 0,void 0,(0,u.gridCell)(0,0),(0,T.isSuccess)(i)?i.value:d.SpecialFormat.Unavailable,void 0,void 0,a)})),this.enqueueRecalcFinished()}writeArrayFormula(e,t,r,n=(0,s.gridRangeAnchor)(t.range),a=!1){this.scheduler.addTask(H.ServerUpdate,A.QueuePos.Back,(()=>{this.trySetStateId(H.ServerUpdate,e)&&this.handleSetRangeFormula(!0,t,r,n,void 0)}))}editArrayFormula(e,t,r,n=(0,s.gridRangeAnchor)(t.range),a=(0,u.sheetGridRange)(t.sheet,G)){this.lastViewport=a,this.scheduler.addTask(H.ClientEdit,A.QueuePos.Back,(()=>{this.trySetStateId(H.ClientEdit,e)&&this.handleSetRangeFormula(!1,t,r,n,a)})),this.enqueueRecalcFinished()}editPaste(e,t,r,n,a=(0,u.sheetGridRange)(r.sheet,G)){this.scheduler.addTask(H.ClientEdit,A.QueuePos.Back,(()=>{this.trySetStateId(H.ClientEdit,e)&&this.handleEditPaste(t,r,n,a)})),this.enqueueRecalcFinished()}assumeRecalcFinal(e,t){this.scheduler.addTask(H.ClientEdit,A.QueuePos.Back,(()=>{this.stateId===e&&this.handleAssumeRecalcFinal(t)}))}testAdvanceState(e){this.scheduler.addTask(H.TestAdvanceState,A.QueuePos.Back,(()=>{this.trySetStateId(H.TestAdvanceState,e)}))}step(){if(!this.scheduler.runTask())return{queueEmpty:!0,messages:[]};const e=this.outputMessageLog;return this.outputMessageLog=[],{queueEmpty:!1,messages:e}}trySetStateId(e,t){if(t<this.stateId)return!1;if(e===H.ClientEdit&&(this.deleteComputeTasks(j.EditReceived),this.stateEvalTime=0),t>this.stateId){if(this.stateId!==-1/0){const e=this.config.sampleWorkbookStatisticsRate;void 0!==e&&this.shouldSample(e)&&this.outputMessageLog.push({kind:d.OutputMessageKind.WorkbookStatistics,stateId:this.stateId,stats:this.getStatistics(),p:e})}const e=1;this.stateChanges===e&&this.enqueueRunExperiments(I.ExperimentKind.OneShot),this.stateChanges>=e&&0===this.scheduler.getCount(H.RunExperiment)&&this.enqueueRunExperiments(I.ExperimentKind.Recurring);const r=this.config.samplePrecisionEvalRate??0,n=this.config.samplePrecisionPrintFormulaRate??0,a=this.config.samplePrecisionPrintValueRate??0;if(this.stateChanges>=e&&(r>0||n>0||a>0)&&this.numPrecisionFailures<q.maxPrecisionFailures&&0===this.scheduler.getCount(H.RunExperiment)){const e=this.config.experimentFactories,t=e?.stepBudget??10,i=e?.totalBudget??1e4,o=new N.PrecisionExperiment({samplePrecisionEvalRate:r,samplePrecisionPrintFormulaRate:n,samplePrecisionPrintValueRate:a}),s={stateId:this.stateId,documents:this.docs.clone(o),stepBudget:t,totalBudget:i,viewport:this.lastViewport};o.setContext(s),this.enqueueRunExperiment("PrecisionExperiment",t,i,I.ExperimentKind.Precision,o,(()=>this.numPrecisionFailures=0),(()=>this.numPrecisionFailures+=1))}this.deleteComputeTasks(j.StateIdAdvanced),this.lastViewport=void 0;const i=this.stateId;this.stateId=t,this.docs.advanceState(i),this.outputMessageLog.push({kind:d.OutputMessageKind.StateAdvanced,stateId:this.stateId}),this.stateEvalTime=0,this.stateChangesSinceLastGC+=1,this.stateChanges+=1,this.enqueueMaybeCollectGarbage()}return!0}deleteComputeTasks(e){this.scheduler.deleteTasks(H.BeforeCompute,void 0),this.scheduler.deleteTasks(H.ComputeCellValue,void 0),this.scheduler.deleteTasks(H.AfterCompute,e),e!==j.EvalTimedOut&&this.scheduler.deleteTasks(H.ComputeEvalFormula,void 0)}enqueueRunExperiment(e,t,r,n,a,i,o){let s=0,u=0;const l=(t,r,i,o)=>{const s=a.failedLogMessage;void 0!==s&&this.outputMessageLog.push({experimentName:e,kind:d.OutputMessageKind.ExperimentRunResult,experimentKind:n,logMessage:s,timeoutReason:{budgetType:t,budget:r,elapsedTime:i,stepsCount:o}})},c=()=>{if(a.done){const t=a.resultLogMessage;return void 0!==t&&this.outputMessageLog.push({experimentName:e,kind:d.OutputMessageKind.ExperimentRunResult,experimentKind:n,logMessage:t}),void i()}const g=(0,f.now)();let m=g;for(let e=0;e<1e3&&m===g;e+=1){a.step(),u+=1;const e=(0,f.now)(),r=e-m;if(r>=t&&!a.done)return l("stepBudget",t,r,u),void o();m=e}if(s+=m>g?m-g:1,s>=r&&!a.done)return l("totalBudget",r,s,u),void o();this.scheduler.addTask(H.RunExperiment,A.QueuePos.Front,c)};this.scheduler.addTask(H.RunExperiment,A.QueuePos.Back,c)}enqueueRunExperiments(e){if(!this.config.experimentFactories)return;const{stepBudget:t,totalBudget:r,factories:n}=this.config.experimentFactories,a=n.filter((t=>t.kind===e&&(t.numFailures??0)<(t.maxFailures??3)));if(0===a.length)return;const i={stateId:this.stateId,documents:this.docs.clone(S.voidCallback,e===I.ExperimentKind.OneShot?h.CloningTarget.Server:h.CloningTarget.Client),stepBudget:t,totalBudget:r,viewport:this.lastViewport};for(const n of a){const a=n.create();a&&(a.setContext(i),this.enqueueRunExperiment(n.experimentName,n.stepBudget??t,r,e,a,(()=>n.numFailures=0),(()=>n.numFailures=(n.numFailures??0)+1)))}}setSheetNames(e,t,r){this.scheduler.addTask(H.ServerUpdate,A.QueuePos.Back,(()=>{if(!this.trySetStateId(H.ServerUpdate,r))return;const n=this.docs.setSheetNames(e,t);n.kind===T.ResultKind.Failure&&this.onUnavailableObject(n.reason),this.deleteComputeTasks(j.SetSheetNames)}))}setLangConfig(e,t){this.scheduler.addTask(H.ServerUpdate,A.QueuePos.Back,(()=>{if(!this.trySetStateId(H.ServerUpdate,e))return;const r=this.docs.config.localeInfo!==t.localeInfo,n=this.docs.config.refStyle!==t.refStyle;this.docs.setConfig(t),r&&this.docs.clearCompiledNumberFormats(),(r||n)&&(this.docs.clearCompiledFormulas(),this.deleteComputeTasks(j.SetLangConfig))}))}setNumberFormats(e,t,r,n){this.scheduler.addTask(H.ServerUpdate,A.QueuePos.Back,(()=>{if(!this.trySetStateId(H.ServerUpdate,n))return;const a=this.docs.setNumberFormats(e,t,r);return a.kind===T.ResultKind.Failure?this.onUnavailable(a.reason):void 0}))}writeNamedObject(e,t,r,n){this.scheduler.addTask(H.ServerUpdate,A.QueuePos.Back,(()=>{if(!this.trySetStateId(H.ServerUpdate,e))return;const a=this.docs.setNamedObject(!0,(0,u.nameLoc)(t,r),n);return a.kind===T.ResultKind.Failure?this.onUnavailable(a.reason):void 0}))}writeUndefinedNames(e,t){this.scheduler.addTask(H.ServerUpdate,A.QueuePos.Back,(()=>{if(!this.trySetStateId(H.ServerUpdate,e))return;const r=this.docs.setUndefinedNames(t);return r.kind===T.ResultKind.Failure?this.onUnavailable(r.reason):void 0}))}promoteNamedObjects(e,t,r){this.scheduler.addTask(H.ServerUpdate,A.QueuePos.Back,(()=>{if(!this.trySetStateId(H.ServerUpdate,e))return;const n=this.docs.promoteNamedObjects(t,r);if(n.kind===T.ResultKind.Failure)return this.onUnavailable(n.reason);n.value||this.outputMessageLog.push({kind:d.OutputMessageKind.UpdateNamesRequest,stateId:this.stateId,scope:t})}))}extendUnusedRange(e,t){this.scheduler.addTask(H.ServerUpdate,A.QueuePos.Back,(()=>{if(!this.trySetStateId(H.ServerUpdate,t))return;const r=this.docs.extendServerUnused(e.sheet,e.range);if(r.kind===T.ResultKind.Failure)return this.onUnavailableObject(r.reason);this.docs.onCellModified(!0)}))}writeHiddenRows(e,t){this.scheduler.addTask(H.ServerUpdate,A.QueuePos.Back,(()=>{if(!this.trySetStateId(H.ServerUpdate,e))return;const r=this.docs.writeHiddenRows(t.sheet,t.range,t.hidden);return r.kind===T.ResultKind.Failure?this.onUnavailableObject(r.reason):void 0}))}writeHiddenCols(e,t){this.scheduler.addTask(H.ServerUpdate,A.QueuePos.Back,(()=>{if(!this.trySetStateId(H.ServerUpdate,e))return;const r=this.docs.writeHiddenCols(t.sheet,t.range,t.hidden);return r.kind===T.ResultKind.Failure?this.onUnavailableObject(r.reason):void 0}))}writeInFilterMode(e,t){this.scheduler.addTask(H.ServerUpdate,A.QueuePos.Back,(()=>{if(!this.trySetStateId(H.ServerUpdate,e))return;const r=this.docs.writeInFilterMode(t.sheet,t.inFilterMode);return r.kind===T.ResultKind.Failure?this.onUnavailableObject(r.reason):void 0}))}getStatistics(){return{queueSize:this.scheduler.getCount(),totalGridStatistics:this.docs.getGridStatistics(),totalNameStatistics:this.docs.getNameStatistics()}}enqueueMaybeCollectGarbage(){this.scheduler.deleteTasks(H.MaybeCollectGarbage,void 0),this.scheduler.addTask(H.MaybeCollectGarbage,A.QueuePos.Back,(()=>{if(this.stateChangesSinceLastGC<t.MaxStateIdDifferenceForGC)return;const e=this.stateId-t.MaxStateIdDifferenceForGC;this.docs.collectGarbage(e),this.outputMessageLog.push({kind:d.OutputMessageKind.GarbageCollected,minStateIdKept:e}),this.stateChangesSinceLastGC=0}))}shouldSample(e){return void 0!==e&&this.rng.next()<=e}translateEnglishFormula(e,t){const r=this.englishParser.parseFormula((0,x.parseLocals)(u.LexicalKind.Cell,t.range),e);if(!(0,T.isSuccess)(r))return r;const a=this.englishAnalyzer.checkFormula((0,W.analyzeLocalsGrid)(u.LexicalKind.Cell,(0,u.sheetGridCell)(t.sheet,t.range)),r.value);if(!(0,T.isSuccess)(a))return a;if(!(0,o.isWellFormed)(a.value))return(0,T.failure)((0,n.illFormedFormula)("ill-formed formula"));const i=this.docs.printFormulaBarText((0,u.lexicalSourceGrid)(u.LexicalKind.Cell,t),t.range,a.value);return(0,T.isSuccess)(i)?(0,T.success)(i.value):i}restrictToViewport(e,t,r,n){if(void 0!==t){const{sheet:a,range:i}=t,o=(0,m.createCellSetFromRange)(i);for(const t of e)(0,s.isSheetIndexEqual)(a,t.sheet)&&n((0,d.sheetCellSet)(a,(0,F.intersectProduct)(t.set,o)),r)}else for(const t of e)n(t,r)}getVolatileMode(){return this.config.volatileMode??_.VolatileMode.Estimation}constructor(e,t={}){this.scheduler=new A.PriorityScheduler,this.englishParser=(0,L.createParser)((0,x.createParseGlobals)(P.initialRecalcServiceConfig)),this.englishAnalyzer=(0,K.createAnalyzer)((0,W.createAnalyzeGlobals)(P.initialRecalcServiceConfig)),this.outputMessageLog=[],this.stateId=-1/0,this.stateChangesSinceLastGC=0,this.stateChanges=0,this.stateEvalTime=0,this.latestSnapshotID=-1,this.numPrecisionFailures=0,this.printFormulaProperties=e=>{const t=(0,s.sheetGridRangeAnchor)(e),r=this.getAvailableFormula(t);if(!(0,T.isSuccess)(r))return void this.onUnavailableObject(r.reason);const[n,a]=r.value,i=a.compiledFmla.getValue(),o=(0,T.isSuccess)(i)?this.docs.printFormulaBarText(n,t.range,i.value):i;return{formulaBarText:o.kind===T.ResultKind.Success?o.value:void this.outputMessageLog.push({kind:d.OutputMessageKind.PrintFormulaFailure,stateId:this.stateId,range:e,reason:o.reason}),hasHyperlink:this.formulaHasHyperlink(a),isFormula:!0}},this.printValueProperties=(e,t)=>{const r=this.docs.getEditedFormula(e);if(!(0,T.isSuccess)(r))return void this.onUnavailableObject(r.reason);const n=r.value?.[1].fmla??"",a=this.docs.renderValueBarText(e,t,n);return{formulaBarText:(0,T.isSuccess)(a)?a.value:void this.outputMessageLog.push({kind:d.OutputMessageKind.PrintFormulaFailure,stateId:this.stateId,range:e,reason:a.reason}),hasHyperlink:!1,isFormula:!1}},this.scheduleAvailableFormulas=(e,t)=>{const r=this.docs.forEachEditedNonBlankCellInSet(e.sheet,e.set,(r=>{const n=(0,u.sheetGridCell)(e.sheet,r),a=this.docs.getEditedFormula(n);return a.kind===T.ResultKind.Failure?(this.onUnavailableObject(a.reason),!0):(void 0!==a.value&&void 0!==a.value[1].compiledFmla&&this.enqueueComputeCellValue(n,t),!0)}));(0,T.isSuccess)(r)||this.onUnavailableObject(r.reason)},this.scheduleAvailableValues=(e,t)=>{const r=this.docs.forEachEditedCellInSet(e.sheet,e.set,(r=>{const n=(0,u.sheetGridCell)(e.sheet,r),a=this.docs.getEditedFormula(n);return a.kind===T.ResultKind.Failure?(this.onUnavailableObject(a.reason),!0):(void 0!==a.value&&void 0!==a.value[1].compiledFmla||this.enqueueReturnCellValue(n,t),!0)}));(0,T.isSuccess)(r)||this.onUnavailableObject(r.reason)},this.docs=new S.PartialWorkbookDocumentCollection(e,this,t,t,t.maxDereferenceCells??U,t.isServerWorkbookLoad??!1),this.reconfigure(t)}}t.PartialWorkbook=q,q.maxPrecisionFailures=3},73812:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPartialWorkbook=t.blankStyle=t.genFmt=t.knownFormatData=t.kfToIformat=t.englishLocaleData=t.defaultConfig=t.mathpack=t.locale=t.createRange=t.assertMessageOrder=void 0;const n=r(41739),a=r(73701),i=r(14009),o=r(60140),s=r(57786),u=r(84288),l=r(53111),c=r(57993),d=r(12973),g=r(99598),m=r(13168),h=r(36159),p=r(78468),f=r(91304),S=r(90437),v=r(3028);var F;!function(e){e.EditedPhase="EditedPhase",e.DependentPhase="DependentPhase",e.StatisticsPhase="StatisticsPhase",e.Finished="Finished"}(F||(F={}));const y={kind:F.EditedPhase,stateId:-1/0},C=Object.getOwnPropertyNames(n.OutputMessageKind);function A(e,t){const r={};return e.forEach((e=>r[e]=t)),r}const E={[F.EditedPhase]:{[n.OutputMessageKind.StateAdvanced]:()=>F.EditedPhase,[n.OutputMessageKind.RecalcStatistics]:(e,t)=>{if(t.message===n.RecalcStatisticsMessage.ChangedCell){if(t.cellKind===n.ComputedCellKind.EditedCell)return F.EditedPhase;if(t.cellKind===n.ComputedCellKind.DependentCell)return F.DependentPhase;if(t.cellKind===n.ComputedCellKind.IndependentCell)return F.EditedPhase;if(t.cellKind===n.ComputedCellKind.UnknownNonEditedCell)return e(`a different message.cellKind than ${t.cellKind}`);(0,a.assertNever)("calc.calc.partialWorkbook.testutilsutils.transitions",t.cellKind)}if(t.message===n.RecalcStatisticsMessage.UnchangedCell){if(t.cellKind===n.ComputedCellKind.EditedCell)return F.EditedPhase;if(t.cellKind===n.ComputedCellKind.DependentCell)return F.DependentPhase;if(t.cellKind===n.ComputedCellKind.IndependentCell)return F.EditedPhase;if(t.cellKind===n.ComputedCellKind.UnknownNonEditedCell)return e(`a different message.cellKind than ${t.cellKind}`);(0,a.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.cellKind)}return t.message===n.RecalcStatisticsMessage.ContinueComputation?F.EditedPhase:t.message===n.RecalcStatisticsMessage.EditFinished||t.message===n.RecalcStatisticsMessage.StateTimedOut?F.StatisticsPhase:t.message===n.RecalcStatisticsMessage.RecalcFinished?F.Finished:void(0,a.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.message)},...A([n.OutputMessageKind.CellWrite,n.OutputMessageKind.RangeWrite],((e,t)=>t.cellKind===n.ComputedCellKind.EditedCell?F.EditedPhase:t.cellKind===n.ComputedCellKind.DependentCell?F.DependentPhase:void(0,a.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.cellKind))),[n.OutputMessageKind.RangeFailure]:(e,t)=>t.cellKind===n.ComputedCellKind.EditedCell?F.EditedPhase:t.cellKind===n.ComputedCellKind.DependentCell?F.DependentPhase:t.cellKind===n.ComputedCellKind.IndependentCell?F.EditedPhase:t.cellKind===n.ComputedCellKind.UnknownNonEditedCell?F.DependentPhase:void(0,a.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.cellKind),[n.OutputMessageKind.PrintFormulaFailure]:()=>F.EditedPhase,[n.OutputMessageKind.InferFormatFailure]:()=>F.EditedPhase,[n.OutputMessageKind.FormatValueFailure]:()=>F.EditedPhase,...A([n.OutputMessageKind.GarbageCollected,n.OutputMessageKind.Alert,n.OutputMessageKind.ExperimentRunResult,n.OutputMessageKind.UpdateRequest,n.OutputMessageKind.WorkbookStatistics,n.OutputMessageKind.UnhandledFailure,n.OutputMessageKind.NumberFormatFailure,n.OutputMessageKind.NameFailure,n.OutputMessageKind.UpdateNamesRequest],(()=>F.EditedPhase))},[F.DependentPhase]:{[n.OutputMessageKind.RecalcStatistics]:(e,t)=>{if(t.message===n.RecalcStatisticsMessage.ChangedCell){if(t.cellKind===n.ComputedCellKind.EditedCell)return e(`a different cellKind than ${t.cellKind}`);if(t.cellKind===n.ComputedCellKind.DependentCell)return F.DependentPhase;if(t.cellKind===n.ComputedCellKind.IndependentCell)return F.DependentPhase;if(t.cellKind===n.ComputedCellKind.UnknownNonEditedCell)return e(`a different cellKind than ${t.cellKind}`);(0,a.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.cellKind)}if(t.message===n.RecalcStatisticsMessage.UnchangedCell){if(t.cellKind===n.ComputedCellKind.EditedCell)return e(`a different cellKind than ${t.cellKind}`);if(t.cellKind===n.ComputedCellKind.DependentCell)return F.DependentPhase;if(t.cellKind===n.ComputedCellKind.IndependentCell)return F.DependentPhase;if(t.cellKind===n.ComputedCellKind.UnknownNonEditedCell)return e(`a different cellKind than ${t.cellKind}`);(0,a.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.cellKind)}return t.message===n.RecalcStatisticsMessage.ContinueComputation?e(`a different message.message than ${t.message}`):t.message===n.RecalcStatisticsMessage.EditFinished?F.StatisticsPhase:t.message===n.RecalcStatisticsMessage.StateTimedOut||t.message===n.RecalcStatisticsMessage.RecalcFinished?e(`a different message.message than ${t.message}`):void(0,a.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.message)},...A([n.OutputMessageKind.CellWrite,n.OutputMessageKind.RangeWrite],((e,t)=>t.cellKind===n.ComputedCellKind.EditedCell?e(`a different message.cellKind than ${t.cellKind}`):t.cellKind===n.ComputedCellKind.DependentCell?F.DependentPhase:void(0,a.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.cellKind))),[n.OutputMessageKind.RangeFailure]:(e,t)=>t.cellKind===n.ComputedCellKind.EditedCell?t.reason.kind===i.ReasonKind.CellCycle?F.DependentPhase:e(`the current state to be ${F.EditedPhase}, or ${F.DependentPhase} and failure ${i.ReasonKind.CellCycle}`):t.cellKind===n.ComputedCellKind.IndependentCell||t.cellKind===n.ComputedCellKind.DependentCell||t.cellKind===n.ComputedCellKind.UnknownNonEditedCell?F.DependentPhase:void(0,a.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.cellKind),[n.OutputMessageKind.FormatValueFailure]:()=>F.DependentPhase,...A([n.OutputMessageKind.GarbageCollected,n.OutputMessageKind.Alert,n.OutputMessageKind.ExperimentRunResult],((e,t)=>e(`a different message.kind than ${t.kind}`))),...A([n.OutputMessageKind.StateAdvanced,n.OutputMessageKind.UpdateRequest,n.OutputMessageKind.WorkbookStatistics,n.OutputMessageKind.UnhandledFailure,n.OutputMessageKind.NumberFormatFailure,n.OutputMessageKind.NameFailure,n.OutputMessageKind.PrintFormulaFailure,n.OutputMessageKind.InferFormatFailure,n.OutputMessageKind.UpdateNamesRequest],((e,t)=>e(`a different message.kind than ${t.kind}`)))},[F.StatisticsPhase]:{[n.OutputMessageKind.RecalcStatistics]:(e,t)=>t.message===n.RecalcStatisticsMessage.ChangedCell||t.message===n.RecalcStatisticsMessage.UnchangedCell||t.message===n.RecalcStatisticsMessage.ContinueComputation||t.message===n.RecalcStatisticsMessage.EditFinished||t.message===n.RecalcStatisticsMessage.StateTimedOut?e(`a different message.message than ${t.message}`):t.message===n.RecalcStatisticsMessage.RecalcFinished?F.Finished:void(0,a.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.message),...A([n.OutputMessageKind.GarbageCollected,n.OutputMessageKind.Alert,n.OutputMessageKind.ExperimentRunResult],((e,t)=>e(`a different message.kind than ${t.kind}`))),...A([n.OutputMessageKind.CellWrite,n.OutputMessageKind.RangeWrite,n.OutputMessageKind.RangeFailure,n.OutputMessageKind.PrintFormulaFailure,n.OutputMessageKind.InferFormatFailure,n.OutputMessageKind.FormatValueFailure,n.OutputMessageKind.StateAdvanced,n.OutputMessageKind.UpdateRequest,n.OutputMessageKind.WorkbookStatistics,n.OutputMessageKind.NumberFormatFailure,n.OutputMessageKind.UnhandledFailure,n.OutputMessageKind.NameFailure,n.OutputMessageKind.UpdateNamesRequest],((e,t)=>e(`a different message.kind than ${t.kind}`)))},[F.Finished]:A(C,(e=>e("no message once recalc finished")))};function b(e,t,r){const{stateId:a,kind:i}=e,o=function(e,t){switch(t.kind){case n.OutputMessageKind.GarbageCollected:return expect(t.minStateIdKept).toBeLessThanOrEqual(e),e;case n.OutputMessageKind.Alert:return e;case n.OutputMessageKind.ExperimentRunResult:return t.experimentKind===S.ExperimentKind.OneShot&&expect(e).toEqual(1),e;default:return expect(e).toBeLessThanOrEqual(t.stateId),t.stateId}}(a,t);return{kind:(0,E[i][t.kind])((function(n){return expect({state:e,message:t,index:r}).toEqual(n)}),t,i),stateId:o}}t.assertMessageOrder=function(e){e.reduce(b,y)},t.createRange=function(e,t){return[(0,o.sheetGridRange)(e,t),(0,n.sheetCellSet)(e,(0,s.createCellSetFromRange)(t))]},t.locale=(0,c.getEnglishLocaleInfo)(),t.mathpack=u.xlMathpack,t.defaultConfig={localeInfo:t.locale,mathpack:t.mathpack,refStyle:d.RefStyle.A1,date1904:!1,dateCompatibility:!0,timezone:g.tzUTC,datepack:g.xlDatepack},t.englishLocaleData=(0,f.localeData)([{functionId:0,functionName:"COUNT"}],[{errorType:1,errorName:"#NULL!"}],"TRUE","FALSE","R","C","{","}","[","]",".",",",",",";",[3,0],",",1033,1,2,!1," ",!1,"Paren",!0,!1,"$",2,"MDY","/","-",!0,!1,!1,!0,":",null,!1,!1,!0,["AM","PM"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"],["AM/PM","A/P","上午/下午",null,"General","$"],[null,";","#","0",".","%",",",":","/","/"," ","-","+","(",")",null,"\\","*","y","m","d","h","m","s","E","/",'"',"[","]","@","?","_","r","a","g","e",null,null,null,null,null,null,"B","N","ว","ด","ป","b","ค","ช","น","ท","๐",null],["Black","White","Red","Green","Blue","Yellow","Magenta","Cyan","Color"],["DBNum1","DBNum2","DBNum3","DBNum4"],(0,v.partialArray)({[d.SpecialRefId.All]:"#All",[d.SpecialRefId.Data]:"#Data",[d.SpecialRefId.Headers]:"#Headers",[d.SpecialRefId.Totals]:"#Totals",[d.SpecialRefId.ThisRow]:"#This Row"}),"dddd, mmmm dd, yyyy","h:mm:ss AM/PM","en-US","en-US","en-US","en-US"),t.kfToIformat=e=>Math.abs(e),t.knownFormatData=(0,h.numEnumArray)(m.KnownFormat).filter((e=>(0,p.isKnownFormatDefined)(e,(0,c.getEnglishLocaleInfo)()))).map((e=>(0,f.numberFormat)((0,t.kfToIformat)(e),(0,p.getKnownFormat)(t.locale,e),!0))),t.genFmt=(0,t.kfToIformat)(m.KnownFormat.General),t.blankStyle=n.SpecialStyle.Blank,t.createPartialWorkbook=function(e,r,n){const a=new l.PartialWorkbook({...t.defaultConfig,localeInfo:n?.localeOverride??t.locale},r);return a.setWorksheetFuncOverrides(n?.worksheetFuncOverrides??{}),(n?.setNumberFormats??1)&&a.setNumberFormats(e,t.knownFormatData,!1,-1/0),a}},50514:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbookDocument=void 0;const n=r(92587),a=r(36159),i=r(55),o=r(57786),s=r(41739),u=r(1765),l=r(89817),c=r(35885),d=r(37919);class g{clone(e=i.CloningTarget.Server){let t;if(this.grids){t=(0,a.makeStringMap)();for(const r in this.grids){const n=this.grids[r];t[r]=n.clone(e)}}return new g(this.document,this.stringCompareCI,this.formats.clone(),this.styles.clone(),this.sheets.clone(),t,void 0,this.nameManager.clone())}getReadonlyNameManager(){return this.nameManager}getReadonlySheets(){return this.sheets}setClientValue(e,t,r){const n=this.getGridById(e.sheet.index);return n.kind===u.ResultKind.Failure?n:(0,u.success)(n.value.setClientValue(e.range,t,r))}setClientFormula(e,t,r){const n=this.getGridById(e.sheet.index);return n.kind===u.ResultKind.Failure?n:(0,u.success)(n.value.setClientFormula(e.range,e.range,t,r))}setRecalcFailure(e,t){const r=this.getGridById(e);return r.kind===u.ResultKind.Failure?r:(0,u.success)(r.value.setRecalcFailure(t))}setRecalcEditTaint(e,t){const r=this.getGridById(e);return r.kind===u.ResultKind.Failure?r:(0,u.success)(r.value.setRecalcEditTaint(t))}setRecalcValue(e,t){const r=this.getGridById(e.sheet.index);return r.kind===u.ResultKind.Failure?r:(0,u.success)(r.value.setRecalcValue(e.range,t))}setEditedFormat(e,t){const r=this.getGridById(e.sheet.index);return r.kind===u.ResultKind.Failure?r:(0,u.success)(r.value.setEditedFormat(e.range,t))}setClientFormat(e,t,r){const n=this.getGridById(e.sheet.index);return n.kind===u.ResultKind.Failure?n:(0,u.success)(n.value.setClientFormat(e.range,t,r))}setHiddenRows(e,t,r){const n=this.getGridById(e);return n.kind===u.ResultKind.Failure?n:(0,u.success)(n.value.setHiddenRows(t,r))}setHiddenCols(e,t,r){const n=this.getGridById(e);return n.kind===u.ResultKind.Failure?n:(0,u.success)(n.value.setHiddenCols(t,r))}setMergeCell(e){const t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.setMergeCell(e.range))}setInFilterMode(e,t){const r=this.getGridById(e);return r.kind===u.ResultKind.Failure?r:(0,u.success)(r.value.setInFilterMode(t))}setCellContents(e,t,r,a,i,o,s,l,c){const d=this.getGridById(t.sheet.index);if(d.kind===u.ResultKind.Failure)return d;const g=void 0!==l&&(0,n.isSheetIndexEqual)(t.sheet,l.sheet)?l.range:void 0;return(0,u.success)(d.value.setCellContents(e,t.set,r,a,i,o,s,g,c))}setRangeFormula(e,t,r,a,i,o,s,l){const c=this.getGridById(t.sheet.index);if(c.kind===u.ResultKind.Failure)return c;const d=void 0!==s&&(0,n.isSheetIndexEqual)(t.sheet,s.sheet)?s.range:void 0;return(0,u.success)(c.value.setRangeFormula(e,t.range,r,a,i,o,d,l))}copyRange(e){const t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.copyRange(e.range))}pasteRange(e,t,r){const n=this.getGridById(e.sheet.index);return n.kind===u.ResultKind.Failure?n:(0,u.success)(n.value.pasteRange(e.range,t,r))}assumeRecalcFinal(e,t){const r=this.getGridById(e.sheet.index);return r.kind===u.ResultKind.Failure?r:(0,u.success)(r.value.assumeRecalcFinal(e.set,t))}getDirtyEditedCells(){const e=[];return this.forEachSheet(((t,r)=>{e.push((0,s.sheetCellSet)(t.sheetIndex,r.getDirtyEditedCells()))})),e}getNonDirtyEditedCells(){const e=[];return this.forEachSheet(((t,r)=>{e.push((0,s.sheetCellSet)(t.sheetIndex,r.getNonDirtyEditedCells()))})),e}getDirtyDependentCells(){const e=[];return this.forEachSheet(((t,r)=>{e.push((0,s.sheetCellSet)(t.sheetIndex,r.getDirtyDependentCells()))})),e}setNamedObject(e,t,r,n){return this.nameManager.setNamedObject(e,t,r,n)}setUndefinedNames(e){return this.nameManager.setUndefinedNames(e)}promoteNamedObjects(e,t){return this.nameManager.promoteNamedObjects(e,t)}setSheetNames(e){const t=this.grids??this.oldGrids,r=(0,a.makeStringMap)();for(const{sheetId:n}of e)r[n]=t?.[n]??i.PartialWorkbookGrid.create();return new g(this.document,this.stringCompareCI,this.formats,this.styles,this.sheets.setSheetNames(e),r,void 0,this.nameManager.setSheetNames(e))}extendServerUnused(e,t,r){const n=this.getGridById(e);return n.kind===u.ResultKind.Failure?n:(0,u.success)(n.value.extendServerUnused(t,r))}promoteServerAvailability(e,t,r){const n=this.getGridById(e);return n.kind===u.ResultKind.Failure?n:(0,u.success)(n.value.promoteServerAvailability(t,r))}getNameLoc(e,t,r){return this.nameManager.getNameLoc(e,t,r)}getNameFormula(e,t){return this.nameManager.getNameFormula(e,t)}hasRecalcNameFailure(e){return this.nameManager.hasRecalcNameFailure(e)}setRecalcNameFailure(e){return this.nameManager.setRecalcNameFailure(e)}getContainingTable(e){const t=this.nameManager.getContainingTable(e);if(t.kind===u.ResultKind.Failure||void 0!==t.value)return t;const r=this.getGridById(e.sheet.index);if(r.kind===u.ResultKind.Failure)return(0,u.failure)((0,n.unavailable)([r.reason]));const a=(0,l.intersectProduct)((0,o.createCellSetFromRange)(e.range),o.availableSetProduct);return(0,l.meetsProduct)(a,r.value.getServerAvailability())?u.successUndefined:(0,u.failure)((0,n.unavailable)([{kind:s.UnavailableKind.ContainingTable,range:e}]))}getNamedRanges(e){const t=this.nameManager.getNamedRanges(e);if(t.kind===u.ResultKind.Failure||void 0!==t.value)return t;const r=this.getGridById(e.sheet.index);if(r.kind===u.ResultKind.Failure)return(0,u.failure)((0,n.unavailable)([r.reason]));const a=(0,l.intersectProduct)((0,o.createCellSetFromRange)(e.range),o.availableSetProduct);return(0,l.meetsProduct)(a,r.value.getServerAvailability())?(0,u.success)([]):(0,u.failure)((0,n.unavailable)([{kind:s.UnavailableKind.NamedRanges,range:e}]))}getIntersectingTables(e){return this.nameManager.getIntersectingTables(e)}getStructRefColumn(e,t){return this.nameManager.getStructRefColumn(e,t)}getStructRefSpecialRef(e,t){return this.nameManager.getStructRefSpecialRef(e,t)}getEditedFormula(e){const t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.getEditedFormula(e.range))}forEachEditedFormula(e,t){const r=this.getGridById(e.sheet.index);return r.kind===u.ResultKind.Failure?r:(0,u.success)(r.value.forEachEditedFormula(e.range,t))}getEditedValue(e){const t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.getEditedValue(e.range))}forEachEditedValue(e,t){const r=this.getGridById(e.sheet.index);return r.kind===u.ResultKind.Failure?r:(0,u.success)(r.value.forEachEditedValue(e.range,t))}getEditedFormat(e){const t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.getEditedFormat(e.range))}forEachEditedFormat(e,t){const r=this.getGridById(e.sheet.index);return r.kind===u.ResultKind.Failure?r:(0,u.success)(r.value.forEachEditedFormat(e.range,t))}getEditedStyle(e){const t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.getEditedStyle(e.range))}isInFilterMode(e){const t=this.getGridById(e);return t.kind===u.ResultKind.Failure?t:t.value.isInFilterMode()}getHiddenRows(e,t,r){const n=this.getGridById(e);return n.kind===u.ResultKind.Failure?i.hiddennessFullyUnavailable:n.value.getHiddenRows(t,r)}tryGetHiddenRows(e,t,r){const n=this.getGridById(e);return n.kind===u.ResultKind.Failure?n:n.value.tryGetHiddenRows(t,r)}getHiddenCols(e,t,r){const n=this.getGridById(e);return n.kind===u.ResultKind.Failure?i.hiddennessFullyUnavailable:n.value.getHiddenCols(t,r)}tryGetHiddenCols(e,t,r){const n=this.getGridById(e);return n.kind===u.ResultKind.Failure?n:n.value.tryGetHiddenCols(t,r)}getMergeCell(e){const t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.getMergeCell(e.range))}getServerFormat(e){const t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.getServerFormat(e.range))}getServerStyle(e){const t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.getServerStyle(e.range))}getClientFormat(e){const t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.getClientFormat(e.range))}getClientValue(e){const t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.getClientValue(e.range))}getRecalcValues(e){const t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.getRecalcValues(e.range))}forEachRecalcValue(e,t){const r=this.getGridById(e.sheet.index);return r.kind===u.ResultKind.Failure?r:(0,u.success)(r.value.forEachRecalcValue(e.range,t))}getServerValue(e){const t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.getServerValue(e.range))}getServerFormula(e){const t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.getServerFormula(e.range))}getClientFormula(e){const t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.getClientFormula(e.range))}getServerUsedRange(e){const t=this.getGridById(e);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.getServerUsedRange())}allServerAvailable(e){const t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.allServerAvailable(e.range))}allEditedAvailable(e){const t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.allEditedAvailable(e.range))}forEachRecalcDirty(e,t){const r=this.getGridById(e.sheet.index);return r.kind===u.ResultKind.Failure?r:(0,u.success)(r.value.forEachRecalcDirty(e.range,t))}hasRecalcDirty(e){const t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.hasRecalcDirty(e.range))}hasRecalcFailure(e){const t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.hasRecalcFailure(e.range))}hasEditedEditTaint(e){const t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.hasEditedEditTaint(e.range))}hasRecalcEditTaint(e){const t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.hasRecalcEditTaint(e.range))}forEachEditedNonBlankCellInSet(e,t,r){const n=this.getGridById(e);return n.kind===u.ResultKind.Failure?n:(0,u.success)(n.value.forEachEditedNonBlankCellInSet(t,r))}forEachServerNonBlankCellInSet(e,t,r){const n=this.getGridById(e);return n.kind===u.ResultKind.Failure?n:(0,u.success)(n.value.forEachServerNonBlankCellInSet(t,r))}forEachEditedCellInSet(e,t,r){const n=this.getGridById(e);return n.kind===u.ResultKind.Failure?n:(0,u.success)(n.value.forEachEditedCellInSet(t,r))}getSheetIndex(e){const t=this.sheets.getSheetByName(e);return t.kind===u.ResultKind.Failure||void 0===t.value?t:(0,u.success)(t.value.sheetIndex)}getSheetName(e){const t=this.sheets.getSheetById(e);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.name)}getEditedUsedRange(e){const t=this.getGridById(e);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.getEditedUsedRange())}getSheetRangeIds(e){return this.sheets.getSheetRangeIds(e)}getIformat(e){return this.formats.getIformat(e)}getIformats(){return this.formats.getIformats()}getKnownFormat(e){return this.formats.getKnownFormat(e)}getFormatString(e){return this.formats.getFormatString(e)}resolveCellStyle(e){return this.styles.resolveCellStyle(e)}setNumberFormats(e,t){this.formats.setNumberFormats(e,t)}setStyles(e,t){this.styles.setStyles(e,t)}setFonts(e,t){this.styles.setFonts(e,t)}setFills(e,t){this.styles.setFills(e,t)}setBorders(e,t){this.styles.setBorders(e,t)}onCellModified(e,t){this.forEachSheet(((r,n)=>{n.onCellModified(e,t)})),this.nameManager.onCellModified(e)}collectGarbage(e,t){this.forEachSheet(((r,n)=>{n.collectGarbage(e,t)})),this.nameManager.collectGarbage(e)}advanceState(e,t){this.forEachSheet(((r,n)=>{n.advanceState(e,t)})),this.nameManager.advanceState(e),this.sheets.advanceState(e),this.oldGrids=this.grids,this.grids=void 0}clearCompiledFormulas(){this.forEachSheet(((e,t)=>{t.clearCompiledFormulas()})),this.nameManager.resetLazyData()}clearCompiledNumberFormats(){this.formats.clearCompiledNumberFormats()}getGridStatistics(){let e=i.emptyGridStatistics;return this.forEachSheet(((t,r)=>e=(0,i.mergeGridStatistics)(e,r.getStatistics()))),e}getNameStatistics(){return this.nameManager.getNameStatistics()}getServerAvailableCells(){const e=[];return this.forEachSheet(((t,r)=>{e.push({sheetIdx:t.sheetIndex,availableCells:r.getServerAvailability()})})),e}forEachSheet(e){const t=this.grids;t&&this.sheets.forEachSheet(((r,n)=>{const a=t[n];a&&e(r,a)}))}getGridById(e){const t=this.grids;if(!t)return(0,u.failure)({kind:s.UnavailableKind.SheetNames});const r=t[e];return void 0===r?(0,u.failure)({kind:s.UnavailableKind.SheetId,document:this.document,sheetId:e}):(0,u.success)(r)}constructor(e,t,r,n,a=new d.PartialWorkbookSheets(e,t),i,o,s=new c.PartialWorkbookNameManager(e,t)){this.document=e,this.stringCompareCI=t,this.formats=r,this.styles=n,this.sheets=a,this.grids=i,this.oldGrids=o,this.nameManager=s}}t.PartialWorkbookDocument=g},76726:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbookDocumentCollection=t.voidCallback=void 0;const n=r(50514),a=r(60140),i=r(92587),o=r(92587),s=r(57993),u=r(55),l=r(96978),c=r(57786),d=r(41739),g=r(41739),m=r(68954),h=r(97729),p=r(14009),f=r(73440),S=r(18784),v=r(66153),F=r(12973),y=r(12973),C=r(12973),A=r(4595),E=r(27437),b=r(77398),R=r(36159),T=r(73701),k=r(74889),N=r(79664),I=r(16101),O=r(69820),_=r(76404),P=r(30070),M=r(64962),D=r(32322),w=r(83970),L=r(1765),x=r(58251),K=r(91092),W=r(13168),U=r(97207),G=r(39263),B=r(78468),V=r(3028),j=r(50013),H=r(8101),q=r(12529),$=r(66761),z=(0,a.gridCell)(0,0);class Q extends j.ConstVisitor{wsfNode(e){this.fns.push((0,s.englishWorksheetFuncIdToName)(e))}operatorNode(e){this.fns.push((0,s.englishOperatorIdToName)(e))}constructor(){super(void 0),this.fns=[]}}function Y(e){const t=new Q;return(0,j.reduceBottomUp)(t,e),t.fns}const J=(0,l.precedents)([],[],[],w.SpecialPrecs.None,l.PrecsBound.Exact);t.voidCallback={onNameFailure:()=>{},onRangeFailure:()=>{},onNumberFormatFailure:()=>{},onInferFormatFailure:()=>{},onUnavailableObject:()=>{},onUnavailable:()=>{},onSetCellValue:()=>{},onSetCellValues:()=>{},onReturnCellValue:()=>{}};class X{clone(e=t.voidCallback,r=u.CloningTarget.Server){const n=new X(this.config,e,this.schedulerConfig,this.limits,this.maxDereferenceCells,this.isServerWorkbookLoad);return n.documentLoc=this.documentLoc,n.document=this.document?.clone(r),n.worksheetFuncOverrides=this.worksheetFuncOverrides,n.userDefinedFuncOverrides=this.userDefinedFuncOverrides,n.version=this.version,n}compareVersion(e){return this.version===e.version}getSingleReadonlyDocument(){return this.document}reconfigure(e,t,r,n){this.schedulerConfig=e,this.limits=t,this.maxDereferenceCells=r,this.isServerWorkbookLoad=n,this.advanceVersion()}setConfig(e){this.config=e}forEachDocument(e){void 0!==this.document&&e(this.document)}getDocumentLoc(e,t){const r=this.documentLoc;return void 0===r||void 0!==e&&e!==r.path||0!==this.config.localeInfo.stringCompareCI(t,r.name)?(0,L.failure)((0,o.unavailable)([{kind:d.UnavailableKind.DocumentLoc,document:(0,a.documentLoc)(e,t)}])):(0,L.success)(r)}getNameLoc(e,t,r){const n=this.getDocument(e.document);return n.kind===L.ResultKind.Failure?(0,L.failure)((0,o.unavailable)([n.reason])):n.value.getNameLoc(e.index,t,r)}getUserDefinedFuncLoc(e,t){if(void 0!==this.userDefinedFuncOverrides[t]){const r=(0,a.userDefinedFuncLoc)(e,t);return(0,L.success)([r])}return(0,L.failure)((0,o.notImplemented)(["call UDF"]))}getCellFormat(e){const t=this.allEditedAvailable(e);if(t.kind===L.ResultKind.Failure)return(0,L.failure)((0,o.unavailable)([t.reason]));if(!0!==t.value)return(0,L.failure)((0,o.unavailable)([{kind:d.UnavailableKind.GridRange,unavailableCells:t.value,range:e}]));const r=this.getEditedFormat(e);return r.kind===L.ResultKind.Failure?(0,L.failure)((0,o.unavailable)([r.reason])):r.value===g.SpecialFormat.Unavailable?(0,L.failure)((0,o.unavailable)([{kind:d.UnavailableKind.CellFormat}])):(0,L.success)(r.value)}getCellStyle(e){const t=this.allEditedAvailable(e);if(!(0,L.isSuccess)(t))return(0,L.failure)((0,o.unavailable)([t.reason]));if(!0!==t.value)return(0,L.failure)((0,o.unavailable)([{kind:d.UnavailableKind.GridRange,unavailableCells:t.value,range:e}]));const r=this.getEditedStyle(e);return(0,L.isSuccess)(r)?r.value===g.SpecialStyle.Unavailable?(0,L.failure)((0,o.unavailable)([{kind:d.UnavailableKind.CellStyle}])):this.resolveCellStyle(e.sheet.document,r.value):(0,L.failure)((0,o.unavailable)([r.reason]))}getIformat(e,t){const r=this.getDocument(e);if(r.kind===L.ResultKind.Failure)return(0,L.failure)((0,o.unavailable)([r.reason]));const n=r.value.getIformat(t);if(n.kind===L.ResultKind.Failure)return(0,L.failure)((0,o.unavailable)([n.reason]));const a=n.value.getValue();return a.kind===L.ResultKind.Failure?(0,L.failure)((0,P.previousFormatFailure)((0,P.formatLocIFormat)(e,t))):a}getIformats(e,t,r){const n=this.getDocument(e);if(n.kind===L.ResultKind.Failure)return(0,L.failure)((0,o.unavailable)([n.reason]));const a=n.value.getIformats(),i=[];for(let e=t,n=(0,R.fastMin)(a.length,r);e<n;e+=1){const t=a[e];void 0!==t&&i.push({iformat:e,formatString:t.formatString,builtIn:t.builtIn})}return(0,L.success)(i)}getKnownFormat(e,t){const r=this.getDocument(e);if(r.kind===L.ResultKind.Failure)return(0,L.failure)((0,o.unavailable)([r.reason]));const n=r.value.getKnownFormat(t);if(n.kind===L.ResultKind.Failure)return(0,L.failure)((0,o.unavailable)([n.reason]));const a=n.value.getValue();return a.kind===L.ResultKind.Failure?(0,L.failure)((0,P.previousFormatFailure)((0,P.formatLocKnownFormat)(e,t))):a}getFormatString(e,t){const r=this.getDocument(e);if(r.kind===L.ResultKind.Failure)return(0,L.failure)((0,o.unavailable)([r.reason]));const n=r.value.getFormatString(t);return n.kind===L.ResultKind.Failure?(0,L.failure)((0,o.unavailable)([n.reason])):n}getNameFormula(e,t){const r=this.getDocument(e.scope.document);if(r.kind===L.ResultKind.Failure)return(0,L.failure)((0,o.unavailable)([r.reason]));const n=r.value.getNameFormula(e,t);if(n.kind===L.ResultKind.Failure)return n;if(void 0===n.value)return(0,L.success)(void 0);const a=n.value.lazyData.getValue();if((0,L.isSuccess)(a))return a;const i=this.hasRecalcNameFailure(e);return(0,L.isSuccess)(i)?i.value||this.setNameFailure(e,a.reason):this.cb.onUnavailable(i.reason),(0,L.failure)((0,p.previousNameFailure)(e))}getCellFormula(e){const t=this.getEditedFormula(e);if(t.kind===L.ResultKind.Failure)return(0,L.failure)((0,o.unavailable)([t.reason]));if(void 0===t.value)return(0,L.success)(void 0);const[r,n]=t.value;if(void 0===n.compiledFmla)return(0,L.success)(void 0);const i=(0,a.sheetGridRange)(e.sheet,r),s=this.readCompiledFmla(i,n.compiledFmla);return(0,L.isSuccess)(s)?(0,L.success)((0,p.cellFormula)((0,a.lexicalSourceGrid)(n.lexicalKind,i),s.value)):s}setCellValue(e,t,r){const n=this.setRecalcValue(e,t);if(n.kind===L.ResultKind.Failure)return this.cb.onUnavailableObject(n.reason);const a=this.propagateEditTaint(e,r);if(a.kind===L.ResultKind.Failure)return this.cb.onUnavailableObject(a.reason);this.cb.onSetCellValue(e,t,r,a.value,this.evalParams)}setCellValues(e,t,r){const n=this.setClientValue(e,t);if(n.kind===L.ResultKind.Failure)return this.cb.onUnavailableObject(n.reason);const a=this.setRecalcValue(e,t);if(a.kind===L.ResultKind.Failure)return this.cb.onUnavailableObject(a.reason);const i=this.propagateEditTaint(e,r);if(i.kind===L.ResultKind.Failure)return this.cb.onUnavailableObject(i.reason);this.cb.onSetCellValues(e,t,r,i.value,this.evalParams)}getWorksheetFunc(e){if((0,E.isVolatileFunc)(e)){let t=!1;const r=this.evalParams.volatileMode;switch(e){case E.WorksheetFuncId.RAND:case E.WorksheetFuncId.RANDBETWEEN:case E.WorksheetFuncId.RANDARRAY:case E.WorksheetFuncId.NOW:t=r===A.VolatileMode.GroundTruth;break;case E.WorksheetFuncId.TODAY:t=r===A.VolatileMode.GroundTruth||r===A.VolatileMode.Estimation;break;default:t=void 0===E.WorksheetFuncId[e]}if(!t)return(0,L.failure)((0,o.unavailable)([{kind:d.UnavailableKind.VolatileFunction,name:(0,s.englishWorksheetFuncIdToName)(e)}]))}const t=this.worksheetFuncOverrides[e]??(0,b.getWorksheetFunc)(e);return null!=t?(0,L.success)(t):(0,L.failure)((0,o.notImplemented)([(0,s.englishWorksheetFuncIdToName)(e)]))}getUserDefinedFunc(e){const t=e.id;return void 0!==this.userDefinedFuncOverrides[t]?(0,L.success)(this.userDefinedFuncOverrides[t]):(0,L.failure)((0,o.notImplemented)(["call UDF"]))}getSheetRangeIndexes(e){return this.getSheetRangeIds(e)}setCellFailure(e,t,r){const n=this.setRecalcFailure(e.sheet,(0,c.createCellSetFromRange)(e.range));if(n.kind===L.ResultKind.Failure)return this.cb.onUnavailableObject(n.reason);const a=this.setClientValue(e,u.clientValueUnknownOper);if(a.kind===L.ResultKind.Failure)return this.cb.onUnavailableObject(a.reason);const i=this.setRecalcValue(e,l.blankOper);if(i.kind===L.ResultKind.Failure)return this.cb.onUnavailableObject(i.reason);const o=this.propagateEditTaint(e,r);if(o.kind===L.ResultKind.Failure)return this.cb.onUnavailableObject(o.reason);const s=this.evalParams;s.onRangeFailure?.(e,t,r),this.cb.onRangeFailure(e,t,r,o.value,s)}getUsedRange(e){const t=this.getEditedUsedRange(e);return t.kind===L.ResultKind.Failure?(0,L.failure)((0,o.unavailable)([t.reason])):t}getSheetName(e,t){const r=this.getDocument(e);if(r.kind===L.ResultKind.Failure)return(0,L.failure)((0,o.unavailable)([r.reason]));const n=r.value.getSheetName(t);return n.kind===L.ResultKind.Failure||void 0===n.value?n:(0,L.success)(n.value)}getSheetIndex(e,t){const r=this.getDocument(e);if(r.kind===L.ResultKind.Failure)return(0,L.failure)((0,o.unavailable)([r.reason]));const n=r.value.getSheetIndex(t);return n.kind===L.ResultKind.Failure||void 0===n.value?n:(0,L.success)(n.value.index)}getContainingTable(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?(0,L.failure)((0,o.unavailable)([t.reason])):t.value.getContainingTable(e)}getNamedRanges(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?(0,L.failure)((0,o.unavailable)([t.reason])):t.value.getNamedRanges(e)}getStructRefColumn(e,t){const r=this.getDocument(e.scope.document);return r.kind===L.ResultKind.Failure?(0,L.failure)((0,o.unavailable)([r.reason])):r.value.getStructRefColumn(e,t)}getStructRefSpecialRef(e,t){const r=this.getDocument(e.scope.document);return r.kind===L.ResultKind.Failure?(0,L.failure)((0,o.unavailable)([r.reason])):r.value.getStructRefSpecialRef(e,t)}getIntersectingTables(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?(0,L.failure)((0,o.unavailable)([t.reason])):t.value.getIntersectingTables(e)}getNamedObject(e,t){const r=this.getDocument(e.scope.document);if(r.kind===L.ResultKind.Failure)return(0,L.failure)((0,o.unavailable)([r.reason]));const n=r.value.getNameFormula(e,t);return n.kind===L.ResultKind.Failure?n:(0,L.success)(n.value?.obj)}getHiddenRows(e,t,r){const n=this.getDocument(e.document);return n.kind===L.ResultKind.Failure?u.hiddennessFullyUnavailable:n.value.getHiddenRows(e.index,t,r)}tryGetHiddenRows(e,t,r){const n=this.getDocument(e.document);if(n.kind===L.ResultKind.Failure)return(0,L.failure)((0,o.unavailable)([n.reason]));const a=n.value.tryGetHiddenRows(e.index,t,r);return a.kind===L.ResultKind.Failure?(0,L.failure)((0,o.unavailable)([a.reason])):a}getHiddenCols(e,t,r){const n=this.getDocument(e.document);return n.kind===L.ResultKind.Failure?u.hiddennessFullyUnavailable:n.value.getHiddenCols(e.index,t,r)}tryGetHiddenCols(e,t,r){const n=this.getDocument(e.document);if(n.kind===L.ResultKind.Failure)return(0,L.failure)((0,o.unavailable)([n.reason]));const a=n.value.tryGetHiddenCols(e.index,t,r);return a.kind===L.ResultKind.Failure?(0,L.failure)((0,o.unavailable)([a.reason])):a}getMergeCell(e){const t=this.allEditedAvailable(e);if(t.kind===L.ResultKind.Failure)return(0,L.failure)((0,o.unavailable)([t.reason]));if(!0!==t.value)return(0,L.failure)((0,o.unavailable)([{kind:d.UnavailableKind.GridRange,unavailableCells:t.value,range:e}]));const r=this.getDocument(e.sheet.document);if(r.kind===L.ResultKind.Failure)return(0,L.failure)((0,o.unavailable)([r.reason]));const n=r.value.getMergeCell(e);return n.kind===L.ResultKind.Failure?(0,L.failure)((0,o.unavailable)([n.reason])):n}isInFilterMode(e){const t=this.getDocument(e.document);if(t.kind===L.ResultKind.Failure)return(0,L.failure)((0,o.unavailable)([t.reason]));const r=t.value.isInFilterMode(e.index);return r.kind===L.ResultKind.Failure?(0,L.failure)((0,o.unavailable)([r.reason])):r}getRandom(){return(0,T.assertTrue)("calc.calc.PartialWorkbookDocumentCollection: getRandom",this.evalParams.volatileMode===A.VolatileMode.GroundTruth),(0,L.success)(this.config.mathpack.fromNumber(this.random.next()))}getTime(e,t){return(0,A.getTimeImpl)(this.config,e,t,this.evalParams.volatileMode)}withEvalParams(e,t){const r=this.evalParams;this.evalParams=e;try{const r=t();return Array.isArray(r)?r:r.kind===L.ResultKind.Paused?(0,p.paused)((()=>this.withEvalParams(e,r.resume))):(0,p.breaked)((()=>this.withEvalParams(e,r.resume)))}finally{this.evalParams=r}}withEvalParamsEvalFormula(e,t){const r=this.evalParams;this.evalParams=e;try{const r=t();return r.kind===L.ResultKind.Paused?(0,p.paused)((()=>this.withEvalParamsEvalFormula(e,r.resume))):r.kind===L.ResultKind.Breaked?(0,p.breaked)((()=>this.withEvalParamsEvalFormula(e,r.resume))):r}finally{this.evalParams=r}}evaluate(e,t,r,n){return this.withEvalParams({computeKind:e,computeCells:t,volatileMode:r,onRangeFailure:n},(()=>this.evaluator.evalCells({},t)))}evalFormula(e,t,r,n){const i={lexicalKind:a.LexicalKind.Other,originGridCell:(0,L.success)(t.range),originSheet:(0,L.success)(t.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0,allowImplicitTable:!0,wrapCellReferences:!1,workbookLoad:!1,emitStepInfo:!1,contextNames:void 0},o={lexicalSource:{kind:a.LexicalKind.Other},originGridCell:(0,L.success)(t.range),originSheet:(0,L.success)(t.sheet),calcingArray:!1,reflectionGridCell:(0,L.success)(t.range),reflectionSheet:(0,L.success)(t.sheet),implicitIntersect:!1,allowUnqualifiedCell:!0,wrapCellReferences:!1,followHyperlinks:(0,L.success)(!1),contextNames:void 0},s=(e,n)=>{if(n.kind===L.ResultKind.Paused)return(0,p.paused)((()=>s(e,n.resume())));if(n.kind===L.ResultKind.Breaked)return(0,p.breaked)((()=>s(e,n.resume())));if(!(0,L.isSuccess)(n))return(0,L.success)({value:n});const a=this.evalFormulaFormat(t,e,n.value,r);return(0,L.success)({value:(0,L.success)(n.value),formatted:a})};return this.withEvalParamsEvalFormula({computeKind:g.ComputeKind.EvalFormula,computeCells:[t],volatileMode:n},(()=>{const t=this.parser.parseFormula(i,e),r=this.checkFormula(i,t,e,g.FormulaMode.EvalFormula),n=this.compileFormula(i,r);return(0,L.isSuccess)(n)?s(n.value,this.evaluator.evalFormula(o,n.value)):(0,L.success)({value:n})}))}evalFormulaFormat(e,t,r,n){if(void 0===n)return;if("number"==typeof n)return this.formatValueIformat(e.sheet.document,n,r);if(n.kind===g.SpecialFormat.Known)return this.formatValueKnownFormat(e.sheet.document,n.knownFormat,r);let a=r;if(this.renderBlanksAsZerosEnabled&&(0,o.isBlankOper)(r)&&(n.kind===g.SpecialFormat.Origin||n.kind===g.SpecialFormat.Inferred||n.kind===g.SpecialFormat.Edit)&&n.renderBlanksAsZeros&&(a=this.config.mathpack.zero),n.kind===g.SpecialFormat.Origin||n.kind===g.SpecialFormat.Aggregate){const t=this.ensureCellExists(e);return(0,R.isNone)(t)||!(0,L.isSuccess)(t)?t:n.kind===g.SpecialFormat.Origin?this.formatValueCell(e,a):this.formatValueAggregate(e,a)}return n.kind===g.SpecialFormat.Inferred?this.applyInferredFormat(e,t,a):n.kind===g.SpecialFormat.Edit?this.applyEditFormat(e,t,a,n.isWholeFormula):(0,T.assertNever)("calc.calc.PartialWorkbookDocumentCollection.evalFormulaFormat",n)}evalValue(e,t,r){const n=this.evalParams;this.evalParams={computeKind:t,computeCells:[e],volatileMode:r};try{const t=this.getEditedFormula(e);if(!(0,L.isSuccess)(t))return this.cb.onUnavailableObject(t.reason);if(void 0!==t.value?.[1].compiledFmla)return;const r=this.hasRecalcDirty(e);if(!(0,L.isSuccess)(r))return this.cb.onUnavailableObject(r.reason);if(r.value)return;const n=this.tryGetCellValue(e.range,e.sheet);if(void 0===n)return;(0,T.assertTrue)("calc.calc.PartialWorkbookDocumentCollection.evalValue",n.kind===p.CellKind.FinalValue),this.cb.onReturnCellValue(e,n.oper,g.ComputedCellKind.EditedCell)}finally{this.evalParams=n}}advanceVersion(){return this.version++,this.version}setUserDefinedFuncOverrides(e){this.userDefinedFuncOverrides=e,this.advanceVersion()}setWorksheetFuncOverrides(e){this.worksheetFuncOverrides=e,this.advanceVersion()}setSheetNames(e,t){const r=this.ensureDocument(e);return r.kind===L.ResultKind.Failure?r:(this.document=r.value.setSheetNames(t),(0,L.success)(void 0))}advanceState(e){void 0!==this.document&&this.document.advanceState(e,this.advanceVersion())}onCellModified(e){if(void 0!==this.document)return this.document.onCellModified(e,this.advanceVersion())}getServerDocument(){return this.documentLoc}allServerAvailable(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.allServerAvailable(e)}forEachEditedNonBlankCellInSet({index:e,document:t},r,n){const a=this.getDocument(t);return a.kind===L.ResultKind.Failure?a:a.value.forEachEditedNonBlankCellInSet(e,r,n)}forEachServerNonBlankCellInSet({index:e,document:t},r,n){const a=this.getDocument(t);return a.kind===L.ResultKind.Failure?a:a.value.forEachServerNonBlankCellInSet(e,r,n)}forEachEditedCellInSet({index:e,document:t},r,n){const a=this.getDocument(t);return a.kind===L.ResultKind.Failure?a:a.value.forEachEditedCellInSet(e,r,n)}clearCompiledFormulas(){if(void 0!==this.document)return this.document.clearCompiledFormulas()}clearCompiledNumberFormats(){if(void 0!==this.document)return this.document.clearCompiledNumberFormats()}getGridStatistics(){return void 0!==this.document?this.document.getGridStatistics():u.emptyGridStatistics}getNameStatistics(){return void 0!==this.document?this.document.getNameStatistics():U.emptyNameStatistics}collectGarbage(e){if(void 0!==this.document)return this.document.collectGarbage(e,this.advanceVersion())}getEditedFormula(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.getEditedFormula(e)}forEachEditedFormula(e,t){const r=this.getDocument(e.sheet.document);return r.kind===L.ResultKind.Failure?r:r.value.forEachEditedFormula(e,t)}getEditedValue(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.getEditedValue(e)}forEachEditedValue(e,t){const r=this.getDocument(e.sheet.document);return r.kind===L.ResultKind.Failure?r:r.value.forEachEditedValue(e,t)}getEditedFormat(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.getEditedFormat(e)}forEachEditedFormat(e,t){const r=this.getDocument(e.sheet.document);return r.kind===L.ResultKind.Failure?r:r.value.forEachEditedFormat(e,t)}getEditedStyle(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.getEditedStyle(e)}getServerFormat(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.getServerFormat(e)}getServerStyle(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.getServerStyle(e)}getClientFormat(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.getClientFormat(e)}getClientValue(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.getClientValue(e)}getRecalcValues(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.getRecalcValues(e)}forEachRecalcValue(e,t){const r=this.getDocument(e.sheet.document);return r.kind===L.ResultKind.Failure?r:r.value.forEachRecalcValue(e,t)}getServerValue(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.getServerValue(e)}getServerFormula(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.getServerFormula(e)}getClientFormula(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.getClientFormula(e)}getServerUsedRange(e){const t=this.getDocument(e.document);if(t.kind===L.ResultKind.Failure)return t;const r=t.value.getServerUsedRange(e.index);return r.kind===L.ResultKind.Failure||void 0===r.value?r:(0,L.success)((0,a.sheetGridRange)(e,r.value))}getServerAvailableCells(){const e=[];return this.forEachDocument((t=>{(0,R.safePush)(e,t.getServerAvailableCells())})),e}promoteServerAvailability({sheet:e,set:t},r){const n=this.getDocument(e.document);return n.kind===L.ResultKind.Failure?n:n.value.promoteServerAvailability(e.index,t,r)}extendServerUnused(e,t){const r=this.getDocument(e.document);return r.kind===L.ResultKind.Failure?r:r.value.extendServerUnused(e.index,t,this.advanceVersion())}setCellContents(e,t,r,n,i,o,s,l,c,d){const g=this.getDocument(t.sheet.document);if(g.kind===L.ResultKind.Failure)return g;const m=void 0===r?void 0:n?this.compileFmla(e,a.LexicalKind.Cell,(0,a.sheetGridCell)(t.sheet,i),void 0,r):""===r?u.blankCellGridFormula:{fmla:r,lexicalKind:a.LexicalKind.Cell,origin:i,compiledFmla:void 0,hasHyperlink:u.SpecialBoolean.ClientValueUnknown};return g.value.setCellContents(e,t,m,o,s,l,c,d,this.advanceVersion())}setRangeFormula(e,t,r,n,i,s,l,c){const d=this.getDocument(t.sheet.document);if(d.kind===L.ResultKind.Failure)return d;const g=""===r?u.blankRangeGridFormula:this.compileFmla(e,a.LexicalKind.Range,(0,a.sheetGridCell)(t.sheet,n),(0,o.gridRangeAnchor)(t.range),r);return d.value.setRangeFormula(e,t,g,i,s,l,c,this.advanceVersion())}copyRange(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.copyRange(e)}pasteRange(e,t){const r=this.getDocument(e.sheet.document);return r.kind===L.ResultKind.Failure?r:r.value.pasteRange(e,t,this.advanceVersion())}assumeRecalcFinal(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.assumeRecalcFinal(e,this.advanceVersion())}getDirtyEditedCells(){return this.document?this.document.getDirtyEditedCells():[]}getNonDirtyEditedCells(){return this.document?this.document.getNonDirtyEditedCells():[]}getDirtyDependentCells(){return this.document?this.document.getDirtyDependentCells():[]}setNamedObject(e,t,r){const n=this.getDocument(t.scope.document);return n.kind===L.ResultKind.Failure?(0,L.failure)((0,o.unavailable)([n.reason])):n.value.setNamedObject(e,t,r,this.compileNamedObject)}setUndefinedNames(e){const t=this.getDocument(e.document);return t.kind===L.ResultKind.Failure?(0,L.failure)((0,o.unavailable)([t.reason])):t.value.setUndefinedNames(e)}promoteNamedObjects(e,t){const r=this.getDocument(e.document);return r.kind===L.ResultKind.Failure?(0,L.failure)((0,o.unavailable)([r.reason])):r.value.promoteNamedObjects(e,t)}setNumberFormats(e,t,r){const n=this.ensureDocument(e);if(n.kind===L.ResultKind.Failure)return(0,L.failure)((0,o.unavailable)([n.reason]));const a=[];return t.forEach((({iformat:e,formatString:t,builtIn:r})=>{const n=this.compileNumberFormat(t,r);a[e]={formatString:t,builtIn:r,compiledFormat:n}})),(0,L.success)(n.value.setNumberFormats(a,r))}setStyles(e,t,r){const n=this.ensureDocument(e);return n.kind===L.ResultKind.Failure?n:(0,L.success)(n.value.setStyles(t,r))}setFonts(e,t,r){const n=this.ensureDocument(e);return n.kind===L.ResultKind.Failure?n:(0,L.success)(n.value.setFonts(t,r))}setFills(e,t,r){const n=this.ensureDocument(e);return n.kind===L.ResultKind.Failure?n:(0,L.success)(n.value.setFills(t,r))}setBorders(e,t,r){const n=this.ensureDocument(e);return n.kind===L.ResultKind.Failure?n:(0,L.success)(n.value.setBorders(t,r))}writeHiddenRows(e,t,r){const n=this.getDocument(e.document);return n.kind===L.ResultKind.Failure?n:n.value.setHiddenRows(e.index,t,r)}writeHiddenCols(e,t,r){const n=this.getDocument(e.document);return n.kind===L.ResultKind.Failure?n:n.value.setHiddenCols(e.index,t,r)}writeMergeCell(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.setMergeCell(e)}writeInFilterMode(e,t){const r=this.getDocument(e.document);return r.kind===L.ResultKind.Failure?r:r.value.setInFilterMode(e.index,t)}resolveCellFormat(e,t){if("number"!=typeof t)return(0,L.success)(t);const r=this.getDocument(e);if(!(0,L.isSuccess)(r))return(0,L.failure)((0,o.unavailable)([r.reason]));const n=r.value.getIformat(t);return(0,L.isSuccess)(n)?n.value.getValue():(0,L.failure)((0,o.unavailable)([n.reason]))}resolveCellStyle(e,t){const r=this.getDocument(e);if(!(0,L.isSuccess)(r))return(0,L.failure)((0,o.unavailable)([r.reason]));const n=r.value.resolveCellStyle(t);return(0,L.isSuccess)(n)?(0,L.success)(n.value):(0,L.failure)((0,o.unavailable)([n.reason]))}resolveValueFormat(e,t){if("string"==typeof t)return this.resolveStringFormat(e,t);const r=this.getKnownFormat(e,t);if(!(0,L.isSuccess)(r))return r;const n=this.getFormatString(e,r.value.formatString);return(0,L.isSuccess)(n)?(0,L.success)(n.value??r.value):n}resolveStringFormat(e,t){const r=this.getFormatString(e,t);return(0,L.isSuccess)(r)?void 0!==r.value?(0,L.success)(r.value):this.formatter.createFormat(t,!1):r}resolveObjectFormat(e,t){const r=this.getFormatString(e,t.formatString);return(0,L.isSuccess)(r)?void 0!==r.value?(0,L.success)(r.value):(0,L.success)(t):r}resolveEditFormat(e,t){return"number"==typeof t?(0,L.success)(t):this.resolveStringFormat(e,t)}resolveRibbonFormat(e,t,r){let n;switch(t){case q.RibbonFormat.GalleryShortDate:case q.RibbonFormat.GalleryLongDate:{const e=this.getCellFormat(r);if(!(0,L.isSuccess)(e))return e;const t=this.resolveCellFormat(r.sheet.document,e.value);if(!(0,L.isSuccess)(t))return t;n=t.value;break}}const a=(0,q.getRibbonFormat)(this.config.localeInfo,t,n);return this.resolveStringFormat(e,a)}resolveChangeDecimals(e,t,r){const n=this.getCellFormat(r);if(!(0,L.isSuccess)(n))return n;const a=this.resolveCellFormat(r.sheet.document,n.value);if(!(0,L.isSuccess)(a))return a;const i=this.formatter.changeFormatDecimals(a.value,t);return(0,L.isSuccess)(i)?void 0===i.value?L.successUndefined:this.resolveObjectFormat(e,i.value):i}parseInferredEdit(e,t,r){const n=this.getCellFormat(e);if(!(0,L.isSuccess)(n))return n;const a=this.resolveCellFormat(e.sheet.document,n.value);if(!(0,L.isSuccess)(a))return a;const i=this.evalParams;this.evalParams={computeKind:g.ComputeKind.ParseEdit,computeCells:[e],volatileMode:r};try{return this.formatter.parseEdit(t,a.value)}finally{this.evalParams=i}}inferFormulaFormat(e){const t=this.getEditedFormula(e);if(!(0,L.isSuccess)(t))return(0,L.success)(void this.cb.onUnavailableObject(t.reason));if(void 0===t.value||void 0===t.value[1].compiledFmla)return(0,L.success)(void this.cb.onUnavailableObject({kind:d.UnavailableKind.CellEvaluatingValue}));const r=t.value[1].compiledFmla.getValue();if(!(0,L.isSuccess)(r))return r;const n=(0,a.lexicalSourceGrid)(t.value[1].lexicalKind,(0,a.sheetGridRange)(e.sheet,t.value[0])),i=r.value;return this.formatter.evalFormat((0,P.evalFormatLocalsGrid)(n),i)}fillInferredFormat(e,t){let r=t,n=t===g.SpecialFormat.Unavailable?(0,L.success)(g.SpecialFormat.Unavailable):this.resolveCellFormat(e.sheet.document,t);if(!(0,L.isSuccess)(n)){const t=n.reason;(0,c.forEachRangeInSet)(e.set,(r=>{const n=(0,a.sheetGridRange)(e.sheet,r);return this.cb.onInferFormatFailure(n,t),!0})),n=(0,L.success)(g.SpecialFormat.Unavailable),r=g.SpecialFormat.Unavailable}const i=n.value;(0,c.forEachCellInSet)(e.set,(t=>{const n=(0,a.sheetGridCell)(e.sheet,t),o=this.getEditedFormat(n);if(!(0,L.isSuccess)(o))return this.cb.onUnavailableObject(o.reason),!0;if(o.value===g.SpecialFormat.Unavailable)return!0;const s=this.resolveCellFormat(e.sheet.document,o.value);if(!(0,L.isSuccess)(s))return this.cb.onInferFormatFailure(n,s.reason),!0;if((0,D.shouldInstallFormat)(i===g.SpecialFormat.Unavailable?void 0:i,s.value)){const e=this.setEditedFormat(n,r);(0,L.isSuccess)(e)||this.cb.onUnavailableObject(e.reason)}return!0}))}anonymizeFormula(e,t){const r=t.compiledFmla?.getValue();return void 0!==r&&(0,L.isSuccess)(r)?[(0,I.anonymizeFormula)(this.config,r.value,e),Y(r.value)]:[(0,O.anonymizeFormulaString)(t.fmla),[]]}compileFmla(e,t,r,n,a){return{fmla:a,lexicalKind:t,origin:n??r.range,compiledFmla:new A.ResettableLazy((()=>{const i=this.parser.parseFormula((0,f.parseLocals)(t,r.range),a),o=e?i:this.autocorrectFormula((0,h.analyzeLocalsGrid)(t,r),i),s=e&&this.isServerWorkbookLoad,u=this.checkFormula((0,h.analyzeLocalsGrid)(t,r,void 0,s),o,a,e?g.FormulaMode.ServerCellFormula:g.FormulaMode.EditCellFormula),l=this.adjustFormulaOrigin(u,r,n);return this.compileFormula((0,p.compileLocalsGrid)(t,r.range),l)})),hasHyperlink:u.SpecialBoolean.ClientValueUnknown}}compileFormula(e,t){return(0,L.isSuccess)(t)?this.compiler.compileFormula(e,t.value):t}checkFormula(e,t,r,n){if(!(0,L.isSuccess)(t))return t;const a=this.analyzer.checkFormulaWithDiagnostics(e,t.value);if(!(0,L.isSuccess)(a))return a;if(!(0,o.isWellFormed)(a.value[0])){const e="calc.PartialWorkbook.checkFormula: expected well-formed formula; given "+(0,O.anonymizeFormulaString)(r);return(0,L.failure)((0,p.illFormedFormula)(e,n,(0,h.summarizeFormulaDiagnostics)(a.value[1])))}return(0,L.success)(a.value[0])}autocorrectFormula(e,t){return(0,L.isSuccess)(t)?this.analyzer.autocorrectFormula(e,t.value):t}adjustFormulaOrigin(e,t,r){if(!(0,L.isSuccess)(e)||void 0===r)return e;const n=(0,x.resolveLocalsGrid)(t);return(0,_.adjustFormulaOrigin)(this,n,r,e.value)}compileNumberFormat(e,t){return new A.ResettableLazy((()=>{const r=this.formatter.createFormat(e,t);return(0,L.isSuccess)(r)||this.cb.onNumberFormatFailure(r.reason),r}))}compileKnownFormats(){return(0,R.numEnumMap)(W.KnownFormat,(e=>this.compileNumberFormat((0,B.getKnownFormat)(this.config.localeInfo,e),!1)))}printFormulaBarText(e,t,r){return this.printer.printFormula((0,N.printLocalsGrid)(e,(0,a.sheetGridCell)(e.range.sheet,t)),r)}renderValueBarText(e,t,r){const n=this.getEditedResolvedFormat(e);return(0,L.isSuccess)(n)?this.formatter.renderFormulaBar(e.sheet.document,t,n.value,(0,V.stringStartsWith)(r,"'")):n}formatValueCell(e,t){if((0,o.isBlankOper)(t))return(0,L.success)((0,P.formattedValue)([],void 0,P.Alignment.Left,P.Clip.All));const r=this.getEditedResolvedFormat(e);return(0,L.isSuccess)(r)?this.formatter.applyFormat(r.value,t,!0):r}formatValueAggregate(e,t){if(!(0,i.isNumberOper)(t))return(0,L.success)((0,P.hashesValue)(P.aggregationError,void 0));let r;if((0,i.isNumberOper)(t)&&0===this.config.mathpack.cond(t))r=this.getKnownFormat(e.sheet.document,W.KnownFormat.General);else{if(r=this.getEditedResolvedFormat(e),!(0,L.isSuccess)(r))return r;const{valueType:t}=r.value;t===P.FormatValueType.Text?r=this.getKnownFormat(e.sheet.document,W.KnownFormat.General):t===P.FormatValueType.Time&&(r=this.getKnownFormat(e.sheet.document,W.KnownFormat.AbsHMMSS))}return(0,L.isSuccess)(r)?this.formatter.applyFormat(r.value,t,!0):r}formatValueIformat(e,t,r){const n=this.getIformat(e,t);return(0,L.isSuccess)(n)?this.formatter.applyFormat(n.value,r,!0):n}formatValueKnownFormat(e,t,r){const n=this.getKnownFormat(e,t);return(0,L.isSuccess)(n)?this.formatter.applyFormat(n.value,r,!0):n}getEditedResolvedFormat(e){const t=this.getEditedFormat(e);return(0,L.isSuccess)(t)?t.value===g.SpecialFormat.Unavailable?(0,L.failure)((0,o.unavailable)([{kind:d.UnavailableKind.CellFormat}])):this.resolveCellFormat(e.sheet.document,t.value):(0,L.failure)((0,o.unavailable)([t.reason]))}getDocument(e){return void 0!==this.documentLoc&&void 0!==this.document&&(0,o.isDocumentLocEqual)(this.documentLoc,e)?(0,L.success)(this.document):(0,L.failure)({kind:d.UnavailableKind.DocumentLoc,document:e})}ensureDocument(e){return void 0===this.documentLoc&&void 0===this.document&&(this.documentLoc=e,this.document=new n.PartialWorkbookDocument(e,this.config.localeInfo.stringCompareCI,new G.PartialWorkbookFormats(this.compileKnownFormats()),new H.PartialWorkbookStyles)),this.getDocument(e)}tryGetCellValues(e,t){const r=(0,a.sheetGridRange)(t,e),{row:n,col:i,rows:s,cols:u}=e,l=this.getRecalcValues(r);if(l.kind===L.ResultKind.Failure)return void this.cb.onUnavailableObject(l.reason);let c=!1;for(let e=0;e<s;e+=1){const r=l.value[e];for(let o=0;o<u;o+=1){const{failure:s}=r[o];void 0!==s&&(this.setCellFailure((0,a.sheetGridCell)(t,(0,a.gridCell)(n+e,i+o)),s,J),c=!0)}}if(c)return;const g=e=>(0,p.finalValue)(e.oper),m=l.value.map((e=>e.map(g))),h=this.forEachRecalcDirty(r,(e=>{const r=(0,a.sheetGridCell)(t,e),s=this.getEditedFormula(r);if(s.kind===L.ResultKind.Failure)return this.cb.onUnavailableObject(s.reason),!1;if(void 0===s.value)return this.setCellFailure(r,(0,o.unavailable)([{kind:d.UnavailableKind.CellMissingFormula}]),J),c=!0,!0;const[u,l]=s.value;if(void 0===l.compiledFmla)return this.cb.onUnavailableObject({kind:d.UnavailableKind.CellEvaluatingValue}),!1;const g=this.readCompiledFmla((0,a.sheetGridRange)(t,u),l.compiledFmla);return(0,L.isSuccess)(g)?(m[e.row-n][e.col-i]=(0,p.pendingValue)((0,a.sheetGridCell)(t,(0,o.gridRangeAnchor)(u))),!0):(c=!0,!0)}));if((0,L.isSuccess)(h)){if(h.value&&!c)return m}else this.cb.onUnavailableObject(h.reason)}tryGetCellValue(e,t){const r=this.tryGetCellValues(e,t);return void 0===r?void 0:r[0][0]}makeGetCellValues(e){return t=>{const r=this.allEditedAvailable(t);if(r.kind===L.ResultKind.Failure)return(0,L.failure)((0,o.unavailable)([r.reason]));if(!0!==r.value)return(0,L.failure)((0,o.unavailable)([{kind:d.UnavailableKind.GridRange,range:t,unavailableCells:r.value}]));const n=this.hasRecalcFailure(t);if(n.kind===L.ResultKind.Failure)return(0,L.failure)((0,o.unavailable)([n.reason]));if(n.value)return(0,L.failure)((0,p.previousFailure)(t));if((0,o.gridRangeSize)(t.range)>this.maxDereferenceCells)return(0,L.failure)((0,o.unavailable)([{kind:d.UnavailableKind.GridRangeSize,range:t}]));const a=e(t.range,t.sheet);return void 0===a?(0,L.failure)((0,p.previousFailure)(t)):(0,L.success)(a)}}readCompiledFmla(e,t){const r=t.getValue();return(0,L.isSuccess)(r)?r:(this.setCellFailure(e,r.reason,J),r.reason.kind===p.ReasonKind.Unavailable?(r.reason,r):(0,L.failure)((0,o.unavailable)([{kind:d.UnavailableKind.CellFormula,reason:r.reason}])))}getEditedUsedRange(e){const t=this.getDocument(e.document);if(t.kind===L.ResultKind.Failure)return t;const r=t.value.getEditedUsedRange(e.index);return r.kind===L.ResultKind.Failure||void 0===r.value?r:(0,L.success)((0,a.sheetGridRange)(e,r.value))}getSheetRangeIds(e){const t=this.getDocument(e.document);return t.kind===L.ResultKind.Failure?(0,L.failure)((0,o.unavailable)([t.reason])):t.value.getSheetRangeIds(e)}allEditedAvailable(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.allEditedAvailable(e)}forEachRecalcDirty(e,t){const r=this.getDocument(e.sheet.document);return r.kind===L.ResultKind.Failure?r:r.value.forEachRecalcDirty(e,t)}hasRecalcDirty(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.hasRecalcDirty(e)}hasRecalcFailure(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.hasRecalcFailure(e)}hasEditedEditTaint(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.hasEditedEditTaint(e)}hasRecalcEditTaint(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.hasRecalcEditTaint(e)}setEditedFormat(e,t){const r=this.getDocument(e.sheet.document);return r.kind===L.ResultKind.Failure?r:r.value.setEditedFormat(e,t)}setClientFormat(e,t){const r=this.getDocument(e.sheet.document);return r.kind===L.ResultKind.Failure?r:r.value.setClientFormat(e,t,this.advanceVersion())}setRecalcFailure(e,t){const r=this.getDocument(e.document);return r.kind===L.ResultKind.Failure?r:r.value.setRecalcFailure(e.index,t)}testAndSetClientValue(e,t){const r=this.getClientValue(e);if(r.kind===L.ResultKind.Failure)return r;const n=(0,u.isClientValueUnknownOper)(r.value.oper)||!(0,o.isReadOperEqual)(this.config.mathpack,r.value.oper,t,!0);if(n){const r=this.setClientValue(e,t);if(r.kind===L.ResultKind.Failure)return r}return(0,L.success)(n)}testAndSetClientFormat(e,t){const r=this.getClientFormat(e);if(r.kind===L.ResultKind.Failure)return r;const n=t!==r.value;if(n){const r=this.setClientFormat(e,t);if(r.kind===L.ResultKind.Failure)return r}return(0,L.success)(n)}testAndSetClientFormula(e,t,r){const n=this.getClientFormula((0,o.sheetGridRangeAnchor)(e));if(n.kind===L.ResultKind.Failure)return n;const[i,s]=n.value??[e.range,u.blankClientGridFormula],l=(0,o.gridRangeAnchor)(e.range),c=void 0!==t&&t!==s.fmla||void 0!==s.compiledFmla&&!(0,o.isGridCellEqual)(l,s.origin),d=void 0!==r&&r!==s.hasHyperlink;if(c||d){const{compiledFmla:n}=s,o=this.setClientFormula((0,a.sheetGridRange)(e.sheet,i),{fmla:t??s.fmla,compiledFmla:n,origin:void 0!==t?l:s.origin,hasHyperlink:r??s.hasHyperlink});if(o.kind===L.ResultKind.Failure)return o}return(0,L.success)({hasFmlaChanged:c,hasHyperlinkChanged:d})}setRecalcEditTaint(e,t){const r=this.getDocument(e.document);return r.kind===L.ResultKind.Failure?r:r.value.setRecalcEditTaint(e.index,t)}propagateEditTaint(e,t){const r=this.hasEditedEditTaint(e);if(r.kind===L.ResultKind.Failure)return r;if(r.value)return(0,L.success)(g.ComputedCellKind.EditedCell);for(const r of t.cells){const t=this.hasRecalcEditTaint(r);if(t.kind===L.ResultKind.Failure)return t;if(t.value){const t=this.setRecalcEditTaint(e.sheet,(0,c.createCellSetFromRange)(e.range));return t.kind===L.ResultKind.Failure?t:(0,L.success)(g.ComputedCellKind.DependentCell)}}if(0!=(t.special&(w.SpecialPrecs.Calc|w.SpecialPrecs.Time))){const t=this.setRecalcEditTaint(e.sheet,(0,c.createCellSetFromRange)(e.range));return t.kind===L.ResultKind.Failure?t:(0,L.success)(g.ComputedCellKind.DependentCell)}return t.bound===l.PrecsBound.Exact||void 0!==this.evalParams&&this.evalParams.computeKind===g.ComputeKind.EditedCell?(0,L.success)(g.ComputedCellKind.IndependentCell):(0,L.success)(g.ComputedCellKind.UnknownNonEditedCell)}setClientValue(e,t){const r=this.getDocument(e.sheet.document);return r.kind===L.ResultKind.Failure?r:r.value.setClientValue(e,t,this.advanceVersion())}setRecalcValue(e,t){const r=this.getDocument(e.sheet.document);return r.kind===L.ResultKind.Failure?r:r.value.setRecalcValue(e,t)}setClientFormula(e,t){const r=this.getDocument(e.sheet.document);return r.kind===L.ResultKind.Failure?r:r.value.setClientFormula(e,t,this.advanceVersion())}hasRecalcNameFailure(e){const t=this.getDocument(e.scope.document);return t.kind===L.ResultKind.Failure?(0,L.failure)((0,o.unavailable)([t.reason])):t.value.hasRecalcNameFailure(e)}setRecalcNameFailure(e){const t=this.getDocument(e.scope.document);return t.kind===L.ResultKind.Failure?(0,L.failure)((0,o.unavailable)([t.reason])):t.value.setRecalcNameFailure(e)}setNameFailure(e,t){const r=this.setRecalcNameFailure(e);if(r.kind===L.ResultKind.Failure)return this.cb.onUnavailable(r.reason);this.cb.onNameFailure(e,t,this.evalParams)}applyInferredFormat(e,t,r){const n=this.getInferredFormat(e,t);return(0,L.isSuccess)(n)?void 0===n.value?this.formatValueKnownFormat(e.sheet.document,W.KnownFormat.General,r):"number"==typeof n.value?this.formatValueIformat(e.sheet.document,n.value,r):this.formatter.applyFormat(n.value,r,!0):n}applyEditFormat(e,t,r,n){if(t.node.kind===y.NodeKind.CellRef&&!n)return this.applyInferredFormat(e,t,r);const a=this.ensureCellExists(e);if((0,R.isNone)(a)||!(0,L.isSuccess)(a))return a;const i=this.getEditedResolvedFormat(e);if(!(0,L.isSuccess)(i))return i;const o=this.getInferredFormat(e,t);if(!(0,L.isSuccess)(o))return o;let s;if(void 0===o.value)s=void 0;else if("number"==typeof o.value){const t=this.getIformat(e.sheet.document,o.value);if(!(0,L.isSuccess)(t))return t;s=t.value}else s=o.value;const u=(0,B.getKnownFormat)(this.config.localeInfo,W.KnownFormat.General)===i.value.formatString;return(n||u)&&(0,R.isDefined)(s)&&(0,D.shouldInstallFormat)(s,i.value)?this.formatter.applyFormat(s,r,!0):this.formatter.applyFormat(i.value,r,!0)}getInferredFormat(e,t){const r={lexicalSource:{kind:a.LexicalKind.Other},originGridCell:(0,L.success)(e.range),originSheet:(0,L.success)(e.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1};return this.formatter.evalFormat(r,t)}ensureCellExists(e){const t=this.allEditedAvailable(e);if((0,L.isSuccess)(t))return!0!==t.value?(0,L.failure)((0,o.unavailable)([{kind:d.UnavailableKind.GridRange,unavailableCells:t.value,range:e}])):(0,L.success)(!0);this.cb.onUnavailableObject(t.reason)}constructor(e,t,r,n,i,s){this.cb=t,this.schedulerConfig=r,this.limits=n,this.maxDereferenceCells=i,this.isServerWorkbookLoad=s,this.renderBlanksAsZerosEnabled=(0,$.isChangeGateEnabled)("OfficeVSO:7042222_renderBlanksAsZeros"),this.random=new K.JSF32(4294967296*Math.random()),this.worksheetFuncOverrides={},this.userDefinedFuncOverrides={},this.version=0,this.interruptToken=[p.Interrupt.Continue],this.getCellValue=this.makeGetCellValues(this.tryGetCellValue.bind(this)),this.getCellValues=this.makeGetCellValues(this.tryGetCellValues.bind(this)),this.compileNamedObject=(e,t,r)=>{const n=e?g.FormulaMode.ServerNamedFormula:g.FormulaMode.EditNamedFormula;switch(r.kind){case"NamedFormula":{const t=r.fmla,i=this.parser.parseFormula((0,f.parseLocals)(a.LexicalKind.NameManager,z),t);(0,T.assertTrue)("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: isServerUpdate",e);const o=e&&this.isServerWorkbookLoad,s=(0,h.analyzeLocalsName)((0,a.originCell)((0,a.documentScope)(this.documentLoc),z),void 0,o),u=i,l=this.checkFormula(s,u,t,n);return this.compileFormula((0,p.compileLocalsName)(z),l)}case"NamedValue":case"NamedRange":case"NamedTable":{let e,n;if("NamedRange"===r.kind){const i=r.value;(0,T.assertTrue)("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: bad range",(0,o.isDocumentLocEqual)(r.value.sheets.document,t.scope.document));const s=i.sheets,u=this.getDocument(s.document);if(!(0,L.isSuccess)(u))return this.cb.onUnavailableObject(u.reason),(0,L.failure)((0,o.unavailable)([u.reason]));const l=u.value.getSheetName(s.index);if(!(0,L.isSuccess)(l))return this.cb.onUnavailable(l.reason),l;const c=r.value.ranges[0];e=(0,C.formula)((0,C.cellRefNode)((0,C.cellRefRange)((0,C.cellRefSingle)((0,C.pos)(C.PosKind.Abs,c.row),(0,C.pos)(C.PosKind.Abs,c.col)),(0,C.cellRefSingle)((0,C.pos)(C.PosKind.Abs,c.row+c.rows-1),(0,C.pos)(C.PosKind.Abs,c.col+c.cols-1))),(0,C.sheetQualifier)(l.value)),[],[],1),n=(0,a.sheetGridCell)(s,z)}else"NamedTable"===r.kind?(e=(0,C.formula)((0,C.structRefNode)((0,C.nameNode)((0,F.identNamePart)(t.name)),(0,C.structRef)(void 0)),[],[],1),n=(0,a.originCell)((0,a.documentScope)(this.documentLoc),z)):(e=(0,C.formula)((0,C.literalNode)(r.value,!0),[],[],1),n=(0,a.originCell)((0,a.documentScope)(this.documentLoc),z));const i=this.analyzer.checkFormula((0,h.analyzeLocalsName)(n),e);return(0,L.isSuccess)(i)&&(0,o.isWellFormed)(i.value)?this.compileFormula((0,p.compileLocalsName)(z),(0,L.success)(i.value)):(0,T.assertFalse)(`calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: constructed ill-formed formula ${(0,I.anonymizeFormula)(this.config,e,(0,a.lexicalSourceName)(t))}`)}case"NamedFailure":return(0,L.failure)((0,o.unavailable)([{kind:d.UnavailableKind.ClientFailure,reason:r.failureReason}]));default:return(0,T.assertNever)("calc.calc.partialWorkbookDocumentCollection.compileNamedFmla",r)}},this.config=e,this.parser=(0,S.createParser)(this),this.printer=(0,I.createPrinter)(this),this.analyzer=(0,m.createAnalyzer)(this),this.formatter=(0,M.createNumberFormatter)(this),this.compiler=(0,v.createCompiler)(this),this.evaluator=(0,k.createEvaluator)(this)}}t.PartialWorkbookDocumentCollection=X},66505:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isFailureOutputMessage=void 0;const n=r(41739),a=[n.OutputMessageKind.RangeFailure,n.OutputMessageKind.NameFailure,n.OutputMessageKind.NumberFormatFailure,n.OutputMessageKind.PrintFormulaFailure,n.OutputMessageKind.InferFormatFailure,n.OutputMessageKind.FormatValueFailure,n.OutputMessageKind.UnhandledFailure];t.isFailureOutputMessage=function(e){return a.includes(e.kind)}},39263:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbookFormats=void 0;const n=r(36159),a=r(1765),i=r(41739);class o{clone(){const e=new o(this.knownFormats);return Object.keys(this.iformats).map(Number).forEach((t=>{e.iformats[t]=this.iformats[t]})),Object.keys(this.formatStrings).forEach((t=>{e.formatStrings[t]=this.formatStrings[t]})),e}clearCompiledNumberFormats(){this.iformats.forEach((e=>{e.compiledFormat.reset()})),Object.keys(this.knownFormats).map((e=>Number(e))).forEach((e=>{this.knownFormats[e].reset()})),this.formatStrings=(0,n.makeStringMap)(),Object.keys(this.iformats).map(Number).forEach((e=>{const t=this.iformats[e];this.formatStrings[t.formatString]=e}))}getIformat(e){const t=this.iformats[e];return void 0===t?(0,a.failure)({kind:i.UnavailableKind.NumberFormat,iformat:e}):(0,a.success)(t.compiledFormat)}getIformats(){return this.iformats}getKnownFormat(e){return(0,a.success)(this.knownFormats[e])}getFormatString(e){return(0,a.success)(this.formatStrings[e])}setNumberFormats(e,t){t||(this.iformats=[],this.formatStrings=(0,n.makeStringMap)()),Object.keys(e).map(Number).forEach((t=>{const r=this.iformats[t];void 0!==r&&delete this.formatStrings[r.formatString];const n=e[t];this.iformats[t]=n,this.formatStrings[n.formatString]=t}))}constructor(e){this.iformats=[],this.formatStrings=(0,n.makeStringMap)(),this.knownFormats=e}}t.PartialWorkbookFormats=o},55:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbookGrid=t.CloningTarget=t.usedRangeIsect=t.usedRangeJoin=t.denseUsedRange=t.emptyUsedRange=t.mergeGridStatistics=t.emptyGridStatistics=t.hiddennessFullyUnavailable=t.isBlankGridValue=t.blankGridValue=t.isClientValueUnknownOper=t.clientValueUnknownOper=t.ClientOperKind=t.blankClientGridFormula=t.isBlankGridFormula=t.blankRangeGridFormula=t.blankCellGridFormula=t.SpecialString=t.SpecialBoolean=t.isBlankCellFormat=t.blankCellFormat=void 0;const n=r(14009),a=r(92587),i=r(60140),o=r(96978),s=r(57786),u=r(74599),l=r(36159),c=r(26795),d=r(89817),g=r(41739),m=r(41739),h=r(1765),p=r(3028);function f(e){return Array.isArray(e)}var S,v,F;function y(e){return e.kind===F.ClientValueUnknown}function C(e,t){return(0,a.isBlankOper)(e)&&void 0===t}function A(e,t,r){return e.setValue(t,r,(e=>e.fmla!==r.fmla||e.lexicalKind!==r.lexicalKind||void 0!==e.compiledFmla&&!(0,a.isGridCellEqual)(e.origin,r.origin)||null==e.compiledFmla!=(null==r.compiledFmla)))}function E(e,r){return e.forEachMeets(r,((r,n)=>{if(n.fmla.length>0){const a=n.lexicalKind===i.LexicalKind.Cell?t.blankCellGridFormula:t.blankRangeGridFormula;e=e.setValue(r,a)}return!0})),e}function b(e,r){return e.forEachMeets(r,((r,n)=>((n.fmla===v.ClientValueUnknown||n.fmla.length>0)&&(e=e.setValue(r,t.blankClientGridFormula)),!0))),e}function R(e,t,r,n){const a=(0,d.intersectProduct)(t,s.availableReadProduct),i=(0,d.project)((0,d.intersectProduct)(r,a),"row","col");return(0,s.forEachCellInSet)((0,d.exceptProduct)(t,i),(t=>(e=e.setValue(t,n),!0))),e}t.blankCellFormat=0,t.isBlankCellFormat=e=>0===e,function(e){e.ClientValueUnknown="ClientValueUnknown"}(S||(t.SpecialBoolean=S={})),function(e){e[e.ClientValueUnknown=0]="ClientValueUnknown"}(v||(t.SpecialString=v={})),t.blankCellGridFormula={fmla:"",lexicalKind:i.LexicalKind.Cell,origin:(0,i.gridCell)(0,0),compiledFmla:void 0,hasHyperlink:!1},(0,l.staticAssertExtends)(),t.blankRangeGridFormula={fmla:"",lexicalKind:i.LexicalKind.Range,origin:(0,i.gridCell)(0,0),compiledFmla:void 0,hasHyperlink:!1},(0,l.staticAssertExtends)(),t.isBlankGridFormula=(e,t)=>""===e&&!t,t.blankClientGridFormula=t.blankCellGridFormula,function(e){e.ClientValueUnknown="ClientValueUnknown"}(F||(t.ClientOperKind=F={})),t.clientValueUnknownOper={kind:F.ClientValueUnknown},t.isClientValueUnknownOper=y,t.blankGridValue={oper:o.blankOper,failure:void 0},(0,l.staticAssertExtends)(),t.isBlankGridValue=C,t.hiddennessFullyUnavailable={hidden:[],available:[]};const T={values:(0,u.makeGridRangeTable)(),formats:(0,u.makeGridRangeTable)(),styles:(0,u.makeGridRangeTable)(),formulae:(0,u.makeGridRangeTable)(),dirty:c.empty};function k(e,r){return e===t.emptyUsedRange?r:r===t.emptyUsedRange?e:(0,a.gridRangeJoin)(e,r)}function N(e,r){return e===t.emptyUsedRange||r===t.emptyUsedRange?t.emptyUsedRange:(0,a.gridRangeIsect)(e,r)}var I;t.emptyGridStatistics={serverFormulaeNodeCount:0,serverFormatsNodeCount:0,serverStylesNodeCount:0,serverValuesNodeCount:0,serverDirtySetSubspaceCount:0,editedFormulaeNodeCount:0,editedFormatsNodeCount:0,editedStylesNodeCount:0,editedValuesNodeCount:0,editedDirtySetSubspaceCount:0,clientFormulaeNodeCount:0,clientFormatsNodeCount:0,clientValuesNodeCount:0,recalcValuesNodeCount:0,recalcDirtySetSubspaceCount:0,recalcFailuresSetSubspaceCount:0,recalcTaintSetSubspaceCount:0,availabilitySetSubspaceCount:0,availabilityHistorySize:0,hiddenRowsNodeCount:0,hiddenColsNodeCount:0},t.mergeGridStatistics=function(e,t){return{serverFormulaeNodeCount:e.serverFormulaeNodeCount+t.serverFormulaeNodeCount,serverFormatsNodeCount:e.serverFormatsNodeCount+t.serverFormatsNodeCount,serverStylesNodeCount:e.serverStylesNodeCount+t.serverStylesNodeCount,serverValuesNodeCount:e.serverValuesNodeCount+t.serverValuesNodeCount,serverDirtySetSubspaceCount:e.serverDirtySetSubspaceCount+t.serverDirtySetSubspaceCount,editedFormulaeNodeCount:e.editedFormulaeNodeCount+t.editedFormulaeNodeCount,editedFormatsNodeCount:e.editedFormatsNodeCount+t.editedFormatsNodeCount,editedStylesNodeCount:e.editedStylesNodeCount+t.editedStylesNodeCount,editedValuesNodeCount:e.editedValuesNodeCount+t.editedValuesNodeCount,editedDirtySetSubspaceCount:e.editedDirtySetSubspaceCount+t.editedDirtySetSubspaceCount,clientFormulaeNodeCount:e.clientFormulaeNodeCount+t.clientFormulaeNodeCount,clientFormatsNodeCount:e.clientFormatsNodeCount+t.clientFormatsNodeCount,clientValuesNodeCount:e.clientValuesNodeCount+t.clientValuesNodeCount,recalcValuesNodeCount:e.recalcValuesNodeCount+t.recalcValuesNodeCount,recalcDirtySetSubspaceCount:e.recalcDirtySetSubspaceCount+t.recalcDirtySetSubspaceCount,recalcFailuresSetSubspaceCount:e.recalcFailuresSetSubspaceCount+t.recalcFailuresSetSubspaceCount,recalcTaintSetSubspaceCount:e.recalcTaintSetSubspaceCount+t.recalcTaintSetSubspaceCount,availabilitySetSubspaceCount:e.availabilitySetSubspaceCount+t.availabilitySetSubspaceCount,availabilityHistorySize:e.availabilityHistorySize+t.availabilityHistorySize,hiddenRowsNodeCount:e.hiddenRowsNodeCount+t.hiddenRowsNodeCount,hiddenColsNodeCount:e.hiddenColsNodeCount+t.hiddenColsNodeCount}},t.emptyUsedRange=void 0,t.denseUsedRange=(0,i.gridRange)(0,0,i.sheetRows,i.sheetCols),t.usedRangeJoin=k,t.usedRangeIsect=N,function(e){e[e.Server=0]="Server",e[e.Client=1]="Client"}(I||(t.CloningTarget=I={}));class O{static create(){return new O}clone(e=I.Server){const t=new O(this.serverContents,this.serverAvailability,this.serverUsed,this.hiddenRows,this.hiddenRowsAvailability,this.hiddenCols,this.hiddenColsAvailability,this.mergeCells,this.inFilterMode,this.filterModeAvailable);return e===I.Client&&(t.editedContents=this.editedContents,t.clientContents=this.clientContents,t.recalcValues=this.recalcValues,t.recalcDirty=this.recalcDirty,t.recalcFailures=this.recalcFailures,t.editedTaint=this.editedTaint,t.recalcTaint=this.recalcTaint,t.editedAvailability=this.editedAvailability),t}advanceState(e,r){this.oldAvailabilities[e]=this.serverAvailability,this.availabilityHistorySize+=1,this.serverAvailability=c.empty,this.serverUsed=t.denseUsedRange,this.hiddenRows=this.hiddenRowsAvailability=c.empty,this.hiddenCols=this.hiddenColsAvailability=c.empty,this.inFilterMode=this.filterModeAvailable=!1,this.rollBackToServerState(r)}rollBackToServerState(e){this.editedContents=this.serverContents,this.editedAvailability=this.serverAvailability,this.editedUsed=this.serverUsed,this.editedTaint=c.empty,this.rollBackToEditedState(e)}rollBackToEditedState(e){this.setClientContents(this.editedContents,e),this.recalcValues=this.editedContents.values,this.recalcFailures=c.empty,this.recalcDirty=this.editedContents.dirty,this.recalcTaint=this.editedTaint}allServerAvailable(e){return this.allAvailable(e,this.serverAvailability)}allEditedAvailable(e){return this.allAvailable(e,this.editedAvailability)}allAvailable(e,t){const r=(0,s.createCellSetFromRange)(e),n=(0,d.intersectProduct)(r,s.availableReadProduct),a=(0,d.intersectProduct)(t,n),i=(0,d.project)((0,d.exceptProduct)(n,a),"row","col"),o=(0,d.compareProduct)(a,n);return!!(void 0!==o&&o>=0)||i}forEachRecalcDirty(e,t){return(0,s.forEachCellInSet)((0,d.intersectProduct)(this.recalcDirty,(0,s.createCellSetFromRange)(e)),t)}hasRecalcDirty(e){return(0,d.meetsProduct)(this.recalcDirty,(0,s.createCellSetFromRange)(e))}hasRecalcFailure(e){return(0,d.meetsProduct)(this.recalcFailures,(0,s.createCellSetFromRange)(e))}hasEditedEditTaint(e){return(0,d.meetsProduct)(this.editedTaint,(0,s.createCellSetFromRange)(e))}hasRecalcEditTaint(e){return(0,d.meetsProduct)(this.recalcTaint,(0,s.createCellSetFromRange)(e))}getEditedUsedRange(){return this.editedUsed}getServerUsedRange(){return this.serverUsed}getServerAvailability(){return this.serverAvailability}getHiddenRows(e,t){const r=s.bspFactory.row((0,l.pair)(e,t)),a=(0,c.intersect)(this.hiddenRowsAvailability,r),i=[];(0,s.forEachRow)(a,(([e,t])=>(i.push((0,n.interval)(e,t)),!0)));const o=[];return(0,s.forEachRow)((0,c.intersect)(this.hiddenRows,a),(([e,t])=>(o.push((0,n.interval)(e,t)),!0))),{hidden:o,available:i}}tryGetHiddenRows(e,t){const r=this.getHiddenRows(e,t);return 1===r.available.length&&r.available[0].start===e&&r.available[0].end===t?(0,h.success)(r.hidden):(0,h.failure)({kind:g.UnavailableKind.HiddenRows})}setHiddenRows(e,t){const r=s.bspFactory.row((0,l.pair)(e.row,e.row+e.rows));this.hiddenRows=(0,c.union)((0,c.except)(this.hiddenRows,r),(0,c.intersect)(t,r)),this.hiddenRowsAvailability=(0,c.union)(this.hiddenRowsAvailability,r)}getHiddenCols(e,t){const r=s.bspFactory.col((0,l.pair)(e,t)),a=(0,c.intersect)(this.hiddenColsAvailability,r),i=[];(0,s.forEachCol)(a,(([e,t])=>(i.push((0,n.interval)(e,t)),!0)));const o=[];return(0,s.forEachCol)((0,c.intersect)(this.hiddenCols,a),(([e,t])=>(o.push((0,n.interval)(e,t)),!0))),{hidden:o,available:i}}tryGetHiddenCols(e,t){const r=this.getHiddenCols(e,t);return 1===r.available.length&&r.available[0].start===e&&r.available[0].end===t?(0,h.success)(r.hidden):(0,h.failure)({kind:g.UnavailableKind.HiddenCols})}setHiddenCols(e,t){const r=s.bspFactory.col((0,l.pair)(e.col,e.col+e.cols));this.hiddenCols=(0,c.union)((0,c.except)(this.hiddenCols,r),(0,c.intersect)(t,r)),this.hiddenColsAvailability=(0,c.union)(this.hiddenColsAvailability,r)}setMergeCell(e){this.mergeCells=this.mergeCells.setValue(e,!0)}getMergeCell(e){let t;return this.mergeCells.forEachGe(e,(e=>(t=e,!0))),t}isInFilterMode(){return this.filterModeAvailable?(0,h.success)(this.inFilterMode):(0,h.failure)({kind:g.UnavailableKind.InFilterMode})}setInFilterMode(e){this.inFilterMode=e,this.filterModeAvailable=!0}forEachNonBlankSetCellInSet(e,r,n,i){const o=(0,d.intersectProduct)(e,s.availableSetProduct);return(0,s.forEachRangeInSet)((0,d.intersectProduct)(n,o),(e=>i.formulae.forEachMeets(e,((n,i)=>!!(0,t.isBlankGridFormula)(i.fmla,void 0!==i.compiledFmla)||(0,a.forEachCellInRange)((0,a.gridRangeIsect)(e,n),r)))))}forEachReadableCellInSet(e,t,r){const n=(0,d.intersectProduct)(e,s.availableReadProduct);return(0,s.forEachRangeInSet)((0,d.intersectProduct)(r,n),(e=>(0,a.forEachCellInRange)(e,t)))}forEachEditedNonBlankCellInSet(e,t){return this.forEachNonBlankSetCellInSet(e,t,this.editedAvailability,this.editedContents)}forEachServerNonBlankCellInSet(e,t){return this.forEachNonBlankSetCellInSet(e,t,this.serverAvailability,this.serverContents)}forEachEditedCellInSet(e,t){return this.forEachReadableCellInSet(e,t,this.editedAvailability)}promoteServerAvailability(e,t){const r=(0,d.intersectProduct)(e,s.availableSetProduct),n=this.oldAvailabilities[t];if(void 0===n)return!1;const a=(0,d.compareProduct)(n,r);return void 0!==a&&a>=0&&(this.unionAvailability(!0,(0,d.intersectProduct)(e,s.availableAllProduct)),this.unionTaint(!0,c.empty),this.unionUsed(!0,(0,s.cellSetBounds)(e)),!0)}extendServerUnused(e,r){const n=e===t.emptyUsedRange?c.empty:(0,s.createCellSetFromRange)(e),a=(0,d.complementProduct)(n);let{values:i,formats:o,styles:u,formulae:l,dirty:g}=this.serverContents;(0,s.forEachRangeInSet)(a,(e=>(i.forEachLe(e,((e,r)=>(C(r.oper,r.failure)||(i=i.setValue(e,t.blankGridValue)),!0))),o.forEachLe(e,((e,r)=>((0,t.isBlankCellFormat)(r)||(o=o.setValue(e,t.blankCellFormat)),!0))),u.forEachLe(e,((e,t)=>(t!==m.SpecialStyle.Blank&&(u=u.setValue(e,m.SpecialStyle.Blank)),!0))),!0))),(0,s.forEachRangeInSet)(a,(e=>(l=E(l,e),!0))),g=(0,d.exceptProduct)(g,a),this.setContents(!0,{values:i,formats:o,styles:u,formulae:l,dirty:g},r);const h=(0,d.intersectProduct)(a,s.availableReadProduct);this.serverAvailability=this.editedAvailability=(0,d.unionProduct)(this.serverAvailability,h),this.editedTaint=this.recalcTaint=c.empty;let p=this.serverUsed;p=N(p,e),this.serverUsed=this.editedUsed=p}setRecalcFailure(e){this.recalcFailures=(0,d.unionProduct)(this.recalcFailures,e)}setRecalcEditTaint(e){this.recalcTaint=(0,d.unionProduct)(this.recalcTaint,e)}setRecalcValue(e,t){(0,a.forEachCellInRange)(e,((e,r,n)=>(this.recalcValues=this.recalcValues.setValue(e,{oper:f(t)?t[r][n]:t,failure:void 0}),!0))),this.recalcDirty=(0,d.exceptProduct)(this.recalcDirty,(0,s.createCellSetFromRange)(e))}setClientContents(e,t){this.clientContents=e}setClientValue(e,t,r){let{values:n}=this.clientContents;(0,a.forEachCellInRange)(e,((e,r,a)=>(n=n.setValue(e,{oper:f(t)?t[r][a]:t,failure:void 0}),!0))),this.setClientContents({...this.clientContents,values:n},r)}setClientFormula(e,t,r,n){let{formulae:i}=this.clientContents;i=b(i,e),void 0!==t?i=i.setValue(t,r):(0,a.forEachCellInRange)(e,(e=>(i=i.setValue(e,r),!0))),this.setClientContents({...this.clientContents,formulae:i},n)}setClientFormat(e,t,r){let{formats:n}=this.clientContents;(0,a.forEachCellInRange)(e,(e=>(n=n.setValue(e,t),!0))),this.setClientContents({...this.clientContents,formats:n},r)}getRecalcValues(e){const{row:r,col:n,rows:a,cols:i}=e,o=new Array(a);for(let e=0;e<a;e+=1)o[e]=(0,p.arrayFill)(new Array(i),t.blankGridValue);return this.recalcValues.forEachLe(e,((e,t)=>(o[e.row-r][e.col-n]=t,!0))),o}forEachRecalcValue(e,t){return this.recalcValues.forEachMeets(e,t)}getClientValue(e){return this.clientContents.values.getValue(e)??t.blankGridValue}getServerValue(e){return this.serverContents.values.getValue(e)??t.blankGridValue}getEditedValue(e){return this.editedContents.values.getValue(e)??t.blankGridValue}forEachEditedValue(e,t){return this.editedContents.values.forEachMeets(e,t)}getServerFormula(e){return this.getFormula(e,this.serverContents.formulae)}getClientFormula(e){return this.getFormula(e,this.clientContents.formulae)}setEditedFormat(e,t){this.editedContents={...this.editedContents,formats:this.editedContents.formats.setValue(e,t)}}getEditedFormat(e){return this.editedContents.formats.getValue(e)??t.blankCellFormat}forEachEditedFormat(e,t){return this.editedContents.formats.forEachMeets(e,t)}getServerFormat(e){return this.serverContents.formats.getValue(e)??t.blankCellFormat}getEditedStyle(e){return this.editedContents.styles.getValue(e)??m.SpecialStyle.Blank}getServerStyle(e){return this.serverContents.styles.getValue(e)??m.SpecialStyle.Blank}getClientFormat(e){return this.clientContents.formats.getValue(e)??t.blankCellFormat}getEditedFormula(e){return this.getFormula(e,this.editedContents.formulae)}forEachEditedFormula(e,t){return this.editedContents.formulae.forEachMeets(e,t)}getFormula(e,r){let n;return r.forEachGe(e,((e,r)=>!!(0,t.isBlankGridFormula)(r.fmla,void 0!==r.compiledFmla)||(n=[e,r],!1))),n}setContents(e,t,r){e&&(this.serverContents=t),this.editedContents=t,e&&this.setClientContents(this.editedContents,r),this.recalcValues=this.editedContents.values,this.recalcDirty=this.editedContents.dirty,this.recalcFailures=c.empty}unionAvailability(e,t){let r=e?this.serverAvailability:this.editedAvailability;r=(0,d.unionProduct)(r,t),e&&(this.serverAvailability=r),this.editedAvailability=r}unionTaint(e,t){this.editedTaint=e?c.empty:(0,d.unionProduct)(this.editedTaint,t),this.recalcTaint=this.editedTaint}unionUsed(e,t){let r=e?this.serverUsed:this.editedUsed;r=k(r,t),e&&(this.serverUsed=r),this.editedUsed=r}setCellContents(e,t,r,n,a,i,o,s,u){this.setCommon(e,t,void 0,r,n,a,i,o,s,u)}setRangeFormula(e,t,r,n,a,i,o,u){const l=(0,s.createCellSetFromRange)(t);this.setCommon(e,l,t,r,n,void 0,a,i,o,u)}setCommon(e,r,n,a,i,o,u,l,g,h){let{values:p,formats:f,styles:S,formulae:v,dirty:F}=e?this.serverContents:this.editedContents;const y=void 0===a&&void 0!==i||void 0!==a?.compiledFmla;let b=a;void 0!==a&&((0,s.forEachRangeInSet)(r,(e=>(v=E(v,e),!0))),(0,t.isBlankGridFormula)(a.fmla,void 0!==a.compiledFmla)&&(b=void 0));const T=void 0!==b&&void 0===n?a:void 0,k=void 0!==b&&void 0!==n?a:void 0;let N=i;void 0!==i&&C(i,o)&&((0,s.forEachRangeInSet)(r,(e=>(p.forEachLe(e,((e,r)=>(C(r.oper,r.failure)||(p=p.setValue(e,t.blankGridValue)),!0))),!0))),F=y?(0,d.unionProduct)(F,r):(0,d.exceptProduct)(F,r),N=void 0);const I=void 0!==N?{oper:N,failure:o}:void 0;let O=u;void 0!==u&&(0,t.isBlankCellFormat)(u)&&((0,s.forEachRangeInSet)(r,(e=>(f.forEachLe(e,((e,r)=>((0,t.isBlankCellFormat)(r)||(f=f.setValue(e,t.blankCellFormat)),!0))),!0))),O=void 0);const _=O===m.SpecialFormat.Weak?void 0:O,P=O===m.SpecialFormat.Weak?O:void 0;let M=l;void 0!==l&&l===m.SpecialStyle.Blank&&((0,s.forEachRangeInSet)(r,(e=>(S.forEachLe(e,((e,t)=>(t!==m.SpecialStyle.Blank&&(S=S.setValue(e,m.SpecialStyle.Blank)),!0))),!0))),M=void 0);const D=M===m.SpecialStyle.Weak?void 0:M,w=M===m.SpecialStyle.Weak?M:void 0;let L=r;if(!e){const e=(0,d.intersectProduct)(r,s.availableSetProduct),t=(0,d.project)((0,d.intersectProduct)(this.editedAvailability,e),"row","col"),n=(0,d.intersectProduct)(r,void 0!==g?(0,s.createCellSetFromRange)(g):c.empty);L=(0,d.unionProduct)(t,n)}if(void 0===T&&void 0===_&&void 0===D&&void 0===I||((0,s.forEachCellInSet)(L,(e=>(void 0!==T&&(v=A(v,e,T)),void 0!==_&&(f=f.setValue(e,_)),void 0!==D&&(S=S.setValue(e,D)),void 0!==I&&(p=p.setValue(e,I)),!0))),void 0===T&&void 0===I||(F=y?(0,d.unionProduct)(F,L):(0,d.exceptProduct)(F,L))),void 0!==k){v=A(v,n,k);const e=(0,s.createCellSetFromRange)(n);F=y?(0,d.unionProduct)(F,e):(0,d.exceptProduct)(F,e)}void 0!==P&&(f=R(f,L,e?this.serverAvailability:this.editedAvailability,m.SpecialFormat.Unavailable)),void 0!==w&&(S=function(e,t,r){const n=(0,d.intersectProduct)(t,s.availableReadProduct),a=(0,d.project)((0,d.intersectProduct)(r,n),"row","col");return(0,s.forEachCellInSet)((0,d.exceptProduct)(t,a),(t=>(e=e.setValue(t,m.SpecialStyle.Unavailable),!0))),e}(S,L,e?this.serverAvailability:this.editedAvailability));const x=void 0===i?c.empty:L,K=void 0===a?c.empty:L,W=void 0===u?c.empty:L,U=void 0===i&&void 0===u?c.empty:L;e||((0,s.forEachRangeInSet)(x,(e=>(this.setClientValue(e,t.clientValueUnknownOper,h),!0))),void 0!==a&&(void 0!==n?this.setClientFormula(n,n,a,h):(0,s.forEachRangeInSet)(K,(e=>(this.setClientFormula(e,void 0,a,h),!0)))),u===m.SpecialFormat.Weak?this.setClientContents({...this.clientContents,formats:R(this.clientContents.formats,W,this.editedAvailability,m.SpecialFormat.ClientValueUnknown)},h):(0,s.forEachRangeInSet)(W,(e=>(this.setClientFormat(e,m.SpecialFormat.ClientValueUnknown,h),!0)))),this.setContents(e,{values:p,formats:f,styles:S,formulae:v,dirty:F},h),this.unionAvailability(e,(0,d.intersectProduct)(x,s.availableAllProduct)),e||(this.editedAvailability=(0,d.exceptProduct)(this.editedAvailability,(0,d.exceptProduct)(r,L))),this.unionTaint(e,U),this.unionUsed(e,(0,s.cellSetBounds)(r))}copyRange(e){function t(t,r){return t.forEachLe(e,((e,t)=>(r=r.setValue(e,t),!0))),r}let{values:r,formats:n,styles:i,formulae:o}=T;const{values:u,formats:l,styles:c,formulae:g}=this.editedContents;r=t(u,r),n=t(l,n),i=t(c,i),g.forEachMeets(e,((t,r)=>(o=o.setValue((0,a.gridRangeIsect)(t,e),r),!0)));const m=(0,a.gridRangeAnchor)(e),h=(0,d.intersectProduct)(this.editedAvailability,(0,s.createCellSetFromRange)(e)),p=N(this.editedUsed,e);return{origin:m,formats:n,styles:i,values:r,formulae:o,availability:h,used:p}}pasteRange(e,r,n){const a=(0,s.createCellSetFromRange)(e),o=(0,i.gridRange)(r.origin.row,r.origin.col,e.rows,e.cols);let{values:u,formats:l,styles:g,formulae:h,dirty:p}=this.editedContents;const f=this.editedUsed,F=e.row-r.origin.row,y=e.col-r.origin.col;function C(e){return(0,i.gridRange)(e.row+F,e.col+y,e.rows,e.cols)}function A(t,r,n){return r.forEachMeets(e,((e,t)=>(r=r.setValue(e,n),!0))),t.forEachLe(o,((e,t)=>(r=r.setValue(C(e),t),!0))),r}const E=k(f,r.used!==t.emptyUsedRange?C(r.used):t.emptyUsedRange),R=N(E,e);u=A(r.values,u,t.blankGridValue),R!==t.emptyUsedRange&&this.setClientValue(R,t.clientValueUnknownOper,n),l=A(r.formats,l,t.blankCellFormat),g=A(r.styles,g,m.SpecialStyle.Blank),R!==t.emptyUsedRange&&this.setClientFormat(R,m.SpecialFormat.ClientValueUnknown,n),h=A(r.formulae,h,t.blankCellGridFormula),p=(0,d.exceptProduct)(p,a);{let{formulae:t}=this.clientContents;t=b(t,e),h.forEachLe(e,((e,{origin:r,compiledFmla:n})=>(void 0!==n&&(p=(0,d.unionProduct)(p,(0,s.createCellSetFromRange)(e))),t=t.setValue(e,{fmla:v.ClientValueUnknown,origin:r,compiledFmla:n,hasHyperlink:S.ClientValueUnknown}),!0))),this.setClientContents({...this.clientContents,formulae:t},n)}const T=!1;var I;this.setContents(T,{values:u,formats:l,styles:g,formulae:h,dirty:p},n),this.editedAvailability=(0,d.exceptProduct)(this.editedAvailability,a),this.unionAvailability(T,(I=r.availability,(0,s.translateAvailabilitySet)(I,F,y))),this.unionTaint(T,R===t.emptyUsedRange?c.empty:(0,s.createCellSetFromRange)(R)),this.unionUsed(T,E)}assumeRecalcFinal(e,t){this.recalcDirty=(0,d.exceptProduct)(this.recalcDirty,e)}getDirtyEditedCells(){return(0,d.intersectProduct)(this.recalcDirty,this.editedTaint)}getNonDirtyEditedCells(){return(0,d.exceptProduct)(this.editedTaint,this.recalcDirty)}getDirtyDependentCells(){return(0,d.exceptProduct)(this.recalcDirty,this.editedTaint)}onCellModified(e,r){const n=e?this.serverContents:this.editedContents;this.setContents(e,n,r),this.unionAvailability(e,c.empty),this.unionTaint(e,c.empty),this.unionUsed(e,t.emptyUsedRange)}clearCompiledFormulas(){for(const e of[this.serverContents.formulae,this.editedContents.formulae])e.forEach(((e,t)=>(void 0!==t.compiledFmla&&t.compiledFmla.reset(),!0)))}getStatistics(){return{serverFormulaeNodeCount:this.serverContents.formulae.getCount(),serverFormatsNodeCount:this.serverContents.formats.getCount(),serverStylesNodeCount:this.serverContents.styles.getCount(),serverValuesNodeCount:this.serverContents.values.getCount(),serverDirtySetSubspaceCount:(0,d.getSubspaceCount)(this.serverContents.dirty),editedFormulaeNodeCount:this.editedContents.formulae.getCount(),editedFormatsNodeCount:this.editedContents.formats.getCount(),editedStylesNodeCount:this.editedContents.styles.getCount(),editedValuesNodeCount:this.editedContents.values.getCount(),editedDirtySetSubspaceCount:(0,d.getSubspaceCount)(this.editedContents.dirty),clientFormulaeNodeCount:this.clientContents.formulae.getCount(),clientFormatsNodeCount:this.clientContents.formats.getCount(),clientValuesNodeCount:this.clientContents.values.getCount(),recalcValuesNodeCount:this.recalcValues.getCount(),recalcDirtySetSubspaceCount:(0,d.getSubspaceCount)(this.recalcDirty),recalcFailuresSetSubspaceCount:(0,d.getSubspaceCount)(this.recalcFailures),recalcTaintSetSubspaceCount:(0,d.getSubspaceCount)(this.recalcTaint),availabilityHistorySize:this.availabilityHistorySize,availabilitySetSubspaceCount:(0,d.getSubspaceCount)(this.editedAvailability),hiddenRowsNodeCount:(0,c.getNodeCount)(this.hiddenRows)+(0,c.getNodeCount)(this.hiddenRowsAvailability),hiddenColsNodeCount:(0,c.getNodeCount)(this.hiddenCols)+(0,c.getNodeCount)(this.hiddenColsAvailability)}}collectGarbage(e,r){let n=c.empty;for(const t in this.oldAvailabilities)if(this.oldAvailabilities.hasOwnProperty(t)){const r=Number(t);if(r>=e){n=(0,d.unionProduct)(n,this.oldAvailabilities[r]);continue}delete this.oldAvailabilities[r],this.availabilityHistorySize-=1}function a(e){return(0,d.meetsProduct)((0,d.intersectProduct)((0,s.createCellSetFromRange)(e),s.availableSetProduct),n)}function i(e,r){return!(0,t.isBlankGridFormula)(r.fmla,void 0!==r.compiledFmla)&&a(e)}function o(e,r){return!(0,t.isBlankCellFormat)(r)&&a(e)}function u(e,t){return t!==m.SpecialStyle.Blank&&a(e)}function l(e,t){return!(!y(t.oper)&&C(t.oper,t.failure))&&a(e)}const g=(0,d.project)(n,"row","col");this.serverContents={formulae:this.serverContents.formulae.filter(i),formats:this.serverContents.formats.filter(o),styles:this.serverContents.styles.filter(u),values:this.serverContents.values.filter(l),dirty:(0,d.intersectProduct)(this.serverContents.dirty,g)},this.editedContents={formulae:this.editedContents.formulae.filter(i),formats:this.editedContents.formats.filter(o),styles:this.editedContents.styles.filter(u),values:this.editedContents.values.filter(l),dirty:(0,d.intersectProduct)(this.editedContents.dirty,g)},this.setClientContents({formulae:this.clientContents.formulae.filter(i),formats:this.clientContents.formats.filter(o),values:this.clientContents.values.filter(l)},r),this.recalcValues=this.recalcValues.filter(l),this.recalcDirty=(0,d.intersectProduct)(this.recalcDirty,g)}constructor(e=T,r=c.empty,n=t.denseUsedRange,a=c.empty,i=c.empty,o=c.empty,s=c.empty,l=(0,u.makeGridRangeTable)(),d=!1,g=!1){this.oldAvailabilities={},this.availabilityHistorySize=0,this.serverContents=e,this.serverAvailability=r,this.serverUsed=n,this.hiddenRows=a,this.hiddenRowsAvailability=i,this.hiddenCols=o,this.hiddenColsAvailability=s,this.mergeCells=l,this.inFilterMode=d,this.filterModeAvailable=g,this.rollBackToServerState(0)}}t.PartialWorkbookGrid=O},41739:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isOutputFormatUnavailable=t.OutputMessageKind=t.FormulaMode=t.SpecialStyle=t.SpecialFormat=t.SetMessageKind=t.mergeRecalcStatistics=t.RecalcStatisticsMessage=t.emptyRecalcStatistics=t.ComputedCellKind=t.ComputeKind=t.sheetInFilterMode=t.sheetHiddenRows=t.sheetUsedRange=t.createSheetCellSetFromRange=t.sheetCellSet=t.UnavailableKind=void 0;const n=r(57786),a=r(73701);var i,o,s,u,l,c,d,g,m;function h(e,t){return{sheet:e,set:t}}function p(e,t){return{...e,[t]:(e[t]??0)+1}}!function(e){e.DocumentLoc="DocumentLoc",e.SheetId="SheetId",e.SheetNames="SheetNames",e.GridRange="GridRange",e.GridRangeSize="GridRangeSize",e.CellFormat="CellFormat",e.CellStyle="CellStyle",e.HiddenRows="HiddenRows",e.HiddenCols="HiddenCols",e.InFilterMode="InFilterMode",e.CellFormula="CellFormula",e.CellMissingFormula="CellMissingFormula",e.CellEvaluatingValue="CellEvaluatingValue",e.EvalFailure="EvalFailure",e.ClientFailure="ClientFailure",e.NumberFormat="NumberFormat",e.StyleId="StyleId",e.FontId="FontId",e.FillId="FillId",e.BorderId="BorderId",e.NameLoc="NameLoc",e.VolatileFunction="VolatileFunction",e.TimeGranularity="TimeGranularity",e.GetTimeKind="GetTimeKind",e.ColumnName="ColumnName",e.ContainingTable="ContainingTable",e.NamedRanges="NamedRanges"}(i||(t.UnavailableKind=i={})),t.sheetCellSet=h,t.createSheetCellSetFromRange=function(e){return h(e.sheet,(0,n.createCellSetFromRange)(e.range))},t.sheetUsedRange=function(e,t){return{sheet:e,range:t}},t.sheetHiddenRows=function(e,t,r){return{sheet:e,range:t,hidden:r}},t.sheetInFilterMode=function(e,t){return{sheet:e,inFilterMode:t}},function(e){e.PrecisionTest="PrecisionTest",e.EditedCell="EditedCell",e.DependentCell="DependentCell",e.EvalFormula="EvalFormula",e.ParseEdit="ParseEdit"}(o||(t.ComputeKind=o={})),function(e){e.EditedCell="EditedCell",e.DependentCell="DependentCell",e.IndependentCell="IndependentCell",e.UnknownNonEditedCell="UnknownNonEditedCell"}(s||(t.ComputedCellKind=s={})),t.emptyRecalcStatistics={calculatedCellCount:{},changedCellCount:{},continueCount:0,editFinishedCount:0,stateTimedOut:!1,recalcFinishedCount:0},function(e){e.ChangedCell="ChangedCell",e.UnchangedCell="UnchangedCell",e.ContinueComputation="ContinueComputation",e.EditFinished="EditFinished",e.StateTimedOut="StateTimedOut",e.RecalcFinished="RecalcFinished"}(u||(t.RecalcStatisticsMessage=u={})),t.mergeRecalcStatistics=function(e,t){switch(t.message){case u.ChangedCell:return{...e,changedCellCount:p(e.changedCellCount,t.cellKind),calculatedCellCount:p(e.calculatedCellCount,t.cellKind)};case u.UnchangedCell:return{...e,calculatedCellCount:p(e.calculatedCellCount,t.cellKind)};case u.ContinueComputation:return{...e,continueCount:e.continueCount+1};case u.StateTimedOut:return{...e,stateTimedOut:!0};case u.EditFinished:return{...e,editFinishedCount:e.editFinishedCount+1};case u.RecalcFinished:return{...e,recalcFinishedCount:e.recalcFinishedCount+1};default:return(0,a.assertNever)("calc.calc.partialWorkbookMessages.mergeRecalcStatistics",t)}},function(e){e.SetSheetNames="SetSheetNames",e.SetRefStyle="SetRefStyle",e.SetLocaleInfo="SetLocaleInfo",e.SetNumberFormats="SetNumberFormats",e.WriteNamedObject="WriteNamedObject",e.WriteUndefinedNames="WriteUndefinedNames",e.PromoteNamedObjects="PromoteNamedObjects",e.ExtendUnusedRange="ExtendUnusedRange",e.WriteHiddenRows="WriteHiddenRows",e.WriteInFilterMode="WriteInFilterMode",e.SetCellContents="SetCellContents",e.SetRangeFormula="SetRangeFormula",e.PromoteCellContents="PromoteCellContents"}(l||(t.SetMessageKind=l={})),function(e){e.Unavailable="Unavailable",e.Weak="Weak",e.ClientValueUnknown="ClientValueUnknown",e.Origin="Origin",e.Aggregate="Aggregate",e.Inferred="Inferred",e.Known="Known",e.Edit="Edit"}(c||(t.SpecialFormat=c={})),function(e){e.Unavailable="Unavailable",e.Weak="Weak",e.Blank="Blank"}(d||(t.SpecialStyle=d={})),function(e){e.EvalFormula="eval-formula",e.ServerCellFormula="server-cell-formula",e.EditCellFormula="edit-cell-formula",e.ServerNamedFormula="server-named-formula",e.EditNamedFormula="edit-named-formula"}(g||(t.FormulaMode=g={})),function(e){e.StateAdvanced="StateAdvanced",e.CellWrite="CellWrite",e.RangeWrite="RangeWrite",e.NameFailure="NameFailure",e.RangeFailure="RangeFailure",e.NumberFormatFailure="NumberFormatFailure",e.PrintFormulaFailure="PrintFormulaFailure",e.InferFormatFailure="InferFormatFailure",e.FormatValueFailure="FormatValueFailure",e.UnhandledFailure="UnhandledFailure",e.UpdateRequest="UpdateRequest",e.UpdateNamesRequest="UpdateNamesRequest",e.GarbageCollected="GarbageCollected",e.Alert="Alert",e.RecalcStatistics="RecalcStatistics",e.WorkbookStatistics="WorkbookStatistics",e.ExperimentRunResult="ExperimentRunResult"}(m||(t.OutputMessageKind=m={})),t.isOutputFormatUnavailable=function(e){return"object"==typeof e}},35885:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbookNameManager=void 0;const n=r(60140),a=r(36159),i=r(1765),o=r(12973),s=r(92587),u=r(73701),l=r(97207),c=r(58251),d=r(24098),g=r(41739);class m{clone(){let e;if(this.sheetScopedNames){e=(0,a.makeStringMap)();for(const t in this.sheetScopedNames){const r=this.sheetScopedNames[t];e[t]=r.clone()}}return new m(this.document,this.stringCompareCI,e,void 0,this.globalNames.clone())}setNamedObject(e,t,r,a){const o=this.getNameFormula(t,n.NameSource.StructRef);void 0!==r&&"NamedTable"===r.kind&&(0,i.isSuccess)(o)&&void 0!==o.value&&"NamedTable"===o.value.obj.kind&&(0,l.isNamedTableRangeEqual)(o.value.obj,r)&&(r=(0,l.mergeNamedTables)(o.value.obj,r));const s=this.getNamesBySheetId(t.scope.index);return s.kind===i.ResultKind.Failure?s:s.value.setNamedObject(e,t,r,a,this.onWriteNamedObject)}setUndefinedNames(e){const t=this.getNamesBySheetId(e.index);return t.kind===i.ResultKind.Failure?t:(0,i.success)(t.value.setUndefinedNames())}promoteNamedObjects(e,t){const r=this.getNamesBySheetId(e.index);return r.kind===i.ResultKind.Failure?r:r.value.promoteNamedObjects(t,this.onWriteNamedObject)}setSheetNames(e){const t=this.sheetScopedNames??this.oldSheetScopedNames,r=(0,a.makeStringMap)();for(const{sheetId:a}of e)r[a]=t?.[a]??new l.PartialWorkbookNames(this.stringCompareCI,(0,n.sheetIndex)(this.document,a));return new m(this.document,this.stringCompareCI,r,void 0,this.globalNames)}getNameLoc(e,t,r){const n=this.getNamesBySheetId(e);if(n.kind===i.ResultKind.Failure)return n;const a=n.value.getNameLoc(t,r);return a.kind,i.ResultKind.Failure,a}getAvailableNamesInScope(e){const t=this.getAllDocumentNames(),r=this.getNamesBySheetId(e);return r.kind===i.ResultKind.Success&&(0,a.safePush)(t,r.value.getAvailableNames((0,n.nameScope)(this.document,e))),t}getAllDocumentNames(){return this.globalNames.getAvailableNames((0,n.documentScope)(this.document))}getAvailableTableColumns(e){const t=this.getNameFormula(e,n.NameSource.StructRef),r=[];if(t.kind!==i.ResultKind.Success||void 0===t.value||"NamedTable"!==t.value.obj.kind)return{cols:r,isPartial:!0};const a=!t.value.obj.allColumnNamesAvailable;return t.value.obj.columnNames.forEach((e=>(r.push(e),!0))),{cols:r,isPartial:a}}getNameFormula(e,t){const r=this.getNamesBySheetId(e.scope.index);return r.kind===i.ResultKind.Failure?r:r.value.getNameFormula(e.name,t)}hasRecalcNameFailure(e){const t=this.getNamesBySheetId(e.scope.index);return t.kind===i.ResultKind.Failure?t:(0,i.success)(t.value.hasRecalcFailure(e.name))}setRecalcNameFailure(e){const t=this.getNamesBySheetId(e.scope.index);return t.kind===i.ResultKind.Failure?t:(0,i.success)(t.value.setRecalcFailure(e.name))}getNamesBySheetId(e){if(void 0===e)return(0,i.success)(this.globalNames);if(!this.sheetScopedNames)return(0,i.failure)((0,s.unavailable)([{kind:g.UnavailableKind.SheetNames}]));const t=this.sheetScopedNames[e];return void 0===t?(0,i.failure)((0,s.unavailable)([{kind:g.UnavailableKind.SheetId,document:this.document,sheetId:e}])):(0,i.success)(t)}getContainingTable(e){const t=this.getNamesBySheetId(e.sheet.index);return t.kind===i.ResultKind.Failure?t:(0,i.success)(t.value.getContainingTable(e.range))}getNamedRanges(e){const t=this.getNamesBySheetId(e.sheet.index);return t.kind===i.ResultKind.Failure?t:(0,i.success)(t.value.getNamedRanges(e.range))}getIntersectingTables(e){const t=this.getNamesBySheetId(e.sheet.index);return t.kind===i.ResultKind.Failure?t:(0,i.success)(t.value.getIntersectingTables(e.range))}getStructRefColumn(e,t){const r=this.getNameFormula(e,n.NameSource.StructRef);if(r.kind===i.ResultKind.Failure)return r;if(void 0===r.value)return(0,i.success)(void 0);if("NamedTable"!==r.value.obj.kind)return(0,i.failure)((0,c.invalidStructRef)(c.InvalidStructRefReason.NamedObjectNotTable));const a=r.value.obj;let u;if("string"==typeof t)u=a.columnNames.getEntry(t);else{const e=a.columnIndexes.getValue(t);u=void 0===e?void 0:(0,d.entry)(e,t)}if(void 0===u)return a.allColumnNamesAvailable?(0,i.success)(void 0):(0,i.failure)((0,s.unavailable)([{kind:g.UnavailableKind.ColumnName,table:e,columnNameOrIndex:t}]));const{sheet:l,range:m}=a.specialRefRanges[o.SpecialRefId.Data],h=(0,n.sheetGridRange)(l,(0,n.gridRange)(m.row,u.value,m.rows,1));return(0,i.success)((0,n.structRefColumnLoc)(u.key,h,a.hasHeadersRow,a.hasTotalsRow))}getStructRefSpecialRef(e,t){const r=this.getNameFormula(e,n.NameSource.StructRef);return r.kind===i.ResultKind.Failure?r:void 0===r.value?(0,i.success)(void 0):"NamedTable"!==r.value.obj.kind?(0,i.failure)((0,c.invalidStructRef)(c.InvalidStructRefReason.NamedObjectNotTable)):(0,i.success)(r.value.obj.specialRefRanges[t])}onCellModified(e){this.forEachSheetScope((t=>{t.onCellModified(e)})),this.globalNames.onCellModified(e)}collectGarbage(e){this.forEachSheetScope((t=>{t.collectGarbage(e)})),this.globalNames.collectGarbage(e)}advanceState(e){this.forEachSheetScope((t=>{t.advanceState(e)})),this.globalNames.advanceState(e),this.oldSheetScopedNames=this.sheetScopedNames,this.sheetScopedNames=void 0}resetLazyData(){this.forEachSheetScope((e=>{e.resetLazyData()})),this.globalNames.resetLazyData()}getNameStatistics(){let e=this.globalNames.getStatistics();return this.forEachSheetScope((t=>e=(0,l.mergeNameStatistics)(e,t.getStatistics()))),e}forEachSheetScope(e){for(const t in this.sheetScopedNames)Object.prototype.hasOwnProperty.call(this.sheetScopedNames,t)&&e(this.sheetScopedNames[t])}constructor(e,t,r,a,c){this.document=e,this.stringCompareCI=t,this.sheetScopedNames=r,this.oldSheetScopedNames=a,this.onWriteNamedObject=(e,t,r)=>{if("NamedRange"===t.kind){const n=t.value;(0,u.assertTrue)("calc.calc.PartialWorkbookDocument.onWriteNamedObject: bad range",(0,s.isDocumentLocEqual)(t.value.sheets.document,e.scope.document));const a=this.getNamesBySheetId(n.sheets.index);if(a.kind===i.ResultKind.Failure)return a;a.value.onWriteNamedRange(e,t,r)}if("NamedTable"===t.kind){const n=this.getNamesBySheetId(t.specialRefRanges[o.SpecialRefId.All].sheet.index);if(n.kind===i.ResultKind.Failure)return n;n.value.onWriteNamedTable(e,t,r)}return i.successUndefined},this.globalNames=c??new l.PartialWorkbookNames(t,(0,n.documentScope)(e))}}t.PartialWorkbookNameManager=m},97207:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbookNames=t.isNamedTableRangeEqual=t.mergeNameStatistics=t.emptyNameStatistics=t.namedFailure=t.namedFormula=t.mergeNamedTables=t.namedTable=t.namedRange=t.namedValue=void 0;const n=r(24945),a=r(60140),i=r(36159),o=r(4595),s=r(43595),u=r(1765),l=r(12973),c=r(92587),d=r(73701),g=r(74599),m=r(41739);t.namedValue=(0,i.typedInstanceCreator)()((e=>({kind:"NamedValue",value:e}))),t.namedRange=(0,i.typedInstanceCreator)()((e=>({kind:"NamedRange",value:e})));const h=s.RedBlackMapTree.create(((e,t)=>e-t));t.namedTable=function(e,t,r,n,i){const{sheet:o,range:u}=e,g=t?(0,a.gridRange)(u.row-1,u.col,1,u.cols):void 0,m=r?(0,a.gridRange)(u.row+u.rows,u.col,1,u.cols):void 0,p=(0,c.gridRangeJoinOpt)((0,c.gridRangeJoinOpt)(g,e.range),m),f=n.reduce(((t,r)=>((0,d.assertTrue)("calc.calc.namedTable: column names in range",r.column>=e.range.col&&r.column<e.range.col+e.range.cols),t.setValue(r.column,r.name))),h);let S=s.RedBlackMapTree.create(i);f.forEach(((e,t)=>(S=S.setValue(t,e),!0)));const v=f.getCount()===e.range.cols;return{kind:"NamedTable",specialRefRanges:{[l.SpecialRefId.Data]:e,[l.SpecialRefId.Headers]:g?(0,a.sheetGridRange)(o,g):void 0,[l.SpecialRefId.Totals]:m?(0,a.sheetGridRange)(o,m):void 0,[l.SpecialRefId.All]:(0,a.sheetGridRange)(o,p)},columnNames:S,columnIndexes:f,allColumnNamesAvailable:v,hasHeadersRow:t,hasTotalsRow:r}},t.mergeNamedTables=function(e,t){let r=e.columnNames,n=e.columnIndexes;t.columnIndexes.forEach(((t,n)=>{const a=e.columnIndexes.getValue(t);return void 0!==a&&(r=r.remove(a)),!0})),t.columnIndexes.forEach(((e,t)=>(r=r.setValue(t,e),n=n.setValue(e,t),!0)));const a=n.getCount()===t.specialRefRanges[l.SpecialRefId.All].range.cols;return{...t,columnNames:r,columnIndexes:n,allColumnNamesAvailable:a}},t.namedFormula=(0,i.typedInstanceCreator)()((e=>({kind:"NamedFormula",fmla:e}))),t.namedFailure=(0,i.typedInstanceCreator)()(((e,t)=>({kind:"NamedFailure",failureReason:e,objectKind:t})));const p=(0,g.makeGridRangeTable)(),f=(0,g.makeGridRangeTable)();t.emptyNameStatistics={namesCount:0,tablesCount:0,rangesCount:0,recalcFailuresCount:0,scopes:0,allAvailableScopes:0},t.mergeNameStatistics=function(e,t){return{namesCount:e.namesCount+t.namesCount,tablesCount:e.tablesCount+t.tablesCount,rangesCount:e.rangesCount+t.rangesCount,recalcFailuresCount:e.recalcFailuresCount+t.recalcFailuresCount,scopes:e.scopes+t.scopes,allAvailableScopes:e.allAvailableScopes+t.allAvailableScopes}},t.isNamedTableRangeEqual=function(e,t){return(0,c.isSheetGridRangeEqual)(e.specialRefRanges[l.SpecialRefId.Data],t.specialRefRanges[l.SpecialRefId.Data])&&e.hasHeadersRow===t.hasHeadersRow&&e.hasTotalsRow===t.hasTotalsRow};class S{static create(e){return new S(s.RedBlackMapTree.create(e),!1,p,f)}update(e,t,r,n){return e!==this.names||t!==this.allAvailable||r!==this.tables||n!==this.ranges?new S(e,t,r,n):this}getEntry(e,t,r){const n=this.names.getEntry(t);return void 0===n?this.allAvailable?(0,u.success)(void 0):(0,u.failure)((0,c.unavailable)([{kind:m.UnavailableKind.NameLoc,name:(0,a.nameLoc)(e,t),source:r}])):(0,u.success)(!1!==n.value?n:void 0)}getEntryIfDefined(e){const t=this.names.getEntry(e);if(void 0!==t)return!1!==t.value?t:void 0}setValue(e,t){return this.update(this.names.setValue(e,t),this.allAvailable,this.tables,this.ranges)}remove(e){return this.update(this.allAvailable?this.names.remove(e):this.names.setValue(e,!1),this.allAvailable,this.tables,this.ranges)}getContainingTable(e){let t;return this.tables.forEachGe(e,((e,r)=>(t=r,!1))),t}getIntersectingTables(e){const t=[];return this.tables.forEachMeets(e,((e,r)=>(t.push(r),!0))),t}getNamedRanges(e){return this.ranges.getValue(e)??[]}getAvailableNames(e){const t=[];return this.names.forEach(((r,n)=>(!1!==n&&t.push((0,a.nameLoc)(e,r)),!0))),t}forEachAvailableName(e){return this.names.forEach(((t,r)=>e(t,!1===r?void 0:r)))}setUndefined(){return this.update(this.names,!0,this.tables,this.ranges)}getStatistics(e){return{namesCount:this.names.getCount(),tablesCount:this.tables.getCount(),rangesCount:this.ranges.getCount(),recalcFailuresCount:e,scopes:1,allAvailableScopes:this.allAvailable?1:0}}collectGarbage(){return this.update(this.allAvailable?this.names.filter(((e,t)=>!1!==t)):this.names,this.allAvailable,this.tables,this.ranges)}resetLazyData(){this.names.forEach(((e,t)=>(!1!==t&&t.lazyData.reset(),!0)))}onWriteNamedTable(e,t,r){const n=t.specialRefRanges[l.SpecialRefId.All].range;return this.update(this.names,this.allAvailable,"remove"===r?this.tables.remove(n):this.tables.setValue(n,e),this.ranges)}onWriteNamedRange(e,t,r){const n=t.value.ranges[0],a=this.ranges.getValue(n)??[],i="remove"===r?a.filter((t=>(0,c.isNameScopeEqual)(e.scope,t.scope)&&e.name===t.name)):[...a,e];return this.update(this.names,this.allAvailable,this.tables,0===i.length?this.ranges.remove(n):this.ranges.setValue(n,i))}constructor(e,t,r,n){this.names=e,this.allAvailable=t,this.tables=r,this.ranges=n}}class v{clone(){const e=new v(this.stringCompareCI,this.scope);return e.contents=this.contents,e}advanceState(e){this.oldContents=this.contents,this.oldStateId=this.isCurrent?e:void 0,this.contents=this.emptyContents,this.isCurrent=this.isChanged=!1,this.recalcFailures=this.emptyRecalcFailures}getStatistics(){return this.contents.getStatistics(this.recalcFailures.getCount())}collectGarbage(e){void 0===this.oldStateId||this.oldStateId<e?(this.oldContents=this.emptyContents,this.oldStateId=void 0):this.oldContents=this.oldContents.collectGarbage(),this.contents=this.contents.collectGarbage()}getNameLoc(e,t){const r=this.contents.getEntry(this.scope,e,t);return(0,u.isSuccess)(r)?(0,u.success)(void 0!==r.value?(0,a.nameLoc)(this.scope,r.value.key):void 0):r}getNameFormula(e,t){const r=this.contents.getEntry(this.scope,e,t);return(0,u.isSuccess)(r)?(0,u.success)(void 0!==r.value?r.value.value:void 0):r}getContainingTable(e){return this.contents.getContainingTable(e)}getIntersectingTables(e){return this.contents.getIntersectingTables(e)}getNamedRanges(e){return this.contents.getNamedRanges(e)}allAvailable(){return this.contents.allAvailable}getAvailableNames(e){return this.contents.getAvailableNames(e)}hasRecalcFailure(e){return this.recalcFailures.contains(e)}setRecalcFailure(e){this.recalcFailures=this.recalcFailures.setValue(e,!0)}onCellModified(e){this.recalcFailures=this.emptyRecalcFailures}resetLazyData(){this.contents.resetLazyData(),this.oldContents!==this.contents&&this.oldContents.resetLazyData()}setNamedObject(e,t,r,n,i){const s=this.contents.getEntryIfDefined(t.name);if(void 0!==s){const e=i((0,a.nameLoc)(this.scope,s.key),s.value.obj,"remove");if(e.kind===u.ResultKind.Failure)return e}if(this.contents=void 0===r?this.contents.remove(t.name):this.contents.setValue(t.name,{obj:r,lazyData:new o.ResettableLazy((()=>n(e,t,r)))}),this.isCurrent=this.isChanged=!0,void 0!==r){const e=i(t,r,"add");if(e.kind===u.ResultKind.Failure)return e}return u.successUndefined}setUndefinedNames(){this.contents=this.contents.setUndefined(),this.isCurrent=this.isChanged=!0}promoteNamedObjects(e,t){if(this.isChanged||e!==this.oldStateId)return(0,u.success)(!1);this.contents=this.oldContents,this.isCurrent=!0;let r=(0,u.success)(!0);return this.contents.forEachAvailableName(((e,n)=>{if(void 0===n)return!0;const i=t((0,a.nameLoc)(this.scope,e),n.obj,"add");return i.kind===u.ResultKind.Success||(r=i,!1)})),r}onWriteNamedTable(e,t,r){this.contents=this.contents.onWriteNamedTable(e,t,r)}onWriteNamedRange(e,t,r){this.contents=this.contents.onWriteNamedRange(e,t,r)}forEachAvailableName(e){return this.contents.forEachAvailableName(e)}constructor(e,t){this.stringCompareCI=e,this.scope=t,this.isCurrent=!1,this.isChanged=!1,this.oldContents=this.contents=this.emptyContents=S.create(e),this.emptyRecalcFailures=this.recalcFailures=n.ArrayMapTree.create(e)}}t.PartialWorkbookNames=v},57786:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.translateAvailabilitySet=t.forEachCellInSet=t.forEachRangeInSet=t.forEachCol=t.forEachRow=t.availableAllProduct=t.availableReadProduct=t.availableSetProduct=t.cellSetBounds=t.createCellSetFromRange=t.bspFactory=t.availabilityOperations=t.anyAvailability=t.AvailabilityKind=void 0;const n=r(60140),a=r(92587),i=r(5033),o=r(26795),s=r(97902),u=r(89817);var l;!function(e){e[e.AvailableSet=0]="AvailableSet",e[e.AvailableRead=1]="AvailableRead"}(l||(t.AvailabilityKind=l={})),t.anyAvailability=[l.AvailableSet,l.AvailableRead+1];const c=[0,n.sheetRows],d=[0,n.sheetCols];t.availabilityOperations=(0,s.boundedParetoSetOperations)(1,t.anyAvailability[0]+1,t.anyAvailability[1],t.anyAvailability,"Availability operations, alpha = 1");const g=(0,s.boundedParetoSetOperations)(.2,c[0]+1,c[1],c,"Row operations, alpha = 0.2"),m=(0,s.boundedParetoSetOperations)(.35,d[0]+1,d[1],d,"Col operations, alpha = 0.35"),h={availability:t.availabilityOperations,row:g,col:m};function p(e,t){return e!==o.dense?(0,o.forEachKey)(e,t):t(h.row.top)}function f(e,t){return e!==o.dense?(0,o.forEachKey)(e,t):t(h.col.top)}function S(e,t){return(0,u.forEachProduct)(e,(e=>p(e.row,(r=>{const[a,i]=r;return f(e.col,(e=>{const[r,o]=e;return t((0,n.gridRange)(a,r,i-a,o-r))}))}))),"row","col")}t.bspFactory={availability:(0,o.createFromKey)(h.availability),row:(0,o.createFromKey)(h.row),col:(0,o.createFromKey)(h.col)},t.createCellSetFromRange=function(e){return(0,u.createFromProduct)({row:t.bspFactory.row([e.row,e.row+e.rows]),col:t.bspFactory.col([e.col,e.col+e.cols])})},t.cellSetBounds=function(e){if(e===o.empty)return;const t=e===o.dense?void 0:e.root.bounds.row,r=e===o.dense?void 0:e.root.bounds.col,[a,s]=void 0===t?h.row.top:function(e){const t=[];return p(e,(e=>(t.push(e),!0))),t.reduce(i.ivlJoin)}((0,o.fromUntyped)(h.row,t)),[u,l]=void 0===r?h.col.top:function(e){const t=[];return f(e,(e=>(t.push(e),!0))),t.reduce(i.ivlJoin)}((0,o.fromUntyped)(h.col,r));return(0,n.gridRange)(a,u,s-a,l-u)},t.availableSetProduct=(0,u.createFromProduct)({availability:t.bspFactory.availability([l.AvailableSet,l.AvailableSet+1])}),t.availableReadProduct=(0,u.createFromProduct)({availability:t.bspFactory.availability([l.AvailableRead,l.AvailableRead+1])}),t.availableAllProduct=(0,u.createFromProduct)({availability:t.bspFactory.availability([l.AvailableSet,l.AvailableRead+1])}),t.forEachRow=p,t.forEachCol=f,t.forEachRangeInSet=S,t.forEachCellInSet=function(e,t){return S(e,(e=>(0,a.forEachCellInRange)(e,t)))},t.translateAvailabilitySet=function(e,r,n){let a=o.empty;return(0,u.forEachProduct)(e,(e=>{let i=o.empty;p(e.row,(([e,n])=>(i=(0,o.union)(i,t.bspFactory.row([e+r,n+r])),!0)));let s=o.empty;f(e.col,(([e,r])=>(s=(0,o.union)(s,t.bspFactory.col([e+n,r+n])),!0)));const l=(0,u.createFromProduct)({row:i,col:s,availability:e.availability});return a=(0,u.unionProduct)(a,l),!0}),"row","col","availability"),a}},37919:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbookSheets=void 0;const n=r(24945),a=r(36159),i=r(60140),o=r(1765),s=r(92587),u=r(41739);class l{clone(){return new l(this.document,this.stringCompareCI,this.sheetPosToId,this.sheetNameToId,this.data,void 0)}setSheetNames(e){const t=this.data??this.oldData,r=(0,a.makeStringMap)(),o=[],s=[];for(let n=0;n<e.length;n+=1){const{sheetName:a,sheetId:u}=e[n];o[n]=u,s.push([a,u]);const l=t?.[u];if(void 0===l){const e=(0,i.sheetIndex)(this.document,u);r[u]={pos:n,name:a,sheetIndex:e}}else r[u]={...l,pos:n,name:a}}const u=n.ArrayMapTree.create(this.stringCompareCI).setValues(s);return new l(this.document,this.stringCompareCI,o,u,r,void 0)}advanceState(e){this.oldData=this.data,this.sheetPosToId=void 0,this.sheetNameToId=void 0,this.data=void 0}getSheetRangeIds(e){let t,r;if(!this.sheetPosToId)return(0,o.failure)((0,s.unavailable)([{kind:u.UnavailableKind.SheetNames}]));if(void 0===e.index)t=0,r=this.sheetPosToId.length;else{const n=this.getSheetById(e.index);if(!(0,o.isSuccess)(n))return n;const i=this.getSheetById(e.index2);if(!(0,o.isSuccess)(i))return i;t=(0,a.fastMin)(n.value.pos,i.value.pos),r=(0,a.fastMax)(n.value.pos,i.value.pos)+1}const n=[];for(let e=t;e<r;e+=1)n.push(this.sheetPosToId[e]);return(0,o.success)((0,i.sheetRangeIndexes)(n,t))}getSheetById(e){if(!this.data)return(0,o.failure)((0,s.unavailable)([{kind:u.UnavailableKind.SheetNames}]));const t=this.data[e];return void 0===t?(0,o.failure)((0,s.unavailable)([{kind:u.UnavailableKind.SheetId,document:this.document,sheetId:e}])):(0,o.success)(t)}getSheetByName(e){if(!this.sheetNameToId)return(0,o.failure)((0,s.unavailable)([{kind:u.UnavailableKind.SheetNames}]));const t=this.sheetNameToId.getValue(e);return void 0===t?(0,o.success)(void 0):this.getSheetById(t)}forEachSheet(e){if(this.sheetPosToId&&this.data)for(const t of this.sheetPosToId){const r=this.data[t];r&&e(r,t)}}constructor(e,t,r,n,a,i){this.document=e,this.stringCompareCI=t,this.sheetPosToId=r,this.sheetNameToId=n,this.data=a,this.oldData=i}}t.PartialWorkbookSheets=l},8101:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbookStyles=t.blankStyleValue=void 0;const n=r(1765),a=r(3030),i=r(41739),o={type:a.BorderLineType.None,color:{argb:"00000000"}};t.blankStyleValue={font:{name:"Calibri",bold:!1,italic:!1,underline:a.FontUnderline.None,strikethrough:!1,verticalAlign:a.FontVerticalAlignment.None,size:11,color:{argb:"ff000000"}},fill:{kind:a.FillKind.Pattern,pattern:a.PatternType.None,fgColor:{argb:"00000000"},bgColor:{argb:"00000000"}},border:{top:o,bottom:o,left:o,right:o},alignment:{horizontal:a.HorizontalAlignment.Automatic,vertical:a.VerticalAlignment.Bottom,textRotation:0,wrapText:!1,indent:0,relativeIndent:0,shrinkToFit:!1,readingOrder:0}};class s{clone(){function e(e,t){Object.keys(e).map(Number).forEach((r=>{t[r]=e[r]}))}const t=new s;return e(this.styles,t.styles),e(this.fonts,t.fonts),e(this.fills,t.fills),e(this.borders,t.borders),t}resolveCellStyle(e){if(e===i.SpecialStyle.Blank)return(0,n.success)(t.blankStyleValue);const r=this.styles[e];if(void 0===r)return(0,n.failure)({kind:i.UnavailableKind.StyleId,styleId:e});const{fontId:a,fillId:o,borderId:s,alignment:u}=r,l=void 0!==a?this.fonts[a]:t.blankStyleValue.font;if(void 0===l)return(0,n.failure)({kind:i.UnavailableKind.FontId,fontId:a});const c=void 0!==o?this.fills[o]:t.blankStyleValue.fill;if(void 0===c)return(0,n.failure)({kind:i.UnavailableKind.FillId,fillId:o});const d=void 0!==s?this.borders[s]:t.blankStyleValue.border;return void 0===d?(0,n.failure)({kind:i.UnavailableKind.BorderId,borderId:s}):(0,n.success)({font:l,fill:c,border:d,alignment:u})}setStyles(e,t){t||(this.styles=[]),Object.keys(e).map(Number).forEach((t=>{this.styles[t]=e[t]}))}setFonts(e,t){t||(this.fonts=[]),Object.keys(e).map(Number).forEach((t=>{this.fonts[t]=e[t]}))}setFills(e,t){t||(this.fills=[]),Object.keys(e).map(Number).forEach((t=>{this.fills[t]=e[t]}))}setBorders(e,t){t||(this.borders=[]),Object.keys(e).map(Number).forEach((t=>{this.borders[t]=e[t]}))}constructor(){this.styles=[],this.fonts=[],this.fills=[],this.borders=[]}}t.PartialWorkbookStyles=s},62703:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PriorityScheduler=t.QueuePos=void 0;const n=r(96482);var a;!function(e){e[e.Back=0]="Back",e[e.Front=1]="Front"}(a||(t.QueuePos=a={})),t.PriorityScheduler=class{deleteTasks(e,t){const r=this.taskDeqs[e];if(!r)return;let n;for(;n=r.popFront();)"function"!=typeof n&&n.onDeleted&&n.onDeleted(t)}addTask(e,t,r){const i=this.taskDeqs[e]??(this.taskDeqs[e]=new n.Deque);t===a.Back?i.pushBack(r):i.pushFront(r),e<this.minPriority&&(this.minPriority=e)}runTask(){for(let e=this.minPriority;e<this.taskDeqs.length;e+=1){this.minPriority=e;const t=this.taskDeqs[e]?.popFront();if(t)return"function"==typeof t?t():t.onRun(),!0}return!1}getCount(e){return void 0!==e?this.taskDeqs[e]?.getCount()??0:this.taskDeqs.reduce(((e,t)=>t?e+t.getCount():e),0)}constructor(){this.minPriority=0,this.taskDeqs=[]}}},73119:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.recalcServiceInsideInit=t.RecalcServiceImpl=void 0;const n=r(74643).__importStar(r(11093)),a=r(82438),i=r(36159),o=r(73506),s=r(60140),u=r(91304),l=r(57786),c=r(53111),d=r(55),g=r(41739),m=r(96978),h=r(92587),p=r(26795),f=r(89817),S=r(73701),v=r(14009),F=r(83264),y=r(94973),C=r(64327),A=r(3028),E=r(90437),b=r(82602),R=r(1765),T=r(60756),k=r(61855),N=r(14907),I=r(70052),O=r(40238),_=r(4595),P=r(59731);class M{setOutputStateId(e){e<=this.currentOutputStateId||(this.flush(),this.currentOutputStateId=e)}pushCellWrite(e,t){(e!==g.ComputedCellKind.DependentCell?this.editedRangeDeltas:this.dependentRangeDeltas).push(t)}pushRangeWrite(e,t){(0,i.safePush)(e!==g.ComputedCellKind.DependentCell?this.editedRangeDeltas:this.dependentRangeDeltas,t)}pushRangeFailure(e,t){(e!==g.ComputedCellKind.DependentCell?this.editedRangeFailures:this.dependentRangeFailures).push(t)}pushUpdateRequest(e){this.rangeUpdateRequests.push(e)}pushUpdateNameRequest(e){this.namesUpdateRequests.push(e.index)}pushRecalcFinished(e){this.recalcFinished=this.recalcFinished||e}isRecalcFinished(){return this.recalcFinished}flush(){(this.rangeUpdateRequests.length>0||this.namesUpdateRequests.length>0)&&(this.onUpdateRequest((0,u.updateRequest)(this.rangeUpdateRequests,[],this.namesUpdateRequests)),this.rangeUpdateRequests=[],this.namesUpdateRequests=[]),(this.editedRangeDeltas.length>0||this.editedRangeFailures.length>0)&&(this.sendRecalcResults("Edited",this.editedRangeDeltas,[],this.editedRangeFailures),this.editedRangeDeltas=[],this.editedRangeFailures=[]),(this.dependentRangeDeltas.length>0||this.dependentRangeFailures.length>0)&&(this.sendRecalcResults("Dependents",this.dependentRangeDeltas,[],this.dependentRangeFailures),this.dependentRangeDeltas=[],this.dependentRangeFailures=[]),this.recalcFinished&&(this.onRecalcResults((0,u.recalcResults)(this.currentOutputStateId,"Dependents",!0,[],[],[])),this.recalcFinished=!1)}sendRecalcResults(e,t,r,n){for(let a=0;a<(0,i.fastMax)((0,i.fastMax)(t.length,r.length),n.length);a+=10)this.onRecalcResults((0,u.recalcResults)(this.currentOutputStateId,e,!1,t.slice(a,a+10),r.slice(a,a+10),n.slice(a,a+10)))}constructor(e,t,r){this.onRecalcResults=e,this.onUpdateRequest=t,this.currentOutputStateId=r,this.editedRangeDeltas=[],this.dependentRangeDeltas=[],this.editedRangeFailures=[],this.dependentRangeFailures=[],this.rangeUpdateRequests=[],this.namesUpdateRequests=[],this.recalcFinished=!1}}function D({kind:e}){return{kind:e}}class w{get document(){return this.dataTransformer.document}get mathpack(){return this.dataTransformer.getLangConfig().mathpack}ping(){}setInputStateId(e,t){const r=e-this.currentInputStateId;return r<0?(this.logInputStateIdDecrease(t),!1):(0!==r&&(this.flushInputLogs(),this.currentInputStateId=e),!0)}setOutputStateId(e){const t=e-this.currentOutputStateId;return t<0?(this.logOutputStateIdDecrease(),!1):(0!==t&&(this.flushOutputLogs(),this.currentOutputStateId=e),!0)}clearAsyncResumeRecalc(){void 0!==this.recalcLoop&&this.recalcLoop.stop()}resumeRecalc(){this.flushInputLogs(),this.clearAsyncResumeRecalc(),this.recalcLoop=this.asyncLoopFactory((()=>{const{messages:e,queueEmpty:t}=this.dataModel.step();return e.length>0&&this.processRecalcResults(e),t?void 0:1}),{costThreshold:1,timeThreshold:this.config.yieldIntervalMs});const e=this.recalcLoop;return(0,C.promiseFinally)(this.recalcLoop.promise,(()=>{this.recalcLoop===e&&(this.recalcLoop=void 0)}))}async testResumeRecalc(e){if(await this.resumeRecalc(),void 0!==e){const t=`calc.calc.RecalcService: resumeRecalc finished; resumeId = ${e}`;S.ulsLogger.ULS.traceTag(574128980,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,t)}}processRecalcResults(e){const t=new M(this.onRecalcResults,this.onUpdateRequest,this.currentOutputStateId);for(const r of e)if(r.kind!==g.OutputMessageKind.GarbageCollected)if(r.kind!==g.OutputMessageKind.Alert)if(r.kind!==g.OutputMessageKind.ExperimentRunResult){if(this.setOutputStateId(r.stateId))switch(t.setOutputStateId(r.stateId),r.kind){case g.OutputMessageKind.CellWrite:{const{cell:e,value:n,format:a,cellKind:o,formulaBarText:s,formatted:u,hasHyperlink:l}=r,{sheet:c,range:d}=e,g=this.cellWriteToRangeDelta(c.index,d.row,d.col,n,a,s,u,l,"messages.<index>.value");(0,i.isDefined)(g)&&t.pushCellWrite(o,g);break}case g.OutputMessageKind.RangeWrite:{const{range:e,values:n,cellKind:a,formulaBarText:i,formatted:o,formats:s}=r,{sheet:u,range:l}=e;t.pushRangeWrite(a,this.rangeWriteToRangeDeltas(u.index,l,n,s,i,o,"messages.<index>.values"));break}case g.OutputMessageKind.NameFailure:this.nameFailures.push(r);break;case g.OutputMessageKind.RangeFailure:{const{range:e,cellKind:n,reason:a}=r;t.pushRangeFailure(n,this.rangeFailure(e,a)),this.rangeFailures.push(r);break}case g.OutputMessageKind.NumberFormatFailure:this.numberFormatFailures.push(r);break;case g.OutputMessageKind.PrintFormulaFailure:this.printFormulaFailures.push(r);break;case g.OutputMessageKind.InferFormatFailure:this.inferFormatFailures.push(r);break;case g.OutputMessageKind.FormatValueFailure:{const{range:e,cellKind:n,reason:a}=r;t.pushRangeFailure(n,this.rangeFailure(e,a)),this.formatValueFailures.push(r);break}case g.OutputMessageKind.UnhandledFailure:this.unhandledFailures.push(r);break;case g.OutputMessageKind.UpdateRequest:t.pushUpdateRequest((0,I.sheetGridRangeToLocation)(r.range));break;case g.OutputMessageKind.UpdateNamesRequest:t.pushUpdateNameRequest(r.scope);break;case g.OutputMessageKind.RecalcStatistics:t.pushRecalcFinished(r.message===g.RecalcStatisticsMessage.RecalcFinished),this.recalcStatistics=(0,g.mergeRecalcStatistics)(this.recalcStatistics,r);break;case g.OutputMessageKind.WorkbookStatistics:this.logWorkbookStats(r.stateId,r.stats,r.p);break;case g.OutputMessageKind.StateAdvanced:break;default:return(0,S.assertNever)("calc.calc.RecalcServiceImpl.processRecalcResults",r)}}else this.logExperimentRunResult(r.experimentName,JSON.stringify({message:r.logMessage,timeoutReason:r.timeoutReason}));else this.onAlert(r.message);else this.onGC(r.minStateIdKept);t.isRecalcFinished()&&this.flushOutputLogs(),t.flush()}logExperimentRunResult(e,t){S.ulsLogger.ULS.traceTag(594409422,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,`calc.calc.RecalcService: ${e} done; ${t}`),"UnitExperiment"===e&&S.ulsLogger.ULS.traceTag(538567681,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,`calc.calc.RecalcService: UnitExperiment done: ${t}`)}logAllFailureStats(){const e=this.nameFailures;this.nameFailures=[];const t=this.rangeFailures;this.rangeFailures=[];const r=this.numberFormatFailures;this.numberFormatFailures=[];const n=this.printFormulaFailures;this.printFormulaFailures=[];const i=this.inferFormatFailures;this.inferFormatFailures=[];const o=this.formatValueFailures;this.formatValueFailures=[];const s=this.unhandledFailures;this.unhandledFailures=[],this.logGenFailureStats(e,595194337,"name",a.TraceLevel.Info),this.logCellFailureStats(t,595658722,"range",a.TraceLevel.Info),this.logGenFailureStats(r,590484946,"format",a.TraceLevel.Info),this.logGenFailureStats(n,592730065,"print-formula",a.TraceLevel.Info),this.logGenFailureStats(i,590484947,"infer-format",a.TraceLevel.Info),this.logCellFailureStats(o,590484948,"format-value",a.TraceLevel.Info),this.logGenFailureStats(s,595194338,"unhandled",a.TraceLevel.Warning)}logGenFailureStats(e,t,r,n){if(0===e.length)return;const i={};for(const{reason:t}of e)(0,O.incrementFailure)(i,t);const o=`calc.calc.RecalcService: recalc ${r} failures; stateId = ${this.currentOutputStateId}, stats = ${JSON.stringify(i)}`;S.ulsLogger.ULS.traceTag(t,a.LogCategory.msoulscat_ES_EWAJS,n,o),this.logJavaScriptFailures(e,r)}logCellFailureStats(e,t,r,n){if(0===e.length)return;const i={};for(const{reason:t,cellKind:r}of e){const e=i[r]??(i[r]={});(0,O.incrementFailure)(e,t)}Object.getOwnPropertyNames(i).sort().forEach((e=>{const o=i[e],s=`calc.calc.RecalcService: recalc ${r} failures; stateId = ${this.currentOutputStateId}, cell kind = ${e}, stats = ${JSON.stringify(o)}`;S.ulsLogger.ULS.traceTag(t,a.LogCategory.msoulscat_ES_EWAJS,n,s)})),this.logJavaScriptFailures(e,r)}logJavaScriptFailures(e,t){for(const{reason:r}of e)if(r.kind===v.ReasonKind.JavaScriptError){const e=`calc.calc.RecalcService: recalc ${t} JavaScript error: ${(0,A.messageFromError)(r.error)}`;S.ulsLogger.ULS.traceTag(595658721,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,e)}}logIgnoredStats(e,t,r,n){if(0===Object.getOwnPropertyNames(n).length)return;const i=`calc.calc.RecalcService: ignored ${r} data; stateId = ${t}, stats = ${JSON.stringify(n)}`;S.ulsLogger.ULS.traceTag(e,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,i)}logIgnoredInputStats(){this.logIgnoredStats(595658723,this.currentInputStateId,"input",this.ignoredInputStats),this.ignoredInputStats={}}logIgnoredOutputStats(){this.logIgnoredStats(595658752,this.currentOutputStateId,"output",this.ignoredOutputStats),this.ignoredOutputStats={}}logRecalcStats(){if(this.currentOutputStateId===-1/0)return;if(this.lastRecalcStatsStateId===this.currentOutputStateId&&this.recalcStatistics===g.emptyRecalcStatistics)return;const e=this.recalcStatistics;this.recalcStatistics=g.emptyRecalcStatistics,this.lastRecalcStatsStateId=this.currentOutputStateId;const t=this.config.sampleRecalcStatisticsRate;if(!this.dataModel.shouldSample(t))return;const r=`calc.calc.RecalcService: recalc statistics; stateId = ${this.currentOutputStateId}, stats = ${JSON.stringify(e)}, p = ${JSON.stringify(t)}`;S.ulsLogger.ULS.traceTag(595654593,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,r)}logUnavailableStats(){if(this.currentOutputStateId===-1/0)return;if(0===this.rangeFailures.length)return;const e=(0,b.computeUnavailableCellsStats)(this.rangeFailures);if(0===e.numOfUnavailableCellsInTheSameSheet&&0===e.numOfUnavailableCellsInDifferentSheet&&0===e.totalNumOfUnavailableCells)return;const t=`calc.calc.RecalcService: unavailable cells statistics; stateId = ${this.currentOutputStateId}, stats = ${JSON.stringify(e)}`;S.ulsLogger.ULS.traceTag(589632004,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,t)}logWorkbookStats(e,t,r){const n=`calc.calc.RecalcService: workbook statistics; stateId = ${e}, stats = ${JSON.stringify(t)}, p = ${JSON.stringify(r)}`;S.ulsLogger.ULS.traceTag(595359882,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,n)}logInputStateIdDecrease(e){(0,y.incrementStat)(this.ignoredInputStats,`${e}: input stateId went backwards`)}logOutputStateIdDecrease(){(0,y.incrementStat)(this.ignoredOutputStats,"output stateId went backwards")}flushInputLogs(){this.logIgnoredInputStats()}flushOutputLogs(){this.logUnavailableStats(),this.logAllFailureStats(),this.logIgnoredOutputStats(),this.logRecalcStats()}cellWriteToRangeDelta(e,t,r,n,a,o,s,l,c){if(!(0,y.check)(n,y.chReadOper,this.ignoredOutputStats,c))return;const d=(0,I.readOperToCellValue)(this.mathpack,n),g=(0,I.cellFormatToInferredFormat)(a);return(0,i.isDefined)(o)||(0,i.isDefined)(d)||(0,i.isDefined)(g)||(0,i.isDefined)(s)||(0,i.isDefined)(l)?(0,u.rangeDelta)((0,u.sheetRangeLocation)(e,t,r),(0,u.cellDataDelta)(o,d,g,s,l)):void 0}rangeWriteToRangeDeltas(e,t,r,n,a,o,s){const u=`${s}.<index>.<index>`,{row:l,col:c,rows:d,cols:g}=t,m=[];for(let t=0;t<d;t+=1)for(let s=0;s<g;s+=1){const d=this.cellWriteToRangeDelta(e,l+t,c+s,r[t][s],n[t][s],0===t&&0===s?a:void 0,o[t][s],void 0,u);(0,i.isDefined)(d)&&m.push(d)}return m}rangeFailure(e,t){return(0,u.rangeFailure)((0,I.sheetGridRangeToLocation)(e),D(t))}setA1ReferenceStyle(e){this.clearAsyncResumeRecalc(),this.dataTransformer.setA1ReferenceStyle(this.dataModel,this.currentInputStateId,e)}setLocale(e){this.clearAsyncResumeRecalc(),this.dataTransformer.setLocaleInfo(this.dataModel,this.currentInputStateId,e,this.ignoredInputStats)}setWorkbookProps(e){this.clearAsyncResumeRecalc(),this.dataTransformer.setWorkbookProps(this.dataModel,this.currentInputStateId,e,this.ignoredInputStats)}setNumberFormats(e,t){this.clearAsyncResumeRecalc(),this.dataModel.setNumberFormats(this.document,(0,y.filterCheck)(e,y.chNumberFormat,this.ignoredInputStats,"numberFormats"),t,this.currentInputStateId)}updateSheetNames(e,t){this.setInputStateId(e,"sheetNames")&&(this.clearAsyncResumeRecalc(),this.dataTransformer.updateSheetNames(this.dataModel,e,t,this.ignoredInputStats))}updateNamedObjects(e,t){this.setInputStateId(e,"namedObjectsUpdates")&&(this.clearAsyncResumeRecalc(),this.dataTransformer.updateNamedObjects(this.dataModel,e,t,this.ignoredInputStats))}updateUnusedCells(e,t){if(!this.setInputStateId(e,"unusedCellsUpdates"))return;this.clearAsyncResumeRecalc();const r=(0,y.filterCheck)(t,y.chUnusedCellsUpdate,this.ignoredInputStats,"unusedCellsUpdates");for(const t of r)this.dataModel.extendUnusedRange((0,I.unusedCellsUpdateToUsedRange)(this.document,t),e)}updateRanges(e,t){this.setInputStateId(e,"rangeUpdates")&&(this.clearAsyncResumeRecalc(),this.applyRangeUpdates(e,t))}updateArrays(e,t){if(!this.setInputStateId(e,"arrayUpdates"))return;this.clearAsyncResumeRecalc();const r=(0,y.filterCheck)(t,y.chArrayUpdate,this.ignoredInputStats,"arrayUpdates");for(const t of r){const{range:r,data:n,fromStateId:a}=t,o=(0,I.sheetRangeLocationToGridRange)(this.document,r);if((0,i.isDefined)(n)){const{formulaBarText:t,isSpilled:r}=n,a=(0,h.gridRangeAnchor)(o.range);this.dataModel.writeArrayFormula(e,o,t,a,r)}else(0,i.isDefined)(a)}}editRangeFormulas(e,t){this.setInputStateId(e,"rangeFormulaEdits")&&(this.clearAsyncResumeRecalc(),this.applyRangeFormulaEdits(t,e))}evalOnClonedModel(e,t,r){return this.evalOnClonedModelOnSnapshot(e,t,void 0,r)}evalOnClonedModelOnSnapshot(e,t,r=void 0,n){(0,S.assertPositiveInteger)("edits array should not be empty",t.length);const a=void 0===r?new c.EvalOnClonePropsFromPartialWB(this.dataModel,n):new c.EvalOnClonePropsFromPartialWBDocumentCollection(r,n);return this.applyRangeUpdates(-1,e,a),this.applyRangeFormulaEdits(t,-1,a),a.resultsPromise.toPromise()}applyRangeUpdates(e,t,r){const n=(0,y.filterCheck)(t,y.chRangeUpdate,this.ignoredInputStats,"rangeUpdates");for(const t of n){const{range:n,excludeRows:a,excludeColumns:o,data:s,fromStateId:u}=t,c=(0,I.sheetRangeLocationToGridRange)(this.document,n),p=c.range,f=(0,I.createExcludeCellSet)(p.row,p.rows,l.bspFactory.row,a),v=(0,I.createExcludeCellSet)(p.col,p.cols,l.bspFactory.col,o),F=(0,I.sheetGridRangeToCellSet)(c,f,v),y=(0,i.isDefined)(s)?(0,I.cellValueToReadOper)(this.mathpack,s.value):m.blankOper;(0,S.assertTrue)("calc.calc.RecalcService: updateRanges oper",null!=y);const C=(0,h.gridRangeAnchor)(p);if((0,i.isDefined)(s)){const t=s.iformat,n="ArrayFormula"===s.kind?void 0:s.formulaBarText??void 0,a=s.failureReason??void 0,i="CellFormula"===s.kind;this.dataModel.writeCellContents(e,F,n,i,C,y,t,g.SpecialStyle.Blank,a,r)}else if((0,i.isNone)(u))this.dataModel.writeCellContents(e,F,"",!1,C,m.blankOper,d.blankCellFormat,void 0,void 0,r);else{if(r)throw new Error("Promote cell data is unsupported for cloned models.");this.dataModel.promoteCellContents(e,c,F,u)}r||(this.dataModel.writeHiddenRows(e,(0,I.sheetGridRangeToHiddenRows)(c,f)),this.dataModel.writeHiddenCols(e,(0,I.sheetGridRangeToHiddenCols)(c,v)))}}localizeEnglishFormula(e,t){const r=this.dataModel.translateEnglishFormula(e,(0,I.sheetCellLocationToGridCell)(this.document,t));return Promise.resolve(r)}applyRangeFormulaEdits(e,t,r){const n=(0,y.filterCheck)(e,y.chRangeFormulaEdit,this.ignoredInputStats,"rangeFormulaEdits");for(const e of n){const{kind:n,range:a,formulaBarText:o,value:u,origin:c,viewport:d}=e;let m=p.empty;a.forEach((e=>{m=(0,f.unionProduct)(m,(0,l.createCellSetFromRange)((0,I.sheetRangeLocationToGridRange)(this.document,e).range))}));const v=(0,I.sheetRangeLocationToGridRange)(this.document,a[0]),F=(0,i.isDefined)(c)?(0,s.gridCell)(c.row,c.column):(0,h.gridRangeAnchor)(v.range),y=(0,i.isDefined)(d)?(0,I.sheetRangeLocationToGridRange)(this.document,d):void 0;let C;(0,i.isDefined)(u)?(C=(0,I.cellValueToReadOper)(this.mathpack,u),(0,S.assertTrue)("calc.calc.RecalcService: editRangeFormulas oper",null!=C)):C=void 0;const A="CellFormula"===n||"Value"!==n&&void 0;r?this.dataModel.editCellContentsOnClone((0,g.sheetCellSet)(v.sheet,m),o,A,F,r):this.dataModel.editCellContents(t,(0,g.sheetCellSet)(v.sheet,m),o,A,F,C,y)}}editRangeFormats(e,t){if(!this.setInputStateId(e,"rangeFormatEdits"))return;this.clearAsyncResumeRecalc();const r=(0,y.filterCheck)(t,y.chRangeFormatEdit,this.ignoredInputStats,"rangeFormatEdits");for(const t of r){const{range:r,operation:n,origin:a,viewport:o}=t,u="SetFormat"!==n.kind||(0,i.isNone)(n.format)?"RibbonFormat"!==n.kind||(0,i.isNone)(n.ribbon)?"ChangeDecimals"!==n.kind||(0,i.isNone)(n.changeDecimals)?void 0:{kind:n.kind,changeDecimals:n.changeDecimals}:{kind:n.kind,ribbon:n.ribbon}:{kind:n.kind,format:n.format};(0,S.assertTrue)("calc.calc.RecalcService: editRangeFormats operation",null!=u);let c=p.empty;r.forEach((e=>{c=(0,f.unionProduct)(c,(0,l.createCellSetFromRange)((0,I.sheetRangeLocationToGridRange)(this.document,e).range))}));const d=(0,I.sheetRangeLocationToGridRange)(this.document,r[0]),m=null!=a?(0,s.gridCell)(a.row,a.column):(0,h.gridRangeAnchor)(d.range),v=(0,i.isDefined)(o)?(0,I.sheetRangeLocationToGridRange)(this.document,o):void 0;this.dataModel.editCellFormats(e,(0,g.sheetCellSet)(d.sheet,c),u,m,v)}}editArrayFormulas(e,t){if(!this.setInputStateId(e,"arrayFormulaEdits"))return;this.clearAsyncResumeRecalc();const r=(0,y.filterCheck)(t,y.chArrayFormulaEdit,this.ignoredInputStats,"arrayFormulaEdits");for(const t of r){const{range:r,formulaBarText:n,origin:a,viewport:o}=t,u=(0,I.sheetRangeLocationToGridRange)(this.document,r),l=(0,i.isDefined)(a)?(0,s.gridCell)(a.row,a.column):(0,s.gridCell)(r.row,r.column),c=(0,i.isDefined)(o)?(0,I.sheetRangeLocationToGridRange)(this.document,o):void 0;this.dataModel.editArrayFormula(e,u,n,l,c)}}editRangePaste(e,t){if(!this.setInputStateId(e,"editRangePaste"))return;this.clearAsyncResumeRecalc();const r=(0,y.filterCheck)(t,y.chPasteEdit,this.ignoredInputStats,"pasteEdits");for(const t of r){const{kind:r,source:n,target:a,viewport:o}=t,s=(0,I.sheetRangeLocationToGridRange)(this.document,n),u=(0,I.sheetCellLocationToGridCell)(this.document,a),l=(0,i.isDefined)(o)?(0,I.sheetRangeLocationToGridRange)(this.document,o):void 0;this.dataModel.editPaste(e,r,u,s,l)}}setConfig(e){const t=Array.isArray(e.runExperiments)?{stepBudget:e.experimentStepBudget??10,totalBudget:e.experimentTotalBudget??1e4,factories:(0,E.getExperimentFactories)(e.runExperiments)}:void 0;this.config={yieldIntervalMs:10,totalTimeMs:e.totalEvalTimeMs??1e4,maxCellChain:2*s.sheetCols,maxNameChain:128,maxLambdaCalls:1e4,maxLambdaDepth:1e3,samplePrecisionEvalRate:e.samplePrecisionEvalRate??.02,samplePrecisionPrintFormulaRate:e.samplePrecisionPrintFormulaRate??.001,samplePrecisionPrintValueRate:e.samplePrecisionPrintValueRate??1e-4,sampleRecalcStatisticsRate:e.sampleRecalcStatisticsRate??.2,sampleWorkbookStatisticsRate:e.sampleWorkbookStatisticsRate??.1,sampleCellEvalStopwatchRate:e.sampleCellEvalStopwatchRate??.003,sampleRecalcEditedStopwatchRate:e.sampleRecalcEditedStopwatchRate??1,sampleRecalcViewportStopwatchRate:e.sampleRecalcViewportStopwatchRate??1,rngSeed:e.rngSeed??1e3*Date.now(),volatileMode:null!=e.volatileMode?_.VolatileMode[e.volatileMode]:_.VolatileMode.Estimation,experimentFactories:t}}reconfigure(e){this.setConfig(e),this.dataModel.reconfigure(this.config)}clearCache(){this.clearAsyncResumeRecalc(),this.dataModel=new c.PartialWorkbook(this.dataTransformer.getLangConfig(),this.config),this.recalcStatistics=g.emptyRecalcStatistics,this.nameFailures=[],this.rangeFailures=[],this.numberFormatFailures=[],this.unhandledFailures=[],this.ignoredInputStats={},this.ignoredOutputStats={},this.currentInputStateId=this.currentOutputStateId=this.lastRecalcStatsStateId=-1/0}evalFormula(e,t,r,n){return(0,y.check)(r,y.chSheetCellLocation,this.ignoredInputStats,"origin")?(0,y.check)(n,y.chEvalFormulaFormat,this.ignoredInputStats,"format")?this.dataModel.evalFormula(e,t,(0,I.sheetCellLocationToGridCell)(this.document,r),(0,I.evalFormulaFormatToUnion)(n)).then((({value:e,formatted:t})=>{let r,n;if((0,R.isSuccess)(e)){if(!(0,y.check)(e.value,y.chReadOper,this.ignoredOutputStats,"evalFormula"))throw new Error("ignored output");const t=(0,I.readOperToCellValue)(this.mathpack,e.value);(0,S.assertTrue)("calc.calc.RecalcService.evalFormula",void 0!==t),r=(0,R.success)(t)}else r=(0,R.failure)(D(e.reason));return n=void 0===t?void 0:(0,R.isSuccess)(t)?t:(0,R.failure)(D(t.reason)),(0,u.evalFormulaData)(r,n)})):Promise.reject(new Error("ignored format")):Promise.reject(new Error("ignored input"))}evalFormulaOnSnapshotImpl(e,t,r,n){return this.dataModel.evalFormula(-1,e,t,r,n)}testAdvanceState(e){this.setInputStateId(e,"testAdvanceState")&&(this.dataModel.testAdvanceState(e),this.clearAsyncResumeRecalc())}getMissingJSFeatures(){return(0,N.getMissingJSFeatures)()}constructor(e,t,r,n,a,i={},s="Local"){this.onRecalcResults=e,this.onUpdateRequest=t,this.onGC=r,this.onAlert=n,this.asyncLoopFactory=a,this.twConfig=i,this.dataTransformer=new O.RecalcServiceDataTransformer,this.currentInputStateId=-1/0,this.currentOutputStateId=-1/0,this.lastRecalcStatsStateId=-1/0,this.recalcStatistics=g.emptyRecalcStatistics,this.nameFailures=[],this.rangeFailures=[],this.numberFormatFailures=[],this.printFormulaFailures=[],this.inferFormatFailures=[],this.formatValueFailures=[],this.unhandledFailures=[],this.ignoredInputStats={},this.ignoredOutputStats={},this.initCalcThreadInside=async(e,t,r)=>(0,o.initCalcInThread)(e,t,r,this.twConfig),this.setConfig({}),this.dataModel=new c.PartialWorkbook(this.dataTransformer.getLangConfig(),this.config)}}t.RecalcServiceImpl=w;const L=(0,k.mixin)(w,(e=>new P.RecalcSideGrid(e)),["getSheetNames","getRangeValues","getRangeFormats","getRangeFormulae","getIntersectingTables","getIformats","discardSnapshot","createIGridExportEndpoint","getHiddenRows","getHiddenCols","evalFormulaOnSnapshot","evalClonedModelOnSnapshot","getCorrespondingSnapshotID"]);if((0,T.getTypedFeatureGate)("TESTING_ONLY_RECALC_SERVICE_IMPORTSCRIPTS_FAIL")&&(self.__retries=(self.__retries??-1)+1,0===self.__retries))throw"";t.recalcServiceInsideInit=({config:e,connection:t})=>n.Endpoint.createInside(t,(r=>new L(((...e)=>r.post.onRecalcResults(...e)),((...e)=>r.post.onUpdateRequest(...e)),((...e)=>r.post.onGC(...e)),((...e)=>r.post.onAlert(...e)),F.asyncLoop,e,t.createMode)))},96349:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createRecalcService=void 0;const n=r(74643).__importStar(r(11093)),a=r(82438),i=r(73701),o=r(73119),s=r(3028),u=r(64327),l=r(36159),c=r(29163),d=r(36873),g=r(73506),m=r(14907);t.createRecalcService=async function(e,...[t,r]){const[h,p]="boolean"==typeof t?t?[(new c.PluginSchedulerSingleton).instance(),(new c.GridImportManagerSingleton).instance()]:[void 0,void 0]:[t,r];let f=-1/0,S=!1;const v={onRecalcResults(e){},onUpdateRequest(e){},onGC(e){f=e},onAlert(e){if(S)return;const t=document.createElement("div"),r=document.createElement("p");r.textContent=e,t.appendChild(r);const n=document.createElement("button");n.textContent="OK",t.appendChild(n),t.setAttribute("style","position: fixed; top: 0; left: 30%; right: 30%; background: red; color: white; font-size: 16px; font-weight: bold; z-index: 1000; padding: 3em; white-space: pre-line;"),n.onclick=()=>{document.body.removeChild(t)},document.body.appendChild(t),S=!0}},F=await n.createWorker({id:"RecalcService",createMode:e},{local:o.recalcServiceInsideInit,thread:{scriptUrl:(0,g.getCalcAbsUrlOrThrow)(),insideInitName:"excelOnlineCalc.calc.recalcServiceInsideInit"}},(()=>v)),y=[];let C="Requested";function A(e="Requested"){C=e,F.close()}F.onClose=()=>{for(const e of y)try{e()}catch(e){i.ulsLogger.ULS.traceTag(539341771,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,`calc.calc.createRecalcService.service.onClose: callback threw ${(0,s.messageFromError)(e)}`)}const e=`calc.calc.createRecalcService.service.onClose: recalc service closed; reason = ${C}`;i.ulsLogger.ULS.traceTag(561534148,a.LogCategory.msoulscat_ES_EWAJS,"Requested"===C?a.TraceLevel.Info:a.TraceLevel.Warning,e)};try{if("Thread"===F.createMode){const e=await(0,g.initCalcThread)(F);y.push((()=>e.close())),(0,m.logMissingJSFeatures)(F.call.getMissingJSFeatures)}F.call.ping.callTimeout=3e4;let e=3,t=0,r=()=>{};(0,u.promiseLoop)((async()=>{if(await new Promise((e=>setTimeout(e,1e3))),F.hasBeenClosed())return;const o=F.call.ping.callTimeout,s=(0,l.now)();try{await F.call.ping()}catch(u){if(!n.WorkerError.isWorkerError(u)||"Timeout"!==u.info.cause)throw u;const c=(0,l.now)()-s;t+=1,t>=e&&A("Unresponsive");const d=F.hasBeenClosed(),g={timeout:o,waitTime:c,timeoutCount:t,hasBeenClosed:d},m=`calc.calc.RecalcService: unresponsive; ${JSON.stringify(g)}`;return i.ulsLogger.ULS.traceTag(561534149,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,m),r(o,c,t,d),!0}return t=0,!0}),!0).catch((e=>{const t=`calc.calc.RecalcService: ping loop threw an error: ${(0,s.messageFromError)(e)}`;i.ulsLogger.ULS.traceTag(561534150,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,t)})),F.post.updateRanges.onPostMessageError=n.dispatchWorkerError;const o={setOnRecalcResults(e){v.onRecalcResults=e},setOnUpdateRequest(e){v.onUpdateRequest=e},setOnUnresponsive(e){r=e},setA1ReferenceStyle(...e){F.post.setA1ReferenceStyle(...e),void 0!==h&&h.doNotify(d.NotificationKind.setA1ReferenceStyle,e)},setLocale(...e){F.post.setLocale(...e),void 0!==h&&h.doNotify(d.NotificationKind.setLocale,e)},setWorkbookProps(...e){F.post.setWorkbookProps(...e),void 0!==h&&h.doNotify(d.NotificationKind.setWorkbookProps,e)},updateSheetNames(...e){F.post.updateSheetNames(...e),void 0!==h&&h.doNotify(d.NotificationKind.updateSheetNames,e)},updateNamedObjects(...e){F.post.updateNamedObjects(...e),void 0!==h&&h.doNotify(d.NotificationKind.updateNamedObjects,e)},setNumberFormats:F.post.setNumberFormats,updateUnusedCells:F.post.updateUnusedCells,updateRanges:F.post.updateRanges,updateArrays:F.post.updateArrays,editRangeFormulas:F.post.editRangeFormulas,editRangeFormats:F.post.editRangeFormats,editArrayFormulas:F.post.editArrayFormulas,editRangePaste:F.post.editRangePaste,resumeRecalc:F.post.resumeRecalc,reconfigure(t){F.call.ping.callTimeout=t.responsivenessPingTimeout??3e4,e=t.responsivenessPingAttempts??3,F.post.reconfigure(t)},clearCache(){F.post.clearCache(),f=-1/0},testAdvanceState:F.post.testAdvanceState,testResumeRecalc:F.call.testResumeRecalc,close:A,stateIdAvailable:e=>e>=f,evalFormula:F.call.evalFormula,evalOnClonedModel:F.call.evalOnClonedModel,localizeEnglishFormula:(...e)=>F.call.localizeEnglishFormula(...e),createIGridExportEndpoint:(e,t)=>(y.push(t),F.call.createIGridExportEndpoint.transfer([e.port],e))};return void 0!==p&&p.onGridExporterCreated(o),o}catch(e){throw A("Error"),e}}},94973:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.chNamedRangeData=t.chNamedFormulaData=t.chNamedValueData=t.chNamedValue=t.chUnusedCellsUpdate=t.chArrayUpdate=t.chArrayData=t.chRangeUpdate=t.chCellData=t.chCellFormat=t.chCellValue=t.chError=t.chBlank=t.chSheetCellLocation=t.chSheetRangeLocation=t.chRangeLocation=t.chCellLocation=t.chCol=t.chRow=t.chSheetName=t.chSheetId=t.chNumberFormat=t.chErrorTypeName=t.chWorksheetFunctionName=t.chFormulaText=t.isFormulaText=t.oneOfChecker=t.eqChecker=t.chArray=t.chBoolean=t.chNonemptyString=t.chString=t.chNatural=t.chInteger=t.chFiniteNumber=t.chPossiblyInfiniteNumber=t.chNever=t.intChecker=t.typeofChecker=t.taggedUnionChecker=t.arrayChecker=t.depAllChecker=t.allChecker=t.objectChecker=t.fromChecker=t.optChecker=t.filterCheck=t.check=t.checker=t.incrementStat=void 0,t.chReadOper=t.chEvalFormulaFormat=t.chWorkbookProps=t.chLocaleData=t.chPasteEdit=t.chArrayFormulaEdit=t.chRangeFormatEdit=t.chRangeFormulaEdit=t.chNamedObjectsUpdate=t.chNamedObject=t.chNamedObjectData=t.chNamedFailureData=t.chNamedTableScope=t.chNamedTableData=t.chColumnData=void 0;const n=r(36159),a=r(36159),i=r(83970),o=r(60140),s=r(13168),u=r(57993),l=r(12973),c=r(3028),d=r(12529);function g(e,t){e[t]=(e[t]??0)+1}function m(e,t,r){return e.push(`${t.join(".")}: expected ${r}`),!1}function h(e,t){return(r,n,i)=>(0,a.isDefined)(r)&&e(r)||m(n,i,t)}function p(e,t,r,n){const a=[],i=t(e,a,[n]);for(const e of a)g(r,e);return i}function f(e){return(t,r,n)=>!!(0,a.isNone)(t)||e(t,r,n)}function S(e){return(t,r,n)=>{if((0,a.isNone)(t))return m(r,n,"non-null object");const i=n.length;try{let a=!0;for(const o in e)n[i]=o,a=a&&e[o](t[o],r,n);return a}finally{n.length=i}}}function v(...e){return(t,r,n)=>e.reduce(((e,a)=>e&&a(t,r,n)),!0)}function F(e,...t){return(r,n,a)=>t.reduce(((e,t)=>e&&t(r)(r,n,a)),e(r,n,a))}function y(e){return(t,r,n)=>{if(!Array.isArray(t))return m(r,n,"Array");n.push("<index>");try{return t.reduce(((t,a)=>t&&e(a,r,n)),!0)}finally{n.pop()}}}function C(e){const t=`one of ${JSON.stringify(Object.getOwnPropertyNames(e).sort())}`;return(r,n,i)=>{if((0,a.isNone)(r))return m(n,i,"non-null object");const o=i.length;try{const o="string"==typeof r.kind||"number"==typeof r.kind?e[r.kind]:void 0;return(0,a.isNone)(o)?(i.push("kind"),m(n,i,t)):o(r,n,i)}finally{i.length=o}}}function A(e){const t=`typeof one of ${JSON.stringify(Object.getOwnPropertyNames(e).sort())}`;return(r,n,i)=>{const o=e[typeof r];return(0,a.isNone)(o)?m(n,i,t):o(r,n,i)}}function E(e){return"number"==typeof e&&e>-1/0&&e<1/0}function b(e){return(0|e)===e||Math.floor(e)===e}function R(e,t,r=(0!==e?`integer >= ${e} and < ${t}`:`natural < ${t}`)){return h((r=>"number"==typeof r&&r>=e&&r<t&&b(r)),r)}function T(e){return h((t=>t===e),JSON.stringify(e))}function k(...e){const t=Object.create(null),r=Object.create(null);for(const n of e)"number"==typeof n?r[n]=!0:t[n]=!0;return h((e=>{switch(typeof e){case"string":case"symbol":return!0===t[e];case"number":return!0===r[e]}return!1}),`one of ${JSON.stringify(e.slice().sort())}`)}function N(e){return"="===e[0]||"+"===e[0]||"-"===e[0]}t.incrementStat=g,t.checker=h,t.check=p,t.filterCheck=function(e,r,n,a){if(!p(e,t.chArray,n,a))return[];const i=`${a}.<index>`;return e.filter((e=>p(e,r,n,i)))},t.optChecker=f,t.fromChecker=function(e){return(t,r,n)=>e(t,r,n)},t.objectChecker=S,t.allChecker=v,t.depAllChecker=F,t.arrayChecker=y,t.taggedUnionChecker=C,t.typeofChecker=A,t.intChecker=R,t.chNever=h((e=>!1),"never"),t.chPossiblyInfiniteNumber=h((function(e){return"number"==typeof e&&!isNaN(e)}),"number (non-NaN)"),t.chFiniteNumber=h(E,"finite number"),t.chInteger=h((e=>E(e)&&b(e)),"integer"),t.chNatural=R(0,1/0,"natural"),t.chString=h((e=>"string"==typeof e),"string"),t.chNonemptyString=h((e=>"string"==typeof e&&e.length>0),"nonempty string"),t.chBoolean=h((e=>"boolean"==typeof e),"boolean"),t.chArray=h((e=>Array.isArray(e)),"Array"),t.eqChecker=T,t.oneOfChecker=k,t.isFormulaText=N,t.chFormulaText=h((e=>"string"==typeof e&&N(e)),"formula text"),t.chWorksheetFunctionName=S({functionId:t.chNatural,functionName:t.chNonemptyString});const I=h((e=>"string"==typeof e&&e.length>1&&(0,c.stringStartsWith)(e,"#")),"error name");t.chErrorTypeName=S({errorType:t.chNatural,errorName:I}),t.chNumberFormat=S({iformat:t.chNatural,formatString:t.chString,builtIn:t.chBoolean}),t.chSheetId=h((e=>"string"==typeof e||E(e)),"string or finite number"),t.chSheetName=S({sheetId:t.chSheetId,sheetName:t.chString}),t.chRow=R(0,o.sheetRows),t.chCol=R(0,o.sheetCols),t.chCellLocation=S({row:t.chRow,column:t.chCol});const O=h((e=>null==e.lastRow||e.lastRow>=e.row),"lastRow >= row"),_=h((e=>null==e.lastColumn||e.lastColumn>=e.column),"lastColumn >= column"),P=v(t.chCellLocation,S({lastRow:f(t.chRow),lastColumn:f(t.chCol)}));t.chRangeLocation=F(P,(e=>O),(e=>_)),t.chSheetRangeLocation=v(t.chRangeLocation,S({sheetId:t.chSheetId})),t.chSheetCellLocation=v(t.chSheetRangeLocation,S({lastRow:f(t.chNever),lastColumn:f(t.chNever)})),t.chBlank=S({kind:T("Blank")}),t.chError=S({kind:T("Error"),type:t.chNatural}),t.chCellValue=A({number:t.chFiniteNumber,string:t.chString,boolean:t.chBoolean,object:C({Blank:t.chBlank,Error:t.chError})}),t.chCellFormat=A({number:t.chNatural,string:t.chString}),t.chCellData=v(S({value:t.chCellValue,iformat:t.chNatural,failureReason:f(t.chString)}),C({CellFormula:S({formulaBarText:t.chFormulaText}),ArrayFormula:S({formulaBarText:f(t.chNever)}),Value:S({formulaBarText:t.chString})})),t.chRangeUpdate=S({range:t.chSheetRangeLocation,excludeRows:f(y(t.chRow)),excludeColumns:f(y(t.chCol)),data:f(t.chCellData),fromStateId:f(t.chInteger)}),t.chArrayData=S({isSpilled:t.chBoolean,formulaBarText:t.chFormulaText}),t.chArrayUpdate=S({range:t.chSheetRangeLocation,data:f(t.chArrayData),fromStateId:f(t.chInteger)}),t.chUnusedCellsUpdate=S({sheetId:t.chSheetId,usedRange:f(t.chRangeLocation)}),t.chNamedValue=A({number:t.chFiniteNumber,string:t.chString,boolean:t.chBoolean,object:C({Error:t.chError})}),t.chNamedValueData=S({kind:T("NamedValue"),value:t.chNamedValue}),t.chNamedFormulaData=S({kind:T("NamedFormula"),formulaBarText:t.chFormulaText}),t.chNamedRangeData=S({kind:T("NamedRange"),range:t.chSheetRangeLocation}),t.chColumnData=S({column:t.chNatural,name:t.chNonemptyString});const M=e=>(e.lastRow??e.row)-e.row+1,D=e=>(e.lastColumn??e.column)-e.column+1,w=h((e=>(!e.hasHeadersRow||e.range.row>0)&&(!e.hasTotalsRow||e.range.row+M(e.range)<o.sheetRows)),"enough rows for headers and totals"),L=h((e=>{const t=e.range.column,r=e.range.column+D(e.range);return e.columns.every((e=>e.column>=t&&e.column<r))}),"column names in range");t.chNamedTableData=F(S({kind:T("NamedTable"),range:t.chSheetRangeLocation,hasHeadersRow:t.chBoolean,hasTotalsRow:t.chBoolean,columns:y(t.chColumnData)}),(e=>w),(e=>L)),t.chNamedTableScope=e=>h((t=>"NamedTable"!==t.data?.kind||null==e),"NamedTable at global scope"),t.chNamedFailureData=S({kind:T("NamedFailure"),failureReason:t.chString,objectKind:f(k("NamedValue","NamedFormula","NamedRange","NamedTable"))}),t.chNamedObjectData=C({NamedValue:t.chNamedValueData,NamedFormula:t.chNamedFormulaData,NamedRange:t.chNamedRangeData,NamedTable:t.chNamedTableData,NamedFailure:t.chNamedFailureData});const x=S({name:t.chString,data:f(t.chNamedObjectData)});t.chNamedObject=e=>F(x,(r=>(0,t.chNamedTableScope)(e))),t.chNamedObjectsUpdate=S({scope:f(t.chSheetId),objects:f(t.chArray),fromStateId:f(t.chInteger)});const K=h((e=>e.length>0),"a non-empty array"),W=h((e=>e.every((t=>t.sheetId===e[0].sheetId))),"ranges on the same sheet"),U=F(y(t.chSheetRangeLocation),(e=>K),(e=>W));t.chRangeFormulaEdit=v(S({range:U,origin:f(t.chCellLocation),viewport:f(t.chSheetRangeLocation)}),C({CellFormula:S({formulaBarText:t.chFormulaText,value:f(t.chNever)}),Value:S({formulaBarText:t.chString,value:t.chCellValue}),Inferred:S({formulaBarText:t.chString,value:f(t.chNever)})}));const G=C({SetFormat:S({format:t.chCellFormat}),RibbonFormat:S({ribbon:k(...(0,a.strEnumArray)(d.RibbonFormat))}),ChangeDecimals:S({changeDecimals:R(-20,20)})});t.chRangeFormatEdit=S({range:U,operation:G,origin:f(t.chCellLocation),viewport:f(t.chSheetRangeLocation)}),t.chArrayFormulaEdit=S({range:t.chSheetRangeLocation,formulaBarText:h((e=>"string"==typeof e&&(0===e.length||N(e))),"empty string or text denoting formula"),origin:f(t.chCellLocation),viewport:f(t.chSheetRangeLocation)});const B=h((e=>{const t=D(e.source),r=M(e.source);return e.target.column+t<=o.sheetCols&&e.target.row+r<=o.sheetRows}),"(target,source) in range");t.chPasteEdit=F(S({kind:k("CopyPaste"),target:t.chSheetCellLocation,source:t.chSheetRangeLocation,viewport:f(t.chSheetRangeLocation)}),(e=>B));const V=h((e=>2===e.length),"2 AM/PM symbols"),j=h((e=>7===e.length),"7 day symbols"),H=h((e=>12===e.length),"12 month symbols");function q(e){const t=(0,a.numEnumMap)(e,a.identity);return h((e=>e.every(((e,r)=>null==e||r in t))),"indexes in enum")}const $=q(l.SpecialRefId),z=q(u.PictureSpecial),Q=q(u.PictureSingle),Y=q(u.PictureColor),J=q(u.PictureDbnum);t.chLocaleData=S({worksheetFunctionNames:t.chArray,thousandsData:y(t.chNatural),errorTypeNames:t.chArray,specialRefNames:F(y(f(t.chNonemptyString)),(e=>$)),trueName:t.chNonemptyString,falseName:t.chNonemptyString,rowLetter:t.chNonemptyString,columnLetter:t.chNonemptyString,leftBrace:t.chNonemptyString,rightBrace:t.chNonemptyString,leftBracket:t.chNonemptyString,rightBracket:t.chNonemptyString,decimalSeparator:t.chNonemptyString,listSeparator:t.chNonemptyString,columnSeparator:t.chNonemptyString,rowSeparator:t.chNonemptyString,thousandsSeparator:t.chString,lcid:t.chNatural,country:t.chNatural,numberDecimals:t.chNatural,isExpSepBySpace:t.chBoolean,fractionSeparator:t.chNonemptyString,isPercentSepBySpace:t.chBoolean,currencyFormat:k(s.CurrencyFormat.Paren,s.CurrencyFormat.Lead,s.CurrencyFormat.Intern,s.CurrencyFormat.Trail),isCurrencySymbolLead:t.chBoolean,isCurrencySepBySpace:t.chBoolean,currencySymbol:t.chString,currencyDecimals:t.chNatural,dateOrder:k(s.DateOrder.MDY,s.DateOrder.DMY,s.DateOrder.YMD,s.DateOrder.MYD,s.DateOrder.DYM,s.DateOrder.YDM),dateSeparator:t.chString,dateAltSeparator:t.chString,year4Digits:t.chBoolean,month2Digits:t.chBoolean,day2Digits:t.chBoolean,longDateFormat:t.chBoolean,timeSeparator:t.chString,timeAltSeparator:f(t.chString),hour2Digits:t.chBoolean,clock24Hour:t.chBoolean,isAMPMSepBySpace:t.chBoolean,ampmSymbols:F(y(t.chString),(e=>V)),dayNameShort:F(y(t.chString),(e=>j)),dayNameLong:F(y(t.chString),(e=>j)),monthNameShort:F(y(t.chString),(e=>H)),monthNameLong:F(y(t.chString),(e=>H)),pictureSpecial:F(y(f(t.chNonemptyString)),(e=>z)),pictureSingle:F(y(f(t.chNonemptyString)),(e=>Q)),pictureColor:F(y(f(t.chNonemptyString)),(e=>Y)),pictureDbnum:F(y(f(t.chNonemptyString)),(e=>J)),sysDateFormat:t.chString,sysTimeFormat:t.chString,cultureTagPrimary:t.chNonemptyString,cultureTagUserDefault:t.chNonemptyString,cultureTagInstLang:t.chNonemptyString,cultureTagUserCurrent:t.chNonemptyString});const X=S({yr:t.chInteger,mon:R(1,13),dom:R(1,6),wdy:R(1,8),hour:R(0,24),min:R(0,60),sec:R(0,60),fracSec:T(0),rounding:R(0,4)}),Z=F(S({bias:t.chFiniteNumber,standardDate:f(X),standardBias:t.chFiniteNumber,daylightDate:f(X),daylightBias:t.chFiniteNumber}),(e=>h((e=>(0,a.isNone)(e.standardDate)===(0,a.isNone)(e.daylightDate)),"standardDate iff daylightDate")));t.chWorkbookProps=S({date1904:f(t.chBoolean),dateCompatibility:f(t.chBoolean),timezone:f(Z)}),t.chEvalFormulaFormat=f(C({Origin:S({iformat:f(t.chNever),knownFormat:f(t.chNever)}),Iformat:S({iformat:t.chNatural,knownFormat:f(t.chNever)}),Known:S({iformat:f(t.chNever),knownFormat:k(...(0,n.numEnumArray)(s.KnownFormat))}),Inferred:S({iformat:f(t.chNever),knownFormat:f(t.chNever)}),Aggregate:S({iformat:f(t.chNever),knownFormat:f(t.chNever)})}));const ee={[i.OperKind.Number]:!0,[i.OperKind.String]:!0,[i.OperKind.Boolean]:!0,[i.OperKind.Error]:!0,[i.OperKind.Array]:!1,[i.OperKind.Blank]:!0,[i.OperKind.Rich]:!1};t.chReadOper=h((e=>ee[e.kind]),"supported ReadOper")},40238:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.incrementFailure=t.RecalcServiceDataTransformer=t.initialRecalcServiceConfig=void 0;const n=r(60140),a=r(36159),i=r(57993),o=r(94973),s=r(94973),u=r(70052),l=r(12973),c=r(84288),d=r(99598),g=r(41739),m=r(73440),h=r(30070),p=r(14009),f=r(73701);t.initialRecalcServiceConfig={localeInfo:(0,i.getEnglishLocaleInfo)(),mathpack:c.xlMathpack,refStyle:l.RefStyle.A1,timezone:d.tzUTC,date1904:!1,dateCompatibility:!0,datepack:d.xlDatepack},t.RecalcServiceDataTransformer=class{getLangConfig(){return this.langConfig}setA1ReferenceStyle(e,t,r){this.langConfig={...this.langConfig,refStyle:r?l.RefStyle.A1:l.RefStyle.R1C1},e.setLangConfig(t,this.langConfig)}setLocaleInfo(e,t,r,n){(0,s.check)(r,s.chLocaleData,n,"localeData")&&(this.langConfig={...this.langConfig,localeInfo:(0,u.createLocaleInfo)(r,n)},e.setLangConfig(t,this.langConfig))}setWorkbookProps(e,r,n,a){(0,s.check)(n,s.chWorkbookProps,a,"workbookProps")&&(this.langConfig={...this.langConfig,date1904:n.date1904??t.initialRecalcServiceConfig.date1904,dateCompatibility:n.dateCompatibility??t.initialRecalcServiceConfig.dateCompatibility,timezone:n.timezone??t.initialRecalcServiceConfig.timezone},e.setLangConfig(r,this.langConfig))}updateSheetNames(e,t,r,n){e.setSheetNames(this.document,(0,s.filterCheck)(r,s.chSheetName,n,"sheetNames"),t)}updateNamedObjects(e,t,r,i){const o=(0,s.filterCheck)(r,s.chNamedObjectsUpdate,i,"namedObjectsUpdates");for(const r of o){const{scope:o,objects:l,fromStateId:c}=r,d=(0,n.nameScope)(this.document,(0,a.isDefined)(o)?o:void 0);if((0,a.isDefined)(l)){const r=(0,s.filterCheck)(l,(0,s.chNamedObject)(o),i,"namedObjectsUpdates.<index>.objects");for(const n of r){const{name:r,data:a}=n;e.writeNamedObject(t,d,r,(0,u.namedObjectDataToNamedObject)(this.langConfig.mathpack,this.langConfig.localeInfo.stringCompareCI,this.document,a))}}else(0,a.isDefined)(c)?e.promoteNamedObjects(t,d,c):e.writeUndefinedNames(t,d)}}constructor(){this.document=(0,n.documentLoc)(void 0,""),this.langConfig=t.initialRecalcServiceConfig}},t.incrementFailure=function(e,t){switch(t.kind){case p.ReasonKind.NotImplemented:for(const r of t.features)(0,o.incrementStat)(e,`${p.ReasonKind.NotImplemented} ${r}`);break;case p.ReasonKind.IllFormedFormula:(0,o.incrementStat)(e,`${p.ReasonKind.IllFormedFormula} ${t.mode??""} ${JSON.stringify({diagnostics:t.diagnostics??{},message:t.mode===g.FormulaMode.ServerCellFormula||t.mode===g.FormulaMode.ServerNamedFormula?t.message:void 0})}`);break;case p.ReasonKind.Unavailable:for(const r of t.objects){const t=[p.ReasonKind.Unavailable];if("string"==typeof r.kind&&r.kind in g.UnavailableKind){const e=r;switch(t.push(e.kind),e.kind){case g.UnavailableKind.SheetId:t.push(e.sheetId);break;case g.UnavailableKind.NameLoc:t.push(e.source),t.push(void 0===e.name.scope.index?"global":"sheet");break;case g.UnavailableKind.ClientFailure:t.push(e.reason);break;case g.UnavailableKind.CellFormula:case g.UnavailableKind.EvalFailure:t.push(e.reason.kind);break;case g.UnavailableKind.VolatileFunction:t.push(e.name);break;case g.UnavailableKind.TimeGranularity:t.push(d.TimeGranularity[e.granularity]);break;case g.UnavailableKind.GetTimeKind:t.push(e.getTimeKind)}}else t.push(JSON.stringify(r));(0,o.incrementStat)(e,t.join(" "))}break;case p.ReasonKind.LimitExceeded:(0,o.incrementStat)(e,`${t.kind} ${p.LimitKind[t.limit]}`);break;case h.FormatReasonKind.NotFormatString:case h.FormatReasonKind.NotValueString:(0,o.incrementStat)(e,`${t.kind} ${t.message}`);break;case p.ReasonKind.InvalidQualifier:case p.ReasonKind.InvalidCellRef:case p.ReasonKind.InvalidStructRef:(0,o.incrementStat)(e,`${t.kind} ${t.reason}`);break;case p.ReasonKind.Internal:(0,o.incrementStat)(e,`${t.kind} ${t.message}`);break;case p.ReasonKind.JavaScriptError:case m.ReasonKind.NotFormulaString:case p.ReasonKind.CellCycle:case p.ReasonKind.NameCycle:case p.ReasonKind.Stopped:case p.ReasonKind.PreviousFailure:case p.ReasonKind.PreviousNameFailure:case h.FormatReasonKind.PreviousFormatFailure:(0,o.incrementStat)(e,t.kind);break;default:(0,f.assertNever)("calc.calc.incrementFailure",t)}}},90437:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerExperimentFactory=t.getExperimentFactories=t.ExperimentKind=void 0;const n=r(82438),a=r(73701),i=r(36159),o=r(5579),s=r(33903);class u{static create(e){if("number"==typeof e)return new u(e);{const t=`calc.calc.TestExperiment: expected number; given ${e}`;a.ulsLogger.ULS.traceTag(591974878,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,t)}}setContext(){}step(){const e=(0,i.now)();for(;(0,i.now)()<e+this.stepDelay;);this.iters+=1,this.iters>1&&(this.done=!0)}constructor(e){this.stepDelay=e,this.done=!1,this.resultLogMessage="TestExperiment",this.failedLogMessage="TestExperiment exceeded budget",this.iters=0}}var l;!function(e){e.OneShot="OneShot",e.Recurring="Recurring",e.Precision="Precision"}(l||(t.ExperimentKind=l={}));const c={TestExperiment:e=>({experimentName:"TestExperiment",kind:l.OneShot,create:()=>u.create(e)}),ExceLintExperiment:()=>({experimentName:"ExceLintExperiment",kind:l.OneShot,create:()=>new o.ExceLintExperiment}),UnitExperiment:()=>({experimentName:"UnitExperiment",kind:l.OneShot,create:()=>new s.UnitExperiment,stepBudget:80})};t.getExperimentFactories=function(e){return e.map((({name:e,param:t})=>c[e]?.(t))).filter((e=>void 0!==e))},t.registerExperimentFactory=function(e,t){c[e]=t}},91304:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.copyPasteRangePasteEdit=t.rangePasteEdit=t.arrayFormulaEdit=t.rangeFormatEdit=t.formatEditChangeDecimals=t.formatEditRibbonFormat=t.formatEditSetFormat=t.formatEditOperation=t.RibbonFormat=t.inferredRangeFormulaEdit=t.valueRangeFormulaEdit=t.cellFormulaRangeFormulaEdit=t.rangeFormulaEdit=t.namedObjectsPromote=t.undefinedNamesWrite=t.namedObjectsWrite=t.namedObjectsUpdate=t.namedObject=t.namedFailureData=t.namedTableData=t.columnData=t.namedRangeData=t.namedFormulaData=t.namedValueData=t.unusedCellsUpdate=t.arrayPromote=t.arrayWrite=t.arrayUpdate=t.arrayData=t.rangePromote=t.rangeWrite=t.rangeUpdate=t.valueCellData=t.arrayFormulaCellData=t.cellFormulaCellData=t.cellData=t.sheetCellLocation=t.sheetRangeLocation=t.rangeLocation=t.cellLocation=t.getCellFormatKind=t.getCellValueKind=t.richValue=t.errorValue=t.blankValue=t.sheetName=t.numberFormat=t.localeData=t.errorTypeName=t.worksheetFunctionName=void 0,t.RecalcServiceCreateMode=t.workbookProps=t.recalcServiceConfig=t.runExperiment=t.updateRequest=t.evalFormulaData=t.evalFormulaFormatAggregate=t.evalFormulaFormatInferred=t.evalFormulaFormatKnown=t.evalFormulaFormatIformat=t.evalFormulaFormatOrigin=t.evalFormulaFormat=t.recalcResults=t.rangeFailure=t.arrayDelta=t.rangeDelta=t.cellDataDelta=t.inferredFormat=void 0;const n=r(36159),a=r(12529);var i;Object.defineProperty(t,"RibbonFormat",{enumerable:!0,get:function(){return a.RibbonFormat}}),t.worksheetFunctionName=(0,n.typedInstanceCreator)()(((e,t)=>({functionId:e,functionName:t}))),t.errorTypeName=(0,n.typedInstanceCreator)()(((e,t)=>({errorType:e,errorName:t}))),t.localeData=(0,n.typedInstanceCreator)()(((e,t,r,n,a,i,o,s,u,l,c,d,g,m,h,p,f,S,v,F,y,C,A,E,b,R,T,k,N,I,O,_,P,M,D,w,L,x,K,W,U,G,B,V,j,H,q,$,z,Q,Y,J,X,Z,ee)=>({worksheetFunctionNames:e,errorTypeNames:t,specialRefNames:z,trueName:r,falseName:n,rowLetter:a,columnLetter:i,leftBrace:o,rightBrace:s,leftBracket:u,rightBracket:l,decimalSeparator:c,listSeparator:d,columnSeparator:g,rowSeparator:m,thousandsData:h,thousandsSeparator:p,lcid:f,country:S,numberDecimals:v,isExpSepBySpace:F,fractionSeparator:y,isPercentSepBySpace:C,currencyFormat:A,isCurrencySymbolLead:E,isCurrencySepBySpace:b,currencySymbol:R,currencyDecimals:T,dateOrder:k,dateSeparator:N,dateAltSeparator:I,year4Digits:O,month2Digits:_,day2Digits:P,longDateFormat:M,timeSeparator:D,timeAltSeparator:w,hour2Digits:L,clock24Hour:x,isAMPMSepBySpace:K,ampmSymbols:W,dayNameShort:U,dayNameLong:G,monthNameShort:B,monthNameLong:V,pictureSpecial:j,pictureSingle:H,pictureColor:q,pictureDbnum:$,sysDateFormat:Q,sysTimeFormat:Y,cultureTagPrimary:J,cultureTagUserDefault:X,cultureTagInstLang:Z,cultureTagUserCurrent:ee}))),t.numberFormat=(0,n.typedInstanceCreator)()(((e,t,r)=>({iformat:e,formatString:t,builtIn:r}))),t.sheetName=(0,n.typedInstanceCreator)()(((e,t)=>({sheetId:e,sheetName:t}))),t.blankValue={kind:"Blank"},t.errorValue=(0,n.typedInstanceCreator)()((e=>({kind:"Error",type:e}))),t.richValue=(0,n.typedInstanceCreator)()((e=>({kind:"Rich",fields:e}))),t.getCellValueKind=function(e){return"object"==typeof e?e.kind:typeof e},t.getCellFormatKind=function(e){return"object"==typeof e?e.kind:typeof e},t.cellLocation=(0,n.typedInstanceCreator)()(((e,t)=>({row:e,column:t}))),t.rangeLocation=(0,n.typedInstanceCreator)()(((e,t,r,n)=>({row:e,column:t,lastRow:r,lastColumn:n}))),t.sheetRangeLocation=(0,n.typedInstanceCreator)()(((e,t,r,n,a)=>({sheetId:e,row:t,column:r,lastRow:n,lastColumn:a}))),t.sheetCellLocation=(0,n.typedInstanceCreator)()(((e,t,r)=>({sheetId:e,row:t,column:r,lastRow:void 0,lastColumn:void 0}))),t.cellData=(0,n.typedInstanceCreator)()(((e,t,r,n,a)=>({formulaBarText:e,value:t,iformat:r,failureReason:n,kind:a}))),t.cellFormulaCellData=function(e,r,n,a){return(0,t.cellData)(e,r,n,a,"CellFormula")},t.arrayFormulaCellData=function(e,r,n){return(0,t.cellData)(void 0,e,r,n,"ArrayFormula")},t.valueCellData=function(e,r,n,a){return(0,t.cellData)(e,r,n,a,"Value")},t.rangeUpdate=(0,n.typedInstanceCreator)()(((e,t,r,n,a)=>({range:e,data:t,fromStateId:r,excludeRows:n,excludeColumns:a}))),t.rangeWrite=(0,n.typedInstanceCreator)()(((e,r,n,a)=>(0,t.rangeUpdate)(e,r,void 0,n,a))),t.rangePromote=function(e,r,n,a){return(0,t.rangeUpdate)(e,void 0,r,n,a)},t.arrayData=(0,n.typedInstanceCreator)()(((e,t)=>({isSpilled:e,formulaBarText:t}))),t.arrayUpdate=(0,n.typedInstanceCreator)()(((e,t,r)=>({range:e,data:t,fromStateId:r}))),t.arrayWrite=function(e,r){return(0,t.arrayUpdate)(e,r,void 0)},t.arrayPromote=function(e,r){return(0,t.arrayUpdate)(e,void 0,r)},t.unusedCellsUpdate=(0,n.typedInstanceCreator)()(((e,t)=>({sheetId:e,usedRange:t}))),t.namedValueData=(0,n.typedInstanceCreator)()((e=>({kind:"NamedValue",value:e}))),t.namedFormulaData=(0,n.typedInstanceCreator)()((e=>({kind:"NamedFormula",formulaBarText:e}))),t.namedRangeData=(0,n.typedInstanceCreator)()((e=>({kind:"NamedRange",range:e}))),t.columnData=(0,n.typedInstanceCreator)()(((e,t)=>({column:e,name:t}))),t.namedTableData=(0,n.typedInstanceCreator)()(((e,t,r,n)=>({kind:"NamedTable",range:e,hasHeadersRow:t,hasTotalsRow:r,columns:n}))),t.namedFailureData=(0,n.typedInstanceCreator)()(((e,t)=>({kind:"NamedFailure",failureReason:e,objectKind:t}))),t.namedObject=(0,n.typedInstanceCreator)()(((e,t)=>({name:e,data:t}))),t.namedObjectsUpdate=(0,n.typedInstanceCreator)()(((e,t,r)=>({scope:e,objects:t,fromStateId:r}))),t.namedObjectsWrite=function(e,r){return(0,t.namedObjectsUpdate)(e,r,void 0)},t.undefinedNamesWrite=function(e){return(0,t.namedObjectsUpdate)(e,void 0,void 0)},t.namedObjectsPromote=function(e,r){return(0,t.namedObjectsUpdate)(e,void 0,r)},t.rangeFormulaEdit=(e,t,r,n,a,i="Inferred")=>({range:Array.isArray(e)?e:[e],formulaBarText:t,value:r,origin:n,viewport:a,kind:i}),t.cellFormulaRangeFormulaEdit=function(e,r,n,a){return(0,t.rangeFormulaEdit)(e,r,void 0,n,a,"CellFormula")},t.valueRangeFormulaEdit=function(e,r,n,a){return(0,t.rangeFormulaEdit)(e,r,n,void 0,a,"Value")},t.inferredRangeFormulaEdit=function(e,r,n,a){return(0,t.rangeFormulaEdit)(e,r,void 0,n,a,"Inferred")},t.formatEditOperation=(0,n.typedInstanceCreator)()(((e,t,r,n)=>({kind:e,format:t,ribbon:r,changeDecimals:n}))),t.formatEditSetFormat=function(e){return(0,t.formatEditOperation)("SetFormat",e,void 0,void 0)},t.formatEditRibbonFormat=function(e){return(0,t.formatEditOperation)("RibbonFormat",void 0,e,void 0)},t.formatEditChangeDecimals=function(e){return(0,t.formatEditOperation)("ChangeDecimals",void 0,void 0,e)},t.rangeFormatEdit=(0,n.typedInstanceCreator)()(((e,t,r,n)=>({range:e,operation:t,origin:r,viewport:n}))),t.arrayFormulaEdit=(0,n.typedInstanceCreator)()(((e,t,r,n)=>({range:e,formulaBarText:t,origin:r,viewport:n}))),t.rangePasteEdit=(0,n.typedInstanceCreator)()(((e,t,r,n)=>({kind:e,target:t,source:r,viewport:n}))),t.copyPasteRangePasteEdit=function(e,r,n){const a=(0,t.sheetCellLocation)(e.sheetId,e.row,e.column);return(0,t.rangePasteEdit)("CopyPaste",a,r,n)},t.inferredFormat=(0,n.typedInstanceCreator)()(((e,t,r)=>({format:e,category:t,decimals:r}))),t.cellDataDelta=(0,n.typedInstanceCreator)()(((e,t,r,n,a)=>({formulaBarText:e,value:t,format:r,formatted:n,hasHyperlink:a}))),t.rangeDelta=(0,n.typedInstanceCreator)()(((e,t)=>({range:e,data:t}))),t.arrayDelta=(0,n.typedInstanceCreator)()(((e,t)=>({range:e,data:t}))),t.rangeFailure=(0,n.typedInstanceCreator)()(((e,t)=>({range:e,reason:t}))),t.recalcResults=(0,n.typedInstanceCreator)()(((e,t,r,n,a,i)=>({stateId:e,priorityGroup:t,isFinished:r,rangeDeltas:n,arrayDeltas:a,rangeFailures:i}))),t.evalFormulaFormat=(0,n.typedInstanceCreator)()(((e,t,r)=>({kind:e,iformat:t,knownFormat:r}))),t.evalFormulaFormatOrigin=function(){return(0,t.evalFormulaFormat)("Origin")},t.evalFormulaFormatIformat=function(e){return(0,t.evalFormulaFormat)("Iformat",e)},t.evalFormulaFormatKnown=function(e){return(0,t.evalFormulaFormat)("Known",void 0,e)},t.evalFormulaFormatInferred=function(){return(0,t.evalFormulaFormat)("Inferred")},t.evalFormulaFormatAggregate=function(){return(0,t.evalFormulaFormat)("Aggregate")},t.evalFormulaData=function(e,t){return{value:e,formatted:t}},t.updateRequest=(0,n.typedInstanceCreator)()(((e,t,r)=>({rangeUpdateRanges:e,arrayUpdateRanges:t,namesUpdateScopes:r}))),t.runExperiment=(0,n.typedInstanceCreator)()(((e,t)=>({name:e,param:t}))),t.recalcServiceConfig=(0,n.typedInstanceCreator)()(((e,t,r,n,a,i,o,s,u,l,c=(null==l?void 0:l/(l>=1?1:10)),d)=>({totalEvalTimeMs:e,samplePrecisionEvalRate:t,samplePrecisionPrintFormulaRate:l,samplePrecisionPrintValueRate:c,sampleRecalcStatisticsRate:s,sampleWorkbookStatisticsRate:n,sampleRecalcEditedStopwatchRate:a,sampleRecalcViewportStopwatchRate:i,sampleCellEvalStopwatchRate:o,rngSeed:r,volatileMode:d,runExperiments:u}))),t.workbookProps=(0,n.typedInstanceCreator)()(((e,t,r)=>({date1904:e,dateCompatibility:t,timezone:r}))),function(e){e.Thread="Thread",e.Local="Local",e.ThreadOrLocal="ThreadOrLocal"}(i||(t.RecalcServiceCreateMode=i={}))},59731:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertX10RangeFormulaEditsToCalcRangeFormulaEdits=t.convertX10UpdatesToCalcUpdates=t.RecalcSideGrid=void 0;const n=r(74643),a=r(36159),i=r(1765),o=r(60140),s=r(92587),u=r(92587),l=r(27308),c=r(55),d=n.__importStar(r(11093)),g=r(91304),m=r(70052),h=r(41739),p=r(57786),f=r(89817),S=r(12973);function v(e,t){return e.map((e=>{if(!(0,a.isDefined)(e.data))return{data:void 0,range:(0,m.sheetGridRangeToLocation)(e.range)};const r=(0,m.readOperToCellValue)(t,e.data.value);return{data:{kind:e.data.kind,formulaBarText:e.data.formulaBarText,value:r??g.blankValue,iformat:e.data.iformat,failureReason:void 0===r?"unsupported Oper serialization":void 0},range:(0,m.sheetGridRangeToLocation)(e.range)}}))}function F(e,t){return e.map((e=>{const[r,...n]=e.range,i=[(0,m.sheetGridRangeToLocation)(r),...n.map((e=>(0,m.sheetGridRangeToLocation)(e)))];return{kind:e.kind,range:i,formulaBarText:e.formulaBarText,value:(0,a.isDefined)(e.value)?(0,m.readOperToCellValue)(t,e.value):void 0,origin:(0,a.isDefined)(e.origin)?(0,m.gridCellToCellLocation)(e.origin):void 0}}))}(0,a.staticAssertSame)(),(0,a.staticAssertSame)(),(0,a.staticAssertSame)(),(0,a.staticAssertSame)(),t.RecalcSideGrid=class{async createIGridExportEndpoint(e){await d.Endpoint.createInside(e,(()=>this))}discardSnapshot(e){return void 0!==this.snapshotPromises[e]&&(delete this.snapshotPromises[e],!0)}async evalClonedModelOnSnapshot(e,t,r,n){const{snapshot:a}=await this.getOrCreateSnapshot(e)??{snapshot:void 0};if(void 0===a)return(0,i.failure)((0,u.unavailable)(["evalOnClonedModel"]));const o=v(t,a.config.mathpack),s=F(r,a.config.mathpack),l=this.calcGrid.evalOnClonedModelOnSnapshot(o,s,a,n);return this.calcGrid.resumeRecalc(),(0,i.success)(await l)}async evalFormulaOnSnapshot(e,t,r,n={kind:h.SpecialFormat.Origin}){const{snapshot:a}=await this.getOrCreateSnapshot(e)??{snapshot:void 0};if(void 0===a)return(0,i.failure)((0,u.unavailable)(["evalFormula"]));const o=this.calcGrid.evalFormulaOnSnapshotImpl(t,r,n,a);this.calcGrid.resumeRecalc();const l=function(e){if(e.value.kind===i.ResultKind.Failure&&e.value.reason.kind===s.ReasonKind.Unavailable){const t=e.value.reason.objects;for(let e=0;e<t.length;e++){const r=t[e];r.kind===h.UnavailableKind.GridRange&&(t[e]={...r,unavailableCells:!0})}}return e}(await o);return(0,i.success)(l)}async getSheetNames(e){const{snapshot:t}=await this.getOrCreateSnapshot(e)??{snapshot:void 0};if(void 0===t)return(0,i.failure)((0,u.unavailable)(["getSheetNames"]));const r={document:this.calcGrid.document,sheets:new Array},n=t.getSheetRangeIndexes((0,o.allSheetsRange)(this.calcGrid.document));if(!(0,i.isSuccess)(n))return n;for(const e of n.value.sheets){const n=t.getSheetName(this.calcGrid.document,e);if(!(0,i.isSuccess)(n))return n;r.sheets.push({sheetIndex:(0,o.sheetIndex)(this.calcGrid.document,e),sheetName:n.value})}return(0,i.success)(r)}async getCorrespondingSnapshotID(e){const t=await this.getOrCreateSnapshot(e);return void 0===t?-1:t.correspondingId}async getOrCreateSnapshot(e){return void 0===this.snapshotPromises[e]&&(this.snapshotPromises[e]=this.calcGrid.dataModel.createSnapshot(e),this.calcGrid.resumeRecalc().catch((e=>{setTimeout((()=>{throw e}))}))),this.snapshotPromises[e]}getRangeFormats(e,t){return this.getRangeData(e,t,"formats")}getRangeValues(e,t){return this.getRangeData(e,t,"values")}getRangeFormulae(e,t){return this.getRangeData(e,t,"formulae")}async getRangeData(e,t,r){const{snapshot:n}=await this.getOrCreateSnapshot(e)??{snapshot:void 0};if(void 0===n)return(0,i.failure)((0,u.unavailable)(["getRangeData/getOrCreateSnapshot"]));const a=n.allEditedAvailable(t);if(a.kind!==i.ResultKind.Success)return(0,i.failure)((0,u.unavailable)(["getRangeData/allEditedAvailable"]));let s=(0,p.createCellSetFromRange)(t.range);!0!==a.value&&(s=(0,f.exceptProduct)(s,a.value));const d=e=>{const r=[];return(0,p.forEachRangeInSet)(s,(n=>{const a=e((0,o.sheetGridRange)(t.sheet,n),(e=>{s=(0,f.exceptProduct)(s,(0,p.createCellSetFromRange)(e))}),((e,t)=>{r.push([[e.row,e.col],t])}));return a.kind===i.ResultKind.Success&&a.value}))?(0,i.success)(r):(0,i.failure)((0,u.unavailable)(["getRangeData/extractData"]))},g={formulae:()=>d(((e,t,r)=>n.forEachEditedFormula(e,((e,{lexicalKind:n,compiledFmla:a,fmla:i,origin:s})=>(n!==o.LexicalKind.Range&&(0,u.isGridCell)(e)?(0,c.isBlankGridFormula)(i,void 0!==a)||r(e,{kind:void 0!==a?l.FormulaKind.CellFormula:l.FormulaKind.Value,formulaBarText:i,origin:(0,u.isGridCellEqual)(s,e)?void 0:s}):t(e),!0))))),formats:()=>d(((e,t,r)=>n.forEachEditedFormat(e,((e,n)=>(n===h.SpecialFormat.Unavailable?t(e):(0,c.isBlankCellFormat)(n)||r(e,"number"==typeof n?n:n.formatString),!0))))),values:()=>d(((e,t,r)=>n.forEachRecalcValue(e,((e,n)=>(void 0!==n.failure?t(e):(0,c.isBlankGridValue)(n.oper,n.failure)||r(e,n.oper),!0)))))}[r]();if(g.kind!==i.ResultKind.Success)return g;const m=[];return(0,p.forEachRangeInSet)(s,(e=>(m.push(e),!0))),(0,i.success)({nonEmptyCells:g.value,availableRanges:m})}async getIntersectingTables(e,t){const{snapshot:r}=await this.getOrCreateSnapshot(e)??{snapshot:void 0};if(void 0===r)return(0,i.failure)((0,u.unavailable)(["getIntersectingTables/getOrCreateSnapshot"]));const n=r.allServerAvailable(t);if(n.kind!==i.ResultKind.Success)return(0,i.failure)((0,u.unavailable)(["getIntersectingTables/allServerAvailable"]));const a=r.getIntersectingTables(t);if(!(0,i.isSuccess)(a))return(0,i.failure)((0,u.unavailable)(["getIntersectingTables/getIntersectingTables"]));const s=[];for(const e of a.value){const t=r.getNamedObject(e,o.NameSource.Plain);if(t.kind!==i.ResultKind.Success)return t;if("NamedTable"!==t.value?.kind)continue;const n=[];t.value.columnIndexes.forEach(((e,t)=>(n.push({column:e,name:t}),!0))),s.push({name:e.name,dataRange:t.value.specialRefRanges[S.SpecialRefId.Data].range,hasHeadersRow:t.value.hasHeadersRow,hasTotalsRow:t.value.hasTotalsRow,columns:n})}const l=(0,p.createCellSetFromRange)(t.range),c=!0===n.value?l:(0,f.exceptProduct)(l,n.value),d=[];return(0,p.forEachRangeInSet)(c,(e=>(d.push(e),!0))),(0,i.success)({tables:s,availableRanges:d})}async getIformats(e,t,r,n){const{snapshot:a}=await this.getOrCreateSnapshot(e)??{snapshot:void 0};if(void 0===a)return(0,i.failure)((0,u.unavailable)(["getIformats/getOrCreateSnapshot"]));const o=a.getIformats(t,r,n);return(0,i.isSuccess)(o)?(0,i.success)({availableFormats:o.value}):(0,i.failure)((0,u.unavailable)(["getIformats/getIntersectingTables"]))}async getHiddenRows(e,t,r,n){const{snapshot:a}=await this.getOrCreateSnapshot(e)??{snapshot:void 0};return void 0===a?c.hiddennessFullyUnavailable:a.getHiddenRows(t,r,n)}async getHiddenCols(e,t,r,n){const{snapshot:a}=await this.getOrCreateSnapshot(e)??{snapshot:void 0};return void 0===a?c.hiddennessFullyUnavailable:a.getHiddenCols(t,r,n)}constructor(e){this.calcGrid=e,this.snapshotPromises=[]}},t.convertX10UpdatesToCalcUpdates=v,t.convertX10RangeFormulaEditsToCalcRangeFormulaEdits=F},82602:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.computeUnavailableCellsStats=void 0;const n=r(41739),a=r(57786),i=r(92587),o=r(89817),s=r(36159),u=r(26795);t.computeUnavailableCellsStats=function(e){const t=(0,s.makeStringMap)(),r=(0,s.makeStringMap)();for(const a of e){const e=a.range;if(a.reason.kind===i.LangReasonKind.Unavailable)for(const s of a.reason.objects)s.kind===n.UnavailableKind.GridRange&&((0,i.isSheetIndexEqual)(s.range.sheet,e.sheet)?t[s.range.sheet.index]=(0,o.unionProduct)(t[s.range.sheet.index]??u.empty,!0!==s.unavailableCells?s.unavailableCells:u.empty):r[s.range.sheet.index]=(0,o.unionProduct)(r[s.range.sheet.index]??u.empty,!0!==s.unavailableCells?s.unavailableCells:u.empty))}let l=0,c=0,d=0;const g=(0,s.makeStringMap)();for(const e in t){const r=t[e]??u.empty;g[e]=(0,o.unionProduct)(g[e]??u.empty,r),(0,a.forEachRangeInSet)(r,(e=>(l+=e.rows*e.cols,!0)))}for(const e in r){const t=r[e]??u.empty;g[e]=(0,o.unionProduct)(g[e]??u.empty,t),(0,a.forEachRangeInSet)(t,(e=>(c+=e.rows*e.cols,!0)))}for(const e in g){const t=g[e]??u.empty;(0,a.forEachRangeInSet)(t,(e=>(d+=e.rows*e.cols,!0)))}return{numOfUnavailableCellsInTheSameSheet:l,numOfUnavailableCellsInDifferentSheet:c,totalNumOfUnavailableCells:d}}},4595:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTimeImpl=t.VolatileMode=t.asyncLazy=t.ResettableLazy=void 0;const n=r(73701),a=r(1765),i=r(41739),o=r(99598),s=r(30070),u=r(92587);class l{getValue(){return void 0===this.value&&(this.value=this.valueCreationFunc()),this.value}force(){void 0===this.value&&(this.value=this.valueCreationFunc())}reset(){this.value=void 0}constructor(e){this.valueCreationFunc=e,this.value=void 0}}var c;t.ResettableLazy=l,t.asyncLazy=function(e){return new l(e)},function(e){e.GroundTruth="GroundTruth",e.Estimation="Estimation",e.PrecisionTest="PrecisionTest"}(c||(t.VolatileMode=c={}));const d=()=>new Date;t.getTimeImpl=function(e,t,r,l=c.Estimation,g=d){switch(l){case c.PrecisionTest:return(0,a.failure)((0,u.unavailable)([{kind:i.UnavailableKind.GetTimeKind,getTimeKind:r}]));case c.Estimation:switch(r){case s.GetTimeKind.NonVolatile:return(0,a.failure)((0,u.unavailable)([{kind:i.UnavailableKind.GetTimeKind,getTimeKind:r}]));case s.GetTimeKind.ValueCell:case s.GetTimeKind.Volatile:}case c.GroundTruth:}const{mathpack:m,datepack:h}=e,p=g(),f=h.utcToLocal(e,(0,o.dateTime)(p.getUTCFullYear(),p.getUTCMonth()+1,p.getUTCDate(),p.getUTCHours(),p.getUTCMinutes(),p.getUTCSeconds(),p.getUTCDay()+1,p.getUTCMilliseconds(),o.Rounding.Round1000ths),e.timezone);(0,n.assertTrue)("calc.calc.PartialWorkbookDocumentCollection: to local",!1!==f);const{yr:S,rounding:v}=f;let{mon:F,dom:y,hour:C,min:A,sec:E,fracSec:b}=f;t<o.TimeGranularity.Instant&&(b=0,E=0,A=0,C=0),t<o.TimeGranularity.Day&&(y=1,F=1);const R=(0,o.dateTime)(S,F,y,C,A,E,1,b,v),T=h.toNum(e,R);(0,n.assertTrue)("calc.calc.PartialWorkbookDocumentCollection: toNum",!(0,u.isErrorOper)(T));const k=m.toNumber(T);if(l===c.GroundTruth)return(0,a.success)(T);const N=h.toNum(e,f);(0,n.assertTrue)("calc.calc.PartialWorkbookDocumentCollection: toNum",!(0,u.isErrorOper)(N));const I=m.toNumber(N);let O;switch(t){case o.TimeGranularity.Instant:O=I;break;case o.TimeGranularity.Day:O=k+1;break;case o.TimeGranularity.Year:{const t=(0,o.dateTime)(S+1,F,y,C,A,E,1,b,v),r=h.toNum(e,t);(0,n.assertTrue)("calc.calc.PartialWorkbookDocumentCollection: toNum",!(0,u.isErrorOper)(r)),O=m.toNumber(r);break}}const _=10/1440;return I<k+_||I>O-_?(0,a.failure)((0,u.unavailable)([{kind:i.UnavailableKind.TimeGranularity,granularity:t}])):(0,a.success)(T)}},38838:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.copyPasteRangePasteEdit=t.rangePasteEdit=t.arrayFormulaEdit=t.rangeFormatEdit=t.formatEditChangeDecimals=t.formatEditRibbonFormat=t.formatEditSetFormat=t.formatEditOperation=t.RibbonFormat=t.inferredRangeFormulaEdit=t.valueRangeFormulaEdit=t.cellFormulaRangeFormulaEdit=t.rangeFormulaEdit=t.columnData=t.namedTableData=t.namedObjectsPromote=t.undefinedNamesWrite=t.namedObjectsWrite=t.namedObjectsUpdate=t.namedObject=t.namedFailureData=t.namedRangeData=t.namedFormulaData=t.namedValueData=t.unusedCellsUpdate=t.arrayPromote=t.arrayWrite=t.arrayUpdate=t.arrayData=t.rangePromote=t.rangeWrite=t.rangeUpdate=t.valueCellData=t.arrayFormulaCellData=t.cellFormulaCellData=t.cellData=t.sheetCellLocation=t.sheetRangeLocation=t.rangeLocation=t.cellLocation=t.getCellFormatKind=t.getCellValueKind=t.richValue=t.errorValue=t.blankValue=t.sheetName=t.numberFormat=t.localeData=t.errorTypeName=t.worksheetFunctionName=void 0,t.internal=t.RecalcServiceDataTransformer=t.getTime=t.recalcServiceInsideInit=t.readOperToCellValue=t.cellValueToReadOper=t.localeInfoFromData=t.RecalcServiceCreateMode=t.createRecalcService=t.workbookProps=t.recalcServiceConfig=t.runExperiment=t.updateRequest=t.evalFormulaFormatAggregate=t.evalFormulaFormatInferred=t.evalFormulaFormatKnown=t.evalFormulaFormatIformat=t.evalFormulaFormatOrigin=t.evalFormulaFormat=t.evalFormulaData=t.recalcResults=t.rangeFailure=t.arrayDelta=t.rangeDelta=t.cellDataDelta=t.inferredFormat=void 0;const n=r(74643),a=n.__importStar(r(91304)),i=n.__importStar(r(96349)),o=n.__importStar(r(70052)),s=n.__importStar(r(73119)),u=n.__importStar(r(4595)),l=n.__importStar(r(91662)),c=n.__importStar(r(40238));t.worksheetFunctionName=a.worksheetFunctionName,t.errorTypeName=a.errorTypeName,t.localeData=a.localeData,t.numberFormat=a.numberFormat,t.sheetName=a.sheetName,t.blankValue=a.blankValue,t.errorValue=a.errorValue,t.richValue=a.richValue,t.getCellValueKind=a.getCellValueKind,t.getCellFormatKind=a.getCellFormatKind,t.cellLocation=a.cellLocation,t.rangeLocation=a.rangeLocation,t.sheetRangeLocation=a.sheetRangeLocation,t.sheetCellLocation=a.sheetCellLocation,t.cellData=a.cellData,t.cellFormulaCellData=a.cellFormulaCellData,t.arrayFormulaCellData=a.arrayFormulaCellData,t.valueCellData=a.valueCellData,t.rangeUpdate=a.rangeUpdate,t.rangeWrite=a.rangeWrite,t.rangePromote=a.rangePromote,t.arrayData=a.arrayData,t.arrayUpdate=a.arrayUpdate,t.arrayWrite=a.arrayWrite,t.arrayPromote=a.arrayPromote,t.unusedCellsUpdate=a.unusedCellsUpdate,t.namedValueData=a.namedValueData,t.namedFormulaData=a.namedFormulaData,t.namedRangeData=a.namedRangeData,t.namedFailureData=a.namedFailureData,t.namedObject=a.namedObject,t.namedObjectsUpdate=a.namedObjectsUpdate,t.namedObjectsWrite=a.namedObjectsWrite,t.undefinedNamesWrite=a.undefinedNamesWrite,t.namedObjectsPromote=a.namedObjectsPromote,t.namedTableData=a.namedTableData,t.columnData=a.columnData,t.rangeFormulaEdit=a.rangeFormulaEdit,t.cellFormulaRangeFormulaEdit=a.cellFormulaRangeFormulaEdit,t.valueRangeFormulaEdit=a.valueRangeFormulaEdit,t.inferredRangeFormulaEdit=a.inferredRangeFormulaEdit,t.RibbonFormat=a.RibbonFormat,t.formatEditOperation=a.formatEditOperation,t.formatEditSetFormat=a.formatEditSetFormat,t.formatEditRibbonFormat=a.formatEditRibbonFormat,t.formatEditChangeDecimals=a.formatEditChangeDecimals,t.rangeFormatEdit=a.rangeFormatEdit,t.arrayFormulaEdit=a.arrayFormulaEdit,t.rangePasteEdit=a.rangePasteEdit,t.copyPasteRangePasteEdit=a.copyPasteRangePasteEdit,t.inferredFormat=a.inferredFormat,t.cellDataDelta=a.cellDataDelta,t.rangeDelta=a.rangeDelta,t.arrayDelta=a.arrayDelta,t.rangeFailure=a.rangeFailure,t.recalcResults=a.recalcResults,t.evalFormulaData=a.evalFormulaData,t.evalFormulaFormat=a.evalFormulaFormat,t.evalFormulaFormatOrigin=a.evalFormulaFormatOrigin,t.evalFormulaFormatIformat=a.evalFormulaFormatIformat,t.evalFormulaFormatKnown=a.evalFormulaFormatKnown,t.evalFormulaFormatInferred=a.evalFormulaFormatInferred,t.evalFormulaFormatAggregate=a.evalFormulaFormatAggregate,t.updateRequest=a.updateRequest,t.runExperiment=a.runExperiment,t.recalcServiceConfig=a.recalcServiceConfig,t.workbookProps=a.workbookProps,t.createRecalcService=i.createRecalcService,t.RecalcServiceCreateMode=a.RecalcServiceCreateMode,t.localeInfoFromData=o.localeInfoFromData,t.cellValueToReadOper=o.cellValueToReadOper,t.readOperToCellValue=o.readOperToCellValue,t.recalcServiceInsideInit=s.recalcServiceInsideInit,t.getTime=u.getTimeImpl,t.RecalcServiceDataTransformer=c.RecalcServiceDataTransformer,t.internal=l},62469:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getExcelOnlineCalcNewPackagesNames=void 0;const n=r(91092),a=r(84817),i=r(55174),o=r(64562),s=r(42459),u=r(40841),l=`${n.PackageName}, ${a.PackageName},\n  ${i.PackageName}, ${o.PackageName}, ${s.PackageName}, ${u.PackageName}`;t.getExcelOnlineCalcNewPackagesNames=function(){return l}},69820:function(e,t,r){"use strict";const n=r(91092);e.exports=n.anonymizer},73701:function(e,t,r){"use strict";const n=r(91092);e.exports=n.assertions},83264:function(e,t,r){"use strict";const n=r(91092);e.exports=n.asyncLoopModule},73506:function(e,t,r){"use strict";const n=r(91092);e.exports=n.config},36159:function(e,t,r){"use strict";const n=r(91092);e.exports=n.core},24945:function(e,t,r){"use strict";const n=r(91092);e.exports=n.arrayMapTree},26795:function(e,t,r){"use strict";const n=r(91092);e.exports=n.bspSet},96482:function(e,t,r){"use strict";const n=r(91092);e.exports=n.deque},5033:function(e,t,r){"use strict";const n=r(91092);e.exports=n.interval},66329:function(e,t,r){"use strict";const n=r(91092);e.exports=n.priorityQueue},89817:function(e,t,r){"use strict";const n=r(91092);e.exports=n.productSet},43595:function(e,t,r){"use strict";const n=r(91092);e.exports=n.rbMapTree},97902:function(e,t,r){"use strict";const n=r(91092);e.exports=n.split},24098:function(e,t,r){"use strict";const n=r(91092);e.exports=n.table},60756:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.overrideTypedFeatureGates=t.isTypedChangeGateEnabled=t.getTypedFeatureGate=t.getFeatures=t.isFeatureEnabled=t.initFeatureConfiguration=t.FeatureName=void 0;const n=r(91092);t.FeatureName=n.featureConfiguration.FeatureName,t.initFeatureConfiguration=n.featureConfiguration.initFeatureConfiguration,t.isFeatureEnabled=n.featureConfiguration.isFeatureEnabled,t.getFeatures=n.featureConfiguration.getFeatures,t.getTypedFeatureGate=n.featureConfiguration.getTypedFeatureGate,t.isTypedChangeGateEnabled=n.featureConfiguration.isTypedChangeGateEnabled;var a=r(66761);Object.defineProperty(t,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return a.overrideTypedFeatureGates}}),Object.defineProperty(t,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return a.setFeatureGateDictionaryGetter}})},71768:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JSF32=void 0;var n=r(91092);Object.defineProperty(t,"JSF32",{enumerable:!0,get:function(){return n.JSF32}})},61855:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mixin=void 0;var n=r(91092);Object.defineProperty(t,"mixin",{enumerable:!0,get:function(){return n.mixin}})},64327:function(e,t,r){"use strict";const n=r(91092);e.exports=n.promise},91988:function(e,t,r){"use strict";const n=r(91092);e.exports=n.resolvablePromise},1765:function(e,t,r){"use strict";const n=r(91092);e.exports=n.result},44252:function(e,t,r){"use strict";const n=r(91092);e.exports=n.machine},63488:function(e,t,r){"use strict";const n=r(91092);e.exports=n.pledge},84468:function(e,t,r){"use strict";const n=r(91092);e.exports=n.setTimeoutInterfaceModule},80957:function(e,t,r){"use strict";const n=r(91092);e.exports=n.stopwatch},3028:function(e,t,r){"use strict";const n=r(91092);e.exports=n.util},87760:function(e,t,r){"use strict";const n=r(91092);e.exports=n.wrapIntoAsyncModule},86270:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ds=t.ResultKind=t.arrayFill=t.stringEndsWith=t.stringStartsWith=t.isInteger=t.messageFromError=t.assertIndex=t.assertPositiveInteger=t.assertPositiveLength=t.assertFalse=t.assertTrue=t.assertNatural=t.assertNever=t.Pledge=t.JSF32=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.now=t.makeStringMap=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.numEnumMap=t.numEnumArray=t.identity=t.fastAbs=t.fastMax=t.fastMin=void 0;const n=r(74643),a=n.__importStar(r(36159)),i=n.__importStar(r(73701)),o=n.__importStar(r(3028)),s=n.__importStar(r(96482)),u=n.__importStar(r(91092)),l=n.__importStar(r(63488));t.fastMin=a.fastMin,t.fastMax=a.fastMax,t.fastAbs=a.fastAbs,t.identity=a.identity,t.numEnumArray=a.numEnumArray,t.numEnumMap=a.numEnumMap,t.safePush=a.safePush,t.safeConcat=a.safeConcat,t.isDefined=a.isDefined,t.isNone=a.isNone,t.makeStringMap=a.makeStringMap,t.now=a.now,t.staticAssertExtends=a.staticAssertExtends,t.staticAssertSame=a.staticAssertSame,t.staticAssertIs=a.staticAssertIs,t.staticAssertIsOptional=a.staticAssertIsOptional,t.JSF32=u.JSF32,t.Pledge=l.Pledge,t.assertNever=i.assertNever,t.assertNatural=i.assertNatural,t.assertTrue=i.assertTrue,t.assertFalse=i.assertFalse,t.assertPositiveLength=i.assertPositiveLength,t.assertPositiveInteger=i.assertPositiveInteger,t.assertIndex=i.assertIndex,t.messageFromError=o.messageFromError,t.isInteger=o.isInteger,t.stringStartsWith=o.stringStartsWith,t.stringEndsWith=o.stringEndsWith,t.arrayFill=o.arrayFill,t.ResultKind=u.result.ResultKind,t.ds=s},78663:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FeatureName=t.getCalcAbsUrl=t.isCalcInit=t.createIsThousandsPositionCallback=t.createWorksheetFuncNameCallbacks=t.operatorIdToName=t.englishOperatorIdToName=t.englishErrorTypeToName=t.englishWorksheetFuncIdToName=t.getEnglishLocaleInfo=t.initCalc=t.calcConfig=t.PictureDbnum=t.PictureColor=t.PictureSingle=t.PictureSpecial=t.Country=t.LCID=t.localeInfo=t.ulsLogger=t.NulLogger=t.TraceLevel=t.LogCategory=void 0;const n=r(74643),a=n.__importStar(r(57993)),i=n.__importStar(r(73506)),o=n.__importStar(r(60756));t.LogCategory=a.LogCategory,t.TraceLevel=a.TraceLevel,t.NulLogger=a.NulLogger,t.ulsLogger=a.ulsLogger,t.localeInfo=a.localeInfo,t.LCID=a.LCID,t.Country=a.Country,t.PictureSpecial=a.PictureSpecial,t.PictureSingle=a.PictureSingle,t.PictureColor=a.PictureColor,t.PictureDbnum=a.PictureDbnum,t.calcConfig=a.calcConfig,t.initCalc=i.initCalc,t.getEnglishLocaleInfo=a.getEnglishLocaleInfo,t.englishWorksheetFuncIdToName=a.englishWorksheetFuncIdToName,t.englishErrorTypeToName=a.englishErrorTypeToName,t.englishOperatorIdToName=a.englishOperatorIdToName,t.operatorIdToName=a.operatorIdToName,t.createWorksheetFuncNameCallbacks=a.createWorksheetFuncNameCallbacks,t.createIsThousandsPositionCallback=a.createIsThousandsPositionCallback,t.isCalcInit=i.isCalcInit,t.getCalcAbsUrl=i.getCalcAbsUrl,t.FeatureName=o.FeatureName},71481:function(e,t,r){"use strict";const n=r(74643).__importStar(r(99598));e.exports=n},2188:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.machine=t.DerefOperKind=void 0;const n=r(74643).__importStar(r(56471));t.DerefOperKind=n.DerefOperKind,t.machine=n.machine},26389:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.contextNameNode=t.fieldRefNamePart=t.cellRefNamePart=t.identNamePart=t.nameNode=t.parenNode=t.wsfNode=t.operatorNode=t.lambdaNode=t.lambdaParam=t.paramNode=t.paramDefault=t.paramName=t.flattenLambdaArgs=t.letNode=t.letVar=t.indexedArg=t.flattenLetArgs=t.appNode=t.arrayNode=t.literalNode=t.formulaSpan=t.singleLineComment=t.multiLineComment=t.formula=t.cellRefBad=t.cellRefCol=t.cellRefRow=t.cellRefRange=t.cellRefSingle=t.cellRefError=t.pos=t.badQualifier=t.sheetRangeQualifier=t.identQualifier=t.sheetQualifier=t.documentQualifier=t.relativeQualifier=t.errorQualifier=t.BadType=t.StructRefKind=t.SpecialRefId=t.NamePartKind=t.NodeKind=t.CommentKind=t.PosKind=t.CellRefKind=t.QualifierKind=t.SyntaxFeature=t.RefStyle=void 0,t.localNameDeclAnnotation=t.localNameUseAnnotation=t.formulaRootAnnotation=t.appHeadNameAnnotation=t.AnnotationKind=t.headNamePart=t.flattenNameParts=t.badSequenceNode=t.badCharsNode=t.missingNode=t.identNode=t.varNode=t.badRef=t.missingRef=t.thisRowOpRef=t.commaOpRef=t.rangeOpRef=t.columnRef=t.specialRef=t.structRef=t.structRefNode=t.fieldRef=t.fieldRefNode=t.cellRefNode=void 0;const n=r(74643).__importStar(r(12973));t.RefStyle=n.RefStyle,t.SyntaxFeature=n.SyntaxFeature,t.QualifierKind=n.QualifierKind,t.CellRefKind=n.CellRefKind,t.PosKind=n.PosKind,t.CommentKind=n.CommentKind,t.NodeKind=n.NodeKind,t.NamePartKind=n.NamePartKind,t.SpecialRefId=n.SpecialRefId,t.StructRefKind=n.StructRefKind,t.BadType=n.BadType,t.errorQualifier=n.errorQualifier,t.relativeQualifier=n.relativeQualifier,t.documentQualifier=n.documentQualifier,t.sheetQualifier=n.sheetQualifier,t.identQualifier=n.identQualifier,t.sheetRangeQualifier=n.sheetRangeQualifier,t.badQualifier=n.badQualifier,t.pos=n.pos,t.cellRefError=n.cellRefError,t.cellRefSingle=n.cellRefSingle,t.cellRefRange=n.cellRefRange,t.cellRefRow=n.cellRefRow,t.cellRefCol=n.cellRefCol,t.cellRefBad=n.cellRefBad,t.formula=n.formula,t.multiLineComment=n.multiLineComment,t.singleLineComment=n.singleLineComment,t.formulaSpan=n.formulaSpan,t.literalNode=n.literalNode,t.arrayNode=n.arrayNode,t.appNode=n.appNode,t.flattenLetArgs=n.flattenLetArgs,t.indexedArg=n.indexedArg,t.letVar=n.letVar,t.letNode=n.letNode,t.flattenLambdaArgs=n.flattenLambdaArgs,t.paramName=n.paramName,t.paramDefault=n.paramDefault,t.paramNode=n.paramNode,t.lambdaParam=n.lambdaParam,t.lambdaNode=n.lambdaNode,t.operatorNode=n.operatorNode,t.wsfNode=n.wsfNode,t.parenNode=n.parenNode,t.nameNode=n.nameNode,t.identNamePart=n.identNamePart,t.cellRefNamePart=n.cellRefNamePart,t.fieldRefNamePart=n.fieldRefNamePart,t.contextNameNode=n.contextNameNode,t.cellRefNode=n.cellRefNode,t.fieldRefNode=n.fieldRefNode,t.fieldRef=n.fieldRef,t.structRefNode=n.structRefNode,t.structRef=n.structRef,t.specialRef=n.specialRef,t.columnRef=n.columnRef,t.rangeOpRef=n.rangeOpRef,t.commaOpRef=n.commaOpRef,t.thisRowOpRef=n.thisRowOpRef,t.missingRef=n.missingRef,t.badRef=n.badRef,t.varNode=n.varNode,t.identNode=n.identNode,t.missingNode=n.missingNode,t.badCharsNode=n.badCharsNode,t.badSequenceNode=n.badSequenceNode,t.flattenNameParts=n.flattenNameParts,t.headNamePart=n.headNamePart,t.AnnotationKind=n.AnnotationKind,t.appHeadNameAnnotation=n.appHeadNameAnnotation,t.formulaRootAnnotation=n.formulaRootAnnotation,t.localNameUseAnnotation=n.localNameUseAnnotation,t.localNameDeclAnnotation=n.localNameDeclAnnotation},77398:function(e,t,r){"use strict";const n=r(42459);e.exports=n.getWorksheetFuncModule},21386:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nextFuncs=t.getWorksheetFunc=void 0;const n=r(74643).__importStar(r(77398)),a=r(42459);t.getWorksheetFunc=n.getWorksheetFunc,t.nextFuncs=a.nextFuncs.nextFuncs},24865:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.packageVersion=void 0,t.packageVersion="57.13.32"},91662:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.chFiniteNumber=t.check=t.chBoolean=t.arrayChecker=t.incrementFailure=t.registerExperimentFactory=t.ExperimentKind=t.UnitExperiment=t.blankStyleValue=t.forEachProduct=t.project=t.compareProduct=t.intersectProduct=t.exceptProduct=t.meetsProduct=t.unionProduct=t.union=t.dense=t.empty=t.namedTable=t.namedFormula=t.makeGridRangeTable=t.forEachRangeInSet=t.forEachCellInSet=t.bspFactory=t.createCellSetFromRange=t.PartialWorkbook=t.blankStyle=t.knownFormatData=t.genFmt=t.locale=t.createRange=t.mathpack=t.englishLocaleData=t.blankCellFormat=t.CloningTarget=t.sheetInFilterMode=t.sheetHiddenRows=t.UnavailableKind=t.OutputMessageKind=t.isFailureOutputMessage=t.SpecialFormat=t.SpecialStyle=t.ComputeKind=t.ComputedCellKind=t.createSheetCellSetFromRange=t.sheetCellSet=t.voidCallback=t.VolatileMode=t.PartialWorkbookDocumentCollection=void 0,t.optChecker=t.oneOfChecker=t.objectChecker=t.chPossiblyInfiniteNumber=void 0;const n=r(74643),a=n.__importStar(r(4595)),i=n.__importStar(r(66505)),o=n.__importStar(r(41739)),s=n.__importStar(r(76726)),u=n.__importStar(r(53111)),l=n.__importStar(r(55)),c=n.__importStar(r(73812)),d=n.__importStar(r(57786)),g=n.__importStar(r(26795)),m=n.__importStar(r(89817)),h=n.__importStar(r(8101)),p=n.__importStar(r(74599)),f=n.__importStar(r(97207)),S=n.__importStar(r(90437)),v=n.__importStar(r(94973)),F=n.__importStar(r(33903)),y=n.__importStar(r(40238));t.PartialWorkbookDocumentCollection=s.PartialWorkbookDocumentCollection,t.VolatileMode=a.VolatileMode,t.voidCallback=s.voidCallback,t.sheetCellSet=o.sheetCellSet,t.createSheetCellSetFromRange=o.createSheetCellSetFromRange,t.ComputedCellKind=o.ComputedCellKind,t.ComputeKind=o.ComputeKind,t.SpecialStyle=o.SpecialStyle,t.SpecialFormat=o.SpecialFormat,t.isFailureOutputMessage=i.isFailureOutputMessage,t.OutputMessageKind=o.OutputMessageKind,t.UnavailableKind=o.UnavailableKind,t.sheetHiddenRows=o.sheetHiddenRows,t.sheetInFilterMode=o.sheetInFilterMode,t.CloningTarget=l.CloningTarget,t.blankCellFormat=l.blankCellFormat,t.englishLocaleData=c.englishLocaleData,t.mathpack=c.mathpack,t.createRange=c.createRange,t.locale=c.locale,t.genFmt=c.genFmt,t.knownFormatData=c.knownFormatData,t.blankStyle=c.blankStyle,t.PartialWorkbook=u.PartialWorkbook,t.createCellSetFromRange=d.createCellSetFromRange,t.bspFactory=d.bspFactory,t.forEachCellInSet=d.forEachCellInSet,t.forEachRangeInSet=d.forEachRangeInSet,t.makeGridRangeTable=p.makeGridRangeTable,t.namedFormula=f.namedFormula,t.namedTable=f.namedTable,t.empty=g.empty,t.dense=g.dense,t.union=g.union,t.unionProduct=m.unionProduct,t.meetsProduct=m.meetsProduct,t.exceptProduct=m.exceptProduct,t.intersectProduct=m.intersectProduct,t.compareProduct=m.compareProduct,t.project=m.project,t.forEachProduct=m.forEachProduct,t.blankStyleValue=h.blankStyleValue,t.UnitExperiment=F.UnitExperiment,t.ExperimentKind=S.ExperimentKind,t.registerExperimentFactory=S.registerExperimentFactory,t.incrementFailure=y.incrementFailure,t.arrayChecker=v.arrayChecker,t.chBoolean=v.chBoolean,t.check=v.check,t.chFiniteNumber=v.chFiniteNumber,t.chPossiblyInfiniteNumber=v.chPossiblyInfiniteNumber,t.objectChecker=v.objectChecker,t.oneOfChecker=v.oneOfChecker,t.optChecker=v.optChecker},76404:function(e,t,r){"use strict";const n=r(84817);e.exports=n.adjust},17157:function(e,t,r){"use strict";const n=r(84817);e.exports=n.annotations},62020:function(e,t,r){"use strict";const n=r(84817);e.exports=n.cellFormat},92536:function(e,t,r){"use strict";const n=r(84817);e.exports=n.cellParse},57993:function(e,t,r){"use strict";const n=r(84817);e.exports=n.config},99598:function(e,t,r){"use strict";const n=r(84817);e.exports=n.datepack},12973:function(e,t,r){"use strict";const n=r(84817);e.exports=n.formulaModule},60140:function(e,t,r){"use strict";const n=r(84817);e.exports=n.location},81943:function(e,t,r){"use strict";const n=r(84817);e.exports=n.mathpack},47756:function(e,t,r){"use strict";const n=r(84817);e.exports=n.mathpackIEEE},84288:function(e,t,r){"use strict";const n=r(84817);e.exports=n.mathpackXL},13168:function(e,t,r){"use strict";const n=r(84817);e.exports=n.numfmt},16101:function(e,t,r){"use strict";const n=r(84817);e.exports=n.printService},79664:function(e,t,r){"use strict";const n=r(84817);e.exports=n.printServiceTypes},75938:function(e,t,r){"use strict";const n=r(84817);e.exports=n.relabel},92988:function(e,t,r){"use strict";const n=r(84817);e.exports=n.resolveService},58251:function(e,t,r){"use strict";const n=r(84817);e.exports=n.resolveServiceTypes},27437:function(e,t,r){"use strict";const n=r(84817);e.exports=n.signature},83970:function(e,t,r){"use strict";const n=r(84817);e.exports=n.types},92587:function(e,t,r){"use strict";const n=r(84817);e.exports=n.util},96978:function(e,t,r){"use strict";const n=r(84817);e.exports=n.value},50013:function(e,t,r){"use strict";const n=r(84817);e.exports=n.visitor},98396:function(e,t,r){"use strict";const n=r(74643).__importStar(r(60140));e.exports=n},6347:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatScientificLeft=t.xlMathpack=t.ieeeMathpack=t.numberComponents=void 0;const n=r(74643),a=n.__importStar(r(81943)),i=n.__importStar(r(47756)),o=n.__importStar(r(84288));t.numberComponents=a.numberComponents,t.ieeeMathpack=i.ieeeMathpack,t.xlMathpack=o.xlMathpack,t.formatScientificLeft=a.formatScientificLeft},32322:function(e,t,r){"use strict";const n=r(64562);e.exports=n.edit},64962:function(e,t,r){"use strict";const n=r(64562);e.exports=n.formatService},78468:function(e,t,r){"use strict";const n=r(64562);e.exports=n.knownFormat},31532:function(e,t,r){"use strict";const n=r(64562);e.exports=n.localeData},12529:function(e,t,r){"use strict";const n=r(64562);e.exports=n.ribbonFormat},30070:function(e,t,r){"use strict";const n=r(64562);e.exports=n.serviceTypes},22570:function(e,t,r){"use strict";const n=r(64562);e.exports=n.util},8860:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.englishXLSXKnownFormat=t.isKnownFormatDefined=t.getKnownFormat=t.Calendar=t.NumberShape=t.DateOrder=t.CurrencyFormat=t.KnownFormat=t.evalFormatLocalsGrid=t.createFormatGlobals=t.NumberFormatSource=t.otherEdit=t.numberEdit=t.stringEdit=t.formulaEdit=t.EditKind=t.renderedValueToString=t.renderInfiniteWidth=t.memoizedRenderCallback=t.renderCallback=t.isHashesValue=t.hashesValue=t.renderedValue=t.formattedValue=t.formattedUnitFlexible=t.formattedUnitBlank=t.formattedUnitString=t.formattedUnitGeneral=t.FormattedUnitKind=t.Clip=t.GetTimeKind=t.Alignment=t.NamedColor=t.FormatCurrency=t.CultureTag=t.BidiDate=t.FormatValueType=t.formatLocIFormat=t.formatLocKnownFormat=t.FormatLocKind=t.previousFormatFailure=t.fractionOverflow=t.dateOverflow=t.aggregationError=t.tooWide=t.noFormatPart=t.notFormatString=t.notValueString=t.ReasonKind=t.FormatReasonKind=void 0,t.toXLNumber=t.applyValueEdit=t.getValueEditOperKind=t.createNumberFormatter=t.shouldInstallFormat=t.getRibbonFormat=t.RibbonFormat=void 0;const n=r(74643),a=n.__importStar(r(30070)),i=n.__importStar(r(13168)),o=n.__importStar(r(78468)),s=n.__importStar(r(12529)),u=n.__importStar(r(32322)),l=n.__importStar(r(64962)),c=n.__importStar(r(22570));t.FormatReasonKind=a.FormatReasonKind,t.ReasonKind=a.ReasonKind,t.notValueString=a.notValueString,t.notFormatString=a.notFormatString,t.noFormatPart=a.noFormatPart,t.tooWide=a.tooWide,t.aggregationError=a.aggregationError,t.dateOverflow=a.dateOverflow,t.fractionOverflow=a.fractionOverflow,t.previousFormatFailure=a.previousFormatFailure,t.FormatLocKind=a.FormatLocKind,t.formatLocKnownFormat=a.formatLocKnownFormat,t.formatLocIFormat=a.formatLocIFormat,t.FormatValueType=a.FormatValueType,t.BidiDate=a.BidiDate,t.CultureTag=a.CultureTag,t.FormatCurrency=a.FormatCurrency,t.NamedColor=a.NamedColor,t.Alignment=a.Alignment,t.GetTimeKind=a.GetTimeKind,t.Clip=a.Clip,t.FormattedUnitKind=a.FormattedUnitKind,t.formattedUnitGeneral=a.formattedUnitGeneral,t.formattedUnitString=a.formattedUnitString,t.formattedUnitBlank=a.formattedUnitBlank,t.formattedUnitFlexible=a.formattedUnitFlexible,t.formattedValue=a.formattedValue,t.renderedValue=a.renderedValue,t.hashesValue=a.hashesValue,t.isHashesValue=a.isHashesValue,t.renderCallback=a.renderCallback,t.memoizedRenderCallback=a.memoizedRenderCallback,t.renderInfiniteWidth=a.renderInfiniteWidth,t.renderedValueToString=a.renderedValueToString,t.EditKind=a.EditKind,t.formulaEdit=a.formulaEdit,t.stringEdit=a.stringEdit,t.numberEdit=a.numberEdit,t.otherEdit=a.otherEdit,t.NumberFormatSource=a.NumberFormatSource,t.createFormatGlobals=a.createFormatGlobals,t.evalFormatLocalsGrid=a.evalFormatLocalsGrid,t.KnownFormat=i.KnownFormat,t.CurrencyFormat=i.CurrencyFormat,t.DateOrder=i.DateOrder,t.NumberShape=i.NumberShape,t.Calendar=i.Calendar,t.getKnownFormat=o.getKnownFormat,t.isKnownFormatDefined=o.isKnownFormatDefined,t.englishXLSXKnownFormat=o.englishXLSXKnownFormat,t.RibbonFormat=s.RibbonFormat,t.getRibbonFormat=s.getRibbonFormat,t.shouldInstallFormat=u.shouldInstallFormat,t.createNumberFormatter=l.createNumberFormatter,t.getValueEditOperKind=c.getValueEditOperKind,t.applyValueEdit=c.applyValueEdit,t.toXLNumber=c.toXLNumber},33284:function(e,t,r){"use strict";const n=r(55174);e.exports=n.parseFieldRefModule},28276:function(e,t,r){"use strict";const n=r(55174);e.exports=n.parseResultHelperModule},18784:function(e,t,r){"use strict";const n=r(55174);e.exports=n.parserService},73440:function(e,t,r){"use strict";const n=r(55174);e.exports=n.parseServiceTypes},1395:function(e,t,r){"use strict";const n=r(55174);e.exports=n.token},44783:function(e,t,r){"use strict";const n=r(55174);e.exports=n.tokenizeFormulaModule},14082:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseResultHelper=t.createParser=t.notFormulaString=t.parseLocals=t.ReasonKind=t.createParseGlobals=void 0;const n=r(74643),a=n.__importStar(r(73440)),i=n.__importStar(r(18784)),o=n.__importStar(r(28276));t.createParseGlobals=a.createParseGlobals,t.ReasonKind=a.ReasonKind,t.parseLocals=a.parseLocals,t.notFormulaString=a.notFormulaString,t.createParser=i.createParser,t.parseResultHelper=o.parseResultHelper},66153:function(e,t,r){"use strict";const n=r(42459);e.exports=n.compilerService},74889:function(e,t,r){"use strict";const n=r(42459);e.exports=n.evaluatorService},56471:function(e,t,r){"use strict";const n=r(42459);e.exports=n.extensionTypes},84272:function(e,t,r){"use strict";const n=r(42459);e.exports=n.machine},74599:function(e,t,r){"use strict";const n=r(42459);e.exports=n.rtree},14009:function(e,t,r){"use strict";const n=r(42459);e.exports=n.serviceTypes},57608:function(e,t,r){"use strict";const n=r(42459);e.exports=n.value},25755:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.extension=t.createEvaluator=t.createCompiler=t.RecordOper=t.LambdaOper=t.LimitKind=t.limitExceeded=t.createCompileGlobals=t.illFormedFormula=t.compileLocalsName=t.compileLocalsGrid=t.evalLocals=t.evalGlobals=t.previousNameFailure=t.previousFailure=t.breaked=t.paused=t.cellCycle=t.nameCycle=t.stopped=t.userDefinedFunc=t.cellFormula=t.cellWellFormedFormula=t.pendingValue=t.finalValue=t.runtimePositionFirstOrderFunc=t.runtimePositionFormulaRoot=t.runtimePositionEtaLambdaBody=t.runtimePositionLambdaParam=t.runtimePositionLambdaRoot=t.runtimePositionLetVal=t.RuntimePositionKind=t.StepAction=t.Interrupt=t.CellKind=t.interval=t.ReasonKind=void 0;const n=r(74643),a=n.__importStar(r(14009)),i=n.__importStar(r(66153)),o=n.__importStar(r(74889)),s=n.__importStar(r(57608)),u=n.__importStar(r(2188));t.ReasonKind=a.ReasonKind,t.interval=a.interval,t.CellKind=a.CellKind,t.Interrupt=a.Interrupt,t.StepAction=a.StepAction,t.RuntimePositionKind=a.RuntimePositionKind,t.runtimePositionLetVal=a.runtimePositionLetVal,t.runtimePositionLambdaRoot=a.runtimePositionLambdaRoot,t.runtimePositionLambdaParam=a.runtimePositionLambdaParam,t.runtimePositionEtaLambdaBody=a.runtimePositionEtaLambdaBody,t.runtimePositionFormulaRoot=a.runtimePositionFormulaRoot,t.runtimePositionFirstOrderFunc=a.runtimePositionFirstOrderFunc,t.finalValue=a.finalValue,t.pendingValue=a.pendingValue,t.cellWellFormedFormula=a.cellWellFormedFormula,t.cellFormula=a.cellFormula,t.userDefinedFunc=a.userDefinedFunc,t.stopped=a.stopped,t.nameCycle=a.nameCycle,t.cellCycle=a.cellCycle,t.paused=a.paused,t.breaked=a.breaked,t.previousFailure=a.previousFailure,t.previousNameFailure=a.previousNameFailure,t.evalGlobals=a.evalGlobals,t.evalLocals=a.evalLocals,t.compileLocalsGrid=a.compileLocalsGrid,t.compileLocalsName=a.compileLocalsName,t.illFormedFormula=a.illFormedFormula,t.createCompileGlobals=a.createCompileGlobals,t.limitExceeded=a.limitExceeded,t.LimitKind=a.LimitKind,t.LambdaOper=s.LambdaOper,t.RecordOper=s.RecordOper,t.createCompiler=i.createCompiler,t.createEvaluator=o.createEvaluator,t.extension=u},49353:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getWorksheetFuncType=t.getOperatorType=t.unknownFunctionType=t.functionType=t.SpecialPrecs=t.WorksheetFuncId=t.OperatorId=t.FunctionFlags=t.SignatureType=void 0;const n=r(74643),a=n.__importStar(r(27437)),i=n.__importStar(r(83970));t.SignatureType=i.SignatureType,t.FunctionFlags=i.FunctionFlags,t.OperatorId=a.OperatorId,t.WorksheetFuncId=a.WorksheetFuncId,t.SpecialPrecs=i.SpecialPrecs,t.functionType=i.functionType,t.unknownFunctionType=a.unknownFunctionType,t.getOperatorType=a.getOperatorType,t.getWorksheetFuncType=a.getWorksheetFuncType},3030:function(e,t,r){"use strict";const n=r(84817);e.exports=n.styleServiceTypes},18236:function(e,t,r){"use strict";const n=r(74643).__importStar(r(3030));e.exports=n},11513:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runSmokeTest=t.cancelSmokeTest=void 0,t.cancelSmokeTest=function(){},t.runSmokeTest=function(){return Promise.resolve()}},1961:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReasonKind=t.isSuccess=t.successUndefined=t.failure=t.success=t.ResultKind=t.isReadOperEqual=t.isWriteOper=t.isPrimitiveOper=t.isRichOper=t.isBlankOper=t.isMissingOper=t.isArrayOper=t.isRangeOper=t.isErrorOper=t.isBooleanOper=t.isStringOper=t.isNumberOper=t.isValidArgsLength=t.getArgType=t.getArguments=t.gridCellRange=t.sheetGridRangeAnchor=t.gridRangeAnchor=t.isWSFNode=t.isOperatorNode=t.isUnqualifiedNameNode=t.isWellFormed=t.isSheetGridRangeEqual=t.isSheetGridCellEqual=t.isGridRangeEqual=t.isGridCellEqual=t.isNameScopeEqual=t.isSheetIndexEqual=t.isDocumentLocEqual=t.gridRangeSize=t.gridRangeExcept=t.gridRangeCompare=t.gridCellImplicitIsect=t.gridRangeIsects=t.gridRangeIsect=t.gridRangesJoin=t.gridRangeJoinOpt=t.gridRangeJoin=t.forEachTileInRange=t.forEachCellInRange=t.isSheetGridCell=t.isGridCell=t.isSheetGridRange=t.isSheetIndex=void 0,t.ConstVisitor=t.identityVisitor=t.IdentityVisitor=t.visitCellRef=t.visitQualifier=t.visitAppHeadNode=t.visitWSFNode=t.visitOperatorNode=t.visitFormulaNode=t.resolveGridRef=t.createResolver=t.resolvedDottedName=t.resolvedNever=t.resolvedStructRef=t.resolvedWorksheetFunc=t.resolvedLocalName=t.resolvedUserDefinedFunc=t.resolvedCellRef=t.resolvedName=t.ResolvedKind=t.emptyIntersection=t.InvalidStructRefReason=t.invalidStructRef=t.InvalidCellRefReason=t.invalidCellRef=t.InvalidQualifierReason=t.invalidQualifier=t.noOriginSheet=t.ResolveReasonKind=t.resolveLocalsGrid=t.wrapPosition=t.parseQualifier=t.parseGridRangeA1=t.parseGridCellA1=t.formatName=t.formatGridRange=t.formatQualifier=t.formatRangePos=t.formatCellPos=t.formatColRange=t.formatRowRange=t.formatCol=t.formatRow=t.resolvePosition=t.columnName=t.createFailureErrorClass=t.javaScriptError=t.internal=t.unavailable=t.notImplemented=void 0,t.relabelFormula=t.createPrinter=t.printLocalsName=t.printLocalsGrid=t.createSimplePrintGlobals=t.buildAnnotations=t.reducePledge=t.reduceBottomUp=t.composeVisitor=t.ComposeVisitor=t.binaryVisitor=t.BinaryVisitor=t.DelegatingVisitor=t.voidVisitor=t.constVisitor=void 0;const n=r(74643),a=n.__importStar(r(62020)),i=n.__importStar(r(92536)),o=n.__importStar(r(92587)),s=n.__importStar(r(58251)),u=n.__importStar(r(1765)),l=n.__importStar(r(92988)),c=n.__importStar(r(50013)),d=n.__importStar(r(17157)),g=n.__importStar(r(75938)),m=n.__importStar(r(79664)),h=n.__importStar(r(16101));t.isSheetIndex=o.isSheetIndex,t.isSheetGridRange=o.isSheetGridRange,t.isGridCell=o.isGridCell,t.isSheetGridCell=o.isSheetGridCell,t.forEachCellInRange=o.forEachCellInRange,t.forEachTileInRange=o.forEachTileInRange,t.gridRangeJoin=o.gridRangeJoin,t.gridRangeJoinOpt=o.gridRangeJoinOpt,t.gridRangesJoin=o.gridRangesJoin,t.gridRangeIsect=o.gridRangeIsect,t.gridRangeIsects=o.gridRangeIsects,t.gridCellImplicitIsect=o.gridCellImplicitIsect,t.gridRangeCompare=o.gridRangeCompare,t.gridRangeExcept=o.gridRangeExcept,t.gridRangeSize=o.gridRangeSize,t.isDocumentLocEqual=o.isDocumentLocEqual,t.isSheetIndexEqual=o.isSheetIndexEqual,t.isNameScopeEqual=o.isNameScopeEqual,t.isGridCellEqual=o.isGridCellEqual,t.isGridRangeEqual=o.isGridRangeEqual,t.isSheetGridCellEqual=o.isSheetGridCellEqual,t.isSheetGridRangeEqual=o.isSheetGridRangeEqual,t.isWellFormed=o.isWellFormed,t.isUnqualifiedNameNode=o.isUnqualifiedNameNode,t.isOperatorNode=o.isOperatorNode,t.isWSFNode=o.isWSFNode,t.gridRangeAnchor=o.gridRangeAnchor,t.sheetGridRangeAnchor=o.sheetGridRangeAnchor,t.gridCellRange=o.gridCellRange,t.getArguments=o.getArguments,t.getArgType=o.getArgType,t.isValidArgsLength=o.isValidArgsLength,t.isNumberOper=o.isNumberOper,t.isStringOper=o.isStringOper,t.isBooleanOper=o.isBooleanOper,t.isErrorOper=o.isErrorOper,t.isRangeOper=o.isRangeOper,t.isArrayOper=o.isArrayOper,t.isMissingOper=o.isMissingOper,t.isBlankOper=o.isBlankOper,t.isRichOper=o.isRichOper,t.isPrimitiveOper=o.isPrimitiveOper,t.isWriteOper=o.isWriteOper,t.isReadOperEqual=o.isReadOperEqual,t.ResultKind=u.ResultKind,t.success=u.success,t.failure=u.failure,t.successUndefined=u.successUndefined,t.isSuccess=u.isSuccess,t.ReasonKind=o.ReasonKind,t.notImplemented=o.notImplemented,t.unavailable=o.unavailable,t.internal=o.internal,t.javaScriptError=u.javaScriptError,t.createFailureErrorClass=o.createFailureErrorClass,t.columnName=a.columnName,t.resolvePosition=a.resolvePosition,t.formatRow=a.formatRow,t.formatCol=a.formatCol,t.formatRowRange=a.formatRowRange,t.formatColRange=a.formatColRange,t.formatCellPos=a.formatCellPos,t.formatRangePos=a.formatRangePos,t.formatQualifier=a.formatQualifier,t.formatGridRange=a.formatGridRange,t.formatName=a.formatName,t.parseGridCellA1=i.parseGridCellA1,t.parseGridRangeA1=i.parseGridRangeA1,t.parseQualifier=i.parseQualifier,t.wrapPosition=i.wrapPosition,t.resolveLocalsGrid=s.resolveLocalsGrid,t.ResolveReasonKind=s.ResolveReasonKind,t.noOriginSheet=s.noOriginSheet,t.invalidQualifier=s.invalidQualifier,t.InvalidQualifierReason=s.InvalidQualifierReason,t.invalidCellRef=s.invalidCellRef,t.InvalidCellRefReason=s.InvalidCellRefReason,t.invalidStructRef=s.invalidStructRef,t.InvalidStructRefReason=s.InvalidStructRefReason,t.emptyIntersection=s.emptyIntersection,t.ResolvedKind=s.ResolvedKind,t.resolvedName=s.resolvedName,t.resolvedCellRef=s.resolvedCellRef,t.resolvedUserDefinedFunc=s.resolvedUserDefinedFunc,t.resolvedLocalName=s.resolvedLocalName,t.resolvedWorksheetFunc=s.resolvedWorksheetFunc,t.resolvedStructRef=s.resolvedStructRef,t.resolvedNever=s.resolvedNever,t.resolvedDottedName=s.resolvedDottedName,t.createResolver=l.createResolver,t.resolveGridRef=l.resolveGridRef,t.visitFormulaNode=c.visitFormulaNode,t.visitOperatorNode=c.visitOperatorNode,t.visitWSFNode=c.visitWSFNode,t.visitAppHeadNode=c.visitAppHeadNode,t.visitQualifier=c.visitQualifier,t.visitCellRef=c.visitCellRef,t.IdentityVisitor=c.IdentityVisitor,t.identityVisitor=c.identityVisitor,t.ConstVisitor=c.ConstVisitor,t.constVisitor=c.constVisitor,t.voidVisitor=c.voidVisitor,t.DelegatingVisitor=c.DelegatingVisitor,t.BinaryVisitor=c.BinaryVisitor,t.binaryVisitor=c.binaryVisitor,t.ComposeVisitor=c.ComposeVisitor,t.composeVisitor=c.composeVisitor,t.reduceBottomUp=c.reduceBottomUp,t.reducePledge=c.reducePledge,t.buildAnnotations=d.buildAnnotations,t.createSimplePrintGlobals=m.createSimplePrintGlobals,t.printLocalsGrid=m.printLocalsGrid,t.printLocalsName=m.printLocalsName,t.createPrinter=h.createPrinter,t.relabelFormula=g.relabelFormula},68120:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.blankOper=t.missingOper=t.range3DOper=t.rangeSeqOper=t.arrayOper=t.externalErrorOper=t.busyErrorOper=t.calcErrorOper=t.fieldErrorOper=t.unknownErrorOper=t.blockedErrorOper=t.connectErrorOper=t.spillErrorOper=t.gettingDataErrorOper=t.naErrorOper=t.numErrorOper=t.nameErrorOper=t.refErrorOper=t.valueErrorOper=t.div0ErrorOper=t.nullErrorOper=t.errorOper=t.booleanOper=t.stringOper=t.precedents=t.ErrorType=t.falseOper=t.trueOper=t.OperKind=t.PrecsBound=t.SpecialPrecs=void 0;const n=r(74643),a=n.__importStar(r(96978)),i=n.__importStar(r(83970));t.SpecialPrecs=i.SpecialPrecs,t.PrecsBound=a.PrecsBound,t.OperKind=i.OperKind,t.trueOper=a.trueOper,t.falseOper=a.falseOper,t.ErrorType=a.ErrorType,t.precedents=a.precedents,t.stringOper=a.stringOper,t.booleanOper=a.booleanOper,t.errorOper=a.errorOper,t.nullErrorOper=a.nullErrorOper,t.div0ErrorOper=a.div0ErrorOper,t.valueErrorOper=a.valueErrorOper,t.refErrorOper=a.refErrorOper,t.nameErrorOper=a.nameErrorOper,t.numErrorOper=a.numErrorOper,t.naErrorOper=a.naErrorOper,t.gettingDataErrorOper=a.gettingDataErrorOper,t.spillErrorOper=a.spillErrorOper,t.connectErrorOper=a.connectErrorOper,t.blockedErrorOper=a.blockedErrorOper,t.unknownErrorOper=a.unknownErrorOper,t.fieldErrorOper=a.fieldErrorOper,t.calcErrorOper=a.calcErrorOper,t.busyErrorOper=a.busyErrorOper,t.externalErrorOper=a.externalErrorOper,t.arrayOper=a.arrayOper,t.rangeSeqOper=a.rangeSeqOper,t.range3DOper=a.range3DOper,t.missingOper=a.missingOper,t.blankOper=a.blankOper},31327:function(e,t,r){"use strict";const n=r(74643).__importStar(r(11513));e.exports=n},98431:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.argumentAssistancePluginDependenciesResolved=t.ArgumentAssistancePlugin=void 0;const n=r(74643),a=r(2340),i=r(44544),o=r(50013),s=r(2488),u=r(57993),l=r(1765),c=r(30070),d=r(27308),g=r(38736),m=r(47943),h=r(4595),p=r(98468),f=r(3541),S=r(60756),v=r(93336),F=r(66761),y=r(12973),C=r(10048),A=r(91903),E=r(12893),b=A.PluginRegistry.create(v.PluginFactoryName.ArgumentAssistancePlugin,v.PluginGroup.Excel);let R=(()=>{let e,t,r,i=[b.x10Plugin()],p=[],v=[];return t=class{*run(e){this.lastRunTime=this.timer.now(),this.runStartTime=this.timer.now(),this.timeStamps=new Map;const t=yield{kind:a.ComputationRequestKind.GetActiveCell};if(t.kind!==a.ComputationRequestKind.GetActiveCell)return this.logFailure("failed to get active cell"),null;this.addTimeStamp("GetActiveCell");let r=yield{kind:a.ComputationRequestKind.ParseActiveCell,formulaText:e.content};if(this.addTimeStamp("ParseCellContentSync"),!(void 0!==r&&r.kind===a.ComputationRequestKind.ParseActiveCell&&(0,l.isSuccess)(r.result)||(r=yield{kind:a.ComputationRequestKind.ParseEdit,cell:t.activeCell,formulaBarText:e.content},this.addTimeStamp("ParseCellContentAsync"),r.kind===a.ComputationRequestKind.ParseEdit&&(0,l.isSuccess)(r.result))))return null;if(r.result.value.kind!==c.EditKind.Formula)return null;const{formula:n}=r.result.value,i=new g.ArgumentAssistanceVisitor(n,e.caretPosition,this.newNamedObjectsEnabled);if((0,o.reduceBottomUp)(i,n),this.addTimeStamp("ArgumentAssistanceVisitor"),void 0===i.assistedFunctionHead)return this.logTimeStamp(),null;const p=yield{kind:a.ComputationRequestKind.GetConfig};this.addTimeStamp("GetConfig");const f=p.kind===a.ComputationRequestKind.GetConfig?p.config.localeInfo.listSeparator:",",S=i.assistedFunctionHead;if(S.kind===y.NodeKind.Name){if(!this.newNamedObjectsEnabled)return null;const t=yield{kind:a.ComputationRequestKind.GetDefinedNamesInfo};if(t.kind!==a.ComputationRequestKind.GetDefinedNamesInfo)return this.logFailure("failed to get named objects info"),null;const r=t.definedNamesInfo.find((e=>e.name===S.whole));if(null==r?.reference)return null;const o=yield{kind:a.ComputationRequestKind.ParseActiveCell,formulaText:r.reference};if(o.kind!==a.ComputationRequestKind.ParseActiveCell||!(0,l.isSuccess)(o.result)||o.result.value.kind!==c.EditKind.Formula)return null;const{formula:s}=o.result.value;if(!s.isWellFormed||"Lambda"!==s.node.kind||!s.node.isClosed)return null;const u=[];for(const e of s.node.params){const{name:t,isBracketed:r}=e.name.arg.name;if("Ident"!==t.kind)return this.logFailure(`unexpected parameter in lambda function: ${t.kind}`),null;const n=r?`[${t.whole}]`:t.whole;u.push(n)}const d=(0,m.getActiveParamIndex)(n,i.assistedFunctionArgs,e.caretPosition,this.fixHandlingWhiteSpace);return{kind:"Minimal",functionName:S.whole,listSeparator:f,parameters:{params:u,activeParam:d}}}const v=yield{kind:a.ComputationRequestKind.GetFunctionInfo,functionName:S.whole};if(this.addTimeStamp("GetFunctionInfo"),v.kind!==a.ComputationRequestKind.GetFunctionInfo)return this.logFailure(`failed to get function info for ${S.whole}`),null;const F=new h.ResettableLazy((()=>(0,m.createFunctionRenderingInfo)(v.functionInfo,n,i.assistedFunctionArgs,e.caretPosition,S.id,f,this.fixHandlingWhiteSpace))),C=s.functionExamples.getValue()[S.id];if(this.addTimeStamp("GetExampleString"),void 0===C)return this.logFailure(`no example found for function: ${S.whole}, id: ${S.id}`),this.addTimeStampAndLog("createFunctionRenderingInfoNoExample"),F.getValue();const A=yield{kind:a.ComputationRequestKind.ParseCellFormula,cell:t.activeCell,formula:{formulaBarText:C,kind:d.FormulaKind.CellFormula},useEnglishLocaleInfo:!0};if(this.addTimeStamp("ParseExample"),A.kind!==a.ComputationRequestKind.ParseCellFormula||!(0,l.isSuccess)(A.result)){this.logFailure(`failed to parse example for function: ${S.whole}`);const e=F.getValue();return this.addTimeStampAndLog("createFunctionRenderingInfoFailedToParseExample"),e}if(p.kind===a.ComputationRequestKind.GetConfig&&p.config.localeInfo.lcid===u.LCID.USA){const t=(0,m.createFunctionRenderingInfo)(v.functionInfo,n,i.assistedFunctionArgs,e.caretPosition,S.id,f,this.fixHandlingWhiteSpace,C,A.result.value);return this.addTimeStampAndLog("createFunctionRenderingInfoEnUs"),t}const E=yield{kind:a.ComputationRequestKind.PrintFormula,formula:A.result.value,origin:t.activeCell};if(this.addTimeStamp("localize example string"),E.kind!==a.ComputationRequestKind.PrintFormula||!(0,l.isSuccess)(E.result)){this.logFailure(`failed to pretty print localized example for function: ${S.whole}`);const e=F.getValue();return this.addTimeStampAndLog("createFunctionRenderingInfoFailedToPrintLocalizedExample"),e}const b=yield{kind:a.ComputationRequestKind.ParseCellFormula,cell:t.activeCell,formula:{formulaBarText:E.result.value,kind:d.FormulaKind.CellFormula},useEnglishLocaleInfo:!1};if(this.addTimeStamp("parse localized example string"),b.kind!==a.ComputationRequestKind.ParseCellFormula||!(0,l.isSuccess)(b.result)){this.logFailure(`failed to parse localized example for function: ${S.whole}`);const e=F.getValue();return this.addTimeStampAndLog("createFunctionRenderingInfoFailedToParseLocalizedExample"),e}const R=(0,m.createFunctionRenderingInfo)(v.functionInfo,n,i.assistedFunctionArgs,e.caretPosition,S.id,f,this.fixHandlingWhiteSpace,E.result.value,b.result.value);return this.addTimeStampAndLog("createFunctionRenderingInfoWithLocalizedExample"),R}logFailure(e){u.ulsLogger.ULS.traceTag(545388683,u.LogCategory.msoulscat_ES_EWAJS,u.TraceLevel.Warning,`ArgumentAssistancePlugin encountered a failure with msg ${e}`)}addTimeStampAndLog(e){this.addTimeStamp(e),this.logTimeStamp()}logTimeStamp(){this.timeStamps.set("Overall",this.timer.now()-this.runStartTime);const e={};this.timeStamps.forEach(((t,r)=>{e[r]=t})),u.ulsLogger.ULS.traceTag(540377222,u.LogCategory.msoulscat_ES_EWAJS,u.TraceLevel.Info,`${JSON.stringify(e)}`)}addTimeStamp(e){this.timeStamps.set(e,this.timer.now()-this.lastRunTime),this.lastRunTime=this.timer.now()}constructor(){this.timer=(n.__runInitializers(this,v),f.defaultTimerInterface),this.lastRunTime=0,this.runStartTime=0,this.timeStamps=new Map,this.fixHandlingWhiteSpace=(0,S.isTypedChangeGateEnabled)("OfficeVSO:7920319_fixArgumentAssistanceHandlingWhitespaces"),this.newNamedObjectsEnabled=(0,F.getBooleanFeatureGate)("Microsoft.Office.Excel.FormulaAuthoringWithNameManager",!1)&&(0,F.getBooleanFeatureGate)("Microsoft.Office.Excel.XLONameManager",!1)}},n.__setFunctionName(t,"ArgumentAssistancePlugin"),(()=>{const a="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[b.uiMessageHandler({kind:E.RequestKind.argumentAssistance})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:a},null,v),n.__esDecorate(null,e={value:t},i,{kind:"class",name:t.name,metadata:a},null,p),t=e.value,a&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:a})})(),t.factory=b.injectPluginFactory(),n.__runInitializers(t,p),t})();t.ArgumentAssistancePlugin=R,(0,i.registerPluginFactory)(R.factory),t.argumentAssistancePluginDependenciesResolved=(0,C.trackableAsyncLazy)((async()=>{let e;e=(0,S.getTypedFeatureGate)("Microsoft.Office.Excel.ArgumentAssistanceOnMainThread")?await p.dynamicPluginLoaderCreated.getValue():await p.workerThreadSpread.getValue(),await e.loadPluginScript("formula-authoring-strings",!0),await e.createAndAttachPlugin(v.PluginFactoryName.ArgumentAssistancePlugin),await p.schedulerWithRecalcServiceAttached.getValue()}),"argumentAssistancePluginDependenciesResolved")},47943:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBaseParamName=t.getParamNumberSuffix=t.getParamIndexToHighlight=t.getActiveParamIndex=t.createFunctionRenderingInfo=void 0;const n=r(27437);function a(e,t,r,n){let a=0;if(n)for(let n=0;n<t.length;n++){const i=e.spans[t[n].label];if(i&&i.start-i.pre.length<=r&&r<=i.end+i.post.length){a=n;break}}else for(let n=t.length-1;n>=0;n-=1){const i=e.spans[t[n].label]?.end;void 0!==i&&r<=i&&(a=n)}return a}function i(e,t,r,n=!1,a=!1){const i=t-1,o=r.restTypes.length,s=r.headTypes.length;if(e<s+o)return e;if(e>=s&&0===o)return-1;const u=(e-s)%o;return n?e<=i-r.tailTypes.length?e:i-r.tailTypes.length-(o-1)+u:s+(a&&0===u&&r.tailTypes.length>0?o:u)}function o(e,t,r){let n=i(e,t,r);return u(e,r)&&(n+=1),n}function s(e,t,r){return 1+Math.max(Math.floor((e-t)/r),0)}function u(e,t){return t.restTypes.length>0&&e>=t.headTypes.length+t.restTypes.length}function l(e){return e.match(/[^0-9\[\]]+/)}function c(e,t){return{params:e,activeParam:Math.min(t,e.length-1)}}t.createFunctionRenderingInfo=function(e,t,r,d,g,m,h,p,f){const S=a(t,r,d,h),v=e.Params.split("!");return{kind:"Full",functionName:e.NameDataStrings,functionDescription:e.Help,signatures:v.map(((t,r)=>function(e,t,r,a,d,g,m,h){const p=(0,n.getWorksheetFuncType)(d),f=""!==t?t.split(g+" ").filter((e=>"..."!==e)):[],S=function(e,t,r){const n=e.slice(),a=t.headTypes.length,i=t.restTypes.length;if(i>0){let e=s(r,a,i);for(let t=a;t<n.length;t+=i){for(let r=0;r<i;r+=1){const a=l(n[t+r]),o=e>1&&r%i==0?"[":"",s=e>1&&r%i==i-1?"]":"";n[t+r]=`${o}${a}${e}${s}`}e+=1}n.push("..."),u(r,t)&&n.splice(a,0,"...")}return n}(f,p,a),v=function(e,t){return void 0===e||void 0===t?null:t.node.args.map((r=>{const n=t.spans[r.label];return n?e.substring(n.start,n.end):""}))}(m,h),F=function(e,t,r,n){let a=e.split("!");if(a=0===n?a.slice(0,t.length):a.slice(-1*t.length),r.restTypes.length>0){for(let e=r.headTypes.length;e<a.length;e+=1){const r=l(t[e]),n=`${r}1,${r}2,... `;a[e]=n+a[e]}1===r.restTypes.length&&a.push(a[r.headTypes.length])}return a}(e.ParamsHelp,f,p,r),y=function(e,t){return e.filter((e=>"..."!==e)).slice(0,t.length).map((e=>function(e){return e.startsWith("[")&&!e.endsWith("]")?e+"]":!e.startsWith("[")&&e.endsWith("]")?"["+e:e}(e)))}(S,F);return{signatureParams:c(S,o(a,f.length,p)),descriptions:F,descriptionParams:c(y,i(a,y.length,p)),exampleParams:null!==v?c(v,i(a,v.length,p,!0)):null,exampleDescription:""}}(e,t,r,S,g,m,p,f))),activeSignature:0,listSeparator:m,isUDF:e.IsDynamicUdf,helpID:e.HelpId}},t.getActiveParamIndex=a,t.getParamIndexToHighlight=i,t.getParamNumberSuffix=s,t.getBaseParamName=l},38736:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArgumentAssistanceVisitor=void 0;const n=r(60756),a=r(12973),i=r(50013);class o extends i.IdentityVisitor{appNode(e,t,r,n){return(e.kind===a.NodeKind.WSF||this.newNamedObjectsEnabled&&e.kind===a.NodeKind.Name)&&this.updateAssistedFunction(e,t),super.appNode(e,t,r,n)}letNode(e,t,r,n,a,i){const o=super.letNode(e,t,r,n,a,i);return this.updateAssistedFunction(e,o.args),o}lambdaNode(e,t,r,n,a,i){const o=super.lambdaNode(e,t,r,n,a,i);return this.updateAssistedFunction(e,o.args),o}updateAssistedFunction(e,t){const r=this.parsedFormulaTree.spans[t[0].label],n=this.parsedFormulaTree.spans[t[t.length-1].label];let a=r.start,i=n.end;this.fixHandlingWhiteSpace&&(a-=r.pre.length,i+=n.post.length),this.caretPosition<=i&&this.caretPosition>=a&&(void 0===this.assistedFunctionHead||a>this.assistedFunctionScopeStart)&&(this.assistedFunctionHead=e,this.assistedFunctionArgs=t,this.assistedFunctionScopeStart=a)}constructor(e,t,r){super(),this.parsedFormulaTree=e,this.caretPosition=t,this.newNamedObjectsEnabled=r,this.assistedFunctionScopeStart=0,this.fixHandlingWhiteSpace=!1,this.fixHandlingWhiteSpace=(0,n.isTypedChangeGateEnabled)("OfficeVSO:7920319_fixArgumentAssistanceHandlingWhitespaces")}}t.ArgumentAssistanceVisitor=o},2488:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionExamples=void 0;const n=r(27437),a=r(4595);t.functionExamples=new a.ResettableLazy((()=>({[n.WorksheetFuncId.ABS]:"=ABS(2)",[n.WorksheetFuncId.CUBEMEMBERPROPERTY]:`=CUBEMEMBERPROPERTY("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales)}","[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Time)}].[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Fiscal)}].[2014]",$A$3)`,[n.WorksheetFuncId.CUBERANKEDMEMBER]:`=CUBERANKEDMEMBER("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales)}",$D$4,1,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TopMonth)}")`,[n.WorksheetFuncId.BINOM_DIST_RANGE]:"=BINOM.DIST.RANGE(60,0.75,48)",[n.WorksheetFuncId.NETWORKDAYS_INTL]:"=NETWORKDAYS.INTL(DATE(2006,1,1),DATE(2006,1,31))",[n.WorksheetFuncId.AVERAGE_WEIGHTED]:"=AVERAGE.WEIGHTED(A1:A10, B1:B10, 5, 0.5)",[n.WorksheetFuncId.GAMMALN_PRECISE]:"=GAMMALN.PRECISE(4)",[n.WorksheetFuncId.CONFIDENCE_NORM]:"=CONFIDENCE.NORM(0.05,2.5,50)",[n.WorksheetFuncId.CEILING_PRECISE]:"=CEILING.PRECISE(4.3)",[n.WorksheetFuncId.FORECAST_LINEAR]:"=FORECAST.LINEAR(30,A2:A6,B2:B6)",[n.WorksheetFuncId.PERCENTRANK_EXC]:"=PERCENTRANK.EXC(A2:A11,2)",[n.WorksheetFuncId.PERCENTRANK_INC]:"=PERCENTRANK.INC(A2:A11,2)",[n.WorksheetFuncId.PERCENTILE_EXC]:"=PERCENTILE.EXC(B2:B10,0.25)",[n.WorksheetFuncId.PERCENTILE_INC]:"=PERCENTILE.INC(A2:A5,0.3)",[n.WorksheetFuncId.CUBEKPIMEMBER]:`=CUBEKPIMEMBER("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales)}","${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MySalesKPI)}",1)`,[n.WorksheetFuncId.CHISQ_DIST_RT]:"=CHISQ.DIST.RT(18.307,10)",[n.WorksheetFuncId.FLOOR_PRECISE]:"=FLOOR.PRECISE(-3.2,-1)",[n.WorksheetFuncId.NEGBINOM_DIST]:"=NEGBINOM.DIST(10,5,0.25,TRUE)",[n.WorksheetFuncId.GETPIVOTDATA]:`=GETPIVOTDATA("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales)}", $A$3, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Region)}", "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.South)}")`,[n.WorksheetFuncId.CUBESETCOUNT]:"=CUBESETCOUNT(A3)",[n.WorksheetFuncId.ERFC_PRECISE]:"=ERFC.PRECISE(1)",[n.WorksheetFuncId.CHISQ_INV_RT]:"=CHISQ.INV.RT(0.3, 2)",[n.WorksheetFuncId.CONFIDENCE_T]:"=CONFIDENCE.T(0.05,1,50)",[n.WorksheetFuncId.CEILING_MATH]:"=CEILING.MATH(24.3,5)",[n.WorksheetFuncId.HYPGEOM_DIST]:"=HYPGEOM.DIST(1,4,8,20,TRUE)",[n.WorksheetFuncId.LOGNORM_DIST]:"=LOGNORM.DIST(4,3.5,1.2,TRUE)",[n.WorksheetFuncId.NEGBINOMDIST]:"=NEGBINOMDIST(10,5,0.25)",[n.WorksheetFuncId.PERMUTATIONA]:"=PERMUTATIONA(3,2)",[n.WorksheetFuncId.POISSON_DIST]:"=POISSON.DIST(1, 2, TRUE)",[n.WorksheetFuncId.WEIBULL_DIST]:"=WEIBULL.DIST(105,20,100,TRUE)",[n.WorksheetFuncId.COVARIANCE_P]:"=COVARIANCE.P(A2:A6, B2:B6)",[n.WorksheetFuncId.COVARIANCE_S]:"=COVARIANCE.S(A3:A5,B3:B5)",[n.WorksheetFuncId.QUARTILE_EXC]:"=QUARTILE.EXC(A2:A12,1)",[n.WorksheetFuncId.QUARTILE_INC]:"=QUARTILE.INC(A2:A9,1)",[n.WorksheetFuncId.ECMA_CEILING]:"=ECMA.CEILING(1.5, 0.1)",[n.WorksheetFuncId.WORKDAY_INTL]:"=WORKDAY.INTL(DATE(2012,1,1),30,0)",[n.WorksheetFuncId.STOCKHISTORY]:"=STOCKHISTORY(MSFT,1-1-2020)",[n.WorksheetFuncId.ERF_PRECISE]:"=ERF.PRECISE(0.745)",[n.WorksheetFuncId.NUMBERVALUE]:"=NUMBERVALUE(0.035)",[n.WorksheetFuncId.HYPGEOMDIST]:"=HYPGEOMDIST(1,4,8,20)",[n.WorksheetFuncId.LOGNORMDIST]:"=LOGNORMDIST(4,3.5,1.2)",[n.WorksheetFuncId.LOGNORM_INV]:"=LOGNORM.INV(0.039084, 3.5, 1.2)",[n.WorksheetFuncId.NORM_S_DIST]:"=NORM.S.DIST(1.33, TRUE)",[n.WorksheetFuncId.STANDARDIZE]:"=STANDARDIZE(42,40,1.5)",[n.WorksheetFuncId.FORMULATEXT]:"=FORMULATEXT(A2)",[n.WorksheetFuncId.PERCENTRANK]:"=PERCENTRANK(A2:A11,2)",[n.WorksheetFuncId.CONCATENATE]:`=CONCATENATE("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Andreas)}", " ", "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Hauser)}")`,[n.WorksheetFuncId.ISO_CEILING]:"=ISO.CEILING(4.3)",[n.WorksheetFuncId.VALUETOTEXT]:`=VALUETOTEXT("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SomeText)}")`,[n.WorksheetFuncId.ARRAYTOTEXT]:"=ARRAYTOTEXT(B1:B3)",[n.WorksheetFuncId.AVERAGEIFS]:'=AVERAGEIFS(B2:B5, B2:B5, ">70", B2:B5, "<90")',[n.WorksheetFuncId.COUNTBLANK]:"=COUNTBLANK(A2:B5)",[n.WorksheetFuncId.ERROR_TYPE]:"=ERROR.TYPE(#NULL!)",[n.WorksheetFuncId.CUBEMEMBER]:`=CUBEMEMBER("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales)}",(B4, C6, D5),"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SalesFor2004)}")`,[n.WorksheetFuncId.ISOWEEKNUM]:"=ISOWEEKNUM(40977)",[n.WorksheetFuncId.SUBSTITUTE]:`=SUBSTITUTE("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SalesData)}", "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales)}", "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Cost)}")`,[n.WorksheetFuncId.SUMPRODUCT]:"=SUMPRODUCT(C2:C5,D2:D5)",[n.WorksheetFuncId.WEBSERVICE]:`=WEBSERVICE(${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WebServiceLink)})`,[n.WorksheetFuncId.BINOM_DIST]:"=BINOM.DIST(6,10,0.5,FALSE)",[n.WorksheetFuncId.CHISQ_DIST]:"=CHISQ.DIST(0.5,1,TRUE)",[n.WorksheetFuncId.CONFIDENCE]:"=CONFIDENCE(0.05,2.5,50)",[n.WorksheetFuncId.EXPON_DIST]:"=EXPON.DIST(0.2,10,TRUE)",[n.WorksheetFuncId.FLOOR_MATH]:"=FLOOR.MATH(24.3,5)",[n.WorksheetFuncId.GAMMA_DIST]:"=GAMMA.DIST(4.79, 1.234, 7, TRUE)",[n.WorksheetFuncId.NORM_S_INV]:"=NORM.S.INV(0.908789)",[n.WorksheetFuncId.CHISQ_TEST]:"=CHISQ.TEST(A2:B4,A6:B8)",[n.WorksheetFuncId.PERCENTILE]:"=PERCENTILE(E2:E5,0.3)",[n.WorksheetFuncId.FIELDVALUE]:`=FIELDVALUE(A2, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Price)}")`,[n.WorksheetFuncId.AVERAGEIF]:'=AVERAGEIF(B2:B5,"<23000")',[n.WorksheetFuncId.BITLSHIFT]:"=BITLSHIFT(4,2)",[n.WorksheetFuncId.BITRSHIFT]:"=BITRSHIFT(13,2)",[n.WorksheetFuncId.DATEVALUE]:'=DATEVALUE("1/1/2008")',[n.WorksheetFuncId.FILTERXML]:'=FILTERXML(B3,"//rc/@title")',[n.WorksheetFuncId.CUBEVALUE]:`=CUBEVALUE(Sales,"[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Measures)}].[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Profit)}]","[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Time)}].[2004]","[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AllProduct)}].[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Beverages)}]")`,[n.WorksheetFuncId.ENCODEURL]:`=ENCODEURL("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EncodeURLExmapleLink)}")`,[n.WorksheetFuncId.HYPERLINK]:`=HYPERLINK("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.HyperlinkExampleLink)}", "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ClickForReport)}")`,[n.WorksheetFuncId.ISLOGICAL]:"=ISLOGICAL(TRUE)",[n.WorksheetFuncId.ISNONTEXT]:"=ISNONTEXT(A2)",[n.WorksheetFuncId.ISFORMULA]:"=ISFORMULA(A2)",[n.WorksheetFuncId.PDURATION]:"=PDURATION(2.5%,2000,2200)",[n.WorksheetFuncId.TIMEVALUE]:"=TIMEVALUE(0.1)",[n.WorksheetFuncId.TRANSPOSE]:"=TRANSPOSE(A2:F9)",[n.WorksheetFuncId.FREQUENCY]:"=FREQUENCY(A2:A20, B2:B5)",[n.WorksheetFuncId.BETA_DIST]:"=BETA.DIST(2,8,10,TRUE,1,3)",[n.WorksheetFuncId.BINOMDIST]:"=BINOMDIST(6,10,0.5,FALSE)",[n.WorksheetFuncId.BINOM_INV]:"=BINOM.INV(6,0.5,0.75)",[n.WorksheetFuncId.CHISQ_INV]:"=CHISQ.INV(0.3, 2)",[n.WorksheetFuncId.CRITBINOM]:"=CRITBINOM(6,0.5,0.75)",[n.WorksheetFuncId.EXPONDIST]:"=EXPONDIST(0.2,10,TRUE)",[n.WorksheetFuncId.F_DIST_RT]:"=F.DIST.RT(15.2069,6,4)",[n.WorksheetFuncId.FISHERINV]:"=FISHERINV(0.972955)",[n.WorksheetFuncId.GAMMADIST]:"=GAMMADIST(10.00001131,9,2,FALSE)",[n.WorksheetFuncId.GAMMA_INV]:"=GAMMA.INV(0.068094,9,2)",[n.WorksheetFuncId.NORM_DIST]:"=NORM.DIST(1, 0, 1, TRUE)",[n.WorksheetFuncId.T_DIST_2T]:"=T.DIST.2T(1.959999998,60)",[n.WorksheetFuncId.T_DIST_RT]:"=T.DIST.RT(1.959999998,60)",[n.WorksheetFuncId.INTERCEPT]:"=INTERCEPT(A2:A6, B2:B6)",[n.WorksheetFuncId.MODE_MULT]:"=MODE.MULT(A2:A13)",[n.WorksheetFuncId.MODE_SNGL]:"=MODE.SNGL(A2:A7)",[n.WorksheetFuncId.AGGREGATE]:"=AGGREGATE(12, 6, A1:A11, B1:B11)",[n.WorksheetFuncId.RANDARRAY]:"=RANDARRAY(5,3,1,100)",[n.WorksheetFuncId.COUNTIFS]:'=COUNTIFS(A2:A7,"<6",A2:A7,">1")',[n.WorksheetFuncId.DAVERAGE]:`=DAVERAGE(A4:E10, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield)}", A1:B2)`,[n.WorksheetFuncId.BAHTTEXT]:"=BAHTTEXT(1234)",[n.WorksheetFuncId.DPRODUCT]:`=DPRODUCT(A5:E11, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield)}", A1:F3)`,[n.WorksheetFuncId.INDIRECT]:"=INDIRECT(B&A)",[n.WorksheetFuncId.ISNUMBER]:"=ISNUMBER(A2)",[n.WorksheetFuncId.MINVERSE]:"=MINVERSE(A1:D4)",[n.WorksheetFuncId.RANK_AVG]:"=RANK.AVG(94,B2:B8)",[n.WorksheetFuncId.SUBTOTAL]:"=SUBTOTAL(9,A2:A5)",[n.WorksheetFuncId.BETADIST]:"=BETADIST(2,8,10,1,3)",[n.WorksheetFuncId.BETA_INV]:"=BETA.INV(0.685470581,8,10,1,3)",[n.WorksheetFuncId.F_INV_RT]:"=F.INV.RT(0.01,6,4)",[n.WorksheetFuncId.GAMMAINV]:"=GAMMAINV(0.65, 4, 2)",[n.WorksheetFuncId.NORMDIST]:"=NORMDIST(42,40,1.5,TRUE)",[n.WorksheetFuncId.NORM_INV]:"=NORM.INV(0.908789,40,1.5)",[n.WorksheetFuncId.NORMSINV]:"=NORMSINV(0.9088)",[n.WorksheetFuncId.SUMX2MY2]:"=SUMX2MY2(A3:A9,B3:B9)",[n.WorksheetFuncId.SUMX2PY2]:"=SUMX2PY2(A3:A9,B3:B9)",[n.WorksheetFuncId.FORECAST]:"=FORECAST(30,A2:A6,B2:B6)",[n.WorksheetFuncId.QUARTILE]:"=QUARTILE(A2:A9,1)",[n.WorksheetFuncId.TRIMMEAN]:"=TRIMMEAN(A2:A12,0.2)",[n.WorksheetFuncId.T_INV_2T]:"=T.INV.2T(0.546449,60)",[n.WorksheetFuncId.AVERAGEA]:"=AVERAGEA(A2:A6)",[n.WorksheetFuncId.TEXTJOIN]:"=TEXTJOIN(, , TRUE, A2:A8)",[n.WorksheetFuncId.SEQUENCE]:"=SEQUENCE(4,5)",[n.WorksheetFuncId.ADDRESS]:`=ADDRESS(2,3,1,FALSE,"[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Book1)}]${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sheet1)}")`,[n.WorksheetFuncId.AVERAGE]:"=AVERAGE(A2:A6)",[n.WorksheetFuncId.COLUMNS]:"=COLUMNS(C1:E4)",[n.WorksheetFuncId.COUNTIF]:'=COUNTIF(B2:B5,">55")',[n.WorksheetFuncId.DAYS360]:'=DAYS360("30-Jan-2011","1-Feb-2011")',[n.WorksheetFuncId.DCOUNTA]:`=DCOUNTA(A4:E10, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Profit)}", A1:F2)`,[n.WorksheetFuncId.DECIMAL]:"=DECIMAL(FF,16)",[n.WorksheetFuncId.DEGREES]:"=DEGREES(PI())",[n.WorksheetFuncId.DSTDEVP]:`=DSTDEVP(A5:E11, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield)}", A1:A3)`,[n.WorksheetFuncId.CUBESET]:`=CUBESET("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales)}","[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Product)}].[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AllProducts)}].${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Children)}","${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Products)}",1,"[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Measures)}].[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SalesAmount)}]")`,[n.WorksheetFuncId.HLOOKUP]:`=HLOOKUP("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Axles)}", A1:C4, 2, TRUE)`,[n.WorksheetFuncId.IFERROR]:`=IFERROR(55/0, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ErrorInCalculation)}")`,[n.WorksheetFuncId.ISBLANK]:"=ISBLANK(A2)",[n.WorksheetFuncId.ISERROR]:"=ISERROR(#REF!)",[n.WorksheetFuncId.XLOOKUP]:`=XLOOKUP("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tom)}",A2:A9,C2:C9,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NotFound)}",0,1)`,[n.WorksheetFuncId.MDETERM]:"=MDETERM(A2:D5)",[n.WorksheetFuncId.PRODUCT]:"=PRODUCT(A2:A4)",[n.WorksheetFuncId.RADIANS]:"=RADIANS(270)",[n.WorksheetFuncId.RANK_EQ]:"=RANK.EQ(7,A2:A6,1)",[n.WorksheetFuncId.REPLACE]:'=REPLACE(2009,3,2,"10")',[n.WorksheetFuncId.STDEV_S]:"=STDEV.S(A2:A11)",[n.WorksheetFuncId.STDEV_P]:"=STDEV.P(A3:A12)",[n.WorksheetFuncId.UNICODE]:"=UNICODE(B)",[n.WorksheetFuncId.UNICHAR]:"=UNICHAR(66)",[n.WorksheetFuncId.VLOOKUP]:"=VLOOKUP(103, A2:B26, 2, FALSE)",[n.WorksheetFuncId.WEEKDAY]:"=WEEKDAY(39492)",[n.WorksheetFuncId.GAMMALN]:"=GAMMALN(4)",[n.WorksheetFuncId.BETAINV]:"=BETAINV(0.685470581,8,10,1,3)",[n.WorksheetFuncId.CHIDIST]:"=CHIDIST(18.307,10)",[n.WorksheetFuncId.COMBINA]:"=COMBINA(4,3)",[n.WorksheetFuncId.CEILING]:"=CEILING(2.5, 1)",[n.WorksheetFuncId.NORMINV]:"=NORMINV(0.908789,40,1.5)",[n.WorksheetFuncId.POISSON]:"=POISSON(1, 2, TRUE)",[n.WorksheetFuncId.WEIBULL]:"=WEIBULL(105,20,100,TRUE)",[n.WorksheetFuncId.SUMXMY2]:"=SUMXMY2(A3:A9,B3:B9)",[n.WorksheetFuncId.CHITEST]:"=CHITEST(A2:B4,A6:B8)",[n.WorksheetFuncId.PEARSON]:"=PEARSON(A3:A7,B3:B7)",[n.WorksheetFuncId.GEOMEAN]:"=GEOMEAN(A2:A8)",[n.WorksheetFuncId.HARMEAN]:"=HARMEAN(A2:A8)",[n.WorksheetFuncId.STDEVPA]:"=STDEVPA(A3:A12)",[n.WorksheetFuncId.DATEDIF]:'=DATEDIF("1/1/2001","1/1/2003","Y")',[n.WorksheetFuncId.ARABIC]:"=ARABIC(LVII)",[n.WorksheetFuncId.CHOOSE]:`=CHOOSE(3,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Wide)}",115,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.World)}",8)`,[n.WorksheetFuncId.COLUMN]:"=COLUMN(C9)",[n.WorksheetFuncId.COUNTA]:"=COUNTA(B2:B6)",[n.WorksheetFuncId.DCOUNT]:`=DCOUNT(A5:E11, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Age)}", A1:F2)`,[n.WorksheetFuncId.DOLLAR]:"=DOLLAR(1.2351, 4)",[n.WorksheetFuncId.DSTDEV]:`=DSTDEV(A5:E11, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield)}", A1:A3)`,[n.WorksheetFuncId.GROWTH]:"=GROWTH(#VALUE!)",[n.WorksheetFuncId.IMCOSH]:'=IMCOSH("4+3i")',[n.WorksheetFuncId.IMCSCH]:'=IMCSCH("4+3i")',[n.WorksheetFuncId.IMSECH]:'=IMSECH("4+3i")',[n.WorksheetFuncId.IMSINH]:'=IMSINH("4+3i")',[n.WorksheetFuncId.ISTEXT]:`=ISTEXT("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Region1)}")`,[n.WorksheetFuncId.LINEST]:"=LINEST(B2:B10, A2:A10, FALSE, TRUE)",[n.WorksheetFuncId.LOGEST]:"=LOGEST(B2:B10, A2:A10, TRUE, TRUE)",[n.WorksheetFuncId.LOOKUP]:"=LOOKUP(4.19, A2:A6, B2:B6)",[n.WorksheetFuncId.XMATCH]:"=XMATCH(F2,C3:C9,1)",[n.WorksheetFuncId.MEDIAN]:"=MEDIAN(A2:A6)",[n.WorksheetFuncId.MINUTE]:"=MINUTE(0.53125)",[n.WorksheetFuncId.OFFSET]:"=OFFSET(D3,3,-2,1,1)",[n.WorksheetFuncId.PROPER]:`=PROPER("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThisIsATITLE)}")`,[n.WorksheetFuncId.SEARCH]:`=SEARCH("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.E)}","${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Statements)}",6)`,[n.WorksheetFuncId.SECOND]:"=SECOND(0.700208333333333)",[n.WorksheetFuncId.SHEETS]:`=SHEETS(${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.My3DRef)})`,[n.WorksheetFuncId.STDEVP]:"=STDEVP(A3:A12)",[n.WorksheetFuncId.SUMIFS]:`=SUMIFS(A2:A9, B2:B9, "<>${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Bananas)}", C2:C9, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tom)}")`,[n.WorksheetFuncId.AVEDEV]:"=AVEDEV(A2:A8)",[n.WorksheetFuncId.CHIINV]:"=CHIINV(0.3, 2)",[n.WorksheetFuncId.COMBIN]:"=COMBIN(8,2)",[n.WorksheetFuncId.F_DIST]:"=F.DIST(15.2069,6,4,TRUE)",[n.WorksheetFuncId.FISHER]:"=FISHER(0.75)",[n.WorksheetFuncId.LOGINV]:"=LOGINV(0.039084, 3.5, 1.2)",[n.WorksheetFuncId.PERMUT]:"=PERMUT(100,3)",[n.WorksheetFuncId.T_DIST]:"=T.DIST(60,1,TRUE)",[n.WorksheetFuncId.CORREL]:"=CORREL(A2:A6, B2:B6)",[n.WorksheetFuncId.F_TEST]:"=F.TEST(A2:A6,B2:B6)",[n.WorksheetFuncId.T_TEST]:"=T.TEST(A2:A10,B2:B10,2,1)",[n.WorksheetFuncId.SKEW_P]:"=SKEW.P(A2:A11)",[n.WorksheetFuncId.Z_TEST]:"=Z.TEST(A2:A11,4)",[n.WorksheetFuncId.STDEVA]:"=STDEVA(A3:A12)",[n.WorksheetFuncId.MAXIFS]:`=MAXIFS(A2:A7,B2:B7,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsB)}",D2:D7,">100")`,[n.WorksheetFuncId.MINIFS]:`=MINIFS(A2:A7,B2:B7,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsB)}",D2:D7,">100")`,[n.WorksheetFuncId.CONCAT]:`=CONCAT("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Andreas)}"," ", "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Hauser)}")`,[n.WorksheetFuncId.SWITCH]:`=SWITCH(WEEKDAY("10/10/2016"),1,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sunday)}",2,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Monday)}",3,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tuesday)}","${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NoMatch)}")`,[n.WorksheetFuncId.FILTER]:`=FILTER(A5:D20,(C5:C20="${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Apple)}")*(A5:A20="${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.East)}"),"")`,[n.WorksheetFuncId.UNIQUE]:"=UNIQUE(A2:A12)",[n.WorksheetFuncId.SORTBY]:"=SORTBY(D2:D9,E2:E9,1)",[n.WorksheetFuncId.BITAND]:"=BITAND(1,5)",[n.WorksheetFuncId.BITXOR]:"=BITXOR(5,3)",[n.WorksheetFuncId.ACOSH]:"=ACOSH(10)",[n.WorksheetFuncId.ACOTH]:"=ACOTH(6)",[n.WorksheetFuncId.ATANH]:"=ATANH(-0.1)",[n.WorksheetFuncId.ATAN2]:"=ATAN2(4,0)",[n.WorksheetFuncId.CLEAN]:"=CLEAN(A2)",[n.WorksheetFuncId.COUNT]:"=COUNT(A2:A7)",[n.WorksheetFuncId.DVARP]:`=DVARP(A4:E10, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield)}", A1:A3)`,[n.WorksheetFuncId.EXACT]:`=EXACT("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Hello)}", "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Goodbye)}")`,[n.WorksheetFuncId.FALSE]:"=FALSE()",[n.WorksheetFuncId.FIXED]:"=FIXED(-1234.567, -1, TRUE)",[n.WorksheetFuncId.IMCOT]:'=IMCOT("4+3i")',[n.WorksheetFuncId.IMCSC]:'=IMCSC("4+3i")',[n.WorksheetFuncId.IMSEC]:'=IMSEC("4+3i")',[n.WorksheetFuncId.IMTAN]:'=IMTAN("4+3i")',[n.WorksheetFuncId.INDEX]:"=INDEX(A2:B3,2,1)",[n.WorksheetFuncId.ISERR]:"=ISERR(#N/A)",[n.WorksheetFuncId.ISREF]:"=ISREF(A2)",[n.WorksheetFuncId.LOWER]:`=LOWER("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EECummings)}")`,[n.WorksheetFuncId.MATCH]:"=MATCH(39,B2:B5,1)",[n.WorksheetFuncId.MMULT]:"=MMULT(A1:B3, C1:F2)",[n.WorksheetFuncId.MONTH]:"=MONTH(40648)",[n.WorksheetFuncId.RIGHT]:`=RIGHT("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SalePrice)}",5)`,[n.WorksheetFuncId.ROUND]:"=ROUND(2.149, 1)",[n.WorksheetFuncId.SHEET]:`=SHEET(${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Table1)})`,[n.WorksheetFuncId.STDEV]:"=STDEV(A3:A12)",[n.WorksheetFuncId.SUMIF]:'=SUMIF(A2:A5,">160000")',[n.WorksheetFuncId.TODAY]:"=TODAY()",[n.WorksheetFuncId.TREND]:"=TREND(B2:B10, A2:A10, A11:A13, TRUE)",[n.WorksheetFuncId.TRUNC]:"=TRUNC(8.9)",[n.WorksheetFuncId.UPPER]:`=UPPER("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.KelliXu)}")`,[n.WorksheetFuncId.VALUE]:"=VALUE(1000)",[n.WorksheetFuncId.VAR_S]:"=VAR.S(A2:A11)",[n.WorksheetFuncId.VAR_P]:"=VAR.P(A2:A11)",[n.WorksheetFuncId.GAMMA]:"=GAMMA(-3.75)",[n.WorksheetFuncId.GAUSS]:"=GAUSS(2)",[n.WorksheetFuncId.FDIST]:"=FDIST(15.20686486,6,4)",[n.WorksheetFuncId.F_INV]:"=F.INV(0.01,6,4)",[n.WorksheetFuncId.FLOOR]:"=FLOOR(23.25, 0.1)",[n.WorksheetFuncId.TDIST]:"=TDIST(60, 1, 1)",[n.WorksheetFuncId.COVAR]:"=COVAR(A2:A6, B2:B6)",[n.WorksheetFuncId.FTEST]:"=FTEST(A2:A6,B2:B6)",[n.WorksheetFuncId.STEYX]:"=STEYX(A3:A9,B3:B9)",[n.WorksheetFuncId.SLOPE]:"=SLOPE(A3:A9,B3:B9)",[n.WorksheetFuncId.TTEST]:"=TTEST(A2:A10,B2:B10,2,1)",[n.WorksheetFuncId.DEVSQ]:"=DEVSQ(A2:A8)",[n.WorksheetFuncId.SUMSQ]:"=SUMSQ(3, 4)",[n.WorksheetFuncId.ZTEST]:"=ZTEST(A2:A11,6)",[n.WorksheetFuncId.LARGE]:"=LARGE(A2:B6,7)",[n.WorksheetFuncId.SMALL]:"=SMALL(A2:A10,4)",[n.WorksheetFuncId.MUNIT]:"=MUNIT(2)",[n.WorksheetFuncId.T_INV]:"=T.INV(0.75,2)",[n.WorksheetFuncId.ROMAN]:"=ROMAN(499,0)",[n.WorksheetFuncId.POWER]:"=POWER(5,2)",[n.WorksheetFuncId.ISPMT]:"=ISPMT(10%, 2, 5, 1000)",[n.WorksheetFuncId.VARPA]:"=VARPA(1, 2)",[n.WorksheetFuncId.AREAS]:"=AREAS(B2:D4)",[n.WorksheetFuncId.ASINH]:"=ASINH(10)",[n.WorksheetFuncId.BITOR]:"=BITOR(23,10)",[n.WorksheetFuncId.ACOS]:"=ACOS(-0.5)",[n.WorksheetFuncId.ACOT]:"=ACOT(2)",[n.WorksheetFuncId.ATAN]:"=ATAN(1)",[n.WorksheetFuncId.CELL]:`=CELL("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Address)}", C2)`,[n.WorksheetFuncId.CHAR]:"=CHAR(65)",[n.WorksheetFuncId.COSH]:"=COSH(EXP(1))",[n.WorksheetFuncId.COTH]:"=COTH(2)",[n.WorksheetFuncId.CSCH]:"=CSCH(2)",[n.WorksheetFuncId.DATE]:"=DATE(2008,1,2)",[n.WorksheetFuncId.DAYS]:'=DAYS("3/15/2011","2/1/2011")',[n.WorksheetFuncId.DGET]:`=DGET(A5:E11, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield)}", A1:A3)`,[n.WorksheetFuncId.DMAX]:`=DMAX(A5:E11, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Profit)}", A1:F3)`,[n.WorksheetFuncId.DMIN]:`=DMIN(A5:E11, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Profit)}", A1:F3)`,[n.WorksheetFuncId.DSUM]:`=DSUM(A4:E10,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Profit)}", A1:F3)`,[n.WorksheetFuncId.DVAR]:`=DVAR(A4:E10, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield)}", A1:A3)`,[n.WorksheetFuncId.FACT]:"=FACT(5)",[n.WorksheetFuncId.FIND]:`=FIND("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.M)}",A2)`,[n.WorksheetFuncId.HOUR]:"=HOUR(0.75)",[n.WorksheetFuncId.IFNA]:`=IFNA("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NoNAError)}", "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Error)}")`,[n.WorksheetFuncId.IPMT]:"=IPMT(10%, 3, 3, 8000)",[n.WorksheetFuncId.ISNA]:"=ISNA(#REF!)",[n.WorksheetFuncId.LEFT]:`=LEFT("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SalePrice)}",4)`,[n.WorksheetFuncId.MIRR]:"=MIRR(A2:A7, 0.1, 0.12)",[n.WorksheetFuncId.NPER]:"=NPER(0.12/12, -100, -1000, 10000, 1)",[n.WorksheetFuncId.PPMT]:"=PPMT(0.08, 10, 10, 200000)",[n.WorksheetFuncId.RAND]:"=RAND()",[n.WorksheetFuncId.RANK]:"=RANK(3.5,A2:A6,1)",[n.WorksheetFuncId.RATE]:"=RATE(4*12, -200, 8000)",[n.WorksheetFuncId.REPT]:'=REPT("*-", 3)',[n.WorksheetFuncId.ROWS]:"=ROWS(C1:E4)",[n.WorksheetFuncId.SECH]:"=SECH(0)",[n.WorksheetFuncId.SIGN]:"=SIGN(10)",[n.WorksheetFuncId.SINH]:"=SINH(2)",[n.WorksheetFuncId.SQRT]:"=SQRT(16)",[n.WorksheetFuncId.TANH]:"=TANH(0.5)",[n.WorksheetFuncId.TEXT]:'=TEXT(1234.567,"$#,##0.00")',[n.WorksheetFuncId.TIME]:"=TIME(16,48,10)",[n.WorksheetFuncId.TRIM]:`=TRIM("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FirstQuarterEarnings)}")`,[n.WorksheetFuncId.TRUE]:"=TRUE()",[n.WorksheetFuncId.TYPE]:`=TYPE("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Smith)}")`,[n.WorksheetFuncId.VARP]:"=VARP(A2:A11)",[n.WorksheetFuncId.YEAR]:"=YEAR(39634)",[n.WorksheetFuncId.INFO]:`=INFO("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numfile)}")`,[n.WorksheetFuncId.EVEN]:"=EVEN(1.5)",[n.WorksheetFuncId.FINV]:"=FINV(0.42, 2, 3)",[n.WorksheetFuncId.PROB]:"=PROB(A3:A6,B3:B6,2)",[n.WorksheetFuncId.KURT]:"=KURT(A2:A11)",[n.WorksheetFuncId.SKEW]:"=SKEW(A2:A11)",[n.WorksheetFuncId.MODE]:"=MODE(A2:A7)",[n.WorksheetFuncId.MINA]:"=MINA(A2:A6)",[n.WorksheetFuncId.MAXA]:"=MAXA(A2:A6)",[n.WorksheetFuncId.VARA]:"=VARA(1, 2)",[n.WorksheetFuncId.SORT]:"=SORT(A2:A17)",[n.WorksheetFuncId.ASIN]:"=ASIN(-0.5)",[n.WorksheetFuncId.BASE]:"=BASE(7,2)",[n.WorksheetFuncId.CODE]:`=CODE("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CodeA)}")`,[n.WorksheetFuncId.AND]:"=AND(A2>1,A2<100)",[n.WorksheetFuncId.COS]:"=COS(1.047)",[n.WorksheetFuncId.COT]:"=COT(30)",[n.WorksheetFuncId.CSC]:"=CSC(15)",[n.WorksheetFuncId.DAY]:"=DAY(40648)",[n.WorksheetFuncId.DDB]:"=DDB(2400,300,10*365,1)",[n.WorksheetFuncId.RTD]:`=RTD(mycomaddin.progid,,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ServerName)}","${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Price)}")`,[n.WorksheetFuncId.EXP]:"=EXP(1)",[n.WorksheetFuncId.INT]:"=INT(8.9)",[n.WorksheetFuncId.IRR]:"=IRR(A2:A4,-10%)",[n.WorksheetFuncId.LEN]:`=LEN("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Excel)}")`,[n.WorksheetFuncId.LOG]:"=LOG(10)",[n.WorksheetFuncId.MAX]:"=MAX(A2:A6)",[n.WorksheetFuncId.MID]:`=MID("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FluidFlow)}",1,5)`,[n.WorksheetFuncId.MIN]:"=MIN(A2:A6)",[n.WorksheetFuncId.MOD]:"=MOD(3, 2)",[n.WorksheetFuncId.NOT]:"=NOT(A2>100)",[n.WorksheetFuncId.NPV]:"=NPV(0.1, -10000, 3000, 4200, 6800)",[n.WorksheetFuncId.PMT]:"=PMT(0.08/12,10,10000)",[n.WorksheetFuncId.ROW]:"=ROW(C10)",[n.WorksheetFuncId.RRI]:"=RRI(96,10000,11000)",[n.WorksheetFuncId.SEC]:"=SEC(30)",[n.WorksheetFuncId.SIN]:"=SIN(PI())",[n.WorksheetFuncId.SLN]:"=SLN(30000, 7500, 10)",[n.WorksheetFuncId.SUM]:"=SUM(A1:A3)",[n.WorksheetFuncId.SYD]:"=SYD(30000,7500,10,1)",[n.WorksheetFuncId.TAN]:"=TAN(0.785)",[n.WorksheetFuncId.VAR]:"=VAR(A2:A11)",[n.WorksheetFuncId.VDB]:"=VDB(2400, 300, 10*365, 0, 1)",[n.WorksheetFuncId.XOR]:"=XOR(3>0,2<9)",[n.WorksheetFuncId.ODD]:"=ODD(1.5)",[n.WorksheetFuncId.PHI]:"=PHI(0.75)",[n.WorksheetFuncId.RSQ]:"=RSQ(A3:A9, B3:B9)",[n.WorksheetFuncId.IFS]:`=IFS(A2>89,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsA)}",A2>79,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsB)}",A2>69,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsC)}",A2>59,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsD)}",TRUE,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsF)}")`,[n.WorksheetFuncId.DB]:"=DB(1000000,100000,6,1,7)",[n.WorksheetFuncId.FV]:"=FV(0.06/12, 10, -200, -500, 1)",[n.WorksheetFuncId.IF]:`=IF(C2>B2,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.OverBudget)}","${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WithinBudget)}")`,[n.WorksheetFuncId.LN]:"=LN(86)",[n.WorksheetFuncId.NA]:"=NA()",[n.WorksheetFuncId.OR]:"=OR(A2>1,A2<100)",[n.WorksheetFuncId.PV]:"=PV(0.08/12, 12*20, 500, , 0)",[n.WorksheetFuncId.N]:`=N(${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Even)})`,[n.WorksheetFuncId.T]:`=T("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Hello)}")`,[n.WorksheetFuncId.ACCRINT]:"=ACCRINT(39508,39691,39569,0.1,1000,2,0)",[n.WorksheetFuncId.ACCRINTM]:"=ACCRINTM(39539,39614,0.1,1000,3)",[n.WorksheetFuncId.AMORDEGRC]:"=AMORDEGRC(2400,39679,39813,300,1,0.15,1)",[n.WorksheetFuncId.AMORLINC]:"=AMORLINC(2400,39679,39813,300,1,0.15,1)",[n.WorksheetFuncId.BESSELI]:"=BESSELI(1.5,1)",[n.WorksheetFuncId.BESSELJ]:"=BESSELJ(1.9,2)",[n.WorksheetFuncId.BESSELK]:"=BESSELK(1.5,1)",[n.WorksheetFuncId.BESSELY]:"=BESSELY(2.5,1)",[n.WorksheetFuncId.BIN2DEC]:"=BIN2DEC(1100100)",[n.WorksheetFuncId.BIN2HEX]:"=BIN2HEX(11111011, 4)",[n.WorksheetFuncId.BIN2OCT]:"=BIN2OCT(1001, 3)",[n.WorksheetFuncId.COMPLEX]:'=COMPLEX(3,4,"j")',[n.WorksheetFuncId.CONVERT]:'=CONVERT(1,"lbm","kg")',[n.WorksheetFuncId.COUPDAYBS]:'=COUPDAYBS("25-Jan-2011","15-Nov-2011",2,1)',[n.WorksheetFuncId.COUPDAYS]:'=COUPDAYS("25-Jan-2011","15-Nov-2011",2,1)',[n.WorksheetFuncId.COUPDAYSNC]:'=COUPDAYSNC("25-Jan-2011","15-Nov-2011",2,1)',[n.WorksheetFuncId.COUPNCD]:'=COUPNCD("25-Jan-2011","15-Nov-2011",2,1)',[n.WorksheetFuncId.COUPNUM]:'=COUPNUM("25-Jan-2011","15-Nov-2012",2,1)',[n.WorksheetFuncId.COUPPCD]:'=COUPPCD("25-Jan-2011","15-Nov-2011",2,1)',[n.WorksheetFuncId.CUMIPMT]:"=CUMIPMT(A2/12,A3*12,A4,13,24,0)",[n.WorksheetFuncId.CUMPRINC]:"=CUMPRINC(A2/12,A3*12,A4,13,24,0)",[n.WorksheetFuncId.DEC2BIN]:"=DEC2BIN(9, 4)",[n.WorksheetFuncId.DEC2HEX]:"=DEC2HEX(100,4)",[n.WorksheetFuncId.DEC2OCT]:"=DEC2OCT(58,3)",[n.WorksheetFuncId.DELTA]:"=DELTA(5,4)",[n.WorksheetFuncId.DISC]:'=DISC("7/1/2018","1/1/2048",97.975,100,1)',[n.WorksheetFuncId.DOLLARDE]:"=DOLLARDE(1.02,16)",[n.WorksheetFuncId.DOLLARFR]:"=DOLLARFR(1.125,16)",[n.WorksheetFuncId.DURATION]:'=DURATION("7/1/2018","1/1/2048",8%,9%,2,1)',[n.WorksheetFuncId.EDATE]:'=EDATE("15-Jan-2011",1)',[n.WorksheetFuncId.EFFECT]:"=EFFECT(0.0525,4)",[n.WorksheetFuncId.EOMONTH]:'=EOMONTH("1-Jan-2011",1)',[n.WorksheetFuncId.ERF]:"=ERF(0.745)",[n.WorksheetFuncId.ERFC]:"=ERFC(1)",[n.WorksheetFuncId.FACTDOUBLE]:"=FACTDOUBLE(6)",[n.WorksheetFuncId.FORECAST_ETS]:"=FORECAST.ETS(A62,$B$4:$B$60,$A$4:$A$60,1,1)",[n.WorksheetFuncId.FORECAST_ETS_CONFINT]:"=FORECAST.ETS.CONFINT(A62,$B$4:$B$60,$A$4:$A$60,0.95,1,1)",[n.WorksheetFuncId.FORECAST_ETS_SEASONALITY]:"=FORECAST.ETS.SEASONALITY($B$4:$B$60,$A$4:$A$60,1,1)",[n.WorksheetFuncId.FORECAST_ETS_STAT]:"=FORECAST.ETS.STAT($B$4:$B$60,$A$4:$A$60,1,J48,1,1)",[n.WorksheetFuncId.FVSCHEDULE]:"=FVSCHEDULE(1,{0.09,0.11,0.1})",[n.WorksheetFuncId.GCD]:"=GCD(24,36)",[n.WorksheetFuncId.GESTEP]:"=GESTEP(5,4)",[n.WorksheetFuncId.HEX2BIN]:"=HEX2BIN(F,8)",[n.WorksheetFuncId.HEX2DEC]:"=HEX2DEC(FFFFFFFF5B)",[n.WorksheetFuncId.HEX2OCT]:"=HEX2OCT(F, 3)",[n.WorksheetFuncId.IMABS]:'=IMABS("5+12i")',[n.WorksheetFuncId.IMAGE]:'=IMAGE("https://microsoft.com/abc.jpg", "Microsoft", 0)',[n.WorksheetFuncId.IMAGINARY]:'=IMAGINARY("3+4i")',[n.WorksheetFuncId.IMARGUMENT]:'=IMARGUMENT("3+4i")',[n.WorksheetFuncId.IMCONJUGATE]:'=IMCONJUGATE("3+4i")',[n.WorksheetFuncId.IMCOS]:'=IMCOS("1+i")',[n.WorksheetFuncId.IMDIV]:'=IMDIV("-238+240i","10+24i")',[n.WorksheetFuncId.IMEXP]:'=IMEXP("1+i")',[n.WorksheetFuncId.IMLN]:'=IMLN("3+4i")',[n.WorksheetFuncId.IMLOG10]:'=IMLOG10("3+4i")',[n.WorksheetFuncId.IMLOG2]:'=IMLOG2("3+4i")',[n.WorksheetFuncId.IMPOWER]:'=IMPOWER("2+3i", 3)',[n.WorksheetFuncId.IMPRODUCT]:'=IMPRODUCT("3+4i","5-3i")',[n.WorksheetFuncId.IMREAL]:'=IMREAL("6-9i")',[n.WorksheetFuncId.IMSIN]:'=IMSIN("4+3i")',[n.WorksheetFuncId.IMSQRT]:'=IMSQRT("1+i")',[n.WorksheetFuncId.IMSUB]:'=IMSUB("13+4i","5+3i")',[n.WorksheetFuncId.IMSUM]:'=IMSUM("3+4i","5-3i")',[n.WorksheetFuncId.INTRATE]:'=INTRATE("2/15/2008","5/15/2008",1000000,1014420,2)',[n.WorksheetFuncId.ISEVEN]:"=ISEVEN(2.5)",[n.WorksheetFuncId.ISODD]:"=ISODD(2.5)",[n.WorksheetFuncId.LAMBDA]:"=LAMBDA(a, b, SQRT((a^2+b^2)))",[n.WorksheetFuncId.LET]:`=LET(${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Total)}, SUM(A1:A10), ${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Count)}, COUNT(A1:A10), ${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Total)} / ${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Count)})`,[n.WorksheetFuncId.LCM]:"=LCM(5,2)",[n.WorksheetFuncId.LOG10]:"=LOG10(86)",[n.WorksheetFuncId.MDURATION]:'=MDURATION("1/1/2008","1/1/2016",8%,9%,2,1)',[n.WorksheetFuncId.MROUND]:"=MROUND(10,3)",[n.WorksheetFuncId.MULTINOMIAL]:"=MULTINOMIAL(2,3,4)",[n.WorksheetFuncId.NETWORKDAYS]:'=NETWORKDAYS("10/1/2012","3/1/2013")',[n.WorksheetFuncId.NOMINAL]:"=NOMINAL(0.053543, 4)",[n.WorksheetFuncId.NOW]:"=NOW()",[n.WorksheetFuncId.OCT2BIN]:"=OCT2BIN(3,3)",[n.WorksheetFuncId.OCT2DEC]:"=OCT2DEC(54)",[n.WorksheetFuncId.OCT2HEX]:"=OCT2HEX(100,4)",[n.WorksheetFuncId.ODDFPRICE]:'=ODDFPRICE("11/11/2008","3/1/2021","10/15/2008","3/1/2009",7.85%,6.25%,100,2,1)',[n.WorksheetFuncId.ODDFYIELD]:'=ODDFYIELD("11/11/2008","3/1/2021","10/15/2008","3/1/2009",5.75%,84.5,100,2,0)',[n.WorksheetFuncId.ODDLPRICE]:'=ODDLPRICE("2/7/2008","6/15/2008","10/15/2007",3.75%,4.05%,100,2,0)',[n.WorksheetFuncId.ODDLYIELD]:'=ODDLYIELD("4/20/2008","6/15/2008","12/24/2007",3.75%,99.875,100,2,0)',[n.WorksheetFuncId.PI]:"=PI()",[n.WorksheetFuncId.PRICE]:'=PRICE("2/15/2008","11/15/2017",5.75%,6.5%,100,2,0)',[n.WorksheetFuncId.PRICEDISC]:'=PRICEDISC("2/16/2008","3/1/2008",5.25%,100,2)',[n.WorksheetFuncId.PRICEMAT]:'=PRICEMAT("2/15/2008","4/13/2008","11/11/2007",6.1%,6.1%,0)',[n.WorksheetFuncId.QUOTIENT]:"=QUOTIENT(5,2)",[n.WorksheetFuncId.RANDBETWEEN]:"=RANDBETWEEN(1,100)",[n.WorksheetFuncId.RECEIVED]:'=RECEIVED("2/15/2008","5/15/2008",1000000,5.75%,2)',[n.WorksheetFuncId.RECURSE]:"=RECURSE()",[n.WorksheetFuncId.ROUNDDOWN]:"=ROUNDDOWN(3.14159,3)",[n.WorksheetFuncId.ROUNDUP]:"=ROUNDUP(3.14159,3)",[n.WorksheetFuncId.SERIESSUM]:"=SERIESSUM(0.785398163,0,2,A4:A7)",[n.WorksheetFuncId.SQRTPI]:"=SQRTPI(1)",[n.WorksheetFuncId.TBILLEQ]:'=TBILLEQ("3/31/2008","6/1/2008",9.14%)',[n.WorksheetFuncId.TBILLPRICE]:'=TBILLPRICE("3/31/2008","6/1/2008",9%)',[n.WorksheetFuncId.TBILLYIELD]:'=TBILLYIELD("3/31/2008","6/1/2008",98.45%)',[n.WorksheetFuncId.TINV]:"=TINV(0.05464,60)",[n.WorksheetFuncId.WEEKNUM]:'=WEEKNUM("3/9/2012",2)',[n.WorksheetFuncId.WORKDAY]:'=WORKDAY("10/1/2008",151)',[n.WorksheetFuncId.XIRR]:"=XIRR(A3:A7, B3:B7, 0.1)",[n.WorksheetFuncId.XNPV]:"=XNPV(0.09, A2:A6, B2:B6)",[n.WorksheetFuncId.YEARFRAC]:'=YEARFRAC("1/1/2012","7/30/2012")',[n.WorksheetFuncId.YIELD]:'=YIELD("2/15/2008","11/15/2016",5.75%,95.04287,100,2,0)',[n.WorksheetFuncId.YIELDDISC]:'=YIELDDISC("2/16/2008","3/1/2008",99.795,100,2)',[n.WorksheetFuncId.YIELDMAT]:'=YIELDMAT("3/15/2008","11/3/2008","11/8/2007",6.25%,100.0123,0)',[n.WorksheetFuncId.TEXTSPLIT]:'=TEXTSPLIT("1,2,3;4,5,6",",",";")',[n.WorksheetFuncId.TEXTBEFORE]:'=TEXTBEFORE("Red riding hood\'s, red hood", "hood")',[n.WorksheetFuncId.TEXTAFTER]:'=TEXTAFTER("Red riding hood\'s, red hood", "hood")',[n.WorksheetFuncId.VSTACK]:"=VSTACK({1,2},{3,4},5)",[n.WorksheetFuncId.HSTACK]:"=HSTACK({1;2},{3;4},5)",[n.WorksheetFuncId.MAP]:"=MAP(A1:C2, LAMBDA(a, IF(a>4,a*a,a)))",[n.WorksheetFuncId.WRAPROWS]:"=WRAPROWS(A2:G2,3)",[n.WorksheetFuncId.SCAN]:"=SCAN(1, A1:C2, LAMBDA(a,b,a*b))",[n.WorksheetFuncId.MAKEARRAY]:"=MAKEARRAY(3, 3, LAMBDA(row,col, row*col))",[n.WorksheetFuncId.REDUCE]:"=REDUCE(, A1:C2, LAMBDA(a,b,a+b^2))",[n.WorksheetFuncId.NORMSDIST]:"=NORMDIST(A2,A3,A4,TRUE)",[n.WorksheetFuncId.CHOOSEROWS]:"=CHOOSEROWS(A2:B7,1,3,5,1)",[n.WorksheetFuncId.CHOOSECOLS]:"=CHOOSECOLS(A2:E7,1,3,5,1)",[n.WorksheetFuncId.DROP]:"=DROP(A2:C4,2)",[n.WorksheetFuncId.WRAPCOLS]:"=WRAPCOLS(A2:F2,3)",[n.WorksheetFuncId.TOCOL]:"=TOCOL(A2:D4)",[n.WorksheetFuncId.TAKE]:"=TAKE(A2:C4,2)",[n.WorksheetFuncId.TOROW]:"=TOROW(A2:D4)",[n.WorksheetFuncId.BYCOL]:`=BYCOL(A1:C2, LAMBDA(${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Array)}, MAX(${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Array)})))`,[n.WorksheetFuncId.BYROW]:`=BYROW(A1:C2, LAMBDA(${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Array)}, MAX(${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Array)})))`,[n.WorksheetFuncId.EXPAND]:"=EXPAND(A2:B3,3,3)",[n.WorksheetFuncId.DBCS]:'=DBCS("EXCEL")',[n.WorksheetFuncId.ASC]:'=ASC("EXCEL")',[n.WorksheetFuncId.LENB]:'=LENB("EXCEL")',[n.WorksheetFuncId.FURIGANA]:"=PHONETIC(C4)",[n.WorksheetFuncId.ISOMITTED]:`=LAMBDA(x,y, IF(ISOMITTED(y),"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MissingSecondArgument)}",x+y))(1,)`,[n.WorksheetFuncId.MIDB]:"=MIDB(A2,7,20)",[n.WorksheetFuncId.RIGHTB]:"=RIGHTB(A2,7)"})))},90556:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationDefinitionsMap=t.RegisterAnnotation=t.alFeatureNamePrefix=void 0;const n=r(10259),a=r(36159),i=r(77829),o=r(46870);t.alFeatureNamePrefix="x10";const s={[i.ALAnnotationKind.FormulaByExample]:{annotationType:n.FormulaByExampleAnnotation,isModelRequired:!1}};t.RegisterAnnotation={[i.ALAnnotationKind.FormulaByExample]:!0},t.AnnotationDefinitionsMap=(0,o.mapFromArrayOfDependantPairs)((0,a.strEnumArray)(i.ALAnnotationKind).map((e=>[e,{annotationName:s[e].annotationType.getTypeName(),featureName:`${t.alFeatureNamePrefix}_${e}`,isModelRequired:s[e].isModelRequired}])))},91301:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AugLoopService=void 0;const n=r(1765),a=r(36159),i=r(93336),o=r(90556),s=r(77829),u=r(46870),l=r(4595);t.AugLoopService=class{async registerALAnnotation(e){const t=this.registerAnnotationCallbacks[e].getValue();return"Failure"===(await t).kind&&this.registerAnnotationCallbacks[e].reset(),t}async sendSignal(e,t){try{const r=await this.augLoopInterop.sendSignal(e,`${o.alFeatureNamePrefix}_${i.PluginFactoryName[t]}`);return(0,a.isDefined)(r)?(0,n.success)(r):(0,n.failure)(r)}catch(e){return(0,n.failure)(e)}}constructor(e){this.augLoopInterop=e,this.registerAnnotationCallbacks=(0,u.mapFromArrayOfDependantPairs)((0,a.strEnumArray)(s.ALAnnotationKind).map((e=>[e,new l.ResettableLazy((async()=>{try{const t=o.AnnotationDefinitionsMap[e],r=await this.augLoopInterop.registerOnAnnotation(s.ALAnnotationKind[e],t.annotationName,t.featureName,t.isModelRequired);return(0,n.success)(r)}catch(e){return(0,n.failure)(e)}}))])))}}},4317:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getConvertEnum=t.speedUnitTypeEnums=t.informationUnitTypeEnums=t.areaUnitTypeEnums=t.volumeUnitTypeEnums=t.temperatureUnitTypeEnums=t.magnetismUnitTypeEnums=t.powerUnitTypeEnums=t.energyUnitTypeEnums=t.forceUnitTypeEnums=t.pressureUnitTypeEnums=t.timeUnitTypeEnums=t.distanceUnitTypeEnums=t.massUnitTypeEnums=void 0;const n=r(4595);t.massUnitTypeEnums=new n.ResettableLazy((()=>[{value:"g",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Gram)},{value:"sg",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Slug)},{value:"lbm",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PoundM)},{value:"u",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Atomic)},{value:"ozm",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ozm)},{value:"grain",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Grain)},{value:"cwt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CWeight)},{value:"uk_cwt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CWeightUk)},{value:"stone",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Stone)},{value:"ton",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ton)},{value:"uk_ton",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TonUk)}])),t.distanceUnitTypeEnums=new n.ResettableLazy((()=>[{value:"m",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Meter)},{value:"mi",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SMile)},{value:"Nmi",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NMile)},{value:"in",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Inch)},{value:"ft",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ft)},{value:"yd",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yd)},{value:"ang",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Angs)},{value:"Pica",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Pica)},{value:"ell",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ell)},{value:"ly",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LightYr)},{value:"parsec",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Parsec)},{value:"survey_mi",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MileUs)}])),t.timeUnitTypeEnums=new n.ResettableLazy((()=>[{value:"yr",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yr)},{value:"day",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Day)},{value:"hr",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Hour)},{value:"mn",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Minute)},{value:"sec",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sec)}])),t.pressureUnitTypeEnums=new n.ResettableLazy((()=>[{value:"Pa",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Pascal)},{value:"atm",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Atmos)},{value:"mmHg",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Merc)},{value:"psi",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Psi)},{value:"Torr",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Torr)}])),t.forceUnitTypeEnums=new n.ResettableLazy((()=>[{value:"N",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Newton)},{value:"dyn",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Dyne)},{value:"lbf",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PoundF)},{value:"pond",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Pond)}])),t.energyUnitTypeEnums=new n.ResettableLazy((()=>[{value:"J",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Joule)},{value:"e",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Erg)},{value:"cal",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ItCal)},{value:"eV",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volt)},{value:"HPh",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.HorsePwHr)},{value:"Wh",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WattHr)},{value:"flb",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FtPound)},{value:"BTU",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Btu)},{value:"c",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThermCal)}])),t.powerUnitTypeEnums=new n.ResettableLazy((()=>[{value:"HP",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.HorsePw)},{value:"W",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Watt)},{value:"PS",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.HorseStr)}])),t.magnetismUnitTypeEnums=new n.ResettableLazy((()=>[{value:"T",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tessla)},{value:"ga",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Gauss)}])),t.temperatureUnitTypeEnums=new n.ResettableLazy((()=>[{value:"C",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Cels)},{value:"F",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Fahr)},{value:"K",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Kelv)},{value:"Rank",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Rankine)},{value:"Reau",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Reaumur)}])),t.volumeUnitTypeEnums=new n.ResettableLazy((()=>[{value:"tsp",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tsp)},{value:"tbs",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tbs)},{value:"oz",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Oz)},{value:"cup",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Cup)},{value:"qt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.QuartUs)},{value:"gal",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Gal)},{value:"l",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Liter)},{value:"uk_pt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PintUk)},{value:"us_pt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PintUs)},{value:"ang^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AngsPow3)},{value:"barrel",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Barrel)},{value:"bushel",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Bushel)},{value:"ft^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FootPow3)},{value:"GRT",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RegTon)},{value:"in^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.InchPow3)},{value:"ly^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LightYrPow3)},{value:"mi^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SMilePow3)},{value:"MTON",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MeasTon)},{value:"Nmi^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NMilePow3)},{value:"Pica^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PicaPow3)},{value:"tspm",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MdnTsp)},{value:"uk_gal",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.GalUk)},{value:"yd^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.YdPow3)},{value:"uk_qt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.QuartUk)}])),t.areaUnitTypeEnums=new n.ResettableLazy((()=>[{value:"uk_acre",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AcreUk)},{value:"us_acre",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AcreUs)},{value:"ang^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AngsPow2)},{value:"ar",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Are)},{value:"ft^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FootPow2)},{value:"ha",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Hectare)},{value:"in^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.InchPow2)},{value:"ly^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LightYrPow2)},{value:"m^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MeterPow2)},{value:"Morgen",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Morgen)},{value:"mi^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SMilePow2)},{value:"Nmi^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NMilePow2)},{value:"Pica^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PicaPow2)},{value:"yd^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.YdPow2)}])),t.informationUnitTypeEnums=new n.ResettableLazy((()=>[{value:"bit",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Bit)},{value:"byte",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Byte)}])),t.speedUnitTypeEnums=new n.ResettableLazy((()=>[{value:"admkn",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AdmKnot)},{value:"kn",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Knot)},{value:"m/hr",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MSlashHr)},{value:"m/sec",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MSlashSec)},{value:"mph",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MPH)}]));const a=new n.ResettableLazy((()=>[t.massUnitTypeEnums,t.distanceUnitTypeEnums,t.timeUnitTypeEnums,t.pressureUnitTypeEnums,t.forceUnitTypeEnums,t.energyUnitTypeEnums,t.powerUnitTypeEnums,t.magnetismUnitTypeEnums,t.temperatureUnitTypeEnums,t.volumeUnitTypeEnums,t.areaUnitTypeEnums,t.informationUnitTypeEnums,t.speedUnitTypeEnums]));t.getConvertEnum=function(e,t,r,n){const i=a.getValue().map((e=>e.getValue())),o=[].concat(...i);if(2===e)return o;if(3===e){const e=function(e,t,r){const n=e.spans[r[1].label].start,i=e.spans[r[1].label].end,o=t.substring(n,i).replace(/^"|"$/g,"")??"";if(""===o)return[];for(const e of a.getValue())if(e.getValue().find((e=>e.value===o)))return e.getValue();return[]}(t,r,n);return e.length>0?e:o}return[]}},17096:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocompleteEnumPluginDependenciesResolved=t.AutocompleteEnumPlugin=void 0;const n=r(74643),a=r(2340),i=r(44544),o=r(57993),s=r(1765),u=r(30070),l=r(98468),c=r(50013),d=r(96926),g=r(66397),m=r(36159),h=r(34618),p=r(4317),f=r(27437),S=r(93336),v=r(10048),F=r(91903),y=r(12893),C=F.PluginRegistry.create(S.PluginFactoryName.AutocompleteEnumPlugin,S.PluginGroup.Excel);let A=(()=>{let e,t,r,i=[C.x10Plugin()],l=[],v=[];return t=class{*run(e){const t=yield{kind:a.ComputationRequestKind.ParseActiveCell,formulaText:e.content};if(t.kind!==a.ComputationRequestKind.ParseActiveCell||!(0,s.isSuccess)(t.result))return null;if(t.result.value.kind!==u.EditKind.Formula)return null;const{formula:r}=t.result.value,n=new g.AutoCompleteEnumVisitor(r,e.caretPosition);if((0,c.reduceBottomUp)(n,r),void 0===n.stringStartPosition||void 0===n.stringEndPosition||void 0===n.functionHead||void 0===n.argIndex||void 0===n.functionArgs||n.isInsideArrayNode)return null;const i=n.argIndex+1,{stringStartPosition:o,stringEndPosition:l,functionHead:d}=n,S=e.caretPosition===l?e.content.substring(o,l).toUpperCase():"";let v;if(d.id===f.WorksheetFuncId.CONVERT)v=(0,p.getConvertEnum)(i,r,e.content,n.functionArgs);else{const e=h.functionEnums.getValue();v=this.getEnumInfoByArg(i,e,d.id)}if((0,m.isNone)(v))return null;const F=yield{kind:a.ComputationRequestKind.GetConfig};if(F.kind!==a.ComputationRequestKind.GetConfig)return this.logFailure("failed to get config"),null;const y=F.config.localeInfo,C=this.getLocalizedEnumInfo(v,y);if(0===C.length)return this.logFailure("failed to get enum info for values/descriptions"),null;const{prefixedEnumInfo:A,notPrefixedEnumInfo:E}=this.getFilteredEnumInfo(S,d.id,C),b=this.shouldAddDoubleQuotes(d.id);return{items:[...this.generateCompletionItems(A,o,l,!0,b),...this.generateCompletionItems(E,o,l,!1,b)]}}generateCompletionItems(e,t,r,n,a){return e.map((e=>{const i=a?`"${e.value}"`:e.value;return{label:i,kind:S.CompletionItemKind.Enum,type:S.SuggestionKind.Simple,detail:e.description,textEdit:{newText:i,range:{start:{line:0,character:t},end:{line:0,character:r}}},isPrefixed:n}}))}getFilteredEnumInfo(e,t,r){let n=[],a=[];const i=e.replace(/^"|"$/g,"");if(this.shouldAddDoubleQuotes(t)&&e.endsWith('"')&&e.startsWith('"'))n=r.filter((e=>e.value.toUpperCase()===i));else{const e=(0,d.filterSuggestionsAccordingToPrefix)(i,r,(e=>e.value));n=e.prefixedSuggestions,a=e.notPrefixedSuggestions}return 0===n.length&&0===a.length&&a.push(...r),{prefixedEnumInfo:n,notPrefixedEnumInfo:a}}getEnumInfoByArg(e,t,r){const n=t[r];if(!(0,m.isNone)(n))return n[e]}getLocalizedEnumInfo(e,t){const r=e.map((e=>({value:"function"==typeof e.value?e.value(t):e.value,description:"function"==typeof e.description?e.description(t):e.description}))),n=r.length,a=r.filter((e=>{const{value:t,description:r}=e;return void 0!==t&&void 0!==r&&""!==t&&"undefined"!==t}));return e.length!==n&&this.logFailure("failed to get enum info for some values"),a}shouldAddDoubleQuotes(e){return e===f.WorksheetFuncId.COMPLEX||e===f.WorksheetFuncId.INFO||e===f.WorksheetFuncId.CONVERT||e===f.WorksheetFuncId.CELL}logFailure(e){o.ulsLogger.ULS.traceTag(508350686,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,`AutocompleteEnumPlugin encountered a failure with msg ${e}`)}constructor(){n.__runInitializers(this,v)}},n.__setFunctionName(t,"AutocompleteEnumPlugin"),(()=>{const a="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[C.uiMessageHandler({kind:y.RequestKind.functionSuggestion})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:a},null,v),n.__esDecorate(null,e={value:t},i,{kind:"class",name:t.name,metadata:a},null,l),t=e.value,a&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:a})})(),t.factory=C.injectPluginFactory(),n.__runInitializers(t,l),t})();t.AutocompleteEnumPlugin=A,(0,i.registerPluginFactory)(A.factory),t.autocompleteEnumPluginDependenciesResolved=(0,v.trackableAsyncLazy)((async()=>{const e=await l.autoCompletePluginsThread.getValue();await e.loadPluginScript("formula-authoring-strings",!0),await e.createAndAttachPlugin(S.PluginFactoryName.AutocompleteEnumPlugin),await l.schedulerWithRecalcServiceAttached.getValue()}),"autocompleteEnumPluginDependenciesResolved")},66397:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutoCompleteEnumVisitor=void 0;const n=r(12973),a=r(28276);class i extends a.CaretInsideArrayNodeIdentityVisitor{appNode(e,t,r,a){return e.kind===n.NodeKind.WSF&&this.updateAssistedFunctionAndArgIndex(e,t),super.appNode(e,t,r,a)}updateAssistedFunctionAndArgIndex(e,t){for(let r=0;r<t.length;r++){const n=this.parsedFormulaTree.spans[t[r].label];if(n&&n.start-n.pre.length<=this.caretPosition&&this.caretPosition<=n.end+n.post.length&&void 0===this.functionHead){this.functionHead=e,this.argIndex=r,this.functionArgs=t,this.stringStartPosition=n.start,this.stringEndPosition=n.end;break}}}constructor(e,t){super(e,t)}}t.AutoCompleteEnumVisitor=i},34618:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionEnums=void 0;const n=r(27437),a=r(4595),i=r(96978);t.functionEnums=new a.ResettableLazy((()=>({[n.WorksheetFuncId.ERROR_TYPE]:{1:[{value:e=>e.errorNames[i.ErrorType.NULL]??"",description:i.ErrorType.NULL.toString()},{value:e=>e.errorNames[i.ErrorType.DIV0]??"",description:i.ErrorType.DIV0.toString()},{value:e=>e.errorNames[i.ErrorType.VALUE]??"",description:i.ErrorType.VALUE.toString()},{value:e=>e.errorNames[i.ErrorType.REF]??"",description:i.ErrorType.REF.toString()},{value:e=>e.errorNames[i.ErrorType.NAME]??"",description:i.ErrorType.NAME.toString()},{value:e=>e.errorNames[i.ErrorType.NUM]??"",description:i.ErrorType.NUM.toString()},{value:e=>e.errorNames[i.ErrorType.NA]??"",description:i.ErrorType.NA.toString()}]},[n.WorksheetFuncId.SUBTOTAL]:{1:[{value:"1",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.AVERAGE)},{value:"2",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNT)},{value:"3",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNTA)},{value:"4",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MAX)},{value:"5",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MIN)},{value:"6",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.PRODUCT)},{value:"7",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.STDEV)},{value:"8",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.STDEVP)},{value:"9",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.SUM)},{value:"10",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.VAR)},{value:"11",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.VARP)},{value:"101",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.AVERAGE)},{value:"102",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNT)},{value:"103",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNTA)},{value:"104",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MAX)},{value:"105",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MIN)},{value:"106",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.PRODUCT)},{value:"107",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.STDEV)},{value:"108",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.STDEVP)},{value:"109",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.SUM)},{value:"110",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.VAR)},{value:"111",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.VARP)}]},[n.WorksheetFuncId.AGGREGATE]:{1:[{value:"1",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.AVERAGE)},{value:"2",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNT)},{value:"3",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNTA)},{value:"4",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MAX)},{value:"5",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MIN)},{value:"6",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.PRODUCT)},{value:"7",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.STDEV)},{value:"8",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.STDEVP)},{value:"9",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.SUM)},{value:"10",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.VAR)},{value:"11",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.VARP)},{value:"12",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MEDIAN)},{value:"13",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MODE_SNGL)},{value:"14",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.LARGE)},{value:"15",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.SMALL)},{value:"16",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.PERCENTILE_INC)},{value:"17",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.QUARTILE_INC)},{value:"18",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.PERCENTILE_EXC)},{value:"19",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.QUARTILE_EXC)}],2:[{value:"0",description:e=>FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreNestedSUBTOTALandAGGREGATEfunctions).replace("{0}",e.getWorksheetFuncName(n.WorksheetFuncId.SUBTOTAL)).replace("{1}",e.getWorksheetFuncName(n.WorksheetFuncId.AGGREGATE))},{value:"1",description:e=>FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreHiddenRowsNestedSUBTOTALandAGGREGATEfunctions).replace("{0}",e.getWorksheetFuncName(n.WorksheetFuncId.SUBTOTAL)).replace("{1}",e.getWorksheetFuncName(n.WorksheetFuncId.AGGREGATE))},{value:"2",description:e=>FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreErrorValuesNestedSUBTOTALandAGGREGATEfunctions).replace("{0}",e.getWorksheetFuncName(n.WorksheetFuncId.SUBTOTAL)).replace("{1}",e.getWorksheetFuncName(n.WorksheetFuncId.AGGREGATE))},{value:"3",description:e=>FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreHiddenRowsErrorValuesNestedSUBTOTALandAGGREGATEfunctions).replace("{0}",e.getWorksheetFuncName(n.WorksheetFuncId.SUBTOTAL)).replace("{1}",e.getWorksheetFuncName(n.WorksheetFuncId.AGGREGATE))},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreNothing)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreHiddenRows)},{value:"6",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreErrorValues)},{value:"7",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreHiddenRowsErrorValues)}]},[n.WorksheetFuncId.CUBESET]:{4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.None)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ascending)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Descending)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AlphaAscending)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AlphaDescending)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NaturalAscending)},{value:"6",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NaturalDescending)}]},[n.WorksheetFuncId.VLOOKUP]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ApproximateMatch)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatch)}]},[n.WorksheetFuncId.HLOOKUP]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ApproximateMatch)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatch)}]},[n.WorksheetFuncId.XLOOKUP]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatch)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatchOrNextSmallerItem)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatchOrNextLargerItem)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WildcardCharacterMatch)}],6:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SearchFirstToLast)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SearchLastToFirst)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BinarySearchAscending)},{value:"-2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BinarySearchDescending)}]},[n.WorksheetFuncId.RANK]:{3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Descending)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ascending)}]},[n.WorksheetFuncId.RANK_AVG]:{3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Descending)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ascending)}]},[n.WorksheetFuncId.RANK_EQ]:{3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Descending)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ascending)}]},[n.WorksheetFuncId.MATCH]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LessThan)},{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatch)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.GreaterThan)}]},[n.WorksheetFuncId.XMATCH]:{3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatch)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatchOrNextSmallerItem)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatchOrNextLargerItem)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WildcardCharacterMatch)}],4:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SearchFirstToLast)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SearchLastToFirst)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BinarySearchAscending)},{value:"-2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BinarySearchDescending)}]},[n.WorksheetFuncId.FINDN]:{4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseSensitiveMatch)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseInsensitiveMatch)}],5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DontMatchToEnd)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MatchToEnd)}],7:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnsTheFirstCharacterPositionOfTheString)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnsTheLastCharacterPositionOfTheString)}]},[n.WorksheetFuncId.TEXTBEFORE]:{4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseSensitiveMatch)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseInsensitiveMatch)}],5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DontMatchToEnd)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MatchToEnd)}]},[n.WorksheetFuncId.TEXTAFTER]:{4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseSensitiveMatch)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseInsensitiveMatch)}],5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DontMatchToEnd)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MatchToEnd)}]},[n.WorksheetFuncId.TEXTSPLIT]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreEmptyCells)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IncludeEmptyCells)}],5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseSensitiveMatch)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseInsensitiveMatch)}]},[n.WorksheetFuncId.ACCRINT]:{6:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],7:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.ACCRINTM]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.ADDRESS]:{4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.R1C1Style)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.A1Style)}],3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Absolute)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AbsoluteRowRelativeColumn)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RelativeRowAbsoluteColumn)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Relative)}]},[n.WorksheetFuncId.AMORDEGRC]:{7:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.AMORLINC]:{7:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.BETA_DIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.BINOMDIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},[n.WorksheetFuncId.BINOM_DIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},[n.WorksheetFuncId.CHISQ_DIST]:{3:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.COMPLEX]:{3:[{value:"i",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ISuffixDescriptionForComplexNumber)},{value:"j",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.JSuffixDescriptionForComplexNumber)}]},[n.WorksheetFuncId.COUPDAYBS]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.COUPDAYS]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.COUPDAYSNC]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.COUPNCD]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.COUPNUM]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.COUPPCD]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.CUMIPMT]:{6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},[n.WorksheetFuncId.CUMPRINC]:{6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},[n.WorksheetFuncId.DAYS360]:{3:[{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASDMethod)},{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EuropeanMethod)}]},[n.WorksheetFuncId.DISC]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.DURATION]:{5:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.EXPONDIST]:{3:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.EXPON_DIST]:{3:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.F_DIST]:{3:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.FIXED]:{3:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PreventCommas)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DoNotPreventCommas)}]},[n.WorksheetFuncId.FV]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},[n.WorksheetFuncId.GAMMADIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.GAMMA_DIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.HYPGEOM_DIST]:{5:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.INDIRECT]:{2:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.A1Style)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.R1C1Style)}]},[n.WorksheetFuncId.INTRATE]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.IPMT]:{6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},[n.WorksheetFuncId.LINEST]:{3:[{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsSetEqualTo0)},{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsCalculatedNormally)}],4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnAdditionalRegressionStatistics)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DoNotReturnAdditionalRegressionStatistics)}]},[n.WorksheetFuncId.LOGEST]:{3:[{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsSetEqualTo0)},{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsCalculatedNormally)}],4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnAdditionalRegressionStatistics)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DoNotReturnAdditionalRegressionStatistics)}]},[n.WorksheetFuncId.LOGNORM_DIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.MDURATION]:{5:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.NEGBINOM_DIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},[n.WorksheetFuncId.NORM_S_DIST]:{2:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.NORMDIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},[n.WorksheetFuncId.NORM_DIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},[n.WorksheetFuncId.NPER]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},[n.WorksheetFuncId.ODDFPRICE]:{8:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],9:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.ODDFYIELD]:{8:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],9:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.ODDLPRICE]:{7:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],8:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.ODDLYIELD]:{7:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],8:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.PMT]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},[n.WorksheetFuncId.POISSON]:{3:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},[n.WorksheetFuncId.POISSON_DIST]:{3:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},[n.WorksheetFuncId.PPMT]:{6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},[n.WorksheetFuncId.PRICE]:{6:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],7:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.PRICEDISC]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.PRICEMAT]:{6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.QUARTILE]:{2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MinimumValue)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FirstQuartile)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MedianValue)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThirdQuartile)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MaximumValue)}]},[n.WorksheetFuncId.QUARTILE_INC]:{2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MinimumValue)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FirstQuartile)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MedianValue)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThirdQuartile)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MaximumValue)}]},[n.WorksheetFuncId.QUARTILE_EXC]:{2:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FirstQuartile)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MedianValue)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThirdQuartile)}]},[n.WorksheetFuncId.RATE]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},[n.WorksheetFuncId.RECEIVED]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.REGEXEXTRACT]:{3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RegexExtractMode0)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RegexExtractMode1)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RegexExtractMode2)}],4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RegexCaseSensitiveMatch)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RegexCaseInsensitiveMatch)}]},[n.WorksheetFuncId.REGEXREPLACE]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RegexCaseSensitiveMatch)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RegexCaseInsensitiveMatch)}]},[n.WorksheetFuncId.REGEXTEST]:{3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RegexCaseSensitiveMatch)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RegexCaseInsensitiveMatch)}]},[n.WorksheetFuncId.ROMAN]:{2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Classic)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MoreConcise)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MoreConcise)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MoreConcise)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Simplified)}]},[n.WorksheetFuncId.STOCKHISTORY]:{4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Daily)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Weekly)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Monthly)}],5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NoHeader)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Showheader)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ShowInstrumentIdentifierAndHeader)}],6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Date)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Close)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Open)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.High)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Low)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volume)}],7:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Date)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Close)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Open)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.High)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Low)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volume)}],8:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Date)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Close)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Open)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.High)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Low)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volume)}],9:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Date)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Close)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Open)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.High)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Low)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volume)}],10:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Date)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Close)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Open)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.High)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Low)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volume)}],11:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Date)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Close)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Open)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.High)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Low)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volume)}]},[n.WorksheetFuncId.TRANSLATE]:{2:[{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagAF),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameAF)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSQ),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSQ)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagAM),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameAM)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagAR),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameAR)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagHY),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHY)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagAS),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameAS)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagAZ),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameAZ)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagBN),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBN)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagBA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagEU),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameEU)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagBHO),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBHO)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagBRX),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBRX)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagBOSNIAN),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBOSNIAN)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagBG),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBG)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagYUE),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameYUE)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagCA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameCA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagHNE),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHNE)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagLZH),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameLZH)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagZH_CHS),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameZH_CHS)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagZH_CHT),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameZH_CHT)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagHR),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHR)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagCS),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameCS)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagDA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameDA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagPRS),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNamePRS)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagDV),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameDV)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagDOI),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameDOI)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagNL),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameNL)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagEN),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameEN)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagET),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameET)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagFO),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFO)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagFJ),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFJ)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagFIL),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFIL)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagFI),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFI)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagFR),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFR)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagFR_CA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFR_CA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagGL),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameGL)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagLUG),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameLUG)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagKA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagDE),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameDE)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagEL),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameEL)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagGU),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameGU)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagHT),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHT)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagHA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagHE),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHE)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagHI),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHI)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMWW),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMWW)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagHU),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHU)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagIS),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameIS)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagIG),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameIG)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagID),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameID)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagIKT),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameIKT)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagIU),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameIU)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagIU_LATN),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameIU_LATN)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagGA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameGA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagIT),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameIT)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagJA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameJA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagKN),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKN)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagKS),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKS)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagKK),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKK)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagKM),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKM)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagRW),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameRW)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagGOM),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameGOM)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagKO),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKO)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagKU),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKU)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagKMR),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKMR)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagKY),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKY)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagLO),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameLO)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagLV),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameLV)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagLN),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameLN)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagLT),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameLT)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagDSB),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameDSB)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMK),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMK)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMAI),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMAI)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMG),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMG)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMS),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMS)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagML),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameML)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMT),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMT)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMNI),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMNI)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMR),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMR)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMN_CYRL),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMN_CYRL)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMN_MONG),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMN_MONG)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMY),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMY)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMI),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMI)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagNE),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameNE)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagNB),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameNB)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagNYA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameNYA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagOR),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameOR)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagPS),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNamePS)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagFA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagPL),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNamePL)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagPT),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNamePT)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagPT_PT),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNamePT_PT)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagPA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNamePA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagOTQ),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameOTQ)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagRO),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameRO)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagRUN),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameRUN)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagRU),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameRU)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSM),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSM)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSR_CYRL),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSR_CYRL)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSR_LATN),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSR_LATN)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagST),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameST)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagNSO),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameNSO)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagTN),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTN)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSN),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSN)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSD),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSD)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSI),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSI)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSK),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSK)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSL),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSL)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSO),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSO)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagES),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameES)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSW),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSW)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSV),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSV)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagTY),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTY)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagTA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagTT),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTT)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagTE),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTE)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagTH),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTH)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagBO),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBO)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagTI),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTI)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagTO),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTO)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagTR),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTR)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagTK),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTK)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagUK),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameUK)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagHSB),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHSB)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagUR),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameUR)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagUG),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameUG)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagUZ),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameUZ)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagVI),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameVI)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagCY),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameCY)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagXH),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameXH)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagYO),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameYO)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagYUA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameYUA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagZU),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameZU)}],3:[{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagAF),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameAF)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSQ),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSQ)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagAM),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameAM)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagAR),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameAR)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagHY),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHY)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagAS),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameAS)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagAZ),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameAZ)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagBN),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBN)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagBA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagEU),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameEU)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagBHO),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBHO)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagBRX),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBRX)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagBOSNIAN),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBOSNIAN)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagBG),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBG)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagYUE),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameYUE)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagCA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameCA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagHNE),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHNE)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagLZH),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameLZH)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagZH_CHS),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameZH_CHS)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagZH_CHT),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameZH_CHT)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagHR),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHR)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagCS),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameCS)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagDA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameDA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagPRS),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNamePRS)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagDV),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameDV)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagDOI),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameDOI)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagNL),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameNL)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagEN),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameEN)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagET),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameET)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagFO),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFO)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagFJ),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFJ)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagFIL),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFIL)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagFI),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFI)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagFR),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFR)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagFR_CA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFR_CA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagGL),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameGL)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagLUG),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameLUG)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagKA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagDE),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameDE)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagEL),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameEL)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagGU),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameGU)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagHT),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHT)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagHA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagHE),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHE)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagHI),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHI)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMWW),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMWW)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagHU),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHU)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagIS),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameIS)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagIG),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameIG)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagID),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameID)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagIKT),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameIKT)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagIU),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameIU)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagIU_LATN),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameIU_LATN)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagGA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameGA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagIT),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameIT)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagJA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameJA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagKN),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKN)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagKS),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKS)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagKK),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKK)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagKM),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKM)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagRW),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameRW)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagGOM),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameGOM)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagKO),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKO)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagKU),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKU)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagKMR),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKMR)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagKY),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKY)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagLO),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameLO)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagLV),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameLV)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagLN),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameLN)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagLT),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameLT)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagDSB),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameDSB)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMK),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMK)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMAI),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMAI)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMG),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMG)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMS),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMS)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagML),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameML)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMT),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMT)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMNI),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMNI)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMR),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMR)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMN_CYRL),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMN_CYRL)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMN_MONG),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMN_MONG)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMY),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMY)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMI),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMI)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagNE),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameNE)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagNB),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameNB)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagNYA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameNYA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagOR),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameOR)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagPS),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNamePS)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagFA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagPL),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNamePL)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagPT),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNamePT)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagPT_PT),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNamePT_PT)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagPA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNamePA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagOTQ),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameOTQ)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagRO),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameRO)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagRUN),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameRUN)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagRU),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameRU)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSM),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSM)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSR_CYRL),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSR_CYRL)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSR_LATN),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSR_LATN)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagST),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameST)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagNSO),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameNSO)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagTN),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTN)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSN),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSN)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSD),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSD)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSI),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSI)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSK),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSK)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSL),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSL)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSO),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSO)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagES),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameES)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSW),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSW)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSV),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSV)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagTY),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTY)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagTA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagTT),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTT)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagTE),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTE)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagTH),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTH)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagBO),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBO)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagTI),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTI)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagTO),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTO)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagTR),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTR)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagTK),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTK)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagUK),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameUK)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagHSB),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHSB)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagUR),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameUR)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagUG),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameUG)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagUZ),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameUZ)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagVI),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameVI)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagCY),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameCY)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagXH),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameXH)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagYO),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameYO)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagYUA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameYUA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagZU),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameZU)}]},[n.WorksheetFuncId.TREND]:{4:[{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsSetEqualTo0)},{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsCalculatedNormally)}]},[n.WorksheetFuncId.TTEST]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.OneTailedDistribution)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoTailedDistribution)}],4:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Paired)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoSampleEqualVariance)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoSampleUnequalVariance)}]},[n.WorksheetFuncId.T_TEST]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.OneTailedDistribution)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoTailedDistribution)}],4:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Paired)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoSampleEqualVariance)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoSampleUnequalVariance)}]},[n.WorksheetFuncId.VDB]:{7:[{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SwitchToStraightLineDepreciation)},{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DoNotSwitchToStraightLineDepreciation)}]},[n.WorksheetFuncId.WEEKDAY]:{2:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Sundaythrough7Saturday)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Mondaythrough7Sunday)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers0Mondaythrough6Sunday)},{value:"11",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Mondaythrough7Sunday)},{value:"12",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Tuesdaythrough7Monday)},{value:"13",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Wednesdaythrough7Tuesday)},{value:"14",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Thursdaythrough7Wednesday)},{value:"15",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Fridaythrough7Thursday)},{value:"16",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Saturdaythrough7Friday)},{value:"17",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Sundaythrough7Saturday)}]},[n.WorksheetFuncId.WEIBULL]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.WEIBULL_DIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.YEARFRAC]:{3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.YIELD]:{6:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],7:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.YIELDDISC]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.YIELDMAT]:{6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.GROWTH]:{4:[{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsSetEqualTo0)},{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsCalculatedNormally)}]},[n.WorksheetFuncId.PV]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},[n.WorksheetFuncId.TDIST]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.OneTailedDistribution)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoTailedDistribution)}]},[n.WorksheetFuncId.T_DIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.WEEKNUM]:{2:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sunday)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Monday)},{value:"11",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Monday)},{value:"12",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tuesday)},{value:"13",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Wednesday)},{value:"14",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Thursday)},{value:"15",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Friday)},{value:"16",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Saturday)},{value:"17",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sunday)},{value:"21",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Monday)}]},[n.WorksheetFuncId.NETWORKDAYS_INTL]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SaturdaySunday)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SundayMonday)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MondayTuesday)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TuesdayWednesday)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WednesdayThursday)},{value:"6",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThursdayFriday)},{value:"7",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FridaySaturday)},{value:"11",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SundayOnly)},{value:"12",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MondayOnly)},{value:"13",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TuesdayOnly)},{value:"14",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WednesdayOnly)},{value:"15",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThursdayOnly)},{value:"16",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FridayOnly)},{value:"17",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SaturdayOnly)}]},[n.WorksheetFuncId.WORKDAY_INTL]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SaturdaySunday)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SundayMonday)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MondayTuesday)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TuesdayWednesday)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WednesdayThursday)},{value:"6",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThursdayFriday)},{value:"7",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FridaySaturday)},{value:"11",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SundayOnly)},{value:"12",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MondayOnly)},{value:"13",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TuesdayOnly)},{value:"14",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WednesdayOnly)},{value:"15",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThursdayOnly)},{value:"16",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FridayOnly)},{value:"17",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SaturdayOnly)}]},[n.WorksheetFuncId.FORECAST_ETS]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MissingValuesTreatedAsZeroes)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AutomaticCompletionUsesLinearInterpolation)}],6:[{value:"1",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.AVERAGE)},{value:"2",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNT)},{value:"3",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNTA)},{value:"4",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MAX)},{value:"5",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MEDIAN)},{value:"6",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MIN)},{value:"7",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.SUM)}]},[n.WorksheetFuncId.FORECAST_ETS_CONFINT]:{6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MissingValuesTreatedAsZeroes)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AutomaticCompletionUsesLinearInterpolation)}],7:[{value:"1",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.AVERAGE)},{value:"2",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNT)},{value:"3",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNTA)},{value:"4",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MAX)},{value:"5",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MEDIAN)},{value:"6",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MIN)},{value:"7",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.SUM)}]},[n.WorksheetFuncId.FORECAST_ETS_SEASONALITY]:{3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MissingValuesTreatedAsZeroes)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AutomaticCompletionUsesLinearInterpolation)}],4:[{value:"1",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.AVERAGE)},{value:"2",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNT)},{value:"3",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNTA)},{value:"4",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MAX)},{value:"5",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MEDIAN)},{value:"6",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MIN)},{value:"7",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.SUM)}]},[n.WorksheetFuncId.FORECAST_ETS_STAT]:{4:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AlphaParameterOfETSalgorithm)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BetaParameterOfETSalgorithm)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.GammaParameterOfETSalgorithm)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MASEMetric)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SMAPEMetric)},{value:"6",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MAEMetric)},{value:"7",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RMSEMetric)},{value:"8",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.StepSizeDetected)}],5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MissingValuesTreatedAsZeroes)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AutomaticCompletionUsesLinearInterpolation)}],6:[{value:"1",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.AVERAGE)},{value:"2",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNT)},{value:"3",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNTA)},{value:"4",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MAX)},{value:"5",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MEDIAN)},{value:"6",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MIN)},{value:"7",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.SUM)}]},[n.WorksheetFuncId.TEXTJOIN]:{2:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreEmptyCells)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IncludeEmptyCells)}]},[n.WorksheetFuncId.SORT]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ascending)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Descending)}],4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SortByColumn)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SortByRow)}]},[n.WorksheetFuncId.UNIQUE]:{2:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnUniqueColumns)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnUniqueRows)}],3:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnitemsthatAppearExactlyOnce)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnEveryDistinctItem)}]},[n.WorksheetFuncId.SORTBY]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ascending)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Descending)}]},[n.WorksheetFuncId.RANDARRAY]:{5:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Integer)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Decimal)}]},[n.WorksheetFuncId.VALUETOTEXT]:{2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Concise)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Strict)}]},[n.WorksheetFuncId.ARRAYTOTEXT]:{2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Concise)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Strict)}]},[n.WorksheetFuncId.TOCOL]:{2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.KeepAllValues)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreBlanks)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreErrors)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreBlanksAndErrors)}],3:[{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ScanByRow)},{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ScanByColumn)}]},[n.WorksheetFuncId.TOROW]:{2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.KeepAllValues)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreBlanks)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreErrors)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreBlanksAndErrors)}],3:[{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ScanByRow)},{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ScanByColumn)}]},[n.WorksheetFuncId.IMAGE]:{3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FitCell)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FillCell)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.OriginalSize)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CustomSize)}]}})))},33893:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutocompleteBaseVisitor=void 0;const n=r(12973),a=r(28276);class i extends a.CaretInsideArrayNodeIdentityVisitor{nameNode(e,t,r){return e.kind!==n.NamePartKind.IdentNamePart&&e.kind!==n.NamePartKind.FieldRefNamePart||this.updateAutocompleteString(r,e.asWhole),super.nameNode(e,t,r)}appNode(e,t,r,a){return this.autoCompleteForCellRefEnabled&&e.kind===n.NodeKind.WSF&&this.updateAutocompleteString(a,e.whole),super.appNode(e,t,r,a)}cellRefNode(e,t,r){const a=this.parsedFormulaTree.spans[r];if(e.kind===n.CellRefKind.Single&&a){const e=this.formulaString.substring(a.start,a.end);this.updateAutocompleteString(r,e)}return super.cellRefNode(e,t,r)}updateAutocompleteString(e,t){const r=this.parsedFormulaTree.spans[e].start,n=r+t.length;this.caretPosition===n&&(this.autocompleteString=t,this.stringEndPosition=n,this.stringStartPosition=r)}constructor(e,t,r,n){super(e,t),this.formulaString=r,this.autoCompleteForCellRefEnabled=n}}t.AutocompleteBaseVisitor=i},71201:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocompleteFunctionPluginDependenciesResolved=t.AutocompleteFunctionPlugin=void 0;const n=r(74643),a=r(2340),i=r(44544),o=r(57993),s=r(1765),u=r(30070),l=r(98468),c=r(50013),d=r(89293),g=r(93336),m=r(93336),h=r(96926),p=r(33893),f=r(66761),S=r(36159),v=r(60756),F=r(10048),y=r(91903),C=r(12893),A=y.PluginRegistry.create(m.PluginFactoryName.AutocompleteFunctionPlugin,g.PluginGroup.Excel);let E=(()=>{let e,t,r,i=[A.x10Plugin()],l=[],m=[];return t=class{*run(e){const t=yield{kind:a.ComputationRequestKind.ParseActiveCell,formulaText:e.content};if(t.kind!==a.ComputationRequestKind.ParseActiveCell||!(0,s.isSuccess)(t.result))return null;if(t.result.value.kind!==u.EditKind.Formula)return null;const{formula:r}=t.result.value,n=new p.AutocompleteBaseVisitor(r,e.caretPosition,e.content,this.autoCompleteForCellRefEnabled);if((0,c.reduceBottomUp)(n,r),void 0===n.autocompleteString||void 0===n.stringStartPosition||void 0===n.stringEndPosition||n.isInsideArrayNode)return null;const i=n.autocompleteString.toUpperCase(),o=n.stringStartPosition,l=n.stringEndPosition,g=yield{kind:a.ComputationRequestKind.GetFunctionsInfo};if(g.kind!==a.ComputationRequestKind.GetFunctionsInfo)return this.logFailure("failed to get functions info"),null;const m=g.functionsInfo,{prefixedSuggestions:f,notPrefixedSuggestions:S}=(0,h.filterSuggestionsAccordingToPrefix)(i,m,(e=>e.NameDataStrings)),v=d.functionShortDescriptions.getValue();null!==v&&null!==v.descriptionMap||this.logFailure("failed to get short descriptions, will show function info help description");const F=(0,h.getCompletedFunctionSuffix)(e.content,l);return{items:[...this.generateCompletionItems(f,v,o,l,!0,F),...this.generateCompletionItems(S,v,o,l,!1,F)]}}generateCompletionItems(e,t,r,n,a,i){const s=[],u=e.map((e=>{const o=e.FunctionIndexInServer.toString();let u=(0,v.isTypedChangeGateEnabled)("Microsoft.Office.Excel.UseObjectInsteadOfMapForFunctionShortDescriptions")?t.descriptionMap?.[o]:t.descriptionMap?.get(o);return(0,S.isNone)(u)&&(s.push(e.FunctionIndexInServer),u=e.Help),{label:e.NameDataStrings,kind:g.CompletionItemKind.Function,type:g.SuggestionKind.Simple,detail:u,textEdit:{newText:e.NameDataStrings+i,range:{start:{line:0,character:r},end:{line:0,character:n}}},isPrefixed:a,shouldRequestAutocompleteOnCommit:!0}}));return s.length>0&&o.ulsLogger.ULS.traceTag(508871621,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`AutocompleteFunctionPlugin missing short descriptions for func IDs: ${JSON.stringify(s)}`),u}logFailure(e){o.ulsLogger.ULS.traceTag(539083013,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,`AutocompleteFunctionPlugin encountered a failure with msg ${e}`)}constructor(){this.autoCompleteForCellRefEnabled=(n.__runInitializers(this,m),(0,f.isChangeGateEnabled)("OfficeVSO:6212698_fixFunctionAutoCompleteForCellRef"))}},n.__setFunctionName(t,"AutocompleteFunctionPlugin"),(()=>{const a="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[A.uiMessageHandler({kind:C.RequestKind.functionSuggestion})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:a},null,m),n.__esDecorate(null,e={value:t},i,{kind:"class",name:t.name,metadata:a},null,l),t=e.value,a&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:a})})(),t.factory=A.injectPluginFactory(),n.__runInitializers(t,l),t})();t.AutocompleteFunctionPlugin=E,(0,i.registerPluginFactory)(E.factory),t.autocompleteFunctionPluginDependenciesResolved=(0,F.trackableAsyncLazy)((async()=>{const e=await l.autoCompletePluginsThread.getValue();await e.loadPluginScript("formula-authoring-strings",!0),await e.createAndAttachPlugin(m.PluginFactoryName.AutocompleteFunctionPlugin),await l.schedulerWithRecalcServiceAttached.getValue()}),"autocompleteFunctionPluginDependenciesResolved")},96926:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCompletedFunctionSuffix=t.getStructRefCompletionItemRank=t.endOf=t.verifyTextAndRange=t.filterSuggestionsAccordingToPrefix=void 0;const n=r(82438),a=r(73701),i=r(36159),o=r(93336);t.filterSuggestionsAccordingToPrefix=function(e,t,r,n=!1){const a=[],o=[],s=e.toLocaleLowerCase();return""===e?{prefixedSuggestions:t,notPrefixedSuggestions:o}:(t.forEach((e=>{const t=r?r(e).toLocaleLowerCase():"string"==typeof e?e.toLocaleLowerCase():void 0;if(void 0!==t)if(!t.startsWith(s)||n&&t===s)if(n){const r=t.split(" ");(0,i.isDefined)(r.find((e=>e.startsWith(s))))&&o.push(e)}else s.length>2&&t.includes(s)&&o.push(e);else a.push(e)})),{prefixedSuggestions:a,notPrefixedSuggestions:o})},t.verifyTextAndRange=(e,t,r,n,a)=>{expect(e?.label).toEqual(t),expect(e?.textEdit?.newText).toEqual(a??t),expect(e?.textEdit?.range?.start?.character).toEqual(r),expect(e?.textEdit?.range?.end?.character).toEqual(n)},t.endOf=e=>e.length,t.getStructRefCompletionItemRank=e=>{const t=e.kind===o.CompletionItemKind.TableHeader?1:e.label?.startsWith("#")?0:e.label?.startsWith("@")?2:void 0;return(0,i.isNone)(t)?(a.ulsLogger.ULS.traceTag(526411872,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,`conflictResolver: trying to rank a structRef completion item with unexpected fields. item = ${JSON.stringify(e)}`),0):t},t.getCompletedFunctionSuffix=function(e,t){return"("===e?.charAt(t)?"":"("}},22206:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocompleteLetPluginDependenciesResolved=t.AutocompleteLetPlugin=void 0;const n=r(74643),a=r(2340),i=r(44544),o=r(1765),s=r(30070),u=r(98468),l=r(50013),c=r(5519),d=r(96926),g=r(66761),m=r(93336),h=r(10048),p=r(91903),f=r(12893),S=p.PluginRegistry.create(m.PluginFactoryName.AutocompleteLetPlugin,m.PluginGroup.Excel);let v=(()=>{let e,t,r,i=[S.x10Plugin()],u=[],h=[];return t=class{*run(e){const t=yield{kind:a.ComputationRequestKind.ParseActiveCell,formulaText:e.content};if(t.kind!==a.ComputationRequestKind.ParseActiveCell||!(0,o.isSuccess)(t.result))return null;if(t.result.value.kind!==s.EditKind.Formula)return null;const{formula:r}=t.result.value,n=e.caretPosition,i=new c.AutocompleteLetVisitor(this.autoCompleteForCellRefEnabled,e.content,r,n);(0,l.reduceBottomUp)(i,r);const u=i.references.reverse(),g=Array.from(new Set(u)),m=i.caretNodeText;if(void 0===m||i.isInsideArrayNode)return null;const h=n,p=h-m.length,{prefixedSuggestions:f,notPrefixedSuggestions:S}=(0,d.filterSuggestionsAccordingToPrefix)(m,g);return{items:[...this.stringsToCompletionItems(f,p,h,!0),...this.stringsToCompletionItems(S,p,h,!1)]}}stringsToCompletionItems(e,t,r,n){return e.map((e=>({label:e,kind:m.CompletionItemKind.LetVariable,type:m.SuggestionKind.Simple,textEdit:{newText:e,range:{start:{line:0,character:t},end:{line:0,character:r}}},isPrefixed:n})))}constructor(){this.autoCompleteForCellRefEnabled=(n.__runInitializers(this,h),(0,g.isChangeGateEnabled)("OfficeVSO:6212698_fixFunctionAutoCompleteForCellRef"))}},n.__setFunctionName(t,"AutocompleteLetPlugin"),(()=>{const a="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[S.uiMessageHandler({kind:f.RequestKind.functionSuggestion})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:a},null,h),n.__esDecorate(null,e={value:t},i,{kind:"class",name:t.name,metadata:a},null,u),t=e.value,a&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:a})})(),t.factory=S.injectPluginFactory(),n.__runInitializers(t,u),t})();t.AutocompleteLetPlugin=v,(0,i.registerPluginFactory)(v.factory),t.autocompleteLetPluginDependenciesResolved=(0,h.trackableAsyncLazy)((async()=>{const e=await u.autoCompletePluginsThread.getValue();await e.createAndAttachPlugin(m.PluginFactoryName.AutocompleteLetPlugin),await u.schedulerWithRecalcServiceAttached.getValue()}),"autocompleteLetPluginDependenciesResolved")},5519:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutocompleteLetVisitor=void 0;const n=r(12973),a=r(28276);class i extends a.ExtractLetVisitor{nameNode(e,t,r){return this.updateCaretNodeText(r,e.asWhole),super.nameNode(e,t,r)}cellRefNode(e,t,r){const a=this.parsedFormulaTree.spans[r];if(this.autoCompleteForCellRefEnabled&&e.kind===n.CellRefKind.Single&&a){const e=this.formulaString.substring(a.start,a.end);this.updateCaretNodeText(r,e)}return super.cellRefNode(e,t,r)}updateCaretNodeText(e,t){const r=this.parsedFormulaTree.spans[e]?.end;void 0!==r&&this.caretPosition===r&&t.length>0&&(this.caretNodeText=t)}constructor(e,t,r,n){super(r,n),this.autoCompleteForCellRefEnabled=e,this.formulaString=t}}t.AutocompleteLetVisitor=i},9246:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocompleteNamedObjectsPluginDependenciesResolved=t.AutocompleteNamedObjectsPlugin=void 0;const n=r(74643),a=r(2340),i=r(44544),o=r(57993),s=r(1765),u=r(30070),l=r(98468),c=r(93336),d=r(33893),g=r(50013),m=r(96926),h=r(36159),p=r(93336),f=r(66761),S=r(93336),v=r(10048),F=r(91903),y=r(12893),C=F.PluginRegistry.create(S.PluginFactoryName.AutocompleteNamedObjectsPlugin,c.PluginGroup.Excel);let A=(()=>{let e,t,r,i=[C.x10Plugin()],l=[],S=[];return t=class{*run(e){const t=yield{kind:a.ComputationRequestKind.ParseActiveCell,formulaText:e.content};if(t.kind!==a.ComputationRequestKind.ParseActiveCell||!(0,s.isSuccess)(t.result))return null;if(t.result.value.kind!==u.EditKind.Formula)return null;const{formula:r}=t.result.value,n=yield{kind:a.ComputationRequestKind.GetDefinedNamesInfo};if(n.kind!==a.ComputationRequestKind.GetDefinedNamesInfo)return this.logFailure("failed to get named objects info"),null;const i=n.definedNamesInfo,o=new d.AutocompleteBaseVisitor(r,e.caretPosition,e.content,this.autoCompleteForCellRefEnabled);(0,g.reduceBottomUp)(o,r);const{autocompleteString:l,stringStartPosition:c,stringEndPosition:f,isInsideArrayNode:S}=o;if(!(0,h.isDefined)(l)||!(0,h.isDefined)(f)||!(0,h.isDefined)(c)||S)return null;const{prefixedSuggestions:v,notPrefixedSuggestions:F}=(0,m.filterSuggestionsAccordingToPrefix)(l,i,(e=>e.name));if(this.newNamedObjectsEnabled){const t=[...v.map((e=>({...e,isPrefixed:!0}))),...F.map((e=>({...e,isPrefixed:!1})))];for(const e of t){if((0,h.isNone)(e.reference)||e.type!==p.DefinedNameInfoType.Other)continue;const t=yield{kind:a.ComputationRequestKind.ParseActiveCell,formulaText:e.reference};if(t.kind!==a.ComputationRequestKind.ParseActiveCell||!(0,s.isSuccess)(t.result)||t.result.value.kind!==u.EditKind.Formula)return null;const{formula:r}=t.result.value;r.isWellFormed&&"Lambda"===r.node.kind&&r.node.isClosed&&(e.type=p.DefinedNameInfoType.Lambda)}const r=(0,m.getCompletedFunctionSuffix)(e.content,f);return{items:this.namesToCompletionItems(t,c,f,r)}}return{items:[...this.namesToCompletionItemsOld(v,c,f,!0),...this.namesToCompletionItemsOld(F,c,f,!1)]}}namesToCompletionItemsOld(e,t,r,n){return e.filter((e=>e.type!==p.DefinedNameInfoType.Invalid)).map((e=>({label:e.name,kind:e.type===p.DefinedNameInfoType.NamedRange?c.CompletionItemKind.NamedRange:c.CompletionItemKind.Table,type:c.SuggestionKind.Simple,textEdit:{newText:e.name,range:{start:{line:0,character:t},end:{line:0,character:r}}},detail:e.tooltip,isPrefixed:n})))}namesToCompletionItems(e,t,r,n){return e.filter((e=>e.type!==p.DefinedNameInfoType.Invalid)).map((e=>{const a=function(e){switch(e.type){case p.DefinedNameInfoType.NamedRange:return c.CompletionItemKind.NamedRange;case p.DefinedNameInfoType.Table:return c.CompletionItemKind.Table;case p.DefinedNameInfoType.Lambda:return c.CompletionItemKind.Lambda;default:return c.CompletionItemKind.NamedOther}}(e);let i=e.name;return a===c.CompletionItemKind.Lambda&&(i+=n),{label:e.name,kind:a,type:c.SuggestionKind.Simple,textEdit:{newText:i,range:{start:{line:0,character:t},end:{line:0,character:r}}},detail:e.tooltip,isPrefixed:e.isPrefixed}}))}logFailure(e){o.ulsLogger.ULS.traceTag(528562134,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,`AutocompleteNamedObjectPlugin encountered a failure with msg ${e}`)}constructor(){this.autoCompleteForCellRefEnabled=(n.__runInitializers(this,S),(0,f.isChangeGateEnabled)("OfficeVSO:6212698_fixFunctionAutoCompleteForCellRef")),this.newNamedObjectsEnabled=(0,f.getBooleanFeatureGate)("Microsoft.Office.Excel.FormulaAuthoringWithNameManager",!1)&&(0,f.getBooleanFeatureGate)("Microsoft.Office.Excel.XLONameManager",!1)}},n.__setFunctionName(t,"AutocompleteNamedObjectsPlugin"),(()=>{const a="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[C.uiMessageHandler({kind:y.RequestKind.functionSuggestion})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:a},null,S),n.__esDecorate(null,e={value:t},i,{kind:"class",name:t.name,metadata:a},null,l),t=e.value,a&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:a})})(),t.factory=C.injectPluginFactory(),n.__runInitializers(t,l),t})();t.AutocompleteNamedObjectsPlugin=A,(0,i.registerPluginFactory)(A.factory),t.autocompleteNamedObjectsPluginDependenciesResolved=(0,v.trackableAsyncLazy)((async()=>{const e=await l.autoCompletePluginsThread.getValue();await e.createAndAttachPlugin(S.PluginFactoryName.AutocompleteNamedObjectsPlugin),await l.schedulerWithRecalcServiceAttached.getValue()}),"autocompleteNamedObjectsPluginDependenciesResolved")},87084:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocompleteRichValuePluginDependenciesResolved=t.AutocompleteRichValuePlugin=void 0;const n=r(74643),a=r(2340),i=r(44544),o=r(98468),s=r(93336),u=r(46641),l=r(1765),c=r(30070),d=r(50013),g=r(92587),m=r(36159),h=r(73701),p=r(43268),f=r(96926),S=r(58251),v=r(93336),F=r(33284),y=r(66761),C=r(10048),A=r(91903),E=r(12893),b=A.PluginRegistry.create(v.PluginFactoryName.AutocompleteRichValuePlugin,s.PluginGroup.Excel);let R=(()=>{let e,t,r,i=[b.x10Plugin()],o=[],h=[];var p=t=class{*run(e){if((0,m.isNone)(e.content)||(0,m.isNone)(e.caretPosition))return T("missing request arguments"),null;const t=yield{kind:a.ComputationRequestKind.ParseActiveCell,formulaText:e.content};if(t.kind!==a.ComputationRequestKind.ParseActiveCell||!(0,l.isSuccess)(t.result))return null;if(t.result.value.kind!==c.EditKind.Formula)return null;const{formula:r}=t.result.value,n=yield{kind:a.ComputationRequestKind.GetDefinedNamesInfo};if(n.kind!==a.ComputationRequestKind.GetDefinedNamesInfo)return T("failed to get named objects info"),null;const i=yield{kind:a.ComputationRequestKind.GetActiveCell};if(i.kind!==a.ComputationRequestKind.GetActiveCell)return T("failed to get active cell"),null;const o=i.activeCell,h=new u.AutocompleteRichValueVisitor(r,e.caretPosition,e.content,n.definedNamesInfo,o.range);if((0,d.reduceBottomUp)(h,r),h.isInsideArrayNode)return null;let p,v;if((0,m.isDefined)(h.cellRef))p=h.cellRef,v=o.sheet.index;else if((0,m.isDefined)(h.namedRangeNode)){const e={originGridCell:(0,l.success)(o.range),originSheet:(0,l.success)(o.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!0},t=yield{kind:a.ComputationRequestKind.ResolveReferences,nodes:[h.namedRangeNode],locals:e};if(t.kind===a.ComputationRequestKind.ResolveReferences){const e=t.resolverResults[0];if(e.kind===S.ResolvedKind.ResolvedStructRef&&(0,l.isSuccess)(e.resolution)&&void 0!==e.resolution.value){const t=e.resolution.value.range;p={firstRow:t.row,firstColumn:t.col,lastRow:t.row+t.rows-1,lastColumn:t.col+t.cols-1},v=e.resolution.value.sheet.index}}}if(!(0,m.isDefined)(p))return null;const F=h.dotNotationPath;if((0,m.isNone)(F))return T("failed to parse cellRef"),null;let y="";if((0,m.isDefined)(h.sheetName))y=h.sheetName;else{const e=yield{kind:a.ComputationRequestKind.GetSheetNames};if(e.kind!==a.ComputationRequestKind.GetSheetNames)return T("failed to get sheet names"),null;if(!(0,g.isDocumentLocEqual)(o.sheet.document,e.document))return T("sheet names document is different than that of active cell"),null;if(!(0,m.isDefined)(v))return T("sheet index is undefined"),null;y=e.sheets[e.idToIndex[v]].sheetName}const C={...p,sheetName:y,namedObjectName:""},A=yield{kind:a.ComputationRequestKind.GetRichValueFieldListContext,rangeToQuery:C,dotNotationPath:F,singleColumn:!1,findRange:!1};if(A.kind!==a.ComputationRequestKind.GetRichValueFieldListContext)return T("failed to get field list context data"),null;if((0,m.isNone)(A.result)||0===A.result.length)return null;A.result.length>1&&T("fieldListContextRequest results length greater than 1");const{prefixedSuggestions:E,notPrefixedSuggestions:b}=(0,f.filterSuggestionsAccordingToPrefix)(h.richValueItemPrefix,A.result[0].FieldInfoDataList,(e=>e.Name),!0),R=yield{kind:a.ComputationRequestKind.GetConfig};let k=[...this.resultsToCompletionItems(E,!0,h.dotNotationIndex,h.fieldRefChainEndIndex??e.caretPosition,R,!!h.namedRangeNode),...this.resultsToCompletionItems(b,!1,h.dotNotationIndex,h.fieldRefChainEndIndex??e.caretPosition,R,!!h.namedRangeNode)];var N,I;return h.shouldAddEmptySuggestion&&(k=[(N=h.dotNotationIndex,I=h.fieldRefChainEndIndex??e.caretPosition,{label:"",kind:s.CompletionItemKind.RichEntityEmptyCellRef,type:s.SuggestionKind.Simple,detail:"",textEdit:{newText:"",range:{start:{line:0,character:N},end:{line:0,character:I}}},isPrefixed:!0}),...k]),{items:k}}static getTextToCommit(e,t,r,n){let i=e.Name;if(i=i.replace("'","''"),i=i.replace("[","'["),i=i.replace("]","']"),e.RefersToDotFunction)return`.${i}`;if(r){if(n)return`.[${i}]`;const e=t.kind===a.ComputationRequestKind.GetConfig?t.config.localeInfo:void 0;return e&&!(0,F.isUnbracketedField)(e,i)?`.[${i}]`:`.${i}`}return`.[${i}]`}resultsToCompletionItems(e,t,r,n,a,i){return e.map((e=>({label:e.Name,kind:s.CompletionItemKind.RichEntity,type:s.SuggestionKind.Simple,detail:"",textEdit:{newText:p.getTextToCommit(e,a,this.dontAlwaysAddBracketsEnabled,i),range:{start:{line:0,character:r},end:{line:0,character:n}}},isPrefixed:t})))}constructor(){this.dontAlwaysAddBracketsEnabled=(n.__runInitializers(this,h),(0,y.isChangeGateEnabled)("OfficeVSO:7765276_RichValueAutoCompleteDontAlwayAddBrackets"))}};return n.__setFunctionName(t,"AutocompleteRichValuePlugin"),(()=>{const a="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[b.uiMessageHandler({kind:E.RequestKind.functionSuggestion})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:a},null,h),n.__esDecorate(null,e={value:t},i,{kind:"class",name:t.name,metadata:a},null,o),p=t=e.value,a&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:a})})(),t.factory=b.injectPluginFactory(),n.__runInitializers(t,o),p=t})();function T(e){h.ulsLogger.ULS.traceTag(529056660,p.LogCategory.msoulscat_ES_EWAJS,p.TraceLevel.Warning,`AutocompleteRichValuePlugin encountered a failure with msg ${e}`)}t.AutocompleteRichValuePlugin=R,(0,i.registerPluginFactory)(R.factory),t.autocompleteRichValuePluginDependenciesResolved=(0,C.trackableAsyncLazy)((async()=>{const e=await o.dynamicPluginLoaderCreated.getValue();await e.createAndAttachPlugin(v.PluginFactoryName.AutocompleteRichValuePlugin),await o.schedulerWithRecalcServiceAttached.getValue()}),"autocompleteRichValuePluginDependenciesResolved")},46641:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutocompleteRichValueVisitor=void 0;const n=r(36159),a=r(57993),i=r(12973),o=r(93336),s=r(60756),u=r(91793),l=r(28276);class c extends l.CaretInsideArrayNodeIdentityVisitor{nameNode(e,t,r){const a=this.parsedFormulaTree.spans[r]?.end;if(a===this.caretPosition&&e.kind===i.NamePartKind.IdentNamePart&&this.trySetDefinedName(e)&&(this.dotNotationIndex=a,this.childFieldRefLabel=r),e.kind===i.NamePartKind.FieldRefNamePart){const r=this.parsedFormulaTree.spans[e.lhs.label]?.end;if((0,n.isDefined)(r)&&(this.caretPosition===a||this.isCaretAfterDotBeforeStartOfFieldRef(r,e.rhs)&&e.lhs.kind!==i.NamePartKind.FieldRefNamePart)){let n=!1;e.lhs.kind===i.NamePartKind.CellRefNamePart?(this.setCellRef(e.lhs.ref,t),n=!0):e.lhs.kind===i.NamePartKind.IdentNamePart&&this.trySetDefinedName(e.lhs)&&(n=!0),n&&(this.dotNotationIndex=r,e.rhs.field.kind===i.NodeKind.Ident&&(this.caretPosition===a?this.richValueItemPrefix=e.rhs.field.whole:this.fieldRefChainEndIndex=a))}}return super.nameNode(e,t,r)}cellRefNode(e,t,r){const n=this.parsedFormulaTree.spans[r]?.end;return void 0!==n&&this.caretPosition===n&&(this.setCellRef(e,t),this.dotNotationIndex=n,this.childFieldRefLabel=r,this.shouldAddEmptySuggestion=!0),super.cellRefNode(e,t,r)}fieldRefNode(e,t,r){const n=this.parsedFormulaTree.spans[r]?.end,a=this.parsedFormulaTree.spans[e.label]?.end;return void 0===n||void 0===a||(this.isCaretAtEndOfFieldRefNode(n,t)?(this.initCellRefAtFieldsRefsChainStartAndAccumulateDotNotationPath(e,r),this.dotNotationIndex=a,this.richValueItemPrefix=d(t)):this.isCaretAfterDotBeforeStartOfFieldRef(a,t)?(this.initCellRefAtFieldsRefsChainStartAndAccumulateDotNotationPath(e,r),this.dotNotationIndex=a,this.fieldRefChainEndIndex=n):e.label===this.childFieldRefLabel&&(this.fieldRefChainEndIndex=n,this.childFieldRefLabel=r)),super.fieldRefNode(e,t,r)}structRefNode(e,t,r){const a=super.structRefNode(e,t,r),s=this.parsedFormulaTree.spans[r]?.end;return this.caretPosition===s&&(0,n.isDefined)(e)&&t.isClosed&&a.kind===i.NodeKind.StructRef&&this.definedNames.some((t=>t.type===o.DefinedNameInfoType.Table&&(0,n.isDefined)(t.name)&&t.name.toLowerCase()===e.whole.toLowerCase()))&&(this.setNamedNodeRef(a),this.dotNotationIndex=s),a}initCellRefAtFieldsRefsChainStartAndAccumulateDotNotationPath(e,t){let r=e;for(;r.kind===i.NodeKind.FieldRef;)this.dotNotationPath="["+d(r.rhs)+"]."+this.dotNotationPath,r=r.lhs;r.kind===i.NodeKind.CellRef&&this.setCellRef(r.ref,r.qualifier),r.kind===i.NodeKind.StructRef&&this.setNamedNodeRef(r),r.kind===i.NodeKind.Name&&this.trySetDefinedName(r.parts),this.childFieldRefLabel=t}getRefString(e){const t=this.parsedFormulaTree.spans[e]?.start,r=this.parsedFormulaTree.spans[e]?.end;return(0,n.isDefined)(t)&&(0,n.isDefined)(r)&&t>=0&&r<this.formulaText.length?this.formulaText.substring(t,r):""}setCellRef(e,t){e.kind!==i.CellRefKind.Single&&e.kind!==i.CellRefKind.Range||(this.cellRef=(0,u.getRangeFromCellRef)(e,this.activeCell,g)),(0,n.isDefined)(t)&&(this.sheetName=(0,u.getSheetNameFromQualifier)(t,g)),this.trySetDotNotationPathOrigin((()=>this.getRefString(e.label)))}setNamedNodeRef(e){this.namedRangeNode=e,this.trySetDotNotationPathOrigin((()=>this.getRefString(e.label)))}isCaretAfterDotBeforeStartOfFieldRef(e,t){if(!(0,n.isDefined)(t))return!1;const r=this.parsedFormulaTree.spans[t.field.label]?.start;return void 0!==r&&this.caretPosition>e&&(this.caretPosition<r||!t.isBracketed&&this.caretPosition===r)}isCaretAtEndOfFieldRefNode(e,t){if(this.caretPosition===e)return!0;const r=this.parsedFormulaTree.spans[t.field.label]?.end;return!(!(0,n.isDefined)(r)||this.caretPosition!==r)}trySetDefinedName(e){if(e.canDenoteNamedObject){const t=this.definedNames.find((t=>t.name?.toLowerCase()===e.asWhole.toLowerCase()));if((0,n.isDefined)(t))return this.setDefinedName(t),!0}return!1}setDefinedName(e){const t=e.namedRange;if(!(0,n.isDefined)(t))return;const r=e.sheetName??t.sheetName;(0,n.isDefined)(r)&&(this.sheetName=r),this.cellRef={firstRow:t.top-1,firstColumn:t.left-1,lastRow:t.bottom-1,lastColumn:t.right-1},this.trySetDotNotationPathOrigin((()=>e.name))}trySetDotNotationPathOrigin(e){if(this.onlySendNestedDotNotationPathEnabled){if(this.dotNotationPath.length>0){const t=e();(0,n.isDefined)(t)?this.dotNotationPath=t+"."+this.dotNotationPath:g("tryUpdateDotNotationPath with undefined name")}}else this.dotNotationPath=e()+(this.dotNotationPath.length>0?"."+this.dotNotationPath:"")}constructor(e,t,r,n,a){super(e,t),this.formulaText=r,this.definedNames=n,this.activeCell=a,this.dotNotationPath="",this.richValueItemPrefix="",this.dotNotationIndex=0,this.shouldAddEmptySuggestion=!1,this.onlySendNestedDotNotationPathEnabled=(0,s.isTypedChangeGateEnabled)("OfficeVSO:6476056_OnlySendNestedDotNotationPath")}}function d(e){return e.field.kind!==i.NodeKind.Ident?"":e.field.whole}function g(e){a.ulsLogger.ULS.traceTag(523257827,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,`AutocompleteRichValueVisitor failed with msg: ${e}`)}t.AutocompleteRichValueVisitor=c},89395:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocompleteTableHeadersPluginDependenciesResolved=void 0;const n=r(74643),a=r(2340),i=r(44544),o=r(57993),s=r(1765),u=r(30070),l=r(4595),c=r(98468),d=r(93336),g=r(50013),m=r(36159),h=r(93336),p=r(31780),f=r(96926),S=r(12973),v=r(93336),F=r(60756),y=r(66761),C=r(20711),A=r(10048),E=r(91903),b=r(12893),R=E.PluginRegistry.create(v.PluginFactoryName.AutocompleteTableHeadersPlugin,d.PluginGroup.Excel);let T=(()=>{let e,t,r,i=[R.x10Plugin()],l=[],c=[];return t=class{*run(e){const{content:t,caretPosition:r}=e;if((0,m.isNone)(t)||(0,m.isNone)(r))return null;const n=yield{kind:a.ComputationRequestKind.ParseActiveCell,formulaText:t};if(n.kind!==a.ComputationRequestKind.ParseActiveCell||!(0,s.isSuccess)(n.result))return null;if(n.result.value.kind!==u.EditKind.Formula)return null;const{formula:i}=n.result.value,l=yield{kind:a.ComputationRequestKind.GetDefinedNamesInfo};if(l.kind!==a.ComputationRequestKind.GetDefinedNamesInfo)return this.logFailure("failed to get named objects info"),null;const c=l.definedNamesInfo.filter((e=>e.type===h.DefinedNameInfoType.Table)).map((e=>e.name)).filter(m.isDefined);if(0===c.length)return null;let d;d=this.fixAutocompleteTableHeadersBugEnabled?new p.AutocompleteTableHeadersVisitor(i,r,c):new C.AutocompleteTableHeadersVisitorOld(i,r,c),(0,g.reduceBottomUp)(d,i);let{tableName:f}=d;const{containingNode:S,isInsideArrayNode:v,isNodeClosed:F}=d;if((0,m.isNone)(S)||v)return null;if((0,m.isNone)(f)){const e=yield{kind:a.ComputationRequestKind.GetActiveCell};if(e.kind!==a.ComputationRequestKind.GetActiveCell)return this.logFailure("Couldn't get active cell"),null;const t=yield{kind:a.ComputationRequestKind.GetContainingTable,cell:e.activeCell};if(t.kind!==a.ComputationRequestKind.GetContainingTable||!(0,s.isSuccess)(t.result))return this.logFailure(`GetContainingTable request failed. result kind = ${JSON.stringify(t)}`),null;if(f=t.result.value?.name,(0,m.isNone)(f))return null}let{start:y,end:A}=S;const E=t.charAt(A-1);if("]"!==E&&")"!==E||A--,"["===t.charAt(y)&&y++,!(r===A||this.fixAutocompleteTableHeadersBugEnabled&&this.caretIsInTheBeginning(t,y,r)))return null;const b=yield{kind:a.ComputationRequestKind.GetAvailableTableHeaders,tableName:f};let R;if(b.kind!==a.ComputationRequestKind.GetAvailableTableHeaders||!(0,s.isSuccess)(b.result)||(0,m.isNone)(b.result.value)||this.getTableHeadersFromServerEnabled&&b.result.value.isPartial){if(this.getTableHeadersFromServerEnabled){o.ulsLogger.ULS.traceTag(509682331,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"AutocompleteTableHeadersPlugin getting col headers from server");const e=yield{kind:a.ComputationRequestKind.GetFullTableHeadersFromServer,tableName:f};if(e.kind!==a.ComputationRequestKind.GetFullTableHeadersFromServer||!(0,m.isDefined)(e.result))return this.logFailure("Failed to get header names from server"),null;R=e.result}}else R=b.result.value.cols;if(!(0,m.isDefined)(R)||0===R.length)return null;let T="";this.fixAutocompleteTableHeadersBugEnabled&&this.caretIsInTheBeginning(t,y,r)?A=F?A:y:T=t.substring(y,A);const k=yield{kind:a.ComputationRequestKind.GetConfig};return k.kind!==a.ComputationRequestKind.GetConfig?(this.logFailure("getConfig request failed"),null):{items:this.getCompletionItems(R,T,y,A,d.isWithinThisRowOp,k.config.localeInfo.specialRefNames)}}caretIsInTheBeginning(e,t,r){return 0===e.substring(t,r).trim().length}generateCompletionItems(e,t,r,n,a,i){const o=[];return e.forEach((e=>{const s="string"==typeof e,u=s?e:e.name,l=s?void 0:e.description;o.push({label:u,kind:a,type:d.SuggestionKind.Simple,textEdit:{newText:(0,m.isDefined)(i)?i(u):u,range:{start:{line:0,character:t},end:{line:0,character:r}}},detail:l,isPrefixed:n})})),o}generateHeadersCompletionItems(e,t,r,n,a=!1){const{prefixedSuggestions:i,notPrefixedSuggestions:o}=(0,f.filterSuggestionsAccordingToPrefix)(e,t),s=this.getHeaderTextEditCallback(a);return[...this.generateCompletionItems(i,r,n,!0,d.CompletionItemKind.TableHeader,s),...this.generateCompletionItems(o,r,n,!1,d.CompletionItemKind.TableHeader,s)]}generateSpecialCaseCompletionItems(e,t,r,n){const a=[S.SpecialRefId.All,S.SpecialRefId.Data,S.SpecialRefId.Headers,S.SpecialRefId.Totals].map((e=>({name:n[e]??"",description:k.getValue()[e]}))),{prefixedSuggestions:i,notPrefixedSuggestions:o}=(0,f.filterSuggestionsAccordingToPrefix)(r,a,(e=>e.name));return[...this.generateCompletionItems(i,e,t,!0,d.CompletionItemKind.TableSpecialStructRef),...this.generateCompletionItems(o,e,t,!1,d.CompletionItemKind.TableSpecialStructRef)]}generateThisRowOpCompletionItem(e,t,r){return{label:`@ - ${r}`,kind:d.CompletionItemKind.TableSpecialStructRef,type:d.SuggestionKind.Simple,textEdit:{newText:"@",range:{start:{line:0,character:e},end:{line:0,character:t}}},detail:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThisRowOpDescription),shouldRequestAutocompleteOnCommit:!0}}logFailure(e){o.ulsLogger.ULS.traceTag(526508764,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,`AutocompleteTableHeadersPlugin encountered a failure with msg ${e}`)}constructor(){this.getTableHeadersFromServerEnabled=(n.__runInitializers(this,c),(0,F.isTypedChangeGateEnabled)("OfficeVSO:7396249_getTableHeadersFromServer")),this.fixAutocompleteTableHeadersBugEnabled=(0,y.isChangeGateEnabled)("OfficeVSO:7899833_fixAutocompleteTableHeadersBug"),this.getCompletionItems=(e,t,r,n,a,i)=>{const o="@"===t.charAt(0);if(o||a){const a=o?r+1:r,i=o?t.substring(1):t;return this.generateHeadersCompletionItems(i,e,a,n,!0)}const s=[];if(""===t){const e=i[S.SpecialRefId.ThisRow]?.substring(1);this.fixAutocompleteTableHeadersBugEnabled?s.push(this.generateThisRowOpCompletionItem(r,r,e)):s.push(this.generateThisRowOpCompletionItem(r,n,e))}return s.push(...this.generateSpecialCaseCompletionItems(r,n,t,i)),s.push(...this.generateHeadersCompletionItems(t,e,r,n)),s},this.getHeaderTextEditCallback=e=>t=>{const r=N(t);return e&&this.hasSpecialChars(r)?`[${r}]`:r},this.hasSpecialChars=e=>{try{return new RegExp("(?=\\P{L})(?=\\P{M})(?=\\P{N})","u").test(e)}catch(e){return this.logFailure(`hasSpecialChars method, error: ${e}.`),!0}}}},n.__setFunctionName(t,"AutocompleteTableHeadersPlugin"),(()=>{const a="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[R.uiMessageHandler({kind:b.RequestKind.functionSuggestion})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:a},null,c),n.__esDecorate(null,e={value:t},i,{kind:"class",name:t.name,metadata:a},null,l),t=e.value,a&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:a})})(),t.factory=R.injectPluginFactory(),n.__runInitializers(t,l),t})();(0,i.registerPluginFactory)(T.factory),t.autocompleteTableHeadersPluginDependenciesResolved=(0,A.trackableAsyncLazy)((async()=>{const e=(0,F.isTypedChangeGateEnabled)("OfficeVSO:7396249_getTableHeadersFromServer")?await c.dynamicPluginLoaderCreated.getValue():await c.autoCompletePluginsThread.getValue();await e.createAndAttachPlugin(v.PluginFactoryName.AutocompleteTableHeadersPlugin),await c.schedulerWithRecalcServiceAttached.getValue()}),"autocompleteTableHeadersPluginDependenciesResolved");const k=new l.ResettableLazy((()=>({[S.SpecialRefId.All]:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SpecialRefAllDescription),[S.SpecialRefId.Data]:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SpecialRefDataDescription),[S.SpecialRefId.Headers]:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SpecialRefHeadersDescription),[S.SpecialRefId.Totals]:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SpecialRefTotalsDescription),[S.SpecialRefId.ThisRow]:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThisRowOpDescription)}))),N=e=>e.replace(/\[|\]|\'|\@|\#/g,"'$&")},31780:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutocompleteTableHeadersVisitor=void 0;const n=r(36159),a=r(12973),i=r(28276);class o extends i.CaretInsideArrayNodeIdentityVisitor{structRefNode(e,t,r){if(this.isCaretInNode(t)){e&&this.tableNames.forEach((t=>{t.toLocaleLowerCase()===e.whole.toLocaleLowerCase()&&(this.tableName=t)}));const r=this.parsedFormulaTree.spans[t.label];this.isNodeClosed=this.isStructRefClosed=t.isClosed,this.containingNode=r,void 0!==t.innerRef&&this.findContainingNode(t.innerRef)}return super.structRefNode(e,t,r)}getIsNodeClosed(e){return e.isBracketed?e.isClosed:this.isStructRefClosed}isCaretInNode(e){const t=this.parsedFormulaTree.spans[e.label];return(0,n.isDefined)(t)&&this.caretPosition<=t.end&&this.caretPosition>=t.start}isCaretInBeginningOfNode(e){return(0,n.isDefined)(e)&&this.caretPosition===e.start}constructor(e,t,r){super(e,t),this.tableNames=r,this.isWithinThisRowOp=!1,this.isStructRefClosed=!1,this.isNodeClosed=!1,this.findContainingNode=e=>{const t=this.parsedFormulaTree.spans[e.label];if(this.isCaretInNode(e))switch(e.kind){case a.StructRefKind.SpecialRef:case a.StructRefKind.ColumnRef:case a.StructRefKind.BadRef:this.isTighterThanCurrent(t)&&(this.containingNode=t,this.isNodeClosed=this.getIsNodeClosed(e));break;case a.StructRefKind.ThisRowOpRef:const r=e.ref;if(this.isCaretInBeginningOfNode(t))break;this.isWithinThisRowOp=!0,(0,n.isDefined)(r)?this.findContainingNode(r):this.isTighterThanCurrent(t)&&(this.containingNode=t,this.isNodeClosed=this.isStructRefClosed);break;case a.StructRefKind.CommaOpRef:if(this.isCaretInBeginningOfNode(t))break;e.refs.map(this.findContainingNode);break;case a.StructRefKind.RangeOpRef:if(this.isCaretInBeginningOfNode(t))break;const i=e;this.findContainingNode(i.lhs),this.findContainingNode(i.rhs);break;case a.StructRefKind.MissingRef:this.containingNode=void 0}},this.isTighterThanCurrent=e=>(0,n.isDefined)(e)&&((0,n.isNone)(this.containingNode)||e.end<this.containingNode.end||e.start>this.containingNode.start)}}t.AutocompleteTableHeadersVisitor=o},20711:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutocompleteTableHeadersVisitorOld=void 0;const n=r(36159),a=r(12973),i=r(28276);class o extends i.CaretInsideArrayNodeIdentityVisitor{structRefNode(e,t,r){return this.isCaretInNode(t)&&(e&&this.tableNames.forEach((t=>{t.toLocaleLowerCase()===e.whole.toLocaleLowerCase()&&(this.tableName=t)})),void 0===t.innerRef?this.containingNode=this.parsedFormulaTree.spans[t.label]:this.findContainingNode(t.innerRef)),super.structRefNode(e,t,r)}isCaretInNode(e){const t=this.parsedFormulaTree.spans[e.label];return(0,n.isDefined)(t)&&this.caretPosition<=t.end&&this.caretPosition>=t.start}constructor(e,t,r){super(e,t),this.tableNames=r,this.isWithinThisRowOp=!1,this.isNodeClosed=!1,this.findContainingNode=e=>{const t=this.parsedFormulaTree.spans[e.label];if(this.isCaretInNode(e))switch(e.kind){case a.StructRefKind.SpecialRef:case a.StructRefKind.ColumnRef:case a.StructRefKind.BadRef:this.isTighterThanCurrent(t)&&(this.containingNode=t);break;case a.StructRefKind.ThisRowOpRef:const r=e.ref;this.isWithinThisRowOp=!0,(0,n.isDefined)(r)?this.findContainingNode(r):this.isTighterThanCurrent(t)&&(this.containingNode=t);break;case a.StructRefKind.CommaOpRef:e.refs.map(this.findContainingNode);break;case a.StructRefKind.RangeOpRef:const i=e;this.findContainingNode(i.lhs),this.findContainingNode(i.rhs);break;case a.StructRefKind.MissingRef:this.containingNode=void 0}},this.isTighterThanCurrent=e=>(0,n.isDefined)(e)&&((0,n.isNone)(this.containingNode)||e.end<this.containingNode.end||e.start>this.containingNode.start)}}t.AutocompleteTableHeadersVisitorOld=o},89293:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionShortDescriptions=void 0;const n=r(27437),a=r(4595),i=r(73701),o=r(82438),s=r(60756);t.functionShortDescriptions=new a.ResettableLazy((()=>{try{const e=new Map,t={};for(const r of Object.keys(n.WorksheetFuncId)){const a=Number(r);if(!isNaN(Number(a))){const r=FormulaAuthoringStrings[n.WorksheetFuncId[a]+"ShortDescription"];e.set(a.toString(),r),t[a.toString()]=r}}return(0,s.isTypedChangeGateEnabled)("Microsoft.Office.Excel.UseObjectInsteadOfMapForFunctionShortDescriptions")?{descriptionMap:t}:{descriptionMap:e}}catch(e){return i.ulsLogger.ULS.traceTag(538792415,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`failed to get functionShortDescriptionsMap with exception ${e}`),{}}}))},9319:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeEventCallbacksManager=t.makeALAnnotationNotifier=t.makeEventEmitter=t.isALAnnotationEventKind=t.ALAnnotationKinds=t.ExternallyHandledEventKinds=t.ExternallyTriggeredEventKinds=t.ALAnnotationKind=t.EventKind=void 0;const n=r(36159),a=r(46870);var i,o;!function(e){e.InternalTestEvent="InternalTestEvent",e.TestEvent="TestEvent",e.FBECacheUpdateEvent="FBECacheUpdateEvent",e.FBESendSignal="FBESendSignal",e.FBEOutcomeUpdate="FBEOutcomeUpdate",e.FBECacheUpdateEventDeprecated="FBECacheUpdateEventDeprecated",e.FormulaTranspilerInitEvent="FormulaTranspilerInitEvent"}(i||(t.EventKind=i={})),function(e){e.FormulaByExample="FormulaByExample"}(o||(t.ALAnnotationKind=o={})),t.ExternallyTriggeredEventKinds=[i.TestEvent,i.FBEOutcomeUpdate,i.FormulaTranspilerInitEvent],t.ExternallyHandledEventKinds=[i.TestEvent],t.ALAnnotationKinds=(0,n.strEnumArray)(o),t.isALAnnotationEventKind=e=>t.ALAnnotationKinds.findIndex((t=>e===t))>=0,(0,n.staticAssertSame)(),(0,n.staticAssertSame)(),(0,n.staticAssertSame)(),(0,n.staticAssertSame)(),(0,n.staticAssertSame)(),(0,n.staticAssertSame)(),t.makeEventEmitter=function(e){return(0,a.mapFromArrayOfDependantPairs)(t.ExternallyTriggeredEventKinds.map((t=>[t,r=>e.triggerEvent(t,r).then((()=>{}))])))},t.makeALAnnotationNotifier=function(e){const r=t=>r=>(0,n.isNone)(r)?Promise.resolve(null):Promise.resolve(e.triggerEvent(t,r));(0,n.staticAssertExtends)();const a={};for(const e of t.ALAnnotationKinds)a[e]=r(e);return a},t.makeEventCallbacksManager=async function(){const e=(0,a.mapFromArrayOfDependantPairs)(t.ExternallyHandledEventKinds.map((e=>[e,[]]))),r=t=>r=>{for(const n of e[t])n(r)};return{registerEventCallback:(t,r)=>e[t].push(r),...(0,a.mapFromArrayOfDependantPairs)(t.ExternallyHandledEventKinds.map((e=>[e,r(e)])))}}},77829:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ALAnnotationKind=t.EventKind=void 0;var n=r(9319);Object.defineProperty(t,"EventKind",{enumerable:!0,get:function(){return n.EventKind}}),Object.defineProperty(t,"ALAnnotationKind",{enumerable:!0,get:function(){return n.ALAnnotationKind}})},12893:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultPluginResponseWindows=t.RequestKind=void 0;var n=r(31712);Object.defineProperty(t,"RequestKind",{enumerable:!0,get:function(){return n.RequestKind}}),Object.defineProperty(t,"defaultPluginResponseWindows",{enumerable:!0,get:function(){return n.defaultPluginResponseWindows}})},31712:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeSyncRequester=t.makeLocalRequester=t.makeRequester=t.requestKindCellContentNamesMap=t.defaultPluginResponseWindows=t.RequestKind=void 0;const n=r(36159),a=r(2340),i=r(60756);var o;!function(e){e.functionSuggestion="functionSuggestion",e.inCellSuggestion="inCellSuggestion",e.formulaHighlighting="formulaHighlighting",e.argumentAssistance="argumentAssistance",e.valuePreview="valuePreview",e.gotoCtrlClick="gotoCtrlClick",e.runExperiment="runExperiment",e.runAuthoringExperiment="runAuthoringExperiment",e.runPerCharacterExperiment="runPerCharacterExperiment",e.runTest="runTest",e.formulaRepair="formulaRepair",e.chatGPTQuery="chatGPTQuery",e.columnFormulaSuggestion="columnFormulaSuggestion",e.setCellPrefetch="setCellPrefetch",e.getTranspiledFormulas="getTranspiledFormulas",e.inCellControlsAutodetection="inCellControlsAutodetection"}(o||(t.RequestKind=o={})),(0,n.staticAssertExtends)(),(0,n.staticAssertExtends)(),t.defaultPluginResponseWindows={[o.functionSuggestion]:{startDelta:5,stopDelta:2e3},[o.inCellSuggestion]:{startDelta:5,stopDelta:2e3},[o.formulaHighlighting]:{startDelta:5,stopDelta:2e3},[o.argumentAssistance]:{startDelta:5,stopDelta:2e3},[o.valuePreview]:{startDelta:5,stopDelta:2e3},[o.gotoCtrlClick]:{startDelta:5,stopDelta:2e3},[o.formulaRepair]:{startDelta:5,stopDelta:2e3},[o.runExperiment]:{startDelta:0,stopDelta:15e3},[o.runAuthoringExperiment]:{startDelta:0,stopDelta:15e3},[o.runPerCharacterExperiment]:{startDelta:5,stopDelta:2e3},[o.runTest]:{startDelta:0,stopDelta:15e3},[o.chatGPTQuery]:{startDelta:0,stopDelta:15e3},[o.columnFormulaSuggestion]:{startDelta:0,stopDelta:2e4},[o.setCellPrefetch]:{startDelta:(0,i.isTypedChangeGateEnabled)("OfficeVSO:9150789_CancelSuppressedRequests")?100:5,stopDelta:2e3},[o.getTranspiledFormulas]:{startDelta:0,stopDelta:5e3},[o.inCellControlsAutodetection]:{startDelta:0,stopDelta:2e3}},n.staticAssertSame,t.requestKindCellContentNamesMap={[o.functionSuggestion]:"content",[o.inCellSuggestion]:"content",[o.formulaHighlighting]:"content",[o.argumentAssistance]:"content",[o.valuePreview]:"text",[o.runAuthoringExperiment]:"content",[o.runPerCharacterExperiment]:"content",[o.formulaRepair]:"formula",[o.gotoCtrlClick]:"text",[o.columnFormulaSuggestion]:void 0,[o.setCellPrefetch]:void 0,[o.runExperiment]:void 0,[o.runTest]:void 0,[o.chatGPTQuery]:void 0,[o.getTranspiledFormulas]:void 0,[o.inCellControlsAutodetection]:void 0},t.makeRequester=function(e){const t=t=>(...[r,i,o])=>(0,n.isNone)(r)?Promise.resolve(null):Promise.resolve(e.doRequest(t,r,i,o??a.DefaultComputationGroup));return{argumentAssistance:t(o.argumentAssistance),chatGPTQuery:t(o.chatGPTQuery),columnFormulaSuggestion:t(o.columnFormulaSuggestion),formulaHighlighting:t(o.formulaHighlighting),formulaRepair:t(o.formulaRepair),functionSuggestion:t(o.functionSuggestion),gotoCtrlClick:t(o.gotoCtrlClick),inCellSuggestion:t(o.inCellSuggestion),runAuthoringExperiment:t(o.runAuthoringExperiment),runExperiment:t(o.runExperiment),runPerCharacterExperiment:t(o.runPerCharacterExperiment),runTest:t(o.runTest),valuePreview:t(o.valuePreview),setCellPrefetch:t(o.setCellPrefetch),getTranspiledFormulas:t(o.getTranspiledFormulas),inCellControlsAutodetection:t(o.inCellControlsAutodetection)}},t.makeLocalRequester=function(e){return{runTest:(t,r,n)=>Promise.resolve(e.doRequest(o.runTest,t,r,n??a.DefaultComputationGroup)),columnFormulaSuggestion:(t,r,n)=>Promise.resolve(e.doRequest(o.columnFormulaSuggestion,t,r,n??a.DefaultComputationGroup))}},t.makeSyncRequester=function(e){return{runTest:(t,r,i)=>(0,n.isNone)(t)?null:e.doSyncRequest(o.runTest,t,r,i??a.DefaultComputationGroup),formulaHighlighting:(t,r,i)=>(0,n.isNone)(t)?null:e.doSyncRequest(o.formulaHighlighting,t,r,i??a.DefaultComputationGroup)}}},44700:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ComputationKinds=t.ComputationType=void 0;const n=r(36159),a=r(9319),i=r(31712);var o;!function(e){e.UIMessage="UIMessage",e.Event="Event"}(o||(t.ComputationType=o={})),t.ComputationKinds={[o.UIMessage]:i.RequestKind,[o.Event]:{...a.EventKind,...a.ALAnnotationKind}},(0,n.staticAssertSame)(),(0,n.staticAssertExtends)(),(0,n.staticAssertExtends)(),(0,n.staticAssertExtends)()},15787:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFormulaContent=t.isFormulaRequest=t.getShouldRunComputationPredicate=t.computationRegistry=t.registerComputation=t.deletePluginRegistration=t.wrapRegistration=void 0;const n=r(36159),a=r(44700),i=r(46870),o=r(78663),s=r(56134),u=r(31712);class l{push(e,t){this.registeredComputations.get(t)?o.ulsLogger.ULS.traceTag(507330770,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,`Computation '${JSON.stringify(t.computationIdentifier)}' already registered`):(this.byFactoryName.get(e).push(t),this.registeredComputations.set(t,!0))}getRegistrationsByPluginIdentifier(e){return this.byFactoryName.get(e)}getRegistrationByComputationIdentifier(e){return this.getRegistrationsByPluginIdentifier(e).find((t=>t.computationIdentifier.computationName===e.computationName))}deleteRegistrationsByPluginIdentifier(e){let t=0;for(const r of this.byFactoryName.get(e))this.registeredComputations.delete(r),t++;return this.byFactoryName.delete(e),t}constructor(){this.registeredComputations=new i.DefaultMap({getKey:e=>`${e.computationIdentifier.factoryName}.${e.computationIdentifier.pluginName}.${e.computationIdentifier.computationName}.${e.computationIdentifier.executionMode.time}`,getDefault:()=>!1}),this.byFactoryName=new i.DefaultMap({getKey:e=>`${e.factoryName}.${e.pluginName}`,getDefault:()=>[]})}}const c=(0,i.mapFromArrayOfDependantPairs)((0,n.strEnumArray)(a.ComputationType).map((e=>[e,new l])));function d(e,t){return function(r,n){for(const t of h)if(!t({registration:e,input:r,pluginGroup:n}))return!1;return void 0===t||t(r,n)}}function g(e){return void 0!==u.requestKindCellContentNamesMap[e]}function m(e){const t=u.requestKindCellContentNamesMap[e[0]];(0,i.staticTypeHint)(t);const r=e[1][t];return(0,i.staticTypeHint)(r),r}t.wrapRegistration=(e,t,r,n,a,i,o,s)=>{const u=d({type:e,kind:t,pluginGroup:n,modifiers:i},s);return{type:e,kind:t,execution:r,pluginGroup:n,computationIdentifier:a,modifiers:i,registrationMethod:(n,i)=>([s,l])=>{if(!u(s.computationInput,l))return void n.addResult({type:e,computationKind:t,computationIdentifier:a,computationGroup:s.computationGroup,correlationId:s.correlationId},{kind:"Skipped"});const c=o.bind(i);n.startComputation(e,t,r,a,c(s.computationInput),s)}}},t.deletePluginRegistration=e=>{let t=0;for(const r of(0,n.strEnumArray)(a.ComputationType))t+=c[r].deleteRegistrationsByPluginIdentifier(e);t>0&&s.x10Logger.log({kind:"failure",payload:{failureKind:s.X10FailureKind.PluginAttachmentFailure,failureLevel:o.TraceLevel.Warning,path:"deletePluginRegistration",description:"Deleted plugin registration",data:e}})},t.registerComputation=(e,r,n,a,i,o,s,u)=>{const l=(0,t.wrapRegistration)(e,r,n,a,i,o,s,u);c[e].push(i,l)},t.computationRegistry=c,t.getShouldRunComputationPredicate=d,t.isFormulaRequest=g,t.getFormulaContent=m;const h=[({registration:e,pluginGroup:t})=>void 0===t||t===e.pluginGroup,({registration:e,input:t})=>{if(e.type!==a.ComputationType.UIMessage||e.modifiers.runOnNonFormula)return!0;if((0,i.staticTypeHint)(e.kind),!g(e.kind))return!0;const r=[e.kind,t];(0,i.staticTypeHint)(r);const n=m(r);return-1!==["=","+","-"].indexOf(n[0])}]},25722:function(e,t){"use strict";var r,n;Object.defineProperty(t,"__esModule",{value:!0}),t.syncGlobalExecutionMode=t.asyncGlobalExecutionMode=t.ExecutionSpaceMode=t.ExecutionTimeMode=void 0,function(e){e.Sync="Sync",e.Async="Async"}(r||(t.ExecutionTimeMode=r={})),function(e){e.Local="Local",e.Global="Global"}(n||(t.ExecutionSpaceMode=n={})),t.asyncGlobalExecutionMode={time:r.Async,space:n.Global},t.syncGlobalExecutionMode={time:r.Sync,space:n.Global}},10303:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FormulaAuthoringHelperSingleton=void 0;const n=r(36159),a=r(97808);t.FormulaAuthoringHelperSingleton=(0,n.singleton)((()=>new a.FormulaAuthoringHelper))},97808:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FormulaAuthoringHelper=void 0;const n=r(36159),a=r(57993),i=r(47943),o=r(31234),s=r(13611);t.FormulaAuthoringHelper=class{getMinimalParamArray(e,t){if((0,n.isNone)(t))return;const{minArgs:r,restTypes:a}=(0,s.getWorksheetFuncTypeWrapper)(t),i=a.length>0?Math.max(r,2):e?.length??0,o=[];for(let r=0;r<i;r+=1){const a=this.getFunctionParamByIndex(e,t,r);(0,n.isDefined)(a)&&o.push(a)}return o}getFunctionParamByIndex(e,t,r){if((0,n.isNone)(t))return;const a=(0,s.getWorksheetFuncTypeWrapper)(t),o=a.headTypes.length,u=t.ParamsHelp.split("!"),l=(0,i.getParamIndexToHighlight)(r,e.length,a,!1,!0);if(-1===l)return void this.logError("Trying to get param by index that is out of bounds");if(l>=e.length)return void this.logError("Trying to add param for a signature that doesn't have rest params.");const c=r<o?e[l].match(/[^\[\]]+/).toString():`${(0,i.getBaseParamName)(e[l])}${(0,i.getParamNumberSuffix)(r,o,a.restTypes.length)}`,d=u[(0,i.getParamIndexToHighlight)(r,t.ParamsHelp.split("!").length,a)];return{name:c,isOptional:r>=a.minArgs,description:d,type:"TO DO"}}getFormulaAnonymizer(e){const t=new o.ConsistentAnonymizer;return{anonymize:(r,a)=>{try{return i=r,(0,n.isDefined)(i)&&"string"==typeof i?function(e){return(0,n.isDefined)(e)&&"object"==typeof e&&"localeInfo"in e&&"mathpack"in e&&"refStyle"in e}(e)?function(e){return(0,n.isDefined)(e)&&"object"==typeof e&&"row"in e&&"col"in e&&1===e.rows&&1===e.cols}(a)?t.anonymize(r,e,a):(this.logError("getFormulaAnonymizer: Origin"),null):(this.logError("getFormulaAnonymizer: Config"),null):(this.logError("getFormulaAnonymizer: Formula"),null)}catch(e){return this.logError(`getFormulaAnonymizer: ${e}`),null}var i}}}logError(e){a.ulsLogger.ULS.traceTag(512331973,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Error,`FormulaAuthoringHelper error: ${e}`)}constructor(){this.hasRepeatingParams=e=>(0,n.isNone)(e)?(this.logError("hasRepeatingParams: funcInfo is null or undefined"),!1):(0,s.getWorksheetFuncTypeWrapper)(e).restTypes.length>0}}},13611:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getWorksheetFuncTypeWrapper=void 0;const n=r(27437),a=r(27437);t.getWorksheetFuncTypeWrapper=function(e){return i(e)?o[e.FunctionIndexInServer][e.signatureIndex]:(0,a.getWorksheetFuncType)(e.FunctionIndexInServer)};const i=e=>{if(void 0===e)return!1;const{FunctionIndexInServer:t,signatureIndex:r}=e;return!(0!==r&&1!==r||t!==n.WorksheetFuncId.AGGREGATE&&t!==n.WorksheetFuncId.INDEX&&t!==n.WorksheetFuncId.LOOKUP)},o={[n.WorksheetFuncId.AGGREGATE]:[{headTypes:[1,1,48,17],restTypes:[],tailTypes:[],minArgs:3,maxArgs:4},{headTypes:[1,1],restTypes:[16],tailTypes:[],minArgs:3,maxArgs:255}],[n.WorksheetFuncId.INDEX]:[{headTypes:[48,1,1],restTypes:[],tailTypes:[],minArgs:2,maxArgs:3},{headTypes:[48,1,1,1],restTypes:[],tailTypes:[],minArgs:2,maxArgs:4}],[n.WorksheetFuncId.LOOKUP]:[{headTypes:[263,48,48],restTypes:[],tailTypes:[],minArgs:2,maxArgs:3},{headTypes:[263,48],restTypes:[],tailTypes:[],minArgs:2,maxArgs:2}]}},31234:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConsistentAnonymizer=void 0;const n=r(44783),a=r(1395),i=r(12973),o=r(83970),s=r(73701);class u{get(e,t,r){if(e===a.TokenKind.Literal){if(void 0===r)throw new Error("Expected subkind");return this.literalStore.get(r)?.get(t)}return this.nonLiteralStore.get(e)?.get(t)}set(e,t,r,n){if(e===a.TokenKind.Literal){if(void 0===n)throw new Error("Expected subkind");const e=this.literalStore.get(n)??new Map;e.set(t,r),this.literalStore.set(n,e)}else{const n=this.nonLiteralStore.get(e)??new Map;n.set(t,r),this.nonLiteralStore.set(e,n)}}constructor(){this.nonLiteralStore=new Map,this.literalStore=new Map}}t.ConsistentAnonymizer=class{getAnonymization(e,t,r,n){const a=this.store.get(e,r,t);if(void 0!==a)return a;const i=n(this.counter);return this.counter+=1,this.store.set(e,r,i,t),i}anonymizeIdent(e,t,r,n){const i=t??e.start,o=r?.localeInfo.getWorksheetFuncId(e.chars);if(void 0!==o&&function(e){return void 0!==e&&e.kind===a.TokenKind.Left&&e.value===a.DelimId.Paren}(n))return(0,a.identToken)(i,e.chars);const s=this.getAnonymization(e.kind,void 0,e.chars,(e=>`ident${e}`));return(0,a.identToken)(i,s)}anonymizeA1CellRef(e,t){if(e.refStyle!==i.RefStyle.A1)throw new Error("Expected RefStyle.A1");const r=t??e.start,n=this.getAnonymization(e.kind,void 0,e.chars,(e=>`A${e}`));return(0,a.cellRefA1Token)(r,n,void 0,void 0)}anonymizeR1C1CellRef(e,t){if(e.refStyle!==i.RefStyle.R1C1)throw new Error("Expected RefStyle.R1C1");const r=t??e.start,n=this.getAnonymization(e.kind,void 0,e.chars,(e=>`R${e}C${e}`));return(0,a.cellRefR1C1Token)(r,n,void 0,void 0)}anonymizeCellRef(e,t){return e.refStyle===i.RefStyle.A1?this.anonymizeA1CellRef(e,t):this.anonymizeR1C1CellRef(e,t)}anonymizeLiteral(e,t){const r=t??e.start;let n;switch(e.oper.kind){case o.OperKind.Number:n=this.getAnonymization(e.kind,e.oper.kind,e.chars,(e=>`${e}`));break;case o.OperKind.String:n=this.getAnonymization(e.kind,e.oper.kind,e.chars,(e=>`"s${e}"`));break;case a.TokenOperKind.BadNumber:n=this.getAnonymization(e.kind,e.oper.kind,e.chars,(e=>`1e${e}000`));break;case a.TokenOperKind.BadError:n=this.getAnonymization(e.kind,e.oper.kind,e.chars,(e=>{const t=["a"],r="a".charCodeAt(0);let n=e;for(;n>0;){const a=e%10,i=String.fromCharCode(r+a);t.push(i),n=Math.floor(n/10)}return`#${t.join("")}`}));break;case o.OperKind.Boolean:case o.OperKind.Error:n=e.chars;break;default:(0,s.assertNever)("error",e.oper)}const i=e.oper,u=e.hasRight;return(0,a.literalToken)(r,n,i,u)}anonymizeToken(e,t,r,n){switch(e.kind){case a.TokenKind.Ident:return this.anonymizeIdent(e,t,r,n);case a.TokenKind.CellRef:return this.anonymizeCellRef(e,t);case a.TokenKind.Literal:return this.anonymizeLiteral(e,t);case a.TokenKind.Unexpected:return function(e,t){const r=t??e.start;return"\t"===e.chars||";"===e.chars?(0,a.unexpectedToken)(r,e.chars):(0,a.unexpectedToken)(r,"\t")}(e,t);case a.TokenKind.SingleLineComment:return(0,a.singleLineCommentToken)(t,"redacted");case a.TokenKind.MultiLineComment:return(0,a.multiLineCommentToken)(t,"redacted",e.isClosed);case a.TokenKind.End:case a.TokenKind.Left:case a.TokenKind.Right:case a.TokenKind.Sep:case a.TokenKind.Operator:case a.TokenKind.Spaces:case a.TokenKind.SpecialRef:case a.TokenKind.Escape:return{...e,start:t};default:return(0,s.assertNever)("ConsistentAnonymizer.anonymizeToken",e)}}anonymize(e,t,r){const a=(0,n.tokenizeFormula)(t.localeInfo,t.mathpack,t.refStyle,r,e,0,{}),i=[];let o=0;for(let e=0;e<a.length;e+=1){const r=a[e],n=e+1<a.length?a[e+1]:void 0,s=this.anonymizeToken(r,o,t,n);o+=s.chars.length,i.push(s)}return i.map((e=>e.chars)).join("")}constructor(){this.store=new u,this.counter=1}}},40431:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formulaCollectionPluginDependenciesResolved=t.combineSplitCollectedFormulaLogs=t.deserializeSplitCollectedFormulaLog=t.FormulaCollectionPlugin=void 0;const n=r(74643),a=r(2340),i=r(44544),o=r(57993),s=r(1765),u=r(30070),l=r(60140),c=r(82438),d=r(31234),g=r(97729),m=r(68954),h=r(92587),p=r(98468),f=r(93336),S=r(10048),v=r(91903),F=r(12893);function y(e){o.ulsLogger.ULS.traceTag(537962337,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Verbose,e)}const C=v.PluginRegistry.create(f.PluginFactoryName.FormulaCollectionPlugin,f.PluginGroup.Excel);let A=(()=>{let e,t,r,i=[C.x10Plugin()],p=[],S=[];var v=t=class{getEditEntry(e,t){const r={content:e,cell:t};if(void 0===this.lastEdit||!(0,h.isSheetGridCellEqual)(this.lastEdit.cell,t)||this.lastEdit.content!==e)return this.lastEdit=r,r}anonymizeSheetId(e){if(this.sheetIdAnonymization.has(e))return this.sheetIdAnonymization.get(e);const t=(0,c.getNewGuid)()[0];return this.sheetIdAnonymization.set(e,t),t}*run(e){const t=yield{kind:a.ComputationRequestKind.GetActiveCell};if(t.kind!==a.ComputationRequestKind.GetActiveCell)return y(T.GetActiveCell),null;const r=t.activeCell;if(null==e.content)return y(T.EmptyContent),null;if(!e.content.trimLeft().startsWith("="))return null;const n=this.getEditEntry(e.content,r);if(void 0===n)return null;const i=yield{kind:a.ComputationRequestKind.GetConfig};if(i.kind!==a.ComputationRequestKind.GetConfig)return y(T.GetConfig),null;const c=i.config,d=(0,g.createAnalyzeGlobals)(c),h=(0,l.lexicalSourceCell)(n.cell),p=(0,g.analyzeLocalsGrid)(h.kind,h.range),f=(0,m.createAnalyzer)(d),S=this.consistentAnonymizer.anonymize(n.content,c,r.range),F=yield{kind:a.ComputationRequestKind.ParseEdit,cell:n.cell,formulaBarText:S};if(F.kind!==a.ComputationRequestKind.ParseEdit||!(0,s.isSuccess)(F.result))return y(T.ParseEdit),null;if(F.result.value.kind!==u.EditKind.Formula)return null;const C=F.result.value.formula,A=C.isWellFormed;let E;if(!A){const e=f.checkFormulaWithDiagnostics(p,C);if((0,s.isSuccess)(e)){const t=e?.value[1];void 0!==t&&(E=function(e,t){const r={},n={};return Object.keys(e).forEach((a=>{const i=Number(a),o=e[i];void 0!==o&&(r[a]=o);const s=t.spans[i];void 0!==s&&(n[a]=s)})),{spanDiagnostics:r,spans:n}}(t,C))}}const k=yield{kind:a.ComputationRequestKind.GetCorrelationId};if("GetCorrelationId"!==k.kind)return null;const N=k.correlationId;return function(e){const t=function(e){let t=JSON.stringify(e),r=0;const n=[];for(;t.length>0;){const[a,i]=R(t,r,e.i);t=i,r+=1,n.push(a)}return n}(e);for(const e of t){const t=b(e);o.ulsLogger.ULS.dnmTraceTag(537962336,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,t)}}({v:v.formulaCollectionVersion,f:S,ok:A,d:E,c:{s:this.anonymizeSheetId(n.cell.sheet.index),c:n.cell.range.col,r:n.cell.range.row},i:N}),null}constructor(){this.lastEdit=void n.__runInitializers(this,S),this.lastEdit=void 0,this.consistentAnonymizer=new d.ConsistentAnonymizer,this.sheetIdAnonymization=new Map}};return n.__setFunctionName(t,"FormulaCollectionPlugin"),(()=>{const a="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[C.uiMessageHandler({kind:F.RequestKind.functionSuggestion})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:a},null,S),n.__esDecorate(null,e={value:t},i,{kind:"class",name:t.name,metadata:a},null,p),v=t=e.value,a&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:a})})(),t.factory=C.injectPluginFactory(),t.factoryName=f.PluginFactoryName.FormulaCollectionPlugin,t.formulaCollectionVersion=1,n.__runInitializers(t,p),v=t})();t.FormulaCollectionPlugin=A;const E=2300;function b(e){return e.correlationId.toString()+","+e.logPartId.toString()+","+e.partialMessage}function R(e,t,r){const n=r.toString().length+t.toString().length+2,a=E-n;return[{correlationId:r,logPartId:t,partialMessage:e.slice(0,a)},e.slice(a)]}var T;t.deserializeSplitCollectedFormulaLog=function(e){let t=e,r=t.indexOf(",");const n=Number(t.slice(0,r));return t=t.slice(r+1),r=t.indexOf(","),{correlationId:n,logPartId:Number(t.slice(0,r)),partialMessage:t.slice(r+1)}},t.combineSplitCollectedFormulaLogs=function(e){const t=e.sort((e=>e.logPartId)).map((e=>e.partialMessage)).join("");return JSON.parse(t)},function(e){e.GetActiveCell="GetActiveCell failed",e.GetConfig="GetConfig failed",e.ParseEdit="ParseEdit failed",e.EmptyContent="empty content"}(T||(T={})),(0,i.registerPluginFactory)(A.factory),t.formulaCollectionPluginDependenciesResolved=(0,S.trackableAsyncLazy)((async()=>{const e=await p.workerThreadSpread.getValue();await e.createAndAttachPlugin(f.PluginFactoryName.FormulaCollectionPlugin),await p.schedulerWithRecalcServiceAttached.getValue()}),"formulaCollectionPluginDependenciesResolved")},23495:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.coloredReferencesPluginDependenciesResolved=void 0;const n=r(74643),a=r(57993),i=r(1765),o=r(50013),s=r(30070),u=r(44544),l=r(98468),c=r(2340),d=r(37448),g=r(36159),m=r(25092),h=r(92587),p=r(93336),f=r(10048),S=r(91903),v=r(12893),F=r(25722),y=S.PluginRegistry.create(p.PluginFactoryName.ColoredReferencesPlugin,p.PluginGroup.Excel);let C=(()=>{let e,t,r,a=[y.x10Plugin()],u=[],l=[];return t=class{*run(e){const t=e.content,r=yield{kind:c.ComputationRequestKind.ParseActiveCell,formulaText:t};if(r.kind!==c.ComputationRequestKind.ParseActiveCell||!(0,i.isSuccess)(r.result))return null;if(r.result.value.kind!==s.EditKind.Formula)return null;const n=yield{kind:c.ComputationRequestKind.GetActiveCell};if(n.kind!==c.ComputationRequestKind.GetActiveCell)return A("failed to get active cell"),null;let a;const u=yield{kind:c.ComputationRequestKind.GetSheetNames};let l;u.kind===c.ComputationRequestKind.GetSheetNames?a=u:A("failed to get sheet names");const f=yield{kind:c.ComputationRequestKind.GetDefinedNamesInfo};f.kind===c.ComputationRequestKind.GetDefinedNamesInfo?l=f.definedNamesInfo:A("failed to get defined names");const S=n.activeCell,{formula:v}=r.result.value,F=new d.ColoredReferencesVisitor(S,v,t,a,l);(0,o.reduceBottomUp)(F,v);let y=F.formulaHighlights;if(0!==F.structRefNodes.length){const e={originGridCell:(0,i.success)(S.range),originSheet:(0,i.success)(S.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!0},t=yield{kind:c.ComputationRequestKind.ResolveReferences,nodes:F.structRefNodes,locals:e};t.kind===c.ComputationRequestKind.ResolveReferences?y=y.concat(function(e,t,r){const n=[];return r.forEach((r=>{const a=e.spans[r.node.label];if(!a)return void A("failed to resolve StructRef, formulaSpan null");if(!(0,i.isSuccess)(r.resolution))return void A(`failed to resolve StructRef, reason: ${r.resolution?.reason.kind}`);if(void 0===r.resolution.value)return void A("failed to resolve StructRef, resolution value undefined");const o=r.resolution.value,s=(0,h.sheetRangeToSheetIndex)(o.sheet);if(!(0,g.isDefined)(s)||!(0,h.isSheetIndexEqual)(s,t.sheet))return;const u=(0,m.gridRangeToRange)(o.range),l={kind:p.HighlightKind.StructRef,span:a,rangeInfo:{range:u}};n.push(l)})),n}(v,S,t.resolverResults)):A("failed to resolve node references")}return{formulaHighlights:y}}constructor(){n.__runInitializers(this,l)}},n.__setFunctionName(t,"ColoredReferencesPlugin"),(()=>{const i="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[y.uiMessageHandler({kind:v.RequestKind.formulaHighlighting,modifiers:{executionMode:{time:F.ExecutionTimeMode.Sync}}})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:i},null,l),n.__esDecorate(null,e={value:t},a,{kind:"class",name:t.name,metadata:i},null,u),t=e.value,i&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:i})})(),t.factory=y.injectPluginFactory(),n.__runInitializers(t,u),t})();function A(e){a.ulsLogger.ULS.traceTag(525133647,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,`ColoredReferencesPlugin encountered a failure with msg ${e}`)}(0,u.registerPluginFactory)(C.factory),t.coloredReferencesPluginDependenciesResolved=(0,f.trackableAsyncLazy)((async()=>{const e=await l.dynamicPluginLoaderCreated.getValue();await e.createAndAttachPlugin(p.PluginFactoryName.ColoredReferencesPlugin),await l.schedulerWithRecalcServiceAttached.getValue()}),"coloredReferencesPluginDependenciesResolved")},37448:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColoredReferencesVisitor=void 0;const n=r(36159),a=r(57993),i=r(27437),o=r(93336),s=r(12973),u=r(12973),l=r(50013),c=r(91793),d=r(92587),g=r(25092),m=r(46124),h=r(93336);class p extends l.IdentityVisitor{structRefNode(e,t,r){const n=super.structRefNode(e,t,r);return this.structRefNodes.push(n),n}nameNode(e,t,r){const a=super.nameNode(e,t,r);if(!this.isRefInActiveSheet(t))return a;if(a.parts.kind===s.NamePartKind.FieldRefNamePart)return this.createAndAppendFieldRefHighlight(a.parts.lhs),a;if(!(0,n.isDefined)(this.namedObjectsMap))return a;const i=this.namedObjectsMap.get(e.asWhole.toLocaleLowerCase());return void 0!==i&&i.type!==h.DefinedNameInfoType.Invalid&&this.createAndAppendNamedRefHighlight(r,i),a}cellRefNode(e,t,r){const n=super.cellRefNode(e,t,r);if(!(0,c.isValidCellRef)(e)||!this.isRefInActiveSheet(t))return n;const a=this.parsedFormulaTree.spans[r];if(a){const t=this.createRangeInfoFromCellRef(e),r=this.formulaSpanToHighlightingSpan(a,u.NodeKind.CellRef);this.formulaHighlights.push(f(o.HighlightKind.CellRef,r,t))}return n}get namedObjectsMap(){return(0,n.isDefined)(this._namedObjectsMap)||(0,n.isDefined)(this.definedNameInfoList)&&(this._namedObjectsMap=(0,c.createNameToDefinedNameInfoMapping)(this.definedNameInfoList)),this._namedObjectsMap}createAndAppendNamedRefHighlight(e,t){const r=this.parsedFormulaTree.spans[e];if(!(0,n.isDefined)(r)||!(0,n.isDefined)(this.sheetNames))return;const a=t.sheetName;if(!(0,n.isDefined)(a))return void S(`createAndAppendNamedRef - sheetName undefined, DefinedNameInfo type: ${t.type}`);const i=(0,c.getSheetIndexFromSheetName)(a,this.sheetNames);if(!(0,n.isDefined)(i))return void S(`createAndAppendNamedRef: sheetIndex undefined, DefinedNameInfo type: ${t.type}`);if(!(0,d.isSheetIndexEqual)(i,this.activeCell.sheet))return;const s=(0,m.getRangeFromDefinedName)(t);void 0!==s&&this.formulaHighlights.push(f(o.HighlightKind.NamedRange,r,{range:s}))}createAndAppendFieldRefHighlight(e){switch(e.kind){case s.NamePartKind.CellRefNamePart:this.createAndAppendCellRefPartHighlight(e);break;case s.NamePartKind.IdentNamePart:{if(!(0,n.isDefined)(this.namedObjectsMap))return;const t=this.namedObjectsMap.get(e.asWhole.toLocaleLowerCase());void 0!==t&&t.type!==h.DefinedNameInfoType.Invalid&&this.createAndAppendNamedRefHighlight(e.label,t);break}case s.NamePartKind.FieldRefNamePart:this.createAndAppendFieldRefHighlight(e.lhs)}}createAndAppendCellRefPartHighlight(e){const t=this.parsedFormulaTree.spans[e.label];if(!(0,n.isDefined)(t))return;const r=this.createRangeInfoFromCellRef(e.ref),a=this.formulaSpanToHighlightingSpan(t,u.NodeKind.CellRef),i=f(o.HighlightKind.CellRef,a,r);this.formulaHighlights.push(i)}formulaSpanToHighlightingSpan(e,t){const r={...e};var n,a;return t===u.NodeKind.CellRef&&(n=e,(a=this.formulaString).length>n.end&&a.charAt(n.end)===i.operatorStrings[i.OperatorId.Pound]&&(r.end+=1)),r}createRangeInfoFromCellRef(e){return{range:(0,c.getRangeFromCellRef)(e,this.activeCell.range,S),positionKindInfo:(0,g.getPositionKindInfoFromCellRef)(e)}}isRefInActiveSheet(e){if(!(0,n.isDefined)(e))return!0;if(!(0,n.isDefined)(this.sheetNames))return!1;const t=(0,c.getSheetIndexFromQualifier)(e,this.sheetNames,this.failureCallback);return(0,n.isDefined)(t)?(0,d.isSheetIndexEqual)(t,this.activeCell.sheet):(this.failureCallback?.("CellRefHighlightCreator.isRefInActiveSheet: sheetIndex is undefined"),!1)}constructor(e,t,r,n,a,i){super(),this.activeCell=e,this.parsedFormulaTree=t,this.formulaString=r,this.sheetNames=n,this.definedNameInfoList=a,this.failureCallback=i,this.structRefNodes=[],this.formulaHighlights=[],this.activeCellSheetName=void 0,this._namedObjectsMap=void 0}}function f(e,t,r){return{kind:e,span:t,rangeInfo:r}}function S(e){a.ulsLogger.ULS.traceTag(520935561,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,`ColoredReferencesVisitor encountered a failure with msg ${e}`)}t.ColoredReferencesVisitor=p},9871:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parenthesesCouplingPluginDependenciesResolved=t.ParenthesesCouplingPlugin=void 0;const n=r(74643),a=r(36159),i=r(1765),o=r(50013),s=r(30070),u=r(44544),l=r(98468),c=r(2340),d=r(20992),g=r(93336),m=r(10048),h=r(91903),p=r(12893),f=r(25722),S=h.PluginRegistry.create(g.PluginFactoryName.ParenthesesCouplingPlugin,g.PluginGroup.Excel);let v=(()=>{let e,t,r,u=[S.x10Plugin()],l=[],m=[];return t=class{*run(e){if(null!=e.selectionLength&&e.selectionLength>0)return null;const t=yield{kind:c.ComputationRequestKind.ParseActiveCell,formulaText:e.content};if(t.kind!==c.ComputationRequestKind.ParseActiveCell||!(0,i.isSuccess)(t.result))return null;if(t.result.value.kind!==s.EditKind.Formula)return null;const{formula:r}=t.result.value,n=new d.ParenthesesCouplingVisitor(r,e.caretPosition);return(0,o.reduceBottomUp)(n,r),(0,a.isDefined)(n.parenthesesSpan)?this.getParenthesesHighlights(n.parenthesesSpan):{formulaHighlights:void 0}}getParenthesesHighlights(e){const t=e.start,r=e.end,n={kind:g.HighlightKind.Parentheses,span:{start:t,end:t+1}};return{formulaHighlights:[{kind:g.HighlightKind.Parentheses,span:{start:r,end:r+1}},n]}}constructor(){n.__runInitializers(this,m)}},n.__setFunctionName(t,"ParenthesesCouplingPlugin"),(()=>{const a="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[S.uiMessageHandler({kind:p.RequestKind.formulaHighlighting,modifiers:{executionMode:{time:f.ExecutionTimeMode.Sync}}}),S.uiMessageHandler({kind:p.RequestKind.formulaHighlighting,modifiers:{executionMode:{time:f.ExecutionTimeMode.Async}}})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:a},null,m),n.__esDecorate(null,e={value:t},u,{kind:"class",name:t.name,metadata:a},null,l),t=e.value,a&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:a})})(),t.factory=S.injectPluginFactory(),n.__runInitializers(t,l),t})();t.ParenthesesCouplingPlugin=v,(0,u.registerPluginFactory)(v.factory),t.parenthesesCouplingPluginDependenciesResolved=(0,m.trackableAsyncLazy)((async()=>{const e=await l.dynamicPluginLoaderCreated.getValue();await e.createAndAttachPlugin(g.PluginFactoryName.ParenthesesCouplingPlugin),await l.schedulerWithRecalcServiceAttached.getValue()}),"parenthesesCouplingPluginDependenciesResolved")},20992:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ParenthesesCouplingVisitor=void 0;const n=r(12973),a=r(50013);class i extends a.IdentityVisitor{appNode(e,t,r,a){return e.kind!==n.NodeKind.Operator&&this.matchFormula(e,r,a),super.appNode(e,t,r,a)}parenNode(e,t,r){const n=this.formula.spans[r];return t&&n&&this.matchParentheses(n.start,n.end-1),super.parenNode(e,t,r)}letNode(e,t,r,n,a,i){return this.matchFormula(e,a,i),super.letNode(e,t,r,n,a,i)}lambdaNode(e,t,r,n,a,i){return this.matchFormula(e,a,i),super.lambdaNode(e,t,r,n,a,i)}matchFormula(e,t,r){const n=this.formula.spans[r],a=this.formula.spans[e.label];t&&n&&a&&this.matchParentheses(a.end,n.end-1)}matchParentheses(e,t){e===this.caretPosition&&(this.checkRight=!0),t===this.caretPosition-1&&(this.checkLeft=!0),this.checkRight&&this.shouldUpdateLocation(e,t,this.caretPosition+1)||this.shouldUpdateLocation(e,t,this.caretPosition)?(this.parenthesesSpan={start:e,end:t},this.areParenthesesLeftOfCaret=!1):this.checkLeft&&this.shouldUpdateLocation(e,t,this.caretPosition-1)&&(this.parenthesesSpan={start:e,end:t},this.areParenthesesLeftOfCaret=!0)}shouldUpdateLocation(e,t,r){return e<r&&r<=t&&(void 0===this.parenthesesSpan||this.areParenthesesLeftOfCaret&&e<=this.parenthesesSpan.start||e>this.parenthesesSpan.start)}constructor(e,t){super(),this.formula=e,this.caretPosition=t,this.parenthesesSpan=void 0,this.checkLeft=!1,this.checkRight=!1,this.areParenthesesLeftOfCaret=!1}}t.ParenthesesCouplingVisitor=i},25092:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPositionKindInfoFromCellRef=t.spanCompare=t.gridRangeToRange=void 0;const n=r(12973),a=r(93336),i={Abs:a.PositionKind.Absolute,Rel:a.PositionKind.Relative};t.gridRangeToRange=function(e){const t=e.row,r=e.col;return{firstRow:t,firstColumn:r,lastRow:t+e.rows-1,lastColumn:r+e.cols-1}},t.spanCompare=function(e,t){let r;return 0!=(r=e.start-t.start)||0!=(r=t.end-e.end)?r:0},t.getPositionKindInfoFromCellRef=function(e){switch(e.kind){case n.CellRefKind.Col:return function(e){return{firstRow:a.PositionKind.Relative,firstColumn:i[e.col1.kind],secondRow:a.PositionKind.Relative,secondColumn:i[e.col2.kind]}}(e);case n.CellRefKind.Row:return function(e){return{firstRow:i[e.row1.kind],firstColumn:a.PositionKind.Relative,secondRow:i[e.row2.kind],secondColumn:a.PositionKind.Relative}}(e);case n.CellRefKind.Single:return function(e){let t,r;return{firstRow:t=i[e.row.kind],firstColumn:r=i[e.col.kind],secondRow:t,secondColumn:r}}(e);case n.CellRefKind.Range:return function(e){return{firstRow:i[e.ref1.row.kind],firstColumn:i[e.ref1.col.kind],secondRow:i[e.ref2.row.kind],secondColumn:i[e.ref2.col.kind]}}(e)}}},76063:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.gotoCtrlClickPluginDependenciesResolved=void 0;const n=r(74643),a=r(57993),i=r(36159),o=r(1765),s=r(93336),u=r(98468),l=r(46124),c=r(2340),d=r(2640),g=r(50013),m=r(30070),h=r(10048),p=r(91903),f=r(12893),S=r(44544),v=p.PluginRegistry.create(s.PluginFactoryName.GotoCtrlClickPlugin,s.PluginGroup.Excel);let F=(()=>{let e,t,r,a=[v.x10Plugin()],u=[],h=[];return t=class{*run({text:e,index:t}){const r=e;if(t<0||t>=r.length)return y("caret out of formula scope"),{kind:s.GotoCtrlClickResultKind.NoReferenceFound};const n=yield{kind:c.ComputationRequestKind.ParseActiveCell,formulaText:r};if(n.kind!==c.ComputationRequestKind.ParseActiveCell||!(0,o.isSuccess)(n.result))return y("failed to parse active cell"),{kind:s.GotoCtrlClickResultKind.Failure};if(n.result.value.kind!==m.EditKind.Formula)return y("Not a formula cell"),{kind:s.GotoCtrlClickResultKind.NotAFormula};const a=yield{kind:c.ComputationRequestKind.GetActiveCell};if(a.kind!==c.ComputationRequestKind.GetActiveCell)return y("failed to get active cell"),null;let u;const h=yield{kind:c.ComputationRequestKind.GetDefinedNamesInfo};h.kind===c.ComputationRequestKind.GetDefinedNamesInfo?u=h.definedNamesInfo:y("failed to get defined names");const p=a.activeCell,{formula:f}=n.result.value,S=new d.GotoCtrlClickVisitor(f,p.range,u,t);if((0,g.reduceBottomUp)(S,f),!S.referenceFound)return{kind:s.GotoCtrlClickResultKind.NoReferenceFound};let v=S.sheetRange;if((0,i.isDefined)(S.structRefNodeToResolve)){let e;const t=yield{kind:c.ComputationRequestKind.GetSheetNames};if(t.kind!==c.ComputationRequestKind.GetSheetNames)return y("failed to get sheet names"),{kind:s.GotoCtrlClickResultKind.RangeResolutionFailure,span:S.span};e=t;const r=yield{kind:c.ComputationRequestKind.ResolveReferences,nodes:[S.structRefNodeToResolve],locals:{originGridCell:(0,o.success)(p.range),originSheet:(0,o.success)(p.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!0}};r.kind===c.ComputationRequestKind.ResolveReferences?v=(0,l.getSheetRangeFromResolvedRef)(e,r.resolverResults[0],y):y("failed to resolve node references")}return(0,i.isDefined)(v)?{kind:s.GotoCtrlClickResultKind.ReferenceFound,sheetRange:v,span:S.span}:{kind:s.GotoCtrlClickResultKind.RangeResolutionFailure,span:S.span}}constructor(){n.__runInitializers(this,h)}},n.__setFunctionName(t,"GotoCtrlClickPlugin"),(()=>{const i="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[v.uiMessageHandler({kind:f.RequestKind.gotoCtrlClick})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:i},null,h),n.__esDecorate(null,e={value:t},a,{kind:"class",name:t.name,metadata:i},null,u),t=e.value,i&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:i})})(),t.factory=v.injectPluginFactory(),n.__runInitializers(t,u),t})();function y(e){a.ulsLogger.ULS.traceTag(508687389,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,`GotoCtrlClickPlugin encountered a failure with msg ${e}`)}(0,S.registerPluginFactory)(F.factory),t.gotoCtrlClickPluginDependenciesResolved=(0,h.trackableAsyncLazy)((async()=>{const e=await u.workerThreadSpread.getValue();await e.createAndAttachPlugin(s.PluginFactoryName.GotoCtrlClickPlugin),await u.schedulerWithRecalcServiceAttached.getValue()}),"gotoCtrlClickPluginDependenciesResolved")},2640:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GotoCtrlClickVisitor=void 0;const n=r(57993),a=r(36159),i=r(12973),o=r(50013),s=r(93336),u=r(91793),l=r(46124);class c extends o.IdentityVisitor{get namedObjectsMap(){return(0,a.isDefined)(this._namedObjectsMap)?this._namedObjectsMap:(0,a.isDefined)(this.definedNameInfoList)?(this._namedObjectsMap=(0,u.createNameToDefinedNameInfoMapping)(this.definedNameInfoList),this._namedObjectsMap):void d("namedObjectsMap: was called but definedNameInfoList is undefined")}structRefNode(e,t,r){const n=super.structRefNode(e,t,r);if(this.referenceFound)return n;const a=this.parsedFormulaTree.spans[r];return(0,u.caretInSpanScope)(this.caretPosition,a)&&(this.referenceFound=!0,this.span=a,this.structRefNodeToResolve=n),n}cellRefNode(e,t,r){const n=super.cellRefNode(e,t,r);if(this.referenceFound)return n;const a=this.parsedFormulaTree.spans[r];return(0,u.caretInSpanScope)(this.caretPosition,a)&&(this.referenceFound=!0,this.span=a,this.sheetRange=(0,l.sheetRangeFromCellRef)(e,t,this.activeCell,d)),n}nameNode(e,t,r){const n=super.nameNode(e,t,r);if(this.referenceFound)return n;const a=this.parsedFormulaTree.spans[r];if(!(0,u.caretInSpanScope)(this.caretPosition,a))return n;if(n.parts.kind===i.NamePartKind.FieldRefNamePart)this.tryFindFieldRefGotoReference(n.parts,t);else{const r=this.namedObjectsMap?.get(e.asWhole.toLocaleLowerCase());void 0!==r&&r.type!==s.DefinedNameInfoType.Invalid&&(this.referenceFound=!0,this.span=a,this.sheetRange=(0,l.getSheetRangeFromDefinedNameInfo)(r,t))}return n}tryFindFieldRefGotoReference(e,t){const r=(0,u.findFieldRefSourceLhs)(e);switch(r.kind){case i.NamePartKind.CellRefNamePart:{const e=this.parsedFormulaTree.spans[r.label];return void((0,u.caretInSpanScope)(this.caretPosition,e)&&(this.referenceFound=!0,this.span=e,this.sheetRange=(0,l.sheetRangeFromCellRef)(r.ref,void 0,this.activeCell,d)))}case i.NamePartKind.IdentNamePart:{const e=this.parsedFormulaTree.spans[r.label];if((0,a.isDefined)(this.namedObjectsMap)&&(0,u.caretInSpanScope)(this.caretPosition,e)){this.referenceFound=!0,this.span=e;const n=(0,u.getNamePartIfExists)(r,this.namedObjectsMap);if(!(0,a.isDefined)(n))return;this.sheetRange=(0,l.getSheetRangeFromDefinedNameInfo)(n,t)}return}default:d("tryFindFieldRefGotoReference: Was not able to parse a left-most NamePart")}}constructor(e,t,r,n){super(),this.parsedFormulaTree=e,this.activeCell=t,this.definedNameInfoList=r,this.caretPosition=n,this.structRefNodeToResolve=void 0,this.span=void 0,this.sheetRange=void 0,this.referenceFound=!1,this._namedObjectsMap=void 0}}function d(e){n.ulsLogger.ULS.traceTag(508687388,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,`GotoCtrlClickVisitor encountered a failure with msg ${e}`)}t.GotoCtrlClickVisitor=c},86441:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ComputationFinalizer=void 0;const n=r(57993),a=r(86761),i=r(64796),o=r(73701),s=r(56134),u=r(2340);t.ComputationFinalizer=class{subscribe(e){if(!this.isClosed)return this.subject.subscribe(e);s.x10Logger.log({kind:"failure",payload:{failureKind:s.X10FailureKind.AssertionFailure,failureLevel:n.TraceLevel.Warning,path:"PluginFinalizer.subscribe",description:"subscription for a closed finalizer was requested"}})}finalize(e,t){const r=this.extractComputationInfo(e);t===u.ExecutionStopReason.Unknown&&s.x10Logger.log({kind:"failure",payload:{failureKind:s.X10FailureKind.AssertionFailure,failureLevel:n.TraceLevel.Warning,path:"PluginFinalizer.finalize",description:"finalize was invoked with an unknown stop reason",data:r}}),this.isClosed?s.x10Logger.log({kind:"failure",payload:{failureKind:s.X10FailureKind.AssertionFailure,failureLevel:n.TraceLevel.Warning,path:"PluginFinalizer.finalize",description:"finalizer was invoked more than once",data:{stopReason:t,...r}}}):(this.isClosed=!0,this.finalizeComputationGeneratorExecution(e,t),this.subject.next({computationInfo:r,stopReason:t}))}finalizeComputationGeneratorExecution(e,t){switch(t){case u.ExecutionStopReason.Unknown:case u.ExecutionStopReason.Frame.Timeout:case u.ExecutionStopReason.Frame.Superseded:case u.ExecutionStopReason.Frame.ConflictResolverEarlyTermination:let r=!1;try{e.generator.throw(new i.X10ExceptionComputationTermination(t))}catch(a){r=!0,a instanceof i.X10ExceptionComputationTermination&&a.stopReason&&a?.stopReason!==t&&n.ulsLogger.ULS.traceTag(508903693,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,s.x10Logger.formatLogMessage("finalizeComputationGeneratorExecution",{description:"computation threw an exception during execution",data:e.info}))}finally{r||s.x10Logger.log({kind:"failure",payload:{failureKind:s.X10FailureKind.AssertionFailure,failureLevel:n.TraceLevel.Warning,path:"ComputationFinalizer.finalizeComputationGeneratorExecution",description:"computation terminated by x10 with exception but did not threw the exception back",data:e.info}})}break;case u.ExecutionStopReason.Computation.Done:case u.ExecutionStopReason.Computation.Skipped:case u.ExecutionStopReason.Computation.Exception:break;default:(0,o.assertNever)("Unknown stopReason",t)}}extractComputationInfo(e){const t=e.info;t.totalRuntime=e.info.computationTime;for(const r in e.info.requestTimes)t.totalRuntime+=e.info.requestTimes[r]?.requestDuration??0;return t}constructor(...e){this.subject=new a.Subject,this.isClosed=!1;for(const t of e)this.subscribe(t)}}},46124:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uniteIntersectingRangeObjects=t.uniteIntersectingGridRanges=t.gridRangesIntersects=t.rangesIntersects=t.getSheetGridCellFromRangeObject=t.rangeToGridRange=t.toSharedSheetRange=t.getSheetRangeFromResolvedRef=t.sheetRangeFromCellRef=t.getSheetRangeFromDefinedNameInfo=t.getRangeFromDefinedName=void 0;const n=r(36159),a=r(91793),i=r(1765),o=r(93336),s=r(25092),u=r(60140);function l(e){const t=e.namedRange;if(null==t||e.type===o.DefinedNameInfoType.Invalid)return;const r=e.type===o.DefinedNameInfoType.Table?1:0;return t.bottom&&t.top&&t.right&&t.left?{firstRow:t.top+r-1,firstColumn:t.left-1,lastRow:t.bottom-1,lastColumn:t.right-1}:void 0}function c(e,t){return(0,n.fastMin)(e.lastColumn,t.lastColumn)>=(0,n.fastMax)(e.firstColumn,t.firstColumn)&&(0,n.fastMin)(e.lastRow,t.lastRow)>=(0,n.fastMax)(e.firstRow,t.firstRow)}function d(e,t){return(0,n.fastMin)(e.col+e.cols-1,t.col+t.cols-1)>=(0,n.fastMax)(e.col,t.col)&&(0,n.fastMin)(e.row+e.rows-1,t.row+t.rows-1)>=(0,n.fastMax)(e.row,t.row)}t.getRangeFromDefinedName=l,t.getSheetRangeFromDefinedNameInfo=function(e,t){const r=l(e);if(!(0,n.isDefined)(r))return;const i=(0,n.isDefined)(e.sheetName)?e.sheetName:t?(0,a.getSheetNameFromQualifier)(t):"";return{...r,sheetName:i,namedObjectName:(0,n.isDefined)(e.name)?e.name:""}},t.sheetRangeFromCellRef=function(e,t,r,i){const o=(0,a.getRangeFromCellRef)(e,r,i);if((0,n.isDefined)(o))return{...o,sheetName:t?(0,a.getSheetNameFromQualifier)(t):"",namedObjectName:""}},t.getSheetRangeFromResolvedRef=function(e,t,r){if(!(0,i.isSuccess)(t.resolution))return void r?.(`failed to resolve StructRef, reason: ${t.resolution.reason}`);if(void 0===t.resolution.value)return void r?.("failed to resolve StructRef, resolution value undefined");const n=t.resolution.value,o=(0,a.sheetIndexToSheetName)(n.sheet,e)??"";return{...(0,s.gridRangeToRange)(n.range),sheetName:o,namedObjectName:t.node.lhs?t.node.lhs.whole:""}},t.toSharedSheetRange=function(e){return{FirstColumn:e.firstColumn,FirstRow:e.firstRow,LastColumn:e.lastColumn,LastRow:e.lastRow,NamedObjectName:e.namedObjectName,SheetName:e.sheetName}},t.rangeToGridRange=function(e){const t=e.firstRow,r=e.firstColumn;return(0,u.gridRange)(t,r,e.lastRow-t+1,e.lastColumn-r+1)},t.getSheetGridCellFromRangeObject=function(e,t){return(0,u.sheetGridCell)(t,{row:e.firstRow,col:e.firstColumn,rows:1,cols:1})},t.rangesIntersects=c,t.gridRangesIntersects=d,t.uniteIntersectingGridRanges=function(e,t){return d(e,t)?(0,u.gridRange)((0,n.fastMin)(e.row,t.row),(0,n.fastMin)(e.col,t.col),(0,n.fastMax)(e.row+e.rows,t.row+t.rows)-(0,n.fastMin)(e.row,t.row),(0,n.fastMax)(e.col+e.cols,t.col+t.cols)-(0,n.fastMin)(e.col,t.col)):null},t.uniteIntersectingRangeObjects=function(e,t){return c(e,t)?{firstRow:(0,n.fastMin)(e.firstRow,t.firstRow),firstColumn:(0,n.fastMin)(e.firstColumn,t.firstColumn),lastRow:(0,n.fastMax)(e.lastRow,t.lastRow),lastColumn:(0,n.fastMax)(e.lastColumn,t.lastColumn)}:null}},86761:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.X10TaskInternal=t.Ref=t.InitializingSubject=t.Subject=void 0;const n=r(82438),a=r(56134);class i{next(e){for(const[t,r]of this.subscribers)r(e)}subscribe(e){return this.subscribers.push([++this.currentSubscription,e]),this.currentSubscription}unsubscribe(e){this.subscribers=this.subscribers.filter((([t,r])=>t!==e))}constructor(){this.subscribers=[],this.currentSubscription=0}}t.Subject=i,t.InitializingSubject=class extends i{subscribe(e){const t=super.subscribe(e);return this.initializeSubscriber().map(e),t}constructor(e){super(),this.initializeSubscriber=e}},t.Ref=class{constructor(e){this.value=e}},t.X10TaskInternal=class{static createToken(){return"Do not use outside of x10 scheduler. Resovle by yielding with an 'AwaitTask' / 'AwaitAll' request"}resolve(e){return e!==this.token&&a.x10Logger.log({kind:"failure",payload:{failureKind:a.X10FailureKind.AssertionFailure,failureLevel:n.TraceLevel.Warning,path:"X10TaskInternal.resolve",description:"Task is resolving with an invalid token"}}),this.maybeThenable}constructor(e,t){this.maybeThenable=e,this.token=t}}},91793:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findFieldRefSourceLhs=t.caretInSpanScope=t.sheetIndexToSheetName=t.getAbsolutePosition=t.getNamePartIfExists=t.createNameToDefinedNameInfoMapping=t.getRangeFromCellRef=t.getSheetNameFromQualifier=t.getSheetIndexFromQualifier=t.getSheetIndexFromSheetName=t.isValidCellRef=void 0;const n=r(12973),a=r(12973),i=r(12973),o=r(12973),s=r(36159),u=r(93336),l=r(92587);class c{}function d(e,t){const r=t.nameToIndex.getValue(e);if((0,s.isDefined)(r))return t.sheets[r].sheetIndex}function g(e,t){return e.kind===a.QualifierKind.Sheet?e.sheet:e.kind===a.QualifierKind.Ident?e.name:((0,s.isDefined)(t)&&t(`getSheetNameFromQualifier unexpected qualifier kind: ${e.kind}`),"")}function m(e,t){return e.index+(e.kind===o.PosKind.Rel?t:0)}c.MaxRow=1048575,c.MaxColumn=16383,t.isValidCellRef=function(e){return e.kind!==i.CellRefKind.Bad&&e.kind!==i.CellRefKind.Error},t.getSheetIndexFromSheetName=d,t.getSheetIndexFromQualifier=function(e,t,r){return d(g(e,r),t)},t.getSheetNameFromQualifier=g,t.getRangeFromCellRef=function(e,t,r){switch(e.kind){case i.CellRefKind.Single:{const r=m(e.row,t.row),n=m(e.col,t.col);return{firstRow:r,firstColumn:n,lastRow:r,lastColumn:n}}case i.CellRefKind.Range:return{firstRow:m(e.ref1.row,t.row),firstColumn:m(e.ref1.col,t.col),lastRow:m(e.ref2.row,t.row),lastColumn:m(e.ref2.col,t.col)};case i.CellRefKind.Col:return{firstRow:0,firstColumn:m(e.col1,t.col),lastRow:c.MaxRow,lastColumn:m(e.col2,t.col)};case i.CellRefKind.Row:return{firstRow:m(e.row1,t.row),firstColumn:0,lastRow:m(e.row2,t.row),lastColumn:c.MaxColumn};default:(0,s.isDefined)(r)&&r(`getRangeFromCellRef unexpected CellRefKind: ${e.kind}`)}},t.createNameToDefinedNameInfoMapping=function(e){const t=new Map;return e.forEach((e=>{(0,s.isDefined)(e.name)&&t.set(e.name.toLocaleLowerCase(),e)})),t},t.getNamePartIfExists=function(e,t){const r=t.get(e.asWhole.toLocaleLowerCase());if(void 0!==r&&r.type!==u.DefinedNameInfoType.Invalid)return r},t.getAbsolutePosition=m,t.sheetIndexToSheetName=function(e,t){const r=t.sheets.findIndex((t=>(0,l.isSheetIndexEqual)(t.sheetIndex,e)));if(-1!==r)return t.sheets[r].sheetName},t.caretInSpanScope=function(e,t){return(0,s.isDefined)(t)&&e.valueOf()>=t.start&&e.valueOf()<t.end},t.findFieldRefSourceLhs=function e(t){switch(t.kind){case n.NamePartKind.CellRefNamePart:case n.NamePartKind.IdentNamePart:return t;case n.NamePartKind.FieldRefNamePart:return e(t.lhs)}}},91903:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PluginRegistry=void 0;var n=r(93463);Object.defineProperty(t,"PluginRegistry",{enumerable:!0,get:function(){return n.PluginRegistry}})},93463:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PluginRegistry=void 0;const n=r(44700),a=r(15787),i=r(86270),o=r(25722);class s{static creator(){return(e,t)=>new s(e,t)}static get create(){return s.creator()}x10Plugin(e){return(t,r)=>{const o=String(r.name),s={factoryName:this.factoryName,pluginName:o,pluginGroup:this.pluginGroup,create:r=>new t(...e?e(r):[])};(0,i.assertTrue)(`Registry object cannot be used on '${s.pluginName}' class. 'x10Plugin' decorator must be called only once on plugin class`,void 0===this.factory),this.factory=s,(0,a.deletePluginRegistration)({factoryName:this.factoryName,pluginName:o});for(const e of this.registeredUIHandlers)(0,a.registerComputation)(n.ComputationType.UIMessage,e.kind,e.executionMode,this.pluginGroup,{factoryName:this.factoryName,pluginName:o,computationName:e.name,executionMode:e.executionMode},e.modifiers,e.computationGenerator,e.predicate);for(const e of this.registeredEventHandlers)(0,a.registerComputation)(n.ComputationType.Event,e.kind,e.executionMode,this.pluginGroup,{factoryName:this.factoryName,pluginName:o,computationName:e.name,executionMode:e.executionMode},e.modifiers,e.computationGenerator,e.predicate)}}uiMessageHandler(e){return(t,r)=>{this.registeredUIHandlers.push({type:n.ComputationType.UIMessage,kind:e.kind,name:String(r.name),executionMode:{time:e.modifiers?.executionMode?.time??o.ExecutionTimeMode.Async,space:e.modifiers?.executionMode?.space??o.ExecutionSpaceMode.Global},modifiers:e.modifiers??{},computationGenerator:t,predicate:e.predicate})}}eventHandler(e){return(t,r)=>{this.registeredEventHandlers.push({type:n.ComputationType.Event,kind:e.kind,name:String(r.name),executionMode:{time:e.modifiers?.executionMode?.time??o.ExecutionTimeMode.Async,space:e.modifiers?.executionMode?.space??o.ExecutionSpaceMode.Global},modifiers:e.modifiers??{},computationGenerator:t,predicate:e.predicate})}}injectPluginFactory(){return(0,i.assertTrue)("Plugin factory not initialized. `x10Plugin` decorator must be called on plugin class",void 0!==this.factory),this.factory}constructor(e,t){this.factoryName=e,this.pluginGroup=t,this.factory=void 0,this.registeredUIHandlers=[],this.registeredEventHandlers=[]}}t.PluginRegistry=s},40664:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.X10TableIntelligenceService=void 0;const n=r(36159),a=r(1765),i=r(57993),o=r(56134);t.X10TableIntelligenceService=class{async getRecognizedRangeTablesInfo(...e){try{const t=await this.tableIntelligenceProvider.getRecognizedRangeTablesInfo(...e);return(0,n.isDefined)(t)?(0,a.success)(t.filter(n.isDefined)):(0,a.failure)(void 0)}catch(e){return"getRecognizedRangeTablesInfo",t=`failed to get recognized range tables info: ${e}`,o.x10Logger.log({kind:"failure",payload:{failureKind:o.X10FailureKind.TableIntelligenceFailure,failureLevel:i.TraceLevel.Warning,path:"X10TableIntelligenceService.getRecognizedRangeTablesInfo",description:t}}),(0,a.failure)(e)}var t}constructor(e){this.tableIntelligenceProvider=e}}},74056:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Types=t.override=t.describe=void 0;const n=r(74643),a=r(225),i=n.__importStar(r(65613));t.describe=a.x10Test.describe,t.override=a.x10Test.override,t.Types=i},65613:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RangeInterface=t.SheetInterface=t.GridInterface=void 0;const n=r(74643).__importStar(r(28281));t.GridInterface=n.GridInterface,t.SheetInterface=n.SheetInterface,t.RangeInterface=n.RangeInterface},225:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.x10Test=t.X10TestInfra=t.generateTestMethod=void 0;const n=r(84468),a=r(86270),i=r(961),o=r(98576),s=r(29163),u=r(88526),l=r(28281);class c{static get instance(){return(0,a.isDefined)(this._instance)||(this._instance=new c),this._instance}constructor(){this.args=[],this.args=JSON.parse({NODE_ENV:"production"}.npm_config_argv??"{}").original??[]}}c.has=e=>c.instance.args.findIndex((t=>t===e))>=0;class d{get startTime(){return this.timer.startTime}get preciseNow(){return this.timer.preciseNow()}jolt(){return new Promise((e=>(0,n.setImmediateUnified)((()=>e()))))}async runUntilResolved(e){let t=!1;const r=Promise.resolve(e);return r.then((()=>t=!0)),await this.runMacrotasksWhile((()=>!t)),r}constructor(e){this.timer=e,this.runMacrotasksWhile=(...e)=>this.timer.runMacrotasksWhile(...e),this.runMacrotasksFor=e=>{const t=this.preciseNow;return this.runMacrotasksWhile((()=>this.preciseNow<t+e))},this.busyWait=e=>this.timer.busyWait(e)}}function g(e,t){return function(r,n,c){const g=function(e){const t=e.some((e=>(0,a.isDefined)(e.changeGates))),r=e.some((e=>(0,a.isDefined)(e.featureGates)));return{overrides:0===e.length?[{}]:e.map((e=>({changeGates:e.changeGates??void 0,featureGates:e.featureGates??void 0}))),description:String(t?"\nCG Overrides: $changeGates":"")+(r?"\nFG Overrides: $featureGates":"")+(t||r?"\n":"")}}(t);describe.each(g.overrides)(g.description,(t=>{e(r,(async(...e)=>{const r=u.GateOverrideManager.override(t);try{return await n(function(){const e=(0,i.createMockAsyncGrid)(),t=new o.MockTimerImmediate,r=(0,s.getSchedulerFactories)().createFormulaBarScheduler((0,i.createMockGridProvider)(e),void 0,t),n=new l.GridInterface(e,r);return r.registerAsyncGrid(),{scheduler:r,grid:n,timer:new d(t)}}(),...e)}finally{u.GateOverrideManager.revert(r)}}),c)}))}}t.generateTestMethod=g;const m=e=>({test:g(test,e),it:g(it,e),each:t=>g(test.each(t),e),failing:g(test.failing,e),failingOverride:t=>(...r)=>{const n=e.filter((e=>!u.GateOverrideManager.extends(e,t))),a=e.filter((e=>u.GateOverrideManager.extends(e,t)));g(test,0===n.length?[t]:n)(...r),g(test.failing,0===a.length?[t]:a)(...r)},flaky:t=>g(c.has("--flaky")?test:test.skip,e),skip:g(test.skip,e),override:t=>m(u.GateOverrideManager.mergeGateOverrideLists(e,t))});class h{call(e,t){describe(e,(()=>t(m(this.overrides))))}each(e){return(t,r,n)=>{describe.each(e)(t,((...e)=>r(m(this.overrides),...e)),n)}}static create(e){const t=new h(e);return Object.assign(((...e)=>t.call(...e)),{each:(...e)=>t.each(...e)})}constructor(e){this.overrides=e,0===e.length&&(this.overrides=[{changeGates:{},featureGates:{}}])}}t.X10TestInfra=e=>({describe:h.create(e),override:t=>({describe:h.create(u.GateOverrideManager.mergeGateOverrideLists(e,t))})}),t.x10Test=(0,t.X10TestInfra)(u.GateOverrideManager.defaultGateOverrides())},28281:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GridInterface=t.SheetInterface=t.RangeInterface=void 0;const n=r(98396),a=r(36873),i=r(38838),o=r(6347),s=r(78663),u=r(14082),l=r(91793);function c(e){return void 0!==e&&e.hasOwnProperty("value")}class d{set(e,t,r){e in this.map||(this.map[e]={}),this.map[e][t]=r}get(e,t){if(e in this.map&&t in this.map[e])return this.map[e][t]}constructor(){this.map={}}}class g{setRange(e){const t=e.map((e=>e.map((e=>c(e)?e.value:e)))),r=e.map((e=>e.map((e=>c(e)?e.format:void 0)))),n=e.map((e=>e.map((e=>c(e)?e.formulaBarText:void 0))));this.grid.setRange(this.sheetId,this,t,r,n)}setTable(e,t,r){const[n,o]=[!e?.hideHeadersRow,e?.hasTotalsRow??!1];this.setRange(n?[t,...r]:r);const s=[(0,i.namedObjectsWrite)(void 0,[(0,i.namedObject)(e.name,(0,i.namedTableData)((0,i.sheetRangeLocation)(this.sheetId,this.firstRow+(n?1:0),this.firstColumn,this.firstRow+r.length-(o?1:0),this.firstColumn+t.length-1),n,o,t.map(((e,t)=>(0,i.columnData)(this.firstColumn+t,e)))))])];this.grid.setNamedObjects(s),this.scheduler.doNotify(a.NotificationKind.updateNamedObjects,[0,s])}get topLeft(){return{row:this.firstRow,col:this.firstColumn,rows:1,cols:1}}get firstRow(){return this.row}get firstColumn(){return this.col}get lastRow(){return this.row+this.rows-1}get lastColumn(){return this.col+this.cols-1}get range(){return this}get sheet(){return{document:{name:"",path:void 0},index:this.sheetId,index2:this.sheetId}}get rowIndex(){return this.firstRow}get colIndex(){return this.firstColumn}get sheetIndex(){return this.sheet.index}get docPath(){return this.sheet.document.path??null}get docName(){return this.sheet.document.name}get tables(){const e=this;return this.grid.getIntersectingTables(0,this).then((async t=>(await e.grid.discardSnapshot(0),"Success"===t.kind?t.value.tables:[])))}get cellValues(){return this.cells.then((e=>e.map((e=>e.map((e=>e.value))))))}get cellFormats(){return this.cells.then((e=>e.map((e=>e.map((e=>e.format))))))}get cells(){const e=this;return e.grid.getRangeValues(0,e).then((t=>e.grid.getRangeFormats(0,e).then((async r=>e.grid.getRangeFormulae(0,e).then((async n=>{const a=h("Success"===t.kind?t.value.nonEmptyCells:[],(e=>(0,i.readOperToCellValue)(o.xlMathpack,e))),s=h("Success"===r.kind?r.value.nonEmptyCells:[],(e=>Number(e))),u=h("Success"===n.kind?n.value.nonEmptyCells:[],(e=>e)),l=[];for(let t=e.firstRow;t<=e.lastRow;t++){l.push([]);for(let r=e.firstColumn;r<=e.lastColumn;r++)l[t-e.firstRow].push({value:a.get(t,r),formulaBarText:u.get(t,r)?.formulaBarText,format:s.get(t,r)})}return await e.grid.discardSnapshot(0),l}))))))}constructor(e,t,r,n,a,i,o){this.grid=e,this.scheduler=t,this.sheetId=r,this.row=n,this.col=a,this.rows=i,this.cols=o}}t.RangeInterface=g;class m{get(e){const t=this.parseRangeIndex(e);return this.getCoordinates(t.firstRow,t.firstColumn,t.lastRow,t.lastColumn)}getCoordinates(e,t,r,n){return new g(this.grid,this.scheduler,this.id,e,t,(r??e)-e+1,(n??t)-t+1)}parseRangeIndex(e){const t={col:0,row:0,cols:1,rows:1},r=this.parser.parseFormulaExpression((0,u.parseLocals)(n.LexicalKind.Range,t),e);if("Success"!==r.kind||"CellRef"!==r.value.node.kind)throw`Could not parse range: ${e}`;const a=(0,l.getRangeFromCellRef)(r.value.node.ref,t,(e=>{throw e}));if(void 0===a)throw`Could not parse range: ${e}`;return a}constructor(e,t,r){this.grid=e,this.scheduler=t,this.id=r;const n={config:(0,s.calcConfig)((0,s.getEnglishLocaleInfo)(),void 0,o.xlMathpack)};this.parser=(0,u.createParser)(n)}}function h(e,t){const r=new d;for(const n of e){const e=n[0],a=e[0],i=e[1],o=e[2]??1,s=e[3]??1,u=n[1];for(let e=a;e<a+o;e++)for(let n=i;n<i+s;n++)r.set(e,n,t(u))}return r}t.SheetInterface=m,t.GridInterface=class{createSheet(e){const t=new m(this.grid,this.scheduler,e);return this.grid.setSheet(e,e,[[]]),this.sheets[e]=t,this.scheduler.doNotify(a.NotificationKind.updateSheetNames,[0,[{sheetId:e,sheetName:e}]]),t}constructor(e,t){this.grid=e,this.scheduler=t,this.sheets={}}}},44994:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logSafeFailure=void 0;const n=r(1765);t.logSafeFailure={failure:e=>({...(0,n.failure)(e),logSafe:!0}),isSafe:e=>!0===e.logSafe,censored:e=>!0===e.logSafe?e:(0,n.failure)(void 0)}},57991:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.valuePreviewPluginDependenciesResolved=t.ValuePreviewPlugin=void 0;const n=r(74643),a=r(2340),i=r(44544),o=r(98468),s=r(1765),u=r(30070),l=r(36159),c=r(73701),d=r(82438),g=r(28648),m=r(50013),h=r(73513),p=r(93336);var f=r(53972).types.SpecialFormat;const S=r(27308),v=r(60140),F=r(10048),y=r(91903),C=r(12893),A=y.PluginRegistry.create(p.PluginFactoryName.ValuePreviewPlugin,p.PluginGroup.Excel);let E=(()=>{let e,t,r,i=[A.x10Plugin()],o=[],p=[];return t=class{*run({text:e,index:t,length:r,activeCell:n}){if((0,l.isNone)(e)||(0,l.isNone)(t)||(0,l.isNone)(r))return b("missing request arguments"),null;if(t<0||t+r>e.length)return b(`invalid selection, ${e.length}, ${t}, ${r}`),null;const i=yield{kind:a.ComputationRequestKind.GetActiveCell};if(i.kind!==a.ComputationRequestKind.GetActiveCell)return{kind:"Failure",index:t,length:r,reason:"GetActiveCell failed"};let o,p=i.activeCell;if((0,l.isNone)(n)||(0,l.isNone)(n.sheetName)||function(e,t){const r=[];return e.sheet.index!==t.sheetName&&r.push("sheet"),e.range.col!==t.firstColumn&&r.push("col"),e.range.row!==t.firstRow&&r.push("row"),r.length>0&&c.ulsLogger.ULS.traceTag(507777486,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Info,`ValuePreviewPlugin.areCellsEqual - active cell diff: ${r.join(",")}`),0===r.length}(p,n)){const t=yield{kind:a.ComputationRequestKind.ParseActiveCell,formulaText:e};if(t.kind!==a.ComputationRequestKind.ParseActiveCell||!(0,s.isSuccess)(t.result))return null;if(t.result.value.kind!==u.EditKind.Formula)return null;o=t.result.value.formula}else{const t=(0,v.unsafeGridRange)(n.firstRow,n.firstColumn,1,1);p=(0,v.sheetGridCell)((0,v.sheetIndex)(p.sheet.document,n.sheetName),t);const r=yield{kind:a.ComputationRequestKind.ParseCellFormula,cell:p,formula:{formulaBarText:e,kind:S.FormulaKind.CellFormula},useEnglishLocaleInfo:!1};if(r.kind!==a.ComputationRequestKind.ParseCellFormula||!(0,s.isSuccess)(r.result))return null;o=r.result.value}const F=function(e,t,r,n){let a;a=0===t?{start:1,end:r>0?r:e.length}:{start:t,end:t+r};const i=new g.ValuePreviewVisitor(n,a.start,a.end,e);let o;if((0,m.reduceBottomUp)(i,n),o=0===r?{start:0===t?t:i.subFormulaStart,end:i.subFormulaEnd}:{start:t,end:t+r},-1===o.start||o.end===o.start||i.isBadSelection||r>0&&!function(e,t){const r=0===t.start||Object.keys(e.spans).some((r=>e.spans[Number(r)]?.start===t.start)),n=Object.keys(e.spans).some((r=>e.spans[Number(r)]?.end===t.end));return r&&n}(n,o))return(0,s.failure)("invalid selection");const u=e.substring(o.start,o.end);return(0,s.success)({subFormula:u,subFormulaSpan:o,isVolatile:i.isVolatile,hasCrossWorkbookRef:i.hasCrossWorkbookRef,letDefinitions:i.letDefinitions})}(e,t,r,o);if("Success"!==F.kind)return null;let{subFormula:y}=F.value;const{subFormulaSpan:C,isVolatile:A,letDefinitions:E,hasCrossWorkbookRef:R}=F.value,T={index:C.start,length:C.end-C.start},k=yield{kind:a.ComputationRequestKind.GetConfig};if(k.kind!==a.ComputationRequestKind.GetConfig)return{kind:"Failure",...T,reason:"GetConfig failed"};(0,l.isDefined)(E)&&(y=E+k.config.localeInfo.listSeparator+y+")");const N=(y.startsWith("=")?"":"=")+y;if("="===N)return{kind:"Failure",...T,reason:"Empty formula"};if(R)return{kind:"Failure",evaluatedFormula:N,...T,reason:"Cross workbook reference"};const I=yield{kind:a.ComputationRequestKind.GetActiveCellFormat};if(I.kind!==a.ComputationRequestKind.GetActiveCellFormat)return b("GetActiveCellFormat failed"),{kind:"Unavailable",evaluatedFormula:N,...T,isVolatile:A,reason:"GetActiveCellFormat failed"};if(!(0,s.isSuccess)(I.result)||(0,l.isNone)(I.result.value))return b("Empty cell format"),{kind:"Unavailable",evaluatedFormula:N,...T,isVolatile:A,reason:"Empty cell format"};const O={kind:f.Edit,renderBlanksAsZeros:!0,isWholeFormula:N===e},_=yield{kind:a.ComputationRequestKind.EvalFormula,formula:N,origin:{sheet:p.sheet,range:{col:p.range.col,row:p.range.row,rows:1,cols:1}},format:O};if(_.kind!==a.ComputationRequestKind.EvalFormula)return{kind:"Failure",evaluatedFormula:N,...T,reason:"EvalFormula failed"};const P=new h.ValuePreviewResultExtractor(k.config).fromEvalFormulaOutput(_.result);switch(P.kind){case"Success":return{...P,evaluatedFormula:N,...T,isVolatile:A};case"Unavailable":return{kind:P.kind,evaluatedFormula:N,...T,isVolatile:A,reason:P.reason};case"Failure":return{kind:P.kind,evaluatedFormula:N,...T,reason:P.reason}}}constructor(){n.__runInitializers(this,p)}},n.__setFunctionName(t,"ValuePreviewPlugin"),(()=>{const a="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[A.uiMessageHandler({kind:C.RequestKind.valuePreview})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:a},null,p),n.__esDecorate(null,e={value:t},i,{kind:"class",name:t.name,metadata:a},null,o),t=e.value,a&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:a})})(),t.factory=A.injectPluginFactory(),n.__runInitializers(t,o),t})();function b(e){c.ulsLogger.ULS.traceTag(521692767,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Warning,`ValuePreviewPlugin encountered a failure with msg ${e}`)}t.ValuePreviewPlugin=E,(0,i.registerPluginFactory)(E.factory),t.valuePreviewPluginDependenciesResolved=(0,F.trackableAsyncLazy)((async()=>{const e=await o.workerThreadSpread.getValue();await e.createAndAttachPlugin(p.PluginFactoryName.ValuePreviewPlugin),await o.schedulerWithRecalcServiceAttached.getValue()}),"valuePreviewPluginDependenciesResolved")},73513:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ValuePreviewResultExtractor=void 0;const n=r(36159),a=r(1765),i=r(83970),o=r(96978),s=r(30070),u=r(14009),l=r(64562),c=r(73701),d=r(43268);t.ValuePreviewResultExtractor=class{fromEvalFormulaOutput({value:e,formatted:t}){switch(e.kind){case a.ResultKind.Success:return this.resultFromSuccess(e.value,t);case a.ResultKind.Failure:return this.resultFromFailureReason(e.reason);default:return e}}resultFromSuccess(e,t){let r;switch(e.kind){case i.OperKind.String:case i.OperKind.Array:case i.OperKind.Blank:case i.OperKind.Number:r=this.resultFromFormatted(t);break;case i.OperKind.Boolean:r=this.resultFromBoolean(e);break;case i.OperKind.Error:r=this.resultFromError(e,t);break;default:return{kind:"Failure",reason:`Unsupported operKind: ${e.kind}`}}if("Success"!==r.kind)return r;const n=this.getUnformattedValue(e,r);return{...r,unformattedValue:n,operKind:e.kind}}resultFromFormatted(e){if((0,n.isNone)(e))return{kind:"Failure",reason:"No formatted value"};switch(e.kind){case a.ResultKind.Success:if((0,s.isHashesValue)(e.value)){const r=e.value.units;return t=`Evaluate HashesValue: ${r.kind}`,c.ulsLogger.ULS.traceTag(520680450,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Warning,`ValuePreviewResultExtractor encountered a failure with msg ${t}`),{kind:"Failure",reason:`HashesValue: ${r.kind}`}}return this.resultFromFormattedValue(e.value);case a.ResultKind.Failure:return this.resultFromFailureReason(e.reason);default:return e}var t}resultFromFormattedValue(e){const t=l.render.renderValue(this.mathpack,e,s.renderInfiniteWidth);return t.kind===a.ResultKind.Failure?{kind:"Failure",reason:"renderValue fail"}:(0,s.isHashesValue)(t.value)?{kind:"Failure",reason:`Render HashesValue: ${t.value.units.kind}`}:{kind:"Success",value:(0,s.renderedValueToString)(t.value),color:e.color}}resultFromFailureReason(e){const t=function(e){switch(e.kind){case u.ReasonKind.Unavailable:return`Unavailable - [${e.objects.map((e=>"kind"in e?e.kind:"")).join(",")}]`;case u.ReasonKind.NotImplemented:return`NotImplemented - [${e.features.join(",")}]`;case u.ReasonKind.PreviousFailure:return"PreviousFailure";default:return`${e.kind}`}}(e);switch(e.kind){case u.ReasonKind.Unavailable:case u.ReasonKind.NotImplemented:case u.ReasonKind.PreviousFailure:return{kind:"Unavailable",reason:`FailureReason: ${t}`};default:return{kind:"Failure",reason:`Unsupported FailureReason: ${t}`}}}resultFromError(e,t){switch(e.type){case o.ErrorType.NAME:case o.ErrorType.VALUE:case o.ErrorType.FIELD:return{kind:"Unavailable",reason:`Unsupported error: ${e.type}`}}return this.resultFromFormatted(t)}getUnformattedValue(e,t){let r=t.value;return e.kind===i.OperKind.String&&(t.value=`"${t.value}"`,r=e.value),e.kind===i.OperKind.Number&&(r=this.mathpack.toNumber(e).toString()),e.kind===i.OperKind.Blank&&(r=this.mathpack.toNumber(this.mathpack.zero).toString()),r}resultFromBoolean(e){const t=e.value?this.localeInfo.trueName:this.localeInfo.falseName;return{kind:"Success",value:t,unformattedValue:t,operKind:i.OperKind.Boolean}}constructor(e){this.mathpack=e.mathpack,this.localeInfo=e.localeInfo}}},28648:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ValuePreviewVisitor=void 0;const n=r(73701),a=r(82438),i=r(36159),o=r(12973),s=r(27437),u=r(50013),l=r(66761);class c extends u.IdentityVisitor{appNode(e,t,r,n){const a=super.appNode(e,t,r,n);return this.tryUpdateAppNodeAsSubFormula(e,a),a}literalNode(e,t,r){const n=super.literalNode(e,t,r);return this.tryUpdateNodeAsSubFormula(n),n}missingNode(e,t){const r=super.missingNode(e,t);return this.tryUpdateNodeAsSubFormula(r),r}arrayNode(e,t,r){const n=super.arrayNode(e,t,r);return this.tryUpdateNodeAsSubFormula(n),n}cellRefNode(e,t,r){const n=super.cellRefNode(e,t,r);return this.validateSelection(r,"whole"),this.tryAddCrossWorkbookRef(t,r),this.tryUpdateNodeAsSubFormula(n)&&(this.isRefNode=!0),n}fieldRefNode(e,t,r){const n=super.fieldRefNode(e,t,r);return this.validateSelection(r,"prefix"),this.tryUpdateNodeAsSubFormula(n),n}structRefNode(e,t,r){const n=super.structRefNode(e,t,r);return this.validateSelection(r,"prefix"),this.tryUpdateNodeAsSubFormula(n)&&(this.isRefNode=!0),n}nameNode(e,t,r){const n=super.nameNode(e,t,r);return this.validateSelection(r,"prefix"),this.tryUpdateNodeAsSubFormula(n)&&(this.isRefNode=!0),n}badSequenceNode(e,t,r){const n=super.badSequenceNode(e,t,r);return t.some((e=>e.label===this.nodeLabel))&&(this.updateNodeAsSubFormula(n),this.isBadSelection=!0),n}parenNode(e,t,r){const n=super.parenNode(e,t,r);return t&&this.tryUpdateNodeAsSubFormula(n),n}letNode(e,t,r,n,a,i){const o=super.letNode(e,t,r,n,a,i),s=this.parsedFormulaTree.spans[i];return this.isMatchingArg(s,!0)&&this.updateLetNodeAsSubFormula(o),o}wsfNode(e,t,r){const n=super.wsfNode(e,t,r);return this.validateSelection(r,"none"),n}operatorNode(e,t){const r=super.operatorNode(e,t);return this.validateSelection(t,"none"),r}tryUpdateNodeAsSubFormula(e){return!!this.isMinimalMatchingSpan(this.parsedFormulaTree.spans[e.label])&&(this.updateNodeAsSubFormula(e),!0)}tryUpdateAppNodeAsSubFormula(e,t){if(e.kind!==o.NodeKind.WSF&&e.kind!==o.NodeKind.Operator)return void n.ulsLogger.ULS.traceTag(509347166,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,`ValuePreviewVisitor - visitor encountered higher order function, kind: ${e.kind}`);const r=this.parsedFormulaTree.spans[e.label],i=this.parsedFormulaTree.spans[t.label];this.tryAddVolatileFunction(e,t),this.isMatchingAppNode(r,i,e.kind,t.isClosed)&&this.updateNodeAsSubFormula(t)}updateLetNodeAsSubFormula(e){const t=this.parsedFormulaTree.spans[e.head.label],r=this.parsedFormulaTree.spans[e.label];if(this.isMatchingAppNode(t,r,o.NodeKind.WSF,e.isClosed))this.updateNodeAsSubFormula(e);else for(let t=0;t<e.args.length;t++){const n=e.args[t],a=this.parsedFormulaTree.spans[n.label];if(!(0,i.isDefined)(a))return;if(this.isMatchingArg(a,!0)){if(1===t)return;const o=t%2==0,s=e.args.length-2,u=o?Math.min(s,t+1):t-2,l=this.parsedFormulaTree.spans[e.args[u].label];if(!(0,i.isDefined)(l))return;const c=this.formula.substring(r.start,l.end);this.letDefinitions=c,this.isVolatile=this.checkIntersectionWithVolatileFunction(r),this.hasCrossWorkbookRef=this.checkIntersectionWithCrossWorkbookRef(r),this.isMinimalMatchingSpan(a)&&(this.subFormulaStart=a.start,this.subFormulaEnd=a.end,this.nodeLabel=n.label)}}}updateNodeAsSubFormula(e){const t=this.parsedFormulaTree.spans[e.label];this.subFormulaStart=t.start,this.subFormulaEnd=t.end,this.nodeLabel=e.label,this.isVolatile=this.checkIntersectionWithVolatileFunction(t),this.hasCrossWorkbookRef=this.checkIntersectionWithCrossWorkbookRef(t)}isMinimalMatchingSpan(e){return-1===this.nodeLabel&&this.isMatchingArg(e)}isMatchingArg(e,t=!1){return!!(0,i.isDefined)(e)&&(this.selectionStart===this.selectionEnd?this.selectionStart>=e.start&&this.selectionEnd<e.end:t?this.selectionStart>=e.start&&this.selectionEnd<=e.end:this.selectionStart===e.start&&this.selectionEnd===e.end)}isMatchingAppNode(e,t,r,n){if(!(0,i.isDefined)(e)||!(0,i.isDefined)(t)||!n)return!1;if(this.selectionStart===this.selectionEnd)switch(r){case o.NodeKind.WSF:return this.selectionStart===e.end||this.selectionStart===t.end-1||this.selectionStart>=e.start&&this.selectionStart<e.end;case o.NodeKind.Operator:return this.selectionStart>=e.start-e.pre.length&&this.selectionStart<e.end+e.post.length}else if(e.start<=this.selectionStart&&this.selectionEnd<=e.end)return this.isBadSelection=!0,!1;return this.selectionStart===t.start&&this.selectionEnd===t.end}tryAddVolatileFunction(e,t){if(e.kind!==o.NodeKind.WSF)return;if(!t.isClosed)return;const r=this.parsedFormulaTree.spans[t.label];(0,i.isNone)(r)||(0,s.isVolatileFunc)(e.id)&&this.volatileFunctions.push({start:r.start,end:r.end})}checkIntersectionWithVolatileFunction(e){return this.volatileFunctions.some((t=>e.start<=t.start&&e.end>=t.end))}tryAddCrossWorkbookRef(e,t){if(!this.isCrossWorkbookRefDetectionEnabled)return;if(!e||e.kind!==o.QualifierKind.Sheet&&e.kind!==o.QualifierKind.SheetRange&&e.kind!==o.QualifierKind.Document)return;if((0,i.isNone)(e.document))return;const r=this.parsedFormulaTree.spans[t];(0,i.isNone)(r)||this.crossWorkbookRefs.push({start:r.start,end:r.end})}checkIntersectionWithCrossWorkbookRef(e){return!!this.isCrossWorkbookRefDetectionEnabled&&this.crossWorkbookRefs.some((t=>e.start<=t.start&&e.end>=t.end))}validateSelection(e,t){if(this.selectionStart===this.selectionEnd)return;const r=this.parsedFormulaTree.spans[e];if((0,i.isDefined)(r)&&!(this.selectionStart<r.start||this.selectionEnd>r.end))switch(t){case"prefix":return void(this.selectionStart!==r.start&&(this.isBadSelection=!0));case"suffix":return void(this.selectionEnd!==r.end&&(this.isBadSelection=!0));case"whole":return void(this.selectionStart===r.start&&this.selectionEnd===r.end||(this.isBadSelection=!0));case"none":return void(this.isBadSelection=!0)}}constructor(e,t,r,n){super(),this.parsedFormulaTree=e,this.selectionStart=t,this.selectionEnd=r,this.formula=n,this.subFormulaStart=-1,this.subFormulaEnd=-1,this.isBadSelection=!1,this.isRefNode=!1,this.isVolatile=!1,this.hasCrossWorkbookRef=!1,this.letDefinitions=void 0,this.volatileFunctions=[],this.crossWorkbookRefs=[],this.nodeLabel=-1,this.isCrossWorkbookRefDetectionEnabled=(0,l.getBooleanFeatureGate)("Microsoft.Office.Excel.ValuePreviewDisableCrossWorkbookRefs",!1)}}t.ValuePreviewVisitor=c},56748:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.chatGPTPluginAttach=t.parserPerformanceMeasurementsAttach=t.autocompleteBinaryModelExperimentPluginAttach=t.autocompleteRangeSuggestionPluginAttach=t.autocompleteWrapperPluginAttach=t.autocompletePluginDependenciesResolved=void 0;const n=r(93336),a=r(98468),i=r(10048),o=r(60756),s=(0,i.trackableAsyncLazy)((async()=>{const e=await a.workerThreadSpread.getValue();return await e.loadPluginScript((0,o.isTypedChangeGateEnabled)("OfficeVSO:9215233_AutocompleteCompleteWebpack5")?"excelOnlineAutocomplete":"excelOnlineAutocompleteWP5",!1),e}),"threadWithExcelOnlineAutocompleteScriptLoaded");t.autocompletePluginDependenciesResolved=(0,i.trackableAsyncLazy)((async()=>{const e=await s.getValue();await e.createAndAttachPlugin(n.PluginFactoryName.AutocompletePlugin),await a.schedulerWithRecalcServiceAttached.getValue()}),"autocompletePluginDependenciesResolved"),t.autocompleteWrapperPluginAttach=(0,i.trackableAsyncLazy)((async()=>{const e=await s.getValue();await e.createAndAttachPlugin(n.PluginFactoryName.AutocompleteWrapperPlugin)}),"autocompleteWrapperPluginAttach"),t.autocompleteRangeSuggestionPluginAttach=(0,i.trackableAsyncLazy)((async()=>{const e=await s.getValue();await e.createAndAttachPlugin(n.PluginFactoryName.AutocompleteRangeSuggestionPlugin)}),"autocompleteRangeSuggestionPluginAttach"),t.autocompleteBinaryModelExperimentPluginAttach=(0,i.trackableAsyncLazy)((async()=>{const e=await s.getValue();await e.createAndAttachPlugin(n.PluginFactoryName.AutocompleteBinaryModelExperimentPlugin)}),"autocompleteBinaryModelExperimentPluginAttach"),t.parserPerformanceMeasurementsAttach=(0,i.trackableAsyncLazy)((async()=>{const e=await s.getValue();await e.createAndAttachPlugin(n.PluginFactoryName.ParserPerformanceMeasurements)}),"parserPerformanceMeasurementsAttach"),t.chatGPTPluginAttach=(0,i.trackableAsyncLazy)((async()=>{const e=await s.getValue();await e.createAndAttachPlugin(n.PluginFactoryName.ChatGPTPlugin)}),"chatGPTPluginAttach")},86585:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CacheGrid=void 0;const n=r(70052),a=r(73812),i=r(59731),o=r(91662),s=r(98396),u=r(12179),l=r(86270),c=r(46124),d=r(89817),g=r(68120),m=r(26795),h=r(57786),p=r(84817);function f(e){switch(e.kind){case"number":return p.mathpackXL.xlMathpack.fromNumber(e.value);case"string":return(0,g.stringOper)(e.stringValue);case"bool":return(0,g.booleanOper)(e.boolValue);case"error":return(0,g.errorOper)(e.errorKind??g.ErrorType.UNKNOWN);case"rich":return{kind:g.OperKind.Rich,getFallback:()=>(0,g.errorOper)(g.ErrorType.FIELD),getField(){}};case"blank":return g.blankOper}}t.CacheGrid=class{get readonlyDataModel(){return this.calcGrid.dataModel.getDocs()}writeRange(e,t){const r=this.sheetRangeToSheetGridRange(t.range);if(void 0===r)return;const{hiddenRowSet:n,hiddenColSet:a}=this.populateHiddenCells(t,r,e),i=(0,o.sheetCellSet)(r.sheet,(0,d.createFromProduct)({row:n,col:a}));this.calcGrid.dataModel.writeCellContents(e,i,"",!1,(0,s.gridCell)(r.range.row,r.range.col),g.blankOper,void 0,void 0);const{visibleRows:u,visibleCols:l}=function(e,t,r){const{row:n,col:a,rows:i,cols:s}=e.range,u=(0,m.except)(o.bspFactory.row([n,n+i]),t),l=(0,m.except)(o.bspFactory.col([a,a+s]),r),c=[];(0,h.forEachRow)(u,(([e,t])=>{for(let r=e;r<t;r++)c.push(r);return!0}));const d=[];return(0,h.forEachCol)(l,(([e,t])=>{for(let r=e;r<t;r++)d.push(r);return!0})),{visibleRows:c,visibleCols:d}}(r,n,a);for(let n=0;n<t.values.length;n++){const a=t.values[n],i=u[n];for(let u=0;u<a.length;u++){const c=a[u],d=l[u],g=(0,s.gridCell)(i,d);this.calcGrid.dataModel.writeCellContents(e,(0,o.sheetCellSet)(r.sheet,(0,h.createCellSetFromRange)(g)),t.formulae[n][u].formulaText,t.formulae[n][u].isFormula,g,f(c),t.iformats[n][u],void 0)}}}get sheets(){return this.readonlyDataModel.getSingleReadonlyDocument()?.getReadonlySheets()}get nameManager(){return this.readonlyDataModel.getSingleReadonlyDocument()?.getReadonlyNameManager()}get config(){return this.readonlyDataModel.config}consumePartialWorkbookMessages(){for(;!this.calcGrid.dataModel.step().queueEmpty;);}populateHiddenCells(e,t,r){const a=e.hiddenRows.reduce(((e,{startInclusive:t,endExclusive:r})=>(0,o.union)(e,o.bspFactory.row([t,r]))),o.empty),i=e.hiddenCols.reduce(((e,{startInclusive:t,endExclusive:r})=>(0,o.union)(e,o.bspFactory.col([t,r]))),o.empty),s=(0,n.sheetGridRangeToHiddenRows)(t,a),u=(0,n.sheetGridRangeToHiddenCols)(t,i);return this.calcGrid.dataModel.writeHiddenRows(r,s),this.calcGrid.dataModel.writeHiddenCols(r,u),{hiddenRowSet:a,hiddenColSet:i}}sheetRangeToSheetGridRange(e){const t=this.calcGrid.dataModel.getDocs().getSheetIndex(this.calcGrid.document,e.sheetName);if(t.kind!==l.ResultKind.Failure&&(0,l.isDefined)(t.value))return(0,s.sheetGridRange)((0,s.sheetIndex)(this.calcGrid.document,t.value),(0,c.rangeToGridRange)(e))}constructor(){this.calcGrid=(0,u.makeCalcGrid)(),this.recalcSideGrid=new i.RecalcSideGrid(this.calcGrid),this.schedulerFeatures=[],this.setSchedulerFeatures=e=>{this.schedulerFeatures=e},this.setA1ReferenceStyle=(...e)=>{this.calcGrid.setA1ReferenceStyle(...e),this.consumePartialWorkbookMessages()},this.setLocale=(...e)=>{this.calcGrid.setLocale(...e),this.consumePartialWorkbookMessages()},this.setWorkbookProps=(...e)=>{this.calcGrid.setWorkbookProps(...e),this.consumePartialWorkbookMessages()},this.updateSheetNames=(...e)=>{this.calcGrid.updateSheetNames(...e),this.consumePartialWorkbookMessages()},this.updateNamedObjects=(...e)=>{this.calcGrid.updateNamedObjects(...e),this.consumePartialWorkbookMessages()},this.setNumberFormats=(...e)=>{this.calcGrid.setNumberFormats(...e),this.consumePartialWorkbookMessages()},this.getStateAsNotifications=()=>[],this.getDocumentLoc=(...e)=>this.readonlyDataModel.getDocumentLoc(...e),this.getSheetIndex=(...e)=>this.readonlyDataModel.getSheetIndex(...e),this.getSheetName=(...e)=>this.readonlyDataModel.getSheetName(...e),this.getNameLoc=(...e)=>this.readonlyDataModel.getNameLoc(...e),this.getUserDefinedFuncLoc=(...e)=>this.readonlyDataModel.getUserDefinedFuncLoc(...e),this.getSheetRangeIndexes=(...e)=>this.readonlyDataModel.getSheetRangeIndexes(...e),this.getContainingTable=(...e)=>this.readonlyDataModel.getContainingTable(...e),this.getStructRefSpecialRef=(...e)=>this.readonlyDataModel.getStructRefSpecialRef(...e),this.getStructRefColumn=(...e)=>this.readonlyDataModel.getStructRefColumn(...e),this.getRangeValues=(...e)=>this.recalcSideGrid.getRangeValues(...e),this.getRangeFormulae=(...e)=>this.recalcSideGrid.getRangeFormulae(...e),this.getRangeFormats=(...e)=>this.recalcSideGrid.getRangeFormats(...e),this.getSheetNames=(...e)=>this.recalcSideGrid.getSheetNames(...e),this.getIntersectingTables=(...e)=>this.recalcSideGrid.getIntersectingTables(...e),this.getIformats=(...e)=>this.recalcSideGrid.getIformats(...e),this.getHiddenRows=(...e)=>this.recalcSideGrid.getHiddenRows(...e),this.getHiddenCols=(...e)=>this.recalcSideGrid.getHiddenCols(...e),this.discardSnapshot=async(...e)=>this.recalcSideGrid.discardSnapshot(...e),this.evalClonedModelOnSnapshot=(...e)=>this.recalcSideGrid.evalClonedModelOnSnapshot(...e),this.evalFormulaOnSnapshot=(...e)=>this.recalcSideGrid.evalFormulaOnSnapshot(...e),this.getCorrespondingSnapshotID=(...e)=>this.recalcSideGrid.getCorrespondingSnapshotID(...e),this.calcGrid.dataModel.setNumberFormats(this.calcGrid.document,a.knownFormatData,!1,-1/0)}}},95767:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChatGPTPlugin=void 0;const n=r(74643),a=r(93336),i=r(36159),o=r(44544),s=r(2340),u=r(91903),l=r(12893),c=u.PluginRegistry.create(a.PluginFactoryName.ChatGPTPlugin,a.PluginGroup.Excel);let d=(()=>{let e,t,r,a=[c.x10Plugin()],o=[],u=[];return t=class{*run(e){const t=e.query;if(!(0,i.isDefined)(t))return null;const r=yield{kind:s.ComputationRequestKind.CreateChatGPTSession,options:e.context};if(r.kind!==s.ComputationRequestKind.CreateChatGPTSession)throw new Error("Inconsistent yield request response type");const n=yield{kind:s.ComputationRequestKind.SendChatGPTQuery,session:r.result,request:t};if(n.kind!==s.ComputationRequestKind.SendChatGPTQuery)throw new Error("Inconsistent yield request response type");const a=yield{kind:s.ComputationRequestKind.SendChatGPTQuery,session:r.result,request:"Explain your answer"};if(a.kind!==s.ComputationRequestKind.SendChatGPTQuery)throw new Error("Inconsistent yield request response type");return{result:n.result,details:a.result}}constructor(){n.__runInitializers(this,u)}},n.__setFunctionName(t,"ChatGPTPlugin"),(()=>{const i="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[c.uiMessageHandler({kind:l.RequestKind.chatGPTQuery})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:i},null,u),n.__esDecorate(null,e={value:t},a,{kind:"class",name:t.name,metadata:i},null,o),t=e.value,i&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:i})})(),t.factory=c.injectPluginFactory(),n.__runInitializers(t,o),t})();t.ChatGPTPlugin=d,(0,o.registerPluginFactory)(d.factory)},38257:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChatGPTService=void 0;const n=r(36159),a=r(1765);t.ChatGPTService=class{async createSession(e){const t=await this.provider.openChat(e);return(0,n.isDefined)(t)?(this.set.add(t),(0,a.success)(t)):(0,a.failure)(void 0)}async closeSession(e){if(!this.set.has(e))return(0,a.failure)(void 0);try{return await this.provider.close(e),this.set.delete(e),(0,a.success)(void 0)}catch{return(0,a.failure)(void 0)}}async request(e,t){if(!this.set.has(e))return(0,a.failure)(void 0);try{const r=await this.provider.send(e,t);return(0,a.success)(r)}catch{return(0,a.failure)(void 0)}}constructor(e){this.provider=e,this.set=new Set}}},3459:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.conflictResolver=void 0;const n=r(36159),a=r(93336),i=r(93336),o=r(73701),s=r(96926),u=r(62886),l=r(82438),c=r(15787);t.conflictResolver={runTest:g,runExperiment:g,runAuthoringExperiment:g,runPerCharacterExperiment:g,argumentAssistance:m,valuePreview:m,gotoCtrlClick:m,formulaRepair:m,chatGPTQuery:m,columnFormulaSuggestion:m,setCellPrefetch:m,getTranspiledFormulas:m,inCellControlsAutodetection:m,inCellSuggestion(e){for(const[{factoryName:t},r]of e)if(t===i.PluginFactoryName.AutocompleteRangeSuggestionPlugin&&(0,n.isDefined)(r))return r;return null},formulaHighlighting(e){if(e.length>0){let t=[];for(const[r,a]of e){const e=a.formulaHighlights?.filter(n.isDefined);void 0!==e&&(t=t.concat(e))}const r=(e,t)=>(0,n.isDefined)(e.span)&&(0,n.isDefined)(t.span)?(0,u.spanCompare)(e.span,t.span):(0,n.isDefined)(e)?1:(0,n.isDefined)(t)?-1:0;return t.sort(r),{formulaHighlights:t}}return null},functionSuggestion(e){let t;const r={Simple:[],Smart:[],Enum:[]};return e.forEach((([e,i])=>{i.items.filter(n.isDefined).filter((e=>(0,n.isDefined)(e.textEdit)||(0,n.isDefined)(e.label))).forEach((e=>{return r[(t=e,t.kind===a.CompletionItemKind.Enum?"Enum":t.type===a.SuggestionKind.Smart?"Smart":"Simple")].push(e);var t})),(0,n.isDefined)(i.data)&&(o.ulsLogger.ULS.assertTag(506804355,l.LogCategory.msoulscat_ES_EWAJS,!(0,n.isDefined)(t),"Multiple smart suggestions data received"),t=i.data)})),{items:r.Enum.length>0?[...r.Enum]:[...r.Smart,...r.Simple.sort((function(e,t){if((0,n.isDefined)(e.label)&&(0,n.isDefined)(t.label)){if((0,n.isDefined)(e.isPrefixed)&&(0,n.isDefined)(t.isPrefixed)&&e.isPrefixed!==t.isPrefixed)return e.isPrefixed?-1:1;if(d.includes(e.kind)&&d.includes(t.kind)){const r=(0,s.getStructRefCompletionItemRank)(e),n=(0,s.getStructRefCompletionItemRank)(t);if(r!==n)return n-r}return e.label.toLocaleLowerCase()>t.label.toLocaleLowerCase()?1:-1}return(0,n.isDefined)(e.label)?1:(0,n.isDefined)(t.label)?-1:0}))],data:t}}};const d=[a.CompletionItemKind.TableHeader,a.CompletionItemKind.TableSpecialStructRef];function g(e){const t=[];for(const[r,{results:a}]of e)(0,n.isDefined)(a)&&t.push(...a.filter(n.isDefined));return{results:t}}function m(e){if(0===e.length)return null;const[t,r]=e[0];if(1===e.length)return r;c.computationRegistry.UIMessage.getRegistrationByComputationIdentifier(t);const n=c.computationRegistry.UIMessage.getRegistrationByComputationIdentifier(t)?.kind;throw new Error(`Conflict resolver: ${n}: ${e.length} results received, while only one active plugin is currently supported`)}(0,n.staticAssertExtends)()},7496:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.customConflictResolverFactories=t.FunctionSuggestionAndArgumentAssistanceConflictResolver=void 0;const n=r(87919),a=r(36159),i=r(91988),o=r(12893),s=r(73701),u=r(66761),l=r(93336);class c{consumeResult(e){if((0,u.isChangeGateEnabled)("OfficeVSO:7640530_InCellSuggestionRequestResolverEnabledV2"))switch(e.kind){case o.RequestKind.functionSuggestion:(0,s.assertTrue)("functionSuggestionSet should be false when receiving functionSuggestion request",!this.functionSuggestionSet),this.functionSuggestionResult=e.result,this.functionSuggestionSet=!0,this.resolvePromiseIfPossible();break;case o.RequestKind.argumentAssistance:(0,s.assertTrue)("argumentAssistanceSet should be false when receiving argumentAssistance request",!this.argumentAssistanceSet),this.argumentAssistanceResult=e.result,this.argumentAssistanceSet=!0,this.resolvePromiseIfPossible();break;case o.RequestKind.inCellSuggestion:(0,s.assertTrue)("inCellSuggestionSet should be false when receiving inCellSuggestion request",!this.inCellSuggestionSet),this.inCellSuggestionResult=e.result,this.inCellSuggestionSet=!0,this.resolvePromiseIfPossible();break;default:(0,s.assertNever)(`unknown result: ${e}`,e)}else switch(e.kind){case o.RequestKind.functionSuggestion:if((0,s.assertTrue)("functionSuggestionSet should be false when receiving functionSuggestion request",!this.functionSuggestionSet),(0,a.isDefined)(e.result)&&(0,a.isDefined)(e.result.items)&&e.result.items.length>0&&e.result.items[e.result.items.length-1]?.type===l.SuggestionKind.Simple)return this.promise.resolve({functionSuggestion:e.result,argumentAssistance:null,inCellSuggestion:null});if(this.argumentAssistanceSet)return null!==this.argumentAssistanceResult?this.promise.resolve({functionSuggestion:null,argumentAssistance:this.argumentAssistanceResult,inCellSuggestion:null}):this.promise.resolve({functionSuggestion:e.result,argumentAssistance:null,inCellSuggestion:null});this.functionSuggestionResult=e.result,this.functionSuggestionSet=!0;break;case o.RequestKind.argumentAssistance:if((0,s.assertTrue)("argumentAssistanceSet should be false when receiving argumentAssistance request",!this.argumentAssistanceSet),this.functionSuggestionSet)return null!==e.result?this.promise.resolve({functionSuggestion:null,argumentAssistance:e.result,inCellSuggestion:null}):this.promise.resolve({functionSuggestion:this.functionSuggestionResult,argumentAssistance:null,inCellSuggestion:null});this.argumentAssistanceResult=e.result,this.argumentAssistanceSet=!0;break;case o.RequestKind.inCellSuggestion:break;default:(0,s.assertNever)(`unknown result: ${e}`,e)}}static create(){return new c}resolvePromiseIfPossible(){if(this.functionSuggestionSet){if((0,a.isDefined)(this.functionSuggestionResult)&&(0,a.isDefined)(this.functionSuggestionResult.items)&&this.functionSuggestionResult.items.length>0)return this.functionSuggestionResult.items[length-1]?.type===l.SuggestionKind.Smart&&((0,s.assertTrue)("can't get argument assistance and smart suggestion at the same time",!this.argumentAssistanceSet||null==this.argumentAssistanceResult),(0,s.assertTrue)("can't get in cell suggestion and smart suggestion at the same time",!this.inCellSuggestionSet||null==this.inCellSuggestionResult?.completionItem)),this.promise.resolve({functionSuggestion:this.functionSuggestionResult,argumentAssistance:null,inCellSuggestion:null});if(this.argumentAssistanceSet&&this.inCellSuggestionSet)return this.promise.resolve({functionSuggestion:this.functionSuggestionResult,argumentAssistance:this.argumentAssistanceResult,inCellSuggestion:this.inCellSuggestionResult})}}constructor(){this.argumentAssistanceResult=null,this.functionSuggestionResult=null,this.inCellSuggestionResult=null,this.argumentAssistanceSet=!1,this.functionSuggestionSet=!1,this.inCellSuggestionSet=!1,this.promise=new i.ResolvablePromise}}t.FunctionSuggestionAndArgumentAssistanceConflictResolver=c,(0,a.staticAssertExtends)(),t.customConflictResolverFactories={[n.CustomConflictResolverStrategy.FunctionSuggestionAndArgumentAssistance]:c},(0,a.staticAssertExtends)()},87919:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeBatchRequester=t.customConflictResolverPluginKinds=t.CustomConflictResolverStrategy=void 0;const n=r(2340),a=r(12893),i=r(36159);var o;!function(e){e.FunctionSuggestionAndArgumentAssistance="FunctionSuggestionAndArgumentAssistance"}(o||(t.CustomConflictResolverStrategy=o={})),t.customConflictResolverPluginKinds={[o.FunctionSuggestionAndArgumentAssistance]:[a.RequestKind.functionSuggestion,a.RequestKind.argumentAssistance,a.RequestKind.inCellSuggestion]},t.makeBatchRequester=function(e){return{functionSuggestionAndArgumentAssistance(t,r,a){if((0,i.isNone)(t))return Promise.resolve(null);const{functionSuggestion:s,argumentAssistance:u,inCellSuggestion:l}=t;return(0,i.isNone)(s)||(0,i.isNone)(u)||(0,i.isNone)(l)?Promise.resolve(null):e.doBatchRequest({strategy:o.FunctionSuggestionAndArgumentAssistance,functionSuggestion:s,argumentAssistance:u,inCellSuggestion:l},r,a??n.DefaultComputationGroup)}}},(0,i.staticAssertExtends)(),(0,i.staticAssertExtends)(),(0,i.staticAssertExtends)(),(0,i.staticAssertExtends)(),(0,i.staticAssertExtends)()},69966:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dynamicPluginLoaderInsideInit=t.timelineQueueProcessorFactory=t.createPrefetchingCacheFactory=t.DynamicPluginLoader=void 0;const n=r(74643).__importStar(r(11093)),a=r(82438),i=r(53411),o=r(53411),s=r(73506),u=r(73701),l=r(44544),c=r(36159),d=r(3541),g=r(3541),m=r(62370),h=r(46870),p=r(4595),f=r(56134),S=r(53710);class v{loadPluginScriptTrace(e,t){u.ulsLogger.ULS.traceTag(553734797,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,f.x10Logger.formatLogMessage("loadPluginScript",{description:`${e} loaded, time to load ${t}`}))}async createAndAttachPlugin(e,t){const r=(0,l.getPluginFactory)(e);this.scheduler.createAndAttachPlugin(r,t)}constructor(e,t){if(!(t instanceof o.FormulaBarScheduler))throw new TypeError(`DynamicPluginLoaderBase.constructor: unknown IFormulaBarScheduler class: ${JSON.stringify(t)}`);this.scheduler=t,f.x10Logger.threadId=e}}class F extends v{async loadPluginScript(e,t){if((0,c.isNone)(e)||(0,c.isNone)(t))return;const r=g.defaultTimerInterface,n=r.now();await this.loader.loadScript(e);const a=r.now()-n;this.loadPluginScriptTrace(e,a)}isThreadingSupported(){return n.isThreadingSupported()&&void 0!==(0,s.getCalcAbsUrl)()}async createPluginThread(e){const t=`DynamicPluginLoaderThread-${F.lastThreadNum+=1}-${e}`,r=`${t}-IGrid`;await s.initCalcCalled;const o=await n.createWorker({createMode:"Thread",id:t},n.paramInsideDef({scriptUrl:(0,s.getCalcAbsUrlOrThrow)(),insideInitName:this.threadEntryPoint},{pluginResponseWindows:this.scheduler.getPluginResponseWindows()}),(()=>({...(0,h.bindMethods)(this.scheduler,[...i.parentMethodsCall,...i.parentMethodsPost]),resolveScript:this.resolveScript})));try{let e=()=>{};o.onClose=()=>{e(),u.ulsLogger.ULS.traceTag(553734798,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,f.x10Logger.formatLogMessage("DynamicPluginLoader",{description:"Thread closed"}))};const t=await(0,s.initCalcThread)(o);e=()=>t.close(),this.scheduler.doNotifyStatelessSubject.subscribe((e=>o.post.processNotification(e))),this.scheduler.requestWithCorrelationIdSubject.subscribe((e=>o.post.requestWithCorrelationId(...e))),this.scheduler.doNotifyStatefulSubject.subscribe((e=>o.post.processNotification(e)));const n={createIGridImportEndpoint:e=>o.call.createIGridImportEndpoint.transfer([e.port],e),onGridExporterClosed:o.post.onGridExporterClosed};return this.gridManager.onGridImporterCreated(n,r),new y(o)}catch(e){throw o.close(),e}}constructor(e,t,r,n){super("Main",r),this.threadEntryPoint=e,this.gridManager=t,this.loader=n;const a=n.getConfig();this.resolveScript=a.resolveScript}}t.DynamicPluginLoader=F,F.lastThreadNum=0;class y{loadPluginScript(e,t){return this.outside.call.loadPluginScript(e,t)}createAndAttachPlugin(e,t){return this.outside.call.createAndAttachPlugin(e,t)}recalcServiceAttached(){return this.outside.call.recalcServiceAttached()}close(){this.outside.close()}constructor(e){this.outside=e}}t.createPrefetchingCacheFactory=e=>(...t)=>{const r=e.getGrid();if(void 0!==r)return S.PrefetchingCache.create(r,...t)},t.timelineQueueProcessorFactory=e=>t=>new d.TimelineQueueProcessor(((e,t)=>e.kind-t.kind),t,void 0,e),t.dynamicPluginLoaderInsideInit=(e,t)=>async({config:r,connection:a},{pluginResponseWindows:s})=>n.Endpoint.createInside(a,(n=>{const u={...(0,h.bindLazyMethods)(new p.ResettableLazy((()=>n.call)),i.parentMethodsCall),...(0,h.bindLazyMethods)(new p.ResettableLazy((()=>n.post)),i.parentMethodsPost)},l=void 0,c=new m.GridProvider((()=>d.registerAsyncGrid())),d=new o.FormulaBarScheduler(e(l),t(c),s,c.getGridDataSink(),c.getSyncDataModel(),l,u);return new C(String(a.options.id),c,d,r,n)}));class C extends v{async loadPluginScript(e,t){if((0,c.isNone)(e)||(0,c.isNone)(t))return;if(!0===this.loadedScripts[e])return;const r=g.defaultTimerInterface,a=r.now();n.importScriptsWithRetry([await this.inside.call.resolveScript({identifier:e,isLocalized:t})],s.maxRetriesForLoadingScript);const i=r.now()-a;this.loadedScripts[e]=!0,this.loadPluginScriptTrace(e,i)}recalcServiceAttached(){return this.scheduler.recalcServiceAttached()}constructor(e,t,r,n,a){super(e,r),this.gridImporter=t,this.twConfig=n,this.inside=a,this.loadedScripts=(0,c.makeStringMap)(),this.initCalcThreadInside=async(e,t,r)=>{await(0,s.initCalcInThread)(e,t,r,this.twConfig)},this.createIGridImportEndpoint=this.gridImporter.createIGridImportEndpoint.bind(this.gridImporter),this.onGridExporterClosed=this.gridImporter.onGridExporterClosed.bind(this.gridImporter),this.processNotification=this.scheduler.processNotification.bind(this.scheduler),this.requestWithCorrelationId=this.scheduler.requestWithCorrelationId.bind(this.scheduler)}}},24221:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.experimentQueueProcessorFactory=t.ExperimentQueueProcessor=void 0;const n=r(36159),a=r(66329),i=r(2340);class o{enqueue(e,t,r){(0,n.isDefined)(r)&&e.kind===i.SchedulerTimelineQueueMessageKind.StopComputationFrame||this.queue.enqueue(e)}step(){const e=this.queue.pop();(0,n.isDefined)(e)&&this.consumeMessage(e)}get done(){return 0===this.queue.getCount()}constructor(e){this.consumeMessage=e,this.queue=new a.PriorityQueue((()=>0))}}t.ExperimentQueueProcessor=o,t.experimentQueueProcessorFactory=e=>new o(e),(0,n.staticAssertExtends)()},46870:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultMap=t.functionMapToGenericFunction1stArg=t.mapFromArrayOfDependantPairs=t.asReadonly=t.bindMethodsNullCheck=t.bindMethodsUnbox=t.bindLazyMethods=t.bindMethods=t.functionMapFromDUFunction=t.staticTypeHint=void 0;const n=r(36159);t.staticTypeHint=function(e){},n.staticAssertSame,n.staticAssertSame,n.staticAssertSame,n.staticAssertSame,t.functionMapFromDUFunction=function(e,t){const r={};for(const n of t)r[n]=(...t)=>e(n,...t);return r},t.bindMethods=function(e,t){const r={};for(const n of t){const t=(...t)=>e[n](...t);r[n]=t}return r},t.bindLazyMethods=function(e,t){const r={};for(const n of t){const t=(...t)=>e.getValue()[n](...t);r[n]=t}return r},n.staticAssertSame,n.staticAssertSame,n.staticAssertSame,n.staticAssertSame;class a{unbox(e){return(...t)=>e(t)}nullcheck(e){return(...t)=>{for(const e of t)if((0,n.isNone)(e))return null;return e(...t)}}}function i(e){const t=new a,r=t[e].bind(t);return function(e,t){const n={};for(const a of t){const t=e[a].bind(e);n[a]=r(t)}return n}}t.bindMethodsUnbox=i("unbox"),t.bindMethodsNullCheck=i("nullcheck");{const e={methodF:e=>e+1,methodG:([e])=>e+1},r=(0,t.bindMethodsUnbox)(e,["methodG"]);n.staticAssertSame,(0,t.bindMethodsNullCheck)(e,["methodG"]),n.staticAssertSame,(0,t.bindMethodsNullCheck)(r,["methodG"]),n.staticAssertSame}function o(e){return e.reduce(((e,[t,r])=>(e[t]=r,e)),{})}t.asReadonly=function(e){return e},t.mapFromArrayOfDependantPairs=o,o([["a",1],["b",2]]),n.staticAssertSame,t.functionMapToGenericFunction1stArg=function(e){return(t,r,...n)=>e[t].call(e,r,...n)},t.DefaultMap=class{get(e){const t=this.operations.getKey(e),r=this.map.get(t);if(void 0!==r)return r;const n=this.operations.getDefault();return this.map.set(t,n),n}set(e,t){this.map.set(this.operations.getKey(e),t)}delete(e){this.map.delete(this.operations.getKey(e))}constructor(e){this.operations=e,this.map=new Map}}},53411:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldRunComputation=t.FormulaBarScheduler=t.parentMethodsPost=t.parentMethodsCall=void 0;const n=r(60140),a=r(93336),i=r(36159),o=r(36159),s=r(36159),u=r(73701),l=r(57993),c=r(2340),d=r(31712),g=r(2340),m=r(14143),h=r(36873),p=r(1765),f=r(3541),S=r(64327),v=r(3459),F=r(91988),y=r(7496),C=r(87919),A=r(89293),E=r(3028),b=r(55186),R=r(20364),T=r(66329),k=r(4595),N=r(60756),I=r(62469),O=r(56134),_=r(38257),P=r(86761),M=r(86441),D=r(46870),w=r(25722),L=r(44700),x=r(15787),K=r(9319),W=r(9319),U=r(9319),G=r(91301),B=r(40664),V=r(44994);class j{create(){return this.current+=1}constructor(){this.current=0}}const H=(0,D.mapFromArrayOfDependantPairs)((0,i.numEnumArray)(a.PluginFactoryName).map((e=>[e,a.PluginFactoryName[e]])));t.parentMethodsCall=["createChatGPTSession","closeChatGPTSession","sendChatGPTQuery","sendAugLoopSignal","registerALAnnotation","getRecognizedTablesInfo"],t.parentMethodsCall,t.parentMethodsPost=["addResult","addToComputationCount","triggerEventImmediate"],(0,o.staticAssertSame)();const q={kind:b.InternalSchedulerResponseKind.FirstStep},$={[h.NotificationKind.setActiveCell]:!0,[h.NotificationKind.setActiveCellFormat]:!0,[h.NotificationKind.doNothing]:!0},z=(0,N.getTypedFeatureGate)("Microsoft.Office.Excel.PluginResponseWindowDebugTimeExtension");class Q{setFunctionInfo(e){if((0,s.isNone)(e))return void u.ulsLogger.ULS.traceTag(512274762,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,O.x10Logger.formatLogMessage("setFunctionInfo",{description:"functionsInfo was none"}));const t={};for(const r of e)(0,s.isDefined)(r)&&(t[r.NameDataStrings]=r);this.state={...this.state,functionsInfoMap:t},u.ulsLogger.ULS.traceTag(512274761,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,O.x10Logger.formatLogMessage("setFunctionInfo",{description:"set functionsInfoMap"}))}setDefinedNamesInfo(e){if((0,s.isNone)(e))return void u.ulsLogger.ULS.traceTag(512274760,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,O.x10Logger.formatLogMessage("setDefinedNamesInfo",{description:"definedNamesInfo was none"}));const t={};for(const r of e)(0,s.isDefined)(r)&&(0,s.isDefined)(r.name)&&(t[r.name.toUpperCase()]=r);this.state={...this.state,definedNamesInfoMap:t},u.ulsLogger.ULS.traceTag(512274759,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,O.x10Logger.formatLogMessage("setDefinedNamesInfo",{description:"set definedNamesInfoMap"}))}onWorkbookClosing(){O.x10Logger.flush()}getPluginResponseWindows(){return this.pluginResultWindows}setPluginResponseWindow(e,t,r){this.pluginResultWindows[e]={startDelta:t,stopDelta:r}}consumeMessage(e){switch(e.kind){case g.SchedulerTimelineQueueMessageKind.StepComputation:this.stepComputation(e.computation,e.payload);break;case g.SchedulerTimelineQueueMessageKind.NoOpRequest:case g.SchedulerTimelineQueueMessageKind.SyncRequest:case g.SchedulerTimelineQueueMessageKind.AsyncRequest:const t=this.timer.now();this.processRequest(e.computation,e.request,{onFulfilled:t=>{if(t.kind===p.ResultKind.Success)return this.enqueueMessage({kind:g.SchedulerTimelineQueueMessageKind.StepComputation,computation:e.computation,payload:{kind:b.InternalSchedulerResponseKind.NormalResponse,response:t.value}}),t.value;const r=V.logSafeFailure.censored(t);return this.enqueueMessage({kind:g.SchedulerTimelineQueueMessageKind.StepComputation,computation:e.computation,payload:{kind:b.InternalSchedulerResponseKind.RequestFailure,request:e.request.kind,failure:r}}),r},onRejected:()=>{const t=(0,p.failure)(void 0);return this.enqueueMessage({kind:g.SchedulerTimelineQueueMessageKind.StepComputation,computation:e.computation,payload:{kind:b.InternalSchedulerResponseKind.RequestFailure,request:e.request.kind,failure:t}}),t}}),e.computation.info.schedulerTime+=this.timer.now()-t;break;case g.SchedulerTimelineQueueMessageKind.StopComputationFrame:this.stopComputationFrame(e.correlationId,e.computationGroup,e.type,e.computationKind,g.ExecutionStopReason.Frame.Timeout);break;case g.SchedulerTimelineQueueMessageKind.Timeout:e.callback();break;default:(0,u.assertNever)(`unknown message: ${e}`,e)}}enqueueMessage(e,t){const r=Q.abstractStepCosts[e.kind];this.processor.enqueue(e,r,t)}stepComputation(e,t){const r=this.responseStates[e.info.type][e.info.computationKind].computationFrame(e.info.computationGroup);if(e.info.correlationId===r?.correlationId)try{const r=this.timer.now(),n=Y(e.generator,t);if(e.info.computationTime+=this.timer.now()-r,!0!==n.done){const t=n.value;this.enqueueMessage((0,b.wrapRequest)(t,e))}else this.addResultAndFinalizeComputationFrame(e,{kind:"Successful",message:n.value},g.ExecutionStopReason.Computation.Done)}catch(t){this.addResultAndFinalizeComputationFrame(e,{kind:"Exception"},g.ExecutionStopReason.Computation.Exception),O.x10Logger.log({kind:"failure",payload:{failureKind:O.X10FailureKind.PluginFailure,failureLevel:l.TraceLevel.Warning,path:"FormulaBarScheduler.stepComputation",description:`plugin threw exception: ${t} during computation`,data:e.info}})}else e.finalizer.finalize(e,e.stopReasonRef.value)}addResultAndFinalizeComputationFrame(e,t,r){return e.finalizer.finalize(e,r),this.addResult(e.info,t)}addResult(e,t,r){const n=this.responseStates[e.type][e.computationKind].computationFrame(e.computationGroup);if(this.parent||r?.forEach((e=>O.x10Logger.log(...e))),void 0===n||n.correlationId>e.correlationId)return;if(n.correlationId<e.correlationId&&O.x10Logger.log({kind:"failure",payload:{failureKind:O.X10FailureKind.AssertionFailure,failureLevel:l.TraceLevel.Warning,path:"FormulaBarScheduler.addResult",description:`main scheduler corelationID (${n.correlationId}) is less than the child one (${e.correlationId})`}}),this.parent){const n=[...r??[],...O.x10Logger.flushBufferedMessages()];this.parent.addResult(e,t,n)}switch(t.kind){case"Successful":n.successfulResults.results.push([e.computationIdentifier,t.message]);break;case"Exception":n.numFailures+=1;break;case"Skipped":n.numSkippedComputations+=1;break;default:(0,u.assertNever)("unknown result",t)}const a=this.x10GetNumOfComputationsFromFrameEnabled?function(e){switch(!0){case e.numFailures+e.numSkippedComputations+e.successfulResults.results.length!==e.numOfComputations:return;case e.numFailures===e.numOfComputations:return g.ExecutionStopReason.Computation.Exception;case e.numSkippedComputations===e.numOfComputations:return g.ExecutionStopReason.Computation.Skipped;default:return g.ExecutionStopReason.Computation.Done}}(n):function(e){return e.numFailures+e.numSkippedComputations+e.successfulResults.results.length}(n)===this.responseStates[e.type][e.computationKind].numComputations?g.ExecutionStopReason.Computation.Done:void 0;void 0!==a&&this.stopComputationFrame(n.correlationId,e.computationGroup,e.type,e.computationKind,a)}processRequest(e,t,{onFulfilled:r,onRejected:n}){const a=this.responseStates[e.info.type][e.info.computationKind],i=a.computationFrame(e.info.computationGroup);if(e.info.correlationId!==i?.correlationId)return e.finalizer.finalize(e,e.stopReasonRef.value),n(V.logSafeFailure.failure("Computation timed out"));const o=this.timer.now(),s=(0,R.processRequest)(R.requestProcessorMap,t,e,a.computationFrame(e.info.computationGroup)?.cache,a.computationFrame(e.info.computationGroup)?.config);return(0,S.bindMaybeThenable)(s,(n=>(this.addProcessingTime(e,t.kind,o),n.kind!==p.ResultKind.Success&&O.x10Logger.log({kind:"failure",payload:{failureKind:O.X10FailureKind.RequestProcessorFailure,failureLevel:l.TraceLevel.Warning,path:"FormulaBarScheduler.processRequest",description:"request returned a scheduler-side failure",data:{...e.info,failedRequest:t.kind,failedReason:V.logSafeFailure.censored(n)}}}),r(n))),(r=>(this.addProcessingTime(e,t.kind,o),O.x10Logger.log({kind:"failure",payload:{failureKind:O.X10FailureKind.RequestProcessorFailure,failureLevel:l.TraceLevel.Error,path:"FormulaBarScheduler.processRequest",description:"request processor threw",data:{...e.info,failedRequest:t.kind,error:(0,E.messageFromError)(r)}}}),n(r))))}addProcessingTime(e,t,r){const n=this.timer.now(),a=e.info.requestTimes[t];return a?(a.requestDuration=a.requestDuration+n-r,a.numberOfRequests+=1,a.timeSinceLastRequest=n-e.lastTimestamp):e.info.requestTimes[t]={requestDuration:n-r,numberOfRequests:1,timeSinceLastRequest:n-e.lastTimestamp},e.lastTimestamp=n,n}stopComputationFrame(e,t,r,n,a){const i=this.responseStates[r][n];e===i.computationFrame(t)?.correlationId&&i.stop(t,a,this.timer.now())}recalcServiceAttached(){return this.recalcServiceAttachedPromise.toPromise()}chatGPTProviderAttached(){return this.chatGPTProviderAttachedPromise.toPromise()}tableIntelligenceServiceAttached(){return this.tableIntelligenceServiceAttachedPromise.toPromise()}getFunctionsShortDescriptions(){return A.functionShortDescriptions.getValue()}getSchedulerFeatures(){return(0,D.asReadonly)(this.syncDataModel.schedulerFeatures)}isSchedulerFeatureEnabled(e){return-1!==this.getSchedulerFeatures().indexOf(e)}doNotify(...e){u.ulsLogger.ULS.traceTag(512274758,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,O.x10Logger.formatLogMessage("FormulaBarScheduler.doNotify",{description:`received notification of kind:\n       ${e[0]}\n      `})),this.enqueueNotification(e),e[0]!==h.NotificationKind.setSchedulerFeatures&&e[0]!==h.NotificationKind.notifyWorkbookClosing||this.processNotifications()}enqueueNotification(e){const t=this.notificationQueue.length-1,r=this.notificationQueue[t];if(void 0===r)this.notificationQueue.push(e),u.ulsLogger.ULS.traceTag(512274757,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,O.x10Logger.formatLogMessage("FormulaBarScheduler.enqueueNotification",{description:`queue empty, notification of kind:\n         ${e[0]} pushed to queue\n        `}));else{const[n]=r,[a]=e;n===a&&!0===$[n]?(this.notificationQueue[t]=e,u.ulsLogger.ULS.traceTag(512274756,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,O.x10Logger.formatLogMessage("FormulaBarScheduler.enqueueNotification",{description:`notification of kind:\n           ${e[0]} overrode previous notification\n          `}))):(this.notificationQueue.push(e),u.ulsLogger.ULS.traceTag(512274755,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,O.x10Logger.formatLogMessage("FormulaBarScheduler.enqueueNotification",{description:`couldn't coalesce, notification of kind:\n           ${e[0]} pushed to queue\n          `})))}}processNotifications(){for(const e of this.notificationQueue)u.ulsLogger.ULS.traceTag(512274754,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,O.x10Logger.formatLogMessage("FormulaBarScheduler.processNotifications",{description:`processing notification of kind:\n         ${e[0]}\n        `})),this.processNotification(e);this.notificationQueue.length=0}processNotification(e){const[t,r]=e;switch(this.notificationProcessorMap[t](...r),t){case h.NotificationKind.setA1ReferenceStyle:case h.NotificationKind.setLocale:case h.NotificationKind.setWorkbookProps:case h.NotificationKind.updateSheetNames:case h.NotificationKind.updateNamedObjects:case h.NotificationKind.setSchedulerFeatures:this.doNotifyStatefulSubject.next(e);break;default:this.doNotifyStatelessSubject.next(e)}}requestWithCorrelationId(...[e,t,r,n,a,i,o]){const s=this.timer.now(),l=this.responseStates[e][t];l.closeFrame(o,g.ExecutionStopReason.Frame.Superseded,s);const c=this.createPrefetchingCache(this.syncDataModel,a),d=this.computationResultWindows[e][t],m=l.createFrame(a,o,w.asyncGlobalExecutionMode,n,c,this.syncDataModel.config,s,d);0===this.responseStates[e][t].numComputations?(O.x10Logger.log({kind:"requestSkipped",payload:{computationKind:t,computationGroup:o}}),m.resolve({kind:"Done",payload:{kind:t,results:[]}})):O.x10Logger.log({kind:"beginRequest",payload:{correlationId:a,computationKind:t,computationGroup:o}});const h=l.computationFrame(o);return(0,u.assertTrue)("`frame` should be always defined at this point",void 0!==h),this.computationSubjects[e][r.time][t].next([h,i]),d.stopDelta<1/0&&this.enqueueMessage({kind:g.SchedulerTimelineQueueMessageKind.StopComputationFrame,correlationId:a,computationGroup:o,type:e,computationKind:t},s+d.stopDelta+z),this.requestWithCorrelationIdSubject.next([e,t,r,n,a,i,o]),m}syncRequestWithCorrelationId(e,t,r,n,a,i,o){const s=this.timer.now(),l=this.responseStates[e][t];l.closeFrame(o,g.ExecutionStopReason.Frame.Superseded,s);const c=this.createPrefetchingCache(this.syncDataModel,a),d=this.computationResultWindows[e][t],m=l.createFrame(a,o,w.syncGlobalExecutionMode,n,c,this.syncDataModel.config,s,d);O.x10Logger.log({kind:"beginRequest",payload:{correlationId:a,computationKind:t,computationGroup:o}});const h=l.computationFrame(o);(0,u.assertTrue)("`frame` should be always defined at this point",void 0!==h),this.computationSubjects[e][r.time][t].next([h,i]);const p=s+d.stopDelta+z,[f,S]=this.runToCompletion(c,this.syncDataModel.config,p);return l.closeFrame(o,f,this.timer.now()),m.resolve({kind:"Done",payload:{kind:t,results:[]}}),{kind:t,results:S}}runToCompletion(e,t,r){const n=[];let a=this.timer.now();for(let i=this.syncMessageQueue.pop();void 0!==i;i=this.syncMessageQueue.pop(),a=this.timer.now()){if(a>=r){i.computation.finalizer.finalize(i.computation,g.ExecutionStopReason.Frame.Timeout);break}let o;switch(i.kind){case g.SchedulerTimelineQueueMessageKind.StepComputation:{const{computation:e,payload:t}=i;try{const r=Y(e.generator,t);if(e.info.computationTime+=this.timer.now()-a,!0!==r.done){const t=r.value;this.syncMessageQueue.enqueue((0,b.wrapSyncRequest)(t,e))}else this.addResult(e.info,{kind:"Successful",message:r.value}),e.finalizer.finalize(e,g.ExecutionStopReason.Computation.Done),n.push([e.info.computationIdentifier,r.value])}catch(t){u.ulsLogger.ULS.traceTag(538581056,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Warning,O.x10Logger.formatLogMessage("FormulaBarScheduler.runToCompletion",{description:"plugin threw exception during computation",data:e.info})),e.finalizer.finalize(e,g.ExecutionStopReason.Computation.Exception)}}break;case g.SchedulerTimelineQueueMessageKind.NoOpRequest:case g.SchedulerTimelineQueueMessageKind.SyncRequest:const r=(0,R.processSyncRequest)(R.requestProcessorMap,i.request,i.computation,e,t);o=this.addProcessingTime(i.computation,i.request.kind,a),i.computation.info.schedulerTime+=o-a,r.kind===p.ResultKind.Success?this.syncMessageQueue.enqueue({kind:g.SchedulerTimelineQueueMessageKind.StepComputation,computation:i.computation,payload:{kind:b.InternalSchedulerResponseKind.NormalResponse,response:r.value}}):(O.x10Logger.log({kind:"failure",payload:{failureKind:O.X10FailureKind.RequestProcessorFailure,failureLevel:l.TraceLevel.Warning,path:"FormulaBarScheduler.runToCompletion",description:"request returned a scheduler-side failure",data:{...i.computation.info,failedRequest:i.request.kind}}}),this.syncMessageQueue.enqueue({kind:g.SchedulerTimelineQueueMessageKind.StepComputation,computation:i.computation,payload:{kind:b.InternalSchedulerResponseKind.RequestFailure,request:i.request.kind,failure:V.logSafeFailure.censored(r)}}));break;default:(0,u.assertNever)(`unknown message: ${i}`,i)}}return this.syncMessageQueue.clear(),[!(0,s.isDefined)(r)||a<r?g.ExecutionStopReason.Computation.Done:g.ExecutionStopReason.Frame.Timeout,n]}triggerEventImmediate(e,t){if(this.parent)return this.parent.triggerEventImmediate(e,t);this.triggerEvent(e,t)}triggerEvent(e,t){return this.processNotifications(),this.doRequestUntyped(L.ComputationType.Event,e,t,void 0,this.eventComputationGroupFactory.create().toString())}doRequest(e,t,r,n){return this.isEnabledProcessNotificationsAfterShouldRunPlugin&&!this.shouldRunRequest(L.ComputationType.UIMessage,e,t,r,w.asyncGlobalExecutionMode)?this.wrapResults(L.ComputationType.UIMessage,this.skippedRequest(e,n)):(this.processNotifications(),this.doRequestUntyped(L.ComputationType.UIMessage,e,t,r,n))}skippedRequest(e,t){O.x10Logger.log({kind:"requestSkipped",payload:{computationKind:e,computationGroup:t}});const r=new F.ResolvablePromise;return r.resolve({kind:"Done",payload:{kind:e,results:[]}}),r}async wrapResults(e,t){const r=await this.resolveConflicts(e,t);return"Superseded"===r.kind?r:{...r,payload:r.payload.result}}async doRequestUntyped(e,t,r,n,a){const i=this.requestWithCorrelationId(e,t,w.asyncGlobalExecutionMode,r,this.idFactory.create(),n,a);return this.wrapResults(e,i)}doSyncRequest(e,t,r,n){return this.isEnabledProcessNotificationsAfterShouldRunPlugin&&!this.shouldRunRequest(L.ComputationType.UIMessage,e,t,r,w.syncGlobalExecutionMode)?this.wrapSyncResponse(L.ComputationType.UIMessage,this.skippedSyncRequest(e,n)):(this.processNotifications(),this.doSyncRequestUntyped(L.ComputationType.UIMessage,e,t,r,n))}skippedSyncRequest(e,t){return O.x10Logger.log({kind:"requestSkipped",payload:{computationKind:e,computationGroup:t}}),{kind:e,results:[]}}wrapSyncResponse(e,t){return this.syncResolveConflicts(e,t).result}doSyncRequestUntyped(e,t,r,n,a){let i;if(0===this.responseStates[e][t].numSyncComputations)i=this.skippedSyncRequest(t,a);else{const o=this.idFactory.create();i=this.syncRequestWithCorrelationId(e,t,w.syncGlobalExecutionMode,r,o,n,a)}return this.wrapSyncResponse(e,i)}async resolveConflicts(e,t){const r=await t;return"Superseded"===r.kind?r:{kind:"Done",payload:this.syncResolveConflicts(e,r.payload)}}syncResolveConflicts(e,t){const r=t.results.filter((([,e])=>(0,s.isDefined)(e)));return{kind:t.kind,result:this.conflictResolvers[e][t.kind](r)}}async doBatchRequest(e,t,r){this.isEnabledProcessNotificationsAfterShouldRunPlugin||this.processNotifications();const n=this.idFactory.create(),a=C.customConflictResolverPluginKinds[e.strategy],i=y.customConflictResolverFactories[e.strategy].create(),o=a.map((()=>!0)),s=new F.ResolvablePromise;for(let u=0;u<a.length;u+=1){const d=a[u],g=e[d];let m;this.isEnabledProcessNotificationsAfterShouldRunPlugin&&!this.shouldRunRequest(L.ComputationType.UIMessage,d,g,t,w.asyncGlobalExecutionMode)?m=this.skippedRequest(d,r??c.DefaultComputationGroup):(this.processNotifications(),m=this.requestWithCorrelationId(L.ComputationType.UIMessage,d,w.asyncGlobalExecutionMode,g,n,t,r??c.DefaultComputationGroup)),this.resolveConflicts(L.ComputationType.UIMessage,m).then((e=>{if(o[u]=!1,"Superseded"===e.kind)s.resolve({kind:"Superseded"});else{const t=e.payload;i.consumeResult(t)}}),(()=>{O.x10Logger.log({kind:"failure",payload:{failureKind:O.X10FailureKind.CustomConflictResolverFailure,failureLevel:l.TraceLevel.Error,path:"FormulaBarScheduler.doBatchRequest",description:`Custom conflict resolver "${e.strategy}" got an exception for plugin kind "${d}". Skipping kind`}}),o[u]=!1,i.consumeResult({kind:d,result:null})}))}const u=(0,S.bindMaybeThenable)(i.promise,(e=>({kind:"Done",payload:e}))),d=await Promise.race([s,u]);for(let e=0;e<a.length;e+=1){const t=a[e];o[e]&&(this.doNotify(h.NotificationKind.conflictResolverEarlyTermination,[n,r??c.DefaultComputationGroup,t]),this.processNotifications())}return d}async updatePrefetchingCache(e){const t=this.createPrefetchingCache(this.syncDataModel,this.idFactory.create()),r=await(e.cache?.getCorrespondingSnapshotID()),n=await(t?.getCorrespondingSnapshotID());return n!==r?(e.cache=t,n):r}notifier(){return this.notifierObject}eventEmitter(){return this.eventEmitterObject}alAnnotationNotifier(){return this.alAnnotationNotifierObject}requester(){return this.requesterObject}syncRequester(){return this.syncRequesterObject}localRequester(){return this.localRequesterObject}batchRequester(){return this.batchRequesterObject}setServerDataProvider(e){(0,s.isNone)(e)||(this.state={...this.state,serverDataProvider:e})}setActiveCellImpl(e){if((0,s.isNone)(e.docName)||(0,s.isNone)(e.sheetIndex))return void O.x10Logger.log({kind:"failure",payload:{failureKind:O.X10FailureKind.NotificationProcessorFailure,failureLevel:l.TraceLevel.Warning,path:"FormulaBarScheduler.setActiveCellImpl",description:"early exit, some of the arguments is None"}});const t=(0,n.documentLoc)(void 0,""),r=(0,n.unsafeGridRange)(e.rowIndex,e.colIndex,1,1),a=(0,n.sheetGridCell)((0,n.sheetIndex)(t,e.sheetIndex),r),i=Z(e);this.state={...this.state,activeCell:a,activeCellFormat:i},u.ulsLogger.ULS.traceTag(512274752,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,O.x10Logger.formatLogMessage("setActiveCellImpl",{description:`updated activeCell to col: ${a.range.col}, row: ${a.range.row}`}))}setActiveCellFormatImpl(e){const t=Z(e);this.state={...this.state,activeCellFormat:t}}getConfig(){return this.syncDataModel.config}startComputation(e,t,r,n,a,i){switch(r.time){case w.ExecutionTimeMode.Async:this.enqueueMessage({kind:g.SchedulerTimelineQueueMessageKind.StepComputation,computation:{...this.generateNewComputationInfo(e,t,n,i),generator:a},payload:q},i.startTime+i.timeWindow.startDelta);break;case w.ExecutionTimeMode.Sync:this.syncMessageQueue.enqueue({kind:g.SchedulerTimelineQueueMessageKind.StepComputation,computation:{...this.generateNewComputationInfo(e,t,n,i),generator:a},payload:q});break;default:(0,u.assertNever)(`${r}`,r)}}generateNewComputationInfo(e,t,r,n){return{info:{correlationId:n.correlationId,computationGroup:n.computationGroup,type:e,computationKind:t,computationIdentifier:r,pluginFactoryNameString:H[r.factoryName],computationTime:0,schedulerTime:0,requestTimes:{}},cache:n.cache,finalizer:new M.ComputationFinalizer(...this.computationFinalizerHandlers),stopReasonRef:n.stopReasonRef,schedulerState:this.state,lastTimestamp:this.timer.now()}}getPluginComputations(e){return[...x.computationRegistry.UIMessage.getRegistrationsByPluginIdentifier(e),...x.computationRegistry.Event.getRegistrationsByPluginIdentifier(e)]}createAndAttachPlugin(e,t){this.parent&&this.warmupParse.force();const r=e.create(t);for(const t of this.getPluginComputations(e))switch(t.type){case L.ComputationType.UIMessage:this.computationSubjects[t.type][t.execution.time][t.kind].subscribe(t.registrationMethod(this,r)),this.addToComputationCount(t);break;case L.ComputationType.Event:(0,K.isALAnnotationEventKind)(t.kind)&&this.registerALAnnotation(t.kind).catch((e=>{O.x10Logger.log({kind:"failure",payload:{failureKind:O.X10FailureKind.ALFailure,failureLevel:l.TraceLevel.Error,path:"FormulaBarScheduler.createAndAttachPlugin",description:`Failed to register on ${t.kind} AL annotation: ${e}`}})})),this.computationSubjects[t.type][t.execution.time][t.kind].subscribe(t.registrationMethod(this,r)),this.addToComputationCount(t);break;default:(0,u.assertNever)(`${t}`,t)}u.ulsLogger.ULS.traceTag(545378970,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,`x10arch.FormulaBarScheduler.createAndAttachPlugin: ${a.PluginFactoryName[e.factoryName]} was attached.`)}addToComputationCount(e){switch(this.parent&&this.parent.addToComputationCount({type:e.type,kind:e.kind,execution:e.execution,computationIdentifier:e.computationIdentifier}),e.execution.time){case w.ExecutionTimeMode.Async:this.responseStates[e.type][e.kind].attachComputation(e.computationIdentifier);break;case w.ExecutionTimeMode.Sync:this.responseStates[e.type][e.kind].attachSyncComputation(e.computationIdentifier)}}attachEventCallbacksManager(e){for(const t of K.ExternallyHandledEventKinds)(0,s.isDefined)(e[t])&&this.computationSubjects[L.ComputationType.Event][w.ExecutionTimeMode.Async][t].subscribe((([r,n])=>{try{e[t](r.computationInput)}catch(e){O.x10Logger.log({kind:"failure",payload:{failureKind:O.X10FailureKind.EventCallbacksManagerFailure,failureLevel:l.TraceLevel.Error,path:"FormulaBarScheduler.attachEventCallbacksManager",description:`Failed to call eventCallbacksManager.${t}: ${e}`}})}}))}async registerEventCallback(e,t){const r=await this.eventCallbackManagerCreated.getValue();(0,s.isDefined)(this.eventCallbackManagerAttachedPromise.getCurrentValue())||(this.eventCallbackManagerAttachedPromise.resolve(r),this.attachEventCallbacksManager(r)),r.registerEventCallback(e,t)}catchEvent(e){return new Promise(((t,r)=>{const n=this.computationSubjects[L.ComputationType.Event][w.ExecutionTimeMode.Async][e.eventKind].subscribe((([r,a])=>{(0,s.isDefined)(e.predicate)&&!e.predicate(r.computationInput)||(this.computationSubjects[L.ComputationType.Event][w.ExecutionTimeMode.Async][e.eventKind].unsubscribe(n),t((0,p.success)(r.computationInput)))}));this.enqueueMessage({kind:g.SchedulerTimelineQueueMessageKind.Timeout,type:L.ComputationType.Event,callback:()=>{this.computationSubjects[L.ComputationType.Event][w.ExecutionTimeMode.Async][e.eventKind].unsubscribe(n),t((0,p.failure)("Timeout"))}},this.timer.now()+e.timeout)}))}registerAsyncGrid(){this.recalcServiceAttachedPromise.resolve(void 0)}registerChatGPTProvider(e){const t=new _.ChatGPTService(e);return this.chatGPTProviderAttachedPromise.resolve(t)}registerALProvider(e){const t=new G.AugLoopService(e);return this.alManagerAttachedPromise.resolve(t)}async registerALAnnotation(e){if(void 0!==this.parent)return this.parent.registerALAnnotation(e);let t;try{t=await this.alManagerAttachedPromise}catch(e){return O.x10Logger.log({kind:"failure",payload:{failureKind:O.X10FailureKind.ALFailure,failureLevel:l.TraceLevel.Warning,path:"FormulaBarScheduler.registerALAnnotation",description:`Error getting AugLoopService: ${e}`}}),(0,p.failure)(e)}return t.registerALAnnotation(e)}registerTableIntelligenceProvider(e){this.tableIntelligenceServiceAttachedPromise.resolve(new B.X10TableIntelligenceService(e))}async getRecognizedTablesInfo(...e){if((0,s.isDefined)(this.parent))return this.parent.getRecognizedTablesInfo(...e);const t=this.tableIntelligenceServiceAttachedPromise.getCurrentValue();return(0,s.isDefined)(t)?t.getRecognizedRangeTablesInfo(...e):(O.x10Logger.log({kind:"failure",payload:{failureKind:O.X10FailureKind.TableIntelligenceFailure,failureLevel:l.TraceLevel.Warning,path:"FormulaBarScheduler.getRecognizedTablesInfo",description:"tableIntelligenceService is not attached yet"}}),(0,p.failure)(void 0))}async sendAugLoopSignal(e,t){if(void 0===this.parent){let r;try{r=await this.alManagerAttachedPromise.toPromise()}catch(e){return O.x10Logger.log({kind:"failure",payload:{failureKind:O.X10FailureKind.ALFailure,failureLevel:l.TraceLevel.Warning,path:"FormulaBarScheduler.sendAugLoopSignal",description:`Error getting AugLoopService: ${e}`}}),(0,p.failure)(e)}return r.sendSignal(e,t)}return this.parent.sendAugLoopSignal(e,t)}augloopCloseCallback(){u.ulsLogger.ULS.traceTag(508629987,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"x10arch.FormulaBarScheduler.augloopCloseCallback: Got close callback from AugLoop Manager")}async createChatGPTSession(e){return void 0===this.parent?(await this.chatGPTProviderAttached()).createSession(e):this.parent.createChatGPTSession(e)}async closeChatGPTSession(e){return void 0===this.parent?(await this.chatGPTProviderAttached()).closeSession(e):this.parent.closeChatGPTSession(e)}async sendChatGPTQuery(e,t){if(void 0===this.parent){const r=await this.chatGPTProviderAttached(),n=await r.request(e,t);return n.kind!==p.ResultKind.Success||(0,s.isDefined)(n.value)?((0,D.staticTypeHint)(n),n):(0,p.failure)(void 0)}return this.parent.sendChatGPTQuery(e,t)}shouldRunRequest(e,t,r,n,a){const i=this.responseStates[e][t],o=a.time===w.ExecutionTimeMode.Async?i.attachedComputations:i.attachedSyncComputations;for(const a of o)if(e!==L.ComputationType.UIMessage||J(e,t,a,n,r))return!0;return!1}constructor(e,t,r={...d.defaultPluginResponseWindows},a,i,o=f.defaultTimerInterface,c){this.createPrefetchingCache=t,this.pluginResultWindows=r,this.gridDataSink=a,this.syncDataModel=i,this.timer=o,this.parent=c,this.responseStates=(0,D.mapFromArrayOfDependantPairs)((0,s.strEnumArray)(L.ComputationType).map((e=>[e,(0,D.mapFromArrayOfDependantPairs)((0,s.strEnumArray)(L.ComputationKinds[e]).map((t=>[t,new g.ResponseState(e,t)])))]))),this.uiMessages=(0,D.mapFromArrayOfDependantPairs)((0,s.strEnumArray)(L.ComputationKinds[L.ComputationType.UIMessage]).map((e=>[e,new P.Subject]))),this.syncUIMessages=(0,D.mapFromArrayOfDependantPairs)((0,s.strEnumArray)(L.ComputationKinds[L.ComputationType.UIMessage]).map((e=>[e,new P.Subject]))),this.eventHandlers=(0,D.mapFromArrayOfDependantPairs)((0,s.strEnumArray)(L.ComputationKinds[L.ComputationType.Event]).map((e=>[e,new P.Subject]))),this.conflictResolvers={[L.ComputationType.UIMessage]:v.conflictResolver,[L.ComputationType.Event]:(0,s.mapFromArrayOfPairs)((0,s.strEnumArray)(L.ComputationKinds[L.ComputationType.Event]).map((e=>[e,()=>{}])))},this.computationSubjects={[L.ComputationType.UIMessage]:{[w.ExecutionTimeMode.Async]:this.uiMessages,[w.ExecutionTimeMode.Sync]:this.syncUIMessages},[L.ComputationType.Event]:{[w.ExecutionTimeMode.Async]:this.eventHandlers}},this.syncMessageQueue=new T.PriorityQueue((()=>0)),this.doNotifyStatelessSubject=new P.Subject,this.doNotifyStatefulSubject=new P.InitializingSubject((()=>this.syncDataModel.getStateAsNotifications())),this.requestWithCorrelationIdSubject=new P.Subject,this.idFactory=new j,this.eventComputationGroupFactory=new j,this.state={scheduler:this},this.notificationProcessorMap={[h.NotificationKind.setActiveCell]:this.setActiveCellImpl.bind(this),[h.NotificationKind.setActiveCellFormat]:this.setActiveCellFormatImpl.bind(this),[h.NotificationKind.setA1ReferenceStyle]:this.syncDataModel.setA1ReferenceStyle.bind(this.syncDataModel),[h.NotificationKind.setLocale]:this.syncDataModel.setLocale.bind(this.syncDataModel),[h.NotificationKind.setWorkbookProps]:this.syncDataModel.setWorkbookProps.bind(this.syncDataModel),[h.NotificationKind.updateSheetNames]:this.syncDataModel.updateSheetNames.bind(this.syncDataModel),[h.NotificationKind.updateNamedObjects]:this.syncDataModel.updateNamedObjects.bind(this.syncDataModel),[h.NotificationKind.doNothing]:()=>{},[h.NotificationKind.writeRange]:(...e)=>this.gridDataSink?.writeRange(...e),[h.NotificationKind.setNumberFormats]:(...e)=>this.gridDataSink?.setNumberFormats(...e),[h.NotificationKind.setFunctionsInfo]:this.setFunctionInfo.bind(this),[h.NotificationKind.conflictResolverEarlyTermination]:(e,t,r)=>this.stopComputationFrame(e,t,L.ComputationType.UIMessage,r,g.ExecutionStopReason.Frame.ConflictResolverEarlyTermination),[h.NotificationKind.setDefinedNamesInfo]:this.setDefinedNamesInfo.bind(this),[h.NotificationKind.notifyWorkbookClosing]:this.onWorkbookClosing.bind(this),[h.NotificationKind.setSchedulerFeatures]:this.syncDataModel.setSchedulerFeatures.bind(this.syncDataModel)},this.notifierObject=(0,m.makeNotifier)(this),this.eventEmitterObject=(0,U.makeEventEmitter)(this),this.alAnnotationNotifierObject=(0,W.makeALAnnotationNotifier)(this),this.requesterObject=(0,d.makeRequester)(this),this.syncRequesterObject=(0,d.makeSyncRequester)(this),this.localRequesterObject=(0,d.makeLocalRequester)(this),this.batchRequesterObject=(0,C.makeBatchRequester)(this),this.notificationQueue=[],this.isEnabledProcessNotificationsAfterShouldRunPlugin=(0,N.isTypedChangeGateEnabled)("OfficeVSO:8579351_x10ProcessNotificationsAfterShouldRunPlugin"),this.x10GetNumOfComputationsFromFrameEnabled=(0,N.isTypedChangeGateEnabled)("OfficeVSO:8557722_x10GetNumOfComputationsFromFrame"),this.eventResultWindows=(0,s.mapFromArrayOfPairs)((0,s.strEnumArray)(L.ComputationKinds[L.ComputationType.Event]).map((e=>[e,{startDelta:0,stopDelta:1/0}]))),this.computationResultWindows={[L.ComputationType.UIMessage]:this.pluginResultWindows,[L.ComputationType.Event]:this.eventResultWindows},this.recalcServiceAttachedPromise=new F.ResolvablePromise,this.chatGPTProviderAttachedPromise=new F.ResolvablePromise,this.alManagerAttachedPromise=new F.ResolvablePromiseWithTimeout(3e5,this.timer),this.tableIntelligenceServiceAttachedPromise=new F.ResolvablePromiseWithSyncValue,this.eventCallbackManagerAttachedPromise=new F.ResolvablePromiseWithSyncValue,this.eventCallbackManagerCreated=(0,k.asyncLazy)(K.makeEventCallbacksManager),this.computationFinalizerHandlers=[X],this.warmupParse=(0,k.asyncLazy)((async()=>{const e=this.createPrefetchingCache(this.syncDataModel,-1);if(e){const t=(0,n.documentLoc)(void 0,""),r=(0,n.sheetGridCell)((0,n.sheetIndex)(t,0),(0,n.gridCell)(1,1));e.parseEditSync(r,"=sum(5,7)",{formatString:"'GENERAL",builtIn:!0})}})),u.ulsLogger.ULS.traceTag(537796811,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,O.x10Logger.formatLogMessage("excelOnlineCalcPackages",{description:`${(0,I.getExcelOnlineCalcNewPackagesNames)()}`})),this.processor=e(this.consumeMessage.bind(this)),this.alManagerAttachedPromise.toPromise().catch((()=>{}))}}function Y(e,t){switch(t.kind){case b.InternalSchedulerResponseKind.FirstStep:return e.next();case b.InternalSchedulerResponseKind.NormalResponse:return e.next(t.response);case b.InternalSchedulerResponseKind.RequestFailure:return e.throw({kind:t.failure.kind,request:t.request,reason:t.failure.reason});default:(0,u.assertNever)("x10arch: FormulaBarScheduler.stepPlugin: unknown payload",t)}}function J(e,t,r,n,a){const i=x.computationRegistry[e].getRegistrationByComputationIdentifier(r)??{type:e,kind:t,modifiers:{},pluginGroup:n};return(0,x.getShouldRunComputationPredicate)(i)(a,n)}function X(e){O.x10Logger.log({kind:"computationStoppedExecution",payload:{computationName:`${e.computationInfo.pluginFactoryNameString}.${e.computationInfo.computationIdentifier.computationName}`,stopReason:e.stopReason,logInfo:e.computationInfo}}),e.stopReason===g.ExecutionStopReason.Computation.Done&&O.x10Logger.log({kind:"pluginCompletedInTime",payload:{pluginName:e.computationInfo.pluginFactoryNameString,logInfo:e.computationInfo}})}function Z(e){let t=null;return(0,s.isNone)(e.formatString)||(0,s.isNone)(e.builtIn)||(t={formatString:e.formatString,builtIn:e.builtIn}),t}t.FormulaBarScheduler=Q,Q.abstractStepCosts={[g.SchedulerTimelineQueueMessageKind.NoOpRequest]:.01,[g.SchedulerTimelineQueueMessageKind.AsyncRequest]:.1,[g.SchedulerTimelineQueueMessageKind.SyncRequest]:.5,[g.SchedulerTimelineQueueMessageKind.StepComputation]:1,[g.SchedulerTimelineQueueMessageKind.StopComputationFrame]:.01,[g.SchedulerTimelineQueueMessageKind.Timeout]:.01},t.shouldRunComputation=J},12179:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeCalcGrid=void 0;const n=r(84468),a=r(73119),i=r(83264),o=()=>{};t.makeCalcGrid=function(e=n.defaultSetTimeoutInterface){return new a.RecalcServiceImpl(o,o,o,o,(0,i.asyncLoopFactory)((0,i.delayPromiseImpl)(e)))}},62370:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GridImportManager=t.GridProvider=void 0;const n=r(74643).__importStar(r(11093)),a=r(3028),i=r(82438),o=r(56134),s=r(30483);function u(e,t,r){const{port1:n,port2:s}=new MessageChannel;Promise.all([e.createIGridImportEndpoint({port:s,options:r}),t.createIGridExportEndpoint({port:n,options:r},(()=>e.onGridExporterClosed()))]).catch((t=>{o.x10Logger.log({kind:"failure",payload:{failureKind:o.X10FailureKind.GridFailure,failureLevel:i.TraceLevel.Warning,path:"gridProvider.connectGridImporterExporter",description:(0,a.messageFromError)(t)}});try{e.onGridExporterClosed()}catch(t){o.x10Logger.log({kind:"failure",payload:{failureKind:o.X10FailureKind.GridFailure,failureLevel:i.TraceLevel.Warning,path:"gridProvider.connectGridImporterExporter",description:`${o.X10FailureKind.GridFailure}: importer threw ${(0,a.messageFromError)(t)}`}})}}))}t.GridProvider=class{getGrid(){return this.gridService?.call}async createIGridImportEndpoint(e){this.onGridExporterClosed();const t=await n.Endpoint.createOutside(e,(e=>{this.gridService={call:void 0,close:()=>e.close("Force")}}));t.hasBeenClosed()||(this.gridService=t,this.onGridReady(this.gridService.call))}onGridExporterClosed(){if(!this.gridService)return;const e=this.gridService;this.gridService=void 0,e.close()}constructor(e){this.onGridReady=e,this.gridService=void 0,this.syncDataModel=new s.SyncDataModel,this.getGridDataSink=()=>{},this.getSyncDataModel=()=>this.syncDataModel}},t.GridImportManager=class{onGridExporterCreated(e){this.exporter=e;for(const{importer:t,id:r}of this.importers)u(t,e,{id:r,createTimeout:this.timeout})}onGridImporterCreated(e,t){this.importers.push({importer:e,id:t}),this.exporter&&u(e,this.exporter,{id:t,createTimeout:this.timeout})}constructor(e){this.timeout=e,this.exporter=void 0,this.importers=[]}}},27308:function(e,t,r){"use strict";const n=r(53972);e.exports=n.gridinterface},62886:function(e,t,r){"use strict";const n=r(53972);e.exports=n.helpers},48930:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createIEEE754Double=void 0;const r=new ArrayBuffer(8),n=new Uint32Array(r),a=new Float64Array(r),i=1===new Uint8Array(new Uint16Array([1]).buffer)[0],[o,s]=i?[0,1]:[1,0];t.createIEEE754Double=function({lowDword:e,highDword:t}){return n[o]=e,n[s]=t,a[0]}},961:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setMockGridSheetAndNotify=t.createMockGridExporter=t.createMockGridProvider=t.createConstGridProvider=t.createMockAsyncGrid=t.MockAsyncGrid=void 0;const n=r(74643),a=r(12179),i=n.__importStar(r(60140)),o=r(87760),s=r(91304),u=r(27308),l=r(57993),c=n.__importStar(r(11093)),d=r(73701),g=r(36873),m=r(59731),h=r(91662),p=r(8860),f=r(30483);function S(e){if("object"==typeof e)switch(e.kind){case"Blank":return"";case"Error":return(0,l.getEnglishLocaleInfo)().errorNames[e.type];case"Rich":return"rich value formulaBarText"}return e.toString()}class v extends((0,o.wrapIntoAsyncClass)()(["getRangeFormats","getRangeFormulae","getRangeValues","getSheetNames","getIformats","discardSnapshot","getHiddenRows","getHiddenCols","evalClonedModelOnSnapshot","evalFormulaOnSnapshot","getCorrespondingSnapshotID","getIntersectingTables"])){get calcConfig(){return this.calcGrid.dataModel.getDocs().config}reconfigure(e){return this.calcGrid.reconfigure(e)}setRange(e,t,r,n,a){const o=i.documentLoc(void 0,""),u=i.sheetIndex(o,e),l=[];for(let e=0;e<r.length;e+=1){const i=r[e];if(void 0!==i)for(let r=0;r<i.length;r+=1){const o=i[r];if(void 0===o)continue;const c=(0,s.sheetRangeLocation)(u.index,t.firstRow+e,t.firstColumn+r),d=a?.[e]?.[r]??S(o),g=n?.[e]?.[r]??p.KnownFormat.General;d.startsWith("=")?l.push((0,s.rangeWrite)(c,(0,s.cellFormulaCellData)(d,o,g))):l.push((0,s.rangeWrite)(c,(0,s.valueCellData)(d,o,g)))}}this.calcGrid.updateRanges(0,[(0,s.rangeWrite)((0,s.sheetRangeLocation)(u.index,t.firstRow,t.firstColumn,t.lastRow,t.lastColumn)),...l]),this.runTasks()}setSheet(e,t,r,n){const a=i.documentLoc(void 0,""),o=i.sheetIndex(a,e);(0,d.assertTrue)(`Sheet having sheetId ${e} is already in the mock workbook`,!this.sheetNames.some((({sheetId:t})=>t===e))),this.sheetNames.push((0,s.sheetName)(o.index,t)),this.calcGrid.updateSheetNames(0,this.sheetNames),this.setRange(e,{firstRow:0,firstColumn:0,lastRow:0,lastColumn:0},r,n)}setNamedObjects(e){this.calcGrid.updateNamedObjects(0,e),this.runTasks()}runTasks(){for(;!this.calcGrid.dataModel.step().queueEmpty;);}constructor(){const e=(0,a.makeCalcGrid)();e.dataModel.setNumberFormats(e.document,h.knownFormatData,!1,-1/0),super(new m.RecalcSideGrid(e)),this.sheetNames=[],this.calcGrid=e,this.document=e.document}}function F(e,t,r){return{getGrid:()=>e,getGridDataSink:()=>t,getSyncDataModel:()=>r}}t.MockAsyncGrid=v,t.createMockAsyncGrid=function(){const e=new v;return{...(0,u.wrapIntoResumeRecalc)(e,(()=>e.calcGrid.resumeRecalc())),setSheet:e.setSheet.bind(e),setRange:e.setRange.bind(e),setNamedObjects:e.setNamedObjects.bind(e),document:e.document,reconfigure:e.reconfigure.bind(e),calcConfig:e.calcConfig}},t.createConstGridProvider=F,t.createMockGridProvider=e=>F(e,void 0,new f.SyncDataModel),t.createMockGridExporter=function(e){return{async createIGridExportEndpoint(t){await c.Endpoint.createInside(t,(()=>e))}}},t.setMockGridSheetAndNotify=function(e,t,r,n,a,i=0){r.setSheet(e,t,n);const o={sheetId:e,sheetName:t};a.doNotify(g.NotificationKind.updateSheetNames,[i,[o]])}},98576:function(e,t,r){"use strict";const n=r(53972);e.exports=n.mockTimer},42184:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NaiveLocalSheetGrid=void 0;const n=r(36159),a=r(1765),i=r(60140),o=r(92587),s=r(27308),u=r(57786),l=r(89817),c=r(26795),d=r(83970),g=r(73701);class m{static buildSparseMatrix(e,t){const r=[];for(const[[n,a,i=1,o=1],...s]of e){const e=s.length;for(let u=a,l=0;u<a+o;u+=1)for(let a=n;a<n+i;a+=1,l=(l+1)%e)void 0===r[a]&&(r[a]=[]),r[a][u]=t(s[l],a,u)}return r}static forEachInSparseMatrix(e,t,r=(()=>!1)){let n=!0;return e.forEach(((e,a)=>{n&&e.forEach(((e,o)=>{n&&!r(e)&&(t((0,i.gridCell)(a,o),e)||(n=!1))}))})),n}static unionRanges(e){return e.map(u.createCellSetFromRange).reduce(l.unionProduct,c.empty)}getCellValue(e,t){return this.isAvailable(e,t,"value")?void 0!==this.values&&void 0!==this.values[e]&&void 0!==this.values[e][t]?(0,a.success)(this.values[e][t]):(0,a.success)(s.emptyRangeValue):(0,a.failure)((0,o.unavailable)(["getCellValue"]))}getCellFormat(e,t){return this.isAvailable(e,t,"format")?void 0!==this.formats&&void 0!==this.formats[e]&&void 0!==this.formats[e][t]?(0,a.success)(this.formats[e][t]):(0,a.success)(s.emptyRangeFormat):(0,a.failure)((0,o.unavailable)(["getCellFormat"]))}getCellFormula(e,t){return this.isAvailable(e,t,"formula")?void 0!==this.formulae&&void 0!==this.formulae[e]&&void 0!==this.formulae[e][t]?(0,a.success)(this.formulae[e][t]):(0,a.success)(s.emptyRangeFormula):(0,a.failure)((0,o.unavailable)(["getCellFormula"]))}foreachNonBlankCellValue(e){return void 0===this.values||m.forEachInSparseMatrix(this.values,e,(e=>e.kind===d.OperKind.Blank))}foreachNonBlankCellFormula(e){return void 0===this.formulae||m.forEachInSparseMatrix(this.formulae,e,(e=>e.kind===s.emptyRangeFormula.kind&&e.formulaBarText===s.emptyRangeFormula.formulaBarText))}isAvailable(e,t,r){let n;switch(r){case"value":n=this.valueAvailabilitySet;break;case"formula":n=this.formulaAvailabilitySet;break;case"format":n=this.formatAvailabilitySet;break;default:(0,g.assertNever)("isAvailable",r)}return void 0!==n&&((0,l.compareProduct)((0,u.createCellSetFromRange)((0,i.gridCell)(e,t)),n)??1)<=0}constructor(e,t,r,n){this.formats=void 0,this.values=void 0,this.formulae=void 0,this.valueAvailabilitySet=void 0,this.formatAvailabilitySet=void 0,this.formulaAvailabilitySet=void 0,(0,a.isSuccess)(t)&&(this.values=m.buildSparseMatrix(t.value.nonEmptyCells,(e=>e)),this.valueAvailabilitySet=m.unionRanges(t.value.availableRanges)),(0,a.isSuccess)(n)&&(this.formats=m.buildSparseMatrix(n.value.nonEmptyCells,(e=>e)),this.formatAvailabilitySet=m.unionRanges(n.value.availableRanges)),(0,a.isSuccess)(r)&&(this.formulae=m.buildSparseMatrix(r.value.nonEmptyCells,(e=>e)),this.formulaAvailabilitySet=m.unionRanges(r.value.availableRanges))}}t.NaiveLocalSheetGrid=m,(0,n.staticAssertExtends)()},36873:function(e,t,r){"use strict";const n=r(53972);e.exports=n.notificationKinds},14143:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeNotifier=void 0;const n=r(36159),a=r(36159),i=r(36873),o=r(46870),s=r(46870),u=r(53614);(0,a.staticAssertExtends)(),(0,a.staticAssertExtends)(),(0,a.staticAssertExtends)();const l=[i.NotificationKind.conflictResolverEarlyTermination],c=(0,n.strEnumArray)(i.NotificationKind).filter((function(e){return l.findIndex((t=>t===e))<0}));t.makeNotifier=function(e){const t=e.doNotify.bind(e),r=(0,s.functionMapFromDUFunction)(t,c),n=(0,s.bindMethodsUnbox)(r,c),a={...(0,s.bindMethodsNullCheck)(n,c),[i.NotificationKind.notifyWorkbookClosing]:()=>n.notifyWorkbookClosing()};return l=a,d=u.notificationMethodArgumentsConvertorsMap,(0,o.mapFromArrayOfDependantPairs)(c.map((e=>[e,(...t)=>l[e](...d[e](...t))])));var l,d}},53614:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.notificationMethodArgumentsConvertorsMap=void 0;const n=r(36873),a=r(26389),i=r(8860),o=r(3028),s=r(68120),u=r(36159),l=r(48930),c=(...e)=>e,d=e=>{if("NamedValue"===e?.kind)switch(e.value.kind){case"Number":return{...e,value:e.value.numberValue};case"String":return{...e,value:e.value.stringValue};case"Boolean":return{...e,value:e.value.booleanValue};case"Error":return{...e,value:e.value}}return e},g=[[s.ErrorType.NULL,e=>0===e],[s.ErrorType.DIV0,e=>7===e],[s.ErrorType.VALUE,e=>15===e||53===e],[s.ErrorType.REF,e=>23===e],[s.ErrorType.NAME,e=>29===e],[s.ErrorType.NUM,e=>36===e],[s.ErrorType.NA,e=>42===e],[s.ErrorType.GETTING_DATA,e=>43===e],[s.ErrorType.SPILL,e=>45===e],[s.ErrorType.CONNECT,e=>46===e],[s.ErrorType.BLOCKED,e=>47===e],[s.ErrorType.UNKNOWN,e=>48===e],[s.ErrorType.FIELD,e=>49===e],[s.ErrorType.CALC,e=>50===e],[s.ErrorType.BUSY,e=>51===e||52===e||54===e],[s.ErrorType.EXTERNAL,()=>!1]];function m(e){switch(e.kind){case"error":for(const[t,r]of g)if(r(e.errorValue))return{kind:"error",errorKind:t};return{kind:"error",errorKind:void 0};case"number":return{kind:"number",value:(0,l.createIEEE754Double)(e)};default:return e}}(0,u.staticAssertSame)(),t.notificationMethodArgumentsConvertorsMap={[n.NotificationKind.doNothing]:c,[n.NotificationKind.setActiveCell]:c,[n.NotificationKind.setActiveCellFormat]:c,[n.NotificationKind.setFunctionsInfo]:c,[n.NotificationKind.setDefinedNamesInfo]:c,[n.NotificationKind.notifyWorkbookClosing]:c,[n.NotificationKind.setSchedulerFeatures]:c,[n.NotificationKind.setA1ReferenceStyle]:c,[n.NotificationKind.setWorkbookProps]:c,[n.NotificationKind.updateSheetNames]:c,[n.NotificationKind.writeRange]:(e,t)=>[e,{...t,values:t.values.map((e=>e.map(m)))}],[n.NotificationKind.setLocale]:(...e)=>{const[t]=e;return[{...t,specialRefNames:(0,o.partialArray)({[a.SpecialRefId.All]:t.specialRefNames.All,[a.SpecialRefId.Data]:t.specialRefNames.Data,[a.SpecialRefId.Headers]:t.specialRefNames.Headers,[a.SpecialRefId.ThisRow]:t.specialRefNames.ThisRow,[a.SpecialRefId.Totals]:t.specialRefNames.Totals}),currencyFormat:i.CurrencyFormat[t.currencyFormat],dateOrder:i.DateOrder[t.dateOrder],timeAltSeparator:t.timeAltSeparator,ampmSymbols:[t.ampmSymbols.first,t.ampmSymbols.second]}]},[n.NotificationKind.updateNamedObjects]:(...e)=>{const[t,r]=e;return[t,r.map((e=>({...e,scope:e.scope,objects:e.objects?.map((e=>({...e,data:d(e.data??void 0)}))),fromStateId:e.fromStateId})))]},[n.NotificationKind.setNumberFormats]:c}},90324:function(e,t){"use strict";if(Object.defineProperty(t,"__esModule",{value:!0}),t.platform=void 0,t.platform=globalThis.__x10_target_platform??"Web",["Web","Win32"].indexOf(t.platform)<0)throw new Error(`Wrong platform id ${t.platform}`);globalThis.__x10_target_platform=t.platform},44544:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerPluginFactory=t.getPluginFactory=void 0;const n=r(93336),a=r(57993),i=r(36159),o=r(60756),s=r(56134),u=(0,i.makeStringMap)();t.getPluginFactory=function(e){const t=u[e];if(!t){const t=s.x10Logger.formatLogMessage("getPluginFactory",{description:`${n.PluginFactoryName[e]} has not been registered`});throw s.x10Logger.log({kind:"failure",payload:{failureKind:s.X10FailureKind.PluginAttachmentFailure,failureLevel:a.TraceLevel.Error,path:"pluginFactory.getPluginFactory",description:`${n.PluginFactoryName[e]} has not been registered`}}),new Error(t)}return t},t.registerPluginFactory=function(e){const t=e.factoryName,r=u[t];if(void 0!==r&&r!==e){const e=s.x10Logger.formatLogMessage("registerPluginFactory",{description:`${n.PluginFactoryName[t]} is already registered`});if(s.x10Logger.log({kind:"failure",payload:{failureKind:s.X10FailureKind.PluginAttachmentFailure,failureLevel:a.TraceLevel.Error,path:"pluginFactory.registerPluginFactory",description:`${n.PluginFactoryName[t]} is already registered`}}),!(0,o.getTypedFeatureGate)("Microsoft.Office.Excel.x10DoNotThrowOnDoublePluginRegistration"))throw new Error(e)}u[t]=e,s.x10Logger.log({kind:"registerPluginFactory",payload:{factoryName:t}})}},46489:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ensureGroupAttachedLegacy=t.ensureGroupAttached=t.ensurePluginAttached=t.setX10Features=t.ensurePluginAttachedLegacy=t.resolveScriptLoaderPromise=void 0;const n=r(60756),a=r(98431),i=r(56748),o=r(98468),s=r(71201),u=r(17096),l=r(9871),c=r(23495),d=r(76063),g=r(22206),m=r(87084),h=r(40431),p=r(9246),f=r(89395),S=r(57991),v=r(46731),F=r(57993),y=r(36159),C=r(56134),A=r(29163),E=r(36873),b=r(93336),R=r(99942),T=r(90324),k=r(21840),N={Web:{[b.PluginFactoryName.ArgumentAssistancePlugin]:[a.argumentAssistancePluginDependenciesResolved,void 0,void 0,"ArgumentAssistance"],[b.PluginFactoryName.AutocompletePlugin]:[i.autocompletePluginDependenciesResolved,void 0,void 0,"SmartSuggestionsAutoComplete"],[b.PluginFactoryName.AutocompleteFunctionPlugin]:[s.autocompleteFunctionPluginDependenciesResolved,void 0,void 0,"SimpleAutoComplete"],[b.PluginFactoryName.ParenthesesCouplingPlugin]:[l.parenthesesCouplingPluginDependenciesResolved,void 0,void 0,"ParenthesisCoupling"],[b.PluginFactoryName.ColoredReferencesPlugin]:[c.coloredReferencesPluginDependenciesResolved,void 0,void 0,"ColoredReferences"],[b.PluginFactoryName.GotoCtrlClickPlugin]:[d.gotoCtrlClickPluginDependenciesResolved,void 0,void 0,"GotoCtrlClick"],[b.PluginFactoryName.AutocompleteLetPlugin]:[g.autocompleteLetPluginDependenciesResolved,void 0,void 0,"SimpleAutoComplete"],[b.PluginFactoryName.AutocompleteRichValuePlugin]:[m.autocompleteRichValuePluginDependenciesResolved,void 0,void 0,"SimpleAutoComplete"],[b.PluginFactoryName.FormulaCollectionPlugin]:[h.formulaCollectionPluginDependenciesResolved,"Microsoft.Office.Excel.FormulaCollection"],[b.PluginFactoryName.AutocompleteNamedObjectsPlugin]:[p.autocompleteNamedObjectsPluginDependenciesResolved,void 0,void 0,"SimpleAutoComplete"],[b.PluginFactoryName.ParserPerformanceMeasurements]:[i.parserPerformanceMeasurementsAttach,"Microsoft.Office.Excel.x10ParserPerformanceMeasurements"],[b.PluginFactoryName.AutocompleteTableHeadersPlugin]:[f.autocompleteTableHeadersPluginDependenciesResolved,void 0,void 0,"SimpleAutoComplete"],[b.PluginFactoryName.ValuePreviewPlugin]:[S.valuePreviewPluginDependenciesResolved,void 0,void 0,"ValuePreview"],[b.PluginFactoryName.SyntaxErrorsPlugin]:[R.syntaxErrorsPluginDependenciesResolved,void 0,void 0,"SyntaxErrors"],[b.PluginFactoryName.AutocompleteRangeSuggestionPlugin]:[i.autocompleteRangeSuggestionPluginAttach,"Microsoft.Office.Excel.AutocompleteRangeSuggestionPlugin"],[b.PluginFactoryName.AutocompleteWrapperPlugin]:[i.autocompleteWrapperPluginAttach,"Microsoft.Office.Excel.x10AutocompleteWrapperPluginIsEnabled"],[b.PluginFactoryName.AutocompleteBinaryModelExperimentPlugin]:[i.autocompleteBinaryModelExperimentPluginAttach,"Microsoft.Office.Excel.x10AutocompleteBinaryModelExperimentPlugin"],[b.PluginFactoryName.FormulaRepairShadowEvalPlugin]:[R.formulaRepairShadowEvalPluginDependenciesResolved,"Microsoft.Office.Excel.ProseFormulaRepairExperimentIsEnabled"],[b.PluginFactoryName.PythonAutocompletePlugin]:[v.pythonAutocompletePluginAttach,"Microsoft.Office.Excel.x10PythonAutocompletionEnabled"],[b.PluginFactoryName.ChatGPTPlugin]:[i.chatGPTPluginAttach,"Microsoft.Office.Excel.ChatGPTPluginEnabled"],[b.PluginFactoryName.FormulaByExamplePlugin]:[R.formulaByExamplePluginAttach,"Microsoft.Office.Excel.FormulaByExamplePluginSuggestionShowing"],[b.PluginFactoryName.TestPlugin]:[o.workerThreadInitialized,"Microsoft.Office.Excel.MockWorkerThreadPlugin"],[b.PluginFactoryName.AutocompleteEnumPlugin]:[u.autocompleteEnumPluginDependenciesResolved,void 0,void 0,"EnumAutoComplete"],[b.PluginFactoryName.SetCellPrefetchPlugin]:[R.setCellPreftechPluginAttach,"Microsoft.Office.Excel.SetCellPrefetchPluginEnabled"],[b.PluginFactoryName.FormulaTranspilerPlugin]:[R.formulaTranspilerPluginAttach,"Microsoft.Office.Excel.FileOptimization"],[b.PluginFactoryName.InCellControlsAutodetectionPlugin]:[R.inCellControlsAutodetectionPluginAttach,"Microsoft.Office.Excel.InCellControlsAutodetection"]},Win32:{[b.PluginFactoryName.FormulaByExamplePlugin]:[k.win32FormulaByExamplePluginAttached,"Microsoft.Office.Excel.DesktopX10FBEEnabled"]}},I={[b.PluginAttachGroup.Core]:!0,[b.PluginAttachGroup.Python]:!1,[b.PluginAttachGroup.SmartSuggestionsAutoComplete]:!1};(0,y.staticAssertExtends)();const O={[b.PluginAttachGroup.Core]:{[b.PluginFactoryName.AutocompletePlugin]:!1},[b.PluginAttachGroup.Python]:{},[b.PluginAttachGroup.SmartSuggestionsAutoComplete]:{[b.PluginFactoryName.AutocompletePlugin]:!0}};async function _(e,t,r=[]){(0,n.isTypedChangeGateEnabled)("OfficeVSO:7903424_Microsoft.Office.Excel.ProvideX10FeaturesFromSchedulerFeatures")&&A.PluginSchedulerSingleton.instance().doNotify(E.NotificationKind.setSchedulerFeatures,[r.map((e=>b.SchedulerFeature[e]))]),o.scriptLoaderPromise.resolve(t);const a=N.Web[e];if(void 0===a)return!1;const[i,s,u,l]=a;if((void 0===s||(0,n.getTypedFeatureGate)(s))&&(void 0===u||(0,n.isTypedChangeGateEnabled)(u))&&(void 0===l||-1!==r.indexOf(l)))try{return await i.getValue(),!0}catch(t){C.x10Logger.log({kind:"failure",payload:{failureKind:C.X10FailureKind.PluginAttachmentFailure,failureLevel:F.TraceLevel.Error,path:"ensurePluginAttachedLegacy",description:`Failed to ensure plugin "${b.PluginFactoryName[e]}" is attached with exception`,data:t}})}return!1}async function P(e){const t=N[T.platform][e];if(void 0===t)return!1;const r=A.PluginSchedulerSingleton.instance().getSchedulerFeatures(),[a,i,o,s]=t;if((void 0===i||(0,n.getTypedFeatureGate)(i))&&(void 0===o||(0,n.isTypedChangeGateEnabled)(o))&&(void 0===s||-1!==r.indexOf(b.SchedulerFeature[s])))try{return await a.getValue(),!0}catch(t){C.x10Logger.log({kind:"failure",payload:{failureKind:C.X10FailureKind.PluginAttachmentFailure,failureLevel:F.TraceLevel.Error,path:"ensurePluginAttached",description:`Failed to ensure plugin "${b.PluginFactoryName[e]}" is attached with exception`,data:t}})}return!1}function M(e){return Object.keys(e).map((e=>parseInt(e,10)))}function D(e,t){return O[t][e]??I[t]}t.resolveScriptLoaderPromise=function(e){o.scriptLoaderPromise.resolve(e)},t.ensurePluginAttachedLegacy=_,t.setX10Features=function(e){A.PluginSchedulerSingleton.instance().doNotify(E.NotificationKind.setSchedulerFeatures,[e.map((e=>b.SchedulerFeature[e]))])},t.ensurePluginAttached=P,t.ensureGroupAttached=async function(e){let t=0;for(const r of M(N[T.platform]))D(r,e)&&await P(r)&&(t+=1);return t},t.ensureGroupAttachedLegacy=async function(e,t,r=[]){let n=0;for(const a of M(N.Web))D(a,t)&&await _(a,e,r)&&(n+=1);return n}},98468:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autoCompletePluginsThread=t.workerThreadInitialized=t.workerThreadSpread=t.dynamicPluginLoaderCreated=t.schedulerWithTableIntelligenceServiceAttached=t.schedulerWithRecalcServiceAttached=t.scriptLoaderPromise=t.FormulaAuthoringStringsOnMainThread=void 0;const n=r(29163),a=r(4595),i=r(91988),o=r(60756),s=r(93336),u=r(10048);t.FormulaAuthoringStringsOnMainThread=(0,u.trackableAsyncLazy)((async()=>{const e=await t.dynamicPluginLoaderCreated.getValue();await e.loadPluginScript("formula-authoring-strings",!0)}),"FormulaAuthoringStringsOnMainThread"),t.scriptLoaderPromise=new i.ResolvablePromise,t.schedulerWithRecalcServiceAttached=(0,u.trackableAsyncLazy)((async()=>{const e=n.PluginSchedulerSingleton.instance();return l.getValue()&&await t.FormulaAuthoringStringsOnMainThread.getValue(),await e.recalcServiceAttached(),e}),"schedulerWithRecalcServiceAttached"),t.schedulerWithTableIntelligenceServiceAttached=(0,u.trackableAsyncLazy)((async()=>{const e=n.PluginSchedulerSingleton.instance();return await e.tableIntelligenceServiceAttached(),e}),"schedulerWithTableIntelligenceServiceAttached"),t.dynamicPluginLoaderCreated=(0,u.trackableAsyncLazy)((async()=>{const e=await t.scriptLoaderPromise;return(0,n.createDynamicPluginLoader)(e)}),"dynamicPluginLoaderCreated"),t.workerThreadSpread=(0,u.trackableAsyncLazy)((async()=>(await t.dynamicPluginLoaderCreated.getValue()).createPluginThread("worker")),"workerThreadSpread"),t.workerThreadInitialized=(0,u.trackableAsyncLazy)((async()=>{await t.workerThreadSpread.getValue()}),"workerThreadInitialized"),t.autoCompletePluginsThread=(0,u.trackableAsyncLazy)((async()=>{let e;return e=(0,o.getTypedFeatureGate)("Microsoft.Office.Excel.AutoCompleteOnMainThread")?await t.dynamicPluginLoaderCreated.getValue():await t.workerThreadSpread.getValue(),e}),"autoCompletePluginsThread");const l=new a.ResettableLazy((()=>{const e=n.PluginSchedulerSingleton.instance();return!e.isSchedulerFeatureEnabled(s.SchedulerFeature.SimpleAutoComplete)&&e.isSchedulerFeatureEnabled(s.SchedulerFeature.ArgumentAssistance)}))},21840:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.win32FormulaByExamplePluginAttached=void 0;const n=r(93336),a=r(10048),i=r(44544),o=r(29163);t.win32FormulaByExamplePluginAttached=new a.TrackableAsyncLazy((async()=>{const e=o.PluginSchedulerSingleton.instance(),t=(0,i.getPluginFactory)(n.PluginFactoryName.FormulaByExamplePlugin);e.createAndAttachPlugin(t)}),"win32FormulaByExamplePluginAttached")},99942:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.inCellControlsAutodetectionPluginAttach=t.formulaTranspilerPluginAttach=t.setCellPreftechPluginAttach=t.formulaByExamplePluginAttach=t.formulaRepairShadowEvalPluginDependenciesResolved=t.syntaxErrorsPluginDependenciesResolved=void 0;const n=r(93336),a=r(98468),i=r(10048),o=(0,i.trackableAsyncLazy)((async()=>{const e=await a.workerThreadSpread.getValue();return await e.loadPluginScript("excelOnlineX10Plugins",!1),e}),"threadWithExcelOnlineX10PluginsScriptLoaded");t.syntaxErrorsPluginDependenciesResolved=(0,i.trackableAsyncLazy)((async()=>{const e=await o.getValue();await a.schedulerWithRecalcServiceAttached.getValue(),await e.createAndAttachPlugin(n.PluginFactoryName.SyntaxErrorsPlugin)}),"syntaxErrorsPluginDependenciesResolved"),t.formulaRepairShadowEvalPluginDependenciesResolved=(0,i.trackableAsyncLazy)((async()=>{const e=await o.getValue();await a.schedulerWithRecalcServiceAttached.getValue(),await e.createAndAttachPlugin(n.PluginFactoryName.FormulaRepairShadowEvalPlugin)}),"formulaRepairShadowEvalPluginDependenciesResolved"),t.formulaByExamplePluginAttach=(0,i.trackableAsyncLazy)((async()=>{const e=await o.getValue();await a.schedulerWithRecalcServiceAttached.getValue(),await e.createAndAttachPlugin(n.PluginFactoryName.FormulaByExamplePlugin)}),"formulaByExamplePluginAttach"),t.setCellPreftechPluginAttach=(0,i.trackableAsyncLazy)((async()=>{const e=await o.getValue();await a.schedulerWithRecalcServiceAttached.getValue(),await e.createAndAttachPlugin(n.PluginFactoryName.SetCellPrefetchPlugin)}),"setCellPreftechPluginAttach"),t.formulaTranspilerPluginAttach=(0,i.trackableAsyncLazy)((async()=>{const e=await a.workerThreadSpread.getValue();await e.loadPluginScript("excelOnlineFormulaTranspiler",!1),await e.createAndAttachPlugin(n.PluginFactoryName.FormulaTranspilerPlugin)}),"formulaTranspilerPluginAttach"),t.inCellControlsAutodetectionPluginAttach=(0,i.trackableAsyncLazy)((async()=>{const e=await o.getValue();await a.schedulerWithRecalcServiceAttached.getValue(),await e.createAndAttachPlugin(n.PluginFactoryName.InCellControlsAutodetectionPlugin)}),"inCellControlsAutodetectionPluginAttach")},2340:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResponseState=t.ExecutionStopReason=t.FrameExecutionStopReason=t.SchedulerTimelineQueueMessageKind=t.delay=t.awaitPromise=t.typedRequest=t.recalcNotificationKinds=t.ComputationRequestKind=t.DefaultComputationGroup=void 0;const n=r(36159),a=r(73701),i=r(36873),o=r(25722),s=r(91988),u=r(86761),l=r(56134),c=r(46870),d=r(62859);var g,m,h;t.DefaultComputationGroup="",t.ComputationRequestKind={GetSheetNames:"GetSheetNames",GetRange:"GetRange",Delay:"Delay",GetCell:"GetCell",GetContainingTable:"GetContainingTable",UnsafeGetContainingTableName:"UnsafeGetContainingTableName",GetAvailableTableHeaders:"GetAvailableTableHeaders",GetIntersectingTables:"GetIntersectingTables",UnsafeGetIntersectingTableNames:"UnsafeGetIntersectingTableNames",GetStructRefColumn:"GetStructRefColumn",GetStructRefSpecialRef:"GetStructRefSpecialRef",GetIformat:"GetIformat",ParseCellFormula:"ParseCellFormula",ParseEdit:"ParseEdit",ParseNumberFormat:"ParseNumberFormat",PrintFormula:"PrintFormula",GetActiveCell:"GetActiveCell",GetActiveCellFormat:"GetActiveCellFormat",GetConfig:"GetConfig",GetCultureTag:"GetCultureTag",AwaitPromise:"AwaitPromise",CreateTask:"CreateTask",PromiseToTask:"PromiseToTask",AwaitTask:"AwaitTask",AwaitBatch:"AwaitBatch",AwaitAll:"AwaitAll",AwaitAny:"AwaitAny",GetFunctionsInfo:"GetFunctionsInfo",GetFunctionInfo:"GetFunctionInfo",GetCorrelationId:"GetCorrelationId",SetActiveCell:"SetActiveCell",ParseActiveCell:"ParseActiveCell",GetRichValueFieldListContext:"GetRichValueFieldListContext",GetHiddenRows:"GetHiddenRows",GetHiddenCols:"GetHiddenCols",GetDefinedNamesInfo:"GetDefinedNamesInfo",GetDefinedNameInfo:"GetDefinedNameInfo",ResolveReferences:"ResolveReferences",EvalOnClonedModel:"EvalOnClonedModel",EvalFormula:"EvalFormula",GetCorrespondingSnapshotID:"GetCorrespondingSnapshotID",GetEditFormat:"GetEditFormat",GetFullTableHeadersFromServer:"GetFullTableHeadersFromServer",CreateChatGPTSession:"CreateChatGPTSession",CloseChatGPTSession:"CloseChatGPTSession",SendChatGPTQuery:"SendChatGPTQuery",IsSchedulerFeatureEnabled:"IsSchedulerFeatureEnabled",SendAugLoopSignal:"SendAugLoopSignal",TriggerEvent:"TriggerEvent",AwaitEvent:"AwaitEvent",GetRecognizedRangeTables:"GetRecognizedRangeTables",UpdateSnapshot:"UpdateSnapshot"},(0,n.staticAssertExtends)(),(0,n.staticAssertExtends)(),(0,n.staticAssertExtends)(),(0,n.staticAssertExtends)(),t.recalcNotificationKinds=[i.NotificationKind.setA1ReferenceStyle,i.NotificationKind.setLocale,i.NotificationKind.setWorkbookProps,i.NotificationKind.updateSheetNames,i.NotificationKind.updateNamedObjects],t.typedRequest=function*(e,t){const r=yield{kind:e,...t};return(0,a.assertTrue)("Response kind coincides with request kind",r.kind===e),(0,c.staticTypeHint)(r),r},t.awaitPromise=function*(e){const r=yield{kind:t.ComputationRequestKind.AwaitPromise,promise:e};return(0,a.assertTrue)("Response kind coincides with request kind",r.kind===t.ComputationRequestKind.AwaitPromise),r.result},t.delay={kind:t.ComputationRequestKind.Delay},function(e){e[e.NoOpRequest=0]="NoOpRequest",e[e.AsyncRequest=1]="AsyncRequest",e[e.SyncRequest=2]="SyncRequest",e[e.StepComputation=3]="StepComputation",e[e.StopComputationFrame=4]="StopComputationFrame",e[e.Timeout=5]="Timeout"}(g||(t.SchedulerTimelineQueueMessageKind=g={})),(0,n.staticAssertExtends)(),function(e){e.Superseded="Superseded",e.Timeout="Timeout",e.ConflictResolverEarlyTermination="ConflictResolverEarlyTermination"}(m||(t.FrameExecutionStopReason=m={})),function(e){e.Done="Done",e.Skipped="Skipped",e.Exception="Exception"}(h||(h={})),t.ExecutionStopReason={Unknown:"Unknown",Frame:m,Computation:h},t.ResponseState=class{computationFrame(e){return this._computationFrames.get(e)}get attachedComputations(){return[...this._attachedComputations]}get attachedSyncComputations(){return[...this._attachedSyncComputations]}get numComputations(){return this._attachedComputations.length}get numSyncComputations(){return this._attachedSyncComputations.length}attachComputation(e){this._attachedComputations.push(e)}attachSyncComputation(e){this._attachedSyncComputations.push(e)}createFrame(e,r,n,a,i,l,c,d){const g=new s.ResolvablePromise,m=this.computationKind,h={type:this.computationType,correlationId:e,computationGroup:r,computationInput:a,cache:i,config:l,startTime:c,timeWindow:d,successfulResults:{kind:m,results:[]},resolvable:g,stopReasonRef:new u.Ref(t.ExecutionStopReason.Unknown),numOfComputations:n.time===o.ExecutionTimeMode.Async?this.numComputations:this.numSyncComputations,numFailures:0,numSkippedComputations:0};return this._computationFrames.set(r,h),g}closeFrame(e,r,n){const a=this.computationFrame(e);if(!a)return;this._computationFrames.delete(e),a.stopReasonRef.value=r,a.resolvable.resolve(r===t.ExecutionStopReason.Frame.Superseded?{kind:"Superseded"}:{kind:"Done",payload:a.successfulResults}),a.cache?.close();const{computationKind:i,numComputations:o,numSyncComputations:s}=this,{correlationId:u,startTime:c,numSkippedComputations:g,successfulResults:m}=a,h=m.results.length,p={correlationId:u,type:this.computationType,computationKind:i,computationGroup:e,numComputations:o,numSyncComputations:s,numSent:h,numSkippedComputations:g,stopReason:r,startTime:c,stopTime:n};l.x10Logger.log({kind:"closeComputationFrame",payload:p}),(0,d.sendX10UsedTelemetryEvent)()}stop(e,t,r){void 0!==this.computationFrame(e)&&this.closeFrame(e,t,r)}constructor(e,t){this.computationType=e,this.computationKind=t,this._attachedComputations=[],this._attachedSyncComputations=[],this._computationFrames=new Map}}},53710:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PrefetchingCache=void 0;const n=r(60140),a=r(42184),i=r(92587),o=r(1765),s=r(1765),u=r(57993),l=r(3028),c=r(64327),d=r(36159),g=r(74599),m=r(57786),h=r(26795),p=r(89817),f=r(43595),S=r(30070),v=r(30070),F=r(64962),y=r(73440),C=r(97729),A=r(18784),E=r(68954),b=r(14009),R=r(12973),T=r(92988),k=r(56134);function N({hasHeadersRow:e,hasTotalsRow:t,dataRange:r}){return(0,n.gridRange)(r.row-Number(e),r.col,r.rows+Number(e)+Number(t),r.cols)}function I(e,t,r,a){const{name:i,hasHeadersRow:o,hasTotalsRow:s,dataRange:u,columns:l}=t,c=o?(0,n.gridRange)(u.row-1,u.col,1,u.cols):void 0,d=s?(0,n.gridRange)(u.row+u.rows,u.col,1,u.cols):void 0,g={};let m=f.RedBlackMapTree.create(e.stringCompareCI);for(const e of l)g[e.column]=e,m=m.setValue(e.name,e);return{name:i,sheet:r,dataRange:u,headersRange:c,totalsRange:d,allRange:a,indexToColumn:g,nameToColumn:m,allColumnNamesAvailable:l.length===u.cols}}function O(e,t){return((0,p.compareProduct)((0,m.createCellSetFromRange)(t),e)??1)<=0}const _=(0,s.failure)((0,i.unavailable)(["getCell"])),P=(0,s.failure)((0,i.unavailable)(["getContainingTable"])),M=(0,s.failure)((0,i.unavailable)(["getIntersectingTables"])),D=(0,s.failure)((0,i.unavailable)(["getIntersectingTableNames"])),w=(0,s.failure)((0,i.unavailable)(["getIformats"])),L=(0,s.failure)((0,i.unavailable)(["GetAvailableTableHeaders"]));class x{static getOrFetchTile(e,t,r){const a=t.range.row>>>x.tileHeightPow,i=t.range.col>>>x.tileWidthPow;void 0===e[a]&&(e[a]=[]);const o=e[a][i];return void 0===o?r((0,n.sheetGridRange)(t.sheet,(0,n.gridRange)(a<<x.tileHeightPow,i<<x.tileWidthPow,1<<x.tileHeightPow,1<<x.tileWidthPow))).then((t=>e[a][i]=t)):o}static create(e,t,r){return new x(e,t,r)}getSheetContents(e){return this.sheet2contents[e]??(this.sheet2contents[e]={cellTiles:[],tables:(0,g.makeGridRangeTable)(),tableTiles:[],hiddenRows:h.empty,hiddenRowsAvailability:h.empty,hiddenCols:h.empty,hiddenColsAvailability:h.empty})}getCurrentDocumentLoc(){return this.currentDocumentLoc}getSheetNames(){if(void 0===this.sheetNames){const e=[];this.syncDataStore.sheets?.forEachSheet((t=>{e.push({sheetIndex:t.sheetIndex,sheetName:t.name})}));const t={};let r=f.RedBlackMapTree.create(this.syncDataStore.config.localeInfo.stringCompareCI);for(let n=0;n<e.length;n+=1){const{sheetIndex:a,sheetName:i}=e[n];t[a.index]=n,r=r.setValue(i,n)}const n=this.getCurrentDocumentLoc();this.sheetNames={document:n,sheets:e,idToIndex:t,nameToIndex:r}}return(0,s.success)(this.sheetNames)}getRangeValues(e){return this.grid.getRangeValues(this.correlationId,e)}getRangeFormulae(e){return this.grid.getRangeFormulae(this.correlationId,e)}getRangeFormats(e){return this.grid.getRangeFormats(this.correlationId,e)}async getHiddenRows(e,t,r){const a=this.getSheetContents(e.index),i=m.bspFactory.row([t,r]),o=(0,h.compare)(i,a.hiddenRowsAvailability);if(0!==o&&-1!==o){const i=await this.grid.getHiddenRows(this.correlationId,e,(0,d.fastMax)(0,t-10),(0,d.fastMin)(n.sheetRows,r+10));a.hiddenRows=i.hidden.reduce(((e,{start:t,end:r})=>(0,h.union)(e,m.bspFactory.row([t,r]))),a.hiddenRows),a.hiddenRowsAvailability=i.available.reduce(((e,{start:t,end:r})=>(0,h.union)(e,m.bspFactory.row([t,r]))),a.hiddenRowsAvailability)}const s=[];(0,m.forEachRow)((0,h.intersect)(a.hiddenRowsAvailability,i),(([e,t])=>(s.push((0,b.interval)(e,t)),!0)));const u=[];return(0,m.forEachRow)((0,h.intersect)(a.hiddenRows,i),(([e,t])=>(u.push((0,b.interval)(e,t)),!0))),{available:s,hidden:u}}async getHiddenCols(e,t,r){const a=this.getSheetContents(e.index),i=m.bspFactory.col([t,r]),o=(0,h.compare)(i,a.hiddenColsAvailability);if(0!==o&&-1!==o){const i=await this.grid.getHiddenCols(this.correlationId,e,(0,d.fastMax)(0,t-10),(0,d.fastMin)(n.sheetCols,r+10));a.hiddenCols=i.hidden.reduce(((e,{start:t,end:r})=>(0,h.union)(e,m.bspFactory.col([t,r]))),a.hiddenCols),a.hiddenColsAvailability=i.available.reduce(((e,{start:t,end:r})=>(0,h.union)(e,m.bspFactory.col([t,r]))),a.hiddenColsAvailability)}const s=[];(0,m.forEachCol)((0,h.intersect)(a.hiddenColsAvailability,i),(([e,t])=>(s.push((0,b.interval)(e,t)),!0)));const u=[];return(0,m.forEachCol)((0,h.intersect)(a.hiddenCols,i),(([e,t])=>(u.push((0,b.interval)(e,t)),!0))),{available:s,hidden:u}}async getRange(e,t){const r=void 0===t||t.indexOf("values")>-1,n=void 0===t||t.indexOf("formulae")>-1,o=void 0===t||t.indexOf("formats")>-1,u=(0,s.failure)((0,i.unavailable)(["getRange"])),[l,c,d]=await Promise.all([r?this.getRangeValues(e):u,n?this.getRangeFormulae(e):u,o?this.getRangeFormats(e):u]);return new a.NaiveLocalSheetGrid(e.sheet,l,c,d)}getCell(e){const t=this.getSheetContents(e.sheet.index),r=x.getOrFetchTile(t.cellTiles,e,(async t=>{const[r,n,i]=[await this.grid.getRangeValues(this.correlationId,t),await this.grid.getRangeFormulae(this.correlationId,t),await this.grid.getRangeFormats(this.correlationId,t)];return(0,s.isSuccess)(r)&&(0,s.isSuccess)(n)&&(0,s.isSuccess)(i)?new a.NaiveLocalSheetGrid(e.sheet,r,n,i):"unavailable"}));return(0,c.bindMaybeThenable)(r,(t=>{if("unavailable"===t)return _;const r=t.getCellValue(e.range.row,e.range.col),n=t.getCellFormula(e.range.row,e.range.col),a=t.getCellFormat(e.range.row,e.range.col);return(0,s.isSuccess)(r)&&(0,s.isSuccess)(n)&&(0,s.isSuccess)(a)?(0,s.success)({value:r.value,formula:n.value,format:a.value}):_}))}getAvailableTableHeaders(e){const t=this.syncDataStore.nameManager;if(!t)return L;const r=t.getAllDocumentNames().find((t=>t.name===e));if(!r)return L;const n=t.getAvailableTableColumns(r);return(0,s.success)(n)}getStructRefColumn(e,t){const r=this.syncDataStore.getStructRefColumn(e,t);return r.kind===o.ResultKind.Failure?(0,s.failure)((0,i.unavailable)(["getStructRefColumn"])):r}getStructRefSpecialRef(e,t){const r=this.syncDataStore.getStructRefSpecialRef(e,t);return r.kind===o.ResultKind.Failure?(0,s.failure)((0,i.unavailable)(["getStructRefSpecialRef"])):r}getContainingTableName(e){const t=this.syncDataStore.getContainingTable(e);return t.kind===o.ResultKind.Failure?(0,s.failure)((0,i.unavailable)(["getContainingTableName"])):t}async getContainingTable(e){const t=this.getSheetContents(e.sheet.index),r=x.getOrFetchTile(t.tableTiles,e,(async r=>{const n=await this.grid.getIntersectingTables(this.correlationId,r);if(!(0,s.isSuccess)(n))return"unavailable";const a=n.value.availableRanges.map(m.createCellSetFromRange).reduce(p.unionProduct,h.empty);for(const r of n.value.tables){const n=N(r);t.tables.getValue(n)||(t.tables=t.tables.setValue(n,I(this.syncDataStore.config.localeInfo,r,e.sheet,n)))}return a}));return(0,c.bindMaybeThenable)(r,(r=>{if("unavailable"===r)return P;let n;return t.tables.forEachGe(e.range,((e,t)=>(n=t,!1))),void 0!==n||O(r,e.range)?(0,s.success)(n):P}))}async getIntersectingTables(e){const t=this.getSheetContents(e.sheet.index);let r=h.empty;for(let a=e.range.row,i=e.range.row+e.range.rows;a<i;a+=1<<x.tileHeightPow)for(let i=e.range.col,o=e.range.col+e.range.cols;i<o;i+=1<<x.tileWidthPow){const o=x.getOrFetchTile(t.tableTiles,(0,n.sheetGridCell)(e.sheet,(0,n.gridCell)(a,i)),(e=>this.fetchTableTile(e.sheet,t,e))),s=(0,c.isThenable)(o)?await o:o;if("unavailable"===s)return M;r=(0,p.unionProduct)(r,s)}const a=[];return t.tables.forEachMeets(e.range,((e,t)=>(a.push(t),r=(0,p.unionProduct)(r,(0,m.createCellSetFromRange)(e)),!0))),O(r,e.range)?(0,s.success)(a):M}getIntersectingTableNames(e){if(void 0===this.syncDataStore.nameManager)return D;const t=this.syncDataStore.nameManager.getIntersectingTables(e);return t.kind===o.ResultKind.Failure?D:t}async fetchTableTile(e,t,r){const n=await this.grid.getIntersectingTables(this.correlationId,r);if(!(0,s.isSuccess)(n))return"unavailable";const a=n.value.availableRanges.map(m.createCellSetFromRange).reduce(p.unionProduct,h.empty);for(const r of n.value.tables){const n=N(r);t.tables.getValue(n)||(t.tables=t.tables.setValue(n,I(this.syncDataStore.config.localeInfo,r,e,n)))}return a}async getIformat(e,t){const r=t>>>x.formatPagePow,n=r<<x.formatPagePow,a=n+(1<<x.formatPagePow);let i=this.formatPages[r];if(void 0===i){const t=await this.grid.getIformats(this.correlationId,e,n,a);if((0,s.isSuccess)(t)){const e=[];for(const r of t.value.availableFormats)r.iformat<n||r.iformat>=a||(e[r.iformat-n]=r);i=this.formatPages[r]=e}else i=this.formatPages[r]="unavailable"}if("unavailable"===i)return w;const o=i[t-n];return void 0===o?w:(0,s.success)(o)}parseCellFormula(e,t,r){return{result:x.cachedParseFormula(r?this.englishFormulaCache:this.formulaCache,r?this.englishParser:this.parser,r?this.englishAnalyzer:this.analyzer,e,t)}}async parseEdit(e,t){const r=await this.getEditFormat(e)??{valueType:v.FormatValueType.General,bidiDate:void 0,culture:void 0};return this.parseEditInternal(e,t,r)}parseEditSync(e,t,r){const n=this.parseNumberFormat(r.formatString,r.builtIn).result;let a;return a=(0,s.isSuccess)(n)?n.value:{valueType:v.FormatValueType.General,bidiDate:void 0,culture:void 0},this.parseEditInternal(e,t,a)}resolveReferences(e,t){return t.map((t=>{switch(t.kind){case R.NodeKind.StructRef:return this.resolveStructRefSync(e,t).result;case R.NodeKind.CellRef:return this.resolveCellRefNodeSync(e,t).result}}))}async getCorrespondingSnapshotID(){return-1===this.correspondingSnapshotID&&(this.correspondingSnapshotID=await this.grid.getCorrespondingSnapshotID(this.correlationId)),this.correspondingSnapshotID}async getEditFormat(e){const t=await this.getCell(e);if(!(0,s.isSuccess)(t))return;let r;if("string"==typeof t.value.format)r=this.parseNumberFormat(t.value.format,!1).result;else{const n=await this.getIformat(e.sheet.document,t.value.format);if(!(0,s.isSuccess)(n))return;const{formatString:a,builtIn:i}=n.value;r=this.parseNumberFormat(a,i).result}return(0,s.isSuccess)(r)?r.value:void 0}parseEditInternal(e,t,r){let n=this.formatter.parseEdit(t,r);if(!(0,s.isSuccess)(n))return{result:n};if(n.value.kind===v.EditKind.String&&"="===t&&r.valueType!==v.FormatValueType.Text&&(n=(0,s.success)((0,S.formulaEdit)(t))),n.value.kind!==v.EditKind.Formula)return{result:(0,s.success)(n.value)};const a=x.parseCheckedFormula(this.parser,this.analyzer,e,n.value.fmla,e.range);return(0,s.isSuccess)(a)?{result:(0,s.success)({kind:v.EditKind.Formula,fmla:n.value.fmla,formula:a.value})}:{result:a}}static cachedParseFormula(e,t,r,n,a){const i=e.get(a);if(void 0!==i)return i;const o=x.parseWellFormedFormula(t,r,n,a.formulaBarText,a.origin??n.range);return e.set(a,o),o}static parseWellFormedFormula(e,t,r,n,a){const o=x.parseCheckedFormula(e,t,r,n,a);return(0,s.isSuccess)(o)?(0,i.isWellFormed)(o.value)?(0,s.success)(o.value):(0,s.failure)((0,b.illFormedFormula)("ill-formed formula")):o}static parseCheckedFormula(e,t,r,a,i){const o=e.parseFormula((0,y.parseLocals)(n.LexicalKind.Cell,i),a);if(!(0,s.isSuccess)(o))return o;const u=t.checkFormula((0,C.analyzeLocalsGrid)(n.LexicalKind.Cell,(0,n.sheetGridCell)(r.sheet,i)),o.value);return(0,s.isSuccess)(u)?(0,s.success)(u.value):u}parseNumberFormat(e,t){return{result:this.cachedParseNumberFormat(e,t)}}evalOnClonedModel(e,t,r){return this.grid.evalClonedModelOnSnapshot(this.correlationId,e,t,r)}evalFormula(e,t,r){return this.grid.evalFormulaOnSnapshot(this.correlationId,e,t,r)}cachedParseNumberFormat(e,t){const r=t?this.builtInFormatCache.get(e):this.customFormatCache.get(e);if(void 0!==r)return r;const n=this.formatter.createFormat(e,t);return t?this.builtInFormatCache.set(e,n):this.customFormatCache.set(e,n),n}resolveStructRefSync(e,t){return{result:this.resolver.resolveStructRef(e,t)}}resolveCellRefNodeSync(e,t){return{result:this.resolver.resolveCellRef(e,t)}}close(){this.grid.discardSnapshot(this.correlationId).catch((e=>{k.x10Logger.log({kind:"failure",payload:{failureKind:k.X10FailureKind.GridFailure,failureLevel:u.TraceLevel.Warning,path:"PrefetchingCache.close",description:(0,l.messageFromError)(e)}})}))}constructor(e,t,r){this.grid=e,this.syncDataStore=t,this.correlationId=r,this.correspondingSnapshotID=-1,this.sheet2contents=(0,d.makeStringMap)(),this.currentDocumentLoc=(0,n.documentLoc)(void 0,""),this.formatPages=[],this.formulaCache=new Map,this.englishFormulaCache=new Map,this.builtInFormatCache=new Map,this.customFormatCache=new Map,this.parser=(0,A.createParser)(t),this.analyzer=(0,E.createAnalyzer)(t),this.formatter=(0,F.createNumberFormatter)(t),this.resolver=(0,T.createResolver)(t);const a={config:{localeInfo:(0,u.getEnglishLocaleInfo)(),get date1904(){return t.config.date1904},get dateCompatibility(){return t.config.dateCompatibility},get datepack(){return t.config.datepack},get mathpack(){return t.config.mathpack},get refStyle(){return t.config.refStyle},get timezone(){return t.config.timezone}},getSheetName:(...e)=>t.getSheetName(...e),getContainingTable:(...e)=>t.getContainingTable(...e),getDocumentLoc:(...e)=>t.getDocumentLoc(...e),getNameLoc:(...e)=>t.getNameLoc(...e),getSheetIndex:(...e)=>t.getSheetIndex(...e),getSheetRangeIndexes:(...e)=>t.getSheetRangeIndexes(...e),getStructRefColumn:(...e)=>t.getStructRefColumn(...e),getStructRefSpecialRef:(...e)=>t.getStructRefSpecialRef(...e),getUserDefinedFuncLoc:(...e)=>t.getUserDefinedFuncLoc(...e)};this.englishParser=(0,A.createParser)(a),this.englishAnalyzer=(0,E.createAnalyzer)(a)}}t.PrefetchingCache=x,x.tileWidthPow=2,x.tileHeightPow=4,x.formatPagePow=6},46731:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pythonAutocompletePluginAttach=void 0;const n=r(98468),a=r(60756),i=r(93336),o=r(10048),s=(0,o.trackableAsyncLazy)((async()=>{const e=await n.workerThreadSpread.getValue();return await e.loadPluginScript((0,a.isTypedChangeGateEnabled)("Microsoft.Office.Excel.X10IntelligentPythonWP5")?"pythonIntelliSenseWP5":"pythonIntelliSense",!1),e}),"threadWithExcelOnlinePythonPluginScriptLoaded");t.pythonAutocompletePluginAttach=(0,o.trackableAsyncLazy)((async()=>{const e=await s.getValue();await e.createAndAttachPlugin(i.PluginFactoryName.PythonAutocompletePlugin)}),"pythonAutocompletePluginAttach")},20364:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.processSyncRequest=t.processRequest=t.requestProcessorMap=void 0;const n=r(36159),a=r(64327),i=r(64327),o=r(1765),s=r(57993),u=r(60140),l=r(16101),c=r(79664),d=r(2340),g=r(92587),m=r(56134),h=r(86761),p=r(60756),f=r(9319),S=r(31532),v=r(44994),F=h.X10TaskInternal.createToken();function y(e,t){return e.kind===o.ResultKind.Failure?e:(0,o.success)(t(e.value))}async function C(e){try{return(0,o.success)(await e)}catch(e){return(0,o.failure)(e)}}t.requestProcessorMap={[d.ComputationRequestKind.Delay]:()=>(0,o.success)({}),[d.ComputationRequestKind.AwaitPromise]:async({request:{promise:e}})=>{try{const t=await e;return(0,o.success)({result:t})}catch(e){return(0,o.failure)(e)}},[d.ComputationRequestKind.CreateTask]:({request:{request:e},handle:t,schedulerState:r})=>{const n=new h.X10TaskInternal(r.scheduler.processRequest(t,e,{onFulfilled:e=>{if(e.kind!==o.ResultKind.Success)throw{kind:"RequestFailure"};return e.value},onRejected:e=>{throw e}}),F);return(0,o.success)({task:n})},[d.ComputationRequestKind.PromiseToTask]:({request:{promise:e}})=>(0,o.success)({task:new h.X10TaskInternal(e,F)}),[d.ComputationRequestKind.AwaitTask]:async({request:{task:e}})=>(0,o.success)({result:await C(e.resolve(F))}),[d.ComputationRequestKind.AwaitBatch]:async({request:{tasks:e}})=>{const t=[];for(const r of e)t.push(await C(r.resolve(F)));return(0,o.success)({results:t})},[d.ComputationRequestKind.AwaitAll]:async({request:{tasks:e}})=>{const t=a.MaybeThenable.all(e.map((e=>e.resolve(F))));return(0,o.success)({result:await C(t)})},[d.ComputationRequestKind.AwaitAny]:async({request:{tasks:e}})=>{const t=a.MaybeThenable.any(e.map((e=>e.resolve(F))));return(0,o.success)({result:await C(t)})},[d.ComputationRequestKind.GetCell]:async({request:{cell:e},cache:t})=>{if(void 0===t)return v.logSafeFailure.failure("Cache is undefined");const r=await t.getCell(e);return(0,o.success)({result:r})},[d.ComputationRequestKind.GetContainingTable]:async({request:{cell:e},cache:t})=>{if(void 0===t)return v.logSafeFailure.failure("Cache is undefined");const r=await t.getContainingTable(e);return(0,o.success)({result:r})},[d.ComputationRequestKind.UnsafeGetContainingTableName]:({request:{cell:e},cache:t})=>{if(void 0===t)return v.logSafeFailure.failure("Cache is undefined");const r=t.getContainingTableName(e);return(0,o.success)({result:r})},[d.ComputationRequestKind.GetAvailableTableHeaders]:({request:{tableName:e},cache:t})=>{if(void 0===t)return v.logSafeFailure.failure("Cache is undefined");const r=t.getAvailableTableHeaders(e);return(0,o.success)({result:r})},[d.ComputationRequestKind.GetIntersectingTables]:async({request:{range:e},cache:t})=>{if(void 0===t)return v.logSafeFailure.failure("Cache is undefined");const r=await t.getIntersectingTables(e);return(0,o.success)({result:r})},[d.ComputationRequestKind.UnsafeGetIntersectingTableNames]:({request:{range:e},cache:t})=>{if(void 0===t)return v.logSafeFailure.failure("Cache is undefined");const r=t.getIntersectingTableNames(e);return(0,o.success)({result:r})},[d.ComputationRequestKind.GetRange]:async({request:{range:e,layers:t},cache:r})=>{if(void 0===r)return v.logSafeFailure.failure("Cache is undefined");const n=await r.getRange(e,t);return(0,o.success)({localSheetGrid:n})},[d.ComputationRequestKind.GetSheetNames]:({cache:e})=>void 0===e?v.logSafeFailure.failure("Cache is undefined"):e.getSheetNames(),[d.ComputationRequestKind.GetStructRefColumn]:({request:{table:e,nameOrCol:t},cache:r})=>{if(void 0===r)return v.logSafeFailure.failure("Cache is undefined");const n=r.getStructRefColumn(e,t);return(0,o.success)({result:n})},[d.ComputationRequestKind.GetStructRefSpecialRef]:({request:{table:e,id:t},cache:r})=>{if(void 0===r)return v.logSafeFailure.failure("Cache is undefined");const n=r.getStructRefSpecialRef(e,t);return(0,o.success)({result:n})},[d.ComputationRequestKind.GetIformat]:async({request:{document:e,iformat:t},cache:r})=>{if(void 0===r)return v.logSafeFailure.failure("Cache is undefined");const n=await r.getIformat(e,t);return(0,o.success)({result:n})},[d.ComputationRequestKind.ParseCellFormula]:({request:{cell:e,formula:t,useEnglishLocaleInfo:r},cache:n})=>void 0===n?v.logSafeFailure.failure("Cache is undefined"):(0,o.success)(n.parseCellFormula(e,t,r)),[d.ComputationRequestKind.ParseEdit]:async({request:{cell:e,formulaBarText:t},cache:r})=>void 0===r?v.logSafeFailure.failure("Cache is undefined"):(0,o.success)(await r.parseEdit(e,t)),[d.ComputationRequestKind.ParseActiveCell]:({request:{formulaText:e},schedulerState:{activeCell:t,activeCellFormat:r},cache:a})=>{if(void 0===a)return v.logSafeFailure.failure("Cache is undefined");if((0,n.isNone)(t))return v.logSafeFailure.failure("Active Cell is undefined");if(void 0===r)return v.logSafeFailure.failure("Active Cell Format is undefined");const i=r??{formatString:"General",builtIn:!0};return(0,o.success)(a.parseEditSync(t,e,i))},[d.ComputationRequestKind.ParseNumberFormat]:({request:{formatString:e,builtIn:t},cache:r})=>void 0===r?v.logSafeFailure.failure("Cache is undefined"):(0,o.success)(r.parseNumberFormat(e,t)),[d.ComputationRequestKind.PrintFormula]:({request:{formula:e,origin:t},config:r})=>{if(void 0===r)return(0,o.failure)([]);const n=(0,l.createPrinter)((0,c.createSimplePrintGlobals)(r)).printFormula((0,c.printLocalsGrid)((0,u.lexicalSourceGrid)(u.LexicalKind.Cell,t),t),e);return(0,o.success)({result:n})},[d.ComputationRequestKind.GetActiveCell]:({schedulerState:{activeCell:e}})=>void 0===e?(s.ulsLogger.ULS.traceTag(512274723,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,m.x10Logger.formatLogMessage("GetActiveCell",{description:"failed because activeCell was undefined"})),v.logSafeFailure.failure("Active Cell is undefined")):(0,o.success)({activeCell:e}),[d.ComputationRequestKind.GetActiveCellFormat]:({schedulerState:{activeCellFormat:e}})=>void 0===e?v.logSafeFailure.failure("Active Cell Format is undefined"):null===e?(0,o.success)({result:(0,o.failure)((0,g.unavailable)(["unavailableFormat"]))}):(0,o.success)({result:(0,o.success)(e)}),[d.ComputationRequestKind.GetConfig]:({config:e})=>void 0===e?v.logSafeFailure.failure("Config is undefined"):(0,o.success)({config:e}),[d.ComputationRequestKind.GetCultureTag]:({request:{lcid:e}})=>{const t=(0,S.convertKnownLCID)(e).toString();return-1===t.indexOf("-")?v.logSafeFailure.failure(`Culture-Tag '${t}' from LCID '${e}' has an unknown format`):(0,o.success)({cultureTag:t})},[d.ComputationRequestKind.GetFunctionsInfo]:({schedulerState:e})=>{const t=e.functionsInfoMap;if(void 0===t)return s.ulsLogger.ULS.traceTag(512274722,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,m.x10Logger.formatLogMessage("GetFunctionsInfo",{description:"failed because functionsInfoMap was undefined"})),v.logSafeFailure.failure("functionsInfoMap is undefined");const r=Object.keys(t).map((e=>t[e]));return(0,o.success)({functionsInfo:r})},[d.ComputationRequestKind.GetFunctionInfo]:({request:{functionName:e},schedulerState:t})=>{if(void 0===t.functionsInfoMap)return s.ulsLogger.ULS.traceTag(512274721,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,m.x10Logger.formatLogMessage("GetFunctionInfo",{description:"failed because functionsInfoMap was undefined"})),v.logSafeFailure.failure("functionsInfoMap is undefined");const r=t.functionsInfoMap[e.toUpperCase()];return void 0===r?v.logSafeFailure.failure("functionsInfo is undefined"):(0,o.success)({functionInfo:r})},[d.ComputationRequestKind.GetDefinedNamesInfo]:({schedulerState:e})=>{const t=e.definedNamesInfoMap;if(void 0===t)return s.ulsLogger.ULS.traceTag(512274720,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,m.x10Logger.formatLogMessage("GetDefinedNamesInfo",{description:"failed because definedNamesInfoMap was undefined"})),v.logSafeFailure.failure("definedNamesInfoMap is undefined");const r=Object.keys(t).map((e=>t[e]));return(0,o.success)({definedNamesInfo:r})},[d.ComputationRequestKind.GetDefinedNameInfo]:({request:{definedName:e},schedulerState:t})=>{if(void 0===t.definedNamesInfoMap)return v.logSafeFailure.failure("definedNamesInfoMap is undefined");const r=t.definedNamesInfoMap[e.toUpperCase()];return(0,o.success)({definedNameInfo:r})},[d.ComputationRequestKind.EvalOnClonedModel]:async({cache:e,request:t})=>{const r=await(e?.evalOnClonedModel(t.updates,t.edits,t.formatResults));return void 0===r?v.logSafeFailure.failure("Operation did not return a result"):r.kind!==o.ResultKind.Success?v.logSafeFailure.failure("Operation returned an unsuccessful result"):(0,o.success)({result:r.value})},[d.ComputationRequestKind.EvalFormula]:async({cache:e,request:t})=>{const r=await(e?.evalFormula(t.formula,t.origin,t.format));return void 0===r?v.logSafeFailure.failure("Operation did not return a result"):r.kind!==o.ResultKind.Success?v.logSafeFailure.failure("Operation returned an unsuccessful result"):(0,o.success)({result:r.value})},[d.ComputationRequestKind.GetCorrelationId]:({correlationId:e})=>(0,o.success)({correlationId:e}),[d.ComputationRequestKind.SetActiveCell]:e=>(e.schedulerState={...e.schedulerState,activeCell:e.request.activeCell,activeCellFormat:e.request.activeCellFormat},(0,o.success)({})),[d.ComputationRequestKind.GetRichValueFieldListContext]:async({schedulerState:e,request:{rangeToQuery:t,dotNotationPath:r,singleColumn:a,findRange:i}})=>{const s=e.serverDataProvider;if((0,n.isNone)(s))return v.logSafeFailure.failure("serverDataProvider is undefined");const u=await s.getRichValueFieldListContext(t,r,a,i);return(0,p.isTypedChangeGateEnabled)("OfficeVSO:8575821_x10MapGetRichValueFieldListContext")||(0,o.success)({result:u}),(0,o.success)({result:u})},[d.ComputationRequestKind.GetHiddenRows]:async({cache:e,request:t})=>{if(void 0===e)return(0,o.failure)([]);const r=await e.getHiddenRows(t.sheet,t.start,t.endExclusive);return(0,o.success)({result:r})},[d.ComputationRequestKind.GetHiddenCols]:async({cache:e,request:t})=>{if(void 0===e)return(0,o.failure)([]);const r=await e.getHiddenCols(t.sheet,t.start,t.endExclusive);return(0,o.success)({result:r})},[d.ComputationRequestKind.ResolveReferences]:({cache:e,request:{locals:t,nodes:r}})=>{if(void 0===e)return v.logSafeFailure.failure("Cache is undefined");if(void 0===t)return v.logSafeFailure.failure("Locals is undefined");if(void 0===r)return v.logSafeFailure.failure("Nodes is undefined");const n=e.resolveReferences(t,r);return(0,o.success)({resolverResults:n})},[d.ComputationRequestKind.GetCorrespondingSnapshotID]:async({cache:e})=>{if(void 0===e)return v.logSafeFailure.failure("Cache is undefined");const t=await e.getCorrespondingSnapshotID();return(0,o.success)({snapshotID:t})},[d.ComputationRequestKind.GetEditFormat]:async({cache:e,request:{cell:t}})=>{if(void 0===e)return v.logSafeFailure.failure("Cache is undefined");const r=await e.getEditFormat(t);return(0,o.success)({result:void 0===r?(0,o.failure)((0,g.unavailable)(["Unavailable Format"])):(0,o.success)(r)})},[d.ComputationRequestKind.UpdateSnapshot]:async({handle:e,schedulerState:t})=>{const r=await t.scheduler.updatePrefetchingCache(e);return void 0===r?v.logSafeFailure.failure("Cache is undefined"):(0,o.success)({snapshotID:r})},[d.ComputationRequestKind.GetFullTableHeadersFromServer]:async({schedulerState:e,request:{tableName:t}})=>{const r=e.serverDataProvider;if((0,n.isNone)(r))return v.logSafeFailure.failure("serverDataProvider is undefined");const a=await r.getTableColHeaders(t);return(0,n.isNone)(a)?(0,o.success)({result:[]}):(0,o.success)({result:a.filter(n.isDefined)})},[d.ComputationRequestKind.CreateChatGPTSession]:async({schedulerState:{scheduler:e},finalizer:t,request:{options:r}})=>{if(void 0===r)return v.logSafeFailure.failure("Request contained undefined 'options'");const n=await e.createChatGPTSession(r);return n.kind===o.ResultKind.Success&&t.subscribe((()=>e.closeChatGPTSession(n.value))),y(n,(e=>({result:e})))},[d.ComputationRequestKind.CloseChatGPTSession]:async({schedulerState:{scheduler:e},request:{session:t}})=>y(await e.closeChatGPTSession(t),(()=>({result:void 0}))),[d.ComputationRequestKind.SendChatGPTQuery]:async({schedulerState:{scheduler:e},request:{session:t,request:r}})=>y(await e.sendChatGPTQuery(t,r),(e=>({result:e}))),[d.ComputationRequestKind.IsSchedulerFeatureEnabled]:({schedulerState:{scheduler:e},request:{feature:t}})=>{const r=e.isSchedulerFeatureEnabled(t);return(0,o.success)({isFeatureEnabled:r})},[d.ComputationRequestKind.SendAugLoopSignal]:async({schedulerState:{scheduler:e},handle:t,request:{signal:r}})=>y(await e.sendAugLoopSignal(r,t.info.computationIdentifier.factoryName),(e=>({result:e}))),[d.ComputationRequestKind.TriggerEvent]:({schedulerState:{scheduler:e},request:{eventKind:t,event:r}})=>(e.triggerEventImmediate(t,r),(0,o.success)({})),[d.ComputationRequestKind.AwaitEvent]:async({schedulerState:{scheduler:e},request:t})=>{const r=(0,p.isTypedChangeGateEnabled)("OfficeVSO:9127295_x10_awaitEventAsyncChanges")?e.catchEvent(t):void 0;if((0,f.isALAnnotationEventKind)(t.eventKind)){const r=await e.registerALAnnotation(t.eventKind);if(r.kind!==o.ResultKind.Success)return r}const n=await(r??e.catchEvent(t));return(0,o.success)({result:n})},[d.ComputationRequestKind.GetRecognizedRangeTables]:async({schedulerState:{scheduler:e},handle:t,request:{sheetId:r,range:n,metadataStates:a,maxRevisions:i}})=>y(await e.getRecognizedTablesInfo(r,n,a,t.info.computationIdentifier.factoryName,i),(e=>({result:e})))},t.processRequest=function(e,t,r,n,a){const{info:{correlationId:s},schedulerState:u,finalizer:l}=r,c=e[t.kind],d={request:t,correlationId:s,cache:n,config:a,schedulerState:u,finalizer:l,handle:r},g=c(d);return(0,i.bindMaybeThenable)(g,(e=>e.kind!==o.ResultKind.Success?v.logSafeFailure.censored(e):(r.schedulerState=d.schedulerState,(0,o.success)({kind:t.kind,...e.value}))))},t.processSyncRequest=function(e,t,r,n,a){const{info:{correlationId:i},schedulerState:s,finalizer:u}=r,l={request:t,correlationId:i,cache:n,config:a,schedulerState:s,finalizer:u,handle:r},c=(0,e[t.kind])(l);return c.kind!==o.ResultKind.Success?v.logSafeFailure.censored(c):(r.schedulerState=l.schedulerState,(0,o.success)({kind:t.kind,...c.value}))}},29163:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSchedulerFactories=t.dynamicPluginLoaderInsideInit=t.createDynamicPluginLoader=t.PluginSchedulerSingleton=t.GridImportManagerSingleton=void 0;const n=r(60756),a=r(36159),i=r(62370),o=r(53411),s=r(24221),u=r(69966),l=r(90324),c=r(86585),d=(0,a.singleton)((()=>{const e=p().createGridProvider((()=>t.PluginSchedulerSingleton.instance().registerAsyncGrid()));return t.GridImportManagerSingleton.instance().onGridImporterCreated(e,"Main-IGrid"),e}));t.GridImportManagerSingleton=(0,a.singleton)((()=>p().createGridImportManager())),t.PluginSchedulerSingleton=(0,a.singleton)((()=>p().createFormulaBarScheduler(d.instance()))),(0,a.staticAssertExtends)(),t.createDynamicPluginLoader=function(e){return p().createDynamicPluginLoader(t.GridImportManagerSingleton.instance(),t.PluginSchedulerSingleton.instance(),e)};const g=(e,t,...r)=>new o.FormulaBarScheduler((0,u.timelineQueueProcessorFactory)(r[0]),(0,u.createPrefetchingCacheFactory)(e),t,e.getGridDataSink(),e.getSyncDataModel(),...r);t.dynamicPluginLoaderInsideInit=(0,u.dynamicPluginLoaderInsideInit)(u.timelineQueueProcessorFactory,u.createPrefetchingCacheFactory);class m extends o.FormulaBarScheduler{set ComputationFinalizerHandlers(e){this.computationFinalizerHandlers=e}get ComputationFinalizerHandlers(){return this.computationFinalizerHandlers}}const h={Win32:{createFormulaBarScheduler:g,createExperimentFormulaBarScheduler(){throw new Error("Cannot use Experiment Formula Bar Scheduler in win32 context")},createTestableFormulaBarScheduler(){throw new Error("Cannot use Testable Formula Bar Scheduler in win32 context")},createDynamicPluginLoader(){throw new Error("Cannot use Dynamic Plugin Loader in win32 context")},createGridImportManager:()=>({onGridExporterCreated(){},onGridImporterCreated(){}}),createGridProvider(){const e=new c.CacheGrid;return{getGrid:()=>e,getGridDataSink:()=>e,getSyncDataModel:()=>e,createIGridImportEndpoint(){throw new Error("Cannot use createIGridImportEndpoint in win32 context")},onGridExporterClosed(){throw new Error("Cannot use onGridExporterClosed in win32 context")}}}},Web:{createFormulaBarScheduler:g,createDynamicPluginLoader:(...e)=>((e,...t)=>new u.DynamicPluginLoader(e,...t))("excelOnlineCalc.x10.stableDynamicPluginLoaderInsideInit",...e),createGridImportManager:e=>new i.GridImportManager(e),createGridProvider:e=>new i.GridProvider(e),createExperimentFormulaBarScheduler:(e,t,...r)=>{let n;const a=new o.FormulaBarScheduler((e=>(n=new s.ExperimentQueueProcessor(e),n)),(0,u.createPrefetchingCacheFactory)(e),t,e.getGridDataSink(),e.getSyncDataModel(),...r);if(void 0===n)throw"not initialized";return[a,n]},createTestableFormulaBarScheduler:(e,t,...r)=>new m((0,u.timelineQueueProcessorFactory)(r[0]),(0,u.createPrefetchingCacheFactory)(e),t,e.getGridDataSink(),e.getSyncDataModel(),...r)}};function p(){return h[l.platform]}if(t.getSchedulerFactories=p,(0,n.getTypedFeatureGate)("TESTING_ONLY_SCHEDULER_IMPORTSCRIPTS_FAIL")&&(self.__retries=(self.__retries??-1)+1,0===self.__retries))throw""},55186:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapRequest=t.wrapSyncRequest=t.InternalSchedulerResponseKind=void 0;const n=r(73701),a=r(36159),i=r(2340);var o;function s(e,t){switch(e.kind){case i.ComputationRequestKind.Delay:case i.ComputationRequestKind.CreateTask:case i.ComputationRequestKind.PromiseToTask:case i.ComputationRequestKind.GetActiveCell:case i.ComputationRequestKind.GetActiveCellFormat:case i.ComputationRequestKind.GetConfig:case i.ComputationRequestKind.GetCultureTag:case i.ComputationRequestKind.GetCorrelationId:case i.ComputationRequestKind.GetFunctionInfo:case i.ComputationRequestKind.GetFunctionsInfo:case i.ComputationRequestKind.GetDefinedNameInfo:case i.ComputationRequestKind.GetDefinedNamesInfo:case i.ComputationRequestKind.SetActiveCell:case i.ComputationRequestKind.IsSchedulerFeatureEnabled:case i.ComputationRequestKind.TriggerEvent:return{kind:i.SchedulerTimelineQueueMessageKind.NoOpRequest,request:e,computation:t};case i.ComputationRequestKind.GetSheetNames:case i.ComputationRequestKind.GetAvailableTableHeaders:case i.ComputationRequestKind.ParseCellFormula:case i.ComputationRequestKind.ParseNumberFormat:case i.ComputationRequestKind.PrintFormula:case i.ComputationRequestKind.ParseActiveCell:case i.ComputationRequestKind.ResolveReferences:case i.ComputationRequestKind.UnsafeGetContainingTableName:case i.ComputationRequestKind.UnsafeGetIntersectingTableNames:case i.ComputationRequestKind.GetStructRefColumn:case i.ComputationRequestKind.GetStructRefSpecialRef:return{kind:i.SchedulerTimelineQueueMessageKind.SyncRequest,request:e,computation:t};default:(0,n.assertNever)(`unknown request: ${e}`,e)}}!function(e){e[e.FirstStep=0]="FirstStep",e[e.NormalResponse=1]="NormalResponse",e[e.RequestFailure=2]="RequestFailure"}(o||(t.InternalSchedulerResponseKind=o={})),(0,a.staticAssertExtends)(),t.wrapSyncRequest=s,t.wrapRequest=function(e,t){switch(e.kind){case i.ComputationRequestKind.GetRange:case i.ComputationRequestKind.GetCell:case i.ComputationRequestKind.GetContainingTable:case i.ComputationRequestKind.GetIntersectingTables:case i.ComputationRequestKind.GetIformat:case i.ComputationRequestKind.AwaitPromise:case i.ComputationRequestKind.AwaitTask:case i.ComputationRequestKind.AwaitBatch:case i.ComputationRequestKind.AwaitAll:case i.ComputationRequestKind.AwaitAny:case i.ComputationRequestKind.ParseEdit:case i.ComputationRequestKind.GetRichValueFieldListContext:case i.ComputationRequestKind.GetHiddenRows:case i.ComputationRequestKind.GetHiddenCols:case i.ComputationRequestKind.EvalOnClonedModel:case i.ComputationRequestKind.EvalFormula:case i.ComputationRequestKind.GetCorrespondingSnapshotID:case i.ComputationRequestKind.GetEditFormat:case i.ComputationRequestKind.UpdateSnapshot:case i.ComputationRequestKind.GetFullTableHeadersFromServer:case i.ComputationRequestKind.CreateChatGPTSession:case i.ComputationRequestKind.CloseChatGPTSession:case i.ComputationRequestKind.SendChatGPTQuery:case i.ComputationRequestKind.SendAugLoopSignal:case i.ComputationRequestKind.AwaitEvent:case i.ComputationRequestKind.GetRecognizedRangeTables:return{kind:i.SchedulerTimelineQueueMessageKind.AsyncRequest,request:e,computation:t};default:return s(e,t)}},(0,a.staticAssertExtends)(),(0,a.staticAssertExtends)(),(0,a.staticAssertExtends)(),(0,a.staticAssertExtends)()},30483:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SyncDataModel=t.MaxStateIdDifferenceForGC=void 0;const n=r(40238),a=r(70052),i=r(91304),o=r(37919),s=r(35885),u=r(60140),l=r(1765),c=r(92587),d=r(36873),g=()=>{};t.MaxStateIdDifferenceForGC=17,t.SyncDataModel=class{get document(){return this.dataTransformer.document}getStateAsNotifications(){return[...this.configNotifications,...this.getSheetStateAsNotifications(),...this.getNameStateAsNotifications(),...this.getSchedulerFeaturesAsNotifications()]}getSchedulerFeaturesAsNotifications(){return[[d.NotificationKind.setSchedulerFeatures,[this.schedulerFeatures]]]}getSheetStateAsNotifications(){const e=[];return this.sheets.forEachSheet(((t,r)=>{e.push((0,i.sheetName)(r,t.name))})),e.length>0?[[d.NotificationKind.updateSheetNames,[this.stateId,e]]]:[]}getNameStateAsNotifications(){const e=[],t=t=>{const r=[];t.forEachAvailableName(((e,t)=>{const n=(0,a.namedObjectToNamedObjectData)(this.config.mathpack,this.dataTransformer.document,t?.obj);return r.push((0,i.namedObject)(e,n)),!0})),r.length>0&&e.push((0,i.namedObjectsWrite)(t.scope.index,r)),t.allAvailable()&&e.push((0,i.undefinedNamesWrite)(t.scope.index))},r=this.nameManager.getNamesBySheetId(void 0);return(0,l.isSuccess)(r)&&t(r.value),this.nameManager.forEachSheetScope((e=>{t(e)})),e.length>0?[[d.NotificationKind.updateNamedObjects,[this.stateId,e]]]:[]}trySetStateId(e,r){if(r<this.stateId)return!1;if(r>this.stateId){const e=this.stateId;if(this.stateId=r,this.sheets.advanceState(e),this.nameManager.advanceState(e),this.stateChangesSinceLastGC+=1,this.stateChangesSinceLastGC>=t.MaxStateIdDifferenceForGC){this.stateChangesSinceLastGC=0;const e=this.stateId-t.MaxStateIdDifferenceForGC;this.nameManager.collectGarbage(e)}}return!0}clearCompiledFormulas(){this.nameManager.resetLazyData()}clearCompiledNumberFormats(){}setA1ReferenceStyle(e){this.configNotifications.push([d.NotificationKind.setA1ReferenceStyle,[e]]),this.dataTransformer.setA1ReferenceStyle(this,this.stateId,e)}setLocale(e){this.configNotifications.push([d.NotificationKind.setLocale,[e]]),this.dataTransformer.setLocaleInfo(this,this.stateId,e,{})}setWorkbookProps(e){this.configNotifications.push([d.NotificationKind.setWorkbookProps,[e]]),this.dataTransformer.setWorkbookProps(this,this.stateId,e,{})}updateSheetNames(e,t){this.dataTransformer.updateSheetNames(this,e,t,{})}updateNamedObjects(e,t){this.dataTransformer.updateNamedObjects(this,e,t,{})}setSchedulerFeatures(e){this.schedulerFeatures=e}setLangConfig(e,t){if(!this.trySetStateId(!0,e))return;const r=this.config.localeInfo!==t.localeInfo,n=this.config.refStyle!==t.refStyle;this.config=t,r&&this.clearCompiledNumberFormats(),(r||n)&&this.clearCompiledFormulas()}setSheetNames(e,t,r){this.trySetStateId(!0,r)&&(this.sheets=this.sheets.setSheetNames(t),this.nameManager=this.nameManager.setSheetNames(t))}writeNamedObject(e,t,r,n){if(!this.trySetStateId(!0,e))return;const a=this.nameManager.setNamedObject(!0,(0,u.nameLoc)(t,r),n,g);(0,l.isSuccess)(a)}writeUndefinedNames(e,t){if(!this.trySetStateId(!0,e))return;const r=this.nameManager.setUndefinedNames(t);(0,l.isSuccess)(r)}promoteNamedObjects(e,t,r){if(!this.trySetStateId(!0,e))return;const n=this.nameManager.promoteNamedObjects(t,r);(0,l.isSuccess)(n)&&n.value}getDocumentLoc(e,t){const r=this.dataTransformer.document;return void 0!==e&&e!==r.path||0!==this.config.localeInfo.stringCompareCI(t,r.name)?(0,l.failure)((0,c.unavailable)([(0,u.documentLoc)(e,t)])):(0,l.success)(r)}getSheetIndex(e,t){const r=this.sheets.getSheetByName(t);return(0,l.isSuccess)(r)?void 0===r.value?r:(0,l.success)(r.value.sheetIndex.index):r}getSheetName(e,t){const r=this.sheets.getSheetById(t);return(0,l.isSuccess)(r)?(0,l.success)(r.value.name):r}getNameLoc(e,t,r){return this.nameManager.getNameLoc(e.index,t,r)}getUserDefinedFuncLoc(e,t){return(0,l.failure)((0,c.notImplemented)(["call UDF"]))}getSheetRangeIndexes(e){return this.sheets.getSheetRangeIds(e)}getContainingTable(e){return this.nameManager.getContainingTable(e)}getStructRefColumn(e,t){return this.nameManager.getStructRefColumn(e,t)}getStructRefSpecialRef(e,t){return this.nameManager.getStructRefSpecialRef(e,t)}getTime(){return(0,l.failure)((0,c.unavailable)(["getTime"]))}constructor(){this.dataTransformer=new n.RecalcServiceDataTransformer,this.stateId=-1/0,this.stateChangesSinceLastGC=0,this.config=this.dataTransformer.getLangConfig(),this.configNotifications=[],this.sheets=new o.PartialWorkbookSheets(this.dataTransformer.document,this.config.localeInfo.stringCompareCI),this.nameManager=new s.PartialWorkbookNameManager(this.dataTransformer.document,this.config.localeInfo.stringCompareCI),this.schedulerFeatures=[]}}},11182:function(e,t,r){"use strict";const n=r(53972);e.exports=n.testUtils},88526:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.flaky=t.YarnExecutionArgs=t.testingCGOverrides=t.GateOverrideManager=void 0;const n=r(60756),a=r(66761),i=r(66761),o=r(36159);class s{static defaultGateOverrides(){return 0===s.changeGatesToTest.length&&0===s.booleanFeatureGatesToTest.length?[{featureGates:{Number_Of_Times_Test_Was_Executed:1}},{featureGates:{Number_Of_Times_Test_Was_Executed:2}}]:[...s.defaultChangeGateOverrides().map((e=>({changeGates:e}))),...s.defaultBooleanFeatureGateOverrides().map((e=>({featureGates:e})))]}static defaultChangeGateOverrides(){return 0===s.changeGatesToTest.length?[]:s.changeGatesToTest.map((e=>[{[e]:!0},{[e]:!1}])).flat()}static defaultBooleanFeatureGateOverrides(){return 0===s.booleanFeatureGatesToTest.length?[]:s.booleanFeatureGatesToTest.map((e=>[{[e]:!0},{[e]:!1}])).flat()}static mergeGateOverrides(e,t){return{changeGates:{...e.changeGates,...t.changeGates},featureGates:{...e.featureGates,...t.featureGates}}}static mergeGateOverrideLists(e,t){const r=new Set;return e.forEach((e=>{t.forEach((t=>{const n=s.mergeGateOverrides(e,t);let a=!0;r.forEach((e=>{s.extends(e,n)?a=!1:s.extends(n,e)&&r.delete(e)})),a&&r.add(n)}))})),Array.from(r)}static extends(e,t){return Object.entries(t.changeGates??{}).every((([t,r])=>e.changeGates?.[t]===r))&&Object.entries(t.featureGates??{}).every((([t,r])=>e.featureGates?.[t]===r))}static override(e){return{changeGates:(0,o.isDefined)(e.changeGates)?(0,i.overrideTypedChangeGates)(n.isTypedChangeGateEnabled,e.changeGates):void 0,featureGates:(0,o.isDefined)(e.featureGates)?(0,n.overrideTypedFeatureGates)(n.getTypedFeatureGate,e.featureGates):void 0}}static revert(e){(0,a.setChangeGateDictionaryGetter)(e.changeGates),(0,n.setFeatureGateDictionaryGetter)(e.featureGates)}}t.GateOverrideManager=s,s.changeGatesToTest=[],s.booleanFeatureGatesToTest=[],t.testingCGOverrides=s.defaultChangeGateOverrides();class u{static get instance(){return(0,o.isDefined)(this._instance)||(this._instance=new u),this._instance}constructor(){this.args=[],this.args=JSON.parse({NODE_ENV:"production"}.npm_config_argv??"{}").original??[]}}t.YarnExecutionArgs=u,u.has=e=>u.instance.args.findIndex((t=>t===e))>=0,t.flaky=()=>u.has("--flaky")?it:it.skip},3541:function(e,t,r){"use strict";const n=r(53972);e.exports=n.timelineQueueProcessor},10048:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.trackableAsyncLazy=t.TrackableAsyncLazy=void 0;const n=r(4595),a=r(56134),i=r(36159);class o extends n.ResettableLazy{reset(){throw new Error("Resetting a TrackableAsyncLazy is not allowed")}constructor(e,t,r=i.now){super((async()=>{const t=r(),n=e(),i=r()-t,o=await n,s=r()-t-i;return a.x10Logger.log({kind:"trackableAsyncLazy",payload:{name:this.name,syncTime:i,asyncTime:s}}),o})),this.name=t}}t.TrackableAsyncLazy=o,t.trackableAsyncLazy=function(e,t,r=i.now){return new o(e,t,r)}},62859:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendX10UsedTelemetryEvent=t.createX10RequestPerformanceEvent=t.createX10AggregatedTelemetryEvent=t.addSampleWithProbability=t.getHistogramBinIndexForDuration=t.updateDurationHistogramsWithRequestTimes=t.histogramBinCount=t.REQUEST_DURATION_THRESHOLDS=void 0;const n=r(36159),a=r(71768),i=r(71191),o=r(57479);t.REQUEST_DURATION_THRESHOLDS=[5,10,20,50,100,200],t.histogramBinCount=t.REQUEST_DURATION_THRESHOLDS.length+1;const s=new a.JSF32(0);let u=!1;function l(e){for(let r=0;r<t.REQUEST_DURATION_THRESHOLDS.length;r++)if(e<t.REQUEST_DURATION_THRESHOLDS[r])return r;return t.REQUEST_DURATION_THRESHOLDS.length}function c(){return{dataCategories:i.EnumObjects.DataCategories.ProductServiceUsage,samplingPolicy:i.EnumObjects.SamplingPolicy.Measure,diagnosticLevel:i.EnumObjects.DiagnosticLevel.Optional}}t.updateDurationHistogramsWithRequestTimes=function(e,r){var a;return(a=r,Object.entries(a)).forEach((([r,a])=>{if((0,n.isDefined)(a)&&a.numberOfRequests>0){const n=l(a.requestDuration/a.numberOfRequests),i=e[r]??Array(t.histogramBinCount).fill(0);i[n]+=a.numberOfRequests,e[r]=i}})),e},t.getHistogramBinIndexForDuration=l,t.addSampleWithProbability=function(e,t,r){return function(e){return e>=0&&e<=1}(r)&&s.next()<r&&e.push(t),e},t.createX10AggregatedTelemetryEvent=function(e){return{eventName:"Office.Excel.Client.X10.AggregatedTelemetry",eventFlags:c(),dataFields:[(0,i.makeStringDataField)("X10AggregatedTelemetryObject",e)]}},t.createX10RequestPerformanceEvent=function(e){return{eventName:"Office.Excel.Client.X10.RequestPerformance",eventFlags:c(),dataFields:[(0,i.makeStringDataField)("X10RequestPerformanceTelemetryObject",e)]}},t.sendX10UsedTelemetryEvent=function(){u||((0,o.getTelemetryLogger)().sendTelemetryEvent({eventName:"Office.Excel.Client.X10.X10UsedEvent",eventFlags:c()}),u=!0)}},64796:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.X10ExceptionComputationTermination=t.X10Exception=void 0;class r extends Error{}t.X10Exception=r,t.X10ExceptionComputationTermination=class extends r{constructor(e){super(`Computation execution was terminated with '${e}'.`),this.stopReason=e}}},56134:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.x10Logger=t.CombinedLogger=t.ImmediateLogger=t.X10FailureKind=t.LoggerKind=void 0;const n=r(36159),a=r(73701),i=r(57993),o=r(93336),s=r(60756),u=r(62859),l=r(46870),c=r(57479),d="Main",g=(0,s.isTypedChangeGateEnabled)("OfficeVSO:8786821_x10SendLoggerMessagesToMainThread"),m=(0,s.isTypedChangeGateEnabled)("OfficeVSO:8846142_x10SendTelemetryWithUTel");var h,p;!function(e){e.Immediate="Immediate",e.Aggregating="Aggregating"}(h||(t.LoggerKind=h={})),function(e){e.ALFailure="ALFailure",e.AssertionFailure="AssertionFailure",e.CustomConflictResolverFailure="CustomConflictResolverFailure",e.EventCallbacksManagerFailure="EventCallbacksManagerFailure",e.GridFailure="GridFailure",e.NotificationProcessorFailure="NotificationProcessorFailure",e.PluginAttachmentFailure="PluginAttachmentFailure",e.PluginFailure="PluginFailure",e.RequestProcessorFailure="RequestProcessorFailure",e.TableIntelligenceFailure="TableIntelligenceFailure"}(p||(t.X10FailureKind=p={}));const f=(e,t,r)=>`x10arch.[${e}].${t}: ${(0,n.isDefined)(r.description)&&r.description.length?`${r.description}. `:""}${(0,n.isDefined)(r.data)?JSON.stringify(r.data):""}`;(0,n.staticAssertSame)();const S={trackableAsyncLazy:(e,t)=>a.ulsLogger.ULS.traceTag(507316304,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,f(e,"trackableAsyncLazy",{data:t})),snapshotCreation:(e,t)=>a.ulsLogger.ULS.traceTag(512305240,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,f(e,"snapshotCreation",{data:t})),beginRequest:(e,t)=>a.ulsLogger.ULS.traceTag(553734792,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,f(e,"beginRequest",{data:t})),requestSkipped:(e,t)=>a.ulsLogger.ULS.traceTag(553734793,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,f(e,"requestSkipped",{data:t})),registerPluginFactory:(e,{factoryName:t})=>a.ulsLogger.ULS.traceTag(571246212,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,f(e,"registerPluginFactory",{description:`registered ${o.PluginFactoryName[t]}`})),pluginCompletedInTime:(e,{pluginName:t,logInfo:r})=>a.ulsLogger.ULS.traceTag(553734790,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,f(e,"pluginCompletedInTime",{description:`plugin completed in time. plugin name:${t}`,data:r})),computationStoppedExecution:(e,{computationName:t,stopReason:r,logInfo:n})=>a.ulsLogger.ULS.traceTag(509109120,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,f(e,"pluginStoppedExecution",{data:{computationName:t,stopReason:r,...n}})),closeComputationFrame:(e,t)=>a.ulsLogger.ULS.traceTag(553734789,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,f(e,"closeUIMessageFrame",{data:t})),nullCheckViolation:(e,t)=>a.ulsLogger.ULS.traceTag(507803776,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,f(e,"nullCheckViolation",{data:t})),failure:(e,{failureKind:t,failureLevel:r,path:n,description:o,data:s})=>a.ulsLogger.ULS.traceTag(507322970,i.LogCategory.msoulscat_ES_EWAJS,r,f(e,n,{description:o,data:{failureKind:t,failureLevel:r,...s}}))},v={trackableAsyncLazy:{},snapshotCreation:{numSnapshots:0,numFreshSnapshots:0},beginRequest:{},requestSkipped:{},registerPluginFactory:{factories:[]},pluginCompletedInTime:{},computationStoppedExecution:{computationsStopReason:{},requestDurationHistograms:{},requestDurationHistogramByComputationKind:{},schedulerTimeSamples:[],computationTimeSamples:[]},closeComputationFrame:{},nullCheckViolation:{},failure:{}},F={trackableAsyncLazy:(e,{name:t,syncTime:r,asyncTime:n})=>({...e,[t]:{numCalls:(e[t]?.numCalls??0)+1,totalSyncTime:(e[t]?.totalSyncTime??0)+r,totalAsyncTime:(e[t]?.totalAsyncTime??0)+n}}),snapshotCreation:({numSnapshots:e,numFreshSnapshots:t},r)=>({numSnapshots:e+1,numFreshSnapshots:t+(r?1:0)}),beginRequest:(e,{computationKind:t})=>({...e,[t]:(e[t]??0)+1}),requestSkipped:(e,{computationKind:t})=>({...e,[t]:(e[t]??0)+1}),registerPluginFactory:({factories:e},{factoryName:t})=>({factories:[...e,o.PluginFactoryName[t]]}),pluginCompletedInTime:(e,{pluginName:t})=>({...e,[t]:(e[t]??0)+1}),computationStoppedExecution:({computationsStopReason:e,requestDurationHistograms:t,requestDurationHistogramByComputationKind:r,schedulerTimeSamples:n,computationTimeSamples:a},{computationName:i,stopReason:o,logInfo:{requestTimes:s,computationTime:l,schedulerTime:c}})=>({computationsStopReason:{...e,[i]:{...e[i],[o]:(e[i]?.[o]??0)+1}},requestDurationHistograms:(0,u.updateDurationHistogramsWithRequestTimes)(t,s),requestDurationHistogramByComputationKind:{...r,[i]:(0,u.updateDurationHistogramsWithRequestTimes)(r[i]??{},s)},schedulerTimeSamples:(0,u.addSampleWithProbability)(n,c,5e-4),computationTimeSamples:(0,u.addSampleWithProbability)(a,l,5e-4)}),closeComputationFrame:(e,t)=>({...e,[t.computationKind]:{...e[t.computationKind],[t.stopReason]:(e[t.computationKind]?.[t.stopReason]??0)+1}}),nullCheckViolation:(e,{requestKind:t,violations:r})=>({...e,[t]:{...e[t],[r.join(";")]:(e[t]?.[r.join(";")]??0)+1}}),failure:(e,{failureKind:t,failureLevel:r})=>({...e,[t]:{...e[t],[r]:(e[t]?.[r]??0)+1}})};class y{log(e,t){this.isMessageForAnotherLogger(t)||((0,s.getTypedFeatureGate)("Microsoft.Office.Excel.EnableFullSessionLogging")||"failure"===e.kind)&&S[e.kind](this.threadId,e.payload)}flush(){}flushBufferedMessages(){return[]}get threadId(){return this._threadId}set threadId(e){this._threadId=e}isMessageForAnotherLogger(e){return(0,n.isDefined)(e)&&e!==h.Immediate}constructor(){this._threadId=d,this.formatLogMessage=(e,t)=>f(this.threadId,e,t)}}t.ImmediateLogger=y;class C{log(e,t){this.isMessageForAnotherLogger(t)||(this.shouldBufferLogMessages()?((0,l.staticTypeHint)(e),this.logMessageBuffer.push([e,h.Aggregating])):(this.loggingStates[e.kind]=F[e.kind](this.loggingStates[e.kind],e.payload),this.periodicFlush(e.kind)))}flush(){if(this.shouldBufferLogMessages())return;const{requestDurationHistogramByComputationKind:e}=this.loggingStates.computationStoppedExecution;this.loggingStates.computationStoppedExecution.requestDurationHistogramByComputationKind={};const t=this.formatLogMessage("AgggregationLogger.flush",{description:"summary logs for session",data:this.loggingStates}),r=this.formatLogMessage("AgggregationLogger.flush",{description:"request duration histogram by computation kind",data:e});if(m&&this.threadId===d){const e=(0,c.getTelemetryLogger)();e.sendTelemetryEvent((0,u.createX10AggregatedTelemetryEvent)(t)),e.sendTelemetryEvent((0,u.createX10RequestPerformanceEvent)(r))}}periodicFlush(e){"closeComputationFrame"===e&&(this.closeComputationFrameCount++,this.closeComputationFrameCount>=this.nextFlushThreshold&&(this.nextFlushThreshold*=1.33,this.flush()))}flushBufferedMessages(){const e=this.logMessageBuffer;return this.logMessageBuffer=[],e}get threadId(){return this._threadId}set threadId(e){this._threadId=e}shouldBufferLogMessages(){return g&&this.threadId!==d}isMessageForAnotherLogger(e){return(0,n.isDefined)(e)&&e!==h.Aggregating}constructor(){this.loggingStates={...v},this._threadId=d,this.logMessageBuffer=[],this.closeComputationFrameCount=0,this.nextFlushThreshold=4,this.formatLogMessage=(e,t)=>f(this.threadId,e,t)}}class A{log(e,t){this.immediateLogger.log(e,t),this.aggregatingLogger.log(e,t)}flush(){this.immediateLogger.flush(),this.aggregatingLogger.flush()}flushBufferedMessages(){return[...this.immediateLogger.flushBufferedMessages(),...this.aggregatingLogger.flushBufferedMessages()]}get threadId(){return this._threadId}set threadId(e){this._threadId=e,this.immediateLogger.threadId=e,this.aggregatingLogger.threadId=e}constructor(){this._threadId=d,this.immediateLogger=new y,this.aggregatingLogger=new C,this.formatLogMessage=(e,t)=>f(this.threadId,e,t)}}t.CombinedLogger=A,t.x10Logger=new A},66840:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Test=t.testingCGOverrides=t.GateOverrideManager=t.runQueueProcessorUntil=t.VisitorHelpers=t.RangeHelpers=t.TimelineQueueProcessor=t.defaultTimerInterface=t.resolveScriptLoaderPromise=t.setX10Features=t.ensurePluginAttached=t.ensureGroupAttachedLegacy=t.ensureGroupAttached=t.spanToLSPRange=t.ValuePreviewResultExtractor=t.PluginRegistry=t.ALAnnotationKind=t.EventKind=t.ComputationType=t.NotificationKind=t.RequestKind=t.delay=t.wrapIntoAsync=t.awaitPromise=t.typedRequest=t.PluginRequestKind=t.ComputationRequestKind=t.stableDynamicPluginLoaderInsideInit=t.DefaultComputationGroup=t.registerPluginFactory=t.PluginFactoryName=t.PluginGroup=t.MockTimerImmediate=t.setMockGridSheetAndNotify=t.createMockGridExporter=t.createMockGridProvider=t.createMockAsyncGrid=t.RecalcSideGrid=t.FormulaKind=t.GridImportManagerSingleton=t.PluginSchedulerSingleton=t.getSchedulerFactories=t.defaultPluginResponseWindows=t.ChatGPTPlugin=t.staticTypeHint=t.core=t.platform=void 0;const n=r(74643),a=n.__importStar(r(36159)),i=n.__importStar(r(46870)),o=n.__importStar(r(29163)),s=n.__importStar(r(961)),u=n.__importStar(r(98576)),l=n.__importStar(r(44544)),c=n.__importStar(r(2340)),d=n.__importStar(r(36873)),g=n.__importStar(r(27308)),m=n.__importStar(r(62886)),h=n.__importStar(r(46489)),p=n.__importStar(r(87760)),f=n.__importStar(r(59731)),S=n.__importStar(r(73513)),v=n.__importStar(r(3541)),F=n.__importStar(r(95767)),y=n.__importStar(r(77829)),C=n.__importStar(r(12893)),A=n.__importStar(r(91903)),E=n.__importStar(r(44700)),b=n.__importStar(r(93336)),R=n.__importStar(r(46124)),T=n.__importStar(r(91793)),k=n.__importStar(r(11182)),N=n.__importStar(r(88526)),I=n.__importStar(r(74056));var O=r(90324);Object.defineProperty(t,"platform",{enumerable:!0,get:function(){return O.platform}}),t.core=a,t.staticTypeHint=i.staticTypeHint,t.ChatGPTPlugin=F.ChatGPTPlugin,t.defaultPluginResponseWindows=C.defaultPluginResponseWindows,t.getSchedulerFactories=o.getSchedulerFactories,t.PluginSchedulerSingleton=o.PluginSchedulerSingleton,t.GridImportManagerSingleton=o.GridImportManagerSingleton,t.FormulaKind=g.FormulaKind,t.RecalcSideGrid=f.RecalcSideGrid,t.createMockAsyncGrid=s.createMockAsyncGrid,t.createMockGridProvider=s.createMockGridProvider,t.createMockGridExporter=s.createMockGridExporter,t.setMockGridSheetAndNotify=s.setMockGridSheetAndNotify,t.MockTimerImmediate=u.MockTimerImmediate,t.PluginGroup=b.PluginGroup,t.PluginFactoryName=b.PluginFactoryName,t.registerPluginFactory=l.registerPluginFactory,t.DefaultComputationGroup=c.DefaultComputationGroup,t.stableDynamicPluginLoaderInsideInit=o.dynamicPluginLoaderInsideInit,t.ComputationRequestKind=c.ComputationRequestKind,t.PluginRequestKind=c.ComputationRequestKind,t.typedRequest=c.typedRequest,t.awaitPromise=c.awaitPromise,t.wrapIntoAsync=p.wrapIntoAsync,t.delay=c.delay,t.RequestKind=C.RequestKind,t.NotificationKind=d.NotificationKind,t.ComputationType=E.ComputationType,t.EventKind=y.EventKind,t.ALAnnotationKind=y.ALAnnotationKind,t.PluginRegistry=A.PluginRegistry,t.ValuePreviewResultExtractor=S.ValuePreviewResultExtractor,t.spanToLSPRange=m.spanToLSPRange,t.ensureGroupAttached=h.ensureGroupAttached,t.ensureGroupAttachedLegacy=h.ensureGroupAttachedLegacy,t.ensurePluginAttached=h.ensurePluginAttached,t.setX10Features=h.setX10Features,t.resolveScriptLoaderPromise=h.resolveScriptLoaderPromise,t.defaultTimerInterface=v.defaultTimerInterface,t.TimelineQueueProcessor=v.TimelineQueueProcessor,t.RangeHelpers=R,t.VisitorHelpers=T,t.runQueueProcessorUntil=k.runQueueProcessorUntil,t.GateOverrideManager=N.GateOverrideManager,t.testingCGOverrides=N.testingCGOverrides,t.Test=I},81623:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promises=void 0;const r={},n="promises";t.promises=function(){return void 0===r[n]&&(r[n]="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&"function"==typeof Promise.resolve(0).then),r[n]}},37925:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=void 0,t.getNewGuid=function(){const e=new Uint8Array(31),t=function(e){const t={crypto:!1,perfNow:!1,exceptions:[]},r="undefined"!=typeof self?self:window,n=r.crypto||r.msCrypto;if(n){t.crypto=!0;try{return n.getRandomValues(e),t}catch(e){t.exceptions.push(`crypto: ${JSON.stringify(e)}`)}}let a=!1;const i=r.performance;try{i&&i.now&&i.now()!==1/0&&(a=!0)}catch(e){t.exceptions.push(`perfNow: ${JSON.stringify(e)}`)}for(let r=0;r<e.length;r+=1){try{if(a){t.perfNow=!0;let e=Math.floor(100*i.now())%10;(e<0||e>9)&&(e=0);for(let t=0;t<e;t+=1)Math.random()}}catch(e){t.exceptions.push(`Math.random: ${JSON.stringify(e)}`)}e[r]=Math.floor(16*Math.random())}return t}(e);let r=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const n=15&e[r];return r+=1,("x"===t?n:3&n|8).toString(16)})),t]}},28727:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isReplaceChildrenSupported=t.replaceChildren=void 0,t.replaceChildren=e=>{if(e)if((0,t.isReplaceChildrenSupported)(e))e.replaceChildren();else for(;e.lastChild;)e.removeChild(e.lastChild)},t.isReplaceChildrenSupported=e=>!!e.replaceChildren},82438:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=t.initStopwatchFactory=t.ConsoleLogger=t.NulLogger=t.perfWatch=t.browserSupport=t.LogCategory=t.TraceLevel=t.ULS=t.utils=t.replaceChildren=t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=t.getNewGuid=void 0;const n=r(29895);t.utils=n;const a=r(43268);Object.defineProperty(t,"ULS",{enumerable:!0,get:function(){return a.ULS}}),Object.defineProperty(t,"TraceLevel",{enumerable:!0,get:function(){return a.TraceLevel}}),Object.defineProperty(t,"LogCategory",{enumerable:!0,get:function(){return a.LogCategory}}),Object.defineProperty(t,"NulLogger",{enumerable:!0,get:function(){return a.NulLogger}}),Object.defineProperty(t,"ConsoleLogger",{enumerable:!0,get:function(){return a.ConsoleLogger}});const i=r(81623);t.browserSupport=i;const o=r(42768);t.perfWatch=o;const s=r(23409);Object.defineProperty(t,"initStopwatchFactory",{enumerable:!0,get:function(){return s.initStopwatchFactory}});const u=r(26314);Object.defineProperty(t,"TelemetryCollector",{enumerable:!0,get:function(){return u.TelemetryCollector}});var l=r(37925);Object.defineProperty(t,"getNewGuid",{enumerable:!0,get:function(){return l.getNewGuid}});var c=r(4004);Object.defineProperty(t,"TextAreaVirtualKeyboardPolicy",{enumerable:!0,get:function(){return c.TextAreaVirtualKeyboardPolicy}}),Object.defineProperty(t,"TextAreaInputMode",{enumerable:!0,get:function(){return c.TextAreaInputMode}});var d=r(28727);Object.defineProperty(t,"replaceChildren",{enumerable:!0,get:function(){return d.replaceChildren}})},43268:function(e,t){"use strict";var r,n;Object.defineProperty(t,"__esModule",{value:!0}),t.NulLogger=t.ConsoleLogger=t.ULS=t.LogCategory=t.TraceLevel=void 0,function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(r||(t.TraceLevel=r={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(n||(t.LogCategory=n={})),t.ULS={getFromExternalLogger:function(e){const t=e;return{ULS:{trace:(e,r,n)=>t.traceTag(0,e,r,n),traceTag:(e,r,n,a)=>t.traceTag(e,r,n,a),debugTrace:(e,r,n)=>t.debugTraceTag(0,e,r,n),debugTraceTag:(e,r,n,a)=>t.debugTraceTag(e,r,n,a),assert:(e,r,n)=>t.assertTag(0,e,r,n),assertTag:(e,r,n,a)=>t.assertTag(e,r,n,a),shipAssert:(e,r,n)=>t.shipAssertTag(0,e,r,n),shipAssertTag:(e,r,n,a)=>t.shipAssertTag(e,r,n,a),dnmTrace:(e,r,n)=>t.dnmTraceTag(0,e,r,n),dnmTraceTag:(e,r,n,a)=>t.dnmTraceTag(e,r,n,a)}}}},t.ConsoleLogger=class{shipAssertTag(e,t,r,n){console.assert(r,"shipAssertTag:",e,t,n)}assertTag(e,t,r,n){console.assert(r,"assertTag",e,t,n)}traceTag(e,t,r,n){console.log("traceTag",e,n,t,r)}dnmTraceTag(e,t,r,n){console.log("dnmTraceTag",e,n,t,r)}debugTraceTag(e,t,r,n){console.log("debugTraceTag",e,n,t,r)}},t.NulLogger=class{shipAssertTag(){}assertTag(){}traceTag(){}debugTraceTag(){}dnmTraceTag(){}}},42768:function(e,t){"use strict";function r(){const e="undefined"!=typeof self?self:window;return e.performance&&e.performance.now?e.performance.now():Date.now()}function n(e,t,n){e[t]=r()-n}Object.defineProperty(t,"__esModule",{value:!0}),t.timeStamp=t.failure=t.success=t.end=t.mark=t.start=void 0,t.start=function(e){const t=r(),a=e,i=t,o={},s=(e,t,r)=>function(e,t,r,a,i,o){n(e,"end",r);const s={sessionName:t,result:a?"success":"failure",message:o,marks:e};i(JSON.stringify(s))}(o,a,i,e,t,r);return o.start=0,{mark:e=>(e=>n(o,e,i))(e),end:e=>s(!0,e),success:(e,t)=>s(!0,e,t),failure:(e,t)=>s(!1,e,t)}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)},t.timeStamp=r},4004:function(e,t){"use strict";var r,n;Object.defineProperty(t,"__esModule",{value:!0}),t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=void 0,function(e){e.Auto="auto",e.Manual="manual"}(r||(t.TextAreaVirtualKeyboardPolicy=r={})),function(e){e.None="none",e.Text="text",e.Tel="tel",e.Url="url",e.Email="email",e.Numeric="numeric",e.Decimal="decimal",e.Search="search"}(n||(t.TextAreaInputMode=n={}))},23409:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initStopwatchFactory=void 0;let r=()=>Date.now();t.initStopwatchFactory=function(e,t=1){return"undefined"!=typeof self&&self.performance&&self.performance.now&&(r=()=>self.performance.now()),function(n){let a=r(),i=n;return{reset(e){null!=e&&(i=e),a=r()},stop(n){const o=r()-a,s=JSON.stringify({Target:i,Duration:o.toFixed(t),StopInfo:n});e(s)}}}}},26314:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=void 0,t.TelemetryCollector=class{getJsonForLogging(){return'{"Events":'+this.getEventsLoggableString()+',"Counters":'+this.getCountersLoggableString()+',"Timers":'+this.getTimersLoggableString()+"}"}addEvent(e,t){null!=e&&null!=t&&(this.events[e]=t)}clearEvents(){this.events={}}getEventsLoggableString(){return JSON.stringify(this.events)}incrementCounter(e){null!=e&&(this.counters.hasOwnProperty(e)?this.counters[e]+=1:this.counters[e]=1)}getCountersLoggableString(){return JSON.stringify(this.counters)}clearCounters(){this.counters={}}startTimer(e){null!=e&&(this.timers[e]={name:e,startTime:Date.now(),endTime:void 0,isRunning:!0,duration:void 0})}endTimer(e){null!=e&&this.timers.hasOwnProperty(e)&&(this.timers[e].endTime=Date.now(),this.timers[e].isRunning=!1,this.timers[e].duration=this.timers[e].endTime-this.timers[e].startTime)}getTimerDuration(e){return null==e?"-1":this.timers.hasOwnProperty(e)&&void 0!==this.timers[e].duration?this.timers[e].duration:"-1"}getTimersLoggableString(){return JSON.stringify(this.timers)}constructor(){this.counters={},this.timers={},this.events={}}}},29895:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calcHashCode=t.decodeHtml=t.getQueryParameterByName=t.chainFallbackPromises=t.retry=t.getPerfWatchMarkName=t.getStringifiedError=t.defaultToJSONResultWhenStringifyFails=t.forEachPromise=void 0,t.forEachPromise=function(e,t,r){return e.reduce(((e,n)=>e.then((()=>r&&r.stop?Promise.resolve(void 0):t(n,r)))),Promise.resolve(void 0))},t.defaultToJSONResultWhenStringifyFails="...",t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(n(e))}catch{return t.defaultToJSONResultWhenStringifyFails}};const r=5;function n(e,t=0){if(t<0||t>r)return e;if(null==e||"object"!=typeof e)return e;const a={};Object.getOwnPropertyNames(e).forEach((t=>{"stack"!==t&&t.toUpperCase()!==t&&(a[t]=e[t])}));const i=Object.getPrototypeOf(e);i&&"object"==typeof i&&Object.keys(i).forEach((t=>{"stack"!==t&&t.toUpperCase()!==t&&(a[t]=e[t])}));const o={};return Object.keys(a).forEach((e=>{o[e]=n(a[e],t+1)})),o}const a=new RegExp("\\W+","g");t.getPerfWatchMarkName=function(e){if(!e)return"";let t=e.trim().substring(0,200).trim().replace(a,"_").substring(0,80);return t&&t.length>0&&"_"===t.substr(t.length-1,1)&&(t=t.substr(0,t.length-1)),t&&t.length>0&&"_"===t.substr(0,1)&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error(`utils.retry: attempts expected to be greater than 0 but got ${t}`));let r=Promise.reject();for(let n=1;n<=t;n+=1)r=r.catch((t=>e(n,t)));return r},t.chainFallbackPromises=function(e,t){if(!e||0===e.length)return Promise.reject();let r=t(e[0]);for(let n=1;n<e.length;n+=1){const a=e[n];r=r.catch((()=>t(a)))}return r},t.getQueryParameterByName=function(e,t){const r=new RegExp(`[?&]${t}(=([^&#]*)|&|#|$)`).exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""},t.decodeHtml=function(e){return"string"==typeof e?(new DOMParser).parseFromString(e,"text/html").documentElement.textContent:e},t.calcHashCode=function(e){if(!e)return 0;let t=5381,r=t;const n=e.length;for(let a=0;a<n&&(t=4294967295&((t<<5)+t^e.charCodeAt(a)),a!==n-1);a+=2)r=4294967295&((r<<5)+r^e.charCodeAt(a+1));let a=t+35685*r+(23896*r<<16)&4294967295;return a<0&&(a+=4294967296),a}},6585:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stackSave=t.stackRestore=t.stackAlloc=t.setThrew=t.memory=t._start=t.__growWasmMemory=t.__errno_location=t.Mathpack_Zero=t.Mathpack_ViewRound=t.Mathpack_Trunc=t.Mathpack_TenTo=t.Mathpack_Tan=t.Mathpack_TakeMathError=t.Mathpack_Sub=t.Mathpack_Sqrt=t.Mathpack_Sin=t.Mathpack_SFloat=t.Mathpack_SFix=t.Mathpack_RoundUp=t.Mathpack_RoundDown=t.Mathpack_Round=t.Mathpack_Power=t.Mathpack_Pi=t.Mathpack_Pack=t.Mathpack_One=t.Mathpack_Neg=t.Mathpack_Mul=t.Mathpack_Mod=t.Mathpack_Log=t.Mathpack_Ln=t.Mathpack_LFix=t.Mathpack_GetExp32=t.Mathpack_FormatScientific=t.Mathpack_FormatGetSign=t.Mathpack_FormatGetExponent=t.Mathpack_FormatGeneral=t.Mathpack_FormatFixed=t.Mathpack_Floor=t.Mathpack_Float=t.Mathpack_Fix=t.Mathpack_Exp=t.Mathpack_Equal=t.Mathpack_Div=t.Mathpack_Cos=t.Mathpack_Cond2=t.Mathpack_Cond=t.Mathpack_Compare=t.Mathpack_Ceil=t.Mathpack_Atan2=t.Mathpack_Atan=t.Mathpack_Asin=t.Mathpack_Add=t.Mathpack_Acos=t.Mathpack_Abs=t.Dtr_Yr=t.Dtr_Write=t.Dtr_Wdy=t.Dtr_UtcToLocal=t.Dtr_ToTime=t.Dtr_ToNumWithDuration=t.Dtr_ToNum=t.Dtr_ToDays=t.Dtr_Sec=t.Dtr_Rounding=t.Dtr_Mon=t.Dtr_Min=t.Dtr_Hour=t.Dtr_FromNum=t.Dtr_FracSec=t.Dtr_DaysPerMonth=t.Dtr_Days=t.Dtr_DOM=t.Base_StrBufSize=t.Base_StrBuf=void 0;var n=r(45488),a=r(80863),i=r(93119),o=new ArrayBuffer(8),s=new Int32Array(o),u=(new Float32Array(o),new Float64Array(o));function l(e){return s[e]}function c(e,t){s[e]=t}function d(){return u[0]}function g(e){u[0]=e}var m,h=new ArrayBuffer(65536),p=(m=new Uint8Array(h),function(e,t){var r,n;if("undefined"==typeof Buffer)for(r=atob(t),n=0;n<r.length;n++)m[e+n]=r.charCodeAt(n);else for(r=Buffer.from(t,"base64"),n=0;n<r.length;n++)m[e+n]=r[n]});p(1024,"yAwAAAEAAAACAAAAAwAAAAAAAAAE"),p(1056,"AQAAAAsAAAANAAAABwAAAAkAAAADAAAABQAAAA8AAAAAAAEAMAACADkAMQAcAAMAPQA6ADIAKgAmAB0AEQAEAD4ANwA7ACQANQAzACsAFgAtACcAIQAeABgAEgAMAAUAPwAvADgAGwA8ACkAJQAQADYAIwA0ABUALAAgABcACwAuABoAKAAPACIAFAAfAAoAGQAOABMACQANAAgABwAGAJAMAACYDAAAoAwAAKgMAAAfHR8eHx4fHx4fHh8fHB8eHx4fHx4fHh8fHB8eHx4fHx4fHh8fHB8eHx4fHx4fHh8fHB8eHx4fHx4fHh8fHR8eHx4fHx4fHh8="),p(1312,"WAwAAHAMAABoDAAAeAw="),p(1359,"AQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQECAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsAAAAAHwA8AFsAeQCYALYA1QD0ABIBMQFPAW4B"),p(1759,"AQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwAAAAAAHwA7AFoAeACXALUA1ADzABEBMAFOAW0B"),p(2135,"oAQ="),p(2151,"yAc="),p(2167,"+go="),p(2182,"QJwO"),p(2198,"UMMR"),p(2214,"JPQU"),p(2229,"gJaYGA=="),p(2245,"ILy+Gw=="),p(2261,"KGvuHg=="),p(2277,"+QKVIg=="),p(2292,"QLdDuiU="),p(2308,"EKXU6Cg="),p(2324,"KueEkSw="),p(2339,"gPQg5rUv"),p(2355,"oDGpX+My"),p(2371,"BL/JG442AAAAAAAAAJ61cCuorcWdawAAAAAAAADXlUMOBY0pr6AAAAAAAAAA1abP/0kfeMLVAAAAAAAAAPz32oePeufXCgEAAAAAAACjFJvFFquz7z8BAAAAAAAAnjIjmcCtD4V1AQAAAAAAAOCM6YDJR7qTqgEAAAAAAADnptOoxbkCpN8BAAAAAAAAqhfmfyuhFrYUAgAAAAAAAJO/m4WRoijKSQIAAAAAAABrVSc5jfdw4H4CAAAAAAAARmGCNzUMLvmzAgAAAAAAADDJPOP/llKK6QIAAAAAAABmF7/W86aRmR4DAAAAAAAAjt75nfvrfqpTAwAAAAAAAM3MzMzMzMzM/f///wAAAAAK16NwPQrXo/r///8AAAAAO99PjZduEoP3////AAAAACxlGeJYF7fR8////wAAAAAjhEcbR6zFp/D///8AAAAAtmlsrwW9N4bt////AAAAALxCeuXVlL/W6f///wAAAAD9zmGEEXfMq+b///8AAAAAl6W0NkFfcInj////AAAAAL/V7b3O/ubb3////wAAAAD/qiTLC//rr9z///8AAAAAzIhQbwnMvIzZ////AAAAABMOtEtCEy7h1f///wAAAAAP2FwJNdwktNL///8AAAAA2aywOvd8HZDP////AAAAAFvhTcS+lJXmy////wAAAAC6lDlFrR6xz5b///8AAAAAWcF+sVN8Erth////AAAAAKXpOaUn6n+oLP///wAAAACmGQlrumDFl/f+//8AAAAAm1N1/fcCtIjC/v//AAAAAH3TZfC8NUP2jP7//wAAAACh5LxkfEbQ3Vf+//8AAAAAyYJTfG66ysci/v//AAAAAJOgc9uT4PSz7f3//wAAAAAwAMs42ycXorj9//8AAAAABswjVHeD/5GD/f//AAAAAGC8pD2p3oCDTv3//wAAAAC+TjFK7Dzl7Bj9//8AAAAA1+Eyz81fYNXj/P//AAAAADoZemMlQzHArvz//w=="),p(3126,"kEEYLURU+yEJQAAAAAAAAOA/AAAAAAAAAEAYLURU+yH5PwAAAAAAAPA/"),p(3182,"WUAAAAAAAAAkQAAAAAAAQI9AAAAAAAAAOEAAAAAAAABOQClRzqDIRdg+IXQL5wZroz41IN+kpBFvPvZNfx3q2jg+AADA////30EAAAAAAADgwQAAsOlNYnBCBAQAABAE"),p(3904,"4E8=");var f=function(e,t,r){var n=new e.Int8Array(r),a=new e.Int16Array(r),i=new e.Int32Array(r),o=new e.Uint8Array(r),u=new e.Uint16Array(r),m=new e.Uint32Array(r),h=(new e.Float32Array(r),new e.Float64Array(r)),p=e.Math.imul,f=(e.Math.fround,e.Math.abs),S=e.Math.clz32,v=e.Math.min,F=(e.Math.max,e.Math.floor),y=e.Math.ceil,C=e.Math.sqrt,A=t.abort,E=(e.NaN,e.Infinity,t.Base_LocaleIsNumeral),b=t.Base_LocaleGetOrdinal,R=t.Base_LocaleDecimalSeparator,T=t.Math_log10,k=t.Math_log,N=(C=t.Math_sqrt,t.Math_sin),I=t.Math_cos,O=t.Math_tan,_=t.Math_atan,P=t.Math_exp,M=t.proc_exit,D=t.getTempRet0,w=20288,L=0;function x(){}function K(e,t,r){e:if(e>>>0<=t>>>0){if(!r)break e;for(;n[0|e]=o[0|t],e=e+1|0,t=t+1|0,r=r+-1|0;);}else if(r)for(e=e+r|0,t=t+r|0;t=t+-1|0,n[0|(e=e+-1|0)]=o[0|t],r=r+-1|0;);}function W(e,t){var r,s,c=0,d=0,m=0,p=0;if(d=3856,w=r=w-48|0,i[r+40>>2]=0,a[r+30>>1]=0,a[r+32>>1]=0,h[482]=e,s=$(e),h[482]=s,ye(s,r+40|0,r,15),u[r+42>>1]){c=(0|(c=ge(t)<<16))<0?100:c>>16,g(+t),m=0|l(1),l(0),(p=-65536&m)&&(2146435072!=(2146435072&m)?c=(0|p)<1?0-c|0:c:i[966]=1);e:{if(!((0|(c=a[r+40>>1]+c|0))>=a[r+42>>1])){if((0|c)<1){d=3168;break e}(255&c)>>>0>=o[r+30|0]||(n[r+30|0]=c)}Fe(3276,3856,r)}e=h[d>>3]}return w=r+48|0,e}function U(e,t){var r,n=0,a=0,o=0;if(h[482]=e,g(+e),a=0|l(1),l(0),o=a,a=0,(n=-65536&o)&&(2146435072!=(2146435072&o)?a=(0|n)<1:(i[966]=1,a=0)),i[965]=2147483647&o,re(h[395]),n=-65536&(o=i[965]))if(2146435072!=(2146435072&o)){if(!((0|n)<1))return z(8),0}else i[966]=1;r=ne(h[395],e),Ee(h[393],r),ae(r),pe();e:{t:{if((n=i[965])>>>0>=65536){if(2146435072!=(2146435072&n))break t;i[966]=1}if(t){if(i[964]=0,i[965]=0,!a)break e;return t=i[783],i[964]=i[782],i[965]=t,h[482]}if(n=i[789],i[964]=i[788],i[965]=n,t=n,1^a|n>>>0<65536)break e;return i[965]=-2147483648^t,h[482]}Te(e),fe(),t&&(h[482]=ne(h[394],h[482]))}return h[482]}function G(e,t,r,n){var s,l=0,c=0,d=0,g=0,m=0,h=0,f=0;if(l=i[e+4>>2],m=-2146827284,!((0|(s=(c=u[e>>1])+(e=(0|(d=a[e+2>>1]))>=1?(d+-1|0)/12|0:(0|d)/-12^-1)<<16>>16))>9999|((r?1900:-9999)+(t?4:0)|0)>(0|s)||((d=d+p(e,-12)<<16>>16)-1&65535)>>>0>11|(!l|1900==(0|s)&2==(0|d)&29==(0|l)?!r:0))){if(h=(0|(e=(g=(0|(c=s+1e4|0))/4|0)<<2))%100|0,f=(0|e)%400|0,l=(((g=p(g,1461)+l|0)+((0|(l=e+-1|0))/-100|0)|0)+((0|l)/400|0)|0)-1|0,c=(p(c-e|0,12)+d|0)-1|0)for(c=c+(e=f?h?0:12:0)|0;l=o[e+1232|0]+l|0,(0|c)!=(0|(e=e+1|0)););e:if(r||t){if(e=l+-4346385|0,!((0|s)>1900|(0|d)>=3))break e;e=l+-4346384|0}else e=l+-4346384|0;e>>>0>2958465||(i[n>>2]=e,m=0)}return m}function B(e,t,r){var n,s,u,l=0,c=0,d=0;c=d=_e(e,t,711573504,201),i[r+28>>2]=(c+1>>>0)%7,l=c+p(n=(c>>>0)/146097|0,-146097)|0,s=(p(l,100)+75>>>0)/3652425|0,l=((u=p(s,-36524)+l|0)>>>0)/1461|0,c=(((c+(((l=((p(s,100)+p(n,400)|0)+(l<<2)|0)+((p(u+p(l,-1461)|0,100)+75>>>0)/36525|0)|0)>>>0)/100|0)|0)-(l>>>2)|0)-((l>>>0)/400|0)|0)+p(l,-365)|0,d=Oe(d,L,-864e5,-1),e=_e(e,t,1e4,0)+d|0,d=!(((t=l+1|0)>>>0)%100)|3&t&&(t>>>0)%400|0?2096+((t=o[c+1728|0])<<1)|0:1696+((t=o[c+1328|0])<<1)|0,i[r+12>>2]=(e>>>0)/36e5,i[r+4>>2]=t+1,i[r>>2]=l+1601,t=(e>>>0)/1e3|0,i[r+20>>2]=(t>>>0)%60,i[r+16>>2]=((e>>>0)/6e4>>>0)%60,i[r+24>>2]=e-p(t,1e3),i[r+8>>2]=1+(c-a[d>>1]|0)}function V(e,t){var r=0,n=0,o=0,s=0,u=0,l=0,c=0,d=0,g=0,m=0,h=0,f=0;return(0|(s=i[e+4>>2]))<1||(d=s+-1|0)>>>0>11||(n=(r=i[e>>2])+-1601|0)>>>0>29226||(0|(u=i[e+8>>2]))<1||(o=1696,((l=65535&r)>>>0)%400&&(o=3&r?2096:(l>>>0)%100|0?1696:2096),(g=i[e+24>>2])>>>0>999||(l=i[e+20>>2])>>>0>59||(m=i[e+16>>2])>>>0>59||(h=i[e+12>>2])>>>0>23||(u=u+-1|0)>>>0>=a[o+(s<<1)>>1]-a[o+(d<<1)>>1]>>>0||(o=n>>>2,s=p(n,365),n=((e=65535&n)>>>0)/400|0,f=(e>>>0)/100|0,((c=65535&(r=r+-1600|0))>>>0)%400&&(e=2096,!((c>>>0)%100)|3&r)||(e=1696),c=1,r=(r=p(p(p(h,60)+m|0,60)+l|0,1e3)+g|0)+(n=Oe(e=a[(d<<1)+e>>1]+(n+((u+(s+o|0)|0)-f|0)|0)|0,e>>31,864e5,0))|0,e=L,i[t>>2]=Oe(r,r>>>0<n>>>0?e+1|0:e,1e4,0),i[t+4>>2]=L)),c}function j(e,t,r,n){var a,o=0,s=0,u=0,l=0;w=a=w-112|0,B(r,n,a+80|0);e:{if(i[e>>2]){if(!V(e,t))break e}else{if((0|(s=i[e+8>>2]))>5|!s)break e;if(r=i[e+4>>2],n=i[e+28>>2],o=i[a+80>>2],i[a+56>>2]=1,i[a+52>>2]=r,i[a+48>>2]=o,i[a+60>>2]=i[e+12>>2],i[a+64>>2]=i[e+16>>2],i[a+68>>2]=i[e+20>>2],e=i[e+24>>2],i[a+76>>2]=0,i[a+72>>2]=e,!V(a+48|0,a+8|0)){o=0;break e}e=n+8|0,r=n+1|0,u=(0|s)<2,B(i[a+8>>2],i[a+12>>2],a+16|0),l=a;t:{if((0|n)<(0|(o=i[a+44>>2])))e=e-o|0;else{if(e=1,(0|n)<=(0|o))break t;e=r-o|0}i[l+56>>2]=e}t:if(!u&&(r=e+7|0,i[a+56>>2]=r,o=1,V(a+48|0,a+8|0)))for(;;){if(B(i[a+8>>2],i[a+12>>2],a+16|0),e=i[a+24>>2],(0|s)==(0|(o=o+1|0)))break t;if(r=r+7|0,i[a+56>>2]=r,!V(a+48|0,a+8|0))break}if(i[a+56>>2]=e,!V(a+48|0,a+8|0)){o=0;break e}e=i[a+12>>2],i[t>>2]=i[a+8>>2],i[t+4>>2]=e}o=1}return w=a+112|0,o}function H(e,t,r){var n,o=0,s=0,l=0,c=0,d=0;if(w=n=w-16|0,r&&(l=r>>31,l^=l+r))for(r=(0|r)>0?2112:2608;(o=15&l)&&(s=a[8+(o=(o<<4)+r|0)>>1],d=q(h[e>>3],h[o>>3],n),t=t+s|0,a[n+14>>1]<=0?(o=u[n+6>>1],s=u[n+8>>1]):(s=i[n+4>>2],o=u[n+6>>1]<<1,a[n+6>>1]=o,c=i[n+8>>2],i[n+12>>2]=i[n+12>>2]<<1|c>>>31,s=c<<1|s>>>31,i[n+8>>2]=s,t=t+-1|0),(65535&o|1&s|0!=(0|d))>>>0<32769||(s=(o=i[n+8>>2])+1|0,i[n+8>>2]=s,s>>>0>=o>>>0||(s=(o=i[n+12>>2])+1|0,i[n+12>>2]=s,s>>>0>=o>>>0||(i[n+12>>2]=-2147483648,t=t+1|0))),o=i[n+12>>2],i[e>>2]=i[n+8>>2],i[e+4>>2]=o),r=r+240|0,l>>=4;);return w=n+16|0,t}function q(e,t,r){var n,i,o,s=0,u=0,c=0,d=0,m=0,h=0,f=0,S=0,v=0,F=0,y=0,C=0;return g(+t),d=0|l(1),m=65535&(u=0|l(0)),g(+e),F=0|l(1),s=0|l(0),c=F,i=p(S=65535&s,m),a[r>>1]=i,o=((65535&(y=p(v=s>>>16,m)))+(i>>>16)|0)+(65535&(f=p(u>>>=16,S)))|0,a[r+2>>1]=o,y=(((h=((65535&(s=p(n=65535&c,m)))+(y>>>16)|0)+(f>>>16)|0)+(65535&(f=p(u,v)))|0)+(65535&(C=p(F=65535&d,S)))|0)+(o>>>16)|0,a[r+4>>1]=y,f=(((((((65535&(h=p(d>>>=16,S)))+(s>>>16)|0)+(65535&(c=p(s=c>>>16,m)))|0)+(f>>>16)|0)+(C>>>16)|0)+(65535&(m=p(F,v)))|0)+(65535&(S=p(u,n)))|0)+(y>>>16)|0,a[r+6>>1]=f,v=((((((C=(c>>>16)+(h>>>16)|0)+(65535&(c=p(d,v)))|0)+(m>>>16)|0)+(S>>>16)|0)+(65535&(h=p(s,u)))|0)+(65535&(u=p(F,n)))|0)+(f>>>16)|0,a[r+8>>1]=v,h=((u=(((65535&(m=p(d,n)))+(c>>>16)|0)+(h>>>16)|0)+(u>>>16)|0)+(65535&(c=p(s,F)))|0)+(v>>>16)|0,a[r+10>>1]=h,s=(((65535&(d=p(s,d)))+(m>>>16)|0)+(c>>>16)|0)+(h>>>16)|0,a[r+12>>1]=s,a[r+14>>1]=(s>>>16)+(d>>>16),65535&(i|o|y)}function $(e){var t,r,n=0,a=0,o=0,s=0,u=0,c=0;return w=t=w-16|0,h[t+8>>3]=e,g(+e),n=0|l(1),a=0|l(0),r=n,(n&=2146435072)&&(i[t+8>>2]=a<<11,i[t+12>>2]=r<<11|a>>>21|-2147483648,s=(n=p(a=(n>>>20)-1022|0,39457)>>17)-14|0,o=H(t+8|0,a,14-n|0),a=i[t+8>>2],(0|o)>=(0|(m[t+12>>2]<(a>>>0<2147477094?-1243209483:-1243209484)>>>0?48:47))||(o=H(t+8|0,o,1),a=i[t+8>>2],s=n+-15|0),n=s,s=(s=a)+(a=-2147483648>>>(31&o))|0,i[t+8>>2]=s,s>>>0>=a>>>0||(c=(u=i[t+12>>2])+1|0,i[t+12>>2]=c,c>>>0>=u>>>0||(i[t+12>>2]=-2147483648,o=o+1|0)),i[t+8>>2]=s&0-(a<<1),o=H(t+8|0,o,n),3071&(n=i[t+8>>2])?(a=n+1024|0,i[t+8>>2]=a,n>>>0<4294966272||(s=(n=i[t+12>>2])+1|0,i[t+12>>2]=s,o=(s>>>0<n>>>0)+o|0)):a=n,(0|o)<=-1023?(i[t+8>>2]=0,i[t+12>>2]=0):(0|(n=1071644672+(o<<20)|0))<=-1||(o=i[t+12>>2],i[t+8>>2]=o<<21|a>>>11,i[t+12>>2]=o>>>11&1048575|n|-2147483648&r),e=h[t+8>>3]),w=t+16|0,e}function z(e){var t;return t=i[966],i[966]=e,t}function Q(){var e,t,r;return e=i[964],t=i[965],ee(1048576),ee(2146435072),a[1931]<0?(i[964]=e,i[965]=t,-2147483648):(r=de(),i[964]=e,i[965]=t,-2147483648^r)}function Y(e){var t,r=0,n=0,a=0,i=0;if(g(+e),r=0|l(1),t=0|l(0),i=r,a=0,!((r=2047&(n=r>>>20))>>>0<1023||(a=e,r>>>0>1075))){if(n=-1<<(19-n&31),r>>>0>=1044)return c(0,n&t),c(1,0|i),+d();i&=n,c(0,0),c(1,0|i),a=+d()}return a}function J(e){var t=0,r=0,n=0;if(e+307>>>0<=615)return i[964]=0,i[965]=-2147483648,n=H(3856,1,e),r=i[964],e=i[965],3071&r&&(t=i[965],(e=i[964]+1024|0)>>>0<1024&&(t=t+1|0),i[964]=e,i[965]=t,r=e,e=t),i[964]=e<<21|r>>>11,void(i[965]=1071644672+(e>>>11&1048575|n<<20));(0|e)>=309&&(i[966]=1),i[964]=0,i[965]=0}function X(e,t,r,n){var o=0,s=0,l=0;e:{t:{r:{n:{if(!n){if(u[e>>1]<=52)break n;break t}if(!((0|n)<1)&&(0|n)<15)break r}return i[t>>2]=1,void(i[r>>2]=0)}if(u[(n<<1)+e>>1]<=52)break e;for(;;){if(l=u[(s=((o=n+-1|0)<<1)+e|0)>>1]+1|0,a[s>>1]=l,58!=(65535&l))break e;if(!(n=o))break}}return a[e>>1]=49,i[t>>2]=i[t>>2]+1,void(i[r>>2]=1)}for(;t=n,(0|n)>=2&&48==u[((n=t+-1|0)<<1)+e>>1];);i[r>>2]=t}function Z(){var e=0,t=0,r=0;e:{if(r=i[964],t=-65536&(e=i[965])){if(2146435072==(2146435072&e))return i[966]=1,void Se();if((0|t)<1)break e}return void Se()}Se(),(0|r)==i[964]&&i[965]==(0|e)||re(1)}function ee(e){h[482]=te(h[482],e)}function te(e,t){var r;return g(+(e+=t)),r=0|l(1),l(0),2146435072==(2146435072&r)&&(i[966]=1,e=h[396]),e}function re(e){h[482]=ne(h[482],e)}function ne(e,t){var r;return g(+(e-=t)),r=0|l(1),l(0),2146435072==(2146435072&r)&&(i[966]=1,e=h[396]),e}function ae(e){h[482]=ie(h[482],e)}function ie(e,t){var r,n=0,a=0,o=0;return g(+e*t),n=0|l(1),r=0|l(0),0|2146435072!=(0|(a=2146435072&n))?(o=(a=!(a|o))?i[792]:r,n=a?i[793]:n,c(0,0|o),c(1,0|n),+d()):(i[966]=1,n=i[793],c(0,i[792]),c(1,0|n),+d())}function oe(e){h[482]=se(h[482],e)}function se(e,t){var r=0,n=0,a=0,o=0;if(g(+t),r=0|l(1),l(0),2146435072&r){if(n=1,g(+e/t),r=0|l(1),a=0|l(0),!(!0&2146435072==(0|(o=2146435072&r))))return a=(n=!(0|o))?i[792]:a,r=n?i[793]:r,c(0,0|a),c(1,0|r),+d()}else n=4;return i[966]=n,r=i[793],c(0,i[792]),c(1,0|r),+d()}function ue(e){h[482]=e>>>0}function le(e){h[482]=0|e}function ce(){var e,t;e=+k(+h[482]),h[482]=e,g(+e),t=0|l(1),l(0),2146435072==(2146435072&t)&&(i[966]=8)}function de(){return ge(h[482])}function ge(e){var t,r=0,n=0,a=0,i=0;return g(+e),i=1106247680==(0|(a=2146435072&(r=0|l(1))))&i>>>0<0|a>>>0<1106247680,t=r&=2147483647,c(0,0|(n=0|l(0))),c(1,0|r),(e=+d())<0x10000000000000000&e>=0?(a=f(e)>=1?e>0?~~v(F(e/4294967296),4294967295)>>>0:~~y((e-+(~~e>>>0>>>0))/4294967296)>>>0:0,r=~~e>>>0):(a=0,r=0),n=i?r:n,!(r=i?a:t)&n>>>0<4294967295|r>>>0<0?n:-1}function me(){return he(h[482])}function he(e){var t=0,r=0;return g(+e),t=0|l(1),l(0),r=1105199104==(0|(t&=2145386496))&r>>>0<0|t>>>0<1105199104,t=f(e)<2147483648?~~e:-2147483648,r?t:-2147483648}function pe(){var e,t;e=+C(+h[482]),h[482]=e,g(+e),t=0|l(1),l(0),2146435072==(2146435072&t)&&(i[966]=8)}function fe(){var e,t;e=+_(+h[482]),h[482]=e,g(+e),t=0|l(1),l(0),2146435072==(2146435072&t)&&(i[966]=8)}function Se(){h[482]=Y(h[482])}function ve(){var e,t;e=+P(+h[482]),h[482]=e,g(+e),t=0|l(1),l(0),2146435072==(2146435072&t)&&(i[966]=1)}function Fe(e,t,r){return function(e,t,r){var n=0,s=0,c=0,d=0;if(n=o[r+30|0]){for(s=r;d=10*d+ +(0|De[i[i[e>>2]+4>>2]](e,u[s>>1])),s=s+2|0,c=(0|n)>1,n=n+-1|0,c;);if(g(+d),n=0|l(1),e=0|l(0),i[t>>2]=e<<11,i[t+4>>2]=2147481600&((2097151&n)<<11|e>>>21)|e>>>21|-2147483648,n=H(t,(n>>>20&2047)-1022|0,((32767&u[r+32>>1])-o[r+30|0]|0)-16384|0),3071&(s=i[t>>2])?(e=s+1024|0,i[t>>2]=e,s>>>0<4294966272||(c=(s=i[t+4>>2])+1|0,i[t+4>>2]=c,n=(c>>>0<s>>>0)+n|0)):e=s,!((0|n)<=-1022))return(0|(s=1071644672+(n<<20)|0))<0?1:(n=i[t+4>>2],i[t>>2]=n<<21|e>>>11,i[t+4>>2]=-2147483648&a[r+32>>1]|s|n>>>11&1048575,0)}return i[t>>2]=0,i[t+4>>2]=0,0}(e,t,r)}function ye(e,t,r,o){!function(e,t,r,o){var s,c,d=0,m=0,f=0,S=0,v=0,F=0,y=0,C=0,A=0,E=0;w=s=w-16|0,h[s+8>>3]=e,c=t,g(+e),m=0|l(1),f=0|l(0),S=d=m;e:if(m=2146435072&d){if(m=p(v=(m>>>20)-1022|0,39457)>>17,a[r+32>>1]=m+16385|d>>>16&32768,(0|o)<=14){if((0|(o=1+(o+m|0)|0))<=-1){n[r+30|0]=0,a[r+32>>1]=0,a[t+2>>1]=0,t=0;break e}o=(0|o)<15?o:15}if(i[s+8>>2]=f<<11,i[s+12>>2]=S<<11|f>>>21|-2147483648,(0|(d=H(s+8|0,v,-1^m)))>=1)for(f=r+32|0;m=u[f>>1],a[f>>1]=m+1&32767|32768&m,(0|(d=H(s+8|0,d,-1)))>0;);if(d?(m=(f=i[s+12>>2])>>>(S=0-d|0),i[s+12>>2]=m,d=f<<d+32|i[s+8>>2]>>>S,i[s+8>>2]=d):(d=i[s+8>>2],m=i[s+12>>2]),d=(f=m>>>0<(d>>>0<2576980377?429496730:429496729)>>>0?922:9223)+d|0,i[s+8>>2]=d,d>>>0<f>>>0&&(m=m+1|0,i[s+12>>2]=m),(0|o)<1)f=r;else{for(F=d>>>16,y=u[s+14>>1],C=r+32|0,E=15==(0|o),f=r,S=1;;){v=o;t:{r:{for(;;){if(o=p(F,10)+(p(65535&d,10)>>>16)>>>16,A=p(y,10)+(o+p(65535&m,10)>>>16)>>>16|48,a[f>>1]=A,y=(m=o+p(m,10)|0)>>>16,F=(d=p(d,10))>>>16,1&(-1^S|48!=(0|A)))break r;if(o=u[C>>1],a[C>>1]=o+-1&32767|32768&o,!E)break}S=1;break t}f=f+2|0,S=0}if(o=v+-1|0,!((0|v)>1))break}i[s+12>>2]=m,i[s+8>>2]=d}d=(o=f-r|0)>>1;t:{if((0|o)<=29){if((0|m)<=-1){a[f>>1]=57,m=d+1|0;break t}a[f>>1]=48}for(;;){if(m=d,(0|d)<1)break t;if(d=m+-1|0,48!=u[(f=f+-2|0)>>1])break}}n[r+30|0]=m,a[t+2>>1]=m,t=(32767&u[r+32>>1])-16384|0}else n[r+30|0]=0,a[r+32>>1]=0,a[t+2>>1]=0,t=0;a[c>>1]=t,w=s+16|0}(e,t,r,o)}function Ce(e,t,r,n){var a,o=0,s=0,u=0,l=0,c=0,d=0,g=0;c=i[t+4>>2],a=i[t>>2],l=u,u=i[e>>2],e=Oe(a,l,o=i[e+4>>2],t=0),s=L,o=Oe(l=c,c=0,o,t),t=L+d|0,t=(s=s+o|0)>>>0<o>>>0?t+1|0:t,o=s,d=t,t=Oe(l,c,s=u,0),l=(u=o)+(o=L)|0,u=d,u=l>>>0<o>>>0?u+1|0:u,o=0,d=Oe(a,g,s,c),e=(s=(g=L)+e|0)>>>0<g>>>0?o+1|0:o,c=t,s=t+s|0,t=e,e=l,l=t=s>>>0<c>>>0?t+1|0:t,(t=e+t|0)>>>0<l>>>0&&(u=u+1|0),i[r>>2]=t,i[r+4>>2]=u,i[n>>2]=d,i[n+4>>2]=s}function Ae(e){return ne(h[482],e)}function Ee(e,t){h[482]=ne(e,t)}function be(e){return ie(h[482],e)}function Re(e){return se(h[482],e)}function Te(e){h[482]=se(e,h[482])}function ke(e,t){h[482]=se(e,t)}function A(){M(1),A()}function Ne(e,t){var r,n;r=0|e,n=0|t,s[0]=r,s[1]=n}function Ie(e,t,r,n){var a=0,i=0,o=0,s=0,u=0,l=0,c=0,d=0,g=0,m=0;e:{t:{r:{n:{a:{i:{o:{s:{u:{l:{if(o=t){if(!(a=r))break l;if(!(i=n))break u;if((a=S(i)-S(o)|0)>>>0<=31)break s;break t}if(1==(0|n)&r>>>0>=0|n>>>0>1)break t;return Ne(e-p(t=(e>>>0)/(r>>>0)|0,r)|0,0),L=0,t}if(a=n,!e)break o;if(!a)break i;if((i=a+-1|0)&a)break i;return Ne(e,o&i),e=o>>>(31&Me(a)),L=0,e}if(!((i=a+-1|0)&a))break a;l=0-(u=(S(a)+33|0)-S(o)|0)|0;break r}u=a+1|0,l=63-a|0;break r}return Ne(0,o-p(e=(o>>>0)/(a>>>0)|0,a)|0),L=0,e}if((a=S(a)-S(o)|0)>>>0<31)break n;break t}if(Ne(e&i,0),1==(0|a))break e;return n=e,e=31&(r=Me(a)),32<=(63&r)>>>0?(a=0,e=t>>>e):(a=t>>>e,e=((1<<e)-1&t)<<32-e|n>>>e),L=a,e}u=a+1|0,l=63-a|0}if(i=t,g=e,o=31&(a=63&u),32<=(63&a)>>>0?(a=0,s=i>>>o):(a=i>>>o,s=((1<<o)-1&i)<<32-o|g>>>o),i=a,o=e,e=31&(a=63&l),32<=(63&a)>>>0?(a=o<<e,e=0):(a=(1<<e)-1&o>>>32-e|t<<e,e=o<<e),t=a,u)for(a=n+-1|0,(o=r+-1|0)>>>0<4294967295&&(a=a+1|0),l=a;a=i<<1|s>>>31,i=s<<1,g=a,a=(s=l-((o>>>0<(i|=t>>>31)>>>0)+a|0)|0)>>31,s=(d=i)-(i=r&(c=s>>31))|0,i=g-((n&a)+(d>>>0<i>>>0)|0)|0,a=t<<1|e>>>31,e=m|e<<1,t=0|a,d=0,m=c&=1,u=u+-1|0;);return Ne(s,i),L=(a=t<<1|e>>>31)|d,c|e<<1}Ne(e,t),e=0,t=0}return L=t,e}function Oe(e,t,r,n){return e=function(e,t,r,n){var a,i,o,s,u=0,l=0;return s=p(u=r>>>16,l=e>>>16),u=(65535&(l=((o=p(a=65535&r,i=65535&e))>>>16)+p(l,a)|0))+p(u,i)|0,e=(((p(t,r)+s|0)+p(e,n)|0)+(l>>>16)|0)+(u>>>16)|0,L=e,65535&o|u<<16}(e,t,r,n),e}function _e(e,t,r,n){return e=function(e,t,r,n){var a=0,i=0;return r=Ie((e^=a=t>>31)-a|0,i=((i=t>>31)^t)-((e>>>0<a>>>0)+i|0)|0,(r^=e=n>>31)-e|0,((a=n>>31)^n)-((r>>>0<e>>>0)+a|0)|0),L=((e=(t^=n)>>31)^L)-(((r^=t>>=31)>>>0<t>>>0)+e|0)|0,r-t|0}(e,t,r,n),e}function Pe(e,t,r,n){return Ie(e,t,r,n),t=0|("function"==typeof setTempRet0&&setTempRet0(s[1]),s[0]),e=0|D(),L=e,0|t}function Me(e){return e?31-S(e+-1^e)|0:32}var De=[null,function(e,t){return 0!=(0|E(0|(t|=0)))|0},function(e,t){return 0|b(0|(t|=0))},function(e){return 0|R()},function(e,t){return(t|=0)-48|0},x];return{memory:Object.create(Object.prototype,{grow:{},buffer:{get:function(){return r}}}),Base_StrBuf:function(){return 3280},Base_StrBufSize:function(){return 255},Dtr_DaysPerMonth:function(e,t,r){return 0|function(e,t,r){var n=0;n=3&t;e:if(r){if(n|(0|t)<2100)break e;n=!((t>>>0)%100)&0!=((t>>>0)%400|0)}else n||(n=!((0|t)%100)&0!=((0|t)%400|0));return o[1232+(((p(n,12)+e|0)-1|0)%48|0)|0]}(e|=0,t|=0,0!=(0|(r|=0)))},Dtr_FromNum:function(e,t,r,n,s){return e=+e,t|=0,n|=0,s|=0,r=p(r|=0,20)+3792|0,a[r>>1]=0,t=function(e,t,r,n,s){var m=0,f=0,S=0,v=0,F=0,y=0,C=0,A=0,E=0;e:if(!u[e>>1]){if(h[482]=t,g(+t),m=0|l(1),S=0|l(0),y=m,E=-65536&m)if(2146435072!=(2146435072&m)){if(!((0|E)>=1))return-2147467259}else i[966]=1;F=i[812],v=-1;t:{if(!((0|m)<(0|(f=C=i[813]))||(v=1,(0|m)>(0|f)))){if((0|F)==(0|(f=S)))break t;v=f>>>0<F>>>0?-1:1}if(f=-2147467259,1==(0|((y&C)>-1?v:0-v|0)))break e}t:{if(F=i[814],C=f=i[815],v=-1,!((0|m)<(0|f)||(v=1,(0|m)>(0|C)))){if((0|S)==(0|F))break t;v=S>>>0<F>>>0?-1:1}if(F=v,-1==(0|((f&y)>-1?F:0-F|0)))return-2147467259}t:{r:{if(!(s|!E))if(2146435072!=(2146435072&m)){if((0|E)<1)break r}else i[966]=1;ee(h[i[1216+(r<<2)>>2]>>3]),A=h[482];break t}Z(),re(t),S=y=i[965],c(0,0|(m=i[964])),c(1,0|S),A=+d(),i[792]==(0|m)&&i[793]==(0|S)||(f=i[965])>>>0<65536||(i[965]=-2147483648^f,g(+(A=h[482])),S=0|l(1),m=0|l(0)),y=S,F=S,S=i[1216+(r<<2)>>2],C=i[S+4>>2],f=i[S>>2],v=-1;r:{if(!((0|F)<(0|(S=C))||(v=1,(0|F)>(0|S)))){if((0|m)==(0|f)){h[482]=t;break r}v=m>>>0<f>>>0?-1:1}if(F=v,h[482]=t,-1==(0|((y&C)>-1?F:0-F|0)))break t}re(h[395])}if(a[e+18>>1]=r,m=me(),f=-2147467259,!z(0)){if(n){if((0|m)>2957003)break e;m=m+1462|0}else if(m+4346018>>>0>7304483)break e;if(a[e+14>>1]=1+((m+6|0)%7|0),!s|m)if(m){if((0|m)<=-1?(S=-4-((n=(-1^m)/1461|0)<<2)|0,f=1461+(p(n,1461)+m|0)|0):(S=(n=(m+-1|0)/1461|0)<<2,f=p(n,-1461)+m|0),!(s&&(0|S)<=199))if((0|(f=(((0|(n=S+-101|0))/100|0)-((0|n)/400|0)|0)+f|0))>=1462){m=3&(n=S+1900|0);t:if(s){if(m|(0|S)<200)break t;m=!((n>>>0)%100)&0!=((n>>>0)%400|0)}else m||(m=!((0|n)%100)&0!=((0|n)%400|0));S=S+4|0,f=(12==(0|p(m,12))?-1460:-1461)+f|0}else(0|f)>0||(S=S+-4|0,f=f+1461|0);m=3&(n=S+1900|0);t:if(s){if(m|(0|S)<200)break t;m=!((n>>>0)%100)&0!=((n>>>0)%400|0)}else m||(m=!((0|n)%100)&0!=((0|n)%400|0));for(m=y=p(m,12);s=m,m=m+1|0,(0|(f=(n=f)-o[s+1232|0]|0))>0;);s=((f=s)-((0|y)<(0|(s=s+-11|0))?y:s)>>>0)/12|0,a[e>>1]=1900+(s+S|0),a[e+2>>1]=(p(s,-12)+m|0)-y}else i[e>>2]=788331,n=30;else i[e>>2]=67436;if(i[e+4>>2]=n,h[482]=A,Se(),(n=i[965])>>>0>=65536&&(i[965]=-2147483648^n),ee(A),ae(h[400]),t=h[482],n=de(),a[e+8>>1]=n,ue(n<<16>>16),(n=i[965])>>>0>=65536&&(i[965]=-2147483648^n),ee(t),ae(h[401]),t=h[482],n=de(),a[e+10>>1]=n,ue(n<<16>>16),(n=i[965])>>>0>=65536&&(i[965]=-2147483648^n),ee(t),ae(h[401]),!r)return r=de(),a[e+16>>1]=0,a[e+12>>1]=r,0;t=h[482],n=de(),a[e+12>>1]=n,ue(n<<16>>16),(n=i[965])>>>0>=65536&&(i[965]=-2147483648^n),ee(t),ae(h[i[1312+(r<<2)>>2]>>3]),h[482]=$(h[482]),a[e+16>>1]=de(),f=0}}return f}(r,e,t,0!=(0|n),0!=(0|s)),i[966]=0,0|t},Dtr_Yr:function(e){return a[p(e|=0,20)+3792>>1]},Dtr_Mon:function(e){return a[p(e|=0,20)+3794>>1]},Dtr_DOM:function(e){return i[p(e|=0,20)+3796>>2]},Dtr_Hour:function(e){return a[p(e|=0,20)+3800>>1]},Dtr_Min:function(e){return a[p(e|=0,20)+3802>>1]},Dtr_Sec:function(e){return a[p(e|=0,20)+3804>>1]},Dtr_Wdy:function(e){return a[p(e|=0,20)+3806>>1]},Dtr_FracSec:function(e){return a[p(e|=0,20)+3808>>1]},Dtr_Rounding:function(e){return a[p(e|=0,20)+3810>>1]},Dtr_Write:function(e,t,r,n,o,s,u,l,c,d){e|=0,t|=0,r|=0,n|=0,o|=0,s|=0,u|=0,l|=0,c|=0,d=p(d|=0,20),a[d+3810>>1]=c,a[d+3808>>1]=l,a[d+3806>>1]=u,a[d+3804>>1]=s,a[d+3802>>1]=o,a[d+3800>>1]=n,i[d+3796>>2]=r,a[d+3794>>1]=t,a[d+3792>>1]=e},Dtr_ToNum:function(e,t,r){return e|=0,t|=0,r|=0,i[964]=0,i[965]=0,function(e,t,r){var n,o=0;w=n=w-16|0;e:{t:{r:{if((u[e+2>>1]+-32767&65535)>>>0>1){if(a[e+18>>1]>=1?(le(a[e+16>>1]),o=Re(h[i[1312+(a[e+18>>1]<<2)>>2]>>3]),le(a[e+12>>1]),ee(o)):le(a[e+12>>1]),o=Re(h[401]),le(a[e+10>>1]),ee(o),o=Re(h[401]),le(a[e+8>>1]),ee(o),o=Re(h[400]),!((0|G(e,t,r,n+12|0))<0)){if(e=i[n+12>>2],!t)break r;if(le(e+-1462|0),!((0|e)<1462)){if(!(t=-65536&(e=i[965])))break t;if(2146435072==(2146435072&e)){i[966]=1;break t}if((0|t)>=1)break t}}i[964]=0,i[965]=0}i[964]=0,i[965]=0,z(8);break e}ue(e)}ee(o)}w=n+16|0}(p(e,20)+3792|0,0!=(0|t),0!=(0|r)),+h[482]},Dtr_ToNumWithDuration:function(e,t,r,n,o){return e|=0,t|=0,r|=0,n|=0,o|=0,i[964]=0,i[965]=0,function(e,t,r,n,o){var s,l=0;w=s=w-16|0;e:{t:{r:{if((u[e+2>>1]+-32767&65535)>>>0>1){n:if(a[e+18>>1]>=1){if(le(a[e+16>>1]),oe(h[i[1312+(a[e+18>>1]<<2)>>2]>>3]),l=h[482],2==(0|o)){h[482]=n,ee(l);break n}le(a[e+12>>1]),ee(l)}else 2!=(0|o)?le(a[e+12>>1]):h[482]=n;if(oe(h[401]),l=h[482],1!=(0|o)?le(a[e+10>>1]):h[482]=n,ee(l),oe(h[401]),l=h[482],o?le(a[e+8>>1]):h[482]=n,ee(l),oe(h[400]),n=h[482],!((0|G(e,t,r,s+12|0))<0)){if(e=i[s+12>>2],!t)break r;if(le(e+-1462|0),!((0|e)<1462)){if(!(t=-65536&(e=i[965])))break t;if(2146435072==(2146435072&e)){i[966]=1;break t}if((0|t)>=1)break t}}i[964]=0,i[965]=0}i[964]=0,i[965]=0,z(8);break e}ue(e)}ee(n)}w=s+16|0}(p(e,20)+3792|0,0!=(0|t),0!=(0|r),+(0|o),n),+h[482]},Dtr_Days:function(){return i[963]},Dtr_ToDays:function(e,t,r){return t|=0,r|=0,0|G(p(e|=0,20)+3792|0,0!=(0|t),0!=(0|r),3852)},Dtr_ToTime:function(e,t,r){return function(e,t,r){h[482]=e,ee(h[i[1216+(r<<2)>>2]>>3]);e:{if(t>>>0<=1){if(t-1)break e}else ae(h[401]);ae(h[401])}ae(h[400]),Se()}(e=+e,t|=0,r|=0),+h[482]},Dtr_UtcToLocal:function(e,t,r,n,o,s,l,c){var d;return e|=0,t|=0,r|=0,n|=0,o|=0,s|=0,l|=0,c|=0,w=d=w-32|0,i[d+24>>2]=s,i[d+16>>2]=n,i[d+8>>2]=t,i[d+20>>2]=(0|o)>-1?p(o,20)+3792|0:0,i[d+12>>2]=(0|r)>-1?p(r,20)+3792|0:0,e=function(e,t,r,n){var o,s=0;return w=o=w-32|0,function(e,t,r){var n,o=0,s=0,l=0,c=0,d=0,g=0,m=0,h=0,f=0,S=0,v=0,F=0;if(w=n=w-96|0,i[n+64>>2]=a[t>>1],i[n+68>>2]=a[t+2>>1],i[n+72>>2]=i[t+4>>2],i[n+76>>2]=a[t+8>>1],i[n+80>>2]=a[t+10>>1],i[n+84>>2]=a[t+12>>1],i[n+92>>2]=a[t+14>>1]+-1,(o=a[t+18>>1])>>>0<=3){e:{t:switch(o-1|0){case 0:o=p(a[t+16>>1],100);break e;case 1:o=p(a[t+16>>1],10);break e;case 2:break t;default:break e}o=a[t+16>>1]}i[n+88>>2]=o}t=0;e:if(V(n- -64|0,n+40|0)){if(l=Oe(l=p(i[e>>2],60),l>>31,1e7,0),d=L,(s=i[e+4>>2])&&(c=i[e+12>>2])){if(i[n+64>>2]=a[s>>1],i[n+68>>2]=a[s+2>>1],i[n+72>>2]=i[s+4>>2],i[n+76>>2]=a[s+8>>1],i[n+80>>2]=a[s+10>>1],i[n+84>>2]=a[s+12>>1],i[n+92>>2]=a[s+14>>1]+-1,(o=a[s+18>>1])>>>0<=3){t:{r:switch(o-1|0){case 0:o=p(a[s+16>>1],100);break t;case 1:o=p(a[s+16>>1],10);break t;case 2:break r;default:break t}o=a[s+16>>1]}i[n+88>>2]=o}if(i[n+8>>2]=a[c>>1],i[n+12>>2]=a[c+2>>1],i[n+16>>2]=i[c+4>>2],i[n+20>>2]=a[c+8>>1],i[n+24>>2]=a[c+10>>1],i[n+28>>2]=a[c+12>>1],i[n+36>>2]=a[c+14>>1]+-1,(o=a[c+18>>1])>>>0<=3){t:{r:switch(o-1|0){case 0:o=p(a[c+16>>1],100);break t;case 1:o=p(a[c+16>>1],10);break t;case 2:break r;default:break t}o=a[c+16>>1]}i[n+32>>2]=o}if(c=s=i[n+44>>2],!j(n- -64|0,n+56|0,o=i[n+40>>2],s))break e;if(!j(n+8|0,n+48|0,o,c))break e;f=i[n+40>>2],m=i[n+44>>2],S=l,v=e+16|0,F=e+8|0,h=(c=d)+i[n+52>>2]|0,(g=(o=l)+i[n+48>>2]|0)>>>0<o>>>0&&(h=h+1|0),s=g,g=Oe(o=p(i[e+8>>2],60),o>>31,1e7,0),o=L+h|0,h=s=s+g|0,g=o=s>>>0<g>>>0?o+1|0:o,s=d+i[n+60>>2]|0,(d=l+i[n+56>>2]|0)>>>0<l>>>0&&(s=s+1|0),l=Oe(e=p(i[e+16>>2],60),e>>31,1e7,0),e=L+s|0,e=(d=l+d|0)>>>0<l>>>0?e+1|0:e,l=d,e=Oe(e=p(i[((e=(0|o)<(0|e)||(0|o)<=(0|e)&&!(h>>>0>=l>>>0)?((0|m)<(0|e)?1:(0|m)<=(0|e)?f>>>0>=l>>>0?0:1:0)&((0|m)>(0|g)?1:(0|m)>=(0|g)?f>>>0<h>>>0?0:1:0):((0|m)<(0|e)?1:(0|m)<=(0|e)?f>>>0>=l>>>0?0:1:0)|((0|m)>(0|g)?1:(0|m)>=(0|g)?f>>>0<h>>>0?0:1:0))?v:F)>>2],60),e>>31,1e7,0),o=L+c|0,d=o=(l=S+e|0)>>>0<e>>>0?o+1|0:o}e=i[n+40>>2],o=i[n+44>>2]-(d+(e>>>0<l>>>0)|0)|0,l=e-l|0,(0|(e=o))<0||(0|e)<=0&&!(l>>>0>=0)||(B(l,e,n- -64|0),a[r>>1]=i[n+64>>2],a[r+2>>1]=i[n+68>>2],i[r+4>>2]=i[n+72>>2],t=1,a[r+14>>1]=u[n+92>>1]+1,a[r+8>>1]=i[n+76>>2],a[r+10>>1]=i[n+80>>2],a[r+12>>1]=i[n+84>>2],e=i[n+88>>2],a[r+18>>1]=3,a[r+16>>1]=e)}return w=n+96|0,t}(n,e,o+8|0)&&(n=i[o+12>>2],i[e>>2]=i[o+8>>2],i[e+4>>2]=n,i[e+16>>2]=i[o+24>>2],n=i[o+20>>2],i[e+8>>2]=i[o+16>>2],i[e+12>>2]=n,n=e,(0|G(e,t,r,o+28|0))>=0?e=1+((i[o+28>>2]+6|0)%7|0)|0:(i[o+28>>2]=-1,e=6),a[n+14>>1]=e,s=1),w=o+32|0,s}(p(e,20)+3792|0,0!=(0|l),0!=(0|c),d+8|0),w=d+32|0,0|e},Mathpack_Zero:function(){return+h[396]},Mathpack_One:function(){return+h[395]},Mathpack_Pi:function(){return+h[391]},Mathpack_Div:function(e,t){return+se(e=+e,t=+t)},Mathpack_Mul:function(e,t){return+ie(e=+e,t=+t)},Mathpack_Sub:function(e,t){return+ne(e=+e,t=+t)},Mathpack_Add:function(e,t){return+te(e=+e,t=+t)},Mathpack_Power:function(e,t){return+function(e,t){var r=0,n=0,o=0,s=0;h[482]=t,g(+t),r=0|l(1),l(0),o=r,i[965]=2147483647&r,t=h[482];e:{if(g(+Ae(h[392])),65535==(0|(r=0|l(1)))&(n=0|l(0))>>>0<=4294967295|r>>>0<65535)h[482]=e,pe();else if(Se(),g(+Ae(t)),65535==(0|(r=0|l(1)))&(n=0|l(0))>>>0>4294967295|r>>>0>65535||-1==(0|(r=de()))){if(h[482]=e,g(+e),n=0|l(1),l(0),(0|(n=(r=n)>>>16<<16))>=1)ce(),ae(t),ve();else if(!((0|n)>-1)){if(ke(h[395],t),s=$(h[482]),h[482]=s,Se(),g(+Ae(s)),65535==(0|(n=0|l(1)))&l(0)>>>0>4294967295|n>>>0>65535)break e;if(2147483647==(0|(n=me()))|!(1&n))break e;h[482]=e,i[965]=2147483647&r,ce(),ae(t),ve(),(r=i[965])>>>0<65536||(i[965]=-2147483648^r)}}else h[482]=e,function(e){var t,r=0;if((t=a[1931])|e){if(!((0|t)<1)&&10==(0|de())){if(r=h[482],Se(),re(r),!u[1931])return void J(e);h[482]=r}for(r=1;1&e&&(r=be(r)),e>>>=1;)ae(h[482]);h[482]=r}else i[966]=4&i[966]?4:64}(r);if(o>>>16<<16>>16<=-1){if(1&(o=i[966]))return i[964]=0,i[965]=0,i[966]=-2&o,h[482];Te(h[395])}return h[482]}return i[966]=8,h[482]}(e=+e,t=+t)},Mathpack_Cond:function(e){var t,r;return g(+(e=+e)),t=0|l(1),l(0),(r=-65536&t)?2146435072==(2146435072&t)?(i[966]=1,0):0|((0|r)<1?-1:1):0},Mathpack_Cond2:function(e,t){t=+t;var r,n,a,i,o=0,s=0,u=0;g(+(e=+e)),o=0|l(1),r=0|l(0),n=o,i=o,g(+t),a=0|l(1),o=0|l(0),u=-1;e:{if(!((0|n)<(0|(s=a))||(u=1,(0|i)>(0|s)))){if(s=0,(0|o)==(0|r))break e;u=r>>>0<o>>>0?-1:1}o=u,s=(a&n)>-1?o:0-o|0}return 0|s},Mathpack_TakeMathError:function(){var e;return e=i[966],i[966]=0,0|e},Mathpack_Trunc:function(e){return+Y(e=+e)},Mathpack_Ceil:function(e){return e=+e,h[482]=e,function(){var e=0,t=0,r=0;e:{if(r=i[964],t=-65536&(e=i[965])){if(2146435072==(2146435072&e))return i[966]=1,void Se();if((0|t)>0)break e}return void Se()}Se(),(0|r)==i[964]&&i[965]==(0|e)||ee(1)}(),+h[482]},Mathpack_Floor:function(e){return e=+e,h[482]=e,Z(),+h[482]},Mathpack_Abs:function(e){var t=0;return g(+(e=+e)),t=0|l(1),t&=2147483647,c(0,0|l(0)),c(1,0|t),+d()},Mathpack_Neg:function(e){var t,r,n,a;return g(+(e=+e)),n=-2147483648^(t=0|l(1)),c(0,0|(r=0|l(0))),c(1,0|n),a=+d(),+(65535==(0|t)&r>>>0>4294967295|t>>>0>65535?a:e)},Mathpack_Float:function(e){return+((e|=0)>>>0)},Mathpack_SFloat:function(e){return+(0|(e|=0))},Mathpack_Fix:function(e){return 0|ge(e=+e)},Mathpack_LFix:function(e){return 0|he(e=+e)},Mathpack_SFix:function(e){return e=+e,h[482]=e,0|Q()},Mathpack_Round:function(e,t){return+function(e,t){var r,o=0,s=0,c=0,d=0;w=r=w+-64|0,i[r+56>>2]=0,a[r+46>>1]=0,a[r+48>>1]=0,h[482]=e,g(+e),o=0|l(1),l(0);e:if(s=-65536&o)if(2146435072!=(2146435072&o)){(0|s)>0||(d=32768,o>>>0<65536||(i[965]=-2147483648^o,e=h[482])),ye(e,r+56|0,r+16|0,15),u[r+58>>1]||(a[r+56>>1]=1),h[482]=t,o=(0|(o=Q()))<0?100:o;t:{if(c=-65536&(s=i[965]))if(2146435072!=(2146435072&s)){if(!((0|c)>0)){if((o=i[965])>>>0>=65536&&(i[965]=-2147483648^o),(0|(o=Q()))<=-1)break t;o=0-o|0}}else i[966]=1;(0|(c=o+(s=a[r+56>>1])|0))<(0|(o=a[r+58>>1]))&&(i[r+12>>2]=o,i[r+8>>2]=s,X(r+16|0,r+8|0,r+12|0,c),o=i[r+12>>2],a[r+58>>1]=o,s=i[r+8>>2],a[r+56>>1]=s),n[r+46|0]=o,a[r+48>>1]=s+16384&32767|d,Fe(3276,3856,r+16|0),e=h[482];break e}e=h[396]}else i[966]=1;return w=r- -64|0,e}(e=+e,t=+t)},Mathpack_RoundUp:function(e,t){return+function(e,t){var r=0,n=0,a=0,o=0,s=0;if(g(+e),r=0|l(1),l(0),(n=-65536&r)&&(2146435072!=(2146435072&r)?s=(0|n)<1?-1:1:i[966]=1),a=W(e,t),h[482]=e,h[482]=$(e),re(a),(r=i[965])>>>0>=65536){if(2146435072==(2146435072&r))return i[966]=1,a;if(r=(0|(r=ge(t)<<16))<0?309:r>>16,g(+t),n=0|l(1),l(0),(o=-65536&n)&&(2146435072!=(2146435072&n)?r=(0|o)<1?0-r|0:r:i[966]=1),(0|r)<=-309)return z(8),0;J(0-r|0),(0|s)>-1||(r=i[965])>>>0<65536||(i[965]=-2147483648^r),ee(a),a=h[482]}return a}(e=+e,t=+t)},Mathpack_RoundDown:function(e,t){var r;return g(+(e=W(e=+e,t=+t))),r=0|l(1),l(0),2146435072==(2146435072&r)&&(i[966]=1,e=-1),+e},Mathpack_TenTo:function(e){return J(e|=0),+h[482]},Mathpack_Compare:function(e,t){return+(0|function(e,t){var r,n=0,a=0,o=0,s=0,u=0;w=r=w-16|0,h[r+8>>3]=e,h[r>>3]=t,g(+e),n=0|l(1),a=0|l(0),o=n,g(+t),u=n=0|l(1);e:{if((0|a)!=(0|(s=0|l(0)))||(0|o)!=(0|n)){if((u+2097152&2146435072)-(2146435072&o)>>>0<=5242879&&(e=$(e),h[r+8>>3]=e,g(+e),n=0|l(1),l(0),o=n,e=$(t),h[r>>3]=e,g(+e),n=0|l(1),l(0),u=n),n=1,(0|(o=i[(s=(a=(u&o)>-1)?r+8|0:r)+4>>2]))>(0|(u=i[(a=a?r:r+8|0)+4>>2])))break e;if((0|o)<(0|u)){n=-1;break e}if((s=i[s>>2])>>>0>(a=i[a>>2])>>>0)break e;if(n=-1,s>>>0<a>>>0)break e}n=0}return w=r+16|0,n}(e=+e,t=+t))},Mathpack_GetExp32:function(e){var t;return g(+(e=+e)),t=0|l(1),l(0),2146435072&t},Mathpack_Equal:function(e,t){t=+t;var r,n,a=0;return g(+(e=+e)),a=0|l(1),r=0|l(0),g(+t),n=0|l(1),0|((0|r)==(0|l(0))?(0|a)==(0|n):0)},Mathpack_ViewRound:function(e){var t;return g(+(e=+e)),t=0|l(1),l(0),2146435072==(2146435072&t)?(i[966]=1,-1):+$(e)},Mathpack_Sqrt:function(e){return e=+e,h[482]=e,pe(),+h[482]},Mathpack_Exp:function(e){return e=+e,h[482]=e,ve(),+h[482]},Mathpack_Ln:function(e){return e=+e,h[482]=e,ce(),+h[482]},Mathpack_Log:function(e){return e=+e,h[482]=e,function(){var e,t;e=+T(+h[482]),h[482]=e,g(+e),t=0|l(1),l(0),2146435072==(2146435072&t)&&(i[966]=8)}(),+h[482]},Mathpack_Sin:function(e){return e=+e,h[482]=e,function(){var e=0,t=0;g(+(t=h[482])),e=0|l(1),l(0),1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+N(+t),h[482]=t,g(+t),e=0|l(1),l(0),2146435072!=(2146435072&e))||(i[966]=8)}(),+h[482]},Mathpack_Cos:function(e){return e=+e,h[482]=e,function(){var e=0,t=0;g(+(t=h[482])),e=0|l(1),l(0),1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+I(+t),h[482]=t,g(+t),e=0|l(1),l(0),2146435072!=(2146435072&e))||(i[966]=8)}(),+h[482]},Mathpack_Tan:function(e){return e=+e,h[482]=e,function(){var e=0,t=0,r=0;r=8,g(+(t=h[482])),e=0|l(1),l(0),1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+O(+t),h[482]=t,r=4,g(+t),e=0|l(1),l(0),2146435072!=(2146435072&e))||(i[966]=r)}(),+h[482]},Mathpack_Asin:function(e){return+U(e=+e,0)},Mathpack_Acos:function(e){return+U(e=+e,1)},Mathpack_Atan:function(e){return e=+e,h[482]=e,fe(),+h[482]},Mathpack_Atan2:function(e,t){return+function(e,t){var r=0,n=0,a=0,o=0,s=0;h[482]=e;e:{if(g(+e),r=0|l(1),l(0),r>>>0>=65536){if(2146435072!=(2146435072&r))break e;i[966]=1}h[482]=t;t:{if(g(+t),r=0|l(1),l(0),n=-65536&r){if(2146435072!=(2146435072&r))break t;i[966]=1}return z(4),0}return le((0|n)<1?-1:1),ae(h[391]),oe(h[393]),h[482]}e:if((0|r)<=-1){g(+t),r=0|l(1),l(0);t:{if(n=-65536&r)if(2146435072!=(2146435072&r)){if((0|n)<1)break t}else i[966]=1;a=h[391];break e}g(+(a=h[391])),o=-2147483648^(r=0|l(1)),c(0,0|(n=0|l(0))),c(1,0|o),s=+d(),a=65535==(0|r)&n>>>0>4294967295|r>>>0>65535?s:a}else a=h[396];return ke(t,e),fe(),ee(a),h[482]}(e=+e,t=+t)},Mathpack_Mod:function(e,t){return+function(e,t){var r,n=0,a=0,o=0,s=0,m=0,f=0,S=0,v=0,F=0,y=0,C=0,A=0,E=0,b=0,R=0,T=0,k=0,N=0,I=0,O=0,_=0,P=0,M=0,D=0,x=0,K=0,W=0,U=0;w=r=w+-64|0,h[482]=e,g(+e),n=0|l(1),l(0),(b=-65536&n)&&(2146435072!=(2146435072&n)?W=(0|b)<1?-1:1:i[966]=1),i[965]=2147483647&n,g(+t),n=0|l(1),b=0|l(0),o=n;e:{t:{if(O=-65536&n){if(2146435072!=(2146435072&n))break t;i[966]=1}z(4),e=0;break e}m=n=2147483647&o,c(0,0|b),c(1,0|n),e=+d(),g(+(t=h[482])),n=0|l(1),a=0|l(0),C=n;t:{r:{f=n,M=m;n:if(!((0|n)<(0|m))){a:{if((0|f)<=(0|M)){if((0|(n=a))==(0|(f=b)))break a;if(n>>>0<f>>>0)break n}if(Ee(_=Y(Re(e)),h[390]),(f=-65536&(n=i[965]))&&(2146435072!=(2146435072&n)?s=(0|f)<1:i[966]=1),i[966]){z(0);break r}if(!s)break r;if(n=2147483647&o,c(0,-134217728&b),c(1,0|n),Ee(e,D=+d()),(n=i[965])|i[964]&&!(2146435072&n))break r;U=be(_),h[482]=ie(_,D),(n=i[965])>>>0>=65536&&(i[965]=-2147483648^n),ee(t),re(U);break n}i[964]=0,i[965]=0}if(n=i[964],o=i[792],v=s=i[965],a=-1,!((0|s)<(0|(m=f=i[793]))||(a=1,(0|v)>(0|m)))){if((0|n)==(0|o))break t;a=n>>>0<o>>>0?-1:1}if(-1!=(0|((s&f)>-1?a:0-a|0)))break t;ee(e);break t}ke(t,e),i[965]=2147483647&i[965];r:{if(n=i[964],f=i[816],T=y=i[965],F=v=i[817],s=-1,!((0|y)<(0|v)||(s=1,(0|T)>(0|F)))){if((0|n)==(0|f))break r;s=n>>>0<f>>>0?-1:1}if(-1==(0|((v&y)>-1?s:0-s|0))){if(f=0,s=0,y=n=b,Oe(0-n&n,0-((0<n>>>0)+(o=v=1048575&o|1048576)|0)&o,-1261761911,66559345),v=31&(n=T=u[1088+(L>>>26<<1)>>1]),32<=(63&n)>>>0?(n=0,v=o>>>v):(n=o>>>v,v=((1<<v)-1&o)<<32-v|y>>>v),y=n,o=a,n=1048575&C|1048576,(0|(k=T-(A=(C>>>20&2047)-(x=m>>>20)|0)|0))>=1&&(F=31&(a=64-k|0),C=o,32<=(63&a)>>>0?(a=0,F=-1>>>F):(a=-1>>>F,F=(1<<F)-1<<32-F|-1>>>F),o=(R=o)-(F=N=F&o)|0,n=(m=n)-((P=n&a)+(C>>>0<F>>>0)|0)|0),C=r,R=r,m=a=(m=(m=i[1056+((a=v)<<1&28)>>2])-p(m,p(a,m)+-1&240)&255)|0-p(m,p(a,m)+-1&65280)&65280,F=Oe(v,y,a,0),S=L+-1|0,(F=F+-1|0)>>>0<4294967295&&(S=S+1|0),m=Oe(-65536&F,S,a=0-a|0,a>>31)|m,S=Oe(m,F=L,v,y),a=L+-1|0,I=(a=Oe(0,S+-1>>>0<4294967295?a+1|0:a,m,F))-m|0,i[R+56>>2]=I,F=L-((a>>>0<m>>>0)+F|0)|0,i[C+60>>2]=F,i[r+48>>2]=v,i[r+52>>2]=y,Ce(r+56|0,r+48|0,r+8|0,r+40|0),S=i[r+12>>2],(m=i[r+8>>2]+1|0)>>>0<1&&(S=S+1|0),i[r+8>>2]=m,i[r+12>>2]=S,m=Pe(0-(a=v)|0,0-((0<a>>>0)+y|0)|0,a,y),C=L,S=31&(a=(0|(A=(A-T|0)- -64|0))%64|0),32<=(63&a)>>>0?(a=1<<S,R=0):(a=(1<<S)-1&1>>>32-S,R=1<<S),S=a,i[r+32>>2]=o,i[r+36>>2]=n,n|o)for(;i[r+56>>2]=o,i[r+60>>2]=n,i[r+48>>2]=m,i[r+52>>2]=C,Ce(r+56|0,r+48|0,r+32|0,r+40|0),o=i[r+32>>2],n=i[r+36>>2],a=s+(E=i[r+44>>2])|0,(s=f+(K=i[r+40>>2])|0)>>>0<f>>>0&&(a=a+1|0),f=s,s=a,(0|E)==(0|a)&f>>>0<K>>>0|a>>>0<E>>>0&&((o=o+1|0)>>>0<1&&(n=n+1|0),i[r+32>>2]=o,i[r+36>>2]=n),o|n;);if(i[r+56>>2]=Pe(f,s,v,y),i[r+60>>2]=L,i[r+48>>2]=R,i[r+52>>2]=S,Ce(r+56|0,r+48|0,r+16|0,r+40|0),o=i[r+44>>2],a=i[r+40>>2],i[r+56>>2]=a,i[r+60>>2]=o,i[r+48>>2]=I,i[r+52>>2]=F,Ce(r+56|0,r+48|0,r+24|0,r+40|0),n=i[r+44>>2],i[r+56>>2]=i[r+40>>2],i[r+60>>2]=n,i[r+48>>2]=v,i[r+52>>2]=y,f=0,s=0,Ce(r+56|0,r+48|0,r+32|0,r+40|0),E=i[r+36>>2],S=i[r+20>>2],(a=(o=0!=(0|a)|0!=(0|o))+i[r+16>>2]|0)>>>0<o>>>0&&(S=S+1|0),R=a,o=a+i[r+32>>2]|0,a=S+E|0,i[r>>2]=o,i[r+4>>2]=o>>>0<R>>>0?a+1|0:a,i[r+32>>2]=m,i[r+36>>2]=C,m|C)for(o=m,n=C;i[r+56>>2]=o,i[r+60>>2]=n,i[r+48>>2]=m,i[r+52>>2]=C,Ce(r+56|0,r+48|0,r+32|0,r+40|0),o=i[r+32>>2],n=i[r+36>>2],a=s+(S=i[r+44>>2])|0,(s=f+(E=i[r+40>>2])|0)>>>0<f>>>0&&(a=a+1|0),f=s,s=a,(0|S)==(0|a)&f>>>0<E>>>0|a>>>0<S>>>0&&((o=o+1|0)>>>0<1&&(n=n+1|0),i[r+32>>2]=o,i[r+36>>2]=n),o|n;);if((0|A)>=64)for(o=Pe(f,s,v,y),n=L,s=A>>>6;1&s&&(a=i[r+4>>2],i[r+56>>2]=i[r>>2],i[r+60>>2]=a,i[r+48>>2]=o,i[r+52>>2]=n,Ce(r+56|0,r+48|0,r+16|0,r+40|0),S=a=i[r+44>>2],A=i[r+40>>2],i[r+56>>2]=A,i[r+60>>2]=a,i[r+48>>2]=I,i[r+52>>2]=F,Ce(r+56|0,r+48|0,r+24|0,r+40|0),a=i[r+44>>2],i[r+56>>2]=i[r+40>>2],i[r+60>>2]=a,i[r+48>>2]=v,i[r+52>>2]=y,Ce(r+56|0,r+48|0,r+32|0,r+40|0),E=i[r+36>>2],a=i[r+20>>2],(A=(S=0!=(0|A)|0!=(0|S))+i[r+16>>2]|0)>>>0<S>>>0&&(a=a+1|0),S=A+i[r+32>>2]|0,a=a+E|0,i[r>>2]=S,i[r+4>>2]=S>>>0<A>>>0?a+1|0:a),i[r+56>>2]=o,i[r+60>>2]=n,i[r+48>>2]=o,i[r+52>>2]=n,Ce(r+56|0,r+48|0,r+16|0,r+40|0),o=i[r+44>>2],a=i[r+40>>2],i[r+56>>2]=a,i[r+60>>2]=o,i[r+48>>2]=I,i[r+52>>2]=F,Ce(r+56|0,r+48|0,r+24|0,r+40|0),n=i[r+44>>2],i[r+56>>2]=i[r+40>>2],i[r+60>>2]=n,i[r+48>>2]=v,i[r+52>>2]=y,Ce(r+56|0,r+48|0,r+32|0,r+40|0),f=i[r+36>>2],n=i[r+20>>2],(a=(o=0!=(0|a)|0!=(0|o))+i[r+16>>2]|0)>>>0<o>>>0&&(n=n+1|0),n=n+f|0,n=(o=a+i[r+32>>2]|0)>>>0<a>>>0?n+1|0:n,s>>>=1;);if(n=i[r+8>>2],o=i[r+12>>2],a=i[r+4>>2],i[r+56>>2]=i[r>>2],i[r+60>>2]=a,i[r+48>>2]=n,i[r+52>>2]=o,Ce(r+56|0,r+48|0,r,r+40|0),f=i[r+40>>2],s=i[r+44>>2],n=i[r+4>>2],o=i[r>>2],i[r+32>>2]=o,i[r+36>>2]=n,n|o)for(;i[r+56>>2]=o,i[r+60>>2]=n,i[r+48>>2]=m,i[r+52>>2]=C,Ce(r+56|0,r+48|0,r+32|0,r+40|0),o=i[r+32>>2],n=i[r+36>>2],a=s+(F=i[r+44>>2])|0,(s=f+(S=i[r+40>>2])|0)>>>0<f>>>0&&(a=a+1|0),f=s,s=a,(0|F)==(0|a)&f>>>0<S>>>0|a>>>0<F>>>0&&(a=n,(n=o+1|0)>>>0<1&&(a=a+1|0),o=n,i[r+32>>2]=n,n=a,i[r+36>>2]=n),o|n;);if(o=Pe(f,s,v,y),n=a=L,i[r>>2]=o,i[r+4>>2]=n,s=(T+x|0)-52|0,N|P&&(m=o,v=31&(o=k),32<=(63&o)>>>0?(a=m<<v,n=0):(a=(1<<v)-1&m>>>32-v|n<<v,n=m<<v),a=a+P|0,o=n=n+N|0,i[r>>2]=n,n=n>>>0<N>>>0?a+1|0:a,i[r+4>>2]=n,s=s-k|0),!(n|o)){i[964]=0,i[965]=0;break t}if((0|n)>=1?(ue(n),n=i[964],f=i[965],ue(o),a=f+33554432|0,a=2146435072&(n>>>0<0?a+1|0:a)|-2146435073&f,c(0,n|(o=0)),c(1,0|a),ee(+d())):ue(o),o=n=i[965],a=i[964],(0|(n=(n>>>20&2047)+s|0))<=1023){i[964]=0,i[965]=0,i[966]=2;break t}i[964]=a,i[965]=-2146435073&o|(n+1025&2047)<<20;break t}}z(2),e=0;break e}(((0|O)<1?-2147483648:1)^W)>-1||((n=i[965])>>>0>=65536&&(i[965]=-2147483648^n),ee(e),i[965]!=(0|M)|(0|b)!=i[964]||(i[964]=0,i[965]=0)),(0|O)>=1?s=i[965]:(s=i[965])>>>0<65536||(s^=-2147483648,i[965]=s),!(i[964]|s)|2146435072&s||(i[966]=2),e=h[482]}return w=r- -64|0,e}(e=+e,t=+t)},Mathpack_FormatGeneral:function(e,t){t|=0;var r,n,o,s=0,c=0;return g(+(e=+e)),r=0|l(1),o=0|l(0),2146435072==(2146435072&r)?(i[966]=1,-1):(h[482]=e,s=3280,(n=-65536&(c=r))&&(2146435072!=(2146435072&c)?(s=3280,(0|n)>0||(c>>>0>=65536&&(i[965]=-2147483648^c),s=3280,!o&-2147483648==(0|r)||(a[1640]=45,s=3282))):(i[966]=1,s=3280)),c=s,t=(0|t)<255?t:255,t=function(e,t,r,n){var o;w=o=w-16|0,e=0|De[i[i[e>>2]+8>>2]](e),i[o+8>>2]=0;e:if(r<<1>>>0<=33){if((0|r)<1)break e;a[t>>1]=0}else ye(h[482],o+8|0,t,15),t=function(e,t,r,n,o,s){var l,c,d,g=0,m=0,h=0,f=0,S=0;w=c=w-16|0,l=(t<<1)+e|0,d=c+12|0;t:{r:{n:{a:if(!(h=(0|r)<5&(m=o?n:1)+3>>>0<8)){i:if(!((0|m)>(0|r))){if((0|(n=r+m|0))>=3){if((0|r)<5|(0|m)>-4)break a;if((n+-2|0)<(0|o))break i;break a}if((0|r)<5)break a}if(f=1,n=1,(0|r)<7)break n;n=r-(m+97>>>0>196?6:5)|0;break n}(1!=(0|r)||(n=0,m))&&(n=r-((0|m)<(0|r)?(0|m)<1?2-m|0:1:0)|0)}n:{if((0|n)<(0|o)){g=1,o=0;a:if(!((0|t)<1)){i:{o:{if(!n){if(u[e>>1]>52)break o;break a}if((0|n)<1|(0|n)>=(0|t))break a;if(u[(n<<1)+e>>1]<=52)break i;for(;;){if(S=u[(g=((o=n+-1|0)<<1)+e|0)>>1]+1|0,a[g>>1]=S,58!=(65535&S))break i;if(n=o,!o)break}}a[e>>1]=49,o=1,g=m+1|0;break a}for(;(0|(o=n))>=2&&48==u[((n=o+-1|0)<<1)+e>>1];);g=m}if((-1^h)&(0|g)>(0|r)|f)break n;break r}if(g=m,!f)break r}if(i[d>>2]=32768,r=e+2|0,(0|o)<2||(n=r+(o<<1)|0)>>>0>=l>>>0?n=r:(o=o+-1|0,i[d>>2]=32768|o,e=e+4|0,(t<<1)-4>>1>>>0<o>>>0&&A(),K(e,r,o<<1),a[r>>1]=s),n>>>0<l>>>0&&(a[n>>1]=69,n=n+2|0),n>>>0>=l>>>0?o=n:(o=n+2|0,(0|g)<=0?(a[n>>1]=45,g=1-g|0):(a[n>>1]=43,g=g+-1|0)),(0|g)<100|o>>>0>=l>>>0||(e=(g>>>0)/100|0,a[o>>1]=e+48,g=g-p(e,100)|0,o=o+2|0),o>>>0<l>>>0&&(a[o>>1]=48+((0|g)/10|0),o=o+2|0),o>>>0>=l>>>0)break t;a[o>>1]=48+((0|g)%10|0),o=o+2|0;break t}if((0|o)<0|(0|o)>(0|g))if(r=o-g|0,i[d>>2]=r,(0|g)>=1){if(!((r=(n=((h=(r=(m=(0|g)>(0|t)?t:g)<<1)+e|0)+(o<<1)|0)-r|0)-2|0)>>>0<e>>>0|n>>>0>=l>>>0))for(;a[n>>1]=u[r>>1],n=n+-2|0,(r=r+-2|0)>>>0>=h>>>0;);(0|g)<(0|t)&&(a[h>>1]=s),o=h+(((0|(e=l-h>>1))>(0|(t=o-m|0))?t+1|0:e)<<1)|0}else{if(!((n=2+((e-(g<<1)|0)+(o<<1)|0)|0)>>>0>=l>>>0||(o=((o<<1)+e|0)-2|0)>>>0<e>>>0))for(;a[n>>1]=u[o>>1],n=n+-2|0,(o=o+-2|0)>>>0>=e>>>0;);if((0|t)>=1&&(a[e>>1]=48,e=e+2|0),e>>>0<l>>>0&&(a[e>>1]=s,e=e+2|0),n=l-e>>1,g&&(t=(0|n)<(0|(t=0-g|0))?n:t))for(o=0;a[(o<<1)+e>>1]=48,(0|t)!=(0|(o=o+1|0)););o=(((0|n)<(0|r)?n:r)<<1)+e|0}else{if(r=(n=(0|g)>(0|t)?t:g)-o|0)for(t=(o<<1)+e|0,o=0;a[t+(o<<1)>>1]=48,(0|r)!=(0|(o=o+1|0)););o=(n<<1)+e|0}}return w=c+16|0,o}(t,r,n,a[o+8>>1],a[o+10>>1],e);return w=o+16|0,t}(i[256],c,3790-c>>1,(0|t)>0?t:0),i[964]=0,i[965]=0,t-3280>>1)},Mathpack_FormatGetExponent:function(){return i[968]},Mathpack_FormatGetSign:function(){return i[969]},Mathpack_FormatFixed:function(e,t,r){t|=0,r|=0;var n,o=0,s=0;return w=n=w+-64|0,g(+(e=+e)),o=0|l(1),l(0),2146435072!=(2146435072&o)?(i[n+56>>2]=0,a[n+46>>1]=0,a[n+48>>1]=0,ye(e,n+56|0,n+16|0,(o=t+r|0)>>>0<15?o:15),s=a[n+56>>1],o=a[n+58>>1],i[n+8>>2]=o,t=t+s|0,i[n+12>>2]=t,(0|(t=t+r|0))<(0|o)&&(X(n+16|0,n+12|0,n+8|0,t),o=i[n+8>>2]),o?((0|(r=r+(t=i[n+12>>2])|0))<(0|o)&&(i[n+8>>2]=r,o=r),(0|o)>-1||(i[966]=1)):(o=0,i[n+12>>2]=0,t=0),i[968]=t,i[969]=u[n+48>>1]>>>15^1,r=o,o>>>0>=256&&(A(),r=i[n+8>>2]),K(3280,n+16|0,o<<1)):(i[966]=1,r=-1),w=n- -64|0,0|r},Mathpack_FormatScientific:function(e,t,r){t|=0,r|=0;var n,o=0,s=0,c=0;if(w=n=w+-64|0,g(+(e=+e)),s=0|l(1),l(0),2146435072!=(2146435072&s)){if(i[n+56>>2]=0,a[n+46>>1]=0,a[n+48>>1]=0,ye(e,n+56|0,n+16|0,15),c=a[n+56>>1],i[n+12>>2]=c,s=a[n+58>>1],i[n+8>>2]=s,(0|(o=t))>=2&&(o=(0|c)%(0|t)|0,o=((0|c)<1?t:o?0:t)+o|0),!((0|(o=r+o|0))>=(0|s))){for(X(n+16|0,n+12|0,n+8|0,o),o=(0|o)<(0|(s=i[n+8>>2]))?o:s;s=o,(0|o)>=1&&48==u[(n+16|0)+((o=s+-1|0)<<1)>>1];);i[n+8>>2]=s,(0|t)<2||(0|(o=i[n+12>>2]))!=(0|c)&&((((c=r)+(r=(0|o)%(0|t)|0)|0)+((0|o)<1?t:r?0:t)|0)>=(0|s)||(A(),s=i[n+8>>2]))}(0|s)<=-1&&(i[966]=1),i[968]=i[n+12>>2],i[969]=u[n+48>>1]>>>15^1,(o=s)>>>0>=256&&(A(),o=i[n+8>>2]),K(3280,n+16|0,s<<1)}else i[966]=1,o=-1;return w=n- -64|0,0|o},Mathpack_Pack:function(e,t,r){var o;return e|=0,t|=0,r|=0,w=o=w-48|0,n[o+39|0]=0,K(o+8|0,3280,(r=(0|r)<15?r:15)<<1),a[o+40>>1]=t+16384&32767|!e<<15,n[o+38|0]=r,i[o>>2]=0,i[o+4>>2]=0,Fe(i[256],o,o+8|0)&&(i[966]=1),w=o+48|0,+h[o>>3]},_start:x,__errno_location:function(){return 3888},setThrew:function(e,t){e|=0,t|=0,i[970]||(i[971]=t,i[970]=e)},stackSave:function(){return 0|w},stackAlloc:function(e){return w=e=w-(e|=0)&-16,0|e},stackRestore:function(e){w=e|=0},__growWasmMemory:function(e){return 0|A()}}}({Math:n.Math,Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,NaN:NaN,Infinity:1/0},{abort:function(){throw new Error("abort")},Base_LocaleIsNumeral:a.Base_LocaleIsNumeral,Base_LocaleGetOrdinal:a.Base_LocaleGetOrdinal,Base_LocaleDecimalSeparator:a.Base_LocaleDecimalSeparator,Math_log10:a.Math_log10,Math_log:a.Math_log,Math_sqrt:a.Math_sqrt,Math_sin:a.Math_sin,Math_cos:a.Math_cos,Math_tan:a.Math_tan,Math_atan:a.Math_atan,Math_exp:a.Math_exp,proc_exit:i.proc_exit,getTempRet0:a.getTempRet0},h),S=f.memory;t.memory=S;var v=f.Base_StrBuf;t.Base_StrBuf=v;var F=f.Base_StrBufSize;t.Base_StrBufSize=F;var y=f.Dtr_DaysPerMonth;t.Dtr_DaysPerMonth=y;var C=f.Dtr_FromNum;t.Dtr_FromNum=C;var A=f.Dtr_Yr;t.Dtr_Yr=A;var E=f.Dtr_Mon;t.Dtr_Mon=E;var b=f.Dtr_DOM;t.Dtr_DOM=b;var R=f.Dtr_Hour;t.Dtr_Hour=R;var T=f.Dtr_Min;t.Dtr_Min=T;var k=f.Dtr_Sec;t.Dtr_Sec=k;var N=f.Dtr_Wdy;t.Dtr_Wdy=N;var I=f.Dtr_FracSec;t.Dtr_FracSec=I;var O=f.Dtr_Rounding;t.Dtr_Rounding=O;var _=f.Dtr_Write;t.Dtr_Write=_;var P=f.Dtr_ToNum;t.Dtr_ToNum=P;var M=f.Dtr_ToNumWithDuration;t.Dtr_ToNumWithDuration=M;var D=f.Dtr_Days;t.Dtr_Days=D;var w=f.Dtr_ToDays;t.Dtr_ToDays=w;var L=f.Dtr_ToTime;t.Dtr_ToTime=L;var x=f.Dtr_UtcToLocal;t.Dtr_UtcToLocal=x;var K=f.Mathpack_Zero;t.Mathpack_Zero=K;var W=f.Mathpack_One;t.Mathpack_One=W;var U=f.Mathpack_Pi;t.Mathpack_Pi=U;var G=f.Mathpack_Div;t.Mathpack_Div=G;var B=f.Mathpack_Mul;t.Mathpack_Mul=B;var V=f.Mathpack_Sub;t.Mathpack_Sub=V;var j=f.Mathpack_Add;t.Mathpack_Add=j;var H=f.Mathpack_Power;t.Mathpack_Power=H;var q=f.Mathpack_Cond;t.Mathpack_Cond=q;var $=f.Mathpack_Cond2;t.Mathpack_Cond2=$;var z=f.Mathpack_TakeMathError;t.Mathpack_TakeMathError=z;var Q=f.Mathpack_Trunc;t.Mathpack_Trunc=Q;var Y=f.Mathpack_Ceil;t.Mathpack_Ceil=Y;var J=f.Mathpack_Floor;t.Mathpack_Floor=J;var X=f.Mathpack_Abs;t.Mathpack_Abs=X;var Z=f.Mathpack_Neg;t.Mathpack_Neg=Z;var ee=f.Mathpack_Float;t.Mathpack_Float=ee;var te=f.Mathpack_SFloat;t.Mathpack_SFloat=te;var re=f.Mathpack_Fix;t.Mathpack_Fix=re;var ne=f.Mathpack_LFix;t.Mathpack_LFix=ne;var ae=f.Mathpack_SFix;t.Mathpack_SFix=ae;var ie=f.Mathpack_Round;t.Mathpack_Round=ie;var oe=f.Mathpack_RoundUp;t.Mathpack_RoundUp=oe;var se=f.Mathpack_RoundDown;t.Mathpack_RoundDown=se;var ue=f.Mathpack_TenTo;t.Mathpack_TenTo=ue;var le=f.Mathpack_Compare;t.Mathpack_Compare=le;var ce=f.Mathpack_GetExp32;t.Mathpack_GetExp32=ce;var de=f.Mathpack_Equal;t.Mathpack_Equal=de;var ge=f.Mathpack_ViewRound;t.Mathpack_ViewRound=ge;var me=f.Mathpack_Sqrt;t.Mathpack_Sqrt=me;var he=f.Mathpack_Exp;t.Mathpack_Exp=he;var pe=f.Mathpack_Ln;t.Mathpack_Ln=pe;var fe=f.Mathpack_Log;t.Mathpack_Log=fe;var Se=f.Mathpack_Sin;t.Mathpack_Sin=Se;var ve=f.Mathpack_Cos;t.Mathpack_Cos=ve;var Fe=f.Mathpack_Tan;t.Mathpack_Tan=Fe;var ye=f.Mathpack_Asin;t.Mathpack_Asin=ye;var Ce=f.Mathpack_Acos;t.Mathpack_Acos=Ce;var Ae=f.Mathpack_Atan;t.Mathpack_Atan=Ae;var Ee=f.Mathpack_Atan2;t.Mathpack_Atan2=Ee;var be=f.Mathpack_Mod;t.Mathpack_Mod=be;var Re=f.Mathpack_FormatGeneral;t.Mathpack_FormatGeneral=Re;var Te=f.Mathpack_FormatGetExponent;t.Mathpack_FormatGetExponent=Te;var ke=f.Mathpack_FormatGetSign;t.Mathpack_FormatGetSign=ke;var Ne=f.Mathpack_FormatFixed;t.Mathpack_FormatFixed=Ne;var Ie=f.Mathpack_FormatScientific;t.Mathpack_FormatScientific=Ie;var Oe=f.Mathpack_Pack;t.Mathpack_Pack=Oe;var _e=f._start;t._start=_e;var Pe=f.__errno_location;t.__errno_location=Pe;var Me=f.setThrew;t.setThrew=Me;var De=f.stackSave;t.stackSave=De;var we=f.stackAlloc;t.stackAlloc=we;var Le=f.stackRestore;t.stackRestore=Le;var xe=f.__growWasmMemory;t.__growWasmMemory=xe},80863:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Base_LocaleDecimalSeparator",{enumerable:!0,get:function(){return n.Base_LocaleDecimalSeparator}}),Object.defineProperty(t,"Base_LocaleGetOrdinal",{enumerable:!0,get:function(){return n.Base_LocaleGetOrdinal}}),Object.defineProperty(t,"Base_LocaleIsNumeral",{enumerable:!0,get:function(){return n.Base_LocaleIsNumeral}}),t.Math_tan=t.Math_sqrt=t.Math_sin=t.Math_log10=t.Math_log=t.Math_exp=t.Math_cos=t.Math_atan=void 0,t.getTempRet0=function(){return g},t.setTempRet0=function(e){g=e};var n=r(18969);const a=Math.sqrt;t.Math_sqrt=a;const i=Math.log10||function(e){return Math.log(e)*Math.LOG10E};t.Math_log10=i;const o=Math.log;t.Math_log=o;const s=Math.exp;t.Math_exp=s;const u=Math.sin;t.Math_sin=u;const l=Math.cos;t.Math_cos=l;const c=Math.tan;t.Math_tan=c;const d=Math.atan;t.Math_atan=d;let g=0},45488:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Math=void 0;const r=function(e){if(e.imul&&e.fround&&e.clz32)return e;const t=new Float32Array(1);return Object.create(e,{imul:{value:function(e,t){var r=(4194303&e)*(t|=0);return 4290772992&e&&(r+=(4290772992&e)*t|0),0|r}},fround:{value:function(e){return t[0]=e,t[0]}},clz32:{value:function(t){var r=t>>>0;return 0===r?32:31-(e.log(r)/e.LN2|0)|0}}})}(Math);t.Math=r},93119:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.proc_exit=function(e){throw new Error("unexpected process termination: "+e)}},29767:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.utcToLocal=t.toTime=t.TimeDivision=t.toDays=t.toNumWithDuration=t.toNum=t.fromNum=t.dtr=t.Rounding=t.daysPerMonth=void 0;const n=r(6585),a=r(73522);var i,o;function s(e,t,r,n,a,i,o,s,u){return{yr:e,mon:t,dom:r,hour:n,min:a,sec:i,wdy:o,fracSec:s,rounding:u}}function u(e){return s((0,n.Dtr_Yr)(e),(0,n.Dtr_Mon)(e),(0,n.Dtr_DOM)(e),(0,n.Dtr_Hour)(e),(0,n.Dtr_Min)(e),(0,n.Dtr_Sec)(e),(0,n.Dtr_Wdy)(e),(0,n.Dtr_FracSec)(e),(0,n.Dtr_Rounding)(e))}function l(e,t){(0,n.Dtr_Write)(t.yr,t.mon,t.dom,t.hour,t.min,t.sec,t.wdy,t.fracSec,t.rounding,e)}t.daysPerMonth=function(e,t,r){return(0,n.Dtr_DaysPerMonth)(e,t,r?1:0)},function(e){e[e.RoundSec=0]="RoundSec",e[e.Round10ths=1]="Round10ths",e[e.Round100ths=2]="Round100ths",e[e.Round1000ths=3]="Round1000ths"}(i||(t.Rounding=i={})),t.dtr=s,t.fromNum=function(e,t,r,a){const i=t;return 0===(0,n.Dtr_FromNum)(e,i,0,r?1:0,a?1:0)&&u(0)},t.toNum=function(e,t,r){l(0,e);const i=(0,n.Dtr_ToNum)(0,t?1:0,r?1:0),o=(0,n.Mathpack_TakeMathError)();return o===a.MathErrorNum.None?i:(0,a.mathError)(o)},t.toNumWithDuration=function(e,t,r,i,o){l(0,e);const s=i,u=(0,n.Dtr_ToNumWithDuration)(0,t?1:0,r?1:0,s,o),c=(0,n.Mathpack_TakeMathError)();return c===a.MathErrorNum.None?u:(0,a.mathError)(c)},t.toDays=function(e,t,r){return l(0,e),0===(0,n.Dtr_ToDays)(0,t?1:0,r?1:0)&&(0,n.Dtr_Days)()},function(e){e[e.Hour=0]="Hour",e[e.Minute=1]="Minute",e[e.Second=2]="Second"}(o||(t.TimeDivision=o={})),t.toTime=function(e,t,r){const i=t,o=r,s=(0,n.Dtr_ToTime)(e,i,o);return(0,n.Mathpack_TakeMathError)()===a.MathErrorNum.None&&s},t.utcToLocal=function(e,t,r,a){return l(0,e),null!=t.standardDate&&l(1,t.standardDate),null!=t.daylightDate&&l(2,t.daylightDate),0!==(0,n.Dtr_UtcToLocal)(0,t.bias,null!=t.standardDate?1:-1,t.standardBias,null!=t.daylightDate?2:-1,t.daylightBias,r?1:0,a?1:0)&&u(0)}},60145:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSupported=t.dtr=t.mathpack=void 0;const n=r(74643),a=n.__importStar(r(73522));t.mathpack=a;const i=n.__importStar(r(29767));t.dtr=i;const o=r(18969);Object.defineProperty(t,"isSupported",{enumerable:!0,get:function(){return o.isSupported}}),(0,r(6585)._start)()},73522:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pack=t.formatScientific=t.formatFixed=t.formatGeneral=t.mod=t.atan2=t.atan=t.acos=t.asin=t.tan=t.cos=t.sin=t.log=t.ln=t.exp=t.sqrt=t.viewRound=t.cond2=t.cond=t.power=t.add=t.sub=t.mul=t.div=t.compare=t.tenTo=t.roundDown=t.roundUp=t.round=t.sfix=t.lfix=t.fix=t.float=t.neg=t.abs=t.floor=t.ceil=t.trunc=t.equal=t.exp32=t.pi=t.one=t.zero=t.mathError=t.MathErrorNum=void 0;const n=r(6585),a=r(18969),i=r(6585);function o(e,t){const r=new Uint16Array(i.memory.buffer);let n="";for(let a=0;a<t;a+=1)n+=String.fromCharCode(r[e+(a<<1)>>1]);return n}var s;function u(e){return{num:e}}!function(e){e[e.None=0]="None",e[e.Over=1]="Over",e[e.Under=2]="Under",e[e.DivBy0=4]="DivBy0",e[e.Trans=8]="Trans",e[e._NA=16]="_NA",e[e._Val=32]="_Val",e[e._Num=64]="_Num"}(s||(t.MathErrorNum=s={}));const l={[s.Over]:u(s.Over),[s.Under]:u(s.Under),[s.DivBy0]:u(s.DivBy0),[s.Trans]:u(s.Trans)};function c(e){return l[e]??u(e)}function d(e){return t=>{const r=e(t),a=(0,n.Mathpack_TakeMathError)();return a===s.None?r:c(a)}}function g(e){return(t,r)=>{const a=e(t,r),i=(0,n.Mathpack_TakeMathError)();return i===s.None?a:c(i)}}t.mathError=c,t.zero=n.Mathpack_Zero,t.one=n.Mathpack_One,t.pi=n.Mathpack_Pi,t.exp32=n.Mathpack_GetExp32,t.equal=function(e,t){return 0!==(0,n.Mathpack_Equal)(e,t)},t.trunc=n.Mathpack_Trunc,t.ceil=d(n.Mathpack_Ceil),t.floor=d(n.Mathpack_Floor),t.abs=n.Mathpack_Abs,t.neg=n.Mathpack_Neg,t.float=function(e){return e<0?(0,n.Mathpack_SFloat)(e):(0,n.Mathpack_Float)(e)},t.fix=function(e){return(0,n.Mathpack_Fix)(e)>>>0},t.lfix=n.Mathpack_LFix,t.sfix=d(n.Mathpack_SFix),t.round=g(n.Mathpack_Round),t.roundUp=g(n.Mathpack_RoundUp),t.roundDown=g(n.Mathpack_RoundDown),t.tenTo=function(e){if(e<-1e3)return 0;if(e>1e3)return c(s.Over);if(!isFinite(e))return c(s.Over);const t=(0,n.Mathpack_TenTo)(e),r=(0,n.Mathpack_TakeMathError)();return r===s.None?t:c(r)},t.compare=n.Mathpack_Compare,t.div=g(n.Mathpack_Div),t.mul=g(n.Mathpack_Mul),t.sub=g(n.Mathpack_Sub),t.add=g(n.Mathpack_Add),t.power=g(n.Mathpack_Power),t.cond=function(e){const t=(0,n.Mathpack_Cond)(e),r=(0,n.Mathpack_TakeMathError)();return r===s.None?t:c(r)},t.cond2=n.Mathpack_Cond2,t.viewRound=d(n.Mathpack_ViewRound),t.sqrt=d(n.Mathpack_Sqrt),t.exp=d(n.Mathpack_Exp),t.ln=d(n.Mathpack_Ln),t.log=d(n.Mathpack_Log),t.sin=d(n.Mathpack_Sin),t.cos=d(n.Mathpack_Cos),t.tan=d(n.Mathpack_Tan),t.asin=d(n.Mathpack_Asin),t.acos=d(n.Mathpack_Acos),t.atan=d(n.Mathpack_Atan),t.atan2=g(n.Mathpack_Atan2),t.mod=g(n.Mathpack_Mod),t.formatGeneral=function(e,t,r){try{(0,a.setLocale)(e);const i=(0,n.Mathpack_FormatGeneral)(t,r);return i<0?c((0,n.Mathpack_TakeMathError)()):o((0,n.Base_StrBuf)(),i)}finally{(0,a.setLocale)(void 0)}},t.formatFixed=function(e,t,r){const a=(0,n.Mathpack_FormatFixed)(e,t,r);if(a<0)return(0,n.Mathpack_TakeMathError)();const i=o((0,n.Base_StrBuf)(),a),s=(0,n.Mathpack_FormatGetExponent)();return{sign:0!==(0,n.Mathpack_FormatGetSign)(),mantissa:i,exponent:s}},t.formatScientific=function(e,t,r){const a=(0,n.Mathpack_FormatScientific)(e,t,r);if(a<0)return(0,n.Mathpack_TakeMathError)();const i=o((0,n.Base_StrBuf)(),a),s=(0,n.Mathpack_FormatGetExponent)();return{sign:0!==(0,n.Mathpack_FormatGetSign)(),mantissa:i,exponent:s}},t.pack=function(e,t,r,o){try{(0,a.setLocale)(e);const u=(0,a.fastMin)(o.length,(0,n.Base_StrBufSize)());!function(e,t){const r=new Uint16Array(i.memory.buffer);for(let n=0;n<t.length;n+=1)r[e+(n<<1)>>1]=t.charCodeAt(n)}((0,n.Base_StrBuf)(),o.substring(0,u));const l=(0,n.Mathpack_Pack)(!!t,r,u),d=(0,n.Mathpack_TakeMathError)();return d!==s.None?c(d):isNaN(l)?c(s.Over):l}finally{(0,a.setLocale)(void 0)}}},18969:function(e,t){"use strict";let r;Object.defineProperty(t,"__esModule",{value:!0}),t.isSupported=t.fastMin=t.Base_LocaleDecimalSeparator=t.Base_LocaleGetOrdinal=t.Base_LocaleIsNumeral=t.setLocale=void 0,t.setLocale=function(e){r=e},t.Base_LocaleIsNumeral=function(e){return r.isNumeral(e)?1:0},t.Base_LocaleGetOrdinal=function(e){return r.getOrdinal(e)},t.Base_LocaleDecimalSeparator=function(){const e=r.decimalSeparator;return 0===e.length?46:e.charCodeAt(0)},t.fastMin=function(e,t){return e<t?e:t},t.isSupported=function(){const e=new ArrayBuffer(2);return new Uint16Array(e)[0]=1,1===new Uint8Array(e)[0]}},75469:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},4431:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(74643).__exportStar(r(75469),t)},71072:function(e,t){"use strict";var r,n,a,i,o;Object.defineProperty(t,"__esModule",{value:!0}),t.PictureDbnum=t.PictureColor=t.PictureSpecial=t.PictureSingle=t.Rounding=void 0,function(e){e[e.RoundSec=0]="RoundSec",e[e.Round10ths=1]="Round10ths",e[e.Round100ths=2]="Round100ths",e[e.Round1000ths=3]="Round1000ths"}(r||(t.Rounding=r={})),function(e){e[e.Sep=1]="Sep",e[e.Hash=2]="Hash",e[e.Zero=3]="Zero",e[e.Decimal=4]="Decimal",e[e.Percent=5]="Percent",e[e.Comma=6]="Comma",e[e.Colon=7]="Colon",e[e.DateSep=8]="DateSep",e[e.Slash=9]="Slash",e[e.Space=10]="Space",e[e.Minus=11]="Minus",e[e.Plus=12]="Plus",e[e.OpenParen=13]="OpenParen",e[e.CloseParen=14]="CloseParen",e[e.Extra=15]="Extra",e[e.Backslash=16]="Backslash",e[e.Star=17]="Star",e[e.Year=18]="Year",e[e.Month=19]="Month",e[e.Day=20]="Day",e[e.Hour=21]="Hour",e[e.Minute=22]="Minute",e[e.Second=23]="Second",e[e.E=24]="E",e[e.APDelim=25]="APDelim",e[e.Quote=26]="Quote",e[e.ColorStart=27]="ColorStart",e[e.ColorEnd=28]="ColorEnd",e[e.Text=29]="Text",e[e.Question=30]="Question",e[e.Underscore=31]="Underscore",e[e.Reign=32]="Reign",e[e.LocDay=33]="LocDay",e[e.Era=34]="Era",e[e.EraYear=35]="EraYear",e[e.Nen1=36]="Nen1",e[e.Gatsu1=37]="Gatsu1",e[e.Nichi1=38]="Nichi1",e[e.Nen2=39]="Nen2",e[e.Gatsu2=40]="Gatsu2",e[e.Nichi2=41]="Nichi2",e[e.BidiDate=42]="BidiDate",e[e.BidiNum=43]="BidiNum",e[e.DayTh=44]="DayTh",e[e.MonthTh=45]="MonthTh",e[e.YearTh=46]="YearTh",e[e.EngYearTh=47]="EngYearTh",e[e.ThYear=48]="ThYear",e[e.HourTh=49]="HourTh",e[e.MinuteTh=50]="MinuteTh",e[e.SecondTh=51]="SecondTh",e[e.ZeroTh=52]="ZeroTh"}(n||(t.PictureSingle=n={})),function(e){e[e.AP1=0]="AP1",e[e.AP2=1]="AP2",e[e.AP3=2]="AP3",e[e.GeneralOldMAC=3]="GeneralOldMAC",e[e.General=4]="General",e[e.Currency=5]="Currency"}(a||(t.PictureSpecial=a={})),function(e){e[e.Black=0]="Black",e[e.White=1]="White",e[e.Red=2]="Red",e[e.Green=3]="Green",e[e.Blue=4]="Blue",e[e.Yellow=5]="Yellow",e[e.Magenta=6]="Magenta",e[e.Cyan=7]="Cyan",e[e.Color=8]="Color"}(i||(t.PictureColor=i={})),function(e){e[e.DBNUM1=0]="DBNUM1",e[e.DBNUM2=1]="DBNUM2",e[e.DBNUM3=2]="DBNUM3",e[e.DBNUM4=3]="DBNUM4"}(o||(t.PictureDbnum=o={}))},30699:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},30421:function(e,t){"use strict";var r,n,a,i,o;Object.defineProperty(t,"__esModule",{value:!0}),t.PictureDbnum=t.PictureColor=t.PictureSpecial=t.PictureSingle=t.Rounding=void 0,function(e){e[e.RoundSec=0]="RoundSec",e[e.Round10ths=1]="Round10ths",e[e.Round100ths=2]="Round100ths",e[e.Round1000ths=3]="Round1000ths"}(r||(t.Rounding=r={})),function(e){e[e.Sep=1]="Sep",e[e.Hash=2]="Hash",e[e.Zero=3]="Zero",e[e.Decimal=4]="Decimal",e[e.Percent=5]="Percent",e[e.Comma=6]="Comma",e[e.Colon=7]="Colon",e[e.DateSep=8]="DateSep",e[e.Slash=9]="Slash",e[e.Space=10]="Space",e[e.Minus=11]="Minus",e[e.Plus=12]="Plus",e[e.OpenParen=13]="OpenParen",e[e.CloseParen=14]="CloseParen",e[e.Extra=15]="Extra",e[e.Backslash=16]="Backslash",e[e.Star=17]="Star",e[e.Year=18]="Year",e[e.Month=19]="Month",e[e.Day=20]="Day",e[e.Hour=21]="Hour",e[e.Minute=22]="Minute",e[e.Second=23]="Second",e[e.E=24]="E",e[e.APDelim=25]="APDelim",e[e.Quote=26]="Quote",e[e.ColorStart=27]="ColorStart",e[e.ColorEnd=28]="ColorEnd",e[e.Text=29]="Text",e[e.Question=30]="Question",e[e.Underscore=31]="Underscore",e[e.Reign=32]="Reign",e[e.LocDay=33]="LocDay",e[e.Era=34]="Era",e[e.EraYear=35]="EraYear",e[e.Nen1=36]="Nen1",e[e.Gatsu1=37]="Gatsu1",e[e.Nichi1=38]="Nichi1",e[e.Nen2=39]="Nen2",e[e.Gatsu2=40]="Gatsu2",e[e.Nichi2=41]="Nichi2",e[e.BidiDate=42]="BidiDate",e[e.BidiNum=43]="BidiNum",e[e.DayTh=44]="DayTh",e[e.MonthTh=45]="MonthTh",e[e.YearTh=46]="YearTh",e[e.EngYearTh=47]="EngYearTh",e[e.ThYear=48]="ThYear",e[e.HourTh=49]="HourTh",e[e.MinuteTh=50]="MinuteTh",e[e.SecondTh=51]="SecondTh",e[e.ZeroTh=52]="ZeroTh"}(n||(t.PictureSingle=n={})),function(e){e[e.AP1=0]="AP1",e[e.AP2=1]="AP2",e[e.AP3=2]="AP3",e[e.GeneralOldMAC=3]="GeneralOldMAC",e[e.General=4]="General",e[e.Currency=5]="Currency"}(a||(t.PictureSpecial=a={})),function(e){e[e.Black=0]="Black",e[e.White=1]="White",e[e.Red=2]="Red",e[e.Green=3]="Green",e[e.Blue=4]="Blue",e[e.Yellow=5]="Yellow",e[e.Magenta=6]="Magenta",e[e.Cyan=7]="Cyan",e[e.Color=8]="Color"}(i||(t.PictureColor=i={})),function(e){e[e.DBNUM1=0]="DBNUM1",e[e.DBNUM2=1]="DBNUM2",e[e.DBNUM3=2]="DBNUM3",e[e.DBNUM4=3]="DBNUM4"}(o||(t.PictureDbnum=o={}))},41879:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},75146:function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.DefinedNameInfoType=void 0,function(e){e[e.Invalid=-1]="Invalid",e[e.Table=0]="Table",e[e.NamedRange=1]="NamedRange",e[e.Lambda=2]="Lambda",e[e.Other=3]="Other"}(r||(t.DefinedNameInfoType=r={}))},61904:function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.MajorityDataType=void 0,function(e){e[e.Text=0]="Text",e[e.Number=1]="Number",e[e.Date=2]="Date",e[e.Max=3]="Max"}(r||(t.MajorityDataType=r={}))},9813:function(e,t){"use strict";var r,n,a,i,o,s;Object.defineProperty(t,"__esModule",{value:!0}),t.RepairItemPartType=t.CodeActionKind=t.DiagnosticTag=t.DiagnosticSeverity=t.SuggestionKind=t.CompletionItemKind=void 0,function(e){e[e.Function=3]="Function",e[e.Enum=13]="Enum",e[e.NamedRange=100]="NamedRange",e[e.TableHeader=101]="TableHeader",e[e.LetVariable=102]="LetVariable",e[e.RichEntity=103]="RichEntity",e[e.Lambda=104]="Lambda",e[e.CustomFunction=105]="CustomFunction",e[e.Table=106]="Table",e[e.TableSpecialStructRef=107]="TableSpecialStructRef",e[e.RichEntityEmptyCellRef=108]="RichEntityEmptyCellRef",e[e.RangeRef=109]="RangeRef",e[e.NamedOther=110]="NamedOther"}(r||(t.CompletionItemKind=r={})),function(e){e[e.Simple=0]="Simple",e[e.Smart=1]="Smart"}(n||(t.SuggestionKind=n={})),function(e){e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Information=3]="Information",e[e.Hint=4]="Hint"}(a||(t.DiagnosticSeverity=a={})),function(e){e[e.Unnecessary=1]="Unnecessary",e[e.Deprecated=2]="Deprecated"}(i||(t.DiagnosticTag=i={})),function(e){e[e.Empty=0]="Empty",e[e.QuickFix=1]="QuickFix",e[e.Refactor=2]="Refactor",e[e.RefactorExtract=3]="RefactorExtract",e[e.RefactorInline=4]="RefactorInline",e[e.RefactorRewrite=5]="RefactorRewrite",e[e.Source=6]="Source",e[e.SourceOrganizeImports=7]="SourceOrganizeImports",e[e.SourceFixAll=8]="SourceFixAll"}(o||(t.CodeActionKind=o={})),function(e){e[e.None=0]="None",e[e.Added=1]="Added",e[e.Removed=2]="Removed",e[e.Replaced=3]="Replaced"}(s||(t.RepairItemPartType=s={}))},79345:function(e,t){"use strict";var r,n;Object.defineProperty(t,"__esModule",{value:!0}),t.ReferenceMode=t.IncompatibilityType=void 0,function(e){e[e.gMove=1]="gMove"}(r||(t.IncompatibilityType=r={})),function(e){e[e.R1C1=0]="R1C1",e[e.A1=1]="A1"}(n||(t.ReferenceMode=n={}))},65238:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},28293:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},92460:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},17089:function(e,t){"use strict";var r,n,a,i,o,s,u,l,c,d,g,m,h,p;Object.defineProperty(t,"__esModule",{value:!0}),t.TableOrientation=t.RecognizedTablesMetadataState=t.ColumnFormulaSuggestionUpdateKind=t.SchedulerFeature=t.GotoCtrlClickResultKind=t.ValuePreviewResultKind=t.PositionKind=t.HighlightKind=t.PerCharacterExperimentResultKind=t.PluginAttachGroup=t.PluginGroup=t.PluginFactoryName=t.MessageType=t.EditorMessageType=void 0,function(e){e[e.FunctionMessage=0]="FunctionMessage"}(r||(t.EditorMessageType=r={})),function(e){e[e.Insert=0]="Insert",e[e.Delete=1]="Delete",e[e.Replace=2]="Replace"}(n||(t.MessageType=n={})),function(e){e[e.TestPlugin=0]="TestPlugin",e[e.AutocompletePlugin=1]="AutocompletePlugin",e[e.DragPlugin=2]="DragPlugin",e[e.ConfigTestPlugin=3]="ConfigTestPlugin",e[e.ArgumentAssistancePlugin=4]="ArgumentAssistancePlugin",e[e.FeatureGateTestPlugin=5]="FeatureGateTestPlugin",e[e.DNMTraceTagTestPlugin=7]="DNMTraceTagTestPlugin",e[e.ParenthesesCouplingPlugin=8]="ParenthesesCouplingPlugin",e[e.AutocompleteFunctionPlugin=9]="AutocompleteFunctionPlugin",e[e.AutocompleteLetPlugin=10]="AutocompleteLetPlugin",e[e.AutocompleteRichValuePlugin=11]="AutocompleteRichValuePlugin",e[e.AutocompleteNamedObjectsPlugin=12]="AutocompleteNamedObjectsPlugin",e[e.AutocompleteTableHeadersPlugin=13]="AutocompleteTableHeadersPlugin",e[e.ColoredReferencesPlugin=14]="ColoredReferencesPlugin",e[e.ValuePreviewPlugin=15]="ValuePreviewPlugin",e[e.AutocompleteRangeSuggestionPlugin=16]="AutocompleteRangeSuggestionPlugin",e[e.SyntaxErrorsPlugin=17]="SyntaxErrorsPlugin",e[e.GotoCtrlClickPlugin=18]="GotoCtrlClickPlugin",e[e.AutocompleteEnumPlugin=19]="AutocompleteEnumPlugin",e[e.FormulaByExamplePlugin=20]="FormulaByExamplePlugin",e[e.SetCellPrefetchPlugin=21]="SetCellPrefetchPlugin",e[e.FormulaTranspilerPlugin=22]="FormulaTranspilerPlugin",e[e.InCellControlsAutodetectionPlugin=23]="InCellControlsAutodetectionPlugin",e[e.FormulaCollectionPlugin=1004]="FormulaCollectionPlugin",e[e.ParserPerformanceMeasurements=1005]="ParserPerformanceMeasurements",e[e.FormulaRepairShadowEvalPlugin=1007]="FormulaRepairShadowEvalPlugin",e[e.PythonAutocompletePlugin=1008]="PythonAutocompletePlugin",e[e.AutocompleteWrapperPlugin=1009]="AutocompleteWrapperPlugin",e[e.AutocompleteBinaryModelExperimentPlugin=1010]="AutocompleteBinaryModelExperimentPlugin",e[e.ChangeGateTestPlugin=2e3]="ChangeGateTestPlugin",e[e.SlowTestPlugin=2001]="SlowTestPlugin",e[e.EvalOnCloneTestPlugin=2002]="EvalOnCloneTestPlugin",e[e.EvalFormulaTestPlugin=2003]="EvalFormulaTestPlugin",e[e.PythonTestPlugin=2004]="PythonTestPlugin",e[e.ChatGPTPlugin=2005]="ChatGPTPlugin",e[e.EventsTestPlugin=2006]="EventsTestPlugin"}(a||(t.PluginFactoryName=a={})),function(e){e[e.Excel=0]="Excel",e[e.Python=1]="Python"}(i||(t.PluginGroup=i={})),function(e){e[e.Core=0]="Core",e[e.Python=1]="Python",e[e.SmartSuggestionsAutoComplete=2]="SmartSuggestionsAutoComplete"}(o||(t.PluginAttachGroup=o={})),function(e){e[e.AutocompleteWrapperPluginResult=0]="AutocompleteWrapperPluginResult"}(s||(t.PerCharacterExperimentResultKind=s={})),function(e){e[e.CellRef=0]="CellRef",e[e.StructRef=1]="StructRef",e[e.NamedRange=2]="NamedRange",e[e.Parentheses=3]="Parentheses"}(u||(t.HighlightKind=u={})),function(e){e[e.Absolute=0]="Absolute",e[e.Relative=1]="Relative"}(l||(t.PositionKind=l={})),function(e){e[e.Failure=0]="Failure",e[e.Success=1]="Success",e[e.Unavailable=2]="Unavailable"}(c||(t.ValuePreviewResultKind=c={})),function(e){e[e.ReferenceFound=0]="ReferenceFound",e[e.NoReferenceFound=1]="NoReferenceFound",e[e.Failure=2]="Failure",e[e.RangeResolutionFailure=3]="RangeResolutionFailure",e[e.NotAFormula=4]="NotAFormula"}(d||(t.GotoCtrlClickResultKind=d={})),function(e){e[e.ArgumentAssistance=0]="ArgumentAssistance",e[e.SimpleAutoComplete=1]="SimpleAutoComplete",e[e.SmartSuggestionsAutoComplete=2]="SmartSuggestionsAutoComplete",e[e.ValuePreview=3]="ValuePreview",e[e.ColoredReferences=4]="ColoredReferences",e[e.ParenthesisCoupling=5]="ParenthesisCoupling",e[e.SyntaxErrors=6]="SyntaxErrors",e[e.GotoCtrlClick=7]="GotoCtrlClick",e[e.EnumAutoComplete=8]="EnumAutoComplete"}(g||(t.SchedulerFeature=g={})),function(e){e[e.Accept=0]="Accept",e[e.Decline=1]="Decline",e[e.Ignore=2]="Ignore"}(m||(t.ColumnFormulaSuggestionUpdateKind=m={})),function(e){e[e.Valid=2]="Valid",e[e.Invalid=4]="Invalid",e[e.All=6]="All"}(h||(t.RecognizedTablesMetadataState=h={})),function(e){e[e.none=0]="none",e[e.rowMajor=1]="rowMajor",e[e.columnMajor=2]="columnMajor"}(p||(t.TableOrientation=p={}))},93336:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PictureSpecial=t.PictureSingle=t.PictureDbnum=t.PictureColor=void 0;const n=r(74643);n.__exportStar(r(75146),t),n.__exportStar(r(61904),t),n.__exportStar(r(9813),t),n.__exportStar(r(41879),t),n.__exportStar(r(79345),t),n.__exportStar(r(92460),t),n.__exportStar(r(65238),t),n.__exportStar(r(30421),t),n.__exportStar(r(17089),t),n.__exportStar(r(28293),t);var a=r(71072);Object.defineProperty(t,"PictureColor",{enumerable:!0,get:function(){return a.PictureColor}}),Object.defineProperty(t,"PictureDbnum",{enumerable:!0,get:function(){return a.PictureDbnum}}),Object.defineProperty(t,"PictureSingle",{enumerable:!0,get:function(){return a.PictureSingle}}),Object.defineProperty(t,"PictureSpecial",{enumerable:!0,get:function(){return a.PictureSpecial}}),n.__exportStar(r(85647),t),n.__exportStar(r(30699),t),n.__exportStar(r(4431),t)},85647:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},71779:function(e,t,r){"use strict";const n=r(91092);e.exports=n.assertions},71121:function(e,t,r){"use strict";const n=r(91092);e.exports=n.core},49163:function(e,t,r){"use strict";const n=r(91092);e.exports=n.priorityQueue},33581:function(e,t,r){"use strict";const n=r(91092);e.exports=n.promise},16499:function(e,t,r){"use strict";const n=r(91092);e.exports=n.result},12158:function(e,t,r){"use strict";const n=r(91092);e.exports=n.setTimeoutInterfaceModule},40834:function(e,t,r){"use strict";const n=r(91092);e.exports=n.util},77588:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},68990:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},15200:function(e,t){"use strict";var r,n,a,i,o,s;Object.defineProperty(t,"__esModule",{value:!0}),t.RepairItemPartType=t.CodeActionKind=t.DiagnosticTag=t.DiagnosticSeverity=t.SuggestionKind=t.CompletionItemKind=void 0,function(e){e[e.Function=3]="Function",e[e.Enum=13]="Enum",e[e.NamedRange=100]="NamedRange",e[e.TableHeader=101]="TableHeader",e[e.LetVariable=102]="LetVariable",e[e.RichEntity=103]="RichEntity",e[e.Lambda=104]="Lambda",e[e.CustomFunction=105]="CustomFunction",e[e.Table=106]="Table",e[e.TableSpecialStructRef=107]="TableSpecialStructRef",e[e.RichEntityEmptyCellRef=108]="RichEntityEmptyCellRef",e[e.RangeRef=109]="RangeRef"}(r||(t.CompletionItemKind=r={})),function(e){e[e.Simple=0]="Simple",e[e.Smart=1]="Smart"}(n||(t.SuggestionKind=n={})),function(e){e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Information=3]="Information",e[e.Hint=4]="Hint"}(a||(t.DiagnosticSeverity=a={})),function(e){e[e.Unnecessary=1]="Unnecessary",e[e.Deprecated=2]="Deprecated"}(i||(t.DiagnosticTag=i={})),function(e){e[e.Empty=0]="Empty",e[e.QuickFix=1]="QuickFix",e[e.Refactor=2]="Refactor",e[e.RefactorExtract=3]="RefactorExtract",e[e.RefactorInline=4]="RefactorInline",e[e.RefactorRewrite=5]="RefactorRewrite",e[e.Source=6]="Source",e[e.SourceOrganizeImports=7]="SourceOrganizeImports",e[e.SourceFixAll=8]="SourceFixAll"}(o||(t.CodeActionKind=o={})),function(e){e[e.None=0]="None",e[e.Added=1]="Added",e[e.Removed=2]="Removed",e[e.Replaced=3]="Replaced"}(s||(t.RepairItemPartType=s={}))},63959:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapIntoResumeRecalc=t.emptyRangeFormat=t.emptyRangeFormula=t.emptyRangeValue=t.FormulaKind=void 0;const n=r(76906),a=r(3136),i=r(71121);var o;!function(e){e.Value="Value",e.CellFormula="CellFormula"}(o||(t.FormulaKind=o={})),t.emptyRangeValue=a.blankOper,t.emptyRangeFormula={kind:o.Value,formulaBarText:"",origin:(0,n.gridCell)(0,0)},(0,i.staticAssertExtends)(),t.emptyRangeFormat=0,t.wrapIntoResumeRecalc=function(e,t){return{evalClonedModelOnSnapshot:(r,...n)=>{const a=e.evalClonedModelOnSnapshot(r,...n);return t(r),a},discardSnapshot:e.discardSnapshot.bind(e),getRangeFormats:(r,...n)=>{const a=e.getRangeFormats(r,...n);return t(r),a},getRangeValues:(r,...n)=>{const a=e.getRangeValues(r,...n);return t(r),a},getRangeFormulae:(r,...n)=>{const a=e.getRangeFormulae(r,...n);return t(r),a},getSheetNames:(r,...n)=>{const a=e.getSheetNames(r,...n);return t(r),a},getIntersectingTables:(r,...n)=>{const a=e.getIntersectingTables(r,...n);return t(r),a},getIformats:(r,...n)=>{const a=e.getIformats(r,...n);return t(r),a},getHiddenRows:(r,...n)=>{const a=e.getHiddenRows(r,...n);return t(r),a},getHiddenCols:(r,...n)=>{const a=e.getHiddenCols(r,...n);return t(r),a},evalFormulaOnSnapshot:(r,...n)=>{const a=e.evalFormulaOnSnapshot(r,...n);return t(r),a},getCorrespondingSnapshotID:t=>e.getCorrespondingSnapshotID(t)}}},31393:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.spanCompare=t.Timeline=t.spanToLSPRange=t.indexToLSPPosition=void 0;const n=r(71121),a=r(4156),i=r(82438),o=r(71779),s=r(11093);function u(e,t){let r=0,a=0;for(;a<t;){const i=e.indexOf("\n",a),o=e.indexOf("\r",a),s=i<0?o:o<0?i:(0,n.fastMin)(i,o);if(s<0||s>=t)break;r+=1,a=s+1+(s===o&&s+1<t&&10===e.charCodeAt(s+1)?1:0)}return{line:r,character:t-a}}t.indexToLSPPosition=u,t.spanToLSPRange=function(e,t,r){return{start:u(e,t),end:u(e,r)}},t.Timeline=class{stamp(e){this.enabled&&!this.timestamps.has(e)&&this.timestamps.set(e,this.timer.now())}log(e){if(this.enabled){this.stamp(e);const t={};let r=this.timer.now(),n=0;this.timestamps.forEach(((e,a)=>{r=Math.min(r,e),n=Math.max(n,e),t[a]=e})),n-r>this.logThreshold&&o.ulsLogger.ULS.traceTag(526234881,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`Timeline[${this.name}]: ${JSON.stringify({...t,...this.workerInfo})}`),this.timestamps.clear()}}constructor(e,t,r=!0){this.name=e,this.logThreshold=t,this.enabled=r,this.timestamps=new Map,this.timer=a.defaultTimerInterface,this.workerInfo={isWorkerThread:(0,s.isWorkerThread)(),workerName:(0,s.workerName)()},o.ulsLogger.ULS.traceTag(526223315,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`Timeline[${this.name}]: Initializing, ${JSON.stringify(this.workerInfo)}`)}},t.spanCompare=function(e,t){let r;return 0!=(r=e.start-t.start)||0!=(r=t.end-e.end)?r:0}},53972:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formulaAssistance=t.dynamicPluginLoaderEwaFacade=t.functionInfoDTO=t.gridinterface=t.helpers=t.mockGlobals=t.notificationKinds=t.testUtils=t.mockTimer=t.timelineQueueProcessor=t.repeatedTaskScheduler=t.types=t.PackageName=void 0;const n=r(74643);t.PackageName="excel-online-x10-types",t.types=n.__importStar(r(35217)),t.repeatedTaskScheduler=n.__importStar(r(69752)),t.timelineQueueProcessor=n.__importStar(r(4156)),t.mockTimer=n.__importStar(r(51891)),t.testUtils=n.__importStar(r(23901)),t.notificationKinds=n.__importStar(r(21374)),t.mockGlobals=n.__importStar(r(24022)),t.helpers=n.__importStar(r(31393)),t.gridinterface=n.__importStar(r(63959)),t.functionInfoDTO=n.__importStar(r(77588)),t.dynamicPluginLoaderEwaFacade=n.__importStar(r(68990)),t.formulaAssistance=n.__importStar(r(15200))},76906:function(e,t,r){"use strict";const n=r(84817);e.exports=n.location},46065:function(e,t,r){"use strict";const n=r(84817);e.exports=n.util},3136:function(e,t,r){"use strict";const n=r(84817);e.exports=n.value},24022:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MockGlobals=void 0;const n=r(16499),a=r(46065);t.MockGlobals=class{getDocumentLoc(){return(0,n.failure)((0,a.notImplemented)(["getDocumentLoc"]))}getSheetIndex(){return(0,n.failure)((0,a.notImplemented)(["getSheetIndex"]))}getSheetName(){return(0,n.failure)((0,a.notImplemented)(["getSheetName"]))}getNameLoc(){return(0,n.failure)((0,a.notImplemented)(["getNameLoc"]))}getUserDefinedFuncLoc(){return(0,n.failure)((0,a.notImplemented)(["getUserDefinedFuncLoc"]))}getSheetRangeIndexes(){return(0,n.failure)((0,a.notImplemented)(["getSheetRangeIndexes"]))}getContainingTable(){return(0,n.failure)((0,a.notImplemented)(["getContainingTable"]))}getStructRefColumn(){return(0,n.failure)((0,a.notImplemented)(["getStructRefColumn"]))}getStructRefSpecialRef(){return(0,n.failure)((0,a.notImplemented)(["getStructRefSpecialRef"]))}getTime(){return(0,n.failure)((0,a.unavailable)(["getTime"]))}constructor(e){this.config=e}}},51891:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MockTimerImmediate=t.MockTimer=void 0;const n=r(49163),a=r(40834),i=r(12158);t.MockTimer=class{now(){const e=this.nowTimes.shift();if(void 0===e)throw"now was called too many times";return e}constructor(e){this.nowTimes=e,this.setImmediateCalls=[],this.setTimeoutCalls=[],this.clearImmediateCalls=[],this.clearTimeoutCalls=[],this.setImmediate=(e,...t)=>{if(void 0!==this.handle)throw"setImmediate called, even though we already have a callback";return this.setImmediateCalls.push([e,...t]),this.handle=(0,i.setImmediateUnified)((()=>(this.handle=void 0,e(...t))))},this.clearImmediate=e=>{if(this.handle!==e)throw"clearImmediate called with a different handle than the one supplied";(0,i.clearTimerUnified)(this.handle),this.clearImmediateCalls.push([e]),this.handle=void 0},this.setTimeout=(e,t,...r)=>{if(void 0!==this.handle)throw"setTimeout called, even though we already have a callback";return this.setTimeoutCalls.push([e,t,...r]),this.handle=(0,i.setImmediateUnified)((()=>(this.handle=void 0,e(...r))))},this.clearTimeout=e=>{if(this.handle!==e)throw"clearTimeout called with a different handle than the one supplied";(0,i.clearTimerUnified)(this.handle),this.clearTimeoutCalls.push([e]),this.handle=void 0}}};class o{preciseNow(){return this.time}now(){return Math.floor(this.time/this.precisionMs)*this.precisionMs}busyWait(e){this.time+=e>0?e:0}busyWaitUntil(e){this.time=this.time<e?e:this.time}async runMacrotasksWhile(e){for(;;){if(await new Promise((e=>(0,i.setImmediateUnified)((()=>e())))),!e())return;const t=this.queue.pop();if(!t)return;if(this.busyWaitUntil(t.delayUntil),t.isValid)try{t.callback(...t.args)}catch(e){dispatchEvent(new ErrorEvent("error",{error:e,message:(0,a.messageFromError)(e),filename:"",lineno:0,colno:0}))}}}constructor(e=1,t=0){this.precisionMs=e,this.startTime=t,this.setImmediate=(e,...t)=>{const r={delayUntil:-1,callback:e,args:t,isValid:!0};return this.queue.enqueue(r),new o.Immediate(r)},this.clearImmediate=e=>{if(!(e instanceof o.Immediate))throw new TypeError("handle is not a MockFullTimer.Immediate");(0,i.clearTimerUnified)(e)},this.setTimeout=(e,t,...r)=>{const n={delayUntil:this.time+(t>4?t:4),callback:e,args:r,isValid:!0};return this.queue.enqueue(n),new o.Timeout(n)},this.clearTimeout=e=>{if(!(e instanceof o.Timeout))throw new TypeError("handle is not a MockFullTimer.Timeout");(0,i.clearTimerUnified)(e)},this.time=t>0?t:0,this.queue=new n.PriorityQueue(((e,t)=>e.delayUntil-t.delayUntil))}}t.MockTimerImmediate=o,o.Immediate=class{constructor(e){this.delayedCallback=e,this.kind="Mocking"}},o.Timeout=class{constructor(e){this.delayedCallback=e,this.kind="Mocking"}}},21374:function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.NotificationKind=void 0,function(e){e.doNothing="doNothing",e.setActiveCell="setActiveCell",e.setActiveCellFormat="setActiveCellFormat",e.setFunctionsInfo="setFunctionsInfo",e.setDefinedNamesInfo="setDefinedNamesInfo",e.notifyWorkbookClosing="notifyWorkbookClosing",e.setSchedulerFeatures="setSchedulerFeatures",e.setA1ReferenceStyle="setA1ReferenceStyle",e.setLocale="setLocale",e.setWorkbookProps="setWorkbookProps",e.updateSheetNames="updateSheetNames",e.updateNamedObjects="updateNamedObjects",e.conflictResolverEarlyTermination="conflictResolverEarlyTermination",e.writeRange="writeRange",e.setNumberFormats="setNumberFormats"}(r||(t.NotificationKind=r={}))},69752:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RepeatedTaskScheduler=t.TaskKind=void 0;const n=r(71779),a=r(71121),i=r(12158);var o,s;function u(e,t){return{kind:e,handle:t}}function l(e){return void 0!==e?(e.kind=o.NoWorkScheduled,e.handle=void 0,e):u(o.NoWorkScheduled,void 0)}!function(e){e[e.NoWorkScheduled=0]="NoWorkScheduled",e[e.PromiseScheduled=1]="PromiseScheduled",e[e.ImmediateScheduled=2]="ImmediateScheduled",e[e.FutureScheduled=3]="FutureScheduled"}(o||(o={})),(0,a.staticAssertExtends)(),function(e){e.Sync="Sync",e.MicroTask="MicroTask",e.MacroTask="MacroTask"}(s||(t.TaskKind=s={}));const c=Promise.resolve();t.RepeatedTaskScheduler=class{runNextSynchronously(){switch(this.handleState.kind){case o.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle);break;case o.FutureScheduled:this.timer.clearTimeout(this.handleState.handle)}this.clearHandleClosureAndRunBody()}runNextAsMicrotask(){switch(this.handleState.kind){case o.PromiseScheduled:return;case o.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle);break;case o.FutureScheduled:this.timer.clearTimeout(this.handleState.handle)}var e;this.handleState=void 0!==(e=this.handleState)?(e.kind=o.PromiseScheduled,e.handle=void 0,e):u(o.PromiseScheduled,void 0),c.then(this.promiseClosure)}runNextAsMacrotask(){switch(this.handleState.kind){case o.ImmediateScheduled:return;case o.FutureScheduled:this.timer.clearTimeout(this.handleState.handle)}var e,t;this.handleState=(e=this.timer.setImmediate(this.clearHandleClosureAndRunBody),void 0!==(t=this.handleState)?(t.kind=o.ImmediateScheduled,t.handle=e,t):u(o.ImmediateScheduled,e))}runNextInFuture(e){switch(this.handleState.kind){case o.FutureScheduled:this.timer.clearTimeout(this.handleState.handle);break;case o.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle)}var t,r;this.handleState=(t=this.timer.setTimeout(this.clearHandleClosureAndRunBody,e),void 0!==(r=this.handleState)?(r.kind=o.FutureScheduled,r.handle=t,r):u(o.FutureScheduled,t))}clear(){switch(this.handleState.kind){case o.FutureScheduled:this.timer.clearTimeout(this.handleState.handle);break;case o.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle)}this.handleState=l(this.handleState)}constructor(e,t=i.defaultSetTimeoutInterface){this.timer=t,this.handleState=l(),this.clearHandleClosureAndRunBody=()=>{let t;switch(this.handleState.kind){case o.NoWorkScheduled:t=s.Sync;break;case o.PromiseScheduled:t=s.MicroTask;break;case o.ImmediateScheduled:case o.FutureScheduled:t=s.MacroTask;break;default:(0,n.assertNever)("Unknown handle state",this.handleState)}this.handleState=l(this.handleState),e(t)},this.promiseClosure=()=>{this.handleState.kind===o.PromiseScheduled&&this.clearHandleClosureAndRunBody()}}}},23901:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runQueueProcessorUntil=void 0;const n=r(33581);t.runQueueProcessorUntil=async function(e,t){let r=!1;const a=Promise.resolve(t);a.then((()=>r=!0));let i=0;return await(0,n.promiseLoop)((async()=>{if(++i%100==0&&await new Promise((e=>setTimeout(e,1))),!r)return e.step(),!0}),!0),a}},4156:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TimelineQueueProcessor=t.defaultTimerInterface=void 0;const n=r(71121),a=r(49163),i=r(12158),o=r(69752);t.defaultTimerInterface={...i.defaultSetTimeoutInterface,now:n.now},t.TimelineQueueProcessor=class{enqueue(e,t,r=this.maxWitnessedNow){this.queue.enqueue({delayUntil:r,payload:e,abstractCost:t}),this.continue()}push(e,t,r=this.maxWitnessedNow){this.queue.push({delayUntil:r,payload:e,abstractCost:t}),this.continue()}pop(){return 1===this.queue.getCount()&&this.scheduler.clear(),this.queue.pop()?.payload}peek(){return this.queue.peek()}getCount(){return this.queue.getCount()}continue(){for(this.startTime=this.startTime??this.now();this.totalSyncCost<this.costThreshold;){const e=this.queue.peek();if(void 0===e)return;if(e.delayUntil>this.maxWitnessedNow&&this.tryRunNextInFuture(e.delayUntil,this.now()))return;this.queue.pop(),this.totalSyncCost+=e.abstractCost,this.consumeMessage(e.payload)}const e=this.queue.peek();if(void 0===e)return;const t=this.now();t-this.startTime<this.timeThreshold&&e.delayUntil<=t?this.scheduler.runNextAsMicrotask():this.tryRunNextInFuture(e.delayUntil,t)||this.scheduler.runNextAsMacrotask()}tryRunNextInFuture(e,t){return e>t&&(this.lastFutureAbsoluteTime!==e&&(this.lastFutureAbsoluteTime=e,this.scheduler.runNextInFuture(e-t)),!0)}now(){return this.maxWitnessedNow=this.timer.now()}constructor(e,r,n,i=t.defaultTimerInterface){this.cmp=e,this.consumeMessage=r,this.timer=i,this.startTime=void 0,this.totalSyncCost=0,this.maxWitnessedNow=0,this.lastFutureAbsoluteTime=void 0,this.queue=new a.PriorityQueue(((t,r)=>{const n=t.delayUntil-r.delayUntil;return 0!==n?n:e(t.payload,r.payload)})),this.costThreshold=n?.costThreshold??1,this.timeThreshold=n?.timeThreshold??10,this.scheduler=new o.RepeatedTaskScheduler((e=>{this.totalSyncCost=0,this.lastFutureAbsoluteTime=void 0,e===o.TaskKind.MacroTask&&(this.startTime=void 0),this.continue()}),i)}}},35217:function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.SpecialFormat=void 0,function(e){e.Unavailable="Unavailable",e.Weak="Weak",e.ClientValueUnknown="ClientValueUnknown",e.Origin="Origin",e.Aggregate="Aggregate",e.Inferred="Inferred",e.Known="Known",e.Edit="Edit"}(r||(t.SpecialFormat=r={}))},56825:function(e,t){"use strict";function r(){return void 0===globalThis.__get_change_gate_dictionary_variable?{}:globalThis.__get_change_gate_dictionary_variable()}Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0,t.getChangeGateDictionary=r,t.isChangeGateEnabled=function(e){return r()[e]??!0},t.setChangeGateDictionaryGetter=function(e){const t=globalThis.__get_change_gate_dictionary_variable;return globalThis.__get_change_gate_dictionary_variable=e,t}},46231:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;const r={};function n(){return void 0===globalThis.__get_feature_gate_dictionary_variable?r:globalThis.__get_feature_gate_dictionary_variable()}function a(e,t){return n()[e]??t}t.getFeatureGateDictionary=n,t.getStringFeatureGate=a,t.getBooleanFeatureGate=function(e,t){const r=a(e)?.trim().toLowerCase();return"true"===r||"false"!==r&&t},t.getNumberFeatureGate=function(e,t){const r=a(e)?.trim().toLowerCase();if(void 0===r)return t;if("infinity"===r||"+infinity"===r)return 1/0;if("-infinity"===r)return-1/0;const n=parseFloat(r);return isNaN(n)?t:n},t.getIntFeatureGate=function(e,t){const r=a(e)?.trim();if(void 0===r)return t;const n=parseInt(r,10);return isNaN(n)?t:n},t.setFeatureGateDictionaryGetter=function(e){const t=globalThis.__get_feature_gate_dictionary_variable;return globalThis.__get_feature_gate_dictionary_variable=e,t}},66761:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(74643);n.__exportStar(r(46231),t),n.__exportStar(r(27234),t),n.__exportStar(r(56825),t),n.__exportStar(r(23935),t),n.__exportStar(r(64729),t),n.__exportStar(r(85687),t)},27234:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;const n=r(46231);t.makeGetTypedFeatureGate=function(e){return function(t){const r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},23935:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;const n=r(56825);t.makeTypedIsChangeGateEnabled=function(e){return e=>(0,n.isChangeGateEnabled)(e)}},64729:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;const n=r(56825);function a(e){const t=(0,n.setChangeGateDictionaryGetter)(void 0);return(0,n.setChangeGateDictionaryGetter)((()=>({...void 0!==t?t():{},...e}))),t}t.overrideChangeGates=a,t.overrideTypedChangeGates=function(e,t){return a(t)}},85687:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;const n=r(46231);function a(e){const t={};for(const r of Object.keys(e))t[r]=e[r]?.toString();const r=(0,n.setFeatureGateDictionaryGetter)(void 0)??(()=>({}));return(0,n.setFeatureGateDictionaryGetter)((()=>({...r(),...t}))),r}t.overrideFeatureGates=a,t.overrideTypedFeatureGates=function(e,t){return a(t)}},57479:function(e,t,r){"use strict";r.r(t),r.d(t,{convertDataFields:function(){return a},getTelemetryLogger:function(){return s},setTelemetryLogger:function(){return o}});var n=r(52716);function a(e){let t=!0;const r=[];return e.forEach((e=>{const a=e.classification;if(a===n.o.DataClassification.SystemMetadata||a===n.o.DataClassification.EssentialServiceMetadata){const t={name:e.name,bool:null,string:null,double:null,int64:null,date:null,contract:null};switch(e.dataType){case n.o.DataFieldType.Boolean:t.bool=e.value;break;case n.o.DataFieldType.Double:t.double=e.value;break;case n.o.DataFieldType.Int64:t.int64=e.value;break;case n.o.DataFieldType.String:t.string=e.value;break;case n.o.DataFieldType.Guid:default:return}r.push(t)}else t=!1})),t?r:[]}var i=r(37374);function o(e){globalThis.__otel_util_telemetry_logger__=e}function s(){return void 0===globalThis.__otel_util_telemetry_logger__&&(globalThis.__otel_util_telemetry_logger__=new i.M),globalThis.__otel_util_telemetry_logger__}},11093:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.createWorker=void 0,a(r(79113),t);var i=r(58713);Object.defineProperty(t,"createWorker",{enumerable:!0,get:function(){return i.createWorker}})},79113:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.workerName=t.isWorkerThread=t.importScriptsWithRetry=t.Endpoint=t.paramInsideDef=t.dispatchWorkerError=t.setConfig=t.isThreadingSupported=t.WorkerError=void 0;var n=r(67053);Object.defineProperty(t,"WorkerError",{enumerable:!0,get:function(){return n.WorkerError}});var a=r(74131);Object.defineProperty(t,"isThreadingSupported",{enumerable:!0,get:function(){return a.isThreadingSupported}}),Object.defineProperty(t,"setConfig",{enumerable:!0,get:function(){return a.setConfig}}),Object.defineProperty(t,"dispatchWorkerError",{enumerable:!0,get:function(){return a.dispatchWorkerError}});var i=r(87627);Object.defineProperty(t,"paramInsideDef",{enumerable:!0,get:function(){return i.paramInsideDef}});var o=r(45044);Object.defineProperty(t,"Endpoint",{enumerable:!0,get:function(){return o.Endpoint}});var s=r(4210);Object.defineProperty(t,"importScriptsWithRetry",{enumerable:!0,get:function(){return s.importScriptsWithRetry}});var u=r(36154);Object.defineProperty(t,"isWorkerThread",{enumerable:!0,get:function(){return u.isWorkerThread}}),Object.defineProperty(t,"workerName",{enumerable:!0,get:function(){return u.workerName}})},74131:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dispatchCreateWorker=t.dispatchWorkerError=t.getCreateMode=t.getCreateTimeout=t.getSafeParams=t.setConfig=t.isThreadingSupported=t.ThreadMessageKind=void 0;const n=r(97843);var a;function i(){return"undefined"!=typeof Blob&&"undefined"!=typeof URL&&void 0!==URL.createObjectURL&&void 0!==URL.revokeObjectURL&&"undefined"!=typeof Worker}let o;function s(e){setTimeout((()=>{throw e}))}function u(){return"undefined"!=typeof self&&"__typed_workers_thread"in self?self:void 0}function l(e){const t=u();if(void 0!==t){const r={kind:a.WorkerError,error:(0,n.encodeResultValue)(e)};t.postMessage(r)}else console.warn(e)}function c(e){const t=u();if(void 0!==t){const r={kind:a.CreateWorker,stats:e};t.postMessage(r)}}!function(e){e[e.InitResult=0]="InitResult",e[e.WorkerError=1]="WorkerError",e[e.CreateWorker=2]="CreateWorker"}(a||(t.ThreadMessageKind=a={})),t.isThreadingSupported=i,t.setConfig=function(e){if(o)throw new TypeError("setConfig has already been called");o=e},t.getSafeParams=function(){const e=o??{};return{createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls?[...e.importScriptUrls]:void 0,typedWorkersUrl:e.typedWorkersUrl,typedWorkersName:e.typedWorkersName,importScriptsMaxRetries:e.importScriptsMaxRetries}},t.getCreateTimeout=function(e){return e?.createTimeout??o?.createTimeout??3e5},t.getCreateMode=function(e){const t=e?.createMode??o?.createMode??"Thread";return"ThreadOrLocal"===t?i()?"Thread":"Local":t},t.dispatchWorkerError=function(e){try{(o?.onWorkerError??l)(e)}catch(t){console.warn(e),s(t)}},t.dispatchCreateWorker=function(e){try{(o?.onCreateWorker??c)(e)}catch(e){s(e)}}},58713:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.createWorker=void 0;const o=r(87627),s=r(45044),u=r(74131),l=r(69353),c=r(67053),d=r(90818),g=r(91891),m={...i(r(79113)),createWorker:S};function h(e,t,r,n,a){const{port1:i,port2:o}=new MessageChannel;let u;return Promise.all([n({port:i,options:e,createMode:t}),(0,d.timePromise)(r.createOutside=(0,d.startStopwatch)(),(()=>s.Endpoint.createOutside({port:o,options:e,createMode:t},(e=>a(u=e)))))]).then((()=>u),(e=>(u?u.close("Force"):o.close(),Promise.reject(e))))}function p(e,t,r,n){return h(e,"Local",t,(e=>function(e,t,r){const{def:n,args:a}="def"in r?r:(0,o.paramInsideDef)(r);if("function"!=typeof n){const t={cause:"InternalError",idInfo:{type:"Endpoint",side:"Inside",id:e.options.id}};return Promise.reject(new c.WorkerError("Loading an InsideScript to create a local worker is unimplemented",t))}return Promise.resolve().then((()=>(0,d.timePromise)(t.insideInit=(0,d.startStopwatch)(),(()=>n({config:(0,u.getSafeParams)(),importTypedWorkers:()=>m,connection:e},...a).then((()=>{}))))))}(e,t,r)),n)}function f(e,t,r,n){let a;t.createThread=(0,d.startStopwatch)();try{a=new l.Thread(e,r)}catch(e){return(0,d.stopStopwatch)(t.createThread,"Error"),Promise.reject(e)}return(0,d.stopStopwatch)(t.createThread,"Success"),h(e,"Thread",t,(e=>a.createInside(e,t)),n).then((e=>(e.hasBeenClosed()?a.terminate():e._onClose=a.terminate.bind(a),e)),(e=>(a.terminate(),Promise.reject(e))))}function S(e,t,r=(()=>{})){const n=(0,u.getCreateMode)(e),a="local"in t?"Local"===n?t.local:t.thread:t,i="Local"===n?p:f,o={id:e.id,createMode:n,createWorker:(0,d.startStopwatch)()},l=(0,d.timePromise)(o.createWorker,(()=>i((0,s.getSafeOptions)(e),o,a,r)));return(0,g.promiseFinally)(l,(()=>{const e=(0,d.createWorkerStats)(o);e&&(0,u.dispatchCreateWorker)(e)}))}t.createWorker=S},45044:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Endpoint=t.getSafeOptions=void 0;const n=r(74131),a=r(97843),i=r(67053),o=r(47831),s=r(91891);t.getSafeOptions=function(e){return{id:e.id,createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls,importScriptsMaxRetries:e.importScriptsMaxRetries}};class u{static _create(e,t,r){const{port:a,options:l,createMode:c}=t,d={type:"Endpoint",side:e,id:l?.id};let g,m;try{g=new o.EndpointState(d,a),m=new u(d,g,c)}catch(e){return Promise.reject(e)}return new Promise(((t,a)=>{g.getCallTimeout=()=>m.callTimeout,g.getOnPostMessageError=()=>m.onPostMessageError,g.onImports=(e,t)=>{Object.defineProperties(m,{post:{configurable:!0,enumerable:!1,writable:!1,value:e},call:{configurable:!0,enumerable:!1,writable:!1,value:t}}),u.resolve()},g.onClose=()=>m.close("Force");const o=(0,n.getCreateTimeout)(l),u=(0,s.setCallbacksTimeout)(o,(()=>{const t="Outside"===e?"inside":"outside",r={cause:"Timeout",idInfo:d,timeout:o},n=new i.WorkerError(`${e} Endpoint timed out waiting for the ${t} to start`,r);u.reject(n)}),{resolve:t,reject:a});let c;m._closedDuringCreate=()=>{u.resolve()};try{c=r(m)}catch(e){return u.reject(e)}m._state?.setExports(c)})).then((()=>(m._closedDuringCreate=void 0,m)),(e=>(m._closedDuringCreate=void 0,m.close(),Promise.reject(e))))}hasBeenClosed(){return void 0===this._state}close(e){if(!this._state)return;if(this._closedDuringCreate){if("Force"!==e){const e={cause:"Connection",idInfo:this._idInfo};throw new i.WorkerError(`${this._idInfo.side} Endpoint's close called during creation`,e)}this._closedDuringCreate()}const t=this._state;this._state=void 0;try{t.close(),this._onClose?.(),this.onClose?.()}catch(e){const t={cause:"Connection",idInfo:this._idInfo,error:(0,a.asError)(e)};(0,n.dispatchWorkerError)(new i.WorkerError(`${this._idInfo.side} Endpoint's close threw an error`,t))}}constructor(e,t,r){this.callTimeout=1/0,this.onPostMessageError=o.throwWorkerError,this._idInfo=e,this._state=t,this.createMode=r;const n=t=>()=>{const r="Outside"===e.side?"inside":"outside",n={cause:"Connection",idInfo:e};throw new i.WorkerError(`${e.side} Endpoint's ${t} referenced before the ${r} Endpoint started`,n)};Object.defineProperties(this,{post:{configurable:!0,enumerable:!1,get:n("post")},call:{configurable:!0,enumerable:!1,get:n("call")}})}}t.Endpoint=u,u.createOutside=(e,t=(()=>{}))=>u._create("Outside",e,t),u.createInside=(e,t)=>u._create("Inside",e,t)},47831:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EndpointState=t.throwWorkerError=void 0;const n=r(74131),a=r(97843),i=r(67053),o=r(91891);var s;function u(e){throw e}!function(e){e[e.Invoke=0]="Invoke",e[e.Result=1]="Result",e[e.Names=2]="Names",e[e.Close=3]="Close"}(s||(s={})),t.throwWorkerError=u;let l=-1;t.EndpointState=class{setExports(e){this.exports=e;const t=(0,o.haveNativeProxy)()?void 0:(0,o.getFunctionPropertyNames)(e),r={kind:s.Names,funcNames:t};this.port.postMessage(r)}close(){if(this.isClosed)return;this.isClosed=!0;const e={kind:s.Close};this.port.postMessage(e),this.port.close();for(const e in this.unresolvedCalls){const{reject:t,funcName:r}=this.unresolvedCalls[e],n={cause:"Connection",idInfo:this.idInfo,funcName:r};t(new i.WorkerError(`Importing Endpoint closed while waiting for ${r} result`,n))}}onInvoke({callId:e,funcName:t,args:r}){const o=Promise.resolve().then((()=>{const n=this.exports[t];if(n)return n.apply(this.exports,r);const a=e>=0?"call":"post",o={cause:"Connection",idInfo:this.idInfo,callId:e,funcName:t};throw new i.WorkerError(`Exporting Endpoint received a ${a} to unknown function ${t}`,o)}));e>=0?o.then((r=>this.sendResult(e,t,!0,r)),(r=>this.sendResult(e,t,!1,r))):o.catch((r=>{const o=(0,a.asError)(r),s={cause:"UnhandledError",idInfo:this.idInfo,error:o,callId:e,funcName:t};(0,n.dispatchWorkerError)(new i.WorkerError(`Exporting Endpoint's ${t} implementation threw or rejected`,s))}))}sendResult(e,t,r,n){const i=(0,a.encodeResultValue)(n),o={kind:s.Result,callId:e,funcName:t,isFulfilled:r,resultValue:i};try{this.port.postMessage(o,void 0)}catch(e){this.onSendResultFailed(o,(0,a.asError)(e))}}onSendResultFailed({callId:e,funcName:t,resultValue:r},a){const o=a?`Exporting Endpoint failed to send ${t} result`:`Importing Endpoint failed to deserialize ${t} result`,s={cause:"MessageError",idInfo:this.idInfo,error:a,callId:e,funcName:t},u=new i.WorkerError(o,s);r.isError?(0,n.dispatchWorkerError)(u):this.sendResult(e,t,!1,u)}takeCallbacks(e){const t=this.unresolvedCalls[e];return t&&delete this.unresolvedCalls[e],t}setCallTimeout(e,t,r,n){return r>o.maxTimeout?n:(0,o.setCallbacksTimeout)(r,(()=>{const n=this.takeCallbacks(e);if(n){const a={cause:"Timeout",idInfo:this.idInfo,timeout:r,callId:e,funcName:t};n.reject(new i.WorkerError(`Importing Endpoint's call to ${t} timed out`,a))}}),n)}sendCall(e,t,r,n){return new Promise(((o,u)=>{const c=l+=1,d={kind:s.Invoke,callId:c,funcName:e,args:t};this.unresolvedCalls[c]={...this.setCallTimeout(c,e,r,{resolve:o,reject:u}),funcName:e};try{this.port.postMessage(d,n)}catch(t){const r=this.takeCallbacks(c);if(r){const n=(0,a.asError)(t),o={cause:"MessageError",idInfo:this.idInfo,error:n,callId:c,funcName:e};r.reject(new i.WorkerError(`Importing Endpoint failed to send call to ${e}`,o))}}}))}sendPost(e,t,r,n){const o={kind:s.Invoke,callId:-1,funcName:e,args:t};try{this.port.postMessage(o,n)}catch(t){const n=(0,a.asError)(t),o={cause:"MessageError",idInfo:this.idInfo,error:n,callId:-1,funcName:e};r(new i.WorkerError(`Importing Endpoint failed to post to ${e}`,o))}}onSendInvokeFailed({callId:e,funcName:t}){const r=e>=0?"call":"post",a={cause:"MessageError",idInfo:this.idInfo,callId:e,funcName:t},o=new i.WorkerError(`Exporting Endpoint failed to deserialize ${r} to ${t}`,a),s=e>=0?this.takeCallbacks(e):void 0;(s?.reject??n.dispatchWorkerError)(o)}onResult({callId:e,funcName:t,isFulfilled:r,resultValue:a}){if(e>=0){const t=this.takeCallbacks(e);t&&(r?t.resolve:t.reject)((0,i.decodeResultValue)(a))}else{const r={cause:"InternalError",idInfo:this.idInfo,callId:e,funcName:t};(0,n.dispatchWorkerError)(new i.WorkerError(`Exporting Endpoint sent a result for a post to ${t}`,r))}}createPostProxy(e){const t=(...e)=>t.transfer(void 0,...e);return t.transfer=(r,...n)=>{if(this.isClosed)return;const a=t.onPostMessageError??this.getOnPostMessageError?.()??u;this.sendPost(e,n,a,r)},t}createCallProxy(e){const t=(...e)=>t.transfer(void 0,...e);return t.transfer=(r,...n)=>{if(this.isClosed){const t={cause:"Connection",idInfo:this.idInfo,funcName:e};return Promise.reject(new i.WorkerError(`${this.idInfo.side} Endpoint's call.${e} called after close`,t))}const a=t.callTimeout??this.getCallTimeout?.()??1/0;return this.sendCall(e,n,a,r)},t.callTimeout=void 0,t}constructor(e,t){this.idInfo=e,this.port=t,this.isClosed=!1,this.exports={},this.unresolvedCalls=(0,o.createEmptyRecord)();const r=()=>this.onClose?.(),n={[s.Invoke]:this.onInvoke.bind(this),[s.Result]:this.onResult.bind(this),[s.Names]:({funcNames:e})=>{this.onImports?.((0,o.createObjectFromFunction)(this.createPostProxy.bind(this),e),(0,o.createObjectFromFunction)(this.createCallProxy.bind(this),e))},[s.Close]:r},a={[s.Invoke]:this.onSendInvokeFailed.bind(this),[s.Result]:this.onSendResultFailed.bind(this),[s.Names]:r,[s.Close]:r};this.port.onmessage=({data:e})=>n[e.kind](e),this.port.onmessageerror=({data:e})=>a[e.kind](e)}}},97843:function(e,t){"use strict";function r(e){return n(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function n(e){if(null==e)return!1;if(e instanceof Error)return!0;const t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function a(e){return{...e,error:e.error?i(e.error):void 0}}function i(e){return{name:e.name,message:r(e)?e.baseMessage:e.message,stack:e.stack,info:r(e)?a(e.info):void 0}}Object.defineProperty(t,"__esModule",{value:!0}),t.encodeResultValue=t.encodeError=t.encodeWorkerErrorInfo=t.asError=t.isError=t.isWorkerError=void 0,t.isWorkerError=r,t.isError=n,t.asError=function(e){return n(e)?e:new Error(`(non-Error object) ${function(e){const t=typeof e;switch(t){case"function":case"symbol":case"undefined":return`<${t}>`;case"object":return JSON.stringify(e);default:return`${e}`}}(e)}`)},t.encodeWorkerErrorInfo=a,t.encodeError=i,t.encodeResultValue=function(e){return n(e)?{isError:!0,value:i(e)}:{isError:!1,value:e}}},55358:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTypedFeatureGate=t.isTypedChangeGateEnabled=void 0;const n=r(66761);t.isTypedChangeGateEnabled=(0,n.makeTypedIsChangeGateEnabled)(["OfficeVSO:WINum_CGExample","OfficeVSO:5592319_TypedWorkersProxyPromiseFix"]),t.getTypedFeatureGate=(0,n.makeGetTypedFeatureGate)({"Microsoft.Office.Shared.FGExample":!0})},91891:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createObjectFromFunction=t.haveNativeProxy=t.getFunctionPropertyNames=t.createEmptyRecord=t.setCallbacksTimeout=t.maxTimeout=t.promiseFinally=void 0;const n=r(55358);function a(){const e=Object.create(null);return e.key=void 0,delete e.key,e}let i;t.promiseFinally=function(e,t){return e.then((e=>(t(),e)),(e=>(t(),Promise.reject(e))))},t.maxTimeout=1<<30,t.setCallbacksTimeout=function(e,r,n){if(e>t.maxTimeout)return n;const a=setTimeout(r,Math.max(0,e));return{resolve:e=>{clearTimeout(a),n.resolve(e)},reject:e=>{clearTimeout(a),n.reject(e)}}},t.createEmptyRecord=a,t.getFunctionPropertyNames=function(e){const t=a();for(;null!=e;){for(const r of Object.getOwnPropertyNames(e))try{"function"==typeof e[r]&&(t[r]=!0)}catch(e){}e=Object.getPrototypeOf(e)}return Object.getOwnPropertyNames(t)},t.haveNativeProxy=function(){return i??(i=function(){try{return"function"==typeof Proxy&&!0===new Proxy({},{get:()=>!0}).k}catch(e){return!1}}())},t.createObjectFromFunction=function(e,t){const r=a(),i=(0,n.isTypedChangeGateEnabled)("OfficeVSO:5592319_TypedWorkersProxyPromiseFix")?(t,r)=>"then"===r?void 0:t[r]??(t[r]=e(r)):(t,r)=>t[r]??(t[r]=e(r));return t?(t.forEach((e=>i(r,e))),r):new Proxy(r,{get:i})}},4210:function(e,t){"use strict";function r(e,t,r){const n=e.indexOf("?");if(n<0)return`${e}?${t}=${r}`;const a=e.slice(0,n+1),i=e.slice(n+1).split("&");let o=0;for(;o<i.length&&("="!==i[o][t.length]||i[o].slice(0,t.length)!==t);o+=1);return i[o]=`${t}=${r}`,a+i.join("&")}function n(e,t){let n;for(let a=0;a<=t;a+=1)try{return void importScripts(a>0?r(e,"retries",String(a)):e)}catch(e){n=e}throw n}Object.defineProperty(t,"__esModule",{value:!0}),t.importScriptsWithRetry=void 0,t.importScriptsWithRetry=function(e,t){if(0!==t)for(const r of e)n(r,t);else importScripts(...e)}},87627:function(e,t){"use strict";function r(e){throw new ReferenceError(`${e} is not defined`)}Object.defineProperty(t,"__esModule",{value:!0}),t.paramInsideDef=t.indexObject=void 0,t.indexObject=function(e,t,n=r){try{const r=t.split(".");for(const t of r)e=e[t];return e??n(t)}catch(e){return n(t)}},t.paramInsideDef=(e,...r)=>t.paramInsideDef.transfer(e,void 0,...r),t.paramInsideDef.transfer=(e,t,...r)=>({def:e,args:r,transferables:t??[]})},90818:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createWorkerStats=t.timePromise=t.stopStopwatch=t.startStopwatch=void 0;const n=r(97843),a="undefined"!=typeof performance&&void 0!==performance.timeOrigin?()=>performance.now()+performance.timeOrigin:()=>Date.now();function i(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,r??a()))}function o(e){return Math.round(1e3*e)/1e3}function s(e,t,r){return e<t?t:e>r?r:e}function u(e,t,r){const n=s(e?.start??1/0,t,r),a=s(e?.end??1/0,t,r);return{status:e?.status??"Pending",start:o(n-t),end:o(a-t),duration:o(a-n)}}t.startStopwatch=function(){return{status:"Pending",start:a()}},t.stopStopwatch=i,t.timePromise=function(e,t){function r(t){throw i(e,(0,n.isWorkerError)(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((t=>i(e,"Success")??t),r)}catch(e){r(e)}},t.createWorkerStats=function(e){const{id:t,createMode:r,createWorker:n,insideInit:a,createOutside:i,createThread:s}=e,{status:l,start:c,end:d}=n;if("Pending"!==l&&void 0!==d)return{id:t,createMode:r,createWorker:{status:l,absStart:c,duration:o(d-c)},createThread:"Thread"===r?u(s,c,d):void 0,createOutside:u(i,c,d),insideInit:u(a,c,d)}}},69353:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Thread=void 0;const a=r(74131),i=r(67053),o=r(87627),s=n(r(67387)),u=r(91891),l=r(66761);let c=-1;t.Thread=class{revokeBlobUrl(){void 0!==this.blobUrl&&(URL.revokeObjectURL(this.blobUrl),this.blobUrl=void 0)}createInside(e,t){const{port:r,options:n}=e,o={type:"Thread",side:"Outside",id:n.id},s=this.worker,c=new Promise(((e,u)=>{this.createCallbacks={resolve:e,reject:u};const c={config:(0,a.getSafeParams)(),port:r,options:n,script:this.script,args:this.args,featureGateDictionary:(0,l.getFeatureGateDictionary)(),changeGateDictionary:(0,l.getChangeGateDictionary)()};s.postMessage(c,[r,...this.transferables]),s.onerror=e=>{e.preventDefault();const t=(0,i.getErrorEventWorkerError)(o,"worker.onerror",e);this.createCallbacks?this.createCallbacks.reject(t):(0,a.dispatchWorkerError)(t)},s.onmessage=({data:e})=>{switch(e.kind){case a.ThreadMessageKind.InitResult:return t.insideInit=e.stopwatch,void 0===e.error?this.createCallbacks?.resolve():this.createCallbacks?.reject((0,i.decodeResultValue)(e.error));case a.ThreadMessageKind.WorkerError:return(0,a.dispatchWorkerError)((0,i.decodeResultValue)(e.error));case a.ThreadMessageKind.CreateWorker:return(0,a.dispatchCreateWorker)(e.stats)}}}));return(0,u.promiseFinally)(c,(()=>{this.createCallbacks=void 0}))}terminate(){if(!this.worker)return;const e=this.worker;this.worker=void 0,this.createCallbacks?.resolve(),e.terminate(),this.revokeBlobUrl()}constructor(e,t){try{let r;[this.script,this.args,this.transferables,r]=function(e){const{def:t,args:r,transferables:n}="def"in e?e:(0,o.paramInsideDef)(e);if("function"!=typeof t)return[t,r,n,void 0];const a=`__generatedInsideInit${c+=1}`;return[{scriptUrl:void 0,insideInitName:a},r,n,`var ${a} = ${t.toString()};`]}(t);const n=void 0===r?[s.default]:[r,"\n\n",s.default];this.blobUrl=URL.createObjectURL(new Blob(n,{type:"application/javascript"}));const a={};null!=e.id&&(a.name=e.id),this.worker=new Worker(this.blobUrl,a)}catch(e){throw this.worker?.terminate(),this.revokeBlobUrl(),e}}}},67387:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default='(function(){var threadBootstrap;(()=>{"use strict";var e={530:(e,t,r)=>{r.r(t),r.d(t,{__assign:()=>a,__asyncDelegator:()=>T,__asyncGenerator:()=>j,__asyncValues:()=>G,__await:()=>S,__awaiter:()=>y,__classPrivateFieldGet:()=>W,__classPrivateFieldIn:()=>C,__classPrivateFieldSet:()=>x,__createBinding:()=>h,__decorate:()=>c,__esDecorate:()=>u,__exportStar:()=>g,__extends:()=>o,__generator:()=>_,__importDefault:()=>M,__importStar:()=>E,__makeTemplateObject:()=>k,__metadata:()=>p,__param:()=>s,__propKey:()=>l,__read:()=>b,__rest:()=>i,__runInitializers:()=>f,__setFunctionName:()=>d,__spread:()=>m,__spreadArray:()=>O,__spreadArrays:()=>w,__values:()=>v});var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var a=function(){return a=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},a.apply(this,arguments)};function i(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function c(e,t,r,n){var o,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(i=(a<3?o(i):a>3?o(t,r,i):o(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i}function s(e,t){return function(r,n){t(r,n,e)}}function u(e,t,r,n,o,a){function i(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var c,s=n.kind,u="getter"===s?"get":"setter"===s?"set":"value",f=!t&&e?n.static?e:e.prototype:null,l=t||(f?Object.getOwnPropertyDescriptor(f,n.name):{}),d=!1,p=r.length-1;p>=0;p--){var y={};for(var _ in n)y[_]="access"===_?{}:n[_];for(var _ in n.access)y.access[_]=n.access[_];y.addInitializer=function(e){if(d)throw new TypeError("Cannot add initializers after decoration has completed");a.push(i(e||null))};var h=(0,r[p])("accessor"===s?{get:l.get,set:l.set}:l[u],y);if("accessor"===s){if(void 0===h)continue;if(null===h||"object"!=typeof h)throw new TypeError("Object expected");(c=i(h.get))&&(l.get=c),(c=i(h.set))&&(l.set=c),(c=i(h.init))&&o.push(c)}else(c=i(h))&&("field"===s?o.push(c):l[u]=c)}f&&Object.defineProperty(f,n.name,l),d=!0}function f(e,t,r){for(var n=arguments.length>2,o=0;o<t.length;o++)r=n?t[o].call(e,r):t[o].call(e);return n?r:void 0}function l(e){return"symbol"==typeof e?e:"".concat(e)}function d(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function p(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function y(e,t,r,n){return new(r||(r=Promise))((function(o,a){function i(e){try{s(n.next(e))}catch(e){a(e)}}function c(e){try{s(n.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,c)}s((n=n.apply(e,t||[])).next())}))}function _(e,t){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(s){return function(c){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&c[0]?n.return:c[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,c[1])).done)return o;switch(n=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,n=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],n=0}finally{r=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}}var h=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function g(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||h(t,e,r)}function v(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function b(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i}function m(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(b(arguments[t]));return e}function w(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var a=arguments[t],i=0,c=a.length;i<c;i++,o++)n[o]=a[i];return n}function O(e,t,r){if(r||2===arguments.length)for(var n,o=0,a=t.length;o<a;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function S(e){return this instanceof S?(this.v=e,this):new S(e)}function j(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),a=[];return n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n;function i(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){a.push([e,t,r,n])>1||c(e,t)}))})}function c(e,t){try{(r=o[e](t)).value instanceof S?Promise.resolve(r.value.v).then(s,u):f(a[0][2],r)}catch(e){f(a[0][3],e)}var r}function s(e){c("next",e)}function u(e){c("throw",e)}function f(e,t){e(t),a.shift(),a.length&&c(a[0][0],a[0][1])}}function T(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:S(e[n](t)),done:!1}:o?o(t):t}:o}}function G(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=v(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}}function k(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var P=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function E(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&h(t,e,r);return P(t,e),t}function M(e){return e&&e.__esModule?e:{default:e}}function W(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function x(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function C(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use \'in\' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},216:(e,t)=>{function r(){return void 0===globalThis.__get_change_gate_dictionary_variable?{}:globalThis.__get_change_gate_dictionary_variable()}Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0,t.getChangeGateDictionary=r,t.isChangeGateEnabled=function(e){return r()[e]??!0},t.setChangeGateDictionaryGetter=function(e){const t=globalThis.__get_change_gate_dictionary_variable;return globalThis.__get_change_gate_dictionary_variable=e,t}},448:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;const r={};function n(){return void 0===globalThis.__get_feature_gate_dictionary_variable?r:globalThis.__get_feature_gate_dictionary_variable()}function o(e,t){return n()[e]??t}t.getFeatureGateDictionary=n,t.getStringFeatureGate=o,t.getBooleanFeatureGate=function(e,t){const r=o(e)?.trim().toLowerCase();return"true"===r||"false"!==r&&t},t.getNumberFeatureGate=function(e,t){const r=o(e)?.trim().toLowerCase();if(void 0===r)return t;if("infinity"===r||"+infinity"===r)return 1/0;if("-infinity"===r)return-1/0;const n=parseFloat(r);return isNaN(n)?t:n},t.getIntFeatureGate=function(e,t){const r=o(e)?.trim();if(void 0===r)return t;const n=parseInt(r,10);return isNaN(n)?t:n},t.setFeatureGateDictionaryGetter=function(e){const t=globalThis.__get_feature_gate_dictionary_variable;return globalThis.__get_feature_gate_dictionary_variable=e,t}},400:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=r(530);n.__exportStar(r(448),t),n.__exportStar(r(187),t),n.__exportStar(r(216),t),n.__exportStar(r(340),t),n.__exportStar(r(56),t),n.__exportStar(r(96),t)},187:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;const n=r(448);t.makeGetTypedFeatureGate=function(e){return function(t){const r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},340:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;const n=r(216);t.makeTypedIsChangeGateEnabled=function(e){return e=>(0,n.isChangeGateEnabled)(e)}},56:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;const n=r(216);function o(e){const t=(0,n.setChangeGateDictionaryGetter)(void 0);return(0,n.setChangeGateDictionaryGetter)((()=>({...void 0!==t?t():{},...e}))),t}t.overrideChangeGates=o,t.overrideTypedChangeGates=function(e,t){return o(t)}},96:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;const n=r(448);function o(e){const t={};for(const r of Object.keys(e))t[r]=e[r]?.toString();const r=(0,n.setFeatureGateDictionaryGetter)(void 0)??(()=>({}));return(0,n.setFeatureGateDictionaryGetter)((()=>({...r(),...t}))),r}t.overrideFeatureGates=o,t.overrideTypedFeatureGates=function(e,t){return o(t)}},691:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.dispatchCreateWorker=t.dispatchWorkerError=t.getCreateMode=t.getCreateTimeout=t.getSafeParams=t.setConfig=t.isThreadingSupported=t.ThreadMessageKind=void 0;const n=r(739);var o;function a(){return"undefined"!=typeof Blob&&"undefined"!=typeof URL&&void 0!==URL.createObjectURL&&void 0!==URL.revokeObjectURL&&"undefined"!=typeof Worker}let i;function c(e){setTimeout((()=>{throw e}))}function s(){return"undefined"!=typeof self&&"__typed_workers_thread"in self?self:void 0}function u(e){const t=s();if(void 0!==t){const r={kind:o.WorkerError,error:(0,n.encodeResultValue)(e)};t.postMessage(r)}else console.warn(e)}function f(e){const t=s();if(void 0!==t){const r={kind:o.CreateWorker,stats:e};t.postMessage(r)}}!function(e){e[e.InitResult=0]="InitResult",e[e.WorkerError=1]="WorkerError",e[e.CreateWorker=2]="CreateWorker"}(o||(t.ThreadMessageKind=o={})),t.isThreadingSupported=a,t.setConfig=function(e){if(i)throw new TypeError("setConfig has already been called");i=e},t.getSafeParams=function(){const e=i??{};return{createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls?[...e.importScriptUrls]:void 0,typedWorkersUrl:e.typedWorkersUrl,typedWorkersName:e.typedWorkersName,importScriptsMaxRetries:e.importScriptsMaxRetries}},t.getCreateTimeout=function(e){return e?.createTimeout??i?.createTimeout??3e5},t.getCreateMode=function(e){const t=e?.createMode??i?.createMode??"Thread";return"ThreadOrLocal"===t?a()?"Thread":"Local":t},t.dispatchWorkerError=function(e){try{(i?.onWorkerError??u)(e)}catch(t){console.warn(e),c(t)}},t.dispatchCreateWorker=function(e){try{(i?.onCreateWorker??f)(e)}catch(e){c(e)}}},739:(e,t)=>{function r(e){return n(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function n(e){if(null==e)return!1;if(e instanceof Error)return!0;const t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function o(e){return{...e,error:e.error?a(e.error):void 0}}function a(e){return{name:e.name,message:r(e)?e.baseMessage:e.message,stack:e.stack,info:r(e)?o(e.info):void 0}}Object.defineProperty(t,"__esModule",{value:!0}),t.encodeResultValue=t.encodeError=t.encodeWorkerErrorInfo=t.asError=t.isError=t.isWorkerError=void 0,t.isWorkerError=r,t.isError=n,t.asError=function(e){return n(e)?e:new Error(`(non-Error object) ${function(e){const t=typeof e;switch(t){case"function":case"symbol":case"undefined":return`<${t}>`;case"object":return JSON.stringify(e);default:return`${e}`}}(e)}`)},t.encodeWorkerErrorInfo=o,t.encodeError=a,t.encodeResultValue=function(e){return n(e)?{isError:!0,value:a(e)}:{isError:!1,value:e}}},762:(e,t)=>{function r(e,t,r){const n=e.indexOf("?");if(n<0)return`${e}?${t}=${r}`;const o=e.slice(0,n+1),a=e.slice(n+1).split("&");let i=0;for(;i<a.length&&("="!==a[i][t.length]||a[i].slice(0,t.length)!==t);i+=1);return a[i]=`${t}=${r}`,o+a.join("&")}function n(e,t){let n;for(let o=0;o<=t;o+=1)try{return void importScripts(o>0?r(e,"retries",String(o)):e)}catch(e){n=e}throw n}Object.defineProperty(t,"__esModule",{value:!0}),t.importScriptsWithRetry=void 0,t.importScriptsWithRetry=function(e,t){if(0!==t)for(const r of e)n(r,t);else importScripts(...e)}},619:(e,t)=>{function r(e){throw new ReferenceError(`${e} is not defined`)}Object.defineProperty(t,"__esModule",{value:!0}),t.paramInsideDef=t.indexObject=void 0,t.indexObject=function(e,t,n=r){try{const r=t.split(".");for(const t of r)e=e[t];return e??n(t)}catch(e){return n(t)}},t.paramInsideDef=(e,...r)=>t.paramInsideDef.transfer(e,void 0,...r),t.paramInsideDef.transfer=(e,t,...r)=>({def:e,args:r,transferables:t??[]})},506:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createWorkerStats=t.timePromise=t.stopStopwatch=t.startStopwatch=void 0;const n=r(739),o="undefined"!=typeof performance&&void 0!==performance.timeOrigin?()=>performance.now()+performance.timeOrigin:()=>Date.now();function a(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,r??o()))}function i(e){return Math.round(1e3*e)/1e3}function c(e,t,r){return e<t?t:e>r?r:e}function s(e,t,r){const n=c(e?.start??1/0,t,r),o=c(e?.end??1/0,t,r);return{status:e?.status??"Pending",start:i(n-t),end:i(o-t),duration:i(o-n)}}t.startStopwatch=function(){return{status:"Pending",start:o()}},t.stopStopwatch=a,t.timePromise=function(e,t){function r(t){throw a(e,(0,n.isWorkerError)(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((t=>a(e,"Success")??t),r)}catch(e){r(e)}},t.createWorkerStats=function(e){const{id:t,createMode:r,createWorker:n,insideInit:o,createOutside:a,createThread:c}=e,{status:u,start:f,end:l}=n;if("Pending"===u||void 0===l)return;return{id:t,createMode:r,createWorker:{status:u,absStart:f,duration:i(l-f)},createThread:"Thread"===r?s(c,f,l):void 0,createOutside:s(a,f,l),insideInit:s(o,f,l)}}}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,r),a.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};(()=>{var e=n;Object.defineProperty(e,"__esModule",{value:!0});const t=r(739),o=r(619),a=r(691),i=r(506),c=r(762),s=r(400);self.onmessage=({data:{config:e,port:r,options:n,script:u,args:f,featureGateDictionary:l,changeGateDictionary:d}})=>{self.onmessage=null,self.__typed_workers_thread=!0,(0,s.setFeatureGateDictionaryGetter)((()=>l)),(0,s.setChangeGateDictionaryGetter)((()=>d));const p=n.importScriptsMaxRetries??e.importScriptsMaxRetries??0;let y;function _(){if(y)return y;if(void 0===e.typedWorkersUrl)throw new TypeError("importTypedWorkers: typedWorkersUrl is not defined");return(0,c.importScriptsWithRetry)([e.typedWorkersUrl],p),y=(0,o.indexObject)(self,e.typedWorkersName??"typedWorkers"),y.setConfig(e),y}const h=(0,i.startStopwatch)();function g(e,r){const n=e?void 0:(0,t.encodeResultValue)((0,t.asError)(r)),o={kind:a.ThreadMessageKind.InitResult,error:n,stopwatch:h};self.postMessage(o),e||setTimeout(self.close.bind(self),6e4)}try{(0,i.timePromise)(h,(()=>{(0,c.importScriptsWithRetry)([...n?.importScriptUrls??e.importScriptUrls??[],...void 0!==u.scriptUrl?[u.scriptUrl]:[]],p);return(0,o.indexObject)(self,u.insideInitName)({config:e,importTypedWorkers:_,connection:{port:r,options:n,createMode:"Thread"}},...f)})).then((()=>g(!0)),(e=>g(!1,e)))}catch(e){g(!1,e)}}})(),threadBootstrap=n})();})()'},67053:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.decodeResultValue=t.decodeWorkerErrorInfo=t.decodeError=t.knownErrorClasses=t.getErrorEventWorkerError=t.WorkerError=void 0;const n=r(97843);class a extends Error{constructor(e,t){super(`${e}; info = ${JSON.stringify({...t,error:t.error?.message})}`),this.baseMessage=e,this.info=t,this.name="WorkerError"}}function i(e){let r;if("WorkerError"===e.name)r=new a(e.message,o(e.info));else{const n=t.knownErrorClasses[e.name];n?r=new n(e.message):(r=new Error(e.message),r.name=e.name)}return null!=e.stack&&(r.stack=e.stack),r}function o(e){return{...e,error:e.error?i(e.error):void 0}}t.WorkerError=a,a.isWorkerError=n.isWorkerError,t.getErrorEventWorkerError=function(e,t,r){if((0,n.isError)(r.error)){if((0,n.isWorkerError)(r.error))return r.error;const i={cause:"UnhandledError",idInfo:e,error:r.error};return new a(`${t} received an unhandled error`,i)}if(null==r.message)return new a(`${t} received a non-error (worker script fetch probably failed)`,{cause:"UnhandledError",idInfo:e});const i={cause:"UnhandledError",idInfo:e},o=`${r.message} at ${r.filename}:${r.lineno}:${r.colno}`;return new a(`${t} received an unhandled error: ${o}`,i)},t.knownErrorClasses={Error,EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError},t.decodeError=i,t.decodeWorkerErrorInfo=o,t.decodeResultValue=function(e){return e.isError?i(e.value):e.value}},36154:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.workerName=t.isWorkerThread=void 0,t.isWorkerThread=function(){return"undefined"!=typeof WorkerGlobalScope},t.workerName=function(){return self.name}}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,r),i.exports}r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};!function(){"use strict";var e=n;Object.defineProperty(e,"__esModule",{value:!0}),e.ConsistentAnonymizer=e.x10TypesSubpackage=e.syntaxSubpackage=e.runtimeSubpackage=e.recalcSubpackage=e.numfmtSubpackage=e.langSubpackage=e.commonSubpackage=e.isTypedChangeGateEnabled=e.getTypedFeatureGate=e.x10=e.worker=e.style=e.funcs=e.calc=e.runtime=e.numfmt=e.analyze=e.parse=e.date=e.math=e.config=e.util=e.signature=e.value=e.formula=e.location=e.common=e.sheetName=e.ResettableLazy=e.asyncLazy=e.ResolvablePromiseWithLimitedSubscribers=e.FormulaAuthoringHelperSingletonGlobal=e.PluginSchedulerSingletonGlobal=e.packageVersion=void 0;const t=r(74643);var a=r(24865);Object.defineProperty(e,"packageVersion",{enumerable:!0,get:function(){return a.packageVersion}});const i=t.__importStar(r(86270));e.common=i;const o=t.__importStar(r(98396));e.location=o;const s=t.__importStar(r(26389));e.formula=s;const u=t.__importStar(r(68120));e.value=u;const l=t.__importStar(r(49353));e.signature=l;const c=t.__importStar(r(1961));e.util=c;const d=t.__importStar(r(78663));e.config=d;const g=t.__importStar(r(6347));e.math=g;const m=t.__importStar(r(71481));e.date=m;const h=t.__importStar(r(14082));e.parse=h;const p=t.__importStar(r(51123));e.analyze=p;const f=t.__importStar(r(8860));e.numfmt=f;const S=t.__importStar(r(25755));e.runtime=S;const v=t.__importStar(r(38838));e.calc=v;const F=t.__importStar(r(21386));e.funcs=F;const y=t.__importStar(r(18236));e.style=y;const C=t.__importStar(r(31327));e.worker=C;const A=t.__importStar(r(66840));e.x10=A;const E=r(29163),b=r(10303);e.PluginSchedulerSingletonGlobal=new E.PluginSchedulerSingleton,e.FormulaAuthoringHelperSingletonGlobal=new b.FormulaAuthoringHelperSingleton;var R=r(64327);Object.defineProperty(e,"ResolvablePromiseWithLimitedSubscribers",{enumerable:!0,get:function(){return R.ResolvablePromiseWithLimitedSubscribers}});var T=r(4595);Object.defineProperty(e,"asyncLazy",{enumerable:!0,get:function(){return T.asyncLazy}}),Object.defineProperty(e,"ResettableLazy",{enumerable:!0,get:function(){return T.ResettableLazy}});var k=r(91304);Object.defineProperty(e,"sheetName",{enumerable:!0,get:function(){return k.sheetName}});var N=r(60756);Object.defineProperty(e,"getTypedFeatureGate",{enumerable:!0,get:function(){return N.getTypedFeatureGate}}),Object.defineProperty(e,"isTypedChangeGateEnabled",{enumerable:!0,get:function(){return N.isTypedChangeGateEnabled}});const I=t.__importStar(r(91092));e.commonSubpackage=I;const O=t.__importStar(r(84817));e.langSubpackage=O;const _=t.__importStar(r(64562));e.numfmtSubpackage=_;const P=t.__importStar(r(40841));e.recalcSubpackage=P;const M=t.__importStar(r(42459));e.runtimeSubpackage=M;const D=t.__importStar(r(55174));e.syntaxSubpackage=D;const w=t.__importStar(r(53972));e.x10TypesSubpackage=w;var L=r(31234);Object.defineProperty(e,"ConsistentAnonymizer",{enumerable:!0,get:function(){return L.ConsistentAnonymizer}})}(),excelOnlineCalc=n}();
//# sourceMappingURL=excelOnlineCalc.min.js.map